cscope 15 /home/mdl/amk7371/video_analytics/HEVC_Encoded_Recognition/HM/source/Lib               0002763464
	@TLibCommon/AccessUnit.h

39 #¥agm®
⁄˚


41 #i‚de‡
__ACCESSUNIT__


42 
	#__ACCESSUNIT__


	)

44 
	~<li°
>

45 
	~"NAL.h
"

62 
˛ass
 
	gAc˚ssUnô
 : 
public
 
°d
::
li°
<
NALUnôEBSP
*>

64 
public
:

65 ~
Ac˚ssUnô
()

67 
Ac˚ssUnô
::
ôî©‹
 
ô
 = 
this
->
begö
(); 
	gô
 !this->
íd
(); it++)

69 
dñëe
 *
	gô
;

	@TLibCommon/CommonDef.h

38 #i‚de‡
__COMMONDEF__


39 
	#__COMMONDEF__


	)

41 
	~<Æg‹ôhm
>

42 
	~<io°ªam
>

43 #unde‡
NDEBUG


44 
	~<as£π.h
>

45 
	~<limôs
>

47 #i‡
_MSC_VER
 > 1000

49 #¥agm®
w¨nög
–
dißbÀ
 : 4018 )

51 #¥agm®
w¨nög
–
dißbÀ
 : 4800 )

53 
	~"Ty≥Def.h
"

55 #ifde‡
_MSC_VER


56 #i‡
_MSC_VER
 <= 1500

57 
ölöe
 
I¡64
 
	$abs
 (
I¡64
 
x
Ë{  
	`_abs64
(x); 
	}
};

68 
	#NV_VERSION
 "16.23"

69 

	)

74 #ifde‡
__GNUC__


75 
	#NVM_COMPILEDBY
 "[GCC %d.%d.%d]", 
__GNUC__
, 
__GNUC_MINOR__
, 
__GNUC_PATCHLEVEL__


	)

76 #ifde‡
__IA64__


77 
	#NVM_ONARCH
 "[⁄ 64-bô] "

	)

79 
	#NVM_ONARCH
 "[⁄ 32-bô] "

	)

83 #ifde‡
__INTEL_COMPILER


84 
	#NVM_COMPILEDBY
 "[ICC %d]", 
__INTEL_COMPILER


	)

85 #ñi‡ 
_MSC_VER


86 
	#NVM_COMPILEDBY
 "[VS %d]", 
_MSC_VER


	)

89 #i‚de‡
NVM_COMPILEDBY


90 
	#NVM_COMPILEDBY
 "[Unk-CXX]"

	)

93 #ifde‡
_WIN32


94 
	#NVM_ONOS
 "[Wödows]"

	)

95 #ñi‡ 
__löux


96 
	#NVM_ONOS
 "[Löux]"

	)

97 #ñi‡ 
__CYGWIN__


98 
	#NVM_ONOS
 "[Cygwö]"

	)

99 #ñi‡
__APPLE__


100 
	#NVM_ONOS
 "[Ma¯OS X]"

	)

102 
	#NVM_ONOS
 "[Unk-OS]"

	)

105 
	#NVM_BITS
 "[%d bô] ", ((
Void
*) == 8 ? 64 : 32)

106 

	)

107 #i‚de‡
NULL


108 
	#NULL
 0

	)

115 c⁄° 
UI¡
 
	gMAX_UINT
 = 0xFFFFFFFFU;

116 c⁄° 
I¡
 
	gMAX_INT
 = 2147483647;

117 c⁄° 
DoubÀ
 
	gMAX_DOUBLE
 = 1.7e+308;

124 c⁄° 
I¡
 
	gMAX_GOP
 = 64;

125 c⁄° 
I¡
 
	gMAX_NUM_REF_PICS
 = 16;

126 c⁄° 
I¡
 
	gMAX_NUM_REF
 = 16;

127 c⁄° 
I¡
 
	gMAX_QP
 = 51;

128 c⁄° 
I¡
 
	gNOT_VALID
 = -1;

130 c⁄° 
I¡
 
	gAMVP_MAX_NUM_CANDS
 = 2;

131 c⁄° 
I¡
 
	gAMVP_DECIMATION_FACTOR
 = 4;

132 c⁄° 
I¡
 
	gMRG_MAX_NUM_CANDS
 = 5;

135 c⁄° 
I¡
 
	gMAX_TLAYER
 = 7;

137 c⁄° 
I¡
 
	gADAPT_SR_SCALE
 = 1;

139 c⁄° 
I¡
 
	gMAX_NUM_PICS_IN_SOP
 = 1024;

141 c⁄° 
I¡
 
	gMAX_NESTING_NUM_OPS
 = 1024;

142 c⁄° 
I¡
 
	gMAX_NESTING_NUM_LAYER
 = 64;

144 c⁄° 
I¡
 
	gMAX_VPS_NUM_HRD_PARAMETERS
 = 1;

145 c⁄° 
I¡
 
	gMAX_VPS_OP_SETS_PLUS1
 = 1024;

146 c⁄° 
I¡
 
	gMAX_VPS_NUH_RESERVED_ZERO_LAYER_ID_PLUS1
 = 1;

148 c⁄° 
I¡
 
	gMAXIMUM_INTRA_FILTERED_WIDTH
 = 16;

149 c⁄° 
I¡
 
	gMAXIMUM_INTRA_FILTERED_HEIGHT
 = 16;

151 c⁄° 
I¡
 
	gMAX_CPB_CNT
 = 32;

152 c⁄° 
I¡
 
	gMAX_NUM_LAYER_IDS
 = 64;

154 c⁄° 
I¡
 
	gCOEF_REMAIN_BIN_REDUCTION
 = 3;

156 c⁄° 
I¡
 
	gCU_DQP_TU_CMAX
 = 5;

157 c⁄° 
I¡
 
	gCU_DQP_EG_k
 = 0;

159 c⁄° 
I¡
 
	gSBH_THRESHOLD
 = 4;

161 c⁄° 
I¡
 
	gC1FLAG_NUMBER
 = 8;

162 c⁄° 
I¡
 
	gC2FLAG_NUMBER
 = 1;

164 c⁄° 
I¡
 
	gMAX_NUM_VPS
 = 16;

165 c⁄° 
I¡
 
	gMAX_NUM_SPS
 = 16;

166 c⁄° 
I¡
 
	gMAX_NUM_PPS
 = 64;

169 c⁄° 
I¡
 
	gMLS_GRP_NUM
 = 64;

170 c⁄° 
I¡
 
	gMLS_CG_LOG2_WIDTH
 = 2;

171 c⁄° 
I¡
 
	gMLS_CG_LOG2_HEIGHT
 = 2;

172 c⁄° 
I¡
 
	gMLS_CG_SIZE
 = 4;

174 #i‡
ADAPTIVE_QP_SELECTION


175 c⁄° 
I¡
 
	gARL_C_PRECISION
 = 7;

176 c⁄° 
I¡
 
	gLEVEL_RANGE
 = 30;

179 c⁄° 
I¡
 
	gRVM_VCEGAM10_M
 = 4;

181 c⁄° 
I¡
 
	gFAST_UDI_MAX_RDMODE_NUM
 = 35;

183 c⁄° 
I¡
 
	gNUM_INTRA_MODE
 = 36;

184 c⁄° 
I¡
 
	gPLANAR_IDX
 = 0;

185 c⁄° 
I¡
 
	gVER_IDX
 = 26;

186 c⁄° 
I¡
 
	gHOR_IDX
 = 10;

187 c⁄° 
I¡
 
	gDC_IDX
 = 1;

188 c⁄° 
I¡
 
	gNUM_CHROMA_MODE
 = 5;

189 c⁄° 
I¡
 
	gDM_CHROMA_IDX
 = 36;

191 c⁄° 
I¡
 
	gMDCS_ANGLE_LIMIT
 = 4;

192 c⁄° 
I¡
 
	gMDCS_MAXIMUM_WIDTH
 = 8;

193 c⁄° 
I¡
 
	gMDCS_MAXIMUM_HEIGHT
 = 8;

196 c⁄° 
I¡
 
	gLOG2_MAX_NUM_COLUMNS_MINUS1
 = 7;

197 c⁄° 
I¡
 
	gLOG2_MAX_NUM_ROWS_MINUS1
 = 7;

199 c⁄° 
I¡
 
	gCABAC_INIT_PRESENT_FLAG
 = 1;

201 c⁄° 
I¡
 
	gLUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
 = 4;

202 c⁄° 
I¡
 
	gCHROMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
 = 8;

204 c⁄° 
I¡
 
	gMAX_NUM_LONG_TERM_REF_PICS
 = 33;

205 c⁄° 
I¡
 
	gNUM_LONG_TERM_REF_PIC_SPS
 = 0;

208 c⁄° 
I¡
 
	gMAX_QP_OFFSET_LIST_SIZE
 = 6;

211 c⁄° 
I¡
 
	gLOSSLESS_AND_MIXED_LOSSLESS_RD_COST_TEST_QP
 = 0;

212 c⁄° 
I¡
 
	gLOSSLESS_AND_MIXED_LOSSLESS_RD_COST_TEST_QP_PRIME
 =4;

214 c⁄° 
I¡
 
	gRExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
 = 4;

215 c⁄° 
I¡
 
	gRExt__GOLOMB_RICE_INCREMENT_DIVISOR
 = 4;

217 c⁄° 
I¡
 
	gRExt__PREDICTION_WEIGHTING_ANALYSIS_DC_PRECISION
 = 0;

219 c⁄° 
I¡
 
	gMAX_TIMECODE_SEI_SETS
 = 3;

221 c⁄° 
I¡
 
	gMAX_CU_DEPTH
 = 6;

222 c⁄° 
I¡
 
	gMAX_CU_SIZE
 = 64;

223 c⁄° 
I¡
 
	gMIN_PU_SIZE
 = 4;

224 c⁄° 
I¡
 
	gMIN_TU_SIZE
 = 4;

225 c⁄° 
I¡
 
	gMAX_TU_SIZE
 = 32;

226 c⁄° 
I¡
 
	gMAX_NUM_PART_IDXS_IN_CTU_WIDTH
 = 
MAX_CU_SIZE
/
MIN_PU_SIZE
;

227 c⁄° 
I¡
 
	gSCALING_LIST_REM_NUM
 = 6;

229 c⁄° 
I¡
 
	gQUANT_SHIFT
 = 14;

230 c⁄° 
I¡
 
	gIQUANT_SHIFT
 = 6;

231 c⁄° 
I¡
 
	gSCALE_BITS
 = 15;

233 c⁄° 
I¡
 
	gSCALING_LIST_NUM
 = 
MAX_NUM_COMPONENT
 * 
NUMBER_OF_PREDICTION_MODES
;

235 c⁄° 
I¡
 
	gSCALING_LIST_START_VALUE
 = 8 ;

236 c⁄° 
I¡
 
	gMAX_MATRIX_COEF_NUM
 = 64 ;

237 c⁄° 
I¡
 
	gMAX_MATRIX_SIZE_NUM
 = 8 ;

238 c⁄° 
I¡
 
	gSCALING_LIST_BITS
 = 8 ;

239 c⁄° 
I¡
 
	gLOG2_SCALING_LIST_NEUTRAL_VALUE
 = 4 ;

240 c⁄° 
I¡
 
	gSCALING_LIST_DC
 = 16 ;

242 c⁄° 
I¡
 
	gCONTEXT_STATE_BITS
 = 6 ;

243 c⁄° 
I¡
 
	gLAST_SIGNIFICANT_GROUPS
 = 10 ;

245 c⁄° 
I¡
 
	gMAX_ENCODER_DEBLOCKING_QUALITY_LAYERS
 = 8 ;

247 c⁄° 
UI¡
 
	gLUMA_LEVEL_TO_DQP_LUT_MAXSIZE
 = 1024;

249 #i‡
FGS_RDD5_ENABLE


250 c⁄° 
I¡
 
	gMAX_NUM_INTENSITIES
 = 256;

251 c⁄° 
I¡
 
	gMAX_NUM_MODEL_VALUES
 = 6;

257 
	gãm∂©e
 <
ty≥«me
 
	gT
> 
ölöe
 
T
 
	$Clù3
 (c⁄° 
T
 
möVÆ
, c⁄° T 
maxVÆ
, c⁄° T 
a
Ë{  
°d
::
mö
<T> (°d::
max
<T> (möVÆ,áË, maxVÆ); 
	}
}

258 
	gãm∂©e
 <
ty≥«me
 
	gT
> 
ölöe
 
T
 
	$ClùBD
(c⁄° 
T
 
x
, c⁄° 
I¡
 
bôDïth
Ë{  
	`Clù3
(
	`T
(0), T((1 << bôDïth)-1), x); 
	}
}

260 
	gãm∂©e
 <
ty≥«me
 
	gT
> 
ölöe
 
Void
 
	$Check3
–
T
 
möVÆ
, T 
maxVÆ
, T 
a
)

262 i‡((
a
 > 
maxVÆ
Ë|| (®< 
möVÆ
))

264 
°d
::
˚º
 << "ERROR: R™gêcheck " << 
möVÆ
 << " >" << 
a
 << " <" << 
maxVÆ
 << " faûed" << std::
ídl
;

265 
	`as£π
(
Ál£
);

266 
	`exô
(1);

268 
	}
}

270 
	#DATA_ALIGN
 1

271 #i‡ 
DATA_ALIGN
 && 
_WIN32
 && ( 
_MSC_VER
 > 1300 )

	)

272 
	#xMÆloc
–
ty≥
, 
Àn
 ) 
	`_Æig√d_mÆloc
–—y≥)*÷í), 32 )

	)

273 
	#xFªe
–
±r
 ) 
	`_Æig√d_‰ì
 (Öå )

	)

275 
	#xMÆloc
–
ty≥
, 
Àn
 ) 
	`mÆloc
 ( —y≥)*÷íË)

	)

276 
	#xFªe
–
±r
 ) 
	`‰ì
 (Öå )

	)

279 
	#FATAL_ERROR_0
(
MESSAGE
, 
EXITCODE
) \

281 
	`¥ötf
(
MESSAGE
); \

282 
	`exô
(
EXITCODE
); \

283 }

	)

285 
	gãm∂©e
 <
ty≥«me
 
	gVÆueTy≥
> 
ölöe
 
VÆueTy≥
 
	$À·Shi·
 (c⁄° 
VÆueTy≥
 
vÆue
, c⁄° 
I¡
 
shi·
Ë{  (shi· >0Ë? ( vÆuê<< shi·Ë: ( vÆuê>> -shi·); 
	}
}

286 
	gãm∂©e
 <
ty≥«me
 
	gVÆueTy≥
> 
ölöe
 
VÆueTy≥
 
	$rightShi·
 (c⁄° 
VÆueTy≥
 
vÆue
, c⁄° 
I¡
 
shi·
Ë{  (shi· >0Ë? ( vÆuê>> shi·Ë: ( vÆuê<< -shi·); 
	}
}

287 
	gãm∂©e
 <
ty≥«me
 
	gVÆueTy≥
> 
ölöe
 
VÆueTy≥
 
	$À·Shi·_round
 (c⁄° 
VÆueTy≥
 
vÆue
, c⁄° 
I¡
 
shi·
Ë{  (shi· >0Ë? ( vÆuê<< shi·Ë: ((vÆuê+ (
	`VÆueTy≥
(1Ë<< (-shi· - 1))Ë>> -shi·); 
	}
}

288 
	gãm∂©e
 <
ty≥«me
 
	gVÆueTy≥
> 
ölöe
 
VÆueTy≥
 
	$rightShi·_round
(c⁄° 
VÆueTy≥
 
vÆue
, c⁄° 
I¡
 
shi·
Ë{  (shi· >0Ë? ((vÆuê+ (
	`VÆueTy≥
(1Ë<< (shi· - 1))Ë>> shi·Ë: ( vÆuê<< -shi·); 
	}
}

289 #i‡
O0043_BEST_EFFORT_DECODING


294 
	gãm∂©e
 <
ty≥«me
 
	gVÆueTy≥
> 
ölöe
 
VÆueTy≥
 
	$rightShi·EvíRoundög
(c⁄° 
VÆueTy≥
 
vÆue
, c⁄° 
UI¡
 
shi·
Ë{  (shi· =0Ë? vÆuê: ((vÆuê+ (1<<(shi·-1))-1 + ((vÆue>>shi·)&1)Ë>> shi·Ë; 
	}
}

	@TLibCommon/ContextModel.cpp

38 
	~<Æg‹ôhm
>

40 
	~"C⁄ãxtModñ.h
"

42 
usög
 
«me•a˚
 
	g°d
;

56 
Void
 
	gC⁄ãxtModñ
::
	$öô
–
I¡
 
qp
, I¡ 
öôVÆue
 )

58 
qp
 = 
	`Clù3
(0, 51, qp);

60 
I¡
 
¶›e
 = (
öôVÆue
>>4)*5 - 45;

61 
I¡
 
off£t
 = ((
öôVÆue
&15)<<3)-16;

62 
I¡
 
öôSèã
 = 
	`mö
–
	`max
–1, ( ( ( 
¶›e
 * 
qp
 ) >> 4 ) + 
off£t
 ) ), 126 );

63 
UI¡
 
mpSèã
 = (
öôSèã
 >= 64 );

64 
m_ucSèã
 = ( (
mpSèã
? (
öôSèã
 - 64):(63 - initState)) <<1) + mpState;

65 
	}
}

67 c⁄° 
UCh¨
 
	gC⁄ãxtModñ
::
m_aucNextSèãMPS
[ 
C⁄ãxtModñ
::
m_tŸÆSèãs
 ] =

79 c⁄° 
UCh¨
 
	gC⁄ãxtModñ
::
m_aucNextSèãLPS
[ 
C⁄ãxtModñ
::
m_tŸÆSèãs
 ] =

91 #i‡
FAST_BIT_EST


92 
UCh¨
 
	gC⁄ãxtModñ
::
m_√xtSèã
[ 
C⁄ãxtModñ
::
m_tŸÆSèãs
 ][2 ];

94 
Void
 
	gC⁄ãxtModñ
::
	$buûdNextSèãTabÀ
()

96 
I¡
 
i
 = 0; i < 
C⁄ãxtModñ
::
m_tŸÆSèãs
; i++)

98 
I¡
 
j
 = 0; j < 2; j++)

100 
m_√xtSèã
[
i
][
j
] = ((i&1Ë=jË? 
m_aucNextSèãMPS
[i] : 
m_aucNextSèãLPS
[i];

103 
	}
}

106 c⁄° 
I¡
 
	gC⁄ãxtModñ
::
m_íå›yBôs
[ 
C⁄ãxtModñ
::
m_tŸÆSèãs
 ] =

108 #i‡
FAST_BIT_EST


	@TLibCommon/ContextModel.h

39 #i‚de‡
__CONTEXTMODEL__


40 
	#__CONTEXTMODEL__


	)

42 #i‡
_MSC_VER
 > 1000

43 #¥agm®
⁄˚


46 
	~"Comm⁄Def.h
"

47 
	~"TComRom.h
"

57 ˛as†
	cC⁄ãxtModñ


59 
	mpublic
:

60 
	$C⁄ãxtModñ
 (Ë{ 
m_ucSèã
 = 0; 
m_bösCoded
 = 0; }

61 ~
	$C⁄ãxtModñ
 (Ë{
	}
}

63 
UCh¨
 
	$gëSèã
 (Ë{  ( 
m_ucSèã
 >> 1 ); 
	}
}

64 
UCh¨
 
	$gëMps
 (Ë{  ( 
m_ucSèã
 & 1 ); 
	}
}

65 
Void
 
	$£tSèãAndMps
–
UCh¨
 
ucSèã
, UCh¨ 
ucMPS
Ë{ 
m_ucSèã
 = (ucSèã << 1Ë+ ucMPS; 
	}
}

67 
Void
 
öô
 ( 
I¡
 
qp
, I¡ 
öôVÆue
 );

69 
Void
 
	$upd©eLPS
 ()

71 
m_ucSèã
 = 
m_aucNextSèãLPS
[ m_ucState ];

72 
	}
}

74 
Void
 
	$upd©eMPS
 ()

76 
m_ucSèã
 = 
m_aucNextSèãMPS
[ m_ucState ];

77 
	}
}

79 
I¡
 
	$gëE¡r›yBôs
(
Sh‹t
 
vÆ
Ë{  
m_íå›yBôs
[
m_ucSèã
 ^ vÆ]; 
	}
}

81 #i‡
FAST_BIT_EST


82 
Void
 
	$upd©e
–
I¡
 
böVÆ
 )

84 
m_ucSèã
 = 
m_√xtSèã
[m_ucSèã][
böVÆ
];

85 
	}
}

86 
Void
 
buûdNextSèãTabÀ
();

87 
I¡
 
	$gëE¡r›yBôsTrm
–
I¡
 
vÆ
 ) {  
m_íå›yBôs
[126 ^ vÆ]; 
	}
}

89 
Void
 
	$£tBösCoded
(
UI¡
 
vÆ
Ë{ 
m_bösCoded
 = vÆ; 
	}
}

90 
UI¡
 
	$gëBösCoded
(Ë{  
m_bösCoded
; 
	}
}

92 
	g¥iv©e
:

93 
UCh¨
 
m_ucSèã
;

95 c⁄° 
UI¡
 
	gm_tŸÆSèãs
 = (1 << 
CONTEXT_STATE_BITS
) * 2;

96 c⁄° 
UCh¨
 
	gm_aucNextSèãMPS
[
m_tŸÆSèãs
];

97 c⁄° 
UCh¨
 
	gm_aucNextSèãLPS
[
m_tŸÆSèãs
];

98 c⁄° 
I¡
 
	gm_íå›yBôs
 [
m_tŸÆSèãs
];

99 #i‡
FAST_BIT_EST


100 
UCh¨
 
	gm_√xtSèã
[
m_tŸÆSèãs
][2 ];

102 
UI¡
 
	gm_bösCoded
;

	@TLibCommon/ContextModel3DBuffer.cpp

38 
	~"C⁄ãxtModñ3DBuf„r.h
"

47 
	gC⁄ãxtModñ3DBuf„r
::
	$C⁄ãxtModñ3DBuf„r
–
UI¡
 
uiSizeZ
, UI¡ 
uiSizeY
, UI¡ 
uiSizeX
, 
C⁄ãxtModñ
 *
ba£På
, 
I¡
 &
cou¡
 )

48 : 
	`m_sizeX
 ( 
uiSizeX
 )

49 , 
	`m_sizeXY
 ( 
uiSizeX
 * 
uiSizeY
 )

50 , 
	$m_sizeXYZ
–
uiSizeX
 * 
uiSizeY
 * 
uiSizeZ
 )

53 
m_c⁄ãxtModñ
 = 
ba£På
;

54 
cou¡
 +
m_sizeXYZ
;

55 
	}
}

68 
Void
 
	gC⁄ãxtModñ3DBuf„r
::
	$öôBuf„r
–
Sli˚Ty≥
 
¶i˚Ty≥
, 
I¡
 
qp
, 
UCh¨
* 
˘xModñ
 )

70 
˘xModñ
 +
¶i˚Ty≥
 * 
m_sizeXYZ
;

72  
I¡
 
n
 = 0;Ç < 
m_sizeXYZ
;Ç++ )

74 
m_c⁄ãxtModñ
[ 
n
 ].
	`öô
–
qp
, 
˘xModñ
[Ç ] );

75 
m_c⁄ãxtModñ
[ 
n
 ].
	`£tBösCoded
( 0 );

77 
	}
}

86 
UI¡
 
	gC⁄ãxtModñ3DBuf„r
::
	$ˇlcCo°
–
Sli˚Ty≥
 
¶i˚Ty≥
, 
I¡
 
qp
, 
UCh¨
* 
˘xModñ
 )

88 
UI¡
 
co°
 = 0;

89 
˘xModñ
 +
¶i˚Ty≥
 * 
m_sizeXYZ
;

91  
I¡
 
n
 = 0;Ç < 
m_sizeXYZ
;Ç++ )

93 
C⁄ãxtModñ
 
tmpC⁄ãxtModñ
;

94 
tmpC⁄ãxtModñ
.
	`öô
–
qp
, 
˘xModñ
[ 
n
 ] );

97 c⁄° 
DoubÀ
 
aSèãToProbLPS
[] = {0.50000000, 0.47460857, 0.45050660, 0.42762859, 0.40591239, 0.38529900, 0.36573242, 0.34715948, 0.32952974, 0.31279528, 0.29691064, 0.28183267, 0.26752040, 0.25393496, 0.24103941, 0.22879875, 0.21717969, 0.20615069, 0.19568177, 0.18574449, 0.17631186, 0.16735824, 0.15885931, 0.15079198, 0.14313433, 0.13586556, 0.12896592, 0.12241667, 0.11620000, 0.11029903, 0.10469773, 0.09938088, 0.09433404, 0.08954349, 0.08499621, 0.08067986, 0.07658271, 0.07269362, 0.06900203, 0.06549791, 0.06217174, 0.05901448, 0.05601756, 0.05317283, 0.05047256, 0.04790942, 0.04547644, 0.04316702, 0.04097487, 0.03889405, 0.03691890, 0.03504406, 0.03326442, 0.03157516, 0.02997168, 0.02844963, 0.02700488, 0.02563349, 0.02433175, 0.02309612, 0.02192323, 0.02080991, 0.01975312, 0.01875000};

99 
DoubÀ
 
¥obLPS
 = 
aSèãToProbLPS
[ 
m_c⁄ãxtModñ
[ 
n
 ].
	`gëSèã
() ];

100 
DoubÀ
 
¥ob0
, 
¥ob1
;

101 i‡(
m_c⁄ãxtModñ
[ 
n
 ].
	`gëMps
()==1)

103 
¥ob0
 = 
¥obLPS
;

104 
¥ob1
 = 1.0-
¥ob0
;

108 
¥ob1
 = 
¥obLPS
;

109 
¥ob0
 = 1.0-
¥ob1
;

112 i‡(
m_c⁄ãxtModñ
[ 
n
 ].
	`gëBösCoded
()>0)

114 
co°
 +(
UI¡
Ë(
¥ob0
 * 
tmpC⁄ãxtModñ
.
	`gëE¡r›yBôs
–0 ) + 
¥ob1
 *ÅmpContextModel.getEntropyBits( 1 ));

118  
co°
;

119 
	}
}

	@TLibCommon/ContextModel3DBuffer.h

38 #i‚de‡
__CONTEXTMODEL3DBUFFER__


39 
	#__CONTEXTMODEL3DBUFFER__


	)

41 
	~<°dio.h
>

42 
	~<mem‹y.h
>

44 
	~"Comm⁄Def.h
"

45 
	~"C⁄ãxtModñ.h
"

55 ˛as†
	cC⁄ãxtModñ3DBuf„r


57 
	m¥Ÿe˘ed
:

58 
C⁄ãxtModñ
* 
m_c⁄ãxtModñ
;

59 c⁄° 
UI¡
 
	mm_sizeX
;

60 c⁄° 
UI¡
 
	mm_sizeXY
;

61 c⁄° 
UI¡
 
	mm_sizeXYZ
;

63 
	mpublic
:

64 
C⁄ãxtModñ3DBuf„r
 ( 
UI¡
 
uiSizeZ
, UI¡ 
uiSizeY
, UI¡ 
uiSizeX
, 
C⁄ãxtModñ
 *
ba£På
, 
I¡
 &
cou¡
 );

65 ~
	$C⁄ãxtModñ3DBuf„r
 () {}

68 
C⁄ãxtModñ
& 
	$gë
–
UI¡
 
uiZ
, UI¡ 
uiY
, UI¡ 
uiX
 )

70  
m_c⁄ãxtModñ
[ 
uiZ
 * 
m_sizeXY
 + 
uiY
 * 
m_sizeX
 + 
uiX
 ];

71 
	}
}

72 
C⁄ãxtModñ
* 
	$gë
–
UI¡
 
uiZ
, UI¡ 
uiY
 )

74  &
m_c⁄ãxtModñ
[ 
uiZ
 * 
m_sizeXY
 + 
uiY
 * 
m_sizeX
 ];

75 
	}
}

76 
C⁄ãxtModñ
* 
	$gë
–
UI¡
 
uiZ
 )

78  &
m_c⁄ãxtModñ
[ 
uiZ
 * 
m_sizeXY
 ];

79 
	}
}

82 
Void
 
öôBuf„r
–
Sli˚Ty≥
 
eSli˚Ty≥
, 
I¡
 
iQp
, 
UCh¨
* 
˘xModñ
 );

84 
UI¡
 
ˇlcCo°
–
Sli˚Ty≥
 
¶i˚Ty≥
, 
I¡
 
qp
, 
UCh¨
* 
˘xModñ
 );

88 
Void
 
	$c›yFrom
–c⁄° 
C⁄ãxtModñ3DBuf„r
* 
§c
 )

90 
	`as£π
–
m_sizeXYZ
 =
§c
->m_sizeXYZ );

91 ::
	`mem˝y
–
m_c⁄ãxtModñ
, 
§c
->m_c⁄ãxtModñ, (
C⁄ãxtModñ
Ë* 
m_sizeXYZ
 );

92 
	}
}

	@TLibCommon/ContextTables.h

39 #i‚de‡
__CONTEXTTABLES__


40 
	#__CONTEXTTABLES__


	)

49 
	#MAX_NUM_CTX_MOD
 512

50 

	)

51 
	#NUM_SPLIT_FLAG_CTX
 3

52 
	#NUM_SKIP_FLAG_CTX
 3

53 

	)

54 
	#NUM_MERGE_FLAG_EXT_CTX
 1

55 
	#NUM_MERGE_IDX_EXT_CTX
 1

56 

	)

57 
	#NUM_PART_SIZE_CTX
 4

58 
	#NUM_PRED_MODE_CTX
 1

59 

	)

60 
	#NUM_INTRA_PREDICT_CTX
 1

61 

	)

62 
	#NUM_CHROMA_PRED_CTX
 2

63 
	#NUM_INTER_DIR_CTX
 5

64 
	#NUM_MV_RES_CTX
 2

65 
	#NUM_CHROMA_QP_ADJ_FLAG_CTX
 1

66 
	#NUM_CHROMA_QP_ADJ_IDC_CTX
 1

67 

	)

68 
	#NUM_REF_NO_CTX
 2

69 
	#NUM_TRANS_SUBDIV_FLAG_CTX
 3

70 
	#NUM_QT_ROOT_CBF_CTX
 1

71 
	#NUM_DELTA_QP_CTX
 3

72 

	)

73 
	#NUM_SIG_CG_FLAG_CTX
 2

74 
	#NUM_EXPLICIT_RDPCM_FLAG_CTX
 1

75 
	#NUM_EXPLICIT_RDPCM_DIR_CTX
 1

76 

	)

81 
	#NUM_SIG_FLAG_CTX_LUMA
 28

82 
	#NUM_SIG_FLAG_CTX_CHROMA
 16

83 

	)

85 c⁄° 
UI¡
 
	gsignifiˇn˚M≠C⁄ãxtSëSèπ
 [
MAX_NUM_CHANNEL_TYPE
][
CONTEXT_NUMBER_OF_TYPES
] = { {0, 9, 21, 27}, {0, 9, 12, 15} };

86 c⁄° 
UI¡
 
	gsignifiˇn˚M≠C⁄ãxtSëSize
 [
MAX_NUM_CHANNEL_TYPE
][
CONTEXT_NUMBER_OF_TYPES
] = { {9, 12, 6, 1}, {9, 3, 3, 1} };

87 c⁄° 
UI¡
 
	gn⁄Düg⁄ÆSˇn8x8C⁄ãxtOff£t
 [
MAX_NUM_CHANNEL_TYPE
] = { 6, 0 };

88 c⁄° 
UI¡
 
	gnŸFú°GroupNeighbourhoodC⁄ãxtOff£t
[
MAX_NUM_CHANNEL_TYPE
] = { 3, 0 };

92 
	#NEIGHBOURHOOD_00_CONTEXT_1_THRESHOLD_4x4
 3

	)

93 
	#NEIGHBOURHOOD_00_CONTEXT_2_THRESHOLD_4x4
 1

	)

97 
	#FIRST_SIG_FLAG_CTX_LUMA
 0

	)

98 
	#FIRST_SIG_FLAG_CTX_CHROMA
 (
FIRST_SIG_FLAG_CTX_LUMA
 + 
NUM_SIG_FLAG_CTX_LUMA
)

	)

100 
	#NUM_SIG_FLAG_CTX
 (
NUM_SIG_FLAG_CTX_LUMA
 + 
NUM_SIG_FLAG_CTX_CHROMA
)

101 

	)

106 
	#NUM_CTX_LAST_FLAG_SETS
 2

	)

108 
	#NUM_CTX_LAST_FLAG_XY
 15

109 

	)

114 
	#NUM_ONE_FLAG_CTX_PER_SET
 4

115 
	#NUM_ABS_FLAG_CTX_PER_SET
 1

116 

	)

119 
	#NUM_CTX_SETS_LUMA
 4

120 
	#NUM_CTX_SETS_CHROMA
 2

121 

	)

122 
	#FIRST_CTX_SET_LUMA
 0

123 

	)

126 
	#NUM_ONE_FLAG_CTX_LUMA
 (
NUM_ONE_FLAG_CTX_PER_SET
 * 
NUM_CTX_SETS_LUMA
)

127 
	#NUM_ONE_FLAG_CTX_CHROMA
 (
NUM_ONE_FLAG_CTX_PER_SET
 * 
NUM_CTX_SETS_CHROMA
)

128 

	)

129 
	#NUM_ABS_FLAG_CTX_LUMA
 (
NUM_ABS_FLAG_CTX_PER_SET
 * 
NUM_CTX_SETS_LUMA
)

130 
	#NUM_ABS_FLAG_CTX_CHROMA
 (
NUM_ABS_FLAG_CTX_PER_SET
 * 
NUM_CTX_SETS_CHROMA
)

131 

	)

132 
	#NUM_ONE_FLAG_CTX
 (
NUM_ONE_FLAG_CTX_LUMA
 + 
NUM_ONE_FLAG_CTX_CHROMA
)

133 
	#NUM_ABS_FLAG_CTX
 (
NUM_ABS_FLAG_CTX_LUMA
 + 
NUM_ABS_FLAG_CTX_CHROMA
)

134 

	)

135 
	#FIRST_CTX_SET_CHROMA
 (
FIRST_CTX_SET_LUMA
 + 
NUM_CTX_SETS_LUMA
)

136 

	)

141 
	#NUM_QT_CBF_CTX_SETS
 2

	)

143 
	#NUM_QT_CBF_CTX_PER_SET
 5

144 

	)

145 
	#FIRST_CBF_CTX_LUMA
 0

146 

	)

147 
	#FIRST_CBF_CTX_CHROMA
 (
FIRST_CBF_CTX_LUMA
 + 
NUM_QT_CBF_CTX_PER_SET
)

148 

	)

152 
	#NUM_MVP_IDX_CTX
 1

153 

	)

154 
	#NUM_SAO_MERGE_FLAG_CTX
 1

155 
	#NUM_SAO_TYPE_IDX_CTX
 1

156 

	)

157 
	#NUM_TRANSFORMSKIP_FLAG_CTX
 1

158 

	)

159 
	#NUM_CU_TRANSQUANT_BYPASS_FLAG_CTX
 1

	)

161 
	#NUM_CROSS_COMPONENT_PREDICTION_CTX
 10

	)

163 
	#CNU
 154

164 

	)

171 c⁄° 
UCh¨


172 
	gINIT_CU_TRANSQUANT_BYPASS_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_CU_TRANSQUANT_BYPASS_FLAG_CTX
] =

180 c⁄° 
UCh¨


181 
	gINIT_SPLIT_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_SPLIT_FLAG_CTX
] =

188 c⁄° 
UCh¨


189 
	gINIT_SKIP_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_SKIP_FLAG_CTX
] =

193 { 
CNU
, CNU, CNU, },

196 c⁄° 
UCh¨


197 
	gINIT_MERGE_FLAG_EXT
[
NUMBER_OF_SLICE_TYPES
][
NUM_MERGE_FLAG_EXT_CTX
] =

201 { 
CNU
, },

204 c⁄° 
UCh¨


205 
	gINIT_MERGE_IDX_EXT
[
NUMBER_OF_SLICE_TYPES
][
NUM_MERGE_IDX_EXT_CTX
] =

209 { 
CNU
, },

212 c⁄° 
UCh¨


213 
	gINIT_PART_SIZE
[
NUMBER_OF_SLICE_TYPES
][
NUM_PART_SIZE_CTX
] =

217 { 184, 
CNU
, CNU, CNU },

220 c⁄° 
UCh¨


221 
	gINIT_PRED_MODE
[
NUMBER_OF_SLICE_TYPES
][
NUM_PRED_MODE_CTX
] =

225 { 
CNU
, },

228 c⁄° 
UCh¨


229 
	gINIT_INTRA_PRED_MODE
[
NUMBER_OF_SLICE_TYPES
][
NUM_INTRA_PREDICT_CTX
] =

236 c⁄° 
UCh¨


237 
	gINIT_CHROMA_PRED_MODE
[
NUMBER_OF_SLICE_TYPES
][
NUM_CHROMA_PRED_CTX
] =

244 c⁄° 
UCh¨


245 
	gINIT_INTER_DIR
[
NUMBER_OF_SLICE_TYPES
][
NUM_INTER_DIR_CTX
] =

249 { 
CNU
, CNU, CNU, CNU, CNU, },

252 c⁄° 
UCh¨


253 
	gINIT_MVD
[
NUMBER_OF_SLICE_TYPES
][
NUM_MV_RES_CTX
] =

257 { 
CNU
, CNU, },

260 c⁄° 
UCh¨


261 
	gINIT_REF_PIC
[
NUMBER_OF_SLICE_TYPES
][
NUM_REF_NO_CTX
] =

265 { 
CNU
, CNU },

268 c⁄° 
UCh¨


269 
	gINIT_DQP
[
NUMBER_OF_SLICE_TYPES
][
NUM_DELTA_QP_CTX
] =

276 c⁄° 
UCh¨


277 
	gINIT_CHROMA_QP_ADJ_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_CHROMA_QP_ADJ_FLAG_CTX
] =

284 c⁄° 
UCh¨


285 
	gINIT_CHROMA_QP_ADJ_IDC
[
NUMBER_OF_SLICE_TYPES
][
NUM_CHROMA_QP_ADJ_IDC_CTX
] =

297 
	#BSLICE_LUMA_CBF_CONTEXT
 153, 111, 
CNU
, CNU, 
	)
CNU

298 
	#PSLICE_LUMA_CBF_CONTEXT
 153, 111, 
CNU
, CNU, 
	)
CNU

299 
	#ISLICE_LUMA_CBF_CONTEXT
 111, 141, 
CNU
, CNU, 
	)
CNU

301 
	#BSLICE_CHROMA_CBF_CONTEXT
 149, 92, 167, 154, 154

	)

302 
	#PSLICE_CHROMA_CBF_CONTEXT
 149, 107, 167, 154, 154

	)

303 
	#ISLICE_CHROMA_CBF_CONTEXT
 94, 138, 182, 154, 154

	)

306 c⁄° 
UCh¨


307 
	gINIT_QT_CBF
[
NUMBER_OF_SLICE_TYPES
][
NUM_QT_CBF_CTX_SETS
 * 
NUM_QT_CBF_CTX_PER_SET
] =

309 { 
BSLICE_LUMA_CBF_CONTEXT
, 
BSLICE_CHROMA_CBF_CONTEXT
 },

310 { 
PSLICE_LUMA_CBF_CONTEXT
, 
PSLICE_CHROMA_CBF_CONTEXT
 },

311 { 
ISLICE_LUMA_CBF_CONTEXT
, 
ISLICE_CHROMA_CBF_CONTEXT
 },

317 c⁄° 
UCh¨


318 
	gINIT_QT_ROOT_CBF
[
NUMBER_OF_SLICE_TYPES
][
NUM_QT_ROOT_CBF_CTX
] =

322 { 
CNU
, },

331 
	#BSLICE_LUMA_LAST_POSITION_CONTEXT
 125, 110, 124, 110, 95, 94, 125, 111, 111, 79, 125, 126, 111, 111, 79

	)

332 
	#PSLICE_LUMA_LAST_POSITION_CONTEXT
 125, 110, 94, 110, 95, 79, 125, 111, 110, 78, 110, 111, 111, 95, 94

	)

333 
	#ISLICE_LUMA_LAST_POSITION_CONTEXT
 110, 110, 124, 125, 140, 153, 125, 127, 140, 109, 111, 143, 127, 111, 79

	)

335 
	#BSLICE_CHROMA_LAST_POSITION_CONTEXT
 108, 123, 93, 
CNU
, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, 
	)
CNU

336 
	#PSLICE_CHROMA_LAST_POSITION_CONTEXT
 108, 123, 108, 
CNU
, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, 
	)
CNU

337 
	#ISLICE_CHROMA_LAST_POSITION_CONTEXT
 108, 123, 63, 
CNU
, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, CNU, 
	)
CNU

340 c⁄° 
UCh¨


341 
	gINIT_LAST
[
NUMBER_OF_SLICE_TYPES
][
NUM_CTX_LAST_FLAG_SETS
 * 
NUM_CTX_LAST_FLAG_XY
] =

343 { 
BSLICE_LUMA_LAST_POSITION_CONTEXT
, 
BSLICE_CHROMA_LAST_POSITION_CONTEXT
 },

344 { 
PSLICE_LUMA_LAST_POSITION_CONTEXT
, 
PSLICE_CHROMA_LAST_POSITION_CONTEXT
 },

345 { 
ISLICE_LUMA_LAST_POSITION_CONTEXT
, 
ISLICE_CHROMA_LAST_POSITION_CONTEXT
 },

351 c⁄° 
UCh¨


352 
	gINIT_SIG_CG_FLAG
[
NUMBER_OF_SLICE_TYPES
][2 * 
NUM_SIG_CG_FLAG_CTX
] =

372 
	#BSLICE_LUMA_SIGNIFICANCE_CONTEXT
 170, 154, 139, 153, 139, 123, 123, 63, 124, 166, 183, 140, 136, 153, 154, 166, 183, 140, 136, 153, 154, 166, 183, 140, 136, 153, 154, 140

	)

373 
	#PSLICE_LUMA_SIGNIFICANCE_CONTEXT
 155, 154, 139, 153, 139, 123, 123, 63, 153, 166, 183, 140, 136, 153, 154, 166, 183, 140, 136, 153, 154, 166, 183, 140, 136, 153, 154, 140

	)

374 
	#ISLICE_LUMA_SIGNIFICANCE_CONTEXT
 111, 111, 125, 110, 110, 94, 124, 108, 124, 107, 125, 141, 179, 153, 125, 107, 125, 141, 179, 153, 125, 107, 125, 141, 179, 153, 125, 141

	)

377 
	#BSLICE_CHROMA_SIGNIFICANCE_CONTEXT
 170, 153, 138, 138, 122, 121, 122, 121, 167, 151, 183, 140, 151, 183, 140, 140

	)

378 
	#PSLICE_CHROMA_SIGNIFICANCE_CONTEXT
 170, 153, 123, 123, 107, 121, 107, 121, 167, 151, 183, 140, 151, 183, 140, 140

	)

379 
	#ISLICE_CHROMA_SIGNIFICANCE_CONTEXT
 140, 139, 182, 182, 152, 136, 152, 136, 153, 136, 139, 111, 136, 139, 111, 111

	)

383 c⁄° 
UCh¨


384 
	gINIT_SIG_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_SIG_FLAG_CTX
] =

386 { 
BSLICE_LUMA_SIGNIFICANCE_CONTEXT
, 
BSLICE_CHROMA_SIGNIFICANCE_CONTEXT
 },

387 { 
PSLICE_LUMA_SIGNIFICANCE_CONTEXT
, 
PSLICE_CHROMA_SIGNIFICANCE_CONTEXT
 },

388 { 
ISLICE_LUMA_SIGNIFICANCE_CONTEXT
, 
ISLICE_CHROMA_SIGNIFICANCE_CONTEXT
 },

397 
	#BSLICE_LUMA_ONE_CONTEXT
 154, 196, 167, 167, 154, 152, 167, 182, 182, 134, 149, 136, 153, 121, 136, 122

	)

398 
	#PSLICE_LUMA_ONE_CONTEXT
 154, 196, 196, 167, 154, 152, 167, 182, 182, 134, 149, 136, 153, 121, 136, 137

	)

399 
	#ISLICE_LUMA_ONE_CONTEXT
 140, 92, 137, 138, 140, 152, 138, 139, 153, 74, 149, 92, 139, 107, 122, 152

	)

401 
	#BSLICE_LUMA_ABS_CONTEXT
 107, 167, 91, 107

	)

402 
	#PSLICE_LUMA_ABS_CONTEXT
 107, 167, 91, 122

	)

403 
	#ISLICE_LUMA_ABS_CONTEXT
 138, 153, 136, 167

	)

406 
	#BSLICE_CHROMA_ONE_CONTEXT
 169, 208, 166, 167, 154, 152, 167, 182

	)

407 
	#PSLICE_CHROMA_ONE_CONTEXT
 169, 194, 166, 167, 154, 167, 137, 182

	)

408 
	#ISLICE_CHROMA_ONE_CONTEXT
 140, 179, 166, 182, 140, 227, 122, 197

	)

410 
	#BSLICE_CHROMA_ABS_CONTEXT
 107, 167

	)

411 
	#PSLICE_CHROMA_ABS_CONTEXT
 107, 167

	)

412 
	#ISLICE_CHROMA_ABS_CONTEXT
 152, 152

	)

417 c⁄° 
UCh¨


418 
	gINIT_ONE_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_ONE_FLAG_CTX
] =

420 { 
BSLICE_LUMA_ONE_CONTEXT
, 
BSLICE_CHROMA_ONE_CONTEXT
 },

421 { 
PSLICE_LUMA_ONE_CONTEXT
, 
PSLICE_CHROMA_ONE_CONTEXT
 },

422 { 
ISLICE_LUMA_ONE_CONTEXT
, 
ISLICE_CHROMA_ONE_CONTEXT
 },

425 c⁄° 
UCh¨


426 
	gINIT_ABS_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_ABS_FLAG_CTX
] =

428 { 
BSLICE_LUMA_ABS_CONTEXT
, 
BSLICE_CHROMA_ABS_CONTEXT
 },

429 { 
PSLICE_LUMA_ABS_CONTEXT
, 
PSLICE_CHROMA_ABS_CONTEXT
 },

430 { 
ISLICE_LUMA_ABS_CONTEXT
, 
ISLICE_CHROMA_ABS_CONTEXT
 },

436 c⁄° 
UCh¨


437 
	gINIT_MVP_IDX
[
NUMBER_OF_SLICE_TYPES
][
NUM_MVP_IDX_CTX
] =

441 { 
CNU
, },

444 c⁄° 
UCh¨


445 
	gINIT_SAO_MERGE_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_SAO_MERGE_FLAG_CTX
] =

452 c⁄° 
UCh¨


453 
	gINIT_SAO_TYPE_IDX
[
NUMBER_OF_SLICE_TYPES
][
NUM_SAO_TYPE_IDX_CTX
] =

460 c⁄° 
UCh¨


461 
	gINIT_TRANS_SUBDIV_FLAG
[
NUMBER_OF_SLICE_TYPES
][
NUM_TRANS_SUBDIV_FLAG_CTX
] =

468 c⁄° 
UCh¨


469 
	gINIT_TRANSFORMSKIP_FLAG
[
NUMBER_OF_SLICE_TYPES
][2*
NUM_TRANSFORMSKIP_FLAG_CTX
] =

476 c⁄° 
UCh¨


477 
	gINIT_EXPLICIT_RDPCM_FLAG
[
NUMBER_OF_SLICE_TYPES
][2*
NUM_EXPLICIT_RDPCM_FLAG_CTX
] =

481 {
CNU
, CNU}

484 c⁄° 
UCh¨


485 
	gINIT_EXPLICIT_RDPCM_DIR
[
NUMBER_OF_SLICE_TYPES
][2*
NUM_EXPLICIT_RDPCM_DIR_CTX
] =

489 {
CNU
, CNU}

492 c⁄° 
UCh¨


493 
	gINIT_CROSS_COMPONENT_PREDICTION
[
NUMBER_OF_SLICE_TYPES
][
NUM_CROSS_COMPONENT_PREDICTION_CTX
] =

	@TLibCommon/Debug.cpp

38 
	~"Debug.h
"

39 
	~<Æg‹ôhm
>

40 
	~<m©h.h
>

41 
	~"TComD©aCU.h
"

42 
	~"TComPic.h
"

43 
	~"TComYuv.h
"

45 c⁄° 
UI¡
 
	g£âögNameWidth
 = 66;

46 c⁄° 
UI¡
 
	g£âögHñpWidth
 = 84;

47 c⁄° 
UI¡
 
	g£âögVÆueWidth
 = 3;

49 #i‡
DEBUG_STRING


51 c⁄° 
TCh¨
 *
	gdebug_ª‹dî_d©a_öãr_tokí
[
MAX_NUM_COMPONENT
+1]

53 c⁄° 
TCh¨
 *
	g∑πSizeToSåög
[
NUMBER_OF_PART_SIZES
]={"2Nx2N(0)", "2NxN(1)", "Nx2N(2)", "NxN(3)", "2Nx(N/2+3N/2)(4)", "2Nx(3N/2+N/2)(5)", "(N/2+3N/2)x2N(6)", "(3N/2+N/2)x2N(7)"};

60 
	g°d
::
li°
<
°d
::
∑ú
<°d::
°rög
, std::°rög> > &
EnvV¨
::
	$gëEnvV¨Li°
()

62 
°d
::
li°
<°d::
∑ú
<°d::
°rög
, std::°rög> > 
v¨InfoLi°
;

63  
v¨InfoLi°
;

64 
	}
}

66 
	g°d
::
li°
<
EnvV¨
*> &EnvV¨::
	$gëEnvV¨InU£
()

68 
°d
::
li°
<
EnvV¨
*> 
v¨InU£Li°
;

69  
v¨InU£Li°
;

70 
	}
}

72 
ölöe
 
Void
 
¥ötPaú
(c⁄° 
°d
::
∑ú
<°d::
°rög
, std::°rög> &
p
)

74 i‡(
p
.
£c⁄d
=="")

76 
°d
::
cout
 << "\n" << std::
£tw
(
£âögNameWidth
Ë<< 
p
.
fú°
 << "\n" << std::
ídl
;

80 
	g°d
::
cout
 << 
°d
::
£tw
(
£âögNameWidth
Ë<< 
p
.
fú°
 << ": " <<Ö.
£c⁄d
 << "\n" << std::
ídl
;

84 
ölöe
 
Void
 
	$¥ötVÆ
(c⁄° 
EnvV¨
* 
ív
)

86 
°d
::
cout
 << std::
	`£tw
(
£âögNameWidth
Ë<< 
ív
->
	`gëName
(Ë<< " = " << std::£tw(
£âögVÆueWidth
Ë<<Énv->
	`gëI¡
(Ë<< " (°rög = " << std::£tw(15Ë<<Énv->
	`gëSåög
(Ë<< ")" << std::
ídl
;

87 
	}
}

96 
Void
 
	gEnvV¨
::
	$¥ötEnvV¨
()

99 i‡(
	`gëEnvV¨Li°
().
	`size
()!=0)

101 
°d
::
cout
 << "--- Envú⁄míàv¨übÀs:\n" << std::
ídl
;

102 
	`f‹_óch
(
	`gëEnvV¨Li°
().
	`begö
(), gëEnvV¨Li°().
	`íd
(), 
¥ötPaú
);

104 
°d
::
cout
 << std::
ídl
;

105 
	}
}

107 
Void
 
	gEnvV¨
::
	$¥ötEnvV¨InU£
()

109 i‡(
	`gëEnvV¨InU£
().
	`size
()!=0)

111 
°d
::
cout
 << "RExàEnvú⁄míàv¨übÀ†£àa†fﬁlows: \n" << std::
ídl
;

112 
	`f‹_óch
(
	`gëEnvV¨InU£
().
	`begö
(), gëEnvV¨InU£().
	`íd
(), 
¥ötVÆ
);

114 
°d
::
cout
 << std::
ídl
;

115 
	}
}

117 
	gEnvV¨
::
	$EnvV¨
(c⁄° 
°d
::
°rög
 &
sName
, c⁄° std::°rög &
sDeÁu…
, c⁄° std::°rög &
sHñp
) :

118 
	`m_sName
(
sName
),

119 
	`m_sHñp
(
sHñp
),

120 
	`m_sVÆ
(),

121 
	`m_dVÆ
(0),

122 
	`m_iVÆ
(0),

123 
	$m_bSë
(
Ál£
)

125 i‡(
	`gëív
(
m_sName
.
	`c_°r
()))

127 
m_sVÆ
 = 
	`gëív
(
m_sName
.
	`c_°r
());

128 
m_bSë
 = 
åue
;

129 
	`gëEnvV¨InU£
().
	`push_back
(
this
);

133 
m_sVÆ
 = 
sDeÁu…
;

136 
m_dVÆ
 = 
	`°πod
(
m_sVÆ
.
	`c_°r
(), 0);

137 
m_iVÆ
 = 
	`I¡
(
m_dVÆ
);

139 
	`gëEnvV¨Li°
().
	`push_back
–
°d
::
∑ú
<°d::
°rög
, std::°rög>(
m_sName
, 
	`ödítNewLöes
(
	`löeWøp
(
	`•lôOnSëtögs
(
m_sHñp
), 
£âögHñpWidth
), (
£âögNameWidth
 + 4))) );

140 
	}
}

147 
EnvV¨
 
Debug
("-- Debugging","","");

149 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugSBAC
 ("DEBUG_SBAC", "0", "Output debug data from SBACÉntropy coder (coefficient dataÉtc.)" );

150 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugRQT
 ("DEBUG_RQT", "0", "Output RQT debug data fromÉntropy coder" );

151 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugPªd
 ("DEBUG_PRED", "0", "OutputÖrediction debug" );

152 
EnvV¨
 
	gDebugO±i⁄Li°
::
F‹˚LumaMode
 ("FORCE_LUMA_MODE", "0", "ForceáÖarticular intra direction for Luma (0-34)" );

153 
EnvV¨
 
	gDebugO±i⁄Li°
::
F‹˚ChromaMode
 ("FORCE_CHROMA_MODE", "0", "ForceáÖarticular intra direction for chroma (0-5)" );

155 #i‡
DEBUG_STRING


156 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugSåög_Såu˘uª
 ("DEBUG_STRUCTURE", "0", "Produce output on chosen structure bit0=intra, bit1=inter");

157 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugSåög_Pªd
 ("DEBUG_PRED", "0", "Produce output onÖrediction data. bit0=intra, bit1=inter");

158 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugSåög_Resi
 ("DEBUG_RESI", "0", "Produce output onÑesidual data. bit0=intra, bit1=inter");

159 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugSåög_Reco
 ("DEBUG_RECO", "0", "Produce output onÑeconstructed data. bit0=intra, bit1=inter");

160 
EnvV¨
 
	gDebugO±i⁄Li°
::
DebugSåög_InvTøn
 ("DEBUG_INV_QT", "0", "Produce output on inverse-quantiserándÅransform stages. bit0=intra, bit1=inter");

167 
Void
 
	$¥ötMa¸oSëtögs
()

169 
°d
::
cout
 << "N⁄-ívú⁄mít-v¨übÀ-c⁄åﬁÀd ma¸o†£àa†fﬁlows: \n" << std::
ídl
;

175 
	`PRINT_CONSTANT
(
RExt__DECODER_DEBUG_BIT_STATISTICS
, 
£âögNameWidth
, 
£âögVÆueWidth
);

176 
	`PRINT_CONSTANT
(
RExt__HIGH_BIT_DEPTH_SUPPORT
, 
£âögNameWidth
, 
£âögVÆueWidth
);

177 
	`PRINT_CONSTANT
(
RExt__HIGH_PRECISION_FORWARD_TRANSFORM
, 
£âögNameWidth
, 
£âögVÆueWidth
);

179 
	`PRINT_CONSTANT
(
O0043_BEST_EFFORT_DECODING
, 
£âögNameWidth
, 
£âögVÆueWidth
);

181 
	`PRINT_CONSTANT
(
ME_ENABLE_ROUNDING_OF_MVS
, 
£âögNameWidth
, 
£âögVÆueWidth
);

185 
°d
::
cout
 << std::
ídl
;

186 
	}
}

193 
UI¡
 
	gg_debugCou¡î
 = 0;

195 #i‡
DEBUG_ENCODER_SEARCH_BINS


196 c⁄° 
UI¡
 
	gdebugEncodîSórchBöT¨gëLöe
 = 0;

197 c⁄° 
UI¡
 
	gdebugEncodîSórchBöWödow
 = 1000000;

200 #i‡
DEBUG_CABAC_BINS


201 c⁄° 
UI¡
 
	gdebugCabacBöT¨gëLöe
 = 0;

202 c⁄° 
UI¡
 
	gdebugCabacBöWödow
 = 1000000;

205 
Void
 
	$¥ötSBACC€ffD©a
–c⁄° 
UI¡
 
œ°X
,

206 c⁄° 
UI¡
 
œ°Y
,

207 c⁄° 
UI¡
 
width
,

208 c⁄° 
UI¡
 
height
,

209 c⁄° 
UI¡
 
ch™
,

210 c⁄° 
UI¡
 
absP¨t
,

211 c⁄° 
UI¡
 
sˇnIdx
,

212 c⁄° 
TC€ff
 *c⁄° 
pC€ff
,

213 c⁄° 
Boﬁ
 
föÆEncode


216 i‡(
DebugO±i⁄Li°
::
DebugSBAC
.
	`gëI¡
()!=0 && 
föÆEncode
)

218 
°d
::
cout
 << "Size: " << 
width
 << "x" << 
height
 << ", La° X/Y: (" << 
œ°X
 << ", " << 
œ°Y
 << "),ábsP¨tIdx: " << 
absP¨t
 << ", sˇnIdx: " << 
sˇnIdx
 << ", ch™: " << 
ch™
 << "\n";

219 
I¡
 
i
=0; i<
width
*
height
; i++)

221 
°d
::
cout
 << std::
	`£tw
(3Ë<< 
pC€ff
[
i
];

222 i‡(
i
%
width
 == width-1)

224 
°d
::
cout
 << "\n";

228 
°d
::
cout
 << ",";

231 
°d
::
cout
 << std::
ídl
;

233 
	}
}

235 
Void
 
	$¥ötCbfAºay
–
TComD©aCU
* 
pcCU
 )

237 c⁄° 
UI¡
 
CUSizeInP¨ts
 = 
pcCU
->
	`gëWidth
(0)/4;

238 c⁄° 
UI¡
 
numVÆidComp
=
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

239 
UI¡
 
ch
=0; ch<
numVÆidComp
; ch++)

241 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

242 
	`¥ötf
("ch™√l: %d\n", 
ch
);

243 
I¡
 
y
=0; y<
CUSizeInP¨ts
; y++)

245 
I¡
 
x
=0; x<
CUSizeInP¨ts
; x++)

247 
	`¥ötf
(
x
+1==
CUSizeInP¨ts
?"%3d\n":"%3d, ", 
pcCU
->
	`gëCbf
(
compID
)[
g_auiRa°îToZsˇn
[
y
*CUSizeInParts + x]]);

251 
	}
}

253 
UI¡
 
	$gëDecimÆWidth
(c⁄° 
DoubÀ
 
vÆue
)

255  (
vÆue
 =0Ë? 1 : (
	`UI¡
(
	`Êo‹
(
	`log10
(
	`Ábs
(value)))) + ((value < 0) ? 2 : 1));

257 
	}
}

259 
UI¡
 
	$gëZSˇnIndex
(c⁄° 
UI¡
 
x
, c⁄° UI¡ 
y
)

261 
UI¡
 
ªmaöögX
 = 
x
;

262 
UI¡
 
ªmaöögY
 = 
y
;

263 
UI¡
 
off£t
 = 0;

264 
UI¡
 
ªsu…
 = 0;

266 (
ªmaöögX
 !0Ë|| (
ªmaöögY
 != 0))

268 
ªsu…
 |((
ªmaöögX
 & 0x1Ë<< 
off£t
Ë| ((
ªmaöögY
 & 0x1) << (offset + 1));

270 
ªmaöögX
 >>= 1;

271 
ªmaöögY
 >>= 1;

272 
off£t
 += 2;

275  
ªsu…
;

276 
	}
}

284 
	g°d
::
°rög
 
	$•lôOnSëtögs
(c⁄° 
°d
::
°rög
 &
öput
)

286 
°d
::
°rög
 
ªsu…
 = 
öput
;

288 
°d
::
°rög
::
size_ty≥
 
£¨chFromPosôi⁄
 = 0;

290 
£¨chFromPosôi⁄
 < 
ªsu…
.
	`Àngth
())

293 
°d
::
°rög
::
size_ty≥
 
equÆsPosôi⁄
 = 
ªsu…
.
	`föd
(" = ", 
£¨chFromPosôi⁄
);

295 i‡(
equÆsPosôi⁄
 =
°d
::
°rög
::
≈os
)

301 
°d
::
°rög
::
size_ty≥
 
•lôPosôi⁄
 = 
ªsu…
.
	`föd_œ°_of
("1234567890", 
equÆsPosôi⁄
);

304 i‡(
•lôPosôi⁄
 !
°d
::
°rög
::
≈os
)

306 
•lôPosôi⁄
 = 
ªsu…
.
	`föd_œ°_of
(' ', splitPosition);

310 i‡(
•lôPosôi⁄
 !
°d
::
°rög
::
≈os
)

312 
ªsu…
.
	`ª∂a˚
(
•lôPosôi⁄
, 1, 1, '\n');

316 
£¨chFromPosôi⁄
 = (
equÆsPosôi⁄
 + 3);

319  
ªsu…
;

320 
	}
}

323 
	g°d
::
°rög
 
	$löeWøp
(c⁄° 
°d
::
°rög
 &
öput
, c⁄° 
UI¡
 
maximumLöeLígth
)

325 i‡(
maximumLöeLígth
 == 0)

327  
öput
;

329 
°d
::
°rög
 
ªsu…
 = 
öput
;

331 
°d
::
°rög
::
size_ty≥
 
löeSèπPosôi⁄
 = 
ªsu…
.
	`föd_fú°_nŸ_of
(' ');

333 
löeSèπPosôi⁄
 !
°d
::
°rög
::
≈os
)

337 c⁄° 
°d
::
°rög
::
size_ty≥
 
£¨chFromPosôi⁄
 = 
löeSèπPosôi⁄
 + 
maximumLöeLígth
;

339 i‡(
£¨chFromPosôi⁄
 >
ªsu…
.
	`Àngth
())

348 
°d
::
°rög
::
size_ty≥
 
√xtLöeSèπPosôi⁄
 = std::°rög::
≈os
;

349 
°d
::
°rög
::
size_ty≥
 
cuºítPosôi⁄
 = 
löeSèπPosôi⁄
; cuºítPosôi⁄ <
£¨chFromPosôi⁄
; currentPosition++)

351 i‡(
ªsu…
[
cuºítPosôi⁄
] == '\n')

353 
√xtLöeSèπPosôi⁄
 = 
cuºítPosôi⁄
 + 1;

361 i‡(
√xtLöeSèπPosôi⁄
 !
°d
::
°rög
::
≈os
)

363 
löeSèπPosôi⁄
 = 
√xtLöeSèπPosôi⁄
;

367 
°d
::
°rög
::
size_ty≥
 
•a˚Posôi⁄
 = std::°rög::
≈os
;

370 
I¡
 
cuºítPosôi⁄
 = 
	`I¡
(
£¨chFromPosôi⁄
); cuºítPosôi⁄ >I¡(
löeSèπPosôi⁄
); currentPosition--)

372 i‡(
ªsu…
[
cuºítPosôi⁄
] == ' ')

374 
•a˚Posôi⁄
 = 
cuºítPosôi⁄
;

380 i‡(
•a˚Posôi⁄
 =
°d
::
°rög
::
≈os
)

382 
ªsu…
.
	`ö£π
(
£¨chFromPosôi⁄
, "-\n");

383 
löeSèπPosôi⁄
 = 
£¨chFromPosôi⁄
 + 2;

387 
ªsu…
.
	`ª∂a˚
(
•a˚Posôi⁄
, 1, 1, '\n');

388 
löeSèπPosôi⁄
 = 
•a˚Posôi⁄
 + 1;

395  
ªsu…
;

396 
	}
}

399 
	g°d
::
°rög
 
	$ödítNewLöes
(c⁄° 
°d
::
°rög
 &
öput
, c⁄° 
UI¡
 
ödítBy
)

401 
°d
::
°rög
 
ªsu…
 = 
öput
;

403 c⁄° 
°d
::
°rög
 
	`ödítSåög
(
ödítBy
, ' ');

404 
°d
::
°rög
::
size_ty≥
 
off£t
 = 0;

406 (
off£t
 = 
ªsu…
.
	`föd
('\n', off£t)Ë!
°d
::
°rög
::
≈os
)

408 i‡((++
off£t
Ë>
ªsu…
.
	`Àngth
())

412 
ªsu…
.
	`ö£π
(
off£t
, 
ödítSåög
);

415  
ªsu…
;

416 
	}
}

422 
Void
 
	$¥ötBlockToSåóm
–
°d
::
o°ªam
 &
ss
, c⁄° 
TCh¨
 *
pLöePªfix
, 
TComYuv
 &
§c
, c⁄° 
UI¡
 
numSubBlocksA¸oss
, c⁄° UI¡ 
numSubBlocksUp
, c⁄° UI¡ 
defWidth
 )

424 c⁄° 
UI¡
 
numVÆidComp
=
§c
.
	`gëNumbîVÆidComp⁄íts
();

426 
UI¡
 
ch
=0; ch<
numVÆidComp
 ; ch++)

428 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

429 c⁄° 
UI¡
 
width
 = 
§c
.
	`gëWidth
(
compID
);

430 c⁄° 
UI¡
 
height
 = 
§c
.
	`gëHeight
(
compID
);

431 c⁄° 
UI¡
 
°ride
 = 
§c
.
	`gëSåide
(
compID
);

432 c⁄° 
Pñ
* 
blkSrc
 = 
§c
.
	`gëAddr
(
compID
);

433 c⁄° 
UI¡
 
subBlockWidth
=
width
/
numSubBlocksA¸oss
;

434 c⁄° 
UI¡
 
subBlockHeight
=
height
/
numSubBlocksUp
;

436 
ss
 << 
pLöePªfix
 << " compID: " << 
compID
 << "\n";

437 
UI¡
 
y
=0; y<
height
; y++)

439 i‡((
y
%
subBlockHeight
)==0 && y!=0)

441 
ss
 << 
pLöePªfix
 << '\n';

444 
ss
 << 
pLöePªfix
;

445 
UI¡
 
x
=0; x<
width
; x++)

447 i‡((
x
%
subBlockWidth
)==0 && x!=0)

449 
ss
 << 
°d
::
	`£tw
(
defWidth
+2) << "";

452 
ss
 << 
°d
::
	`£tw
(
defWidth
Ë<< 
blkSrc
[
y
*
°ride
 + 
x
] << ' ';

454 
ss
 << '\n';

456 
ss
 << 
pLöePªfix
 << " --- \n";

458 
	}
}

460 #i‡
DEBUG_STRING


461 
I¡
 
	$DebugSåögGëPªdModeMask
(
PªdMode
 
mode
)

463  (
mode
==
MODE_INTRA
)?1:2;

464 
	}
}

466 
Void
 
	$DebugI¡îPªdResiReco
(
°d
::
°rög
 &
sDebug
, 
TComYuv
 &
¥ed
, TComYuv &
ªsi
, TComYuv &
ªco
, 
I¡
 
¥edmode_mask
)

468 i‡(
DebugO±i⁄Li°
::
DebugSåög_Pªd
.
	`gëI¡
()&
¥edmode_mask
)

470 
°d
::
°rög°ªam
 
	`ss
(°d::°rög°ªam::
out
);

471 
	`¥ötBlockToSåóm
(
ss
, "###öãr-¥ed: ", 
¥ed
);

472 
°d
::
°rög
 
debugTmp
;

473 
debugTmp
=
ss
.
	`°r
();

474 
sDebug
=
debugTmp
+sDebug;

476 i‡(
DebugO±i⁄Li°
::
DebugSåög_Resi
.
	`gëI¡
()&
¥edmode_mask
)

478 
°d
::
°rög°ªam
 
	`ss
(°d::°rög°ªam::
out
);

479 
	`¥ötBlockToSåóm
(
ss
, "###öãr-ªsi: ", 
ªsi
);

480 
sDebug
+=
ss
.
	`°r
();

482 i‡(
DebugO±i⁄Li°
::
DebugSåög_Reco
.
	`gëI¡
()&
¥edmode_mask
)

484 
°d
::
°rög°ªam
 
	`ss
(°d::°rög°ªam::
out
);

485 
	`¥ötBlockToSåóm
(
ss
, "###öãr-ªco: ", 
ªco
);

486 
sDebug
+=
ss
.
	`°r
();

488 
	}
}

	@TLibCommon/Debug.h

38 #i‚de‡
__DEBUG__


39 
	#__DEBUG__


	)

41 
	~<io°ªam
>

42 
	~<iom™ù
>

43 
	~<°rög
>

44 
	~<li°
>

45 
	~<°dlib.h
>

46 
	~<s°ªam
>

47 
	~<TLibComm⁄/Comm⁄Def.h
>

49 #i‡
DEBUG_STRING


50 c⁄° 
TCh¨
 *
debug_ª‹dî_d©a_öãr_tokí
[
MAX_NUM_COMPONENT
+1];

51 c⁄° 
TCh¨
 *
∑πSizeToSåög
[
NUMBER_OF_PART_SIZES
];

58 
	#PRINT_CONSTANT
(
NAME
, 
NAME_WIDTH
, 
VALUE_WIDTH
Ë
°d
::
cout
 << std::
	`£tw
(NAME_WIDTHË<< #NAME << " = " << std::£tw(VALUE_WIDTHË<< NAME << std::
ídl
;

	)

64 ˛as†
	cEnvV¨


66 
	m¥iv©e
:

67 
°d
::
°rög
 
m_sName
;

68 
	m°d
::
°rög
 
m_sHñp
;

69 
	m°d
::
°rög
 
m_sVÆ
;

70 
DoubÀ
 
	mm_dVÆ
;

71 
I¡
 
	mm_iVÆ
;

72 
Boﬁ
 
	mm_bSë
;

74 
	mpublic
:

76 
°d
::
li°
< std::
∑ú
<°d::
°rög
, 
	m°d
::°rög> > &
gëEnvV¨Li°
();

77 
	m°d
::
li°
<
EnvV¨
*> &
gëEnvV¨InU£
();

78 
Void
 
¥ötEnvV¨
();

79 
Void
 
¥ötEnvV¨InU£
();

81 
EnvV¨
(c⁄° 
°d
::
°rög
 &
sName
, c⁄° std::°rög &
sDeÁu…
, c⁄° std::°rög &
sHñp
);

83 
DoubÀ
 
	$gëDoubÀ
(Ëc⁄° {  
m_dVÆ
; }

84 
I¡
 
	$gëI¡
(Ëc⁄° {  
m_iVÆ
; 
	}
}

85 c⁄° 
	g°d
::
°rög
 &
	$gëSåög
(Ëc⁄° {  
m_sVÆ
; 
	}
}

86 
Boﬁ
 
	$isSë
(Ëc⁄° {  
m_bSë
; 
	}
}

87 
Boﬁ
 
	$isTrue
(Ëc⁄° {  
m_iVÆ
!=0; 
	}
}

88 c⁄° 
	g°d
::
°rög
 &
	$gëName
(Ëc⁄° {  
m_sName
; 
	}
}

97 
«me•a˚
 
	gDebugO±i⁄Li°


99 
EnvV¨
 
DebugSBAC
;

100 
EnvV¨
 
DebugRQT
;

101 
EnvV¨
 
DebugPªd
;

102 
EnvV¨
 
F‹˚LumaMode
;

103 
EnvV¨
 
F‹˚ChromaMode
;

105 #i‡
DEBUG_STRING


106 
EnvV¨
 
DebugSåög_Såu˘uª
;

107 
EnvV¨
 
DebugSåög_Pªd
;

108 
EnvV¨
 
DebugSåög_Resi
;

109 
EnvV¨
 
DebugSåög_Reco
;

110 
EnvV¨
 
DebugSåög_InvTøn
;

116 
Void
 
¥ötMa¸oSëtögs
();

122 
UI¡
 
g_debugCou¡î
;

124 #i‡
DEBUG_ENCODER_SEARCH_BINS


125 c⁄° 
UI¡
 
debugEncodîSórchBöT¨gëLöe
;

126 c⁄° 
UI¡
 
debugEncodîSórchBöWödow
;

129 #i‡
DEBUG_CABAC_BINS


130 c⁄° 
UI¡
 
debugCabacBöT¨gëLöe
;

131 c⁄° 
UI¡
 
debugCabacBöWödow
;

135 
Void
 
¥ötSBACC€ffD©a
–c⁄° 
UI¡
 
œ°X
,

136 c⁄° 
UI¡
 
œ°Y
,

137 c⁄° 
UI¡
 
width
,

138 c⁄° 
UI¡
 
height
,

139 c⁄° 
UI¡
 
ch™
,

140 c⁄° 
UI¡
 
absP¨t
,

141 c⁄° 
UI¡
 
sˇnIdx
,

142 c⁄° 
TC€ff
 *c⁄° 
pC€ff
,

143 c⁄° 
Boﬁ
 
föÆEncode
=
åue


147 
Void
 
¥ötCbfAºay
–
˛ass
 
TComD©aCU
* 
pcCU
 );

149 
UI¡
 
gëDecimÆWidth
(c⁄° 
DoubÀ
 
vÆue
);

150 
UI¡
 
gëZSˇnIndex
(c⁄° UI¡ 
x
, c⁄° UI¡ 
y
);

153 
	gãm∂©e
 <
ty≥«me
 
	gVÆueTy≥
> 
ölöe
 
Void
 
	$wrôeVÆueToSåóm
 (c⁄° 
VÆueTy≥
 &
vÆue
, 
°d
::
o°ªam
 &
°ªam
, c⁄° 
UI¡
 
ouçutWidth
Ë{ såóm << std::
	`£tw
(ouçutWidthË<< vÆue; 
	}
}

154 
	gãm∂©e
 <> 
ölöe
 
Void
 
	gwrôeVÆueToSåóm
<
	gSCh¨
>(c⁄° SCh¨ &
	gvÆue
, 
	g°d
::
o°ªam
 &
°ªam
, c⁄° 
UI¡
 
	gouçutWidth
Ë{ 
	g°ªam
 << std::
£tw
(
ouçutWidth
Ë<< 
I¡
(
vÆue
); }

155 
	gãm∂©e
 <> 
ölöe
 
Void
 
	gwrôeVÆueToSåóm
<
	gUCh¨
>(c⁄° UCh¨ &
	gvÆue
, 
	g°d
::
o°ªam
 &
°ªam
, c⁄° 
UI¡
 
	gouçutWidth
Ë{ 
	g°ªam
 << std::
£tw
(
ouçutWidth
Ë<< UI¡(
vÆue
); }

157 
	gãm∂©e
 <
ty≥«me
 
	gVÆueTy≥
>

158 
Void
 
	$¥ötBlock
(c⁄° 
VÆueTy≥
 *c⁄° 
sour˚
,

159 c⁄° 
UI¡
 
width
,

160 c⁄° 
UI¡
 
height
,

161 c⁄° 
UI¡
 
°ride
,

162 c⁄° 
UI¡
 
ouçutVÆueWidth
 = 0,

163 c⁄° 
Boﬁ
 
⁄lyPrötEdges
 = 
Ál£
,

164 c⁄° 
Boﬁ
 
¥ötInZSˇn
 = 
Ál£
,

165 c⁄° 
I¡
 
shi·Le·By
 = 0,

166 c⁄° 
Boﬁ
 
¥ötAvîage
 = 
Ál£
,

167 
°d
::
o°ªam
 & 
°ªam
 = std::
cout
)

170 
UI¡
 
ouçutWidth
 = 
ouçutVÆueWidth
;

172 i‡(
ouçutWidth
 == 0)

174 
VÆueTy≥
 
möimumVÆue
 = 
	`À·Shi·
(
sour˚
[0], 
shi·Le·By
);

175 
VÆueTy≥
 
maximumVÆue
 = 
möimumVÆue
;

177 
UI¡
 
y
 = 0; y < 
height
; y++)

179 
UI¡
 
x
 = 0; x < 
width
; x++)

181 
VÆueTy≥
 
vÆue
 = 0;

183 i‡(!
⁄lyPrötEdges
 || (
x
 =0Ë|| (
y
 == 0))

185 
vÆue
 = 
	`À·Shi·
(
sour˚
[
¥ötInZSˇn
 ? 
	`gëZSˇnIndex
(
x
, 
y
Ë: ((y * 
°ride
Ë+ x)], 
shi·Le·By
);

188 i‡(
vÆue
 < 
möimumVÆue
)

190 
möimumVÆue
 = 
vÆue
;

192 i‡(
vÆue
 > 
maximumVÆue
)

194 
maximumVÆue
 = 
vÆue
;

199 
ouçutWidth
 = 
°d
::
max
<
UI¡
>(
	`gëDecimÆWidth
(
	`DoubÀ
(
möimumVÆue
)), gëDecimÆWidth(DoubÀ(
maximumVÆue
))) + 1;

205 
VÆueTy≥
 
vÆueSum
 = 0;

207 
UI¡
 
y
 = 0; y < 
height
; y++)

209 
UI¡
 
x
 = 0; x < 
width
; x++)

211 
VÆueTy≥
 
vÆue
 = 0;

213 i‡(!
⁄lyPrötEdges
 || (
x
 =0Ë|| (
y
 == 0))

215 
vÆue
 = 
	`À·Shi·
(
sour˚
[
¥ötInZSˇn
 ? 
	`gëZSˇnIndex
(
x
, 
y
Ë: ((y * 
°ride
Ë+ x)], 
shi·Le·By
);

216 
vÆueSum
 +
vÆue
;

219 
	`wrôeVÆueToSåóm
(
vÆue
, 
°ªam
, 
ouçutWidth
);

221 
°ªam
 << "\n";

224 c⁄° 
I¡
 
vÆueCou¡
 = 
⁄lyPrötEdges
 ? 
	`I¡
((
width
 + 
height
) - 1) : Int(width * height);

225 i‡(
¥ötAvîage
)

227 
°ªam
 << "Avîage: " << (
vÆueSum
 / 
vÆueCou¡
) << "\n";

229 
°ªam
 << "\n";

230 
	}
}

233 
	gãm∂©e
 <
ty≥«me
 
	gT
>

234 
Void
 
	$¥ötBlockToSåóm
–
°d
::
o°ªam
 &
ss
, c⁄° 
TCh¨
 *
pLöePªfix
, c⁄° 
T
 * 
blkSrc
, c⁄° 
UI¡
 
width
, c⁄° UI¡ 
height
, c⁄° UI¡ 
°ride
, c⁄° UI¡ 
subBlockWidth
=0, c⁄° UI¡ 
subBlockHeight
=0, c⁄° UI¡ 
defWidth
=3 )

236 
UI¡
 
y
=0; y<
height
; y++)

238 i‡(
subBlockHeight
!=0 && (
y
%subBlockHeight)==0 && y!=0)

240 
ss
 << 
pLöePªfix
 << '\n';

243 
ss
 << 
pLöePªfix
;

244 
UI¡
 
x
=0; x<
width
; x++)

246 i‡(
subBlockWidth
!=0 && (
x
%subBlockWidth)==0 && x!=0)

248 
ss
 << 
°d
::
	`£tw
(
defWidth
+2) << "";

251 
ss
 << 
°d
::
	`£tw
(
defWidth
Ë<< 
blkSrc
[
y
*
°ride
 + 
x
] << ' ';

253 
ss
 << '\n';

255 
	}
}

257 
˛ass
 
	gTComYuv
;

258 
Void
 
¥ötBlockToSåóm
–
°d
::
o°ªam
 &
ss
, c⁄° 
TCh¨
 *
pLöePªfix
, 
TComYuv
 &
§c
, c⁄° 
UI¡
 
numSubBlocksA¸oss
=1, c⁄° UI¡ 
numSubBlocksUp
=1, c⁄° UI¡ 
defWidth
=3 );

264 
	g°d
::
°rög
 
•lôOnSëtögs
(c⁄° 
°d
::°rög &
öput
);

266 
	g°d
::
°rög
 
löeWøp
(c⁄° 
°d
::°rög &
öput
, c⁄° 
UI¡
 
maximumLöeLígth
);

268 
	g°d
::
°rög
 
ödítNewLöes
(c⁄° 
°d
::°rög &
öput
, c⁄° 
UI¡
 
ödítBy
);

272 #i‡
DEBUG_STRING


273 
I¡
 
DebugSåögGëPªdModeMask
(
PªdMode
 
mode
);

274 
Void
 
DebugI¡îPªdResiReco
(
°d
::
°rög
 &
sDebug
, 
TComYuv
 &
¥ed
, TComYuv &
ªsi
, TComYuv &
ªco
, 
I¡
 
¥edmode_mask
);

	@TLibCommon/NAL.h

34 #¥agm®
⁄˚


36 #i‚de‡
__NAL__


37 
	#__NAL__


	)

39 
	~<s°ªam
>

40 
	~"Comm⁄Def.h
"

42 
˛ass
 
	gTComOuçutBô°ªam
;

47 
	sNALUnô


49 
NÆUnôTy≥
 
	mm_«lUnôTy≥
;

50 
UI¡
 
	mm_ãmp‹ÆId
;

51 
UI¡
 
	mm_nuhLayîId
;

53 
NALUnô
(c⁄° NALUnô &
§c
)

54 :
m_«lUnôTy≥
 (
§c
.m_nalUnitType)

55 ,
m_ãmp‹ÆId
 (
§c
.m_temporalId)

56 ,
m_nuhLayîId
 (
§c
.m_nuhLayerId)

59 
NALUnô
(

60 
NÆUnôTy≥
 
«lUnôTy≥
,

61 
I¡
 
ãmp‹ÆId
 = 0,

62 
I¡
 
nuhLayîId
 = 0)

63 :
m_«lUnôTy≥
 (
«lUnôTy≥
)

64 ,
m_ãmp‹ÆId
 (
ãmp‹ÆId
)

65 ,
m_nuhLayîId
 (
nuhLayîId
)

69 
NALUnô
() {}

71 
	mvútuÆ
 ~
NALUnô
() { }

74 
Boﬁ
 
isSli˚
()

76  
	mm_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_TRAIL_R


77 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_TRAIL_N


78 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_TSA_R


79 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_TSA_N


80 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_STSA_R


81 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_STSA_N


82 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_BLA_W_LP


83 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_BLA_W_RADL


84 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_BLA_N_LP


85 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_IDR_W_RADL


86 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_IDR_N_LP


87 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_CRA


88 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_N


89 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_R


90 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_N


91 || 
m_«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_R
;

93 
Boﬁ
 
isSei
()

95  
	mm_«lUnôTy≥
 =
NAL_UNIT_PREFIX_SEI


96 || 
m_«lUnôTy≥
 =
NAL_UNIT_SUFFIX_SEI
;

99 
Boﬁ
 
isV˛
()

101  ( (
	mUI¡
)
	mm_«lUnôTy≥
 < 32 );

105 
	gOuçutNALUnô
;

110 
	gNALUnôEBSP
 : 
public
 
NALUnô


112 
°d
::
o°rög°ªam
 
m_«lUnôD©a
;

119 
NALUnôEBSP
(
OuçutNALUnô
& 
«lu
);

	@TLibCommon/ProfileLevelTierFeatures.cpp

38 
	~"TLibComm⁄/TComSli˚.h
"

41 
	~<m©h.h
>

42 
	~"ProfûeLevñTõrFótuªs.h
"

44 
UI¡


45 
	gLevñTõrFótuªs
::
	$gëMaxPicWidthInLumaSam∂es
() const

47  
	`UI¡
(
	`sqπ
(
maxLumaPs
*8.0));

48 
	}
}

50 
UI¡


51 
	gLevñTõrFótuªs
::
	$gëMaxPicHeightInLumaSam∂es
() const

53  
	`UI¡
(
	`sqπ
(
maxLumaPs
*8.0));

54 
	}
}

56 c⁄° 
UI¡64
 
	gMAX_CNFUINT64
 = 
°d
::
numîic_limôs
<UI¡64>::
max
();

58 c⁄° 
LevñTõrFótuªs
 
	gmaöLevñTõrInfo
[] =

60 { 
Levñ
::
LEVEL1
 , 36864, { 350, 0 }, 16, 1, 1, 552960ULL, { 128, 0 }, { 2, 2} },

61 { 
Levñ
::
LEVEL2
 , 122880, { 1500, 0 }, 16, 1, 1, 3686400ULL, { 1500, 0 }, { 2, 2} },

62 { 
Levñ
::
LEVEL2_1
, 245760, { 3000, 0 }, 20, 1, 1, 7372800ULL, { 3000, 0 }, { 2, 2} },

63 { 
Levñ
::
LEVEL3
 , 552960, { 6000, 0 }, 30, 2, 2, 16588800ULL, { 6000, 0 }, { 2, 2} },

64 { 
Levñ
::
LEVEL3_1
, 983040, { 10000, 0 }, 40, 3, 3, 33177600ULL, { 10000, 0 }, { 2, 2} },

65 { 
Levñ
::
LEVEL4
 , 2228224, { 12000, 30000 }, 75, 5, 5, 66846720ULL, { 12000, 30000 }, { 4, 4} },

66 { 
Levñ
::
LEVEL4_1
, 2228224, { 20000, 50000 }, 75, 5, 5, 133693440ULL, { 20000, 50000 }, { 4, 4} },

67 { 
Levñ
::
LEVEL5
 , 8912896, { 25000, 100000 }, 200, 11, 10, 267386880ULL, { 25000, 100000 }, { 6, 4} },

68 { 
Levñ
::
LEVEL5_1
, 8912896, { 40000, 160000 }, 200, 11, 10, 534773760ULL, { 40000, 160000 }, { 8, 4} },

69 { 
Levñ
::
LEVEL5_2
, 8912896, { 60000, 240000 }, 200, 11, 10, 1069547520ULL, { 60000, 240000 }, { 8, 4} },

70 { 
Levñ
::
LEVEL6
 , 35651584, { 60000, 240000 }, 600, 22, 20, 1069547520ULL, { 60000, 240000 }, { 8, 4} },

71 { 
Levñ
::
LEVEL6_1
, 35651584, { 120000, 480000 }, 600, 22, 20, 2139095040ULL, { 120000, 480000 }, { 8, 4} },

72 { 
Levñ
::
LEVEL6_2
, 35651584, { 240000, 800000 }, 600, 22, 20, 4278190080ULL, { 240000, 800000 }, { 6, 4} },

73 { 
Levñ
::
LEVEL8_5
, 
MAX_UINT
, { MAX_UINT, MAX_UINT }, MAX_UINT, MAX_UINT, MAX_UINT, 
MAX_CNFUINT64
, {MAX_UINT, MAX_UINT }, { 0, 0} },

74 { 
Levñ
::
NONE
 }

77 c⁄° 
ProfûeFótuªs
 
	gvÆidProfûes
[] =

79 { 
Profûe
::
MAIN
, "Maö", 8, 
CHROMA_420
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

80 { 
Profûe
::
MAIN10
, "Maö10", 10, 
CHROMA_420
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1875, 10 , 
maöLevñTõrInfo
 },

81 { 
Profûe
::
MAIN10
, "Maö10 Stû»Pi˘uª", 10, 
CHROMA_420
, 
Ál£
, 
åue
, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1
 , fÆ£, 256, 64,Åruê, 1000, 1100, 1875, 10 , 
maöLevñTõrInfo
 },

82 { 
Profûe
::
MAINSTILLPICTURE
, "Maö Stû»Pi˘uª", 8, 
CHROMA_420
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1
 , fÆ£, 256, 64, 
åue
 , 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

83 { 
Profûe
::
MAINREXT
, "M⁄ochrome", 8, 
CHROMA_400
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 667, 733, 1000, 10 , 
maöLevñTõrInfo
 },

84 { 
Profûe
::
MAINREXT
, "M⁄ochromê12", 12, 
CHROMA_400
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

85 { 
Profûe
::
MAINREXT
, "M⁄ochromê16", 16, 
CHROMA_400
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1333, 1467, 2000, 10 , 
maöLevñTõrInfo
 },

86 { 
Profûe
::
MAINREXT
, "Maö 12", 12, 
CHROMA_420
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1500, 1650, 2250, 10 , 
maöLevñTõrInfo
 },

87 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 10", 10, 
CHROMA_422
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::
OPTIONAL
, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1667, 1833, 2500, 5 , 
maöLevñTõrInfo
 },

88 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 12", 12, 
CHROMA_422
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::
OPTIONAL
, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

89 { 
Profûe
::
MAINREXT
, "Maö 4:4:4", 8, 
CHROMA_444
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

90 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 10", 10, 
CHROMA_444
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2500, 2750, 3750, 5 , 
maöLevñTõrInfo
 },

91 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 12", 12, 
CHROMA_444
, 
Ál£
, fÆ£, 
ProfûeFótuªs
::
ENABLED
 , ProfûeFótuªs::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 3000, 3300, 4500, 5 , 
maöLevñTõrInfo
 },

92 { 
Profûe
::
MAINREXT
, "Maö I¡ø", 8, 
CHROMA_420
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

93 { 
Profûe
::
MAINREXT
, "Maö 10 I¡ø", 10, 
CHROMA_420
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1875, 10 , 
maöLevñTõrInfo
 },

94 { 
Profûe
::
MAINREXT
, "Maö 12 I¡ø", 12, 
CHROMA_420
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1500, 1650, 2250, 10 , 
maöLevñTõrInfo
 },

95 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 10 I¡ø", 10, 
CHROMA_422
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1667, 1833, 2500, 5 , 
maöLevñTõrInfo
 },

96 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 12 I¡ø", 12, 
CHROMA_422
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::DISABLED, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

97 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 I¡ø", 8, 
CHROMA_444
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

98 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 10 I¡ø", 10, 
CHROMA_444
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2500, 2750, 3750, 5 , 
maöLevñTõrInfo
 },

99 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 12 I¡ø", 12, 
CHROMA_444
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 3000, 3300, 4500, 5 , 
maöLevñTõrInfo
 },

100 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 16 I¡ø", 16, 
CHROMA_444
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
DISABLED
, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 4000, 4400, 6000, 5 , 
maöLevñTõrInfo
 },

101 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 Stû»Pi˘uª", 8, 
CHROMA_444
, 
åue
 ,Åruê, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
DISABLED
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::DISABLED, 
HBR_1_OR_2
 , 
Ál£
, 256, 64,Åruê, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

102 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 16 Stû»Pi˘uª", 16, 
CHROMA_444
, 
åue
 ,Åruê, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
DISABLED
, 
HBR_1_OR_2
 , 
Ál£
, 256, 64,Åruê, 4000, 4400, 6000, 5 , 
maöLevñTõrInfo
 },

103 { 
Profûe
::
HIGHTHROUGHPUTREXT
, "High Throughpuà4:4:4 16 I¡ø", 16, 
CHROMA_444
, 
åue
 , 
Ál£
, 
ProfûeFótuªs
::
OPTIONAL
, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::OPTIONAL, ProfûeFótuªs::
ENABLED
 , 
HBR_12_OR_24
 ,Åruê, 256, 64, fÆ£, 4000, 4400, 6000, 5 , 
maöLevñTõrInfo
 },

104 { 
Profûe
::
NONE
, 0 }

110 
Void


111 
	gProfûeLevñTõrFótuªs
::
	$a˘iv©e
(c⁄° 
TComSPS
 &
•s
)

113 c⁄° 
ProfûeTõrLevñ
 
±l
=*(
•s
.
	`gëPTL
()->
	`gëGíîÆPTL
());

114 
	`a˘iv©e
(
±l
.
	`gëProfûeIdc
(),

115 
±l
.
	`gëBôDïthC⁄°øöt
(),

116 
±l
.
	`gëChromaF‹m©C⁄°øöt
(),

117 
±l
.
	`gëI¡øC⁄°øötFœg
(),

118 
±l
.
	`gëO√Pi˘uªO∆yC⁄°øötFœg
(),

119 
±l
.
	`gëLevñIdc
(),

120 
±l
.
	`gëTõrFœg
(),

121 
•s
.
	`gëMaxCUWidth
(),

122 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
),

123 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_CHROMA
),

124 
•s
.
	`gëChromaF‹m©Idc
());

125 
	}
}

127 
Void


128 
	gProfûeLevñTõrFótuªs
::
	$a˘iv©e
(c⁄° 
Profûe
::
Name
 
¥ofûeIdc
,

129 c⁄° 
UI¡
 
bôDïthC⁄°øöt
,

130 c⁄° 
ChromaF‹m©
 
chromaF‹m©C⁄°øöt
,

131 c⁄° 
Boﬁ
 
öåaC⁄°øötFœg
,

132 c⁄° 
Boﬁ
 
⁄ePi˘uªO∆yC⁄°øötFœg
,

133 c⁄° 
Levñ
::
Name
 
Àvñ
,

134 c⁄° 
Levñ
::
Tõr
 
tõr
,

135 c⁄° 
UI¡
 
˘bSizeY
,

136 c⁄° 
UI¡
 
bôDïthY
,

137 c⁄° 
UI¡
 
bôDïthC
,

138 c⁄° 
ChromaF‹m©
 
chF‹m©
)

140 
m_tõr
 = 
tõr
;

142 
I¡
 
i
=0; 
vÆidProfûes
[i].
¥ofûe
 !
Profûe
::
NONE
; i++)

144 i‡(
¥ofûeIdc
 =
vÆidProfûes
[
i
].
¥ofûe
 &&

145 
bôDïthC⁄°øöt
 =
vÆidProfûes
[
i
].
maxBôDïth
 &&

146 
chromaF‹m©C⁄°øöt
 =
vÆidProfûes
[
i
].
maxChromaF‹m©
 &&

147 
öåaC⁄°øötFœg
 =
vÆidProfûes
[
i
].
gíîÆI¡øC⁄°øötFœg
 &&

148 
⁄ePi˘uªO∆yC⁄°øötFœg
 =
vÆidProfûes
[
i
].
gíîÆO√Pi˘uªO∆yC⁄°øötFœg
 )

150 
m_pProfûe
 = &(
vÆidProfûes
[
i
]);

155 i‡(
m_pProfûe
 != 0)

158 c⁄° 
LevñTõrFótuªs
 *
pLTF
 = 
m_pProfûe
->
pLevñTõrsLi°Info
;

159 c⁄° 
Levñ
::
Name
 
•sLevñName
 = 
Àvñ
;

160 i‡(
•sLevñName
!=
Levñ
::
LEVEL8_5
 || 
m_pProfûe
->
bC™U£Levñ8p5
)

162 
I¡
 
i
=0; 
pLTF
[i].
Àvñ
!=
Levñ
::
NONE
; i++)

164 i‡(
pLTF
[
i
].
Àvñ
 =
•sLevñName
)

166 
m_pLevñTõr
 = &(
pLTF
[
i
]);

173 c⁄° 
UI¡
 
˘bWidthC
 = 
˘bSizeY
 >> 
	`gëCh™√lTy≥SˇÀX
(
CHANNEL_TYPE_CHROMA
, 
chF‹m©
);

174 c⁄° 
UI¡
 
˘bHeightC
 = 
˘bSizeY
 >> 
	`gëCh™√lTy≥SˇÀY
(
CHANNEL_TYPE_CHROMA
, 
chF‹m©
);

176 c⁄° 
UI¡
 
øwCtuBôs
 = 
˘bSizeY
*˘bSizeY*
bôDïthY
+2*(
˘bWidthC
*
˘bHeightC
)*
bôDïthC
;

177 
m_maxRawCtuBôs
=(
øwCtuBôs
*5)/3;

180 
	}
}

182 
I¡
 
	gProfûeLevñTõrFótuªs
::
	$gëMaxDPBNumFømes
(c⁄° 
UI¡
 
PicSizeInSam∂esY
)

184 
I¡
 
MaxDpbSize
=-1;

186 i‡(
m_pLevñTõr
!=0)

188 
UI¡
 
MaxLumaPs
=
m_pLevñTõr
->
maxLumaPs
;

189 
I¡
 
maxDpbPicBuf
=6;

191 if–
PicSizeInSam∂esY
 <–
MaxLumaPs
 >> 2 ) )

193 
MaxDpbSize
 = 
	`mö
–4 * 
maxDpbPicBuf
, 16 );

195 if–
PicSizeInSam∂esY
 <–
MaxLumaPs
 >> 1 ) )

197 
MaxDpbSize
 = 
	`mö
–2 * 
maxDpbPicBuf
, 16 );

199 if–
PicSizeInSam∂esY
 <––3 * 
MaxLumaPs
 ) >> 2 ) )

201 
MaxDpbSize
 = 
	`mö
––4 * 
maxDpbPicBuf
 ) / 3, 16 );

205 
MaxDpbSize
 = 
maxDpbPicBuf
;

208  
MaxDpbSize
;

209 
	}
}

	@TLibCommon/ProfileLevelTierFeatures.h

38 #i‚de‡
__PROFILELEVELTIERFEATURES__


39 
	#__PROFILELEVELTIERFEATURES__


	)

43 #i‡
_MSC_VER
 > 1000

44 #¥agm®
⁄˚


47 
	~"TLibComm⁄/Comm⁄Def.h
"

48 
	~<°dio.h
>

49 
	~<io°ªam
>

53 
˛ass
 
	gTComSPS
;

54 
˛ass
 
	gProfûeTõrLevñ
;

57 
	eHBRFACTOREQN


59 
	mHBR_1
 = 0,

60 
	mHBR_1_OR_2
 = 1,

61 
	mHBR_12_OR_24
 = 2

62 } 
	tHBRFACTOREQN
;

65 
	sLevñTõrFótuªs


67 
	mLevñ
::
Name
 
Àvñ
;

68 
UI¡
 
	mmaxLumaPs
;

69 
UI¡
 
	mmaxCpb
[
Levñ
::
NUMBER_OF_TIERS
];

70 
UI¡
 
	mmaxSli˚SegmítsPîPi˘uª
;

71 
UI¡
 
	mmaxTûeRows
;

72 
UI¡
 
	mmaxTûeCﬁs
;

73 
UI¡64
 
	mmaxLumaSr
;

74 
UI¡
 
	mmaxBr
[
Levñ
::
NUMBER_OF_TIERS
];

75 
UI¡
 
	mmöCrBa£
[
Levñ
::
NUMBER_OF_TIERS
];

76 
UI¡
 
gëMaxPicWidthInLumaSam∂es
() const;

77 
UI¡
 
gëMaxPicHeightInLumaSam∂es
() const;

81 
	sProfûeFótuªs


84 
	eTRISTATE


86 
	mDISABLED
=0,

87 
	mOPTIONAL
=1,

88 
	mENABLED
=2

89 } 
	tTRISTATE
;

91 
	mProfûe
::
Name
 
¥ofûe
;

92 c⁄° 
TCh¨
 *
	mpNameSåög
;

93 
UI¡
 
	mmaxBôDïth
;

94 
ChromaF‹m©
 
	mmaxChromaF‹m©
;

95 
Boﬁ
 
	mgíîÆI¡øC⁄°øötFœg
;

96 
Boﬁ
 
	mgíîÆO√Pi˘uªO∆yC⁄°øötFœg
;

97 
TRISTATE
 
	mgíîÆLowîBôR©eC⁄°øöt
;

98 
TRISTATE
 
	mgíîÆRExtToﬁsE«bÀd
;

99 
TRISTATE
 
	mexãndedPªcisi⁄Pro˚ssögFœg
;

100 
TRISTATE
 
	mchromaQpOff£tLi°E«bÀdFœg
;

101 
TRISTATE
 
	mˇbacBy∑ssAlignmítE«bÀdFœg
;

102 
HBRFACTOREQN
 
	mhbrFa˘‹Eqn
;

103 
Boﬁ
 
	mbWave‰⁄tsAndTûesC™BeU£dSimu…™eou¶y
;

105 
UI¡
 
	mmöTûeCﬁumnWidthInLumaSam∂es
;

106 
UI¡
 
	mmöTûeRowHeightInLumaSam∂es
;

107 
Boﬁ
 
	mbC™U£Levñ8p5
;

108 
UI¡
 
	m˝bV˛Fa˘‹
;

109 
UI¡
 
	m˝bNÆFa˘‹
;

110 
UI¡
 
	mf‹m©C≠abûôyFa˘‹x1000
;

111 
UI¡
 
	mmöCrSˇÀFa˘‹x10
;

112 c⁄° 
LevñTõrFótuªs
 *
	mpLevñTõrsLi°Info
;

114 
Boﬁ
 
chromaF‹m©VÆid
(
ChromaF‹m©
 
chFmt
Ëc⁄° {  (
	m¥ofûe
 =
Profûe
::
MAINREXT
 || 
¥ofûe
 =Profûe::
HIGHTHROUGHPUTREXT
Ë? chFmt<=
maxChromaF‹m©
 : (chFmt == maxChromaFormat ); }

115 
Boﬁ
 
⁄lyIRAPPi˘uªs
(Ëc⁄° {  
	mgíîÆI¡øC⁄°øötFœg
; }

116 
UI¡
 
gëHbrFa˘‹
(
Boﬁ
 
bLowîBôR©eC⁄°øötFœg
) const

118  
	mhbrFa˘‹Eqn
==
HBR_1_OR_2
 ? (2-(
bLowîBôR©eC⁄°øötFœg
?1:0)) :

119 (
hbrFa˘‹Eqn
==
HBR_12_OR_24
 ? 12*(2-(
bLowîBôR©eC⁄°øötFœg
?1:0)) :

125 ˛as†
	cProfûeLevñTõrFótuªs


127 
	m¥iv©e
:

128 c⁄° 
ProfûeFótuªs
 *
m_pProfûe
;

129 c⁄° 
LevñTõrFótuªs
 *
	mm_pLevñTõr
;

131 
	mLevñ
::
Tõr
 
m_tõr
;

132 
UI¡
 
	mm_maxRawCtuBôs
;

133 
	mpublic
:

134 
	$ProfûeLevñTõrFótuªs
(Ë: 
	`m_pProfûe
(0), 
	`m_pLevñTõr
(0), 
	`m_tõr
(
Levñ
::
MAIN
), 
	$m_maxRawCtuBôs
(0) { }

136 
Void
 
	`a˘iv©e
(c⁄° 
Profûe
::
Name
 
¥ofûeIdc
,

137 c⁄° 
UI¡
 
bôDïthC⁄°øöt
,

138 c⁄° 
ChromaF‹m©
 
chromaF‹m©C⁄°øöt
,

139 c⁄° 
Boﬁ
 
öåaC⁄°øötFœg
,

140 c⁄° 
Boﬁ
 
⁄ePi˘uªO∆yC⁄°øötFœg
,

141 c⁄° 
Levñ
::
Name
 
Àvñ
,

142 c⁄° 
Levñ
::
Tõr
 
tõr
,

143 c⁄° 
UI¡
 
˘bSizeY
,

144 c⁄° 
UI¡
 
bôDïthY
,

145 c⁄° 
UI¡
 
bôDïthC
,

146 c⁄° 
ChromaF‹m©
 
chF‹m©
);

148 
Void
 
	`a˘iv©e
(c⁄° 
TComSPS
 &
•s
);

150 c⁄° 
ProfûeFótuªs
 *
	$gëProfûeFótuªs
(Ëc⁄° {  
m_pProfûe
; 
	}
}

151 c⁄° 
LevñTõrFótuªs
 *
	$gëLevñTõrFótuªs
(Ëc⁄° {  
m_pLevñTõr
; 
	}
}

152 
	gLevñ
::
Tõr
 
	$gëTõr
(Ëc⁄° {  
m_tõr
; 
	}
}

153 
UI¡64
 
	$gëCpbSizeInBôs
(Ëc⁄° {  (
m_pLevñTõr
!=0 && 
m_pProfûe
!=0Ë? 
	`UI¡64
(m_pProfûe->
˝bV˛Fa˘‹
Ë* m_pLevñTõr->
maxCpb
[
m_tõr
?1:0] : UI¡64(0); 
	}
}

154 
DoubÀ
 
	$gëMöCr
(Ëc⁄° {  (
m_pLevñTõr
!=0 && 
m_pProfûe
!=0Ë? (m_pProfûe->
möCrSˇÀFa˘‹x10
 * m_pLevñTõr->
möCrBa£
[
m_tõr
?1:0])/10.0 : 0.0 ; 
	}
}

155 
UI¡
 
	$gëMaxRawCtuBôs
(Ëc⁄° {  
m_maxRawCtuBôs
; 
	}
}

156 
I¡
 
gëMaxDPBNumFømes
(c⁄° 
UI¡
 
PicSizeInSam∂esY
);

	@TLibCommon/SEI.cpp

38 
	~"Comm⁄Def.h
"

39 
	~"SEI.h
"

40 
	~<io°ªam
>

42 c⁄° 
	g°d
::
ve˘‹
<
SEI
::
PaylﬂdTy≥
> SEI::
¥efix_£i_mesßges
({

43 
SEI
::
BUFFERING_PERIOD
,

44 
SEI
::
PICTURE_TIMING
,

45 
SEI
::
PAN_SCAN_RECT
,

46 
SEI
::
FILLER_PAYLOAD
,

47 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
,

48 
SEI
::
USER_DATA_UNREGISTERED
,

49 
SEI
::
RECOVERY_POINT
,

50 
SEI
::
SCENE_INFO
,

51 
SEI
::
PICTURE_SNAPSHOT
,

52 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_START
,

53 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_END
,

54 
SEI
::
FILM_GRAIN_CHARACTERISTICS
,

55 
SEI
::
POST_FILTER_HINT
,

56 
SEI
::
TONE_MAPPING_INFO
,

57 
SEI
::
FRAME_PACKING
,

58 
SEI
::
DISPLAY_ORIENTATION
,

59 
SEI
::
GREEN_METADATA
,

60 
SEI
::
SOP_DESCRIPTION
,

61 
SEI
::
ACTIVE_PARAMETER_SETS
,

62 
SEI
::
DECODING_UNIT_INFO
,

63 
SEI
::
TEMPORAL_LEVEL0_INDEX
,

64 
SEI
::
SCALABLE_NESTING
,

65 
SEI
::
REGION_REFRESH_INFO
,

66 
SEI
::
NO_DISPLAY
,

67 
SEI
::
TIME_CODE
,

68 
SEI
::
MASTERING_DISPLAY_COLOUR_VOLUME
,

69 
SEI
::
SEGM_RECT_FRAME_PACKING
,

70 
SEI
::
TEMP_MOTION_CONSTRAINED_TILE_SETS
,

71 
SEI
::
CHROMA_RESAMPLING_FILTER_HINT
,

72 
SEI
::
KNEE_FUNCTION_INFO
,

73 
SEI
::
COLOUR_REMAPPING_INFO
,

74 
SEI
::
DEINTERLACE_FIELD_IDENTIFICATION
,

75 
SEI
::
CONTENT_LIGHT_LEVEL_INFO
,

76 
SEI
::
DEPENDENT_RAP_INDICATION
,

77 
SEI
::
CODED_REGION_COMPLETION
,

78 
SEI
::
ALTERNATIVE_TRANSFER_CHARACTERISTICS
,

79 
SEI
::
AMBIENT_VIEWING_ENVIRONMENT


80 , 
SEI
::
CONTENT_COLOUR_VOLUME


81 , 
SEI
::
EQUIRECTANGULAR_PROJECTION


82 , 
SEI
::
SPHERE_ROTATION


83 , 
SEI
::
OMNI_VIEWPORT


84 , 
SEI
::
CUBEMAP_PROJECTION


85 , 
SEI
::
REGION_WISE_PACKING


86 , 
SEI
::
FISHEYE_VIDEO_INFO


87 , 
SEI
::
REGIONAL_NESTING


88 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


89 , 
SEI
::
SHUTTER_INTERVAL_INFO


93 c⁄° 
	g°d
::
ve˘‹
<
SEI
::
PaylﬂdTy≥
> SEI::
suffix_£i_mesßges
({

94 
SEI
::
FILLER_PAYLOAD
,

95 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
,

96 
SEI
::
USER_DATA_UNREGISTERED
,

97 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_END
,

98 
SEI
::
POST_FILTER_HINT
,

99 
SEI
::
DECODED_PICTURE_HASH
,

100 
SEI
::
CODED_REGION_COMPLETION
,

103 c⁄° 
	g°d
::
ve˘‹
<
SEI
::
PaylﬂdTy≥
> SEI::
ªgi⁄Æ_√°ög_£i_mesßges
({

104 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
,

105 
SEI
::
USER_DATA_UNREGISTERED
,

106 
SEI
::
FILM_GRAIN_CHARACTERISTICS
,

107 
SEI
::
POST_FILTER_HINT
,

108 
SEI
::
TONE_MAPPING_INFO
,

109 
SEI
::
CHROMA_RESAMPLING_FILTER_HINT
,

110 
SEI
::
KNEE_FUNCTION_INFO
,

111 
SEI
::
COLOUR_REMAPPING_INFO
,

112 
SEI
::
CONTENT_COLOUR_VOLUME
,

115 
SEIMesßges
 
	$gëSeisByTy≥
(
SEIMesßges
 &
£iLi°
, 
SEI
::
PaylﬂdTy≥
 
£iTy≥
)

117 
SEIMesßges
 
ªsu…
;

119 
SEIMesßges
::
ôî©‹
 
ô
=
£iLi°
.
	`begö
(); it!=£iLi°.
	`íd
(); it++)

121 i‡((*
ô
)->
	`∑ylﬂdTy≥
(Ë=
£iTy≥
)

123 
ªsu…
.
	`push_back
(*
ô
);

126  
ªsu…
;

127 
	}
}

129 
SEIMesßges
 
	$exåa˘SeisByTy≥
(
SEIMesßges
 &
£iLi°
, 
SEI
::
PaylﬂdTy≥
 
£iTy≥
)

131 
SEIMesßges
 
ªsu…
;

133 
SEIMesßges
::
ôî©‹
 
ô
=
£iLi°
.
	`begö
();

134  
ô
!=
£iLi°
.
	`íd
() )

136 i‡((*
ô
)->
	`∑ylﬂdTy≥
(Ë=
£iTy≥
)

138 
ªsu…
.
	`push_back
(*
ô
);

139 
ô
 = 
£iLi°
.
	`îa£
(it);

143 
ô
++;

146  
ªsu…
;

147 
	}
}

150 
Void
 
	$dñëeSEIs
 (
SEIMesßges
 &
£iLi°
)

152 
SEIMesßges
::
ôî©‹
 
ô
=
£iLi°
.
	`begö
(); it!=£iLi°.
	`íd
(); it++)

154 
	`dñëe
 (*
ô
);

156 
£iLi°
.
	`˛ór
();

157 
	}
}

159 
	gSEIBuf„rögPîiod
::
	$c›yTo
 (
SEIBuf„rögPîiod
& 
èrgë
)

161 
èrgë
.
m_bpSeqP¨amëîSëId
 = m_bpSeqParameterSetId;

162 
èrgë
.
m_øpCpbP¨amsPª£¡Fœg
 = m_rapCpbParamsPresentFlag;

163 
èrgë
.
m_˝bDñayOff£t
 = m_cpbDelayOffset;

164 
èrgë
.
m_dpbDñayOff£t
 = m_dpbDelayOffset;

165 
èrgë
.
m_c⁄ˇã«ti⁄Fœg
 = m_concatenationFlag;

166 
èrgë
.
m_auCpbRemovÆDñayDñè
 = m_auCpbRemovalDelayDelta;

167 ::
	`mem˝y
(
èrgë
.
m_öôülCpbRemovÆDñay
, m_initialCpbRemovalDelay, (m_initialCpbRemovalDelay));

168 ::
	`mem˝y
(
èrgë
.
m_öôülCpbRemovÆDñayOff£t
, m_initialCpbRemovalDelayOffset, (m_initialCpbRemovalDelayOffset));

169 ::
	`mem˝y
(
èrgë
.
m_öôülA…CpbRemovÆDñay
, m_initialAltCpbRemovalDelay, (m_initialAltCpbRemovalDelay));

170 ::
	`mem˝y
(
èrgë
.
m_öôülA…CpbRemovÆDñayOff£t
, m_initialAltCpbRemovalDelayOffset, (m_initialAltCpbRemovalDelayOffset));

171 
	}
}

173 
	gSEIPi˘uªTimög
::
	$c›yTo
 (
SEIPi˘uªTimög
& 
èrgë
)

175 
èrgë
.
m_picSåu˘
 = m_picStruct;

176 
èrgë
.
m_sour˚SˇnTy≥
 = m_sourceScanType;

177 
èrgë
.
m_du∂iˇãFœg
 = m_duplicateFlag;

179 
èrgë
.
m_auCpbRemovÆDñay
 = m_auCpbRemovalDelay;

180 
èrgë
.
m_picDpbOuçutDñay
 = m_picDpbOutputDelay;

181 
èrgë
.
m_picDpbOuçutDuDñay
 = m_picDpbOutputDuDelay;

182 
èrgë
.
m_numDecodögUnôsMöus1
 = m_numDecodingUnitsMinus1;

183 
èrgë
.
m_duComm⁄CpbRemovÆDñayFœg
 = m_duCommonCpbRemovalDelayFlag;

184 
èrgë
.
m_duComm⁄CpbRemovÆDñayMöus1
 = m_duCommonCpbRemovalDelayMinus1;

186 
èrgë
.
m_numNÆusInDuMöus1
 = m_numNalusInDuMinus1;

187 
èrgë
.
m_duCpbRemovÆDñayMöus1
 = m_duCpbRemovalDelayMinus1;

188 
	}
}

190 
	g°d
::
o°ªam
& 
›î©‹
<<(
°d
::o°ªam &
os
, 
RNSEIWödow
 c⁄° &
	gªgi⁄
)

192 
	gos
 << 
	gªgi⁄
.
gëRegi⁄Id
(Ë<< " " <<Ñegi⁄.
gëWödowLe·Off£t
() <<

193 
	gªgi⁄
.
gëWödowRightOff£t
(Ë<< " " <<Ñegi⁄.
gëWödowT›Off£t
() << " " <<

194 
	gªgi⁄
.
gëWödowBŸtomOff£t
() << "\n";

195  
	gos
;

198 
	gSEIRegi⁄ÆNe°ög
::~
	$SEIRegi⁄ÆNe°ög
()

201 
I¡
 
i
 = 0; i < 
m_∫SeiMesßges
.
	`size
(); i++)

203 
dñëe
 
m_∫SeiMesßges
[
i
].
m_£iMesßge
;

205 
	}
}

207 
Void
 
	gSEIRegi⁄ÆNe°ög
::
	$addRegi⁄ÆSEI
(
Regi⁄ÆSEI
 *
ªgSEI
)

210 c⁄° 
RNSEIWödowVec
 
√wRegi⁄s
 = 
ªgSEI
->
	`gëRegi⁄s
();

211 
RNSEIWödowVec
 
ªgi⁄sToAdd
;

212 
°d
::
ve˘‹
<
UI¡
> 
li°OfIndi˚s
;

215 
RNSEIWödowVec
::
c⁄°_ôî©‹
 
ôîNew
 = 
√wRegi⁄s
.
	`begö
();

216 
ôîNew
 !
√wRegi⁄s
.
	`íd
(); iterNew++)

218 
Boﬁ
 
addNewRegi⁄
 = 
m_ªgi⁄s
.
	`em±y
(Ë? 
åue
 : 
Ál£
;

219 
Boﬁ
 
foundRegi⁄
 = 
Ál£
;

221 
RNSEIWödowVec
::
c⁄°_ôî©‹
 
ôîRef
 = 
m_ªgi⁄s
.
	`begö
();

222 !
foundRegi⁄
 && 
ôîRef
 !
m_ªgi⁄s
.
	`íd
(); iterRef++)

224 if–(*
ôîNew
Ë=(*
ôîRef
) )

226 
li°OfIndi˚s
.
	`push_back
((
UI¡
)(
ôîRef
 - 
m_ªgi⁄s
.
	`begö
()));

227 
foundRegi⁄
 = 
åue
;

229 if–
ôîRef
->
	`checkSameID
(*
ôîNew
) )

232 
°d
::
cout
 << "Two differentÑegions haveÅhe same ID;Ölease check.\n";

233 
°d
::
cout
 << "Regi⁄:" << (*
ôîNew
) << "\n";

234 
°d
::
cout
 << "Regi⁄:" << (*
ôîRef
) << "\n";

235 
	`exô
(1);

238 
addNewRegi⁄
 = !
foundRegi⁄
;

240 if(
addNewRegi⁄
)

243 
li°OfIndi˚s
.
	`push_back
((
UI¡
)
m_ªgi⁄s
.
	`size
());

244 
m_ªgi⁄s
.
	`push_back
((*
ôîNew
));

247 if(
li°OfIndi˚s
.
	`em±y
())

249 
°d
::
cout
 << "UnableÅoáddÑegionsÅoÅheÑegionalÇesting SEI.\n";

250 
	`exô
(1);

252 
SEILi°OfIndi˚s
 
	`£iWôhLi°OfIndi˚s
(
li°OfIndi˚s
, 
ªgSEI
->
	`dissocüãSEIObje˘
());

253 
	`addRegi⁄ÆSEI
(
£iWôhLi°OfIndi˚s
);

254 
	}
}

257 c⁄° 
TCh¨
 *
	gSEI
::
	$gëSEIMesßgeSåög
(
SEI
::
PaylﬂdTy≥
 
∑ylﬂdTy≥
)

259 
∑ylﬂdTy≥
)

261 
SEI
::
BUFFERING_PERIOD
:  "BufferingÖeriod";

262 
SEI
::
PICTURE_TIMING
:  "PictureÅiming";

263 
SEI
::
PAN_SCAN_RECT
:  "Pan-scanÑectangle";

264 
SEI
::
FILLER_PAYLOAD
:  "FillerÖayload";

265 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
:  "User dataÑegistered";

266 
SEI
::
USER_DATA_UNREGISTERED
:  "User data unregistered";

267 
SEI
::
RECOVERY_POINT
:  "RecoveryÖoint";

268 
SEI
::
SCENE_INFO
:  "Scene information";

269 
SEI
::
PICTURE_SNAPSHOT
:  "Picture snapshot";

270 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_START
:  "ProgressiveÑefinement segment start";

271 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_END
:  "ProgressiveÑefinement segmentÉnd";

272 
SEI
::
FILM_GRAIN_CHARACTERISTICS
:  "Film grain characteristics";

273 
SEI
::
POST_FILTER_HINT
:  "Post filter hint";

274 
SEI
::
TONE_MAPPING_INFO
:  "Tone mapping information";

275 
SEI
::
KNEE_FUNCTION_INFO
:  "Knee function information";

276 
SEI
::
FRAME_PACKING
:  "FrameÖackingárrangement";

277 
SEI
::
DISPLAY_ORIENTATION
:  "Display orientation";

278 
SEI
::
GREEN_METADATA
:  "Green metadata information";

279 
SEI
::
SOP_DESCRIPTION
:  "Structure ofÖictures information";

280 
SEI
::
ACTIVE_PARAMETER_SETS
:  "ActiveÖarameter sets";

281 
SEI
::
DECODING_UNIT_INFO
:  "Decoding unit information";

282 
SEI
::
TEMPORAL_LEVEL0_INDEX
:  "Temporal sub-layer zero index";

283 
SEI
::
DECODED_PICTURE_HASH
:  "DecodedÖicture hash";

284 
SEI
::
SCALABLE_NESTING
:  "ScalableÇesting";

285 
SEI
::
REGION_REFRESH_INFO
:  "RegionÑefresh information";

286 
SEI
::
NO_DISPLAY
:  "No display";

287 
SEI
::
TIME_CODE
:  "Time code";

288 
SEI
::
MASTERING_DISPLAY_COLOUR_VOLUME
:  "Mastering display colour volume";

289 
SEI
::
SEGM_RECT_FRAME_PACKING
:  "SegmentedÑectangular frameÖackingárrangement";

290 
SEI
::
TEMP_MOTION_CONSTRAINED_TILE_SETS
:  "Temporal motion constrainedÅile sets";

291 
SEI
::
CHROMA_RESAMPLING_FILTER_HINT
:  "Chroma sampling filter hint";

292 
SEI
::
COLOUR_REMAPPING_INFO
:  "ColourÑemapping info";

293 
SEI
::
DEINTERLACE_FIELD_IDENTIFICATION
:  "Deinterlace field identification";

294 
SEI
::
CONTENT_LIGHT_LEVEL_INFO
:  "ContentÜightÜevel info";

295 
SEI
::
DEPENDENT_RAP_INDICATION
:  "Dependent RAP indication";

296 
SEI
::
CODED_REGION_COMPLETION
:  "CodedÑegion completion";

297 
SEI
::
ALTERNATIVE_TRANSFER_CHARACTERISTICS
:  "AlternativeÅransfer characteristics";

298 
SEI
::
AMBIENT_VIEWING_ENVIRONMENT
:  "Ambient viewingÉnvironment";

299 
SEI
::
CONTENT_COLOUR_VOLUME
:  "Content Colour Volume";

300 
SEI
::
EQUIRECTANGULAR_PROJECTION
:  "EquirectangularÖrojection";

301 
SEI
::
SPHERE_ROTATION
:  "SphereÑotation";

302 
SEI
::
OMNI_VIEWPORT
:  "Omni viewport";

303 
SEI
::
CUBEMAP_PROJECTION
:  "CubemapÖrojection";

304 
SEI
::
REGION_WISE_PACKING
:  "Region wiseÖacking information";

305 
SEI
::
FISHEYE_VIDEO_INFO
:  "Fisheye video information";

306 
SEI
::
REGIONAL_NESTING
:  "RegionalÇesting";

307 #i‡
MCTS_EXTRACTION


308 
SEI
::
MCTS_EXTRACTION_INFO_SET
:  "MCTSÉxtraction information";

310 
SEI
::
ANNOTATED_REGIONS
:  "Annotated Region";

311 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


312 
SEI
::
SHUTTER_INTERVAL_INFO
:  "Shutter interval information";

316 
	}
}

	@TLibCommon/SEI.h

34 #i‚de‡
__SEI__


35 
	#__SEI__


	)

37 #¥agm®
⁄˚


38 
	~<li°
>

39 
	~<ve˘‹
>

40 
	~<c°rög
>

41 
	~<m≠
>

43 
	~"Comm⁄Def.h
"

44 
	~"libmd5/MD5.h
"

48 
˛ass
 
	gTComSPS
;

53 ˛as†
	cSEI


55 
	mpublic
:

56 
	ePaylﬂdTy≥


58 
BUFFERING_PERIOD
 = 0,

59 
	mPICTURE_TIMING
 = 1,

60 
	mPAN_SCAN_RECT
 = 2,

61 
	mFILLER_PAYLOAD
 = 3,

62 
	mUSER_DATA_REGISTERED_ITU_T_T35
 = 4,

63 
	mUSER_DATA_UNREGISTERED
 = 5,

64 
	mRECOVERY_POINT
 = 6,

65 
	mSCENE_INFO
 = 9,

66 
	mPICTURE_SNAPSHOT
 = 15,

67 
	mPROGRESSIVE_REFINEMENT_SEGMENT_START
 = 16,

68 
	mPROGRESSIVE_REFINEMENT_SEGMENT_END
 = 17,

69 
	mFILM_GRAIN_CHARACTERISTICS
 = 19,

70 
	mPOST_FILTER_HINT
 = 22,

71 
	mTONE_MAPPING_INFO
 = 23,

72 
	mFRAME_PACKING
 = 45,

73 
	mDISPLAY_ORIENTATION
 = 47,

74 
	mGREEN_METADATA
 = 56,

75 
	mSOP_DESCRIPTION
 = 128,

76 
	mACTIVE_PARAMETER_SETS
 = 129,

77 
	mDECODING_UNIT_INFO
 = 130,

78 
	mTEMPORAL_LEVEL0_INDEX
 = 131,

79 
	mDECODED_PICTURE_HASH
 = 132,

80 
	mSCALABLE_NESTING
 = 133,

81 
	mREGION_REFRESH_INFO
 = 134,

82 
	mNO_DISPLAY
 = 135,

83 
	mTIME_CODE
 = 136,

84 
	mMASTERING_DISPLAY_COLOUR_VOLUME
 = 137,

85 
	mSEGM_RECT_FRAME_PACKING
 = 138,

86 
	mTEMP_MOTION_CONSTRAINED_TILE_SETS
 = 139,

87 
	mCHROMA_RESAMPLING_FILTER_HINT
 = 140,

88 
	mKNEE_FUNCTION_INFO
 = 141,

89 
	mCOLOUR_REMAPPING_INFO
 = 142,

90 
	mDEINTERLACE_FIELD_IDENTIFICATION
 = 143,

91 
	mCONTENT_LIGHT_LEVEL_INFO
 = 144,

92 
	mDEPENDENT_RAP_INDICATION
 = 145,

93 
	mCODED_REGION_COMPLETION
 = 146,

94 
	mALTERNATIVE_TRANSFER_CHARACTERISTICS
 = 147,

95 
	mAMBIENT_VIEWING_ENVIRONMENT
 = 148,

96 
	mCONTENT_COLOUR_VOLUME
 = 149,

97 
	mEQUIRECTANGULAR_PROJECTION
 = 150,

98 
	mSPHERE_ROTATION
 = 154,

99 
	mOMNI_VIEWPORT
 = 156,

100 
	mCUBEMAP_PROJECTION
 = 151,

101 
	mFISHEYE_VIDEO_INFO
 = 152,

102 
	mREGION_WISE_PACKING
 = 155,

103 
	mREGIONAL_NESTING
 = 157,

104 #i‡
MCTS_EXTRACTION


105 
	mMCTS_EXTRACTION_INFO_SET
 = 158,

107 
	mANNOTATED_REGIONS
 = 202,

108 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


109 
	mSHUTTER_INTERVAL_INFO
 = 203,

113 
	$SEI
(Ë{
	}
}

114 
	gvútuÆ
 ~
	$SEI
(Ë{
	}
}

116 c⁄° 
TCh¨
 *
gëSEIMesßgeSåög
(
SEI
::
PaylﬂdTy≥
 
∑ylﬂdTy≥
);

118 
vútuÆ
 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
() const = 0;

120 c⁄° 
°d
::
ve˘‹
 <
SEI
::
PaylﬂdTy≥
> 
¥efix_£i_mesßges
;

121 c⁄° 
°d
::
ve˘‹
 <
SEI
::
PaylﬂdTy≥
> 
suffix_£i_mesßges
;

122 c⁄° 
°d
::
ve˘‹
 <
SEI
::
PaylﬂdTy≥
> 
ªgi⁄Æ_√°ög_£i_mesßges
;

123 
	}
};

126 
	g°d
::
	tli°
<
	tSEI
*> 
	tSEIMesßges
;

129 
SEIMesßges
 
gëSeisByTy≥
(SEIMesßge†&
£iLi°
, 
SEI
::
PaylﬂdTy≥
 
£iTy≥
);

132 
SEIMesßges
 
exåa˘SeisByTy≥
(SEIMesßge†&
£iLi°
, 
SEI
::
PaylﬂdTy≥
 
£iTy≥
);

135 
Void
 
dñëeSEIs
 (
SEIMesßges
 &
£iLi°
);

138 ˛as†
	cSEIBuf„rögPîiod
 : 
public
 
SEI


140 
public
:

141 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
BUFFERING_PERIOD
; }

142 
	`c›yTo
 (
SEIBuf„rögPîiod
& 
èrgë
);

144 
	$SEIBuf„rögPîiod
()

145 : 
	`m_bpSeqP¨amëîSëId
 (0)

146 , 
	`m_øpCpbP¨amsPª£¡Fœg
 (
Ál£
)

147 , 
	`m_˝bDñayOff£t
 (0)

148 , 
	$m_dpbDñayOff£t
 (0)

150 ::
	`mem£t
(
m_öôülCpbRemovÆDñay
, 0, (m_initialCpbRemovalDelay));

151 ::
	`mem£t
(
m_öôülCpbRemovÆDñayOff£t
, 0, (m_initialCpbRemovalDelayOffset));

152 ::
	`mem£t
(
m_öôülA…CpbRemovÆDñay
, 0, (m_initialAltCpbRemovalDelay));

153 ::
	`mem£t
(
m_öôülA…CpbRemovÆDñayOff£t
, 0, (m_initialAltCpbRemovalDelayOffset));

154 
	}
}

155 
	gvútuÆ
 ~
	$SEIBuf„rögPîiod
(Ë{
	}
}

157 
UI¡
 
	gm_bpSeqP¨amëîSëId
;

158 
Boﬁ
 
	gm_øpCpbP¨amsPª£¡Fœg
;

159 
UI¡
 
	gm_˝bDñayOff£t
;

160 
UI¡
 
	gm_dpbDñayOff£t
;

161 
UI¡
 
	gm_öôülCpbRemovÆDñay
 [
MAX_CPB_CNT
][2];

162 
UI¡
 
	gm_öôülCpbRemovÆDñayOff£t
 [
MAX_CPB_CNT
][2];

163 
UI¡
 
	gm_öôülA…CpbRemovÆDñay
 [
MAX_CPB_CNT
][2];

164 
UI¡
 
	gm_öôülA…CpbRemovÆDñayOff£t
[
MAX_CPB_CNT
][2];

165 
Boﬁ
 
	gm_c⁄ˇã«ti⁄Fœg
;

166 
UI¡
 
	gm_auCpbRemovÆDñayDñè
;

170 ˛as†
	cSEIPi˘uªTimög
 : 
public
 
SEI


172 
public
:

173 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
PICTURE_TIMING
; }

174 
	`c›yTo
 (
SEIPi˘uªTimög
& 
èrgë
);

176 
	$SEIPi˘uªTimög
()

177 : 
	`m_picSåu˘
 (0)

178 , 
	`m_sour˚SˇnTy≥
 (0)

179 , 
	`m_du∂iˇãFœg
 (
Ál£
)

180 , 
	$m_picDpbOuçutDuDñay
 (0)

181 {
	}
}

182 
	gvútuÆ
 ~
	$SEIPi˘uªTimög
()

184 
	}
}

186 
UI¡
 
	gm_picSåu˘
;

187 
UI¡
 
	gm_sour˚SˇnTy≥
;

188 
Boﬁ
 
	gm_du∂iˇãFœg
;

190 
UI¡
 
	gm_auCpbRemovÆDñay
;

191 
UI¡
 
	gm_picDpbOuçutDñay
;

192 
UI¡
 
	gm_picDpbOuçutDuDñay
;

193 
UI¡
 
	gm_numDecodögUnôsMöus1
;

194 
Boﬁ
 
	gm_duComm⁄CpbRemovÆDñayFœg
;

195 
UI¡
 
	gm_duComm⁄CpbRemovÆDñayMöus1
;

196 
	g°d
::
ve˘‹
<
UI¡
> 
m_numNÆusInDuMöus1
;

197 
	g°d
::
ve˘‹
<
UI¡
> 
m_duCpbRemovÆDñayMöus1
;

201 ˛as†
	cSEIP™SˇnRe˘
 : 
public
 
SEI


203 
public
:

204 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
PAN_SCAN_RECT
; }

206 
	$SEIP™SˇnRe˘
(Ë{
	}
}

207 
	gvútuÆ
 ~
	$SEIP™SˇnRe˘
(Ë{
	}
}

209 
	sP™SˇnRe˘


211 
I¡
 
	gÀ·Off£t
;

212 
I¡
 
	grightOff£t
;

213 
I¡
 
	gt›Off£t
;

214 
I¡
 
	gbŸtomOff£t
;

217 
UI¡
 
	gm_∑nSˇnRe˘Id
;

218 
Boﬁ
 
	gm_∑nSˇnRe˘C™˚lFœg
;

219 
	g°d
::
ve˘‹
<
P™SˇnRe˘
> 
m_∑nSˇnRe˘Regi⁄s
;

220 
Boﬁ
 
	gm_∑nSˇnRe˘Pîsi°í˚Fœg
;

224 ˛as†
	cSEIFûÀrPaylﬂd
 : 
public
 
SEI


226 
public
:

227 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
FILLER_PAYLOAD
; }

229 
	$SEIFûÀrPaylﬂd
(Ë{
	}
}

230 
	gvútuÆ
 ~
	$SEIFûÀrPaylﬂd
(Ë{
	}
}

232 
UI¡
 
	gm_numFûÀrFFByãs
;

236 ˛as†
	cSEIU£rD©aRegi°îed
 : 
public
 
SEI


238 
public
:

239 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
USER_DATA_REGISTERED_ITU_T_T35
; }

241 
	$SEIU£rD©aRegi°îed
(Ë{
	}
}

242 
	gvútuÆ
 ~
	$SEIU£rD©aRegi°îed
(Ë{
	}
}

244 
USh‹t
 
	gm_ôuCou¡ryCode
;

245 
	g°d
::
ve˘‹
<
UCh¨
> 
m_u£rD©a
;

249 c⁄° 
UI¡
 
	gISO_IEC_11578_LEN
=16;

251 ˛as†
	cSEIU£rD©aUƒegi°îed
 : 
public
 
SEI


253 
public
:

254 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
USER_DATA_UNREGISTERED
; }

256 
	$SEIU£rD©aUƒegi°îed
(Ë{
	}
}

257 
	gvútuÆ
 ~
	$SEIU£rD©aUƒegi°îed
(Ë{ 
	}
}

259 
UCh¨
 
	gm_uuid_iso_õc_11578
[
ISO_IEC_11578_LEN
];

260 
	g°d
::
ve˘‹
<
UCh¨
> 
m_u£rD©a
;

264 ˛as†
	cSEIRecovîyPoöt
 : 
public
 
SEI


266 
public
:

267 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
RECOVERY_POINT
; }

269 
	$SEIRecovîyPoöt
(Ë{
	}
}

270 
	gvútuÆ
 ~
	$SEIRecovîyPoöt
(Ë{
	}
}

272 
I¡
 
	gm_ªcovîyPocC¡
;

273 
Boﬁ
 
	gm_exa˘M©chögFœg
;

274 
Boﬁ
 
	gm_brokíLökFœg
;

278 ˛as†
	cSEIS˚√Info
 : 
public
 
SEI


280 
public
:

281 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
SCENE_INFO
; }

283 
	$SEIS˚√Info
(Ë{
	}
}

284 
	gvútuÆ
 ~
	$SEIS˚√Info
(Ë{
	}
}

286 
Boﬁ
 
	gm_bS˚√InfoPª£¡Fœg
;

287 
Boﬁ
 
	gm_bPªvS˚√IdVÆidFœg
;

288 
UI¡
 
	gm_s˚√Id
;

289 
UI¡
 
	gm_s˚√Tønsôi⁄Ty≥
;

290 
UI¡
 
	gm_£c⁄dS˚√Id
;

294 ˛as†
	cSEIPi˘uªS«pshŸ
 : 
public
 
SEI


296 
public
:

297 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
PICTURE_SNAPSHOT
; }

299 
	$SEIPi˘uªS«pshŸ
(Ë{
	}
}

300 
	gvútuÆ
 ~
	$SEIPi˘uªS«pshŸ
(Ë{
	}
}

302 
UI¡
 
	gm_¢≠shŸId
;

306 ˛as†
	cSEIProgªssiveReföemítSegmítSèπ
 : 
public
 
SEI


308 
public
:

309 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
PROGRESSIVE_REFINEMENT_SEGMENT_START
; }

311 
	$SEIProgªssiveReföemítSegmítSèπ
(Ë{
	}
}

312 
	gvútuÆ
 ~
	$SEIProgªssiveReföemítSegmítSèπ
(Ë{
	}
}

314 
UI¡
 
	gm_¥ogªssiveReföemítId
;

315 
UI¡
 
	gm_picOrdîC¡Dñè
;

319 ˛as†
	cSEIProgªssiveReföemítSegmítEnd
: 
public
 
SEI


321 
public
:

322 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
PROGRESSIVE_REFINEMENT_SEGMENT_END
; }

324 
	$SEIProgªssiveReföemítSegmítEnd
(Ë{
	}
}

325 
	gvútuÆ
 ~
	$SEIProgªssiveReföemítSegmítEnd
(Ë{
	}
}

327 
UI¡
 
	gm_¥ogªssiveReföemítId
;

331 ˛as†
	cSEIFûmGøöCh¨a˘îi°ics
: 
public
 
SEI


333 
public
:

334 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
FILM_GRAIN_CHARACTERISTICS
; }

336 
	$SEIFûmGøöCh¨a˘îi°ics
(Ë{
	}
}

337 
	gvútuÆ
 ~
	$SEIFûmGøöCh¨a˘îi°ics
(Ë{
	}
}

339 
Boﬁ
 
	gm_fûmGøöCh¨a˘îi°icsC™˚lFœg
;

340 
UCh¨
 
	gm_fûmGøöModñId
;

341 
Boﬁ
 
	gm_£∑øãCﬁourDes¸ùti⁄Pª£¡Fœg
;

342 
UCh¨
 
	gm_fûmGøöBôDïthLumaMöus8
;

343 
UCh¨
 
	gm_fûmGøöBôDïthChromaMöus8
;

344 
Boﬁ
 
	gm_fûmGøöFuŒR™geFœg
;

345 
UCh¨
 
	gm_fûmGøöCﬁourPrim¨õs
;

346 
UCh¨
 
	gm_fûmGøöTøns„rCh¨a˘îi°ics
;

347 
UCh¨
 
	gm_fûmGøöM©rixC€ffs
;

348 
UCh¨
 
	gm_bÀndögModeId
;

349 
UCh¨
 
	gm_log2SˇÀFa˘‹
;

351 
	sCompModñI¡ísôyVÆues


353 
UCh¨
 
	göãnsôyI¡îvÆLowîBound
;

354 
UCh¨
 
	göãnsôyI¡îvÆUµîBound
;

355 
	g°d
::
ve˘‹
<
I¡
> 
compModñVÆue
;

358 
	sCompModñ


360 
Boﬁ
 
	gbPª£¡Fœg
;

361 
UCh¨
 
	gnumModñVÆues
;

362 
	g°d
::
ve˘‹
<
CompModñI¡ísôyVÆues
> 
öãnsôyVÆues
;

365 
CompModñ
 
	gm_compModñ
[
MAX_NUM_COMPONENT
];

366 
Boﬁ
 
	gm_fûmGøöCh¨a˘îi°icsPîsi°í˚Fœg
;

370 ˛as†
	cSEIPo°FûãrHöt
: 
public
 
SEI


372 
public
:

373 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
POST_FILTER_HINT
; }

375 
	$SEIPo°FûãrHöt
(Ë{
	}
}

376 
	gvútuÆ
 ~
	$SEIPo°FûãrHöt
(Ë{
	}
}

378 
UI¡
 
	gm_fûãrHötSizeY
;

379 
UI¡
 
	gm_fûãrHötSizeX
;

380 
UI¡
 
	gm_fûãrHötTy≥
;

381 
Boﬁ
 
	gm_bIsM⁄ochrome
;

382 
	g°d
::
ve˘‹
<
I¡
> 
m_fûãrHötVÆues
;

386 ˛as†
	cSEIT⁄eM≠pögInfo
 : 
public
 
SEI


388 
public
:

389 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
TONE_MAPPING_INFO
; }

390 
	$SEIT⁄eM≠pögInfo
(Ë{
	}
}

391 
	gvútuÆ
 ~
	$SEIT⁄eM≠pögInfo
(Ë{
	}
}

393 
I¡
 
	gm_t⁄eM≠Id
;

394 
Boﬁ
 
	gm_t⁄eM≠C™˚lFœg
;

395 
Boﬁ
 
	gm_t⁄eM≠Pîsi°í˚Fœg
;

396 
I¡
 
	gm_codedD©aBôDïth
;

397 
I¡
 
	gm_èrgëBôDïth
;

398 
I¡
 
	gm_modñId
;

399 
I¡
 
	gm_möVÆue
;

400 
I¡
 
	gm_maxVÆue
;

401 
I¡
 
	gm_sigmoidMidpoöt
;

402 
I¡
 
	gm_sigmoidWidth
;

403 
	g°d
::
ve˘‹
<
I¡
> 
m_°¨tOfCodedI¡îvÆ
;

404 
I¡
 
	gm_numPivŸs
;

405 
	g°d
::
ve˘‹
<
I¡
> 
m_codedPivŸVÆue
;

406 
	g°d
::
ve˘‹
<
I¡
> 
m_èrgëPivŸVÆue
;

407 
I¡
 
	gm_ˇmîaIsoS≥edIdc
;

408 
I¡
 
	gm_ˇmîaIsoS≥edVÆue
;

409 
I¡
 
	gm_exposuªIndexIdc
;

410 
I¡
 
	gm_exposuªIndexVÆue
;

411 
Boﬁ
 
	gm_exposuªCom≥nßti⁄VÆueSignFœg
;

412 
I¡
 
	gm_exposuªCom≥nßti⁄VÆueNumî©‹
;

413 
I¡
 
	gm_exposuªCom≥nßti⁄VÆueDíomIdc
;

414 
I¡
 
	gm_ªfS¸ìnLumö™˚Whôe
;

415 
I¡
 
	gm_exãndedR™geWhôeLevñ
;

416 
I¡
 
	gm_nomöÆBœckLevñLumaCodeVÆue
;

417 
I¡
 
	gm_nomöÆWhôeLevñLumaCodeVÆue
;

418 
I¡
 
	gm_exãndedWhôeLevñLumaCodeVÆue
;

422 ˛as†
	cSEIFømePackög
 : 
public
 
SEI


424 
public
:

425 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
FRAME_PACKING
; }

427 
	$SEIFømePackög
(Ë{
	}
}

428 
	gvútuÆ
 ~
	$SEIFømePackög
(Ë{
	}
}

430 
I¡
 
	gm_¨øngemítId
;

431 
Boﬁ
 
	gm_¨øngemítC™˚lFœg
;

432 
I¡
 
	gm_¨øngemítTy≥
;

433 
Boﬁ
 
	gm_quöcunxSam∂ögFœg
;

434 
I¡
 
	gm_c⁄ã¡I¡î¥ë©i⁄Ty≥
;

435 
Boﬁ
 
	gm_•©ülFlùpögFœg
;

436 
Boﬁ
 
	gm_‰ame0Flù≥dFœg
;

437 
Boﬁ
 
	gm_fõldVõwsFœg
;

438 
Boﬁ
 
	gm_cuºítFømeIsFøme0Fœg
;

439 
Boﬁ
 
	gm_‰ame0SñfC⁄èöedFœg
;

440 
Boﬁ
 
	gm_‰ame1SñfC⁄èöedFœg
;

441 
I¡
 
	gm_‰ame0GridPosôi⁄X
;

442 
I¡
 
	gm_‰ame0GridPosôi⁄Y
;

443 
I¡
 
	gm_‰ame1GridPosôi⁄X
;

444 
I¡
 
	gm_‰ame1GridPosôi⁄Y
;

445 
I¡
 
	gm_¨øngemítRe£rvedByã
;

446 
Boﬁ
 
	gm_¨øngemítPîsi°í˚Fœg
;

447 
Boﬁ
 
	gm_upßm∂edA•e˘R©io
;

451 ˛as†
	cSEIDi•œyOrõ¡©i⁄
 : 
public
 
SEI


453 
public
:

454 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
DISPLAY_ORIENTATION
; }

456 
	$SEIDi•œyOrõ¡©i⁄
()

457 : 
	`ˇn˚lFœg
(
åue
)

458 , 
	`≥rsi°í˚Fœg
(0)

459 , 
	$exãnsi⁄Fœg
(
Ál£
)

460 {
	}
}

461 
	gvútuÆ
 ~
	$SEIDi•œyOrõ¡©i⁄
(Ë{
	}
}

463 
Boﬁ
 
	gˇn˚lFœg
;

464 
Boﬁ
 
	gh‹Flù
;

465 
Boﬁ
 
	gvîFlù
;

467 
UI¡
 
	g™ti˛ockwi£RŸ©i⁄
;

468 
Boﬁ
 
	g≥rsi°í˚Fœg
;

469 
Boﬁ
 
	gexãnsi⁄Fœg
;

473 ˛as†
	cSEIGªíMëad©aInfo
 : 
public
 
SEI


475 
public
:

476 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
GREEN_METADATA
; }

477 
	$SEIGªíMëad©aInfo
(Ë{
	}
}

479 
	gvútuÆ
 ~
	$SEIGªíMëad©aInfo
(Ë{
	}
}

481 
UI¡
 
	gm_gªíMëad©aTy≥
;

482 
UI¡
 
	gm_xsdMëricTy≥
;

483 
UI¡
 
	gm_xsdMëricVÆue
;

487 ˛as†
	cSEISOPDes¸ùti⁄
 : 
public
 
SEI


489 
public
:

490 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
SOP_DESCRIPTION
; }

492 
	$SEISOPDes¸ùti⁄
(Ë{
	}
}

493 
	gvútuÆ
 ~
	$SEISOPDes¸ùti⁄
(Ë{
	}
}

495 
UI¡
 
	gm_s›SeqP¨amëîSëId
;

496 
UI¡
 
	gm_numPicsInS›Möus1
;

498 
UI¡
 
	gm_s›DescV˛NÆuTy≥
[
MAX_NUM_PICS_IN_SOP
];

499 
UI¡
 
	gm_s›DescTemp‹ÆId
[
MAX_NUM_PICS_IN_SOP
];

500 
UI¡
 
	gm_s›DescStRpsIdx
[
MAX_NUM_PICS_IN_SOP
];

501 
I¡
 
	gm_s›DescPocDñè
[
MAX_NUM_PICS_IN_SOP
];

505 ˛as†
	cSEIA˘iveP¨amëîSës
 : 
public
 
SEI


507 
public
:

508 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
ACTIVE_PARAMETER_SETS
; }

510 
	$SEIA˘iveP¨amëîSës
()

511 : 
	`a˘iveVPSId
 (0)

512 , 
	`m_£lfC⁄èöedCvsFœg
 (
Ál£
)

513 , 
	`m_noP¨amëîSëUpd©eFœg
 (
Ál£
)

514 , 
	$numSpsIdsMöus1
 (0)

515 {
	}
}

516 
	gvútuÆ
 ~
	$SEIA˘iveP¨amëîSës
(Ë{
	}
}

518 
I¡
 
	ga˘iveVPSId
;

519 
Boﬁ
 
	gm_£lfC⁄èöedCvsFœg
;

520 
Boﬁ
 
	gm_noP¨amëîSëUpd©eFœg
;

521 
I¡
 
	gnumSpsIdsMöus1
;

522 
	g°d
::
ve˘‹
<
I¡
> 
a˘iveSeqP¨amëîSëId
;

526 ˛as†
	cSEIDecodögUnôInfo
 : 
public
 
SEI


528 
public
:

529 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
DECODING_UNIT_INFO
; }

531 
	$SEIDecodögUnôInfo
()

532 : 
	`m_decodögUnôIdx
(0)

533 , 
	`m_duS±CpbRemovÆDñay
(0)

534 , 
	`m_dpbOuçutDuDñayPª£¡Fœg
(
Ál£
)

535 , 
	$m_picS±DpbOuçutDuDñay
(0)

536 {
	}
}

537 
	gvútuÆ
 ~
	$SEIDecodögUnôInfo
(Ë{
	}
}

538 
I¡
 
	gm_decodögUnôIdx
;

539 
I¡
 
	gm_duS±CpbRemovÆDñay
;

540 
Boﬁ
 
	gm_dpbOuçutDuDñayPª£¡Fœg
;

541 
I¡
 
	gm_picS±DpbOuçutDuDñay
;

545 ˛as†
	cSEITemp‹ÆLevñ0Index
 : 
public
 
SEI


547 
public
:

548 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
TEMPORAL_LEVEL0_INDEX
; }

550 
	$SEITemp‹ÆLevñ0Index
()

551 : 
	`é0Idx
(0)

552 , 
	$øpIdx
(0)

553 {
	}
}

554 
	gvútuÆ
 ~
	$SEITemp‹ÆLevñ0Index
(Ë{
	}
}

556 
UI¡
 
	gé0Idx
;

557 
UI¡
 
	gøpIdx
;

561 ˛as†
	cSEIDecodedPi˘uªHash
 : 
public
 
SEI


563 
public
:

564 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
DECODED_PICTURE_HASH
; }

566 
	$SEIDecodedPi˘uªHash
(Ë{
	}
}

567 
	gvútuÆ
 ~
	$SEIDecodedPi˘uªHash
(Ë{
	}
}

569 
HashTy≥
 
	gmëhod
;

571 
TComPi˘uªHash
 
	gm_pi˘uªHash
;

575 ˛as†
	cSEISˇœbÀNe°ög
 : 
public
 
SEI


577 
public
:

578 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
SCALABLE_NESTING
; }

580 
	$SEISˇœbÀNe°ög
(Ë{
	}
}

582 
	gvútuÆ
 ~
	$SEISˇœbÀNe°ög
()

584 
	`dñëeSEIs
(
m_√°edSEIs
);

585 
	}
}

587 
Boﬁ
 
	gm_bôSåómSub£tFœg
;

588 
Boﬁ
 
	gm_√°ögOpFœg
;

589 
Boﬁ
 
	gm_deÁu…OpFœg
;

590 
UI¡
 
	gm_√°ögNumOpsMöus1
;

591 
UI¡
 
	gm_√°ögMaxTemp‹ÆIdPlus1
[
MAX_TLAYER
];

592 
UI¡
 
	gm_√°ögOpIdx
[
MAX_NESTING_NUM_OPS
];

594 
Boﬁ
 
	gm_ÆlLayîsFœg
;

595 
UI¡
 
	gm_√°ögNoOpMaxTemp‹ÆIdPlus1
;

596 
UI¡
 
	gm_√°ögNumLayîsMöus1
;

597 
UCh¨
 
	gm_√°ögLayîId
[
MAX_NESTING_NUM_LAYER
];

599 
SEIMesßges
 
	gm_√°edSEIs
;

603 ˛as†
	cSEIRegi⁄Re‰eshInfo
 : 
public
 
SEI


605 
public
:

606 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
REGION_REFRESH_INFO
; }

608 
	$SEIRegi⁄Re‰eshInfo
()

609 : 
	$m_gdrF‹egroundFœg
(0)

610 {
	}
}

611 
vútuÆ
 ~
	$SEIRegi⁄Re‰eshInfo
(Ë{
	}
}

613 
Boﬁ
 
m_gdrF‹egroundFœg
;

617 ˛as†
	cSEINoDi•œy
 : 
public
 
SEI


619 
public
:

620 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
NO_DISPLAY
; }

622 
	$SEINoDi•œy
()

623 : 
	$m_noDi•œy
(
Ál£
)

624 {
	}
}

625 
vútuÆ
 ~
	$SEINoDi•œy
(Ë{
	}
}

627 
Boﬁ
 
m_noDi•œy
;

631 ˛as†
	cSEITimeCode
 : 
public
 
SEI


633 
public
:

634 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
TIME_CODE
; }

635 
	$SEITimeCode
(Ë{
	}
}

636 
	gvútuÆ
 ~
	$SEITimeCode
(){
	}
}

638 
UI¡
 
	gnumClockTs
;

639 
TComSEITimeSë
 
	gtimeSëAºay
[
MAX_TIMECODE_SEI_SETS
];

643 ˛as†
	cSEIMa°îögDi•œyCﬁourVﬁume
 : 
public
 
SEI


645 
public
:

646 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
MASTERING_DISPLAY_COLOUR_VOLUME
; }

647 
	$SEIMa°îögDi•œyCﬁourVﬁume
(Ë{
	}
}

648 
	gvútuÆ
 ~
	$SEIMa°îögDi•œyCﬁourVﬁume
(){
	}
}

650 
TComSEIMa°îögDi•œy
 
	gvÆues
;

654 ˛as†
	cSEISegmíãdRe˘FømePackög
 : 
public
 
SEI


656 
public
:

657 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
SEGM_RECT_FRAME_PACKING
; }

659 
	$SEISegmíãdRe˘FømePackög
(Ë{
	}
}

660 
	gvútuÆ
 ~
	$SEISegmíãdRe˘FømePackög
(Ë{
	}
}

662 
Boﬁ
 
	gm_¨øngemítC™˚lFœg
;

663 
I¡
 
	gm_c⁄ã¡I¡î¥ë©i⁄Ty≥
;

664 
Boﬁ
 
	gm_¨øngemítPîsi°í˚Fœg
;

669 ˛as†
	cSEITempMŸi⁄C⁄°øöedTûeSës
: 
public
 
SEI


671 ˛as†
	cTûeSëD©a


673 
¥Ÿe˘ed
:

674 
°d
::
ve˘‹
<
I¡
> 
m_t›_À·_tûe_ödex
;

675 
	m°d
::
ve˘‹
<
I¡
> 
m_bŸtom_right_tûe_ödex
;

677 
	mpublic
:

678 
I¡
 
m_m˘s_id
;

679 
Boﬁ
 
	mm_di•œy_tûe_£t_Êag
;

680 
I¡
 
	mm_num_tûe_ª˘s_ö_£t
;

681 
Boﬁ
 
	mm_exa˘_ßm∂e_vÆue_m©ch_Êag
;

682 
Boﬁ
 
	mm_m˘s_tõr_Àvñ_idc_¥e£¡_Êag
;

683 
Boﬁ
 
	mm_m˘s_tõr_Êag
;

684 
I¡
 
	mm_m˘s_Àvñ_idc
;

686 
Void
 
£tNumbîOfTûeRe˘s
(c⁄° 
I¡
 
numbî
)

688 
	mm_t›_À·_tûe_ödex
 .
ªsize
(
numbî
);

689 
	mm_bŸtom_right_tûe_ödex
.
ªsize
(
numbî
);

692 
I¡
 
gëNumbîOfTûeRe˘s
() const

694 
as£π
(
m_t›_À·_tûe_ödex
.
size
(Ë=
m_bŸtom_right_tûe_ödex
.size());

695  
I¡
(
m_t›_À·_tûe_ödex
.
size
());

698 
	mI¡
 &
t›Le·TûeIndex
 (c⁄° 
I¡
 
tûeRe˘Index
Ë{  
	mm_t›_À·_tûe_ödex
 [tileRectIndex]; }

699 
	mI¡
 &
bŸtomRightTûeIndex
(c⁄° 
I¡
 
tûeRe˘Index
Ë{  
	mm_bŸtom_right_tûe_ödex
[tileRectIndex]; }

700 c⁄° 
	mI¡
 &
t›Le·TûeIndex
 (c⁄° 
I¡
 
tûeRe˘Index
Ëc⁄° {  
	mm_t›_À·_tûe_ödex
 [tileRectIndex]; }

701 c⁄° 
	mI¡
 &
bŸtomRightTûeIndex
(c⁄° 
I¡
 
tûeRe˘Index
Ëc⁄° {  
	mm_bŸtom_right_tûe_ödex
[tileRectIndex]; }

704 
	g¥Ÿe˘ed
:

705 
°d
::
ve˘‹
<
TûeSëD©a
> 
m_tûe_£t_d©a
;

707 
	gpublic
:

709 
Boﬁ
 
m_mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag
;

710 
Boﬁ
 
	gm_óch_tûe_⁄e_tûe_£t_Êag
;

711 
Boﬁ
 
	gm_limôed_tûe_£t_di•œy_Êag
;

712 
Boﬁ
 
	gm_max_mcs_tõr_Àvñ_idc_¥e£¡_Êag
;

713 
Boﬁ
 
	gm_max_m˘s_tõr_Êag
;

714 
I¡
 
	gm_max_m˘s_Àvñ_idc
;

716 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
TEMP_MOTION_CONSTRAINED_TILE_SETS
; 
	}
}

717 
	$SEITempMŸi⁄C⁄°øöedTûeSës
(Ë{ 
	}
}

718 
	gvútuÆ
 ~
	$SEITempMŸi⁄C⁄°øöedTûeSës
(Ë{ 
	}
}

720 
Void
 
	$£tNumbîOfTûeSës
(c⁄° 
I¡
 
numbî
Ë{ 
m_tûe_£t_d©a
.
	`ªsize
“umbî); 
	}
}

721 
I¡
 
	$gëNumbîOfTûeSës
(Ëc⁄° {  
	`I¡
(
m_tûe_£t_d©a
.
	`size
()); 
	}
}

723 
	gTûeSëD©a
 &
	$tûeSëD©a
 (c⁄° 
I¡
 
ödex
Ë{  
m_tûe_£t_d©a
[ödex]; 
	}
}

724 c⁄° 
	gTûeSëD©a
 &
	$tûeSëD©a
 (c⁄° 
I¡
 
ödex
Ëc⁄° {  
m_tûe_£t_d©a
[ödex]; 
	}
}

729 ˛as†
	cSEIChromaReßm∂ögFûãrHöt
 : 
public
 
SEI


731 
public
:

732 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° { 
CHROMA_RESAMPLING_FILTER_HINT
;}

733 
	$SEIChromaReßm∂ögFûãrHöt
(Ë{
	}
}

734 
	gvútuÆ
 ~
	$SEIChromaReßm∂ögFûãrHöt
(Ë{
	}
}

736 
I¡
 
	gm_vîChromaFûãrIdc
;

737 
I¡
 
	gm_h‹ChromaFûãrIdc
;

738 
Boﬁ
 
	gm_vîFûãrögFõldPro˚ssögFœg
;

739 
I¡
 
	gm_èrgëF‹m©Idc
;

740 
Boﬁ
 
	gm_≥r„˘Rec⁄°ru˘i⁄Fœg
;

741 
	g°d
::
ve˘‹
<
°d
::ve˘‹<
I¡
> > 
m_vîFûãrC€ff
;

742 
	g°d
::
ve˘‹
<
°d
::ve˘‹<
I¡
> > 
m_h‹FûãrC€ff
;

746 ˛as†
	cSEIK√eFun˘i⁄Info
 : 
public
 
SEI


748 
public
:

749 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
KNEE_FUNCTION_INFO
; }

750 
	$SEIK√eFun˘i⁄Info
(Ë{
	}
}

751 
	gvútuÆ
 ~
	$SEIK√eFun˘i⁄Info
(Ë{
	}
}

753 
I¡
 
	gm_k√eId
;

754 
Boﬁ
 
	gm_k√eC™˚lFœg
;

755 
Boﬁ
 
	gm_k√ePîsi°í˚Fœg
;

756 
I¡
 
	gm_k√eI≈utDønge
;

757 
I¡
 
	gm_k√eI≈utDi•Lumö™˚
;

758 
I¡
 
	gm_k√eOuçutDønge
;

759 
I¡
 
	gm_k√eOuçutDi•Lumö™˚
;

760 
I¡
 
	gm_k√eNumK√ePoötsMöus1
;

761 
	g°d
::
ve˘‹
<
I¡
> 
m_k√eI≈utK√ePoöt
;

762 
	g°d
::
ve˘‹
<
I¡
> 
m_k√eOuçutK√ePoöt
;

765 ˛as†
	cSEIC⁄ã¡CﬁourVﬁume
 : 
public
 
SEI


767 
public
:

768 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
CONTENT_COLOUR_VOLUME
; }

769 
	$SEIC⁄ã¡CﬁourVﬁume
(Ë{
	}
}

770 
	gvútuÆ
 ~
	$SEIC⁄ã¡CﬁourVﬁume
(Ë{
	}
}

772 
Boﬁ
 
	gm_ccvC™˚lFœg
;

773 
Boﬁ
 
	gm_ccvPîsi°í˚Fœg
;

774 
Boﬁ
 
	gm_ccvPrim¨õsPª£¡Fœg
;

775 
Boﬁ
 
	gm_ccvMöLumö™˚VÆuePª£¡Fœg
;

776 
Boﬁ
 
	gm_ccvMaxLumö™˚VÆuePª£¡Fœg
;

777 
Boﬁ
 
	gm_ccvAvgLumö™˚VÆuePª£¡Fœg
;

778 
I¡
 
	gm_ccvPrim¨õsX
[
MAX_NUM_COMPONENT
];

779 
I¡
 
	gm_ccvPrim¨õsY
[
MAX_NUM_COMPONENT
];

780 
UI¡
 
	gm_ccvMöLumö™˚VÆue
;

781 
UI¡
 
	gm_ccvMaxLumö™˚VÆue
;

782 
UI¡
 
	gm_ccvAvgLumö™˚VÆue
;

785 ˛as†
	cSEIEquúe˘™guœrProje˘i⁄
 : 
public
 
SEI


787 
public
:

788 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
EQUIRECTANGULAR_PROJECTION
; }

790 
	$SEIEquúe˘™guœrProje˘i⁄
(Ë{
	}
}

791 
	gvútuÆ
 ~
	$SEIEquúe˘™guœrProje˘i⁄
(Ë{
	}
}

793 
Boﬁ
 
	gm_îpC™˚lFœg
;

794 
Boﬁ
 
	gm_îpPîsi°í˚Fœg
;

795 
Boﬁ
 
	gm_îpGu¨dB™dFœg
;

796 
UCh¨
 
	gm_îpGu¨dB™dTy≥
;

797 
UCh¨
 
	gm_îpLe·Gu¨dB™dWidth
;

798 
UCh¨
 
	gm_îpRightGu¨dB™dWidth
;

801 ˛as†
	cSEISphîeRŸ©i⁄
 : 
public
 
SEI


803 
public
:

804 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
SPHERE_ROTATION
; }

806 
	$SEISphîeRŸ©i⁄
(Ë{
	}
}

807 
	gvútuÆ
 ~
	$SEISphîeRŸ©i⁄
(Ë{
	}
}

809 
Boﬁ
 
	gm_•hîeRŸ©i⁄C™˚lFœg
;

810 
Boﬁ
 
	gm_•hîeRŸ©i⁄Pîsi°í˚Fœg
;

811 
I¡
 
	gm_•hîeRŸ©i⁄Yaw
;

812 
I¡
 
	gm_•hîeRŸ©i⁄Pôch
;

813 
I¡
 
	gm_•hîeRŸ©i⁄Rﬁl
;

816 ˛as†
	cSEIOmniVõwp‹t
 : 
public
 
SEI


818 
public
:

819 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
OMNI_VIEWPORT
; }

821 
	$SEIOmniVõwp‹t
(Ë{
	}
}

822 
	gvútuÆ
 ~
	$SEIOmniVõwp‹t
(Ë{
	}
}

824 
	sOmniVõwp‹t


826 
I¡
 
	gazimuthCíåe
;

827 
I¡
 
	gñev©i⁄Cíåe
;

828 
I¡
 
	gtûtCíåe
;

829 
UI¡
 
	gh‹R™ge
;

830 
UI¡
 
	gvîR™ge
;

833 
UI¡
 
	gm_omniVõwp‹tId
;

834 
Boﬁ
 
	gm_omniVõwp‹tC™˚lFœg
;

835 
Boﬁ
 
	gm_omniVõwp‹tPîsi°í˚Fœg
;

836 
UCh¨
 
	gm_omniVõwp‹tC¡Möus1
;

837 
	g°d
::
ve˘‹
<
OmniVõwp‹t
> 
m_omniVõwp‹tRegi⁄s
;

840 ˛as†
	cSEIA¬Ÿ©edRegi⁄s
 : 
public
 
SEI


842 
public
:

843 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
ANNOTATED_REGIONS
; }

844 
	$SEIA¬Ÿ©edRegi⁄s
(Ë{
	}
}

845 
	gvútuÆ
 ~
	$SEIA¬Ÿ©edRegi⁄s
(Ë{
	}
}

847 
Void
 
	$c›yFrom
(c⁄° 
SEIA¬Ÿ©edRegi⁄s
 &
£iA¬Ÿ©edRegi⁄s
)

849 (*
this
Ë
£iA¬Ÿ©edRegi⁄s
;

850 
	}
}

852 
	sA¬Ÿ©edRegi⁄Obje˘


854 
A¬Ÿ©edRegi⁄Obje˘
() :

855 
obje˘C™˚lFœg
(
Ál£
),

856 
obje˘LabñVÆid
(
Ál£
),

857 
boundögBoxVÆid
(
Ál£
)

859 
Boﬁ
 
	gobje˘C™˚lFœg
;

861 
Boﬁ
 
	gobje˘LabñVÆid
;

862 
UI¡
 
	gobjLabñIdx
;

864 
Boﬁ
 
	gboundögBoxVÆid
;

865 
UI¡
 
	gboundögBoxT›
;

866 
UI¡
 
	gboundögBoxLe·
;

867 
UI¡
 
	gboundögBoxWidth
;

868 
UI¡
 
	gboundögBoxHeight
;

870 
Boﬁ
 
	g∑πülObje˘Fœg
;

871 
UI¡
 
	gobje˘C⁄fidí˚
;

873 
	sA¬Ÿ©edRegi⁄Labñ


875 
A¬Ÿ©edRegi⁄Labñ
(Ë: 
œbñVÆid
(
Ál£
) { }

876 
Boﬁ
 
œbñVÆid
;

877 
	g°d
::
°rög
 
œbñ
;

880 
	sA¬Ÿ©edRegi⁄Hódî


882 
A¬Ÿ©edRegi⁄Hódî
(Ë: 
m_ˇn˚lFœg
(
åue
), 
m_ª˚ivedSëtögsOn˚
(
Ál£
) { }

883 
Boﬁ
 
	gm_ˇn˚lFœg
;

884 
Boﬁ
 
	gm_ª˚ivedSëtögsOn˚
;

886 
Boﬁ
 
	gm_nŸO±imizedF‹VõwögFœg
;

887 
Boﬁ
 
	gm_åueMŸi⁄Fœg
;

888 
Boﬁ
 
	gm_oc˛udedObje˘Fœg
;

889 
Boﬁ
 
	gm_∑πülObje˘FœgPª£¡Fœg
;

890 
Boﬁ
 
	gm_obje˘LabñPª£¡Fœg
;

891 
Boﬁ
 
	gm_obje˘C⁄fidí˚InfoPª£¡Fœg
;

892 
UI¡
 
	gm_obje˘C⁄fidí˚Lígth
;

893 
Boﬁ
 
	gm_obje˘LabñL™guagePª£¡Fœg
;

894 
	g°d
::
°rög
 
m_™nŸ©edRegi⁄sObje˘LabñL™g
;

896 
UI¡
 
	tA¬Ÿ©edRegi⁄Obje˘Index
;

897 
UI¡
 
	tA¬Ÿ©edRegi⁄LabñIndex
;

899 
A¬Ÿ©edRegi⁄Hódî
 
	gm_hdr
;

900 
	g°d
::
ve˘‹
<
°d
::
∑ú
<
A¬Ÿ©edRegi⁄Obje˘Index
, 
	gA¬Ÿ©edRegi⁄Obje˘
> > 
	gm_™nŸ©edRegi⁄s
;

901 
	g°d
::
ve˘‹
<
°d
::
∑ú
<
A¬Ÿ©edRegi⁄LabñIndex
, 
	gA¬Ÿ©edRegi⁄Labñ
> > 
	gm_™nŸ©edLabñs
;

904 ˛as†
	cSEICubem≠Proje˘i⁄
 : 
public
 
SEI


906 
public
:

907 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
CUBEMAP_PROJECTION
; }

908 
	$SEICubem≠Proje˘i⁄
(Ë{
	}
}

909 
	gvútuÆ
 ~
	$SEICubem≠Proje˘i⁄
(Ë{
	}
}

910 
Boﬁ
 
	gm_cmpC™˚lFœg
;

911 
Boﬁ
 
	gm_cmpPîsi°í˚Fœg
;

914 ˛as†
	cSEIRegi⁄Wi£Packög
 : 
public
 
SEI


916 
public
:

917 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
REGION_WISE_PACKING
; }

918 
	$SEIRegi⁄Wi£Packög
(Ë{
	}
}

919 
	gvútuÆ
 ~
	$SEIRegi⁄Wi£Packög
(Ë{
	}
}

920 
Boﬁ
 
	gm_rwpC™˚lFœg
;

921 
Boﬁ
 
	gm_rwpPîsi°í˚Fœg
;

922 
Boﬁ
 
	gm_c⁄°ôuítPi˘uªM©chögFœg
;

923 
I¡
 
	gm_numPackedRegi⁄s
;

924 
I¡
 
	gm_¥ojPi˘uªWidth
;

925 
I¡
 
	gm_¥ojPi˘uªHeight
;

926 
I¡
 
	gm_∑ckedPi˘uªWidth
;

927 
I¡
 
	gm_∑ckedPi˘uªHeight
;

928 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpTønsf‹mTy≥
;

929 
	g°d
::
ve˘‹
<
Boﬁ
> 
m_rwpGu¨dB™dFœg
;

930 
	g°d
::
ve˘‹
<
UI¡
> 
m_¥ojRegi⁄Width
;

931 
	g°d
::
ve˘‹
<
UI¡
> 
m_¥ojRegi⁄Height
;

932 
	g°d
::
ve˘‹
<
UI¡
> 
m_rwpProjRegi⁄T›
;

933 
	g°d
::
ve˘‹
<
UI¡
> 
m_¥ojRegi⁄Le·
;

934 
	g°d
::
ve˘‹
<
USh‹t
> 
m_∑ckedRegi⁄Width
;

935 
	g°d
::
ve˘‹
<
USh‹t
> 
m_∑ckedRegi⁄Height
;

936 
	g°d
::
ve˘‹
<
USh‹t
> 
m_∑ckedRegi⁄T›
;

937 
	g°d
::
ve˘‹
<
USh‹t
> 
m_∑ckedRegi⁄Le·
;

938 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpLe·Gu¨dB™dWidth
;

939 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpRightGu¨dB™dWidth
;

940 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpT›Gu¨dB™dHeight
;

941 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpBŸtomGu¨dB™dHeight
;

942 
	g°d
::
ve˘‹
<
Boﬁ
> 
m_rwpGu¨dB™dNŸU£dF‹PªdFœg
;

943 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpGu¨dB™dTy≥
;

946 ˛as†
	cSEIFisheyeVideoInfo
 : 
public
 
SEI


948 
public
:

949 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
FISHEYE_VIDEO_INFO
; }

950 
	$SEIFisheyeVideoInfo
(Ë{
	}
}

951 
	gvútuÆ
 ~
	$SEIFisheyeVideoInfo
(Ë{
	}
}

952 
TComSEIFisheyeVideoInfo
 
	gvÆues
;

955 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


956 ˛as†
	cSEIShuâîI¡îvÆInfo
 : 
public
 
SEI


958 
public
:

959 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
SHUTTER_INTERVAL_INFO
; }

960 
	$SEIShuâîI¡îvÆInfo
(Ë{
	}
}

961 
	gvútuÆ
 ~
	$SEIShuâîI¡îvÆInfo
(Ë{
	}
}

963 
Boﬁ
 
	gm_siiE«bÀd
;

964 
UI¡
 
	gm_siiNumUnôsInShuâîI¡îvÆ
;

965 
UI¡
 
	gm_siiTimeSˇÀ
;

966 
UI¡
 
	gm_siiMaxSubLayîsMöus1
;

967 
Boﬁ
 
	gm_siiFixedSIwôhöCLVS
;

968 
	g°d
::
ve˘‹
<
UI¡
> 
m_siiSubLayîNumUnôsInSI
;

972 ˛as†
	cSEICﬁourRem≠pögInfo
 : 
public
 
SEI


974 
public
:

976 
	sCRIlut


978 
I¡
 
codedVÆue
;

979 
I¡
 
	mèrgëVÆue
;

980 
boﬁ
 
	m›î©‹
 < (c⁄° 
	mCRIlut
& 
	ma
) const

982  
	mcodedVÆue
 < 
	ma
.codedValue;

986 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
COLOUR_REMAPPING_INFO
; 
	}
}

987 
	$SEICﬁourRem≠pögInfo
(Ë{
	}
}

988 ~
	$SEICﬁourRem≠pögInfo
(Ë{
	}
}

990 
Void
 
	$c›yFrom
–c⁄° 
SEICﬁourRem≠pögInfo
 &
£iCriI≈ut
)

992 (*
this
Ë
£iCriI≈ut
;

993 
	}
}

995 
UI¡
 
	gm_cﬁourRem≠Id
;

996 
Boﬁ
 
	gm_cﬁourRem≠C™˚lFœg
;

997 
Boﬁ
 
	gm_cﬁourRem≠Pîsi°í˚Fœg
;

998 
Boﬁ
 
	gm_cﬁourRem≠VideoSig«lInfoPª£¡Fœg
;

999 
Boﬁ
 
	gm_cﬁourRem≠FuŒR™geFœg
;

1000 
I¡
 
	gm_cﬁourRem≠Prim¨õs
;

1001 
I¡
 
	gm_cﬁourRem≠Tøns„rFun˘i⁄
;

1002 
I¡
 
	gm_cﬁourRem≠M©rixC€fficõ¡s
;

1003 
I¡
 
	gm_cﬁourRem≠I≈utBôDïth
;

1004 
I¡
 
	gm_cﬁourRem≠BôDïth
;

1005 
I¡
 
	gm_¥eLutNumVÆMöus1
[3];

1006 
	g°d
::
ve˘‹
<
CRIlut
> 
m_¥eLut
[3];

1007 
Boﬁ
 
	gm_cﬁourRem≠M©rixPª£¡Fœg
;

1008 
I¡
 
	gm_log2M©rixDíom
;

1009 
I¡
 
	gm_cﬁourRem≠C€ffs
[3][3];

1010 
I¡
 
	gm_po°LutNumVÆMöus1
[3];

1011 
	g°d
::
ve˘‹
<
CRIlut
> 
m_po°Lut
[3];

1015 ˛as†
	cSEIDeöãæa˚FõldIdítifiˇti⁄
 : 
public
 
SEI


1017 
public
:

1018 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
DEINTERLACE_FIELD_IDENTIFICATION
; }

1019 
	$SEIDeöãæa˚FõldIdítifiˇti⁄
(Ë{ 
	}
}

1021 
	gvútuÆ
 ~
	$SEIDeöãæa˚FõldIdítifiˇti⁄
(Ë{
	}
}

1023 
Boﬁ
 
	gm_deöãæa˚dPi˘uªSour˚P¨ôyFœg
;

1027 ˛as†
	cSEIC⁄ã¡LightLevñInfo
 : 
public
 
SEI


1029 
public
:

1030 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
CONTENT_LIGHT_LEVEL_INFO
; }

1031 
	$SEIC⁄ã¡LightLevñInfo
(Ë{ 
	}
}

1033 
	gvútuÆ
 ~
	$SEIC⁄ã¡LightLevñInfo
(Ë{ 
	}
}

1035 
UI¡
 
	gm_maxC⁄ã¡LightLevñ
;

1036 
UI¡
 
	gm_maxPicAvîageLightLevñ
;

1040 ˛as†
	cSEIDïídítRAPIndiˇti⁄
 : 
public
 
SEI


1042 
public
:

1043 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
DEPENDENT_RAP_INDICATION
; }

1044 
	$SEIDïídítRAPIndiˇti⁄
(Ë{ 
	}
}

1046 
	gvútuÆ
 ~
	$SEIDïídítRAPIndiˇti⁄
(Ë{ 
	}
}

1050 ˛as†
	cSEICodedRegi⁄Com∂ëi⁄
 : 
public
 
SEI


1052 
public
:

1053 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
CODED_REGION_COMPLETION
; }

1054 
	$SEICodedRegi⁄Com∂ëi⁄
(Ë{ 
	}
}

1056 
	gvútuÆ
 ~
	$SEICodedRegi⁄Com∂ëi⁄
(Ë{ 
	}
}

1058 
UI¡
 
	gm_√xtSegmítAddªss
;

1059 
Boﬁ
 
	gm_ödïídítSli˚SegmítFœg
;

1063 ˛as†
	cSEIA…î«tiveTøns„rCh¨a˘îi°ics
 : 
public
 
SEI


1065 
public
:

1066 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
ALTERNATIVE_TRANSFER_CHARACTERISTICS
; }

1068 
	$SEIA…î«tiveTøns„rCh¨a˘îi°ics
(Ë: 
	$m_¥e„ºedTøns„rCh¨a˘îi°ics
(18)

1069 { 
	}
}

1071 
vútuÆ
 ~
	$SEIA…î«tiveTøns„rCh¨a˘îi°ics
(Ë{
	}
}

1073 
UI¡
 
m_¥e„ºedTøns„rCh¨a˘îi°ics
;

1077 ˛as†
	cSEIAmbõ¡VõwögEnvú⁄mít
 : 
public
 
SEI


1079 
public
:

1080 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
AMBIENT_VIEWING_ENVIRONMENT
; }

1081 
	$SEIAmbõ¡VõwögEnvú⁄mít
(Ë{ 
	}
}

1083 
	gvútuÆ
 ~
	$SEIAmbõ¡VõwögEnvú⁄mít
(Ë{ 
	}
}

1085 
UI¡
 
	gm_ambõ¡IŒumö™˚
;

1086 
USh‹t
 
	gm_ambõ¡LightX
;

1087 
USh‹t
 
	gm_ambõ¡LightY
;

1089 #i‡
MCTS_EXTRACTION


1090 ˛as†
	cSEIMCTSExåa˘i⁄InfoSë
 : 
public
 
SEI


1092 
public
:

1093 
	sMCTSExåa˘i⁄Info


1095 
°d
::
ve˘‹
< std::ve˘‹<
UI¡
> > 
m_idxOfM˘sInSë
;

1096 
Boﬁ
 
	mm_¶i˚Re‹dîögE«bÀdFœg
;

1097 
	m°d
::
ve˘‹
<
UI¡
> 
m_ouçutSli˚SegmítAddªss
;

1098 
	m°d
::
ve˘‹
<
UI¡
> 
m_vpsRb•D©aLígth
;

1099 
	m°d
::
ve˘‹
<
UI¡
> 
m_•sRb•D©aLígth
;

1100 
	m°d
::
ve˘‹
<
UI¡
> 
m_µsNuhTemp‹ÆIdPlus1
;

1101 
	m°d
::
ve˘‹
<
UI¡
> 
m_µsRb•D©aLígth
;

1102 
	m°d
::
ve˘‹
< 
°d
::ve˘‹<
uöt8_t
> > 
m_vpsRb•D©a
;

1103 
	m°d
::
ve˘‹
< 
°d
::ve˘‹<
uöt8_t
> > 
m_•sRb•D©a
;

1104 
	m°d
::
ve˘‹
< 
°d
::ve˘‹<
uöt8_t
> > 
m_µsRb•D©a
;

1105 
UI¡
 
	mm˘sWidth
;

1106 
UI¡
 
	mm˘sHeight
;

1108 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
MCTS_EXTRACTION_INFO_SET
; 
	}
}

1109 
	$SEIMCTSExåa˘i⁄InfoSë
(Ë{ 
	}
}

1110 
	gvútuÆ
 ~
	$SEIMCTSExåa˘i⁄InfoSë
(Ë{ 
	}
}

1111 
	g°d
::
ve˘‹
<
MCTSExåa˘i⁄Info
> 
m_MCTSExåa˘i⁄InfoSës
;

1117 ˛as†
	cRegi⁄ÆSEI


1119 
	mpublic
:

1120 
	$Regi⁄ÆSEI
(): 
	$m_£iMesßge
(
NULL
) {}

1121 
	$Regi⁄ÆSEI
(
SEI
 *
£i
, 
RNSEIWödowVec
 &
ªgi⁄s
)

1123 if–
	`checkRegi⁄ÆNe°edSEIPaylﬂdTy≥
(
£i
->
	`∑ylﬂdTy≥
()) )

1125 
m_£iMesßge
 = 
£i
;

1126 
m_ªgi⁄s
 = 
ªgi⁄s
;

1130 
m_£iMesßge
 = 
£i
;

1132 
	}
}

1133 ~
	$Regi⁄ÆSEI
()

1135 if(!
m_£iMesßge
)

1137 
dñëe
 
m_£iMesßge
;

1139 
	}
}

1140 
SEI
 *
	$dissocüãSEIObje˘
()

1142 
SEI
 *
ãmp
 = 
m_£iMesßge
;

1143 
m_£iMesßge
 = 
NULL
;

1144  
ãmp
;

1145 
	}
}

1146 
UI¡
 
	$gëNumRegi⁄s
(Ëc⁄° {  (
UI¡
Ë
m_ªgi⁄s
.
	`size
(); 
	}
}

1147 c⁄° 
	gRNSEIWödowVec
& 
	$gëRegi⁄s
(Ë{  
m_ªgi⁄s
; 
	}
}

1148 
Void
 
	$addRegi⁄s
(
RNSEIWödowVec
 c⁄° &
ªgi⁄s
Ë{ 
m_ªgi⁄s
.
	`ö£π
(m_ªgi⁄s.
	`íd
(),Ñegi⁄s.
	`begö
(),Ñegi⁄s.íd()); 
	}
}

1149 
Boﬁ
 
	$checkRegi⁄ÆNe°edSEIPaylﬂdTy≥
(
SEI
::
PaylﬂdTy≥
 c⁄° 
∑ylﬂdTy≥
)

1151 
∑ylﬂdTy≥
)

1153 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
:

1154 
SEI
::
USER_DATA_UNREGISTERED
:

1155 
SEI
::
FILM_GRAIN_CHARACTERISTICS
:

1156 
SEI
::
POST_FILTER_HINT
:

1157 
SEI
::
TONE_MAPPING_INFO
:

1158 
SEI
::
CHROMA_RESAMPLING_FILTER_HINT
:

1159 
SEI
::
KNEE_FUNCTION_INFO
:

1160 
SEI
::
COLOUR_REMAPPING_INFO
:

1161 
SEI
::
CONTENT_COLOUR_VOLUME
:

1162  
åue
;

1164  
Ál£
;

1166 
	}
}

1167 
	g¥iv©e
:

1168 
SEI
 *
m_£iMesßge
;

1169 
RNSEIWödowVec
 
	gm_ªgi⁄s
;

1172 ˛as†
	cSEIRegi⁄ÆNe°ög
 : 
public
 
SEI


1174 
public
:

1175 
	$SEIRegi⁄ÆNe°ög
(): 
	$m_∫Id
(0) {}

1176 ~
	`SEIRegi⁄ÆNe°ög
();

1178 
	sSEILi°OfIndi˚s


1180 
°d
::
ve˘‹
<
UI¡
> 
m_li°OfIndi˚s
;

1181 
SEI
 *
m_£iMesßge
;

1182 
	`SEILi°OfIndi˚s
(Ë: 
	`m_£iMesßge
(
NULL
) {}

1183 
	`SEILi°OfIndi˚s
(
°d
::
ve˘‹
<
UI¡
> 
li°OfIndi˚s
, 
SEI
* 
£i
Ë: 
	`m_li°OfIndi˚s
÷i°OfIndi˚s), 
	`m_£iMesßge
(sei) {}

1184 
	}
};

1186 
PaylﬂdTy≥
 
	$∑ylﬂdTy≥
(Ëc⁄° {  
REGIONAL_NESTING
; 
	}
}

1187 
UI¡
 
	$gëNumRnSEIMesßge
(Ëc⁄° {  (
UI¡
Ë
m_∫SeiMesßges
.
	`size
(); 
	}
}

1188 
UI¡
 
	$gëNumRe˘Regi⁄s
(Ëc⁄° {  (
UI¡
Ë
m_ªgi⁄s
.
	`size
(); 
	}
}

1189 
UI¡
 
	$gëRNId
(Ëc⁄° {  
m_∫Id
; 
	}
}

1190 
Void
 
	$addRegi⁄
(
RNSEIWödow
 *
ªgn
Ë{ 
m_ªgi⁄s
.
	`push_back
(*ªgn); 
	}
}

1191 
Void
 
	$˛órRegi⁄s
(Ë{ 
m_ªgi⁄s
.
	`˛ór
(); 
	}
}

1192 
Void
 
	$addRegi⁄ÆSEI
(
SEILi°OfIndi˚s
 c⁄° &
£iWôhLi°OfRegi⁄Indi˚s
)

1194 
m_∫SeiMesßges
.
	`push_back
(
£iWôhLi°OfRegi⁄Indi˚s
);

1195 
	}
}

1196 
Void
 
addRegi⁄ÆSEI
(
Regi⁄ÆSEI
 *
ªgSEI
);

1197 c⁄° 
	g°d
::
ve˘‹
< 
SEILi°OfIndi˚s
 >& 
	$gëRnSEIMesßges
(Ëc⁄° {  
m_∫SeiMesßges
; 
	}
}

1198 c⁄° 
	g°d
::
ve˘‹
<
RNSEIWödow
> &
	$gëRegi⁄s
(Ëc⁄° {  
m_ªgi⁄s
; 
	}
}

1199 
	g¥iv©e
:

1200 
UI¡
 
m_∫Id
;

1201 
RNSEIWödowVec
 
	gm_ªgi⁄s
;

1202 
	g°d
::
ve˘‹
< 
SEILi°OfIndi˚s
 > 
m_∫SeiMesßges
;

	@TLibCommon/SEIFilmGrainSynthesizer.cpp

38 
	~"SEIFûmGøöSy¡hesizî.h
"

40 
	~<°dio.h
>

42 #i‡
FGS_RDD5_ENABLE


45 c⁄° 
öt8_t
 
	ggaussünLUT
[2048] =

177 c⁄° 
uöt32_t
 
	g£edLUT
[256] = {

211 c⁄° 
öt8_t
 
	gR64_IDCT
[64][64] =

535 c⁄° 
uöt32_t
 
	gdeblockFa˘‹
[13] =

539 
	gSEIFûmGøöSy¡hesizî
::
	$SEIFûmGøöSy¡hesizî
()

540 : 
	`m_width
(0)

541 , 
	`m_height
(0)

542 , 
	`m_chromaF‹m©
(
NUM_CHROMA_FORMAT
)

543 , 
	`m_bôDïth
(0)

544 , 
	`m_idrPicId
(0)

545 , 
	`m_íabÀDeblockög
(0)

546 , 
	`m_pGøöSy¡
(
NULL
)

547 , 
	`m_poc
(0)

548 , 
	`m_îr‹Code
(0)

549 , 
	$m_pFgcP¨amëîs
(
NULL
)

552 
	}
}

554 
	gSEIFûmGøöSy¡hesizî
::
	$¸óã
(
uöt32_t
 
width
, uöt32_à
height
, 
ChromaF‹m©
 
fmt
,

555 
uöt8_t
 
bôDïth
, 
uöt32_t
 
idrPicId
, uöt8_à
íabÀDeblockög
)

557 
m_width
 = 
width
;

558 
m_height
 = 
height
;

559 
m_chromaF‹m©
 = 
fmt
;

560 
m_bôDïth
 = 
bôDïth
;

561 
m_idrPicId
 = 
idrPicId
;

562 
m_íabÀDeblockög
 = 
íabÀDeblockög
;

563 
m_pGøöSy¡
 = 
NULL
;

564 
m_îr‹Code
 = 0;

565 
m_pFgcP¨amëîs
 = 
NULL
;

566 
	}
}

568 
	gSEIFûmGøöSy¡hesizî
::~
	$SEIFûmGøöSy¡hesizî
()

571 
	}
}

573 
SEIFûmGøöSy¡hesizî
::
	$fgsInô
()

575 
m_pGøöSy¡
 = 
√w
 
GøöSy¡hesisSåu˘
;

576 
	`d©aBa£Gí
();

577 
	}
}

579 
	gSEIFûmGøöSy¡hesizî
::
	$fgsDeöô
()

581 
dñëe
 
m_pGøöSy¡
;

582 
	}
}

584 
	gSEIFûmGøöSy¡hesizî
::
	$gøöSy¡hesizeAndBÀnd
(
TComPicYuv
* 
pGøöBuf
, 
Boﬁ
 
isIdrPic
)

586 
uöt8_t
 
numComp
 = 
MAX_NUM_COMPONENT
, 
compCå
, 
blkId
;

587 
uöt8_t
 
log2SˇÀFa˘‹
, 
h
, 
v
;

588 
uöt8_t
 
bôDïth
;

589 
uöt8_t
 
cﬁ‹_off£t
[
MAX_NUM_COMPONENT
];

590 
uöt32_t
 
widthComp
[
MAX_NUM_COMPONENT
], 
heightComp
[MAX_NUM_COMPONENT], 
°rideComp
[MAX_NUM_COMPONENT];

591 
Pñ
 *
decSam∂eBlk16
, *
decSam∂eBlk8
, *
decSam∂eOff£tY
;

592 
Pñ
 *
decComp
[
MAX_NUM_COMPONENT
];

593 
uöt16_t
 
numSam∂es
;

594 
öt16_t
 
sˇÀFa˘‹
;

595 
uöt32_t
 
kOff£t
, 
lOff£t
, 
gøöSåùeOff£t
, 
gøöSåùeOff£tBlk8
, 
off£tBlk8x8
;

596 
öt32_t
 *
gøöSåùe
;

597 
öt32_t
 
yOff£t8x8
, 
xOff£t8x8
;

598 
uöt32_t
 
picOff£t
, 
x
, 
y
, 
öãnsôyI¡
;

599 
Pñ
 
blockAvg
;

600 
uöt32_t
 
p£udoR™dVÆEc
;

601 
uöt32_t
 
picOrdîC¡Off£t
=0;

604 
cﬁ‹_off£t
[0] = 
COLOUR_OFFSET_LUMA
;

605 
cﬁ‹_off£t
[1] = 
COLOUR_OFFSET_CR
;

606 
cﬁ‹_off£t
[2] = 
COLOUR_OFFSET_CB
;

608 
bôDïth
 = 
m_bôDïth
;

609 
log2SˇÀFa˘‹
 = 
m_pFgcP¨amëîs
->
m_log2SˇÀFa˘‹
;

611 
widthComp
[0] = 
m_width
;

612 
widthComp
[1] = 
m_width
;

613 
widthComp
[2] = 
m_width
;

614 
heightComp
[0] = 
m_height
;

615 
heightComp
[1] = 
m_height
;

616 
heightComp
[2] = 
m_height
;

617 i‡(
CHROMA_420
 =
m_chromaF‹m©
)

619 
widthComp
[1] >>= 1;

620 
widthComp
[2] >>= 1;

621 
heightComp
[1] >>= 1;

622 
heightComp
[2] >>= 1;

624 i‡(
CHROMA_422
 =
m_chromaF‹m©
)

626 
widthComp
[1] >>= 1;

627 
widthComp
[2] >>= 1;

629 i‡(
CHROMA_400
 =
m_chromaF‹m©
)

631 
numComp
 = 1;

635 
decComp
[0] = 
pGøöBuf
->
	`gëAddr
(
COMPONENT_Y
);

636 
decComp
[1] = 
pGøöBuf
->
	`gëAddr
(
COMPONENT_Cb
);

637 
decComp
[2] = 
pGøöBuf
->
	`gëAddr
(
COMPONENT_Cr
);

640 
°rideComp
[0] = 
pGøöBuf
->
	`gëSåide
(
COMPONENT_Y
);

641 
°rideComp
[1] = 
pGøöBuf
->
	`gëSåide
(
COMPONENT_Cb
);

642 
°rideComp
[2] = 
pGøöBuf
->
	`gëSåide
(
COMPONENT_Cr
);

644 
gøöSåùe
 = (
öt32_t
 *)
	`mÆloc
(
°rideComp
[0] * 
BLK_16
 * (int32_t));

646 i‡(
isIdrPic
)

648 
picOrdîC¡Off£t
 = 
m_idrPicId
;

651 i‡(
FGS_SUCCESS
 =
m_îr‹Code
)

653 i‡(0 =
m_pFgcP¨amëîs
->
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
)

655 
compCå
 = 0; compCå < 
numComp
; compCtr++)

657 i‡(1 =
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
bPª£¡Fœg
)

659 
picOff£t
 = (
m_poc
Ë+ (
picOrdîC¡Off£t
 << 5);

661 
p£udoR™dVÆEc
 = 
£edLUT
[((
picOff£t
 + 
cﬁ‹_off£t
[
compCå
]) % 256)];

663 
decSam∂eOff£tY
 = 
decComp
[
compCå
];

666 
y
 = 0; y < 
heightComp
[
compCå
]; y +
BLK_16
)

669 
	`mem£t
(
gøöSåùe
, 0, (
°rideComp
[0] * 
BLK_16
 * (
öt32_t
)));

670 
x
 = 0; x < 
widthComp
[
compCå
]; x +
BLK_16
)

673 
gøöSåùeOff£t
 = 
x
;

674 
decSam∂eBlk16
 = 
decSam∂eOff£tY
 + 
x
;

676 
blkId
 = 0; blkId < 
NUM_8x8_BLKS_16x16
; blkId++)

678 
yOff£t8x8
 = (
blkId
 >> 1Ë* 
BLK_8
;

679 
xOff£t8x8
 = (
blkId
 & 0x1)* 
BLK_8
;

680 
off£tBlk8x8
 = 
xOff£t8x8
 + (
yOff£t8x8
 * 
°rideComp
[
compCå
]);

681 
gøöSåùeOff£tBlk8
 = 
gøöSåùeOff£t
 + 
off£tBlk8x8
;

683 
decSam∂eBlk8
 = 
decSam∂eBlk16
 + 
off£tBlk8x8
;

684 
blockAvg
 = 
	`blockAvîage
(
decSam∂eBlk8
, 
°rideComp
[
compCå
], &
numSam∂es
,

685 
	`MIN
(
BLK_8
, (
heightComp
[
compCå
] - 
y
 - 
yOff£t8x8
)),

686 
	`MIN
(
BLK_8
, (
widthComp
[
compCå
] - 
x
 - 
xOff£t8x8
)),

687 
bôDïth
);

690 i‡(
numSam∂es
 > 0)

693 
öãnsôyI¡
 = 
m_pGøöSy¡
->
öãnsôyI¡îvÆ
[
compCå
][
blockAvg
];

695 i‡(
INTENSITY_INTERVAL_MATCH_FAIL
 !
öãnsôyI¡
)

698 
kOff£t
 = (
	`MSB16
(
p£udoR™dVÆEc
) % 52);

699 
kOff£t
 &= 0xFFFC;

700 
kOff£t
 +(
x
 + 
xOff£t8x8
) & 0x0008;

701 
lOff£t
 = (
	`LSB16
(
p£udoR™dVÆEc
) % 56);

702 
lOff£t
 &= 0xFFF8;

703 
lOff£t
 +(
y
 + 
yOff£t8x8
) & 0x0008;

704 
sˇÀFa˘‹
 = 
	`BIT0
(
p£udoR™dVÆEc
) ? -1 : 1;

705 
sˇÀFa˘‹
 *=

706 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyI¡
].
compModñVÆue
[0];

707 
h
 = 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyI¡
].
compModñVÆue
[1] - 2;

708 
v
 = 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyI¡
].
compModñVÆue
[2] - 2;

711 
	`simuœãGøöBlk8x8
(
gøöSåùe
, 
gøöSåùeOff£tBlk8
,

712 
m_pGøöSy¡
, 
°rideComp
[
compCå
],

713 
log2SˇÀFa˘‹
, 
sˇÀFa˘‹
, 
kOff£t
, 
lOff£t
, 
h
, 
v
, 
	`MIN
(
BLK_8
, (
widthComp
[
compCå
] - 
x
 - 
xOff£t8x8
)));

719 
p£udoR™dVÆEc
 = 
	`¥ng
(pseudoRandValEc);

723 i‡(
m_íabÀDeblockög
)

725 
	`deblockGøöSåùe
(
gøöSåùe
, 
widthComp
[
compCå
], 
°rideComp
[compCtr]);

728 
	`bÀndSåùe
(
decSam∂eOff£tY
, 
gøöSåùe
,

729 
°rideComp
[
compCå
], 
	`MIN
(
BLK_16
, (
heightComp
[compCå] - 
y
)), 
bôDïth
);

730 
decSam∂eOff£tY
 +
	`MIN
(
BLK_16
, 
heightComp
[
compCå
] - 
y
Ë* 
°rideComp
[compCtr];

737 i‡(
isIdrPic
)

739 
m_idrPicId
++;

741 
	`‰ì
(
gøöSåùe
);

742 
	}
}

744 
	gSEIFûmGøöSy¡hesizî
::
	$d©aBa£Gí
()

746 
uöt32_t
 
p£udoR™dVÆEhv
;

747 
uöt8_t
 
h
, 
v
;

748 
uöt32_t
 
SˇÀCutOffFh
, 
SˇÀCutOffFv
, 
l
, 
r
, 
i
, 
j
, 
k
;

749 
öt32_t
 
B
[
DATA_BASE_SIZE
][DATA_BASE_SIZE], 
bIDCT
[DATA_BASE_SIZE][DATA_BASE_SIZE];

750 
öt32_t
 
bGøö
[
DATA_BASE_SIZE
][DATA_BASE_SIZE];

751 
öt8_t
 
R64_IDCT_TR
[
DATA_BASE_SIZE
][DATA_BASE_SIZE];

753 
l
 = 0;Ü < 
DATA_BASE_SIZE
;Ü++)

755 
k
 = 0; k < 
DATA_BASE_SIZE
; k++)

757 
R64_IDCT_TR
[
l
][
k
] = 
R64_IDCT
[k][l];

761 
h
 = 0; h < 
NUM_CUT_OFF_FREQ
; h++)

763 
v
 = 0; v < 
NUM_CUT_OFF_FREQ
; v++)

765 
	`mem£t
(&
B
, 0, 
DATA_BASE_SIZE
*DATA_BASE_SIZE * (
öt32_t
));

766 
	`mem£t
(&
bIDCT
, 0, 
DATA_BASE_SIZE
*DATA_BASE_SIZE * (
öt32_t
));

767 
	`mem£t
(&
bGøö
, 0, 
DATA_BASE_SIZE
*DATA_BASE_SIZE * (
öt32_t
));

768 
SˇÀCutOffFh
 = ((
h
 + 3) << 2) - 1;

769 
SˇÀCutOffFv
 = ((
v
 + 3) << 2) - 1;

772 
p£udoR™dVÆEhv
 = 
£edLUT
[
h
 + 
v
 * 13];

774 
l
 = 0, 
r
 = 0;Ü <
SˇÀCutOffFv
;Ü++)

776 
k
 = 0; k <
SˇÀCutOffFh
; k += 4)

778 
B
[
k
][
l
] = 
gaussünLUT
[
p£udoR™dVÆEhv
 % 2048];

779 
B
[
k
 + 1][
l
] = 
gaussünLUT
[(
p£udoR™dVÆEhv
 + 1) % 2048];

780 
B
[
k
 + 2][
l
] = 
gaussünLUT
[(
p£udoR™dVÆEhv
 + 2) % 2048];

781 
B
[
k
 + 3][
l
] = 
gaussünLUT
[(
p£udoR™dVÆEhv
 + 3) % 2048];

782 
r
++;

783 
p£udoR™dVÆEhv
 = 
	`¥ng
(pseudoRandValEhv);

786 
B
[0][0] = 0;

788 
i
 = 0; i < 
DATA_BASE_SIZE
; i++)

790 
j
 = 0; j < 
DATA_BASE_SIZE
; j++)

792 
k
 = 0; k < 
DATA_BASE_SIZE
; k++)

794 
bIDCT
[
i
][
j
] +
R64_IDCT_TR
[i][
k
] * 
B
[k][j];

796 
bIDCT
[
i
][
j
] += 128;

797 
bIDCT
[
i
][
j
] = bIDCT[i][j] >> 8;

801 
i
 = 0; i < 
DATA_BASE_SIZE
; i++)

803 
j
 = 0; j < 
DATA_BASE_SIZE
; j++)

805 
k
 = 0; k < 
DATA_BASE_SIZE
; k++)

807 
bGøö
[
i
][
j
] +
bIDCT
[i][
k
] * 
R64_IDCT
[k][j];

809 
bGøö
[
i
][
j
] += 128;

810 
bGøö
[
i
][
j
] = bGrain[i][j] >> 8;

811 
m_pGøöSy¡
->
d©aBa£
[
h
][
v
][
j
][
i
] = 
	`CLIP3
(-127, 127, 
bGøö
[i][j]);

816 i‡(
m_íabÀDeblockög
)

818 
l
 = 0;Ü < 
DATA_BASE_SIZE
;Ü += 8)

820 
k
 = 0; k < 
DATA_BASE_SIZE
; k++)

822 
m_pGøöSy¡
->
d©aBa£
[
h
][
v
][
l
][
k
] = ((m_pGøöSy¡->d©aBa£[h][v][l][k]Ë* 
deblockFa˘‹
[v]) >> 7;

823 
m_pGøöSy¡
->
d©aBa£
[
h
][
v
][
l
 + 7][
k
] = ((m_pGøöSy¡->d©aBa£[h][v][»+ 7][k]Ë* 
deblockFa˘‹
[v]) >> 7;

831 
	}
}

835 
uöt8_t
 
	gSEIFûmGøöSy¡hesizî
::
	$gøöVÆid©eP¨ams
()

837 
uöt8_t
 
numComp
 = 
MAX_NUM_COMPONENT
;

838 
uöt8_t
 
compCå
, 
öãnsôyCå
, 
mu…iGøöCheck
[
MAX_NUM_COMPONENT
][
MAX_NUM_INTENSITIES
] = {{ 0 }};

839 
uöt16_t
 
mu…iGøöCå
;

840 
uöt8_t
 
limôCompModñVÆ1
[10] = { 0 }, 
limôCompModñVÆ2
[10] = { 0 };

841 
uöt8_t
 
num_comp_modñ_∑ús
 = 0, 
limôCompModñCå
, 
compPaúM©ch
;

843 
	`mem£t
(
m_pGøöSy¡
->
öãnsôyI¡îvÆ
, 
INTENSITY_INTERVAL_MATCH_FAIL
,

844 (
m_pGøöSy¡
->
öãnsôyI¡îvÆ
));

846 i‡((
m_width
 < 
MIN_WIDTH
Ë|| (m_width > 
MAX_WIDTH
) || (m_width % 4))

848  
FGS_INVALID_WIDTH
;

850 i‡((
m_height
 < 
MIN_HEIGHT
Ë|| (m_heighà> 
MAX_HEIGHT
) || (m_height % 4))

852  
FGS_INVALID_HEIGHT
;

854 i‡((
m_chromaF‹m©
 < 
MIN_CHROMA_FORMAT_IDC
Ë|| (m_chromaF‹m© > 
MAX_CHROMA_FORMAT_IDC
))

856  
FGS_INVALID_CHROMA_FORMAT
;

858 i‡(
m_chromaF‹m©
 =
MIN_CHROMA_FORMAT_IDC
)

860 
numComp
 = 1;

863 i‡((
m_bôDïth
 < 
MIN_BIT_DEPTH
Ë|| (m_bôDïth > 
MAX_BIT_DEPTH
))

865  
FGS_INVALID_BIT_DEPTH
;

868 i‡((0 !
m_pFgcP¨amëîs
->
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
) &&

869 (1 !
m_pFgcP¨amëîs
->
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
))

871  
FGS_INVALID_FGC_CANCEL_FLAG
;

874 i‡(
FILM_GRAIN_MODEL_ID_VALUE
 !
m_pFgcP¨amëîs
->
m_fûmGøöModñId
)

876  
FGS_INVALID_GRAIN_MODEL_ID
;

879 i‡(0 !
m_pFgcP¨amëîs
->
m_£∑øãCﬁourDes¸ùti⁄Pª£¡Fœg
)

881  
FGS_INVALID_SEP_COL_DES_FLAG
;

884 i‡(
BLENDING_MODE_VALUE
 !
m_pFgcP¨amëîs
->
m_bÀndögModeId
)

886  
FGS_INVALID_BLEND_MODE
;

889 i‡((
m_pFgcP¨amëîs
->
m_log2SˇÀFa˘‹
 < 
MIN_LOG2SCALE_VALUE
) ||

890 (
m_pFgcP¨amëîs
->
m_log2SˇÀFa˘‹
 > 
MAX_LOG2SCALE_VALUE
))

892  
FGS_INVALID_LOG2_SCALE_FACTOR
;

896 
compCå
 = 0; compCå < 
numComp
; compCtr++)

898 i‡((
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
bPª£¡Fœg
 !
åue
) &&

899 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
bPª£¡Fœg
 !
Ál£
))

901  
FGS_INVALID_COMP_MODEL_PRESENT_FLAG
;

903 i‡(
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
bPª£¡Fœg
 &&

904 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
numModñVÆues
 > 
MAX_ALLOWED_MODEL_VALUES
))

906  
FGS_INVALID_NUM_MODEL_VALUES
;

911 
compCå
 = 0; compCå < 
numComp
; compCtr++)

913 i‡(
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
bPª£¡Fœg
)

915 
öãnsôyCå
 = 0; i¡ísôyCå < 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
.
	`size
(); intensityCtr++)

918 i‡(
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
öãnsôyI¡îvÆLowîBound
 >

919 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
öãnsôyI¡îvÆUµîBound
)

921  
FGS_INVALID_INTENSITY_BOUNDARY_VALUES
;

924 
mu…iGøöCå
 = 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
öãnsôyI¡îvÆLowîBound
;

925 
mu…iGøöCå
 <
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
öãnsôyI¡îvÆUµîBound
; multiGrainCtr++)

927 
m_pGøöSy¡
->
öãnsôyI¡îvÆ
[
compCå
][
mu…iGøöCå
] = 
öãnsôyCå
;

928 i‡(
mu…iGøöCheck
[
compCå
][
mu…iGøöCå
])

930  
FGS_INVALID_INTENSITY_BOUNDARY_VALUES
;

934 
mu…iGøöCheck
[
compCå
][
mu…iGøöCå
] = 1;

938 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
.
	`ªsize
(
MAX_NUM_MODEL_VALUES
);

940 i‡(1 =
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
numModñVÆues
)

942 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1] = 
DEFAULT_HORZ_CUT_OFF_FREQUENCY
;

943 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2] =

944 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1];

946 i‡(2 =
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
numModñVÆues
)

948 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2] =

949 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1];

953 i‡(
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[0] > (
MAX_STANDARD_DEVIATION
 << (
m_bôDïth
 - 
BIT_DEPTH_8
)))

955  
FGS_INVALID_STANDARD_DEVIATION
;

957 i‡((
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1] < 
MIN_CUT_OFF_FREQUENCY
) ||

958 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1] > 
MAX_CUT_OFF_FREQUENCY
))

960  
FGS_INVALID_CUT_OFF_FREQUENCIES
;

962 i‡((
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2] < 
MIN_CUT_OFF_FREQUENCY
) ||

963 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2] > 
MAX_CUT_OFF_FREQUENCY
))

965  
FGS_INVALID_CUT_OFF_FREQUENCIES
;

969 i‡((
CHROMA_444
 !
m_chromaF‹m©
Ë&& (
compCå
 > 0))

971 i‡(
CHROMA_420
 =
m_chromaF‹m©
)

973 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[0] >>= 1;

974 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1] =

975 
	`CLIP3
(
MIN_CUT_OFF_FREQUENCY
, 
MAX_CUT_OFF_FREQUENCY
,

976 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1] << 1));

977 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2] =

978 
	`CLIP3
(
MIN_CUT_OFF_FREQUENCY
, 
MAX_CUT_OFF_FREQUENCY
,

979 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2] << 1));

982 i‡(
CHROMA_422
 =
m_chromaF‹m©
)

984 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[0] =

985 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[0] * 
SCALE_DOWN_422
Ë>> 
Q_FORMAT_SCALING
;

987 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1] =

988 
	`CLIP3
(
MIN_CUT_OFF_FREQUENCY
, 
MAX_CUT_OFF_FREQUENCY
,

989 (
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1] << 1));

994 
compPaúM©ch
 = 0;

995 
limôCompModñCå
 = 0;ÜimôCompModñCå <
num_comp_modñ_∑ús
;ÜimitCompModelCtr++)

997 i‡((
limôCompModñVÆ1
[
limôCompModñCå
] ==

998 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1]) &&

999 (
limôCompModñVÆ2
[
limôCompModñCå
] ==

1000 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2]))

1002 
compPaúM©ch
 = 1;

1006 i‡(0 =
compPaúM©ch
)

1008 
num_comp_modñ_∑ús
++;

1010 i‡(
num_comp_modñ_∑ús
 > 
MAX_ALLOWED_COMP_MODEL_PAIRS
)

1012  
FGS_INVALID_NUM_CUT_OFF_FREQ_PAIRS
;

1014 
limôCompModñVÆ1
[
num_comp_modñ_∑ús
 - 1] =

1015 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[1];

1016 
limôCompModñVÆ2
[
num_comp_modñ_∑ús
 - 1] =

1017 
m_pFgcP¨amëîs
->
m_compModñ
[
compCå
].
öãnsôyVÆues
[
öãnsôyCå
].
compModñVÆue
[2];

1023 i‡(0 !
m_pFgcP¨amëîs
->
m_fûmGøöCh¨a˘îi°icsPîsi°í˚Fœg
)

1025  
FGS_INVALID_FGC_REPETETION_PERIOD
;

1027  
FGS_SUCCESS
;

1028 
	}
}

1030 
uöt32_t
 
	gSEIFûmGøöSy¡hesizî
::
	$¥ng
(
uöt32_t
 
x_r
)

1032 
uöt32_t
 
addVÆ
;

1033 
addVÆ
 = (1 + ((
x_r
 & (
POS_2
)Ë> 0Ë+ ((x_∏& (
POS_30
)) > 0)) % 2;

1034 
x_r
 = (x_∏<< 1Ë+ 
addVÆ
;

1035  
x_r
;

1036 
	}
}

1039 
Pñ
 
	gSEIFûmGøöSy¡hesizî
::
	$blockAvîage
(
Pñ
 *
decSam∂eBlk8
,

1040 
uöt32_t
 
widthComp
,

1041 
uöt16_t
 *
pNumSam∂es
,

1042 
uöt8_t
 
ySize
,

1043 
uöt8_t
 
xSize
,

1044 
uöt8_t
 
bôDïth
)

1046 
uöt32_t
 
blockAvg
 = 0;

1047 
uöt8_t
 
k
, 
l
;

1048 
uöt16_t
 
numSam∂es
 = 0;

1050 
k
 = 0; k < 
ySize
; k++)

1052 
l
 = 0;Ü < 
xSize
;Ü++)

1054 
blockAvg
 +*(
decSam∂eBlk8
 + 
l
 + (
k
*
widthComp
));

1055 
numSam∂es
++;

1058 i‡(
numSam∂es
 > 0)

1060 
blockAvg
 /
numSam∂es
;

1061 
blockAvg
 >>(
bôDïth
 - 
BIT_DEPTH_8
);

1064 
	`as£π
(
blockAvg
 < (1 << 
BIT_DEPTH_8
));

1065 *
pNumSam∂es
 = 
numSam∂es
;

1067 
blockAvg
 = 
	`CLIP3
(0, (1 << 
BIT_DEPTH_8
) - 1, blockAvg);

1068  
blockAvg
;

1069 
	}
}

1070 
	gSEIFûmGøöSy¡hesizî
::
	$deblockGøöSåùe
(
öt32_t
 *
gøöSåùe
, 
uöt32_t
 
widthComp
, uöt32_à
°rideComp
)

1072 
öt32_t
 
À·1
, 
À·0
, 
right0
, 
right1
;

1073 
uöt32_t
 
pos8
, 
vîtCå
;

1075 
pos8
 = 0;Öos8 < (
widthComp
 - 
BLK_8
);Öos8 += BLK_8)

1077 
vîtCå
 = 0; vîtCå < 
BLK_16
; vertCtr++)

1079 
À·1
 = *(
gøöSåùe
 + 
pos8
 + 6 + (
vîtCå
*
°rideComp
));

1080 
À·0
 = *(
gøöSåùe
 + 
pos8
 + 7 + (
vîtCå
*
°rideComp
));

1081 
right0
 = *(
gøöSåùe
 + 
pos8
 + 
BLK_8
 + 0 + (
vîtCå
*
°rideComp
));

1082 
right1
 = *(
gøöSåùe
 + 
pos8
 + 
BLK_8
 + 1 + (
vîtCå
*
°rideComp
));

1083 *(
gøöSåùe
 + 
pos8
 + 
BLK_8
 + 0 + (
vîtCå
*
°rideComp
)Ë(
À·0
 + (
right0
 << 1Ë+ 
right1
) >> 2;

1084 *(
gøöSåùe
 + 
pos8
 + 7 + (
vîtCå
*
°rideComp
)Ë(
À·1
 + (
À·0
 << 1Ë+ 
right0
) >> 2;

1088 
	}
}

1089 
	gSEIFûmGøöSy¡hesizî
::
	$bÀndSåùe
(
Pñ
 *
decSam∂eOff£tY
, 
öt32_t
 *
gøöSåùe
,

1090 
uöt32_t
 
widthComp
, uöt32_à
blockHeight
, 
uöt8_t
 
bôDïth
)

1092 
uöt32_t
 
k
, 
l
;

1093 
öt32_t
 
gøöSam∂e
;

1094 
Pñ
 
decodeSam∂e
;

1095 
uöt16_t
 
maxR™ge
;

1096 
maxR™ge
 = (1 << 
bôDïth
) - 1;

1097 
l
 = 0;Ü < 
blockHeight
;Ü++)

1099 
k
 = 0; k < 
widthComp
; k++)

1101 
decodeSam∂e
 = *(
decSam∂eOff£tY
 + 
k
 + (
l
*
widthComp
));

1102 
gøöSam∂e
 = *(
gøöSåùe
 + 
k
 + (
l
*
widthComp
));

1103 
gøöSam∂e
 <<(
bôDïth
 - 
BIT_DEPTH_8
);

1104 
gøöSam∂e
 = 
	`CLIP3
(0, 
maxR™ge
, gøöSam∂ê+ 
decodeSam∂e
);

1105 *(
decSam∂eOff£tY
 + 
k
 + (
l
*
widthComp
)Ë(
Pñ
)
gøöSam∂e
;

1109 
	}
}

1112 
	gSEIFûmGøöSy¡hesizî
::
	$simuœãGøöBlk8x8
(
öt32_t
 *
gøöSåùe
, 
uöt32_t
 
gøöSåùeOff£tBlk8
,

1113 
GøöSy¡hesisSåu˘
 *
pGøöSy¡
, 
uöt32_t
 
width
, 
uöt8_t
 
log2SˇÀFa˘‹
,

1114 
öt16_t
 
sˇÀFa˘‹
, 
uöt32_t
 
kOff£t
, uöt32_à
lOff£t
,

1115 
uöt8_t
 
h
, uöt8_à
v
, 
uöt32_t
 
xSize
)

1117 
uöt32_t
 
k
, 
l
;

1118 
l
 = 0;Ü < 
BLK_8
;Ü++)

1120 
k
 = 0; k < 
xSize
; k++)

1122 *(
gøöSåùe
 + 
gøöSåùeOff£tBlk8
 + 
k
 + (
l
*
width
)) =

1123 ((
sˇÀFa˘‹
 *

1124 
pGøöSy¡
->
d©aBa£
[
h
][
v
][
l
 + 
lOff£t
][
k
 + 
kOff£t
]Ë>> (
log2SˇÀFa˘‹
 + 
GRAIN_SCALE
));

1128 
	}
}

	@TLibCommon/SEIFilmGrainSynthesizer.h

39 #i‚de‡
__SEIFILMGRAINSYNTHESIZER__


40 
	#__SEIFILMGRAINSYNTHESIZER__


	)

42 
	~"SEI.h
"

43 
	~"TComPicYuv.h
"

52 
	#MAX_ALLOWED_MODEL_VALUES
 3

	)

53 
	#MIN_LOG2SCALE_VALUE
 2

	)

54 
	#MAX_LOG2SCALE_VALUE
 7

	)

55 
	#FILM_GRAIN_MODEL_ID_VALUE
 0

	)

56 
	#BLENDING_MODE_VALUE
 0

	)

57 
	#MAX_STANDARD_DEVIATION
 255

	)

58 
	#MIN_CUT_OFF_FREQUENCY
 2

	)

59 
	#MAX_CUT_OFF_FREQUENCY
 14

	)

60 
	#DEFAULT_HORZ_CUT_OFF_FREQUENCY
 8

	)

61 
	#MAX_ALLOWED_COMP_MODEL_PAIRS
 10

	)

63 
	#SCALE_DOWN_422
 181

	)

64 
	#Q_FORMAT_SCALING
 8

	)

65 
	#GRAIN_SCALE
 6

	)

66 
	#MIN_CHROMA_FORMAT_IDC
 0

	)

67 
	#MAX_CHROMA_FORMAT_IDC
 3

	)

68 
	#MIN_BIT_DEPTH
 8

	)

69 
	#MAX_BIT_DEPTH
 16

	)

70 
	#BIT_DEPTH_8
 8

	)

71 
	#NUM_8x8_BLKS_16x16
 4

	)

72 
	#BLK_8
 8

	)

73 
	#BLK_16
 16

	)

74 
	#INTENSITY_INTERVAL_MATCH_FAIL
 -1

	)

75 
	#COLOUR_OFFSET_LUMA
 0

	)

76 
	#COLOUR_OFFSET_CR
 85

	)

77 
	#COLOUR_OFFSET_CB
 170

	)

79 
	#NUM_CUT_OFF_FREQ
 13

	)

80 
	#DATA_BASE_SIZE
 64

	)

82 
	#MIN_WIDTH
 128

	)

83 
	#MAX_WIDTH
 7680

	)

84 
	#MIN_HEIGHT
 128

	)

85 
	#MAX_HEIGHT
 4320

	)

87 
	#MIN_CHROMA_FORMAT_IDC
 0

	)

88 
	#MAX_CHROMA_FORMAT_IDC
 3

	)

89 
	#MIN_BIT_DEPTH
 8

	)

90 
	#MAX_BIT_DEPTH
 16

	)

91 
	#BIT_DEPTH_8
 8

	)

92 
	#NUM_8x8_BLKS_16x16
 4

	)

93 
	#BLK_8
 8

	)

94 
	#BLK_16
 16

	)

95 
	#INTENSITY_INTERVAL_MATCH_FAIL
 -1

	)

96 
	#COLOUR_OFFSET_LUMA
 0

	)

97 
	#COLOUR_OFFSET_CR
 85

	)

98 
	#COLOUR_OFFSET_CB
 170

	)

100 
	#CLIP3
(
mö
, 
max
, 
x
Ë(((xË> (max)Ë? (maxË:(((xË< (mö))? (mö):(x)))

	)

101 
	#MIN
(
x
,
y
Ë(((xË> (y)Ë? (yË: (x))

	)

102 
	#MSB16
(
x
Ë((x&0xFFFF0000)>>16)

	)

103 
	#LSB16
(
x
Ë(x&0x0000FFFF)

	)

104 
	#BIT0
(
x
Ë(x&0x1)

	)

105 
	#POS_30
 (1<<30)

	)

106 
	#POS_2
 (1<<2)

	)

109 
	#FGS_FILE_IO_ERROR
 0x0010

	)

110 
	#FGS_PARAM_ERROR
 0x0020

	)

116 
	mFGS_SUCCESS
 = 0,

118 
	mFGS_INVALID_WIDTH
 = 
FGS_FILE_IO_ERROR
 + 0x01,

120 
	mFGS_INVALID_HEIGHT
 = 
FGS_FILE_IO_ERROR
 + 0x02,

122 
	mFGS_INVALID_CHROMA_FORMAT
 = 
FGS_FILE_IO_ERROR
 + 0x03,

124 
	mFGS_INVALID_BIT_DEPTH
 = 
FGS_FILE_IO_ERROR
 + 0x04,

127 
	mFGS_INVALID_FGC_CANCEL_FLAG
 = 
FGS_PARAM_ERROR
 + 0x01,

129 
	mFGS_INVALID_GRAIN_MODEL_ID
 = 
FGS_PARAM_ERROR
 + 0x02,

131 
	mFGS_INVALID_SEP_COL_DES_FLAG
 = 
FGS_PARAM_ERROR
 + 0x03,

133 
	mFGS_INVALID_BLEND_MODE
 = 
FGS_PARAM_ERROR
 + 0x04,

135 
	mFGS_INVALID_LOG2_SCALE_FACTOR
 = 
FGS_PARAM_ERROR
 + 0x05,

137 
	mFGS_INVALID_COMP_MODEL_PRESENT_FLAG
 = 
FGS_PARAM_ERROR
 + 0x06,

139 
	mFGS_INVALID_NUM_MODEL_VALUES
 = 
FGS_PARAM_ERROR
 + 0x07,

141 
	mFGS_INVALID_INTENSITY_BOUNDARY_VALUES
 = 
FGS_PARAM_ERROR
 + 0x08,

143 
	mFGS_INVALID_STANDARD_DEVIATION
 = 
FGS_PARAM_ERROR
 + 0x09,

145 
	mFGS_INVALID_CUT_OFF_FREQUENCIES
 = 
FGS_PARAM_ERROR
 + 0x0A,

147 
	mFGS_INVALID_NUM_CUT_OFF_FREQ_PAIRS
 = 
FGS_PARAM_ERROR
 + 0x0B,

149 
	mFGS_INVALID_FGC_REPETETION_PERIOD
 = 
FGS_PARAM_ERROR
 + 0x0C,

152 
	mFGS_FAIL
 = 0xFF

153 }
	tFGS_ERROR_T
;

156 
	sGøöSy¡hesisSåu˘_t


158 
öt8_t
 
	md©aBa£
[
NUM_CUT_OFF_FREQ
][NUM_CUT_OFF_FREQ][
DATA_BASE_SIZE
][DATA_BASE_SIZE];

159 
öt16_t
 
	möãnsôyI¡îvÆ
[
MAX_NUM_COMPONENT
][
MAX_NUM_INTENSITIES
];

160 }
	tGøöSy¡hesisSåu˘
;

162 ˛as†
	cSEIFûmGøöSy¡hesizî


165 
	m¥iv©e
:

166 
uöt32_t
 
m_width
;

167 
uöt32_t
 
	mm_height
;

168 
ChromaF‹m©
 
	mm_chromaF‹m©
;

169 
uöt8_t
 
	mm_bôDïth
;

170 
uöt32_t
 
	mm_idrPicId
;

171 
uöt8_t
 
	mm_íabÀDeblockög
;

173 
GøöSy¡hesisSåu˘
 *
	mm_pGøöSy¡
;

174 
	mpublic
:

175 
uöt32_t
 
m_poc
;

176 
uöt32_t
 
	mm_îr‹Code
;

177 
SEIFûmGøöCh¨a˘îi°ics
 *
	mm_pFgcP¨amëîs
;

179 
	mpublic
:

180 
SEIFûmGøöSy¡hesizî
();

181 
¸óã
(
uöt32_t
 
width
, uöt32_à
height
, 
ChromaF‹m©
 
fmt
, 
uöt8_t
 
bôDïth
,

182 
uöt32_t
 
idrPicId
, 
uöt8_t
 
íabÀDeblockög
);

184 
	mvútuÆ
 ~
SEIFûmGøöSy¡hesizî
();

186 
fgsInô
();

187 
fgsDeöô
();

188 
gøöSy¡hesizeAndBÀnd
(
TComPicYuv
* 
pGøöBuf
, 
Boﬁ
 
isIdrPic
);

189 
uöt8_t
 
gøöVÆid©eP¨ams
();

191 
	m¥iv©e
:

192 
d©aBa£Gí
();

193 
uöt32_t
 
¥ng
(uöt32_à
x_r
);

194 
Pñ
 
blockAvîage
(Pñ *
decSam∂eBlk8
,

195 
uöt32_t
 
widthComp
,

196 
uöt16_t
 *
pNumSam∂es
,

197 
uöt8_t
 
ySize
,

198 
uöt8_t
 
xSize
,

199 
uöt8_t
 
bôDïth
);

200 
deblockGøöSåùe
(
öt32_t
 *
gøöSåùe
, 
uöt32_t
 
widthComp
, uöt32_à
°rideComp
);

201 
bÀndSåùe
(
Pñ
 *
decSam∂eOff£tY
, 
öt32_t
 *
gøöSåùe
,

202 
uöt32_t
 
widthComp
, uöt32_à
blockHeight
, 
uöt8_t
 
bôDïth
);

203 
simuœãGøöBlk8x8
(
öt32_t
 *
gøöSåùe
, 
uöt32_t
 
gøöSåùeOff£tBlk8
,

204 
GøöSy¡hesisSåu˘
 *
pGøöSy¡
, 
uöt32_t
 
width
, 
uöt8_t
 
log2SˇÀFa˘‹
,

205 
öt16_t
 
sˇÀFa˘‹
, 
uöt32_t
 
kOff£t
, uöt32_à
lOff£t
,

206 
uöt8_t
 
h
, uöt8_à
v
, 
uöt32_t
 
xSize
);

	@TLibCommon/TComBitCounter.h

38 #i‚de‡
__TCOMBITCOUNTER__


39 
	#__TCOMBITCOUNTER__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TComBôSåóm.h
"

55 ˛as†
	cTComBôCou¡î
 : 
public
 
TComBôIf


57 
¥Ÿe˘ed
:

58 
UI¡
 
m_uiBôCou¡î
;

60 
	mpublic
:

61 
	$TComBôCou¡î
() {}

62 
vútuÆ
 ~
	$TComBôCou¡î
(Ë{
	}
}

64 
Void
 
	$wrôe
 ( 
UI¡
 , UI¡ 
uiNumbîOfBôs
 ) { 
m_uiBôCou¡î
 +uiNumbîOfBôs; 
	}
}

65 
Void
 
	$ª£tBôs
 (Ë{ 
m_uiBôCou¡î
 = 0; 
	}
}

66 
UI¡
 
	$gëNumbîOfWrôãnBôs
(Ëc⁄° {  
m_uiBôCou¡î
; 
	}
}

67 
I¡
 
	$gëNumBôsU¡ûByãAlig√d
(Ëc⁄° {  (8 - 
m_uiBôCou¡î
Ë& 0x7;
	}
}

	@TLibCommon/TComBitStream.cpp

38 
	~<°döt.h
>

39 
	~<ve˘‹
>

40 
	~"TComBôSåóm.h
"

41 
	~<°rög.h
>

42 
	~<mem‹y.h
>

44 
usög
 
«me•a˚
 
	g°d
;

53 
	gTComOuçutBô°ªam
::
	$TComOuçutBô°ªam
()

55 
	`˛ór
();

56 
	}
}

58 
	gTComOuçutBô°ªam
::~
	$TComOuçutBô°ªam
()

60 
	}
}

63 
TComI≈utBô°ªam
::
	$TComI≈utBô°ªam
()

64 : 
	`m_fifo
()

65 , 
	`m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
()

66 , 
	`m_fifo_idx
(0)

67 , 
	`m_num_hñd_bôs
(0)

68 , 
	`m_hñd_bôs
(0)

69 , 
	$m_numBôsRód
(0)

70 { 
	}
}

72 
	gTComI≈utBô°ªam
::
	$TComI≈utBô°ªam
(c⁄° 
TComI≈utBô°ªam
 &
§c
)

73 : 
	`m_fifo
(
§c
.
m_fifo
)

74 , 
	`m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
(
§c
.
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
)

75 , 
	`m_fifo_idx
(
§c
.
m_fifo_idx
)

76 , 
	`m_num_hñd_bôs
(
§c
.
m_num_hñd_bôs
)

77 , 
	`m_hñd_bôs
(
§c
.
m_hñd_bôs
)

78 , 
	$m_numBôsRód
(
§c
.
m_numBôsRód
)

79 { 
	}
}

85 
Void
 
	gTComI≈utBô°ªam
::
	$ª£tToSèπ
()

87 
m_fifo_idx
=0;

88 
m_num_hñd_bôs
=0;

89 
m_hñd_bôs
=0;

90 
m_numBôsRód
=0;

91 
	}
}

93 
UCh¨
* 
	gTComOuçutBô°ªam
::
	$gëByãSåóm
() const

95  (
UCh¨
*Ë&
m_fifo
.
	`‰⁄t
();

96 
	}
}

98 
UI¡
 
	gTComOuçutBô°ªam
::
	$gëByãSåómLígth
()

100  
	`UI¡
(
m_fifo
.
	`size
());

101 
	}
}

103 
Void
 
	gTComOuçutBô°ªam
::
	$˛ór
()

105 
m_fifo
.
	`˛ór
();

106 
m_hñd_bôs
 = 0;

107 
m_num_hñd_bôs
 = 0;

108 
	}
}

110 
Void
 
	gTComOuçutBô°ªam
::
	$wrôe
 ( 
UI¡
 
uiBôs
, UI¡ 
uiNumbîOfBôs
 )

112 
	`as£π
–
uiNumbîOfBôs
 <= 32 );

113 
	`as£π
–
uiNumbîOfBôs
 =32 || (
uiBôs
 & (~0 << uiNumberOfBits)) == 0 );

117 
UI¡
 
num_tŸÆ_bôs
 = 
uiNumbîOfBôs
 + 
m_num_hñd_bôs
;

118 
UI¡
 
√xt_num_hñd_bôs
 = 
num_tŸÆ_bôs
 % 8;

126 
UCh¨
 
√xt_hñd_bôs
 = 
uiBôs
 << (8 - 
√xt_num_hñd_bôs
);

128 i‡(!(
num_tŸÆ_bôs
 >> 3))

133 
m_hñd_bôs
 |
√xt_hñd_bôs
;

134 
m_num_hñd_bôs
 = 
√xt_num_hñd_bôs
;

139 
UI¡
 
t›w‹d
 = (
uiNumbîOfBôs
 - 
√xt_num_hñd_bôs
) & ~((1 << 3) -1);

140 
UI¡
 
wrôe_bôs
 = (
m_hñd_bôs
 << 
t›w‹d
Ë| (
uiBôs
 >> 
√xt_num_hñd_bôs
);

142 
num_tŸÆ_bôs
 >> 3)

144 4: 
m_fifo
.
	`push_back
(
wrôe_bôs
 >> 24);

145 3: 
m_fifo
.
	`push_back
(
wrôe_bôs
 >> 16);

146 2: 
m_fifo
.
	`push_back
(
wrôe_bôs
 >> 8);

147 1: 
m_fifo
.
	`push_back
(
wrôe_bôs
);

150 
m_hñd_bôs
 = 
√xt_hñd_bôs
;

151 
m_num_hñd_bôs
 = 
√xt_num_hñd_bôs
;

152 
	}
}

154 
Void
 
	gTComOuçutBô°ªam
::
	$wrôeAlignO√
()

156 
UI¡
 
num_bôs
 = 
	`gëNumBôsU¡ûByãAlig√d
();

157 
	`wrôe
((1 << 
num_bôs
) - 1,Çum_bits);

159 
	}
}

161 
Void
 
	gTComOuçutBô°ªam
::
	$wrôeAlignZîo
()

163 i‡(0 =
m_num_hñd_bôs
)

167 
m_fifo
.
	`push_back
(
m_hñd_bôs
);

168 
m_hñd_bôs
 = 0;

169 
m_num_hñd_bôs
 = 0;

170 
	}
}

177 
Void
 
	gTComOuçutBô°ªam
::
	$addSub°ªam
–
TComOuçutBô°ªam
* 
pcSub°ªam
 )

179 
UI¡
 
uiNumBôs
 = 
pcSub°ªam
->
	`gëNumbîOfWrôãnBôs
();

181 c⁄° 
ve˘‹
<
uöt8_t
>& 
rb•
 = 
pcSub°ªam
->
	`gëFIFO
();

182 
ve˘‹
<
uöt8_t
>::
c⁄°_ôî©‹
 
ô
 = 
rb•
.
	`begö
(); ià!rb•.
	`íd
();)

184 
	`wrôe
(*
ô
++, 8);

186 i‡(
uiNumBôs
&0x7)

188 
	`wrôe
(
pcSub°ªam
->
	`gëHñdBôs
()>>(8-(
uiNumBôs
&0x7)), uiNumBits&0x7);

190 
	}
}

192 
Void
 
	gTComOuçutBô°ªam
::
	$wrôeByãAlignmít
()

194 
	`wrôe
( 1, 1);

195 
	`wrôeAlignZîo
();

196 
	}
}

198 
I¡
 
	gTComOuçutBô°ªam
::
	$cou¡SèπCodeEmuœti⁄s
()

200 
UI¡
 
˙t
 = 0;

201 
ve˘‹
<
uöt8_t
>& 
rb•
 = 
	`gëFIFO
();

202 
ve˘‹
<
uöt8_t
>::
ôî©‹
 
ô
 = 
rb•
.
	`begö
(); ià!rb•.
	`íd
();)

204 
ve˘‹
<
uöt8_t
>::
ôî©‹
 
found
 = 
ô
;

209 
found
 = 
	`£¨ch_n
(found, 
rb•
.
	`íd
()-1, 2, 0);

210 
found
++;

212 i‡(
found
 =
rb•
.
	`íd
())

216 i‡(*(++
found
) <= 3)

220 } 
åue
);

221 
ô
 = 
found
;

222 i‡(
found
 !
rb•
.
	`íd
())

224 
˙t
++;

227  
˙t
;

228 
	}
}

238 
Void
 
	gTComI≈utBô°ªam
::
	$p£udoRód
 ( 
UI¡
 
uiNumbîOfBôs
, UI¡& 
ruiBôs
 )

240 
UI¡
 
ßved_num_hñd_bôs
 = 
m_num_hñd_bôs
;

241 
UCh¨
 
ßved_hñd_bôs
 = 
m_hñd_bôs
;

242 
UI¡
 
ßved_fifo_idx
 = 
m_fifo_idx
;

244 
UI¡
 
num_bôs_to_ªad
 = 
	`mö
(
uiNumbîOfBôs
, 
	`gëNumBôsLe·
());

245 
	`ªad
(
num_bôs_to_ªad
, 
ruiBôs
);

246 
ruiBôs
 <<(
uiNumbîOfBôs
 - 
num_bôs_to_ªad
);

248 
m_fifo_idx
 = 
ßved_fifo_idx
;

249 
m_hñd_bôs
 = 
ßved_hñd_bôs
;

250 
m_num_hñd_bôs
 = 
ßved_num_hñd_bôs
;

251 
	}
}

254 
Void
 
	gTComI≈utBô°ªam
::
	$ªad
 (
UI¡
 
uiNumbîOfBôs
, UI¡& 
ruiBôs
)

256 
	`as£π
–
uiNumbîOfBôs
 <= 32 );

258 
m_numBôsRód
 +
uiNumbîOfBôs
;

261 
UI¡
 
ªtvÆ
 = 0;

262 i‡(
uiNumbîOfBôs
 <
m_num_hñd_bôs
)

267 
ªtvÆ
 = 
m_hñd_bôs
 >> (
m_num_hñd_bôs
 - 
uiNumbîOfBôs
);

268 
ªtvÆ
 &~(0xf‡<< 
uiNumbîOfBôs
);

269 
m_num_hñd_bôs
 -
uiNumbîOfBôs
;

270 
ruiBôs
 = 
ªtvÆ
;

279 
uiNumbîOfBôs
 -
m_num_hñd_bôs
;

280 
ªtvÆ
 = 
m_hñd_bôs
 & ~(0xf‡<< 
m_num_hñd_bôs
);

281 
ªtvÆ
 <<
uiNumbîOfBôs
;

291 
UI¡
 
Æig√d_w‹d
 = 0;

292 
UI¡
 
num_byãs_to_lﬂd
 = (
uiNumbîOfBôs
 - 1) >> 3;

293 
	`as£π
(
m_fifo_idx
 + 
num_byãs_to_lﬂd
 < 
m_fifo
.
	`size
());

295 
num_byãs_to_lﬂd
)

297 3: 
Æig√d_w‹d
 = 
m_fifo
[
m_fifo_idx
++] << 24;

298 2: 
Æig√d_w‹d
 |
m_fifo
[
m_fifo_idx
++] << 16;

299 1: 
Æig√d_w‹d
 |
m_fifo
[
m_fifo_idx
++] << 8;

300 0: 
Æig√d_w‹d
 |
m_fifo
[
m_fifo_idx
++];

304 
UI¡
 
√xt_num_hñd_bôs
 = (32 - 
uiNumbîOfBôs
) % 8;

307 
ªtvÆ
 |
Æig√d_w‹d
 >> 
√xt_num_hñd_bôs
;

310 
m_num_hñd_bôs
 = 
√xt_num_hñd_bôs
;

311 
m_hñd_bôs
 = 
Æig√d_w‹d
;

313 
ruiBôs
 = 
ªtvÆ
;

314 
	}
}

320 
Void
 
	gTComOuçutBô°ªam
::
	$ö£πAt
(c⁄° 
TComOuçutBô°ªam
& 
§c
, 
UI¡
 
pos
)

322 
UI¡
 
§c_bôs
 = 
§c
.
	`gëNumbîOfWrôãnBôs
();

323 
	`as£π
(0 =
§c_bôs
 % 8);

325 
ve˘‹
<
uöt8_t
>::
ôî©‹
 
©
 = 
m_fifo
.
	`begö
(Ë+ 
pos
;

326 
m_fifo
.
	`ö£π
(
©
, 
§c
.m_fifo.
	`begö
(), src.m_fifo.
	`íd
());

327 
	}
}

329 
UI¡
 
	gTComI≈utBô°ªam
::
	$ªadOutTøûögBôs
 ()

331 
UI¡
 
cou¡
=0;

332 
UI¡
 
uiBôs
 = 0;

334  ( 
	`gëNumBôsLe·
(Ë> 0 ) && (
	`gëNumBôsU¡ûByãAlig√d
()!=0) )

336 
cou¡
++;

337 
	`ªad
 ( 1, 
uiBôs
 );

339  
cou¡
;

340 
	}
}

358 
TComI≈utBô°ªam
 *
	gTComI≈utBô°ªam
::
	$exåa˘Sub°ªam
–
UI¡
 
uiNumBôs
 )

360 
UI¡
 
uiNumByãs
 = 
uiNumBôs
/8;

361 
TComI≈utBô°ªam
 *
pResu…
 = 
√w
 TComInputBitstream;

363 
°d
::
ve˘‹
<
uöt8_t
> &
buf
 = 
pResu…
->
	`gëFifo
();

364 
buf
.
	`ª£rve
((
uiNumBôs
+7)>>3);

366 i‡(
m_num_hñd_bôs
 == 0)

368 
°d
::
size_t
 
cuºítOuçutBuf„rSize
=
buf
.
	`size
();

369 c⁄° 
UI¡
 
uiNumByãsToRódFromFifo
 = 
°d
::
mö
<UI¡>(
uiNumByãs
, (UI¡)
m_fifo
.
	`size
(Ë- 
m_fifo_idx
);

370 
buf
.
	`ªsize
(
cuºítOuçutBuf„rSize
+
uiNumByãs
);

371 
	`mem˝y
(&(
buf
[
cuºítOuçutBuf„rSize
]), &(
m_fifo
[
m_fifo_idx
]), 
uiNumByãsToRódFromFifo
); m_fifo_idx+=uiNumBytesToReadFromFifo;

372 i‡(
uiNumByãsToRódFromFifo
 !
uiNumByãs
)

374 
	`mem£t
(&(
buf
[
cuºítOuçutBuf„rSize
+
uiNumByãsToRódFromFifo
]), 0, 
uiNumByãs
 - uiNumBytesToReadFromFifo);

379 
UI¡
 
ui
 = 0; uò< 
uiNumByãs
; ui++)

381 
UI¡
 
uiByã
;

382 
	`ªad
(8, 
uiByã
);

383 
buf
.
	`push_back
(
uiByã
);

386 i‡(
uiNumBôs
&0x7)

388 
UI¡
 
uiByã
 = 0;

389 
	`ªad
(
uiNumBôs
&0x7, 
uiByã
);

390 
uiByã
 <<8-(
uiNumBôs
&0x7);

391 
buf
.
	`push_back
(
uiByã
);

393  
pResu…
;

394 
	}
}

396 
UI¡
 
	gTComI≈utBô°ªam
::
	$ªadByãAlignmít
()

398 
UI¡
 
code
 = 0;

399 
	`ªad
–1, 
code
 );

400 
	`as£π
(
code
 == 1);

402 
UI¡
 
numBôs
 = 
	`gëNumBôsU¡ûByãAlig√d
();

403 if(
numBôs
)

405 
	`as£π
(
numBôs
 <
	`gëNumBôsLe·
());

406 
	`ªad
–
numBôs
, 
code
 );

407 
	`as£π
(
code
 == 0);

409  
numBôs
+1;

410 
	}
}

	@TLibCommon/TComBitStream.h

38 #i‚de‡
__TCOMBITSTREAM__


39 
	#__TCOMBITSTREAM__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~<°döt.h
>

46 
	~<ve˘‹
>

47 
	~<°dio.h
>

48 
	~"Comm⁄Def.h
"

58 ˛as†
	cTComBôIf


60 
	mpublic
:

61 
vútuÆ
 
Void
 
	$wrôeAlignO√
 () {};

62 
vútuÆ
 
Void
 
	$wrôeAlignZîo
 (Ë{
	}
};

63 
vútuÆ
 
Void
 
wrôe
 ( 
UI¡
 
uiBôs
, UI¡ 
uiNumbîOfBôs
 ) = 0;

64 
vútuÆ
 
Void
 
ª£tBôs
 () = 0;

65 
vútuÆ
 
UI¡
 
	$gëNumbîOfWrôãnBôs
() const = 0;

66 
vútuÆ
 
I¡
 
	$gëNumBôsU¡ûByãAlig√d
() const = 0;

67 
vútuÆ
 ~
	$TComBôIf
(Ë{
	}
}

74 ˛as†
	cTComOuçutBô°ªam
 : 
public
 
TComBôIf


83 
°d
::
ve˘‹
<
uöt8_t
> 
m_fifo
;

85 
UI¡
 
	mm_num_hñd_bôs
;

86 
UCh¨
 
	mm_hñd_bôs
;

88 
	mpublic
:

90 
TComOuçutBô°ªam
();

91 ~
TComOuçutBô°ªam
();

98 
Void
 
wrôe
 ( 
UI¡
 
uiBôs
, UI¡ 
uiNumbîOfBôs
 );

101 
Void
 
wrôeAlignO√
 ();

104 
Void
 
wrôeAlignZîo
 ();

107 
Void
 
	$ª£tBôs
(Ë{ 
	`as£π
(0); }

117 
UCh¨
* 
	$gëByãSåóm
() const;

122 
UI¡
 
	`gëByãSåómLígth
();

127 
Void
 
	`˛ór
();

133 
I¡
 
	$gëNumBôsU¡ûByãAlig√d
(Ëc⁄° {  (8 - 
m_num_hñd_bôs
Ë& 0x7; 
	}
}

138 
UI¡
 
	$gëNumbîOfWrôãnBôs
(Ëc⁄° {  
	`UI¡
(
m_fifo
.
	`size
()Ë* 8 + 
m_num_hñd_bôs
; 
	}
}

140 
Void
 
ö£πAt
(c⁄° 
TComOuçutBô°ªam
& 
§c
, 
UI¡
 
pos
);

145 
	g°d
::
ve˘‹
<
uöt8_t
>& 
	$gëFIFO
(Ë{  
m_fifo
; 
	}
}

147 
UCh¨
 
	$gëHñdBôs
 (Ë{  
m_hñd_bôs
; 
	}
}

151 c⁄° 
	g°d
::
ve˘‹
<
uöt8_t
>& 
	$gëFIFO
(Ëc⁄° {  
m_fifo
; 
	}
}

153 
Void
 
addSub°ªam
 ( 
TComOuçutBô°ªam
* 
pcSub°ªam
 );

154 
Void
 
wrôeByãAlignmít
();

157 
I¡
 
cou¡SèπCodeEmuœti⁄s
();

164 ˛as†
	cTComI≈utBô°ªam


166 
	m¥Ÿe˘ed
:

167 
°d
::
ve˘‹
<
uöt8_t
> 
m_fifo
;

168 
	m°d
::
ve˘‹
<
UI¡
> 
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
;

170 
UI¡
 
	mm_fifo_idx
;

172 
UI¡
 
	mm_num_hñd_bôs
;

173 
UCh¨
 
	mm_hñd_bôs
;

174 
UI¡
 
	mm_numBôsRód
;

176 
	mpublic
:

180 
TComI≈utBô°ªam
();

181 
	mvútuÆ
 ~
	$TComI≈utBô°ªam
() { }

182 
	`TComI≈utBô°ªam
(c⁄° 
TComI≈utBô°ªam
 &
§c
);

184 
Void
 
	`ª£tToSèπ
();

187 
Void
 
	`p£udoRód
 ( 
UI¡
 
uiNumbîOfBôs
, UI¡& 
ruiBôs
 );

188 
Void
 
	`ªad
 ( 
UI¡
 
uiNumbîOfBôs
, UI¡& 
ruiBôs
 );

189 
Void
 
	$ªadByã
 ( 
UI¡
 &
ruiBôs
 )

191 
	`as£π
(
m_fifo_idx
 < 
m_fifo
.
	`size
());

192 
ruiBôs
 = 
m_fifo
[
m_fifo_idx
++];

193 
	}
}

195 
Void
 
	$≥ekPªviousByã
–
UI¡
 &
byã
 )

197 
	`as£π
(
m_fifo_idx
 > 0);

198 
byã
 = 
m_fifo
[
m_fifo_idx
 - 1];

199 
	}
}

201 
UI¡
 
ªadOutTøûögBôs
 ();

202 
UCh¨
 
	$gëHñdBôs
 (Ë{  
m_hñd_bôs
; 
	}
}

203 
	gTComOuçutBô°ªam
& 
	g›î©‹
(c⁄° 
TComOuçutBô°ªam
& 
§c
);

204 
UI¡
 
	$gëByãLoˇti⁄
 ( ) {  
m_fifo_idx
 ; 
	}
}

207 
UI¡
 
	$≥ekBôs
 (
UI¡
 
uiBôs
Ë{ UI¡ 
tmp
; 
	`p£udoRód
(uiBôs,Åmp); Åmp; 
	}
}

210 
UI¡
 
	$ªad
(
UI¡
 
numbîOfBôs
Ë{ UI¡ 
tmp
; 
	`ªad
“umbîOfBôs,Åmp); Åmp; 
	}
}

211 
UI¡
 
	$ªadByã
(Ë{ 
UI¡
 
tmp
; 
	`ªadByã
–tm∞); Åmp; 
	}
}

212 
UI¡
 
	$gëNumBôsU¡ûByãAlig√d
(Ë{  
m_num_hñd_bôs
 & (0x7); 
	}
}

213 
UI¡
 
	$gëNumBôsLe·
(Ë{  8*((
UI¡
)
m_fifo
.
	`size
(Ë- 
m_fifo_idx
Ë+ 
m_num_hñd_bôs
; 
	}
}

214 
TComI≈utBô°ªam
 *
exåa˘Sub°ªam
–
UI¡
 
uiNumBôs
 );

215 
UI¡
 
	$gëNumBôsRód
(Ë{  
m_numBôsRód
; 
	}
}

216 
UI¡
 
ªadByãAlignmít
();

218 
Void
 
	$pushEmuœti⁄Pªvíti⁄ByãLoˇti⁄
 ( 
UI¡
 
pos
 ) { 
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
.
	`push_back
–po†); 
	}
}

219 
UI¡
 
	$numEmuœti⁄Pªvíti⁄ByãsRód
 (Ë{  (
UI¡
Ë
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
.
	`size
(); 
	}
}

220 c⁄° 
	g°d
::
ve˘‹
<
UI¡
> &
	$gëEmuœti⁄Pªvíti⁄ByãLoˇti⁄
 (Ëc⁄° {  
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
; 
	}
}

221 
UI¡
 
	$gëEmuœti⁄Pªvíti⁄ByãLoˇti⁄
 ( 
UI¡
 
idx
 ) {  
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
[ idx ]; 
	}
}

222 
Void
 
	$˛órEmuœti⁄Pªvíti⁄ByãLoˇti⁄
(Ë{ 
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
.
	`˛ór
(); 
	}
}

223 
Void
 
£tEmuœti⁄Pªvíti⁄ByãLoˇti⁄
 ( c⁄° 
°d
::
ve˘‹
<
UI¡
> &
vec
 ) { 
m_emuœti⁄Pªvíti⁄ByãLoˇti⁄
 = vec; }

225 c⁄° 
	g°d
::
ve˘‹
<
uöt8_t
> &
	$gëFifo
(Ëc⁄° {  
m_fifo
; 
	}
}

226 
	g°d
::
ve˘‹
<
uöt8_t
> &
	$gëFifo
(Ë{  
m_fifo
; 
	}
}

	@TLibCommon/TComCABACTables.cpp

38 
	~"TComCABACTabÀs.h
"

43 c⁄° 
UCh¨
 
	gTComCABACTabÀs
::
sm_aucLPSTabÀ
[1 << 
CONTEXT_STATE_BITS
][4] =

111 c⁄° 
UCh¨
 
	gTComCABACTabÀs
::
sm_aucRí‹mTabÀ
[32] =

	@TLibCommon/TComCABACTables.h

38 #i‚de‡
__TCOMCABACTABLES__


39 
	#__TCOMCABACTABLES__


	)

41 
	~"TLibComm⁄/Comm⁄Def.h
"

42 
	~"TLibComm⁄/TComRom.h
"

51 ˛as†
	cTComCABACTabÀs


53 
	mpublic
:

54 c⁄° 
UCh¨
 
sm_aucLPSTabÀ
[1 << 
CONTEXT_STATE_BITS
][4];

55 c⁄° 
UCh¨
 
	msm_aucRí‹mTabÀ
[32];

	@TLibCommon/TComChromaFormat.cpp

35 
	~"TComChromaF‹m©.h
"

36 
	~"TComPic.h
"

37 
	~"TComD©aCU.h
"

38 
	~"TComTrQu™t.h
"

39 
	~"TComTU.h
"

46 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
	$°rögToI≈utCﬁourS∑˚C⁄vît
(c⁄° 
°d
::
°rög
 &
vÆue
, c⁄° 
Boﬁ
 
bIsF‹w¨d
)

48 i‡(
vÆue
.
	`em±y
() || value=="UNCHANGED")

50  
IPCOLOURSPACE_UNCHANGED
;

52 i‡(
bIsF‹w¨d
)

54 i‡(
vÆue
=="YCbCrtoYYY")

56  
IPCOLOURSPACE_YCbCπoYYY
;

58 i‡(
vÆue
=="YCbCrtoYCrCb")

60  
IPCOLOURSPACE_YCbCπoYCrCb
;

62 i‡(
vÆue
=="RGBtoGBR")

64  
IPCOLOURSPACE_RGBtoGBR
;

69 i‡(
vÆue
=="YCrCbtoYCbCr")

71  
IPCOLOURSPACE_YCbCπoYCrCb
;

73 i‡(
vÆue
=="GBRtoRGB")

75  
IPCOLOURSPACE_RGBtoGBR
;

78  
NUMBER_INPUT_COLOUR_SPACE_CONVERSIONS
;

79 
	}
}

81 
	g°d
::
°rög
 
	$gëLi°OfCﬁourS∑˚C⁄vîts
(c⁄° 
Boﬁ
 
bIsF‹w¨d
)

83 i‡(
bIsF‹w¨d
)

91 
	}
}

96 
Void
 
	$gëTUE¡r›yCodögP¨amëîs
–
TUE¡r›yCodögP¨amëîs
 &
ªsu…
,

97 
TComTU
 &
rTu
,

98 c⁄° 
Comp⁄ítID
 
comp⁄ít
)

104 
TComD©aCU
 *c⁄° 
pcCU
 = 
rTu
.
	`gëCU
();

105 c⁄° 
TComRe˘™gÀ
 & 
¨ó
 = 
rTu
.
	`gëRe˘
(
comp⁄ít
);

106 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
(
comp⁄ít
);

107 c⁄° 
UI¡
 
log2BlockWidth
 = 
g_aucC⁄vîtToBô
[
¨ó
.
width
] + 2;

108 c⁄° 
UI¡
 
log2BlockHeight
 = 
g_aucC⁄vîtToBô
[
¨ó
.
height
] + 2;

109 c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
 = 
	`toCh™√lTy≥
(
comp⁄ít
);

111 
ªsu…
.
sˇnTy≥
 = 
	`COEFF_SCAN_TYPE
(
pcCU
->
	`gëC€fSˇnIdx
(
uiAbsP¨tIdx
, 
¨ó
.
width
,áªa.
height
, 
comp⁄ít
));

117 
ªsu…
.
widthInGroups
 = 
¨ó
.
width
 >> 
MLS_CG_LOG2_WIDTH
;

118 
ªsu…
.
heightInGroups
 = 
¨ó
.
height
 >> 
MLS_CG_LOG2_HEIGHT
;

124 c⁄° 
UI¡
 
log2WidthInGroups
 = 
g_aucC⁄vîtToBô
[
ªsu…
.
widthInGroups
 * 4];

125 c⁄° 
UI¡
 
log2HeightInGroups
 = 
g_aucC⁄vîtToBô
[
ªsu…
.
heightInGroups
 * 4];

127 
ªsu…
.
sˇn
 = 
g_sˇnOrdî
[ 
SCAN_GROUPED_4x4
 ][Ñesu….
sˇnTy≥
 ][ 
log2BlockWidth
 ][ 
log2BlockHeight
 ];

128 
ªsu…
.
sˇnCG
 = 
g_sˇnOrdî
[ 
SCAN_UNGROUPED
 ][Ñesu….
sˇnTy≥
 ][ 
log2WidthInGroups
 ][ 
log2HeightInGroups
 ];

134 i‡(
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëTønsf‹mSkùC⁄ãxtE«bÀdFœg
()

135 && (
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
Ë|| (pcCU->
	`gëTønsf‹mSkù
(uiAbsP¨tIdx, 
comp⁄ít
) != 0)))

137 
ªsu…
.
fú°Signifiˇn˚M≠C⁄ãxt
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
ch™√lTy≥
][
CONTEXT_TYPE_SINGLE
];

141 i‡((
¨ó
.
width
 =4Ë&& (¨ó.
height
 == 4))

143 
ªsu…
.
fú°Signifiˇn˚M≠C⁄ãxt
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
ch™√lTy≥
][
CONTEXT_TYPE_4x4
];

145 i‡((
¨ó
.
width
 =8Ë&& (¨ó.
height
 == 8))

147 
ªsu…
.
fú°Signifiˇn˚M≠C⁄ãxt
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
ch™√lTy≥
][
CONTEXT_TYPE_8x8
];

148 i‡(
ªsu…
.
sˇnTy≥
 !
SCAN_DIAG
)

150 
ªsu…
.
fú°Signifiˇn˚M≠C⁄ãxt
 +
n⁄Düg⁄ÆSˇn8x8C⁄ãxtOff£t
[
ch™√lTy≥
];

155 
ªsu…
.
fú°Signifiˇn˚M≠C⁄ãxt
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
ch™√lTy≥
][
CONTEXT_TYPE_NxN
];

160 
	}
}

	@TLibCommon/TComChromaFormat.h

34 #i‚de‡
__TCOMCHROMAFORMAT__


35 
	#__TCOMCHROMAFORMAT__


	)

37 
	~"Comm⁄Def.h
"

38 
	~"TComRe˘™gÀ.h
"

39 
	~"C⁄ãxtTabÀs.h
"

40 
	~"TComRom.h
"

41 
	~<io°ªam
>

42 
	~<ve˘‹
>

43 
	~<as£π.h
>

44 
	~"Debug.h
"

50 
˛ass
 
	gTComD©aCU
;

53 
ölöe
 
Ch™√lTy≥
 
	$toCh™√lTy≥
 (c⁄° 
Comp⁄ítID
 
id
Ë{  (id==
COMPONENT_Y
)? 
CHANNEL_TYPE_LUMA
 : 
CHANNEL_TYPE_CHROMA
; 
	}
}

54 
ölöe
 
Boﬁ
 
	$isLuma
 (c⁄° 
Comp⁄ítID
 
id
Ë{  (id==
COMPONENT_Y
); 
	}
}

55 
ölöe
 
Boﬁ
 
	$isLuma
 (c⁄° 
Ch™√lTy≥
 
id
Ë{  (id==
CHANNEL_TYPE_LUMA
); 
	}
}

56 
ölöe
 
Boﬁ
 
	$isChroma
 (c⁄° 
Comp⁄ítID
 
id
Ë{  (id!=
COMPONENT_Y
); 
	}
}

57 
ölöe
 
Boﬁ
 
	$isChroma
 (c⁄° 
Ch™√lTy≥
 
id
Ë{  (id!=
CHANNEL_TYPE_LUMA
); 
	}
}

58 
ölöe
 
UI¡
 
	$gëCh™√lTy≥SˇÀX
 (c⁄° 
Ch™√lTy≥
 
id
, c⁄° 
ChromaF‹m©
 
fmt
Ë{  (
	`isLuma
(idË|| (fmt==
CHROMA_444
)Ë? 0 : 1; 
	}
}

59 
ölöe
 
UI¡
 
	$gëCh™√lTy≥SˇÀY
 (c⁄° 
Ch™√lTy≥
 
id
, c⁄° 
ChromaF‹m©
 
fmt
Ë{  (
	`isLuma
(idË|| (fmt!=
CHROMA_420
)Ë? 0 : 1; 
	}
}

60 
ölöe
 
UI¡
 
	$gëComp⁄ítSˇÀX
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
ChromaF‹m©
 
fmt
Ë{  
	`gëCh™√lTy≥SˇÀX
(
	`toCh™√lTy≥
(id), fmt); 
	}
}

61 
ölöe
 
UI¡
 
	$gëComp⁄ítSˇÀY
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
ChromaF‹m©
 
fmt
Ë{  
	`gëCh™√lTy≥SˇÀY
(
	`toCh™√lTy≥
(id), fmt); 
	}
}

62 
ölöe
 
UI¡
 
	$gëNumbîVÆidCh™√lTy≥s
(c⁄° 
ChromaF‹m©
 
fmt
Ë{  (fmt==
CHROMA_400
Ë? 1 : 
MAX_NUM_CHANNEL_TYPE
; 
	}
}

63 
ölöe
 
UI¡
 
	$gëNumbîVÆidComp⁄íts
 (c⁄° 
ChromaF‹m©
 
fmt
Ë{  (fmt==
CHROMA_400
Ë? 1 : 
MAX_NUM_COMPONENT
; 
	}
}

64 
ölöe
 
Boﬁ
 
	$isChromaE«bÀd
 (c⁄° 
ChromaF‹m©
 
fmt
Ë{  fmt!=
CHROMA_400
; 
	}
}

65 
ölöe
 
Comp⁄ítID
 
	$gëFú°Comp⁄ítOfCh™√l
(c⁄° 
Ch™√lTy≥
 
id
Ë{  (
	`isLuma
(idË? 
COMPONENT_Y
 : 
COMPONENT_Cb
); 
	}
}

67 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
°rögToI≈utCﬁourS∑˚C⁄vît
(c⁄° 
°d
::
°rög
 &
vÆue
, c⁄° 
Boﬁ
 
bIsF‹w¨d
);

68 
	g°d
::
°rög
 
gëLi°OfCﬁourS∑˚C⁄vîts
(c⁄° 
Boﬁ
 
bIsF‹w¨d
);

72 
ölöe
 
UI¡
 
	$gëTŸÆSam∂es
(c⁄° 
UI¡
 
width
, c⁄° UI¡ 
height
, c⁄° 
ChromaF‹m©
 
f‹m©
)

74 c⁄° 
UI¡
 
ßm∂esPîCh™√l
 = 
width
 * 
height
;

76 
f‹m©
)

78 
CHROMA_400
:  
ßm∂esPîCh™√l
; ;

79 
CHROMA_420
:  (
ßm∂esPîCh™√l
 * 3) >> 1; ;

80 
CHROMA_422
:  
ßm∂esPîCh™√l
 * 2; ;

81 
CHROMA_444
:  
ßm∂esPîCh™√l
 * 3; ;

83 
°d
::
˚º
 << "ERROR: Uƒecogni£d chrom®f‹m© i¿gëTŸÆSam∂es()" << std::
ídl
;

84 
	`exô
(1);

88  
MAX_UINT
;

89 
	}
}

93 
ölöe
 
UI¡
 
	$gëTŸÆBôs
(c⁄° 
UI¡
 
width
, c⁄° UI¡ 
height
, c⁄° 
ChromaF‹m©
 
f‹m©
, c⁄° 
I¡
 
bôDïths
[
MAX_NUM_CHANNEL_TYPE
])

95 c⁄° 
UI¡
 
ßm∂esPîCh™√l
 = 
width
 * 
height
;

97 
f‹m©
)

99 
CHROMA_400
:  
ßm∂esPîCh™√l
 * 
bôDïths
[
CHANNEL_TYPE_LUMA
]; ;

100 
CHROMA_420
:  (
ßm∂esPîCh™√l
 * (
bôDïths
[
CHANNEL_TYPE_LUMA
]*2 + bôDïths[
CHANNEL_TYPE_CHROMA
]) ) >> 1; ;

101 
CHROMA_422
:  
ßm∂esPîCh™√l
 * (
bôDïths
[
CHANNEL_TYPE_LUMA
] + bôDïths[
CHANNEL_TYPE_CHROMA
]); ;

102 
CHROMA_444
:  
ßm∂esPîCh™√l
 * (
bôDïths
[
CHANNEL_TYPE_LUMA
] + 2*bôDïths[
CHANNEL_TYPE_CHROMA
]); ;

104 
°d
::
˚º
 << "ERROR: Uƒecogni£d chrom®f‹m© i¿gëTŸÆSam∂es()" << std::
ídl
;

105 
	`exô
(1);

109  
MAX_UINT
;

110 
	}
}

119 
ölöe
 
Boﬁ
 
	$íabÀ4ChromaPUsInI¡øNxNCU
(c⁄° 
ChromaF‹m©
 
chFmt
)

121  (
chFmt
 =
CHROMA_444
);

122 
	}
}

129 
ölöe
 
UI¡


130 
	$gëChromasC‹ª•⁄dögPULumaIdx
(c⁄° 
UI¡
 
lumaZOrdîIdxInCtu
,

131 c⁄° 
ChromaF‹m©
 
chFmt
,

132 c⁄° 
I¡
 
∑πsPîMöCU


135  
	`íabÀ4ChromaPUsInI¡øNxNCU
(
chFmt
Ë? 
lumaZOrdîIdxInCtu
 :ÜumaZOrdîIdxInCtu & (~(
∑πsPîMöCU
-1));

136 
	}
}

142 
ölöe
 
UI¡
 
	$gëMaxCUDïthOff£t
(c⁄° 
ChromaF‹m©
 
chFmt
, c⁄° 
UI¡
 
quadåìTULog2MöSize
)

144  (
chFmt
==
CHROMA_422
 && 
quadåìTULog2MöSize
>2) ? 1 : 0;

145 
	}
}

151 
ölöe
 
Boﬁ
 
	$fûãrI¡øRe„ªn˚Sam∂es
 (c⁄° 
Ch™√lTy≥
 
chTy≥
, c⁄° 
ChromaF‹m©
 
chFmt
, c⁄° 
Boﬁ
 
öåaRe„ªn˚SmoŸhögDißbÀd
)

153  (!
öåaRe„ªn˚SmoŸhögDißbÀd
Ë&& (
	`isLuma
(
chTy≥
Ë|| (
chFmt
 =
CHROMA_444
));

154 
	}
}

161 
ölöe
 
Boﬁ
 
	$TUCompRe˘HasAssocüãdTønsf‹mSkùFœg
(c⁄° 
TComRe˘™gÀ
 &
ª˘Sam∂es
, c⁄° 
UI¡
 
å™sf‹mSkùLog2MaxSize
)

163  (
ª˘Sam∂es
.
width
 <(1<<
å™sf‹mSkùLog2MaxSize
));

164 
	}
}

169 
ölöe
 
I¡
 
	$gëTønsf‹mShi·
(c⁄° 
I¡
 
ch™√lBôDïth
, c⁄° 
UI¡
 
uiLog2TrSize
, c⁄° I¡ 
maxLog2TrDy«micR™ge
)

171  
maxLog2TrDy«micR™ge
 - 
ch™√lBôDïth
 - 
uiLog2TrSize
;

172 
	}
}

177 
ölöe
 
I¡
 
	$gëSˇÀdChromaQP
(
I¡
 
unsˇÀdChromaQP
, c⁄° 
ChromaF‹m©
 
chFmt
)

179  
g_aucChromaSˇÀ
[
chFmt
][
	`Clù3
(0, (
chromaQPM≠pögTabÀSize
 - 1), 
unsˇÀdChromaQP
)];

180 
	}
}

187 
ölöe
 
I¡
 
	$gëSˇlögLi°Ty≥
(c⁄° 
PªdMode
 
¥edMode
, c⁄° 
Comp⁄ítID
 
compID
)

189  ((
¥edMode
 !
MODE_INTER
Ë? 0 : 
MAX_NUM_COMPONENT
Ë+ 
compID
;

190 
	}
}

202 c⁄° 
UI¡
 
	gsignifiˇn˚M≠C⁄ãxtSèπTabÀ
[
MAX_NUM_CHANNEL_TYPE
] = {
FIRST_SIG_FLAG_CTX_LUMA
, 
FIRST_SIG_FLAG_CTX_CHROMA
};

203 c⁄° 
UI¡
 
	gc⁄ãxtSëSèπTabÀ
 [
MAX_NUM_CHANNEL_TYPE
] = {
FIRST_CTX_SET_LUMA
, 
FIRST_CTX_SET_CHROMA
 };

204 c⁄° 
UI¡
 
	gCBFC⁄ãxtSèπTabÀ
 [
MAX_NUM_CHANNEL_TYPE
] = {
FIRST_CBF_CTX_LUMA
, 
FIRST_CBF_CTX_CHROMA
 };

211 
ölöe
 
Void
 
	$gëLa°Signifiˇ¡C⁄ãxtP¨amëîs
 (c⁄° 
Comp⁄ítID
 
comp⁄ít
,

212 c⁄° 
I¡
 
width
,

213 c⁄° 
I¡
 
height
,

214 
I¡
 &
ªsu…_off£tX
,

215 
I¡
 &
ªsu…_off£tY
,

216 
I¡
 &
ªsu…_shi·X
,

217 
I¡
 &
ªsu…_shi·Y
)

219 c⁄° 
UI¡
 
c⁄vîãdWidth
 = 
g_aucC⁄vîtToBô
[
width
];

220 c⁄° 
UI¡
 
c⁄vîãdHeight
 = 
g_aucC⁄vîtToBô
[
height
];

222 
ªsu…_off£tX
 = (
	`isChroma
(
comp⁄ít
)Ë? 0 : ((
c⁄vîãdWidth
 * 3) + ((convertedWidth + 1) >> 2));

223 
ªsu…_off£tY
 = (
	`isChroma
(
comp⁄ít
)Ë? 0 : ((
c⁄vîãdHeight
 * 3) + ((convertedHeight + 1) >> 2));

224 
ªsu…_shi·X
 = (
	`isChroma
(
comp⁄ít
)Ë? 
c⁄vîãdWidth
 : ((convertedWidth + 3) >> 2);

225 
ªsu…_shi·Y
 = (
	`isChroma
(
comp⁄ít
)Ë? 
c⁄vîãdHeight
 : ((convertedHeight + 3) >> 2);

226 
	}
}

233 
ölöe
 
UI¡
 
	$gëSignifiˇn˚M≠C⁄ãxtOff£t
 (c⁄° 
Comp⁄ítID
 
comp⁄ít
)

235  
signifiˇn˚M≠C⁄ãxtSèπTabÀ
[
	`toCh™√lTy≥
(
comp⁄ít
)];

236 
	}
}

243 
ölöe
 
UI¡
 
	$gëC⁄ãxtSëIndex
 (c⁄° 
Comp⁄ítID
 
comp⁄ít
,

244 c⁄° 
UI¡
 
sub£tIndex
,

245 c⁄° 
Boﬁ
 
foundAC€fficõ¡Gª©îTh™1
)

247 c⁄° 
UI¡
 
nŸFú°Sub£tOff£t
 = (
	`isLuma
(
comp⁄ít
Ë&& (
sub£tIndex
 > 0)) ? 2 : 0;

248 c⁄° 
UI¡
 
foundAGª©îTh™1Off£t
 = 
foundAC€fficõ¡Gª©îTh™1
 ? 1 : 0;

250  
c⁄ãxtSëSèπTabÀ
[
	`toCh™√lTy≥
(
comp⁄ít
)] + 
nŸFú°Sub£tOff£t
 + 
foundAGª©îTh™1Off£t
;

251 
	}
}

258 
ölöe
 
UI¡
 
	$gëCBFC⁄ãxtOff£t
 (c⁄° 
Comp⁄ítID
 
comp⁄ít
)

260  
CBFC⁄ãxtSèπTabÀ
[
	`toCh™√lTy≥
(
comp⁄ít
)];

261 
	}
}

268 
Void
 
gëTUE¡r›yCodögP¨amëîs
–
TUE¡r›yCodögP¨amëîs
 &
ªsu…
,

269 
˛ass
 
TComTU
 &
rTu
,

270 c⁄° 
Comp⁄ítID
 
comp⁄ít
);

	@TLibCommon/TComCodingStatistics.h

34 #i‚de‡
__TCOMCODINGSTATISTICS__


35 
	#__TCOMCODINGSTATISTICS__


	)

37 
	~"Comm⁄Def.h
"

38 
	~<°dio.h
>

39 
	~<°rög
>

40 
	~<m≠
>

41 
	~<m©h.h
>

42 
	~"TComChromaF‹m©.h
"

44 c⁄° 
I¡64
 
	gTCOMCODINGSTATISTICS_ENTROPYSCALE
=32768;

47 
	eTComCodögSèti°icsTy≥


49 
	mSTATS__NAL_UNIT_TOTAL_BODY
,

50 
	mSTATS__NAL_UNIT_PACKING
,

51 
	mSTATS__EMULATION_PREVENTION_3_BYTES
,

52 
	mSTATS__NAL_UNIT_HEADER_BITS
,

53 
	mSTATS__CABAC_INITIALISATION
,

54 
	mSTATS__CABAC_BITS__TQ_BYPASS_FLAG
,

55 
	mSTATS__CABAC_BITS__SKIP_FLAG
,

56 
	mSTATS__CABAC_BITS__MERGE_FLAG
,

57 
	mSTATS__CABAC_BITS__MERGE_INDEX
,

58 
	mSTATS__CABAC_BITS__MVP_IDX
,

59 
	mSTATS__CABAC_BITS__SPLIT_FLAG
,

60 
	mSTATS__CABAC_BITS__PART_SIZE
,

61 
	mSTATS__CABAC_BITS__PRED_MODE
,

62 
	mSTATS__CABAC_BITS__INTRA_DIR_ANG
,

63 
	mSTATS__CABAC_BITS__INTER_DIR
,

64 
	mSTATS__CABAC_BITS__REF_FRM_IDX
,

65 
	mSTATS__CABAC_BITS__MVD
,

66 
	mSTATS__CABAC_BITS__MVD_EP
,

67 
	mSTATS__CABAC_BITS__TRANSFORM_SUBDIV_FLAG
,

68 
	mSTATS__CABAC_BITS__QT_ROOT_CBF
,

69 
	mSTATS__CABAC_BITS__DELTA_QP_EP
,

70 
	mSTATS__CABAC_BITS__CHROMA_QP_ADJUSTMENT
,

71 
	mSTATS__CABAC_BITS__QT_CBF
,

72 
	mSTATS__CABAC_BITS__CROSS_COMPONENT_PREDICTION
,

73 
	mSTATS__CABAC_BITS__TRANSFORM_SKIP_FLAGS
,

75 
	mSTATS__CABAC_BITS__LAST_SIG_X_Y
,

76 
	mSTATS__CABAC_BITS__SIG_COEFF_GROUP_FLAG
,

77 
	mSTATS__CABAC_BITS__SIG_COEFF_MAP_FLAG
,

78 
	mSTATS__CABAC_BITS__GT1_FLAG
,

79 
	mSTATS__CABAC_BITS__GT2_FLAG
,

80 
	mSTATS__CABAC_BITS__SIGN_BIT
,

81 
	mSTATS__CABAC_BITS__ESCAPE_BITS
,

83 
	mSTATS__CABAC_BITS__SAO
,

84 
	mSTATS__CABAC_TRM_BITS
,

85 
	mSTATS__CABAC_FIXED_BITS
,

86 
	mSTATS__CABAC_PCM_ALIGN_BITS
,

87 
	mSTATS__CABAC_PCM_CODE_BITS
,

88 
	mSTATS__BYTE_ALIGNMENT_BITS
,

89 
	mSTATS__TRAILING_BITS
,

90 
	mSTATS__EXPLICIT_RDPCM_BITS
,

91 
	mSTATS__CABAC_EP_BIT_ALIGNMENT
,

92 
	mSTATS__CABAC_BITS__ALIGNED_SIGN_BIT
,

93 
	mSTATS__CABAC_BITS__ALIGNED_ESCAPE_BITS
,

94 
	mSTATS__NUM_STATS


97 
ölöe
 c⁄° 
TCh¨
* 
	$gëName
(
TComCodögSèti°icsTy≥
 
«me
)

99 c⁄° 
TCh¨
 *
°©Names
[]=

145 
	`as£π
(
STATS__NUM_STATS
 =(
°©Names
)/(
TCh¨
 *Ë&& 
«me
 < STATS__NUM_STATS);

146  
°©Names
[
«me
];

147 
	}
}

149 
ölöe
 
Boﬁ
 
	$isAlig√dBös
(
TComCodögSèti°icsTy≥
 
°©T
Ë{  sètT==
STATS__CABAC_BITS__ALIGNED_SIGN_BIT
 || sètT==
STATS__CABAC_BITS__ALIGNED_ESCAPE_BITS
; 
	}
}

151 c⁄° 
UI¡
 
	gCODING_STATS_NUM_WIDTHS
=7;

152 c⁄° 
UI¡
 
	gCODING_STATS_NUM_SUBCLASSES
=
CODING_STATS_NUM_WIDTHS
*(1+
MAX_NUM_COMPONENT
+
MAX_NUM_CHANNEL_TYPE
);

154 ˛as†
	cTComCodögSèti°icsCœssTy≥


156 
	mpublic
:

158 
	$TComCodögSèti°icsCœssTy≥
(c⁄° 
TComCodögSèti°icsTy≥
 
t
)

159 : 
	`ty≥
(
t
), 
	$subCœss
(0)

161 
	$TComCodögSèti°icsCœssTy≥
(c⁄° 
TComCodögSèti°icsTy≥
 
t
, c⁄° 
UI¡
 
log2w
 )

162 : 
	`ty≥
(
t
), 
	$subCœss
(
log2w
)

163 { 
	}
}

164 
	$TComCodögSèti°icsCœssTy≥
(c⁄° 
TComCodögSèti°icsTy≥
 
t
, c⁄° 
I¡
 
log2w
 )

165 : 
	`ty≥
(
t
), 
	$subCœss
(
log2w
)

166 { 
	}
}

167 
	$TComCodögSèti°icsCœssTy≥
(c⁄° 
TComCodögSèti°icsTy≥
 
t
, c⁄° 
Comp⁄ítID
 
cid
 )

168 : 
	`ty≥
(
t
), 
	`subCœss
((
cid
+1)*
CODING_STATS_NUM_WIDTHS
)

169 { 
	}
}

170 
	$TComCodögSèti°icsCœssTy≥
(c⁄° 
TComCodögSèti°icsTy≥
 
t
, c⁄° 
Ch™√lTy≥
 
chid
 )

171 : 
	`ty≥
(
t
), 
	`subCœss
((
chid
+
MAX_NUM_COMPONENT
+1)*
CODING_STATS_NUM_WIDTHS
)

172 { 
	}
}

173 
	$TComCodögSèti°icsCœssTy≥
(c⁄° 
TComCodögSèti°icsTy≥
 
t
, c⁄° 
UI¡
 
log2w
, c⁄° 
Comp⁄ítID
 
cid
 )

174 : 
	`ty≥
(
t
), 
	`subCœss
((
cid
+1)*
CODING_STATS_NUM_WIDTHS
 + 
log2w
)

175 { 
	}
}

176 
	$TComCodögSèti°icsCœssTy≥
(c⁄° 
TComCodögSèti°icsTy≥
 
t
, c⁄° 
UI¡
 
log2w
, c⁄° 
Ch™√lTy≥
 
chid
 )

177 : 
	`ty≥
(
t
), 
	`subCœss
((
chid
+
MAX_NUM_COMPONENT
+1)*
CODING_STATS_NUM_WIDTHS
 + 
log2w
)

178 { 
	}
}

180 
UI¡
 
	$GëSubCœssWidth
(c⁄° 
UI¡
 
subCœss
)

182  
subCœss
%
CODING_STATS_NUM_WIDTHS
;

183 
	}
}

185 c⁄° 
TCh¨
 *
	$GëSubCœssSåög
(c⁄° 
UI¡
 
subCœss
)

187 
	`as£π
 (
subCœss
<
CODING_STATS_NUM_SUBCLASSES
);

188 c⁄° 
TCh¨
 *
°rögs
[1+
MAX_NUM_COMPONENT
+
MAX_NUM_CHANNEL_TYPE
]={"-", "Y", "Cb", "Cr", "Luma", "Chroma"};

189  
°rögs
[
subCœss
/
CODING_STATS_NUM_WIDTHS
];

190 
	}
}

192 
TComCodögSèti°icsTy≥
 
	gty≥
;

193 
UI¡
 
	gsubCœss
;

198 ˛as†
	cTComCodögSèti°ics


200 
	mpublic
:

203 
	sSètLogVÆue


205 
UI¡
 
vÆues
[512+1];

206 
SètLogVÆue
()

208 c⁄° 
DoubÀ
 
	mes
=DoubÀ(
TCOMCODINGSTATISTICS_ENTROPYSCALE
);

209 
	mvÆues
[0]=0;

210 
UI¡
 
	mi
=1; i<(
	mvÆues
)/(
	mUI¡
); i++)

212 
	mvÆues
[
i
]=
UI¡
–
log
(
DoubÀ
(i))*
es
/log(2.0) );

217 
	sSSèt


219 
SSèt
(Ë: 
bôs
(0), 
cou¡
(0), 
sum
(0) { }

220 
I¡64
 
	gbôs
;

221 
I¡64
 
	gcou¡
;

222 
I¡64
 
	gsum
;

223 
Void
 
˛ór
(Ë{ 
	gbôs
=0; 
	gcou¡
=0; 
	gsum
=0; }

225 
	gSSèt
 &
	g›î©‹
+=(c⁄° 
SSèt
 &
§c
)

226 { 
bôs
+=
§c
.bôs; 
	gcou¡
+=§c.
cou¡
; 
	gsum
+=§c.
sum
;  *
	gthis
; }

229 ˛as†
	cTComCodögSèti°icsD©a


231 
	g¥iv©e
:

232 
SSèt
 
°©i°ics
[
STATS__NUM_STATS
+1][
CODING_STATS_NUM_SUBCLASSES
];

233 
SSèt
 
	g°©i°ics_ï
[
STATS__NUM_STATS
+1][
CODING_STATS_NUM_SUBCLASSES
 ];

234 
	g°d
::
m≠
<
°d
::
°rög
, 
	gSSèt
> 
	gm≠pögs_ï
;

235 
‰õnd
 
˛ass
 
	gTComCodögSèti°ics
;

238 
	g¥iv©e
:

240 
TComCodögSèti°icsD©a
 
d©a
;

242 
	$TComCodögSèti°ics
(Ë: 
	$d©a
()

243 { 
	}
}

245 
Void
 
	$OuçutLöe
(c⁄° 
TCh¨
 *
pName
, c⁄° TCh¨ 
£p
, 
UI¡
 
width
, c⁄° TCh¨ *
pSubCœssSå
, c⁄° 
SSèt
 &
sCABAC
, c⁄° SSèà&
sEP
)

247 i‡(
width
==0)

249 
	`OuçutLöe
(
pName
, 
£p
, "-", 
pSubCœssSå
, 
sCABAC
, 
sEP
);

253 
	`¥ötf
("%c%-45s%c %6d %6s %12lld %12lld %12lld %12lld %12lld %12lld %12lld (%12lld)%c\n",

254 
£p
=='~'?'[':' ', 
pName
, sï, 1<<
width
, 
pSubCœssSå
,

255 
sCABAC
.
cou¡
, sCABAC.
sum
, sCABAC.
bôs
, 
sEP
.cou¡, sEP.sum, sEP.bôs, sCABAC.bôs+sEP.bôs, (sCABAC.bôs+sEP.bôs)/8, 
£p
=='~'?']':' ');

257 
	}
}

258 
Void
 
	$OuçutLöe
(c⁄° 
TCh¨
 *
pName
, c⁄° TCh¨ 
£p
, c⁄° TCh¨ *
pWidthSåög
, c⁄° TCh¨ *
pSubCœssSå
, c⁄° 
SSèt
 &
sCABAC
, c⁄° SSèà&
sEP
)

260 
	`¥ötf
("%c%-45s%c %6s %6s %12lld %12lld %12lld %12lld %12lld %12lld %12lld (%12lld)%c\n",

261 
£p
=='~'?'[':' ', 
pName
, sï, 
pWidthSåög
, 
pSubCœssSå
,

262 
sCABAC
.
cou¡
, sCABAC.
sum
, sCABAC.
bôs
, 
sEP
.cou¡, sEP.sum, sEP.bôs, sCABAC.bôs+sEP.bôs, (sCABAC.bôs+sEP.bôs)/8, 
£p
=='~'?']':' ');

263 
	}
}

264 
Void
 
	$OuçutLöe
(c⁄° 
TCh¨
 *
pName
, c⁄° TCh¨ 
£p
, c⁄° TCh¨ *
pWidthSåög
, c⁄° TCh¨ *
pSubCœssSå
, c⁄° 
SSèt
 &
sEP
)

266 
	`¥ötf
("%c%-45s%c %6s %6s %12s %12s %12s %12lld %12lld %12lld %12lld (%12lld)%c\n",

267 
£p
=='~'?'[':' ', 
pName
, sï, 
pWidthSåög
, 
pSubCœssSå
,

268 "", "", "", 
sEP
.
cou¡
, sEP.
sum
, sEP.
bôs
, sEP.bôs, (sEP.bôs)/8, 
£p
=='~'?']':' ');

269 
	}
}

271 
Void
 
	$OuçutDashedLöe
(c⁄° 
TCh¨
 *
pText
)

273 
	`¥ötf
("--%s",
pText
);

274 
UI¡
 
tŸ
=0;

275 ;
pText
[
tŸ
]!=0;Åot++);

277 
tŸ
+=2;

278 ; 
tŸ
<168;Åot++)

280 
	`¥ötf
("-");

282 
	`¥ötf
("\n");

283 
	}
}

285 ~
	$TComCodögSèti°ics
()

287 c⁄° 
I¡64
 
es
=
TCOMCODINGSTATISTICS_ENTROPYSCALE
;

289 
I¡64
 
¸
=0;

291 
I¡64
 
tŸÆCABACbôs
=0, 
roundedCABACbôs
=0;

292 
I¡
 
i
=
STATS__NAL_UNIT_PACKING
; i<
STATS__NUM_STATS
; i++)

294 
UI¡
 
c
=0; c<
CODING_STATS_NUM_SUBCLASSES
; c++)

296 
tŸÆCABACbôs
+=
d©a
.
°©i°ics
[
i
][
c
].
bôs
;

297 
roundedCABACbôs
+=
d©a
.
°©i°ics
[
i
][
c
].
bôs
/
es
;

300 
I¡64
 
ªmaödî
=
tŸÆCABACbôs
 - 
roundedCABACbôs
*
es
;

301 
¸
=(
ªmaödî
+
es
/2)/es;

304 
	`¥ötf
("NŸê%†wû»bêex˛uded fromÅhêtŸÆá†ô should bêthêsum o‡Æ»thêŸhîÉ¡rõ†”x˚± f‹ %s)\n", 
	`gëName
(
STATS__NAL_UNIT_TOTAL_BODY
), gëName(
STATS__NAL_UNIT_PACKING
));

305 
	`¥ötf
(" %-45s- Width Type CABAC Count CABAC Sum CABAC bits EP Count EP Sum EP bits Total bits ( Total bytes)\n", "Decoder statistics");

307 
	`OuçutDashedLöe
("");

308 
SSèt
 
ˇbacTŸÆBôs
, 
ïTŸÆBôs
;

309 
SSèt
 
°©TŸÆs_ˇbac
[
CODING_STATS_NUM_SUBCLASSES
];

310 
SSèt
 
°©TŸÆs_ï
[
CODING_STATS_NUM_SUBCLASSES
];

312 
I¡
 
i
=0; i<
STATS__NUM_STATS
; i++)

314 
SSèt
 
ˇbacSubTŸÆ
, 
ïSubTŸÆ
;

315 
Boﬁ
 
bHadCœssifõdE¡ry
=
Ál£
;

316 c⁄° 
TCh¨
 *
pName
=
	`gëName
(
	`TComCodögSèti°icsTy≥
(
i
));

318 
UI¡
 
c
=0; c<
CODING_STATS_NUM_SUBCLASSES
; c++)

320 
SSèt
 &
sCABAC‹ig
=
d©a
.
°©i°ics
[
i
][
c
];

321 
SSèt
 &
sEP
=
d©a
.
°©i°ics_ï
[
i
][
c
];

323 i‡(
sCABAC‹ig
.
bôs
==0 && 
sEP
.bits==0)

328 
SSèt
 
sCABAC
;

330 
I¡64
 
thisCABACbôs
=
sCABAC‹ig
.
bôs
/
es
;

331 i‡(
i
==
STATS__CABAC_INITIALISATION
 && 
sCABAC‹ig
.
bôs
!=0)

333 
thisCABACbôs
+=
¸
;

334 
¸
=0;

336 
sCABAC
.
bôs
=
thisCABACbôs
;

337 
sCABAC
.
cou¡
=
sCABAC‹ig
.count;

338 
sCABAC
.
sum
=
sCABAC‹ig
.sum;

340 
UI¡
 
width
=
TComCodögSèti°icsCœssTy≥
::
	`GëSubCœssWidth
(
c
);

341 
	`OuçutLöe
(
pName
, ':', 
width
, 
TComCodögSèti°icsCœssTy≥
::
	`GëSubCœssSåög
(
c
), 
sCABAC
, 
sEP
);

342 
ˇbacSubTŸÆ
+=
sCABAC
;

343 
ïSubTŸÆ
+=
sEP
;

344 i‡(
i
!=
STATS__NAL_UNIT_TOTAL_BODY
)

346 
ˇbacTŸÆBôs
+=
sCABAC
;

347 
ïTŸÆBôs
+=
sEP
;

348 
°©TŸÆs_ˇbac
[
c
]+=
sCABAC
;

349 
°©TŸÆs_ï
[
c
]+=
sEP
;

351 
bHadCœssifõdE¡ry
=bHadCœssifõdE¡ry||(
c
!=0);

353 i‡(
bHadCœssifõdE¡ry
)

355 
	`OuçutLöe
(
pName
, '~', "~~ST~~", "~~ST~~", 
ˇbacSubTŸÆ
, 
ïSubTŸÆ
);

357 i‡(
i
==
STATS__NAL_UNIT_TOTAL_BODY
)

359 
	`OuçutDashedLöe
("");

362 
	`OuçutDashedLöe
("");

363 
	`OuçutLöe
("CABAC Sub-tŸÆ", '~', "~~ST~~", "~~ST~~", 
ˇbacTŸÆBôs
, 
ïTŸÆBôs
);

365 
	`OuçutDashedLöe
("CAVLC HEADER BITS");

366 
SSèt
 
ˇvlcTŸÆBôs
;

367 
°d
::
m≠
<°d::
°rög
, 
SSèt
>::
ôî©‹
 
ô
=
d©a
.
m≠pögs_ï
.
	`begö
(); it!=d©a.m≠pögs_ï.
	`íd
(); it++)

369 
SSèt
 
s
=
ô
->
£c⁄d
;

370 
ˇvlcTŸÆBôs
+=
s
;

371 
	`OuçutLöe
(
ô
->
fú°
.
	`c_°r
(), ':', "-", "-", 
s
);

374 
	`OuçutDashedLöe
("");

375 
	`OuçutLöe
("CAVLC Hódî Sub-tŸÆ", '~', "~~ST~~", "~~ST~~", 
ˇvlcTŸÆBôs
);

378 
	`OuçutDashedLöe
("CABAC Break down by size");

379 
UI¡
 
s
=0; s<
CODING_STATS_NUM_WIDTHS
; s++)

381 
SSèt
 
subTŸÆCabac
, 
subTŸÆEP
;

382 
UI¡
 
c
=0; c<
CODING_STATS_NUM_SUBCLASSES
; c+=
CODING_STATS_NUM_WIDTHS
)

384 
subTŸÆCabac
+=
°©TŸÆs_ˇbac
[
c
+
s
];

385 
subTŸÆEP
+=
°©TŸÆs_ï
[
c
+
s
];

387 i‡(
subTŸÆCabac
.
bôs
!=0 || 
subTŸÆEP
.bits!=0)

389 
	`OuçutLöe
("CABAC by sizêSub-tŸÆ", '=', 
s
, "AŒ", 
subTŸÆCabac
, 
subTŸÆEP
);

392 
	`OuçutDashedLöe
("Break down by component/ChannelÅype");

393 
UI¡
 
c
=0; c<
CODING_STATS_NUM_SUBCLASSES
; c+=
CODING_STATS_NUM_WIDTHS
)

395 
SSèt
 
subTŸÆCabac
, 
subTŸÆEP
;

396 
UI¡
 
s
=0; s<
CODING_STATS_NUM_WIDTHS
; s++)

398 
subTŸÆCabac
+=
°©TŸÆs_ˇbac
[
c
+
s
];

399 
subTŸÆEP
+=
°©TŸÆs_ï
[
c
+
s
];

401 i‡(
subTŸÆCabac
.
bôs
!=0 || 
subTŸÆEP
.bits!=0)

403 
	`OuçutLöe
("CABAC byÅy≥ Sub-tŸÆ", '=', "-", 
TComCodögSèti°icsCœssTy≥
::
	`GëSubCœssSåög
(
c
), 
subTŸÆCabac
, 
subTŸÆEP
);

406 
	`OuçutDashedLöe
("Break down by sizeánd component/ChannelÅype");

407 
UI¡
 
c
=0; c<
CODING_STATS_NUM_SUBCLASSES
; c+=
CODING_STATS_NUM_WIDTHS
)

409 
UI¡
 
s
=0; s<
CODING_STATS_NUM_WIDTHS
; s++)

411 
SSèt
 
subTŸÆCabac
, 
subTŸÆEP
;

412 
subTŸÆCabac
+=
°©TŸÆs_ˇbac
[
c
+
s
];

413 
subTŸÆEP
+=
°©TŸÆs_ï
[
c
+
s
];

414 i‡(
subTŸÆCabac
.
bôs
!=0 || 
subTŸÆEP
.bits!=0)

416 
	`OuçutLöe
("CABAC by sizê™dÅy≥ Sub-tŸÆ", '=', 
s
, 
TComCodögSèti°icsCœssTy≥
::
	`GëSubCœssSåög
(
c
), 
subTŸÆCabac
, 
subTŸÆEP
);

421 
	`OuçutDashedLöe
("");

422 
	`OuçutLöe
("CABAC Sub-tŸÆ", '~', "~~ST~~", "~~ST~~", 
ˇbacTŸÆBôs
, 
ïTŸÆBôs
);

423 
	`OuçutLöe
("CAVLC Hódî Sub-tŸÆ", '~', "~~ST~~", "~~ST~~", 
ˇvlcTŸÆBôs
);

424 
	`OuçutDashedLöe
("GRAND TOTAL");

425 
ïTŸÆBôs
+=
ˇvlcTŸÆBôs
;

426 
	`OuçutLöe
("TOTAL", '~', "~~GT~~", "~~GT~~", 
ˇbacTŸÆBôs
, 
ïTŸÆBôs
);

427 
	}
}

430 
	gpublic
:

431 
TComCodögSèti°ics
& 
	$GëSögÀt⁄In°™˚
()

433 
TComCodögSèti°ics
 
ö°
;

434  
ö°
;

435 
	}
}

437 c⁄° 
	gTComCodögSèti°icsD©a
 &
	$GëSèti°ics
(Ë{  
	`GëSögÀt⁄In°™˚
().
d©a
; 
	}
}

438 
Void
 
	$SëSèti°ics
(c⁄° 
TComCodögSèti°icsD©a
 &
§c
Ë{ 
	`GëSögÀt⁄In°™˚
().
d©a
=§c; 
	}
}

440 
	gSSèt
 &
	$GëSèti°icEP
(c⁄° 
TComCodögSèti°icsCœssTy≥
 &
°©
Ë{  
	`GëSögÀt⁄In°™˚
().
d©a
.
°©i°ics_ï
[°©.
ty≥
][°©.
subCœss
]; 
	}
}

442 
	gSSèt
 &
	$GëSèti°icEP
(c⁄° 
°d
::
°rög
 &
°r
Ë{  
	`GëSögÀt⁄In°™˚
().
d©a
.
m≠pögs_ï
[°r]; 
	}
}

444 
	gSSèt
 &
	$GëSèti°icEP
(c⁄° 
TCh¨
 *
pKey
Ë{ 
	`GëSèti°icEP
(
°d
::
	`°rög
’Key)); 
	}
}

446 
Void
 
	$In¸emítSèti°icEP
(c⁄° 
TComCodögSèti°icsCœssTy≥
 &
°©
, c⁄° 
I¡
 
numBôs
, c⁄° I¡ 
vÆue
)

448 
SSèt
 &
s
=
	`GëSèti°icEP
(
°©
);

449 
s
.
bôs
+=
numBôs
;

450 
s
.
cou¡
++;

451 
s
.
sum
+=
vÆue
;

452 
	}
}

454 
Void
 
	$In¸emítSèti°icEP
(c⁄° 
°d
::
°rög
 &
°r
, c⁄° 
I¡
 
numBôs
, c⁄° I¡ 
vÆue
)

456 
SSèt
 &
s
=
	`GëSèti°icEP
(
°r
);

457 
s
.
bôs
+=
numBôs
;

458 
s
.
cou¡
++;

459 
s
.
sum
+=
vÆue
;

460 
	}
}

462 
Void
 
	$In¸emítSèti°icEP
(c⁄° 
TCh¨
 *
pKey
, c⁄° 
I¡
 
numBôs
, c⁄° I¡ 
vÆue
)

464 
SSèt
 &
s
=
	`GëSèti°icEP
(
pKey
);

465 
s
.
bôs
+=
numBôs
;

466 
s
.
cou¡
++;

467 
s
.
sum
+=
vÆue
;

468 
	}
}

470 
SètLogVÆue
 
	gvÆues
;

472 
Void
 
	$Upd©eCABACSèt
(c⁄° 
TComCodögSèti°icsCœssTy≥
 &
°©
, 
UI¡
 
uiR™geBef‹e
, UI¡ 
uiR™geA·î
, 
I¡
 
vÆ
)

474 
TComCodögSèti°ics
 &
ö°
=
	`GëSögÀt⁄In°™˚
();

478 
SSèt
 &
s
=
ö°
.
d©a
.
°©i°ics
[
°©
.
ty≥
][°©.
subCœss
];

479 
s
.
bôs
+=
ö°
.
vÆues
.vÆues[
uiR™geBef‹e
]-ö°.vÆues.vÆues[
uiR™geA·î
];

480 
s
.
cou¡
++;

481 
s
.
sum
+=
vÆ
;

482 
	}
}

	@TLibCommon/TComDataCU.cpp

39 
	~"TComD©aCU.h
"

40 
	~"TComTU.h
"

41 
	~"TComPic.h
"

50 
	gTComD©aCU
::
	$TComD©aCU
()

52 
m_pcPic
 = 
NULL
;

53 
m_pcSli˚
 = 
NULL
;

54 
m_puhDïth
 = 
NULL
;

56 
m_skùFœg
 = 
NULL
;

58 
m_≥P¨tSize
 = 
NULL
;

59 
m_≥PªdMode
 = 
NULL
;

60 
m_CUTønsqu™tBy∑ss
 = 
NULL
;

61 
m_puhWidth
 = 
NULL
;

62 
m_puhHeight
 = 
NULL
;

63 
m_phQP
 = 
NULL
;

64 
m_ChromaQpAdj
 = 
NULL
;

65 
m_pbMîgeFœg
 = 
NULL
;

66 
m_puhMîgeIndex
 = 
NULL
;

67 
UI¡
 
i
=0; i<
MAX_NUM_CHANNEL_TYPE
; i++)

69 
m_puhI¡øDú
[
i
] = 
NULL
;

71 
m_puhI¡îDú
 = 
NULL
;

72 
m_puhTrIdx
 = 
NULL
;

74 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

76 
m_puhCbf
[
comp
] = 
NULL
;

77 
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
] = 
NULL
;

78 
m_puhTønsf‹mSkù
[
comp
] = 
NULL
;

79 
m_pcTrC€ff
[
comp
] = 
NULL
;

80 #i‡
ADAPTIVE_QP_SELECTION


81 
m_pcAæC€ff
[
comp
] = 
NULL
;

83 
m_pcIPCMSam∂e
[
comp
] = 
NULL
;

84 
m_ex∂icôRdpcmMode
[
comp
] = 
NULL
;

86 #i‡
ADAPTIVE_QP_SELECTION


87 
m_AæC€ffIsAlü£dAŒoˇti⁄
 = 
Ál£
;

89 
m_pbIPCMFœg
 = 
NULL
;

91 
m_pCtuAboveLe·
 = 
NULL
;

92 
m_pCtuAboveRight
 = 
NULL
;

93 
m_pCtuAbove
 = 
NULL
;

94 
m_pCtuLe·
 = 
NULL
;

96 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

98 
m_≠iMVPIdx
[
i
] = 
NULL
;

99 
m_≠iMVPNum
[
i
] = 
NULL
;

102 
m_bDecSubCu
 = 
Ál£
;

103 
	}
}

105 
	gTComD©aCU
::~
	$TComD©aCU
()

107 
	}
}

109 
Void
 
TComD©aCU
::
¸óã
–
ChromaF‹m©
 
chromaF‹m©IDC
, 
UI¡
 
uiNumP¨tôi⁄
, UI¡ 
uiWidth
, UI¡ 
uiHeight
, 
Boﬁ
 
bDecSubCu
, 
I¡
 
unôSize


110 #i‡
ADAPTIVE_QP_SELECTION


111 , 
TC€ff
 *
pP¨ítARLBuf„r


115 
	gm_bDecSubCu
 = 
bDecSubCu
;

117 
	gm_pcPic
 = 
NULL
;

118 
	gm_pcSli˚
 = 
NULL
;

119 
	gm_uiNumP¨tôi⁄
 = 
uiNumP¨tôi⁄
;

120 
	gm_unôSize
 = 
unôSize
;

122 i‡–!
	gbDecSubCu
 )

124 
	gm_phQP
 = (
SCh¨
* )
xMÆloc
(SCh¨, 
uiNumP¨tôi⁄
);

125 
	gm_puhDïth
 = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

126 
	gm_puhWidth
 = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

127 
	gm_puhHeight
 = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

129 
	gm_ChromaQpAdj
 = 
√w
 
UCh¨
[ 
uiNumP¨tôi⁄
 ];

130 
	gm_skùFœg
 = 
√w
 
Boﬁ
[ 
uiNumP¨tôi⁄
 ];

131 
	gm_≥P¨tSize
 = 
√w
 
SCh¨
[ 
uiNumP¨tôi⁄
 ];

132 
mem£t
–
m_≥P¨tSize
, 
NUMBER_OF_PART_SIZES
,
uiNumP¨tôi⁄
 * ( *m_pePartSize ) );

133 
	gm_≥PªdMode
 = 
√w
 
SCh¨
[ 
uiNumP¨tôi⁄
 ];

134 
	gm_CUTønsqu™tBy∑ss
 = 
√w
 
Boﬁ
[ 
uiNumP¨tôi⁄
 ];

136 
	gm_pbMîgeFœg
 = (
Boﬁ
* )
xMÆloc
(Boﬁ, 
uiNumP¨tôi⁄
);

137 
	gm_puhMîgeIndex
 = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

139 
UI¡
 
	gch
=0; ch<
	gMAX_NUM_CHANNEL_TYPE
; ch++)

141 
	gm_puhI¡øDú
[
ch
] = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

143 
	gm_puhI¡îDú
 = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

145 
	gm_puhTrIdx
 = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

147 
UI¡
 
	gi
=0; i<
	gNUM_REF_PIC_LIST_01
; i++)

149 c⁄° 
RefPicLi°
 
	gΩl
=RefPicLi°(
i
);

150 
	gm_≠iMVPIdx
[
Ωl
] = 
√w
 
SCh¨
[ 
uiNumP¨tôi⁄
 ];

151 
	gm_≠iMVPNum
[
Ωl
] = 
√w
 
SCh¨
[ 
uiNumP¨tôi⁄
 ];

152 
mem£t
–
m_≠iMVPIdx
[
Ωl
], -1,
uiNumP¨tôi⁄
 * –
SCh¨
 ) );

155 
UI¡
 
	gcomp
=0; comp<
	gMAX_NUM_COMPONENT
; comp++)

157 c⁄° 
Comp⁄ítID
 
	gcompID
 = Comp⁄ítID(
comp
);

158 c⁄° 
UI¡
 
	gchromaShi·
 = 
gëComp⁄ítSˇÀX
(
compID
, 
chromaF‹m©IDC
Ë+ 
gëComp⁄ítSˇÀY
(compID, chromaFormatIDC);

159 c⁄° 
UI¡
 
	gtŸÆSize
 = (
uiWidth
 * 
uiHeight
Ë>> 
chromaShi·
;

161 
	gm_¸ossComp⁄ítPªdi˘i⁄AÕha
[
compID
] = (
SCh¨
* )
xMÆloc
(SCh¨, 
uiNumP¨tôi⁄
);

162 
	gm_puhTønsf‹mSkù
[
compID
] = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

163 
	gm_ex∂icôRdpcmMode
[
compID
] = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

164 
	gm_puhCbf
[
compID
] = (
UCh¨
* )
xMÆloc
(UCh¨, 
uiNumP¨tôi⁄
);

165 
	gm_pcTrC€ff
[
compID
] = (
TC€ff
*)
xMÆloc
(TC€ff, 
tŸÆSize
);

166 
mem£t
–
m_pcTrC€ff
[
compID
], 0, (
tŸÆSize
 * –
TC€ff
 )) );

168 #i‡
ADAPTIVE_QP_SELECTION


169 if–
	gpP¨ítARLBuf„r
 != 0 )

171 
m_pcAæC€ff
[
compID
] = 
pP¨ítARLBuf„r
;

172 
	gm_AæC€ffIsAlü£dAŒoˇti⁄
 = 
åue
;

173 
	gpP¨ítARLBuf„r
 +
tŸÆSize
;

177 
	gm_pcAæC€ff
[
compID
] = (
TC€ff
*)
xMÆloc
(TC€ff, 
tŸÆSize
);

178 
	gm_AæC€ffIsAlü£dAŒoˇti⁄
 = 
Ál£
;

181 
	gm_pcIPCMSam∂e
[
compID
] = (
Pñ
* )
xMÆloc
(Pñ , 
tŸÆSize
);

184 
	gm_pbIPCMFœg
 = (
Boﬁ
* )
xMÆloc
(Boﬁ, 
uiNumP¨tôi⁄
);

186 
UI¡
 
	gi
=0; i<
	gNUM_REF_PIC_LIST_01
; i++)

188 
	gm_acCUMvFõld
[
i
].
¸óã
–
uiNumP¨tôi⁄
 );

194 
UI¡
 
	gi
=0; i<
	gNUM_REF_PIC_LIST_01
; i++)

196 
	gm_acCUMvFõld
[
i
].
£tNumP¨tôi⁄
(
uiNumP¨tôi⁄
 );

202 
	gm_pCtuAboveLe·
 = 
NULL
;

203 
	gm_pCtuAboveRight
 = 
NULL
;

204 
	gm_pCtuAbove
 = 
NULL
;

205 
	gm_pCtuLe·
 = 
NULL
;

208 
Void
 
	gTComD©aCU
::
	$de°roy
()

211 i‡–!
m_bDecSubCu
 )

213 i‡–
m_phQP
 )

215 
	`xFªe
(
m_phQP
);

216 
m_phQP
 = 
NULL
;

218 i‡–
m_puhDïth
 )

220 
	`xFªe
(
m_puhDïth
);

221 
m_puhDïth
 = 
NULL
;

223 i‡–
m_puhWidth
 )

225 
	`xFªe
(
m_puhWidth
);

226 
m_puhWidth
 = 
NULL
;

228 i‡–
m_puhHeight
 )

230 
	`xFªe
(
m_puhHeight
);

231 
m_puhHeight
 = 
NULL
;

234 i‡–
m_skùFœg
 )

236 
dñëe
[] 
m_skùFœg
;

237 
m_skùFœg
 = 
NULL
;

240 i‡–
m_≥P¨tSize
 )

242 
dñëe
[] 
m_≥P¨tSize
;

243 
m_≥P¨tSize
 = 
NULL
;

245 i‡–
m_≥PªdMode
 )

247 
dñëe
[] 
m_≥PªdMode
;

248 
m_≥PªdMode
 = 
NULL
;

250 i‡–
m_ChromaQpAdj
 )

252 
dñëe
[] 
m_ChromaQpAdj
;

253 
m_ChromaQpAdj
 = 
NULL
;

255 i‡–
m_CUTønsqu™tBy∑ss
 )

257 
dñëe
[] 
m_CUTønsqu™tBy∑ss
;

258 
m_CUTønsqu™tBy∑ss
 = 
NULL
;

260 i‡–
m_puhI¡îDú
 )

262 
	`xFªe
(
m_puhI¡îDú
);

263 
m_puhI¡îDú
 = 
NULL
;

265 i‡–
m_pbMîgeFœg
 )

267 
	`xFªe
(
m_pbMîgeFœg
);

268 
m_pbMîgeFœg
 = 
NULL
;

270 i‡–
m_puhMîgeIndex
 )

272 
	`xFªe
(
m_puhMîgeIndex
);

273 
m_puhMîgeIndex
 = 
NULL
;

276 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

278 
	`xFªe
(
m_puhI¡øDú
[
ch
]);

279 
m_puhI¡øDú
[
ch
] = 
NULL
;

282 i‡–
m_puhTrIdx
 )

284 
	`xFªe
(
m_puhTrIdx
);

285 
m_puhTrIdx
 = 
NULL
;

288 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

290 i‡–
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
] )

292 
	`xFªe
(
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
]);

293 
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
] = 
NULL
;

295 i‡–
m_puhTønsf‹mSkù
[
comp
] )

297 
	`xFªe
(
m_puhTønsf‹mSkù
[
comp
]);

298 
m_puhTønsf‹mSkù
[
comp
] = 
NULL
;

300 i‡–
m_puhCbf
[
comp
] )

302 
	`xFªe
(
m_puhCbf
[
comp
]);

303 
m_puhCbf
[
comp
] = 
NULL
;

305 i‡–
m_pcTrC€ff
[
comp
] )

307 
	`xFªe
(
m_pcTrC€ff
[
comp
]);

308 
m_pcTrC€ff
[
comp
] = 
NULL
;

310 i‡–
m_ex∂icôRdpcmMode
[
comp
] )

312 
	`xFªe
(
m_ex∂icôRdpcmMode
[
comp
]);

313 
m_ex∂icôRdpcmMode
[
comp
] = 
NULL
;

316 #i‡
ADAPTIVE_QP_SELECTION


317 i‡(!
m_AæC€ffIsAlü£dAŒoˇti⁄
)

319 i‡–
m_pcAæC€ff
[
comp
] )

321 
	`xFªe
(
m_pcAæC€ff
[
comp
]);

322 
m_pcAæC€ff
[
comp
] = 
NULL
;

327 i‡–
m_pcIPCMSam∂e
[
comp
] )

329 
	`xFªe
(
m_pcIPCMSam∂e
[
comp
]);

330 
m_pcIPCMSam∂e
[
comp
] = 
NULL
;

333 i‡–
m_pbIPCMFœg
 )

335 
	`xFªe
(
m_pbIPCMFœg
 );

336 
m_pbIPCMFœg
 = 
NULL
;

339 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

341 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

342 i‡–
m_≠iMVPIdx
[
Ωl
] )

344 
dñëe
[] 
m_≠iMVPIdx
[
Ωl
];

345 
m_≠iMVPIdx
[
Ωl
] = 
NULL
;

347 i‡–
m_≠iMVPNum
[
Ωl
] )

349 
dñëe
[] 
m_≠iMVPNum
[
Ωl
];

350 
m_≠iMVPNum
[
Ωl
] = 
NULL
;

354 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

356 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

357 
m_acCUMvFõld
[
Ωl
].
	`de°roy
();

361 
m_pcPic
 = 
NULL
;

362 
m_pcSli˚
 = 
NULL
;

364 
m_pCtuAboveLe·
 = 
NULL
;

365 
m_pCtuAboveRight
 = 
NULL
;

366 
m_pCtuAbove
 = 
NULL
;

367 
m_pCtuLe·
 = 
NULL
;

369 
	}
}

371 
Boﬁ
 
	gTComD©aCU
::
	$CUIsFromSameTûe
 ( c⁄° 
TComD©aCU
 *
pCU
 ) const

373  
pCU
!=
NULL
 &&

374 
pCU
->
	`gëSli˚
(Ë!
NULL
 &&

375 
m_pcPic
->
	`gëPicSym
()->
	`gëTûeIdxM≠
–
pCU
->
	`gëCtuRsAddr
() ) == m_pcPic->getPicSym()->getTileIdxMap(getCtuRsAddr());

376 
	}
}

378 
Boﬁ
 
	gTComD©aCU
::
	$CUIsFromSameSli˚AndTûe
 ( c⁄° 
TComD©aCU
 *
pCU
 ) const

380  
pCU
!=
NULL
 &&

381 
pCU
->
	`gëSli˚
(Ë!
NULL
 &&

382 
pCU
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
() == getSlice()->getSliceCurStartCtuTsAddr() &&

383 
m_pcPic
->
	`gëPicSym
()->
	`gëTûeIdxM≠
–
pCU
->
	`gëCtuRsAddr
() ) == m_pcPic->getPicSym()->getTileIdxMap(getCtuRsAddr())

385 
	}
}

387 
Boﬁ
 
	gTComD©aCU
::
	$CUIsFromSameSli˚TûeAndWave‰⁄tRow
–c⁄° 
TComD©aCU
 *
pCU
 ) const

389  
	`CUIsFromSameSli˚AndTûe
(
pCU
)

390 && (!
	`gëSli˚
()->
	`gëPPS
()->
	`gëE¡r›yCodögSyncE«bÀdFœg
(Ë|| 
	`gëPic
()->
	`gëCtu
(
	`gëCtuRsAddr
())->
	`gëCUPñY
(Ë=gëPic()->gëCtu(
pCU
->getCtuRsAddr())->getCUPelY());

391 
	}
}

393 
Boﬁ
 
	gTComD©aCU
::
	$isLa°SubCUOfCtu
(c⁄° 
UI¡
 
absP¨tIdx
) const

395 c⁄° 
TComSPS
 &
•s
=*(
	`gëSli˚
()->
	`gëSPS
());

397 c⁄° 
UI¡
 
picWidth
 = 
•s
.
	`gëPicWidthInLumaSam∂es
();

398 c⁄° 
UI¡
 
picHeight
 = 
•s
.
	`gëPicHeightInLumaSam∂es
();

399 c⁄° 
UI¡
 
gønuœrôyWidth
 = 
•s
.
	`gëMaxCUWidth
();

401 c⁄° 
UI¡
 
cuPosX
 = 
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
absP¨tIdx
] ];

402 c⁄° 
UI¡
 
cuPosY
 = 
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
absP¨tIdx
] ];

404  (((
cuPosX
+
	`gëWidth
–
absP¨tIdx
))%
gønuœrôyWidth
==0||(cuPosX+gëWidth–absP¨tIdx)==
picWidth
 ))

405 && ((
cuPosY
+
	`gëHeight
(
absP¨tIdx
))%
gønuœrôyWidth
==0||(cuPosY+gëHeight◊bsP¨tIdx)==
picHeight
)));

406 
	}
}

422 
Void
 
	gTComD©aCU
::
	$öôCtu
–
TComPic
* 
pcPic
, 
UI¡
 
˘uRsAddr
 )

425 c⁄° 
UI¡
 
maxCUWidth
 = 
pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëMaxCUWidth
();

426 c⁄° 
UI¡
 
maxCUHeight

pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëMaxCUHeight
();

427 
m_pcPic
 = 
pcPic
;

428 
m_pcSli˚
 = 
pcPic
->
	`gëSli˚
’cPic->
	`gëCuºSli˚Idx
());

429 
m_˘uRsAddr
 = 
˘uRsAddr
;

430 
m_uiCUPñX
 = ( 
˘uRsAddr
 % 
pcPic
->
	`gëFømeWidthInCtus
(ËË* 
maxCUWidth
;

431 
m_uiCUPñY
 = ( 
˘uRsAddr
 / 
pcPic
->
	`gëFømeWidthInCtus
(ËË* 
maxCUHeight
;

432 
m_absZIdxInCtu
 = 0;

433 
m_dTŸÆCo°
 = 
MAX_DOUBLE
;

434 
m_uiTŸÆDi°‹ti⁄
 = 0;

435 
m_uiTŸÆBôs
 = 0;

436 
m_uiTŸÆBös
 = 0;

437 
m_uiNumP¨tôi⁄
 = 
pcPic
->
	`gëNumP¨tôi⁄sInCtu
();

439 
	`mem£t
–
m_skùFœg
 , 
Ál£
, 
m_uiNumP¨tôi⁄
 * ( *m_skipFlag ) );

441 
	`mem£t
–
m_≥P¨tSize
 , 
NUMBER_OF_PART_SIZES
, 
m_uiNumP¨tôi⁄
 * ( *m_pePartSize ) );

442 
	`mem£t
–
m_≥PªdMode
 , 
NUMBER_OF_PREDICTION_MODES
, 
m_uiNumP¨tôi⁄
 * ( *m_pePredMode ) );

443 
	`mem£t
–
m_CUTønsqu™tBy∑ss
, 
Ál£
, 
m_uiNumP¨tôi⁄
 * ( *m_CUTransquantBypass) );

444 
	`mem£t
–
m_puhDïth
 , 0, 
m_uiNumP¨tôi⁄
 * ( *m_puhDepth ) );

445 
	`mem£t
–
m_puhTrIdx
 , 0, 
m_uiNumP¨tôi⁄
 * ( *m_puhTrIdx ) );

446 
	`mem£t
–
m_puhWidth
 , 
maxCUWidth
, 
m_uiNumP¨tôi⁄
 * ( *m_puhWidth ) );

447 
	`mem£t
–
m_puhHeight
 , 
maxCUHeight
, 
m_uiNumP¨tôi⁄
 * ( *m_puhHeight ) );

448 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

450 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

451 
	`mem£t
–
m_≠iMVPIdx
[
Ωl
] , -1, 
m_uiNumP¨tôi⁄
 * ( *m_apiMVPIdx[rpl] ) );

452 
	`mem£t
–
m_≠iMVPNum
[
Ωl
] , -1, 
m_uiNumP¨tôi⁄
 * ( *m_apiMVPNum[rpl] ) );

454 
	`mem£t
–
m_phQP
 , 
	`gëSli˚
()->
	`gëSli˚Qp
(), 
m_uiNumP¨tôi⁄
 * ( *m_phQP ) );

455 
	`mem£t
–
m_ChromaQpAdj
 , 0, 
m_uiNumP¨tôi⁄
 * ( *m_ChromaQpAdj ) );

456 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

458 
	`mem£t
–
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
] , 0, 
m_uiNumP¨tôi⁄
 * ( *m_crossComponentPredictionAlpha[comp] ) );

459 
	`mem£t
–
m_puhTønsf‹mSkù
[
comp
] , 0, 
m_uiNumP¨tôi⁄
 * ( *m_puhTransformSkip[comp]) );

460 
	`mem£t
–
m_puhCbf
[
comp
] , 0, 
m_uiNumP¨tôi⁄
 * ( *m_puhCbf[comp] ) );

461 
	`mem£t
–
m_ex∂icôRdpcmMode
[
comp
] , 
NUMBER_OF_RDPCM_MODES
, 
m_uiNumP¨tôi⁄
 * ( *m_explicitRdpcmMode[comp] ) );

463 
	`mem£t
–
m_pbMîgeFœg
 , 
Ál£
, 
m_uiNumP¨tôi⁄
 * ( *m_pbMergeFlag ) );

464 
	`mem£t
–
m_puhMîgeIndex
 , 0, 
m_uiNumP¨tôi⁄
 * ( *m_puhMergeIndex ) );

465 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

467 
	`mem£t
–
m_puhI¡øDú
[
ch
] , ((ch==0Ë? 
DC_IDX
 : 0), 
m_uiNumP¨tôi⁄
 * ( *(m_puhIntraDir[ch]) ) );

469 
	`mem£t
–
m_puhI¡îDú
 , 0, 
m_uiNumP¨tôi⁄
 * ( *m_puhInterDir ) );

470 
	`mem£t
–
m_pbIPCMFœg
 , 
Ál£
, 
m_uiNumP¨tôi⁄
 * ( *m_pbIPCMFlag ) );

472 c⁄° 
UI¡
 
numC€ffY
 = 
maxCUWidth
*
maxCUHeight
;

473 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

475 c⁄° 
UI¡
 
comp⁄ítShi·
 = 
m_pcPic
->
	`gëComp⁄ítSˇÀX
(
	`Comp⁄ítID
(
comp
)Ë+ m_pcPic->
	`gëComp⁄ítSˇÀY
(ComponentID(comp));

476 
	`mem£t
–
m_pcTrC€ff
[
comp
], 0, (
TC€ff
)* 
numC€ffY
>>
comp⁄ítShi·
 );

477 #i‡
ADAPTIVE_QP_SELECTION


478 
	`mem£t
–
m_pcAæC€ff
[
comp
], 0, (
TC€ff
)* 
numC€ffY
>>
comp⁄ítShi·
 );

482 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

484 
m_acCUMvFõld
[
i
].
	`˛órMvFõld
();

488 
m_pCtuLe·
 = 
NULL
;

489 
m_pCtuAbove
 = 
NULL
;

490 
m_pCtuAboveLe·
 = 
NULL
;

491 
m_pCtuAboveRight
 = 
NULL
;

493 
UI¡
 
‰ameWidthInCtus
 = 
pcPic
->
	`gëFømeWidthInCtus
();

494 i‡–
m_˘uRsAddr
 % 
‰ameWidthInCtus
 )

496 
m_pCtuLe·
 = 
pcPic
->
	`gëCtu
–
m_˘uRsAddr
 - 1 );

499 i‡–
m_˘uRsAddr
 / 
‰ameWidthInCtus
 )

501 
m_pCtuAbove
 = 
pcPic
->
	`gëCtu
–
m_˘uRsAddr
 - 
‰ameWidthInCtus
 );

504 i‡–
m_pCtuLe·
 && 
m_pCtuAbove
 )

506 
m_pCtuAboveLe·
 = 
pcPic
->
	`gëCtu
–
m_˘uRsAddr
 - 
‰ameWidthInCtus
 - 1 );

509 i‡–
m_pCtuAbove
 && ( (
m_˘uRsAddr
%
‰ameWidthInCtus
) < (frameWidthInCtus-1) ) )

511 
m_pCtuAboveRight
 = 
pcPic
->
	`gëCtu
–
m_˘uRsAddr
 - 
‰ameWidthInCtus
 + 1 );

513 
	}
}

525 
Void
 
	gTComD©aCU
::
	$öôE°D©a
–c⁄° 
UI¡
 
uiDïth
, c⁄° 
I¡
 
qp
, c⁄° 
Boﬁ
 
bTønsqu™tBy∑ss
 )

527 
m_dTŸÆCo°
 = 
MAX_DOUBLE
;

528 
m_uiTŸÆDi°‹ti⁄
 = 0;

529 
m_uiTŸÆBôs
 = 0;

530 
m_uiTŸÆBös
 = 0;

532 c⁄° 
UCh¨
 
uhWidth
 = 
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
(Ë>> 
uiDïth
;

533 c⁄° 
UCh¨
 
uhHeight
 = 
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUHeight
(Ë>> 
uiDïth
;

535 
UI¡
 
ui
 = 0; uò< 
m_uiNumP¨tôi⁄
; ui++)

537 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

539 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

540 
m_≠iMVPIdx
[
Ωl
][
ui
] = -1;

541 
m_≠iMVPNum
[
Ωl
][
ui
] = -1;

543 
m_puhDïth
 [
ui
] = 
uiDïth
;

544 
m_puhWidth
 [
ui
] = 
uhWidth
;

545 
m_puhHeight
 [
ui
] = 
uhHeight
;

546 
m_puhTrIdx
 [
ui
] = 0;

547 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

549 
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
][
ui
] = 0;

550 
m_puhTønsf‹mSkù
 [
comp
][
ui
] = 0;

551 
m_ex∂icôRdpcmMode
 [
comp
][
ui
] = 
NUMBER_OF_RDPCM_MODES
;

553 
m_skùFœg
[
ui
] = 
Ál£
;

554 
m_≥P¨tSize
[
ui
] = 
NUMBER_OF_PART_SIZES
;

555 
m_≥PªdMode
[
ui
] = 
NUMBER_OF_PREDICTION_MODES
;

556 
m_CUTønsqu™tBy∑ss
[
ui
] = 
bTønsqu™tBy∑ss
;

557 
m_pbIPCMFœg
[
ui
] = 0;

558 
m_phQP
[
ui
] = 
qp
;

559 
m_ChromaQpAdj
[
ui
] = 0;

560 
m_pbMîgeFœg
[
ui
] = 0;

561 
m_puhMîgeIndex
[
ui
] = 0;

563 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

565 
m_puhI¡øDú
[
ch
][
ui
] = ((ch==0Ë? 
DC_IDX
 : 0);

568 
m_puhI¡îDú
[
ui
] = 0;

569 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

571 
m_puhCbf
[
comp
][
ui
] = 0;

575 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

577 
m_acCUMvFõld
[
i
].
	`˛órMvFõld
();

580 c⁄° 
UI¡
 
numC€ffY
 = 
uhWidth
*
uhHeight
;

582 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

584 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp
);

585 c⁄° 
UI¡
 
numC€ff
 = 
numC€ffY
 >> (
	`gëPic
()->
	`gëComp⁄ítSˇÀX
(
comp⁄ít
Ë+ gëPic()->
	`gëComp⁄ítSˇÀY
(component));

586 
	`mem£t
–
m_pcTrC€ff
[
comp
], 0, 
numC€ff
 * –
TC€ff
 ) );

587 #i‡
ADAPTIVE_QP_SELECTION


588 
	`mem£t
–
m_pcAæC€ff
[
comp
], 0, 
numC€ff
 * –
TC€ff
 ) );

590 
	`mem£t
–
m_pcIPCMSam∂e
[
comp
], 0, 
numC€ff
 * –
Pñ
) );

592 
	}
}

596 
Void
 
	gTComD©aCU
::
	$öôSubCU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tUnôIdx
, UI¡ 
uiDïth
, 
I¡
 
qp
 )

598 
	`as£π
–
uiP¨tUnôIdx
<4 );

600 
UI¡
 
uiP¨tOff£t
 = ( 
pcCU
->
	`gëTŸÆNumP¨t
()>>2 )*
uiP¨tUnôIdx
;

602 
m_pcPic
 = 
pcCU
->
	`gëPic
();

603 
m_pcSli˚
 = 
pcCU
->
	`gëSli˚
();

604 
m_˘uRsAddr
 = 
pcCU
->
	`gëCtuRsAddr
();

605 
m_absZIdxInCtu
 = 
pcCU
->
	`gëZ‹dîIdxInCtu
(Ë+ 
uiP¨tOff£t
;

607 c⁄° 
UCh¨
 
uhWidth
 = 
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
(Ë>> 
uiDïth
;

608 c⁄° 
UCh¨
 
uhHeight
 = 
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUHeight
(Ë>> 
uiDïth
;

610 
m_uiCUPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ ( 
uhWidth
 )*–
uiP¨tUnôIdx
 & 1 );

611 
m_uiCUPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ ( 
uhHeight
)*–
uiP¨tUnôIdx
 >> 1 );

613 
m_dTŸÆCo°
 = 
MAX_DOUBLE
;

614 
m_uiTŸÆDi°‹ti⁄
 = 0;

615 
m_uiTŸÆBôs
 = 0;

616 
m_uiTŸÆBös
 = 0;

617 
m_uiNumP¨tôi⁄
 = 
pcCU
->
	`gëTŸÆNumP¨t
() >> 2;

619 
I¡
 
iSizeInUch¨
 = –
UCh¨
 ) * 
m_uiNumP¨tôi⁄
;

620 
I¡
 
iSizeInBoﬁ
 = –
Boﬁ
 ) * 
m_uiNumP¨tôi⁄
;

621 
I¡
 
sizeInCh¨
 = –
SCh¨
 ) * 
m_uiNumP¨tôi⁄
;

623 
	`mem£t
–
m_phQP
, 
qp
, 
sizeInCh¨
 );

624 
	`mem£t
–
m_pbMîgeFœg
, 0, 
iSizeInBoﬁ
 );

625 
	`mem£t
–
m_puhMîgeIndex
, 0, 
iSizeInUch¨
 );

626 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

628 
	`mem£t
–
m_puhI¡øDú
[
ch
], ((ch==0Ë? 
DC_IDX
 : 0), 
iSizeInUch¨
 );

631 
	`mem£t
–
m_puhI¡îDú
, 0, 
iSizeInUch¨
 );

632 
	`mem£t
–
m_puhTrIdx
, 0, 
iSizeInUch¨
 );

634 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

636 
	`mem£t
–
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
], 0, 
iSizeInUch¨
 );

637 
	`mem£t
–
m_puhTønsf‹mSkù
[
comp
], 0, 
iSizeInUch¨
 );

638 
	`mem£t
–
m_puhCbf
[
comp
], 0, 
iSizeInUch¨
 );

639 
	`mem£t
–
m_ex∂icôRdpcmMode
[
comp
], 
NUMBER_OF_RDPCM_MODES
, 
iSizeInUch¨
 );

642 
	`mem£t
–
m_puhDïth
, 
uiDïth
, 
iSizeInUch¨
 );

643 
	`mem£t
–
m_puhWidth
, 
uhWidth
, 
iSizeInUch¨
 );

644 
	`mem£t
–
m_puhHeight
, 
uhHeight
, 
iSizeInUch¨
 );

645 
	`mem£t
–
m_pbIPCMFœg
, 0, 
iSizeInBoﬁ
 );

646 
UI¡
 
ui
 = 0; uò< 
m_uiNumP¨tôi⁄
; ui++)

648 
m_skùFœg
[
ui
] = 
Ál£
;

649 
m_≥P¨tSize
[
ui
] = 
NUMBER_OF_PART_SIZES
;

650 
m_≥PªdMode
[
ui
] = 
NUMBER_OF_PREDICTION_MODES
;

651 
m_CUTønsqu™tBy∑ss
[
ui
] = 
Ál£
;

652 
m_ChromaQpAdj
[
ui
] = 0;

654 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

656 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

657 
m_≠iMVPIdx
[
Ωl
][
ui
] = -1;

658 
m_≠iMVPNum
[
Ωl
][
ui
] = -1;

662 c⁄° 
UI¡
 
numC€ffY
 = 
uhWidth
*
uhHeight
;

663 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

665 c⁄° 
UI¡
 
comp⁄ítShi·
 = 
m_pcPic
->
	`gëComp⁄ítSˇÀX
(
	`Comp⁄ítID
(
ch
)Ë+ m_pcPic->
	`gëComp⁄ítSˇÀY
(ComponentID(ch));

666 
	`mem£t
–
m_pcTrC€ff
[
ch
], 0, (
TC€ff
)*(
numC€ffY
>>
comp⁄ítShi·
) );

667 #i‡
ADAPTIVE_QP_SELECTION


668 
	`mem£t
–
m_pcAæC€ff
[
ch
], 0, (
TC€ff
)*(
numC€ffY
>>
comp⁄ítShi·
) );

670 
	`mem£t
–
m_pcIPCMSam∂e
[
ch
], 0, (
Pñ
)* (
numC€ffY
>>
comp⁄ítShi·
) );

673 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

675 
m_acCUMvFõld
[
i
].
	`˛órMvFõld
();

678 
m_pCtuLe·
 = 
pcCU
->
	`gëCtuLe·
();

679 
m_pCtuAbove
 = 
pcCU
->
	`gëCtuAbove
();

680 
m_pCtuAboveLe·
 = 
pcCU
->
	`gëCtuAboveLe·
();

681 
m_pCtuAboveRight
 = 
pcCU
->
	`gëCtuAboveRight
();

682 
	}
}

684 
Void
 
	gTComD©aCU
::
	$£tOutsideCUP¨t
–
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

686 c⁄° 
UI¡
 
uiNumP¨tôi⁄
 = 
m_uiNumP¨tôi⁄
 >> (
uiDïth
 << 1);

687 c⁄° 
UI¡
 
uiSizeInUch¨
 = –
UCh¨
 ) * 
uiNumP¨tôi⁄
;

688 c⁄° 
TComSPS
 &
•s
 = *(
	`gëSli˚
()->
	`gëSPS
());

689 c⁄° 
UCh¨
 
uhWidth
 = 
•s
.
	`gëMaxCUWidth
(Ë>> 
uiDïth
;

690 c⁄° 
UCh¨
 
uhHeight
 = 
•s
.
	`gëMaxCUHeight
(Ë>> 
uiDïth
;

691 
	`mem£t
–
m_puhDïth
 + 
uiAbsP¨tIdx
, 
uiDïth
, 
uiSizeInUch¨
 );

692 
	`mem£t
–
m_puhWidth
 + 
uiAbsP¨tIdx
, 
uhWidth
, 
uiSizeInUch¨
 );

693 
	`mem£t
–
m_puhHeight
 + 
uiAbsP¨tIdx
, 
uhHeight
, 
uiSizeInUch¨
 );

694 
	}
}

700 
Void
 
	gTComD©aCU
::
	$c›ySubCU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

702 
UI¡
 
uiP¨t
 = 
uiAbsP¨tIdx
;

704 
m_pcPic
 = 
pcCU
->
	`gëPic
();

705 
m_pcSli˚
 = 
pcCU
->
	`gëSli˚
();

706 
m_˘uRsAddr
 = 
pcCU
->
	`gëCtuRsAddr
();

707 
m_absZIdxInCtu
 = 
uiAbsP¨tIdx
;

709 
m_uiCUPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

710 
m_uiCUPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

712 
m_skùFœg
=
pcCU
->
	`gëSkùFœg
(Ë+ 
uiP¨t
;

714 
m_phQP
=
pcCU
->
	`gëQP
(Ë+ 
uiP¨t
;

715 
m_ChromaQpAdj
 = 
pcCU
->
	`gëChromaQpAdj
(Ë+ 
uiP¨t
;

716 
m_≥P¨tSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
(Ë+ 
uiP¨t
;

717 
m_≥PªdMode
=
pcCU
->
	`gëPªdi˘i⁄Mode
(Ë+ 
uiP¨t
;

718 
m_CUTønsqu™tBy∑ss
 = 
pcCU
->
	`gëCUTønsqu™tBy∑ss
()+
uiP¨t
;

720 
m_pbMîgeFœg
 = 
pcCU
->
	`gëMîgeFœg
(Ë+ 
uiP¨t
;

721 
m_puhMîgeIndex
 = 
pcCU
->
	`gëMîgeIndex
(Ë+ 
uiP¨t
;

723 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

725 
m_puhI¡øDú
[
ch
] = 
pcCU
->
	`gëI¡øDú
(
	`Ch™√lTy≥
(ch)Ë+ 
uiP¨t
;

728 
m_puhI¡îDú
 = 
pcCU
->
	`gëI¡îDú
(Ë+ 
uiP¨t
;

729 
m_puhTrIdx
 = 
pcCU
->
	`gëTønsf‹mIdx
(Ë+ 
uiP¨t
;

731 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

733 
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
] = 
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
	`Comp⁄ítID
(comp)Ë+ 
uiP¨t
;

734 
m_puhTønsf‹mSkù
[
comp
] = 
pcCU
->
	`gëTønsf‹mSkù
(
	`Comp⁄ítID
(comp)Ë+ 
uiP¨t
;

735 
m_puhCbf
[
comp
] = 
pcCU
->
	`gëCbf
(
	`Comp⁄ítID
(comp)Ë+ 
uiP¨t
;

736 
m_ex∂icôRdpcmMode
[
comp
] = 
pcCU
->
	`gëEx∂icôRdpcmMode
(
	`Comp⁄ítID
(comp)Ë+ 
uiP¨t
;

739 
m_puhDïth
=
pcCU
->
	`gëDïth
(Ë+ 
uiP¨t
;

740 
m_puhWidth
=
pcCU
->
	`gëWidth
(Ë+ 
uiP¨t
;

741 
m_puhHeight
=
pcCU
->
	`gëHeight
(Ë+ 
uiP¨t
;

743 
m_pbIPCMFœg
 = 
pcCU
->
	`gëIPCMFœg
(Ë+ 
uiP¨t
;

745 
m_pCtuAboveLe·
 = 
pcCU
->
	`gëCtuAboveLe·
();

746 
m_pCtuAboveRight
 = 
pcCU
->
	`gëCtuAboveRight
();

747 
m_pCtuAbove
 = 
pcCU
->
	`gëCtuAbove
();

748 
m_pCtuLe·
 = 
pcCU
->
	`gëCtuLe·
();

750 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

752 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

753 
m_≠iMVPIdx
[
Ωl
]=
pcCU
->
	`gëMVPIdx
‘∂Ë+ 
uiP¨t
;

754 
m_≠iMVPNum
[
Ωl
]=
pcCU
->
	`gëMVPNum
‘∂Ë+ 
uiP¨t
;

757 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

759 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

760 
m_acCUMvFõld
[
Ωl
].
	`lökToWôhOff£t
–
pcCU
->
	`gëCUMvFõld
‘∂), 
uiP¨t
 );

763 
UI¡
 
uiMaxCuWidth
=
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
();

764 
UI¡
 
uiMaxCuHeight
=
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUHeight
();

766 
UI¡
 
uiCoffOff£t
 = 
uiMaxCuWidth
*
uiMaxCuHeight
*
uiAbsP¨tIdx
/
pcCU
->
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
();

768 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

770 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
ch
);

771 c⁄° 
UI¡
 
comp⁄ítShi·
 = 
m_pcPic
->
	`gëComp⁄ítSˇÀX
(
comp⁄ít
Ë+ m_pcPic->
	`gëComp⁄ítSˇÀY
(component);

772 c⁄° 
UI¡
 
off£t
 = 
uiCoffOff£t
 >> 
comp⁄ítShi·
;

773 
m_pcTrC€ff
[
ch
] = 
pcCU
->
	`gëC€ff
(
comp⁄ít
Ë+ 
off£t
;

774 #i‡
ADAPTIVE_QP_SELECTION


775 
m_pcAæC€ff
[
ch
] = 
pcCU
->
	`gëAæC€ff
(
comp⁄ít
Ë+ 
off£t
;

777 
m_pcIPCMSam∂e
[
ch
] = 
pcCU
->
	`gëPCMSam∂e
(
comp⁄ít
Ë+ 
off£t
;

779 
	}
}

782 
Void
 
	gTComD©aCU
::
	$c›yI¡îPªdInfoFrom
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefPicLi°
 )

784 
m_pcPic
 = 
pcCU
->
	`gëPic
();

785 
m_pcSli˚
 = 
pcCU
->
	`gëSli˚
();

786 
m_˘uRsAddr
 = 
pcCU
->
	`gëCtuRsAddr
();

787 
m_absZIdxInCtu
 = 
uiAbsP¨tIdx
;

789 
I¡
 
iRa°P¨tIdx
 = 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
];

790 
m_uiCUPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
m_pcPic
->
	`gëMöCUWidth
 ()*–
iRa°P¨tIdx
 % m_pcPic->
	`gëNumP¨tInCtuWidth
() );

791 
m_uiCUPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
m_pcPic
->
	`gëMöCUHeight
()*–
iRa°P¨tIdx
 / m_pcPic->
	`gëNumP¨tInCtuWidth
() );

793 
m_pCtuAboveLe·
 = 
pcCU
->
	`gëCtuAboveLe·
();

794 
m_pCtuAboveRight
 = 
pcCU
->
	`gëCtuAboveRight
();

795 
m_pCtuAbove
 = 
pcCU
->
	`gëCtuAbove
();

796 
m_pCtuLe·
 = 
pcCU
->
	`gëCtuLe·
();

798 
m_skùFœg
 = 
pcCU
->
	`gëSkùFœg
 (Ë+ 
uiAbsP¨tIdx
;

800 
m_≥P¨tSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
 (Ë+ 
uiAbsP¨tIdx
;

801 
m_≥PªdMode
 = 
pcCU
->
	`gëPªdi˘i⁄Mode
(Ë+ 
uiAbsP¨tIdx
;

802 
m_ChromaQpAdj
 = 
pcCU
->
	`gëChromaQpAdj
(Ë+ 
uiAbsP¨tIdx
;

803 
m_CUTønsqu™tBy∑ss
 = 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(Ë+ 
uiAbsP¨tIdx
;

804 
m_puhI¡îDú
 = 
pcCU
->
	`gëI¡îDú
 (Ë+ 
uiAbsP¨tIdx
;

806 
m_puhDïth
 = 
pcCU
->
	`gëDïth
 (Ë+ 
uiAbsP¨tIdx
;

807 
m_puhWidth
 = 
pcCU
->
	`gëWidth
 (Ë+ 
uiAbsP¨tIdx
;

808 
m_puhHeight
 = 
pcCU
->
	`gëHeight
(Ë+ 
uiAbsP¨tIdx
;

810 
m_pbMîgeFœg
 = 
pcCU
->
	`gëMîgeFœg
(Ë+ 
uiAbsP¨tIdx
;

811 
m_puhMîgeIndex
 = 
pcCU
->
	`gëMîgeIndex
(Ë+ 
uiAbsP¨tIdx
;

813 
m_≠iMVPIdx
[
eRefPicLi°
] = 
pcCU
->
	`gëMVPIdx
”RefPicLi°Ë+ 
uiAbsP¨tIdx
;

814 
m_≠iMVPNum
[
eRefPicLi°
] = 
pcCU
->
	`gëMVPNum
”RefPicLi°Ë+ 
uiAbsP¨tIdx
;

816 
m_acCUMvFõld
[ 
eRefPicLi°
 ].
	`lökToWôhOff£t
–
pcCU
->
	`gëCUMvFõld
”RefPicLi°), 
uiAbsP¨tIdx
 );

817 
	}
}

821 
Void
 
	gTComD©aCU
::
	$c›yP¨tFrom
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tUnôIdx
, UI¡ 
uiDïth
 )

823 
	`as£π
–
uiP¨tUnôIdx
<4 );

825 
m_dTŸÆCo°
 +
pcCU
->
	`gëTŸÆCo°
();

826 
m_uiTŸÆDi°‹ti⁄
 +
pcCU
->
	`gëTŸÆDi°‹ti⁄
();

827 
m_uiTŸÆBôs
 +
pcCU
->
	`gëTŸÆBôs
();

829 
UI¡
 
uiOff£t
 = 
pcCU
->
	`gëTŸÆNumP¨t
()*
uiP¨tUnôIdx
;

830 c⁄° 
UI¡
 
numVÆidComp
=
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

831 c⁄° 
UI¡
 
numVÆidCh™
=
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
()==
CHROMA_400
 ? 1:2;

833 
UI¡
 
uiNumP¨tôi⁄
 = 
pcCU
->
	`gëTŸÆNumP¨t
();

834 
I¡
 
iSizeInUch¨
 = –
UCh¨
 ) * 
uiNumP¨tôi⁄
;

835 
I¡
 
iSizeInBoﬁ
 = –
Boﬁ
 ) * 
uiNumP¨tôi⁄
;

837 
I¡
 
sizeInCh¨
 = –
SCh¨
 ) * 
uiNumP¨tôi⁄
;

838 
	`mem˝y
–
m_skùFœg
 + 
uiOff£t
, 
pcCU
->
	`gëSkùFœg
(), –*m_skùFœg ) * 
uiNumP¨tôi⁄
 );

839 
	`mem˝y
–
m_phQP
 + 
uiOff£t
, 
pcCU
->
	`gëQP
(), 
sizeInCh¨
 );

840 
	`mem˝y
–
m_≥P¨tSize
 + 
uiOff£t
, 
pcCU
->
	`gëP¨tôi⁄Size
(), –*m_≥P¨tSizêË* 
uiNumP¨tôi⁄
 );

841 
	`mem˝y
–
m_≥PªdMode
 + 
uiOff£t
, 
pcCU
->
	`gëPªdi˘i⁄Mode
(), –*m_≥PªdModêË* 
uiNumP¨tôi⁄
 );

842 
	`mem˝y
–
m_ChromaQpAdj
 + 
uiOff£t
, 
pcCU
->
	`gëChromaQpAdj
(), –*m_ChromaQpAdj ) * 
uiNumP¨tôi⁄
 );

843 
	`mem˝y
–
m_CUTønsqu™tBy∑ss
 + 
uiOff£t
, 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(), –*m_CUTønsqu™tBy∑s†Ë* 
uiNumP¨tôi⁄
 );

844 
	`mem˝y
–
m_pbMîgeFœg
 + 
uiOff£t
, 
pcCU
->
	`gëMîgeFœg
(), 
iSizeInBoﬁ
 );

845 
	`mem˝y
–
m_puhMîgeIndex
 + 
uiOff£t
, 
pcCU
->
	`gëMîgeIndex
(), 
iSizeInUch¨
 );

847 
UI¡
 
ch
=0; ch<
numVÆidCh™
; ch++)

849 
	`mem˝y
–
m_puhI¡øDú
[
ch
] + 
uiOff£t
, 
pcCU
->
	`gëI¡øDú
(
	`Ch™√lTy≥
(ch)), 
iSizeInUch¨
 );

852 
	`mem˝y
–
m_puhI¡îDú
 + 
uiOff£t
, 
pcCU
->
	`gëI¡îDú
(), 
iSizeInUch¨
 );

853 
	`mem˝y
–
m_puhTrIdx
 + 
uiOff£t
, 
pcCU
->
	`gëTønsf‹mIdx
(), 
iSizeInUch¨
 );

855 
UI¡
 
comp
=0; comp<
numVÆidComp
; comp++)

857 
	`mem˝y
–
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
comp
] + 
uiOff£t
, 
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
	`Comp⁄ítID
(comp)), 
iSizeInUch¨
 );

858 
	`mem˝y
–
m_puhTønsf‹mSkù
[
comp
] + 
uiOff£t
, 
pcCU
->
	`gëTønsf‹mSkù
(
	`Comp⁄ítID
(comp)Ë, 
iSizeInUch¨
 );

859 
	`mem˝y
–
m_puhCbf
[
comp
] + 
uiOff£t
, 
pcCU
->
	`gëCbf
(
	`Comp⁄ítID
(comp)Ë, 
iSizeInUch¨
 );

860 
	`mem˝y
–
m_ex∂icôRdpcmMode
[
comp
] + 
uiOff£t
, 
pcCU
->
	`gëEx∂icôRdpcmMode
(
	`Comp⁄ítID
(comp)Ë, 
iSizeInUch¨
 );

863 
	`mem˝y
–
m_puhDïth
 + 
uiOff£t
, 
pcCU
->
	`gëDïth
(), 
iSizeInUch¨
 );

864 
	`mem˝y
–
m_puhWidth
 + 
uiOff£t
, 
pcCU
->
	`gëWidth
(), 
iSizeInUch¨
 );

865 
	`mem˝y
–
m_puhHeight
 + 
uiOff£t
, 
pcCU
->
	`gëHeight
(), 
iSizeInUch¨
 );

867 
	`mem˝y
–
m_pbIPCMFœg
 + 
uiOff£t
, 
pcCU
->
	`gëIPCMFœg
(), 
iSizeInBoﬁ
 );

869 
m_pCtuAboveLe·
 = 
pcCU
->
	`gëCtuAboveLe·
();

870 
m_pCtuAboveRight
 = 
pcCU
->
	`gëCtuAboveRight
();

871 
m_pCtuAbove
 = 
pcCU
->
	`gëCtuAbove
();

872 
m_pCtuLe·
 = 
pcCU
->
	`gëCtuLe·
();

874 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

876 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

877 
	`mem˝y
–
m_≠iMVPIdx
[
Ωl
] + 
uiOff£t
, 
pcCU
->
	`gëMVPIdx
‘∂), 
iSizeInUch¨
 );

878 
	`mem˝y
–
m_≠iMVPNum
[
Ωl
] + 
uiOff£t
, 
pcCU
->
	`gëMVPNum
‘∂), 
iSizeInUch¨
 );

881 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

883 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

884 
m_acCUMvFõld
[
Ωl
].
	`c›yFrom
–
pcCU
->
	`gëCUMvFõld
–Ω»),ÖcCU->
	`gëTŸÆNumP¨t
(), 
uiOff£t
 );

887 c⁄° 
UI¡
 
numC€ffY
 = (
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()*pcCU->gëSli˚()->gëSPS()->
	`gëMaxCUHeight
()Ë>> (
uiDïth
<<1);

888 c⁄° 
UI¡
 
off£tY
 = 
uiP¨tUnôIdx
*
numC€ffY
;

889 
UI¡
 
ch
=0; ch<
numVÆidComp
; ch++)

891 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
ch
);

892 c⁄° 
UI¡
 
comp⁄ítShi·
 = 
m_pcPic
->
	`gëComp⁄ítSˇÀX
(
comp⁄ít
Ë+ m_pcPic->
	`gëComp⁄ítSˇÀY
(component);

893 c⁄° 
UI¡
 
off£t
 = 
off£tY
>>
comp⁄ítShi·
;

894 
	`mem˝y
–
m_pcTrC€ff
 [
ch
] + 
off£t
, 
pcCU
->
	`gëC€ff
(
comp⁄ít
), (
TC€ff
)*(
numC€ffY
>>
comp⁄ítShi·
) );

895 #i‡
ADAPTIVE_QP_SELECTION


896 
	`mem˝y
–
m_pcAæC€ff
[
ch
] + 
off£t
, 
pcCU
->
	`gëAæC€ff
(
comp⁄ít
), (
TC€ff
)*(
numC€ffY
>>
comp⁄ítShi·
) );

898 
	`mem˝y
–
m_pcIPCMSam∂e
[
ch
] + 
off£t
, 
pcCU
->
	`gëPCMSam∂e
(
comp⁄ít
), (
Pñ
)*(
numC€ffY
>>
comp⁄ítShi·
) );

901 
m_uiTŸÆBös
 +
pcCU
->
	`gëTŸÆBös
();

902 
	}
}

906 
Void
 
	gTComD©aCU
::
	$c›yToPic
–
UCh¨
 
uhDïth
 )

908 
TComD©aCU
* 
pCtu
 = 
m_pcPic
->
	`gëCtu
–
m_˘uRsAddr
 );

909 c⁄° 
UI¡
 
numVÆidComp
=
pCtu
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

910 c⁄° 
UI¡
 
numVÆidCh™
=
pCtu
->
	`gëPic
()->
	`gëChromaF‹m©
()==
CHROMA_400
 ? 1:2;

912 
pCtu
->
	`gëTŸÆCo°
(Ë
m_dTŸÆCo°
;

913 
pCtu
->
	`gëTŸÆDi°‹ti⁄
(Ë
m_uiTŸÆDi°‹ti⁄
;

914 
pCtu
->
	`gëTŸÆBôs
(Ë
m_uiTŸÆBôs
;

916 
I¡
 
iSizeInUch¨
 = –
UCh¨
 ) * 
m_uiNumP¨tôi⁄
;

917 
I¡
 
iSizeInBoﬁ
 = –
Boﬁ
 ) * 
m_uiNumP¨tôi⁄
;

918 
I¡
 
sizeInCh¨
 = –
SCh¨
 ) * 
m_uiNumP¨tôi⁄
;

920 
	`mem˝y
–
pCtu
->
	`gëSkùFœg
(Ë+ 
m_absZIdxInCtu
, 
m_skùFœg
, –*m_skùFœg ) * 
m_uiNumP¨tôi⁄
 );

922 
	`mem˝y
–
pCtu
->
	`gëQP
(Ë+ 
m_absZIdxInCtu
, 
m_phQP
, 
sizeInCh¨
 );

924 
	`mem˝y
–
pCtu
->
	`gëP¨tôi⁄Size
(Ë+ 
m_absZIdxInCtu
, 
m_≥P¨tSize
, –*m_≥P¨tSizêË* 
m_uiNumP¨tôi⁄
 );

925 
	`mem˝y
–
pCtu
->
	`gëPªdi˘i⁄Mode
(Ë+ 
m_absZIdxInCtu
, 
m_≥PªdMode
, –*m_≥PªdModêË* 
m_uiNumP¨tôi⁄
 );

926 
	`mem˝y
–
pCtu
->
	`gëChromaQpAdj
(Ë+ 
m_absZIdxInCtu
, 
m_ChromaQpAdj
, –*m_ChromaQpAdj ) * 
m_uiNumP¨tôi⁄
 );

927 
	`mem˝y
–
pCtu
->
	`gëCUTønsqu™tBy∑ss
()+ 
m_absZIdxInCtu
, 
m_CUTønsqu™tBy∑ss
, –*m_CUTønsqu™tBy∑s†Ë* 
m_uiNumP¨tôi⁄
 );

928 
	`mem˝y
–
pCtu
->
	`gëMîgeFœg
(Ë+ 
m_absZIdxInCtu
, 
m_pbMîgeFœg
, 
iSizeInBoﬁ
 );

929 
	`mem˝y
–
pCtu
->
	`gëMîgeIndex
(Ë+ 
m_absZIdxInCtu
, 
m_puhMîgeIndex
, 
iSizeInUch¨
 );

930 
UI¡
 
ch
=0; ch<
numVÆidCh™
; ch++)

932 
	`mem˝y
–
pCtu
->
	`gëI¡øDú
(
	`Ch™√lTy≥
(
ch
)Ë+ 
m_absZIdxInCtu
, 
m_puhI¡øDú
[ch], 
iSizeInUch¨
);

935 
	`mem˝y
–
pCtu
->
	`gëI¡îDú
(Ë+ 
m_absZIdxInCtu
, 
m_puhI¡îDú
, 
iSizeInUch¨
 );

936 
	`mem˝y
–
pCtu
->
	`gëTønsf‹mIdx
(Ë+ 
m_absZIdxInCtu
, 
m_puhTrIdx
, 
iSizeInUch¨
 );

938 
UI¡
 
comp
=0; comp<
numVÆidComp
; comp++)

940 
	`mem˝y
–
pCtu
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
	`Comp⁄ítID
(
comp
)Ë+ 
m_absZIdxInCtu
, 
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[comp], 
iSizeInUch¨
 );

941 
	`mem˝y
–
pCtu
->
	`gëTønsf‹mSkù
(
	`Comp⁄ítID
(
comp
)Ë+ 
m_absZIdxInCtu
, 
m_puhTønsf‹mSkù
[comp], 
iSizeInUch¨
 );

942 
	`mem˝y
–
pCtu
->
	`gëCbf
(
	`Comp⁄ítID
(
comp
)Ë+ 
m_absZIdxInCtu
, 
m_puhCbf
[comp], 
iSizeInUch¨
 );

943 
	`mem˝y
–
pCtu
->
	`gëEx∂icôRdpcmMode
(
	`Comp⁄ítID
(
comp
)Ë+ 
m_absZIdxInCtu
, 
m_ex∂icôRdpcmMode
[comp], 
iSizeInUch¨
 );

946 
	`mem˝y
–
pCtu
->
	`gëDïth
(Ë+ 
m_absZIdxInCtu
, 
m_puhDïth
, 
iSizeInUch¨
 );

947 
	`mem˝y
–
pCtu
->
	`gëWidth
(Ë+ 
m_absZIdxInCtu
, 
m_puhWidth
, 
iSizeInUch¨
 );

948 
	`mem˝y
–
pCtu
->
	`gëHeight
(Ë+ 
m_absZIdxInCtu
, 
m_puhHeight
, 
iSizeInUch¨
 );

950 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

952 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

953 
	`mem˝y
–
pCtu
->
	`gëMVPIdx
(
Ωl
Ë+ 
m_absZIdxInCtu
, 
m_≠iMVPIdx
[Ωl], 
iSizeInUch¨
 );

954 
	`mem˝y
–
pCtu
->
	`gëMVPNum
(
Ωl
Ë+ 
m_absZIdxInCtu
, 
m_≠iMVPNum
[Ωl], 
iSizeInUch¨
 );

957 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

959 c⁄° 
RefPicLi°
 
Ωl
=
	`RefPicLi°
(
i
);

960 
m_acCUMvFõld
[
Ωl
].
	`c›yTo
–
pCtu
->
	`gëCUMvFõld
–Ω»), 
m_absZIdxInCtu
 );

963 
	`mem˝y
–
pCtu
->
	`gëIPCMFœg
(Ë+ 
m_absZIdxInCtu
, 
m_pbIPCMFœg
, 
iSizeInBoﬁ
 );

965 c⁄° 
UI¡
 
numC€ffY
 = (
pCtu
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()*pCtu->gëSli˚()->gëSPS()->
	`gëMaxCUHeight
())>>(
uhDïth
<<1);

966 c⁄° 
UI¡
 
off£tY
 = 
m_absZIdxInCtu
*
m_pcPic
->
	`gëMöCUWidth
()*m_pcPic->
	`gëMöCUHeight
();

967 
UI¡
 
comp
=0; comp<
numVÆidComp
; comp++)

969 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp
);

970 c⁄° 
UI¡
 
comp⁄ítShi·
 = 
m_pcPic
->
	`gëComp⁄ítSˇÀX
(
comp⁄ít
Ë+ m_pcPic->
	`gëComp⁄ítSˇÀY
(component);

971 
	`mem˝y
–
pCtu
->
	`gëC€ff
(
comp⁄ít
Ë+ (
off£tY
>>
comp⁄ítShi·
), 
m_pcTrC€ff
[comp⁄ít], (
TC€ff
)*(
numC€ffY
>>componentShift) );

972 #i‡
ADAPTIVE_QP_SELECTION


973 
	`mem˝y
–
pCtu
->
	`gëAæC€ff
(
comp⁄ít
Ë+ (
off£tY
>>
comp⁄ítShi·
), 
m_pcAæC€ff
[comp⁄ít], (
TC€ff
)*(
numC€ffY
>>componentShift) );

975 
	`mem˝y
–
pCtu
->
	`gëPCMSam∂e
(
comp⁄ít
Ë+ (
off£tY
>>
comp⁄ítShi·
), 
m_pcIPCMSam∂e
[comp⁄ít], (
Pñ
)*(
numC€ffY
>>componentShift) );

978 
pCtu
->
	`gëTŸÆBös
(Ë
m_uiTŸÆBös
;

979 
	}
}

985 c⁄° 
TComD©aCU
* 
	gTComD©aCU
::
	$gëPULe·
–
UI¡
& 
uiLP¨tUnôIdx
,

986 
UI¡
 
uiCuºP¨tUnôIdx
,

987 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
,

988 
Boﬁ
 
bEnf‹˚TûeRe°ri˘i⁄
 ) const

990 
UI¡
 
uiAbsP¨tIdx
 = 
g_auiZsˇnToRa°î
[
uiCuºP¨tUnôIdx
];

991 
UI¡
 
uiAbsZ‹dîCUIdx
 = 
g_auiZsˇnToRa°î
[
m_absZIdxInCtu
];

992 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

994 i‡–!
Ra°îAddªss
::
	`isZîoCﬁ
–
uiAbsP¨tIdx
, 
numP¨tInCtuWidth
 ) )

996 
uiLP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdx
 - 1 ];

997 i‡–
Ra°îAddªss
::
	`isEquÆCﬁ
–
uiAbsP¨tIdx
, 
uiAbsZ‹dîCUIdx
, 
numP¨tInCtuWidth
 ) )

999  
m_pcPic
->
	`gëCtu
–
	`gëCtuRsAddr
() );

1003 
uiLP¨tUnôIdx
 -
m_absZIdxInCtu
;

1004  
this
;

1008 
uiLP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdx
 + 
numP¨tInCtuWidth
 - 1 ];

1009 i‡–(
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚
(
m_pCtuLe·
)Ë|| (
bEnf‹˚TûeRe°ri˘i⁄
 && !
	`CUIsFromSameTûe
(m_pCtuLeft)) )

1011  
NULL
;

1013  
m_pCtuLe·
;

1014 
	}
}

1017 c⁄° 
TComD©aCU
* 
	gTComD©aCU
::
	$gëPUAbove
–
UI¡
& 
uiAP¨tUnôIdx
,

1018 
UI¡
 
uiCuºP¨tUnôIdx
,

1019 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
,

1020 
Boﬁ
 
∂™¨AtCtuBound¨y
,

1021 
Boﬁ
 
bEnf‹˚TûeRe°ri˘i⁄
 ) const

1023 
UI¡
 
uiAbsP¨tIdx
 = 
g_auiZsˇnToRa°î
[
uiCuºP¨tUnôIdx
];

1024 
UI¡
 
uiAbsZ‹dîCUIdx
 = 
g_auiZsˇnToRa°î
[
m_absZIdxInCtu
];

1025 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

1027 i‡–!
Ra°îAddªss
::
	`isZîoRow
–
uiAbsP¨tIdx
, 
numP¨tInCtuWidth
 ) )

1029 
uiAP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdx
 - 
numP¨tInCtuWidth
 ];

1030 i‡–
Ra°îAddªss
::
	`isEquÆRow
–
uiAbsP¨tIdx
, 
uiAbsZ‹dîCUIdx
, 
numP¨tInCtuWidth
 ) )

1032  
m_pcPic
->
	`gëCtu
–
	`gëCtuRsAddr
() );

1036 
uiAP¨tUnôIdx
 -
m_absZIdxInCtu
;

1037  
this
;

1041 if(
∂™¨AtCtuBound¨y
)

1043  
NULL
;

1046 
uiAP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdx
 + 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë- 
numP¨tInCtuWidth
 ];

1048 i‡–(
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚
(
m_pCtuAbove
)Ë|| (
bEnf‹˚TûeRe°ri˘i⁄
 && !
	`CUIsFromSameTûe
(m_pCtuAbove)) )

1050  
NULL
;

1052  
m_pCtuAbove
;

1053 
	}
}

1055 c⁄° 
TComD©aCU
* 
	gTComD©aCU
::
	$gëPUAboveLe·
–
UI¡
& 
uiALP¨tUnôIdx
, UI¡ 
uiCuºP¨tUnôIdx
, 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
 ) const

1057 
UI¡
 
uiAbsP¨tIdx
 = 
g_auiZsˇnToRa°î
[
uiCuºP¨tUnôIdx
];

1058 
UI¡
 
uiAbsZ‹dîCUIdx
 = 
g_auiZsˇnToRa°î
[
m_absZIdxInCtu
];

1059 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

1061 i‡–!
Ra°îAddªss
::
	`isZîoCﬁ
–
uiAbsP¨tIdx
, 
numP¨tInCtuWidth
 ) )

1063 i‡–!
Ra°îAddªss
::
	`isZîoRow
–
uiAbsP¨tIdx
, 
numP¨tInCtuWidth
 ) )

1065 
uiALP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdx
 - 
numP¨tInCtuWidth
 - 1 ];

1066 i‡–
Ra°îAddªss
::
	`isEquÆRowOrCﬁ
–
uiAbsP¨tIdx
, 
uiAbsZ‹dîCUIdx
, 
numP¨tInCtuWidth
 ) )

1068  
m_pcPic
->
	`gëCtu
–
	`gëCtuRsAddr
() );

1072 
uiALP¨tUnôIdx
 -
m_absZIdxInCtu
;

1073  
this
;

1076 
uiALP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdx
 + 
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
(Ë- 
numP¨tInCtuWidth
 - 1 ];

1077 i‡–
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚AndTûe
(
m_pCtuAbove
) )

1079  
NULL
;

1081  
m_pCtuAbove
;

1084 i‡–!
Ra°îAddªss
::
	`isZîoRow
–
uiAbsP¨tIdx
, 
numP¨tInCtuWidth
 ) )

1086 
uiALP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdx
 - 1 ];

1087 i‡–
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚AndTûe
(
m_pCtuLe·
) )

1089  
NULL
;

1091  
m_pCtuLe·
;

1094 
uiALP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
() - 1 ];

1095 i‡–
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚AndTûe
(
m_pCtuAboveLe·
) )

1097  
NULL
;

1099  
m_pCtuAboveLe·
;

1100 
	}
}

1102 c⁄° 
TComD©aCU
* 
	gTComD©aCU
::
	$gëPUBñowLe·
(
UI¡
& 
uiBLP¨tUnôIdx
, UI¡ 
uiCuºP¨tUnôIdx
, UI¡ 
uiP¨tUnôOff£t
, 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
) const

1104 
UI¡
 
uiAbsP¨tIdxLB
 = 
g_auiZsˇnToRa°î
[
uiCuºP¨tUnôIdx
];

1105 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

1106 
UI¡
 
uiAbsZ‹dîCUIdxLB
 = 
g_auiZsˇnToRa°î
[ 
m_absZIdxInCtu
 ] + ((
m_puhHeight
[0] / 
m_pcPic
->
	`gëMöCUHeight
()Ë- 1)*
numP¨tInCtuWidth
;

1108 if––
m_pcPic
->
	`gëCtu
(
m_˘uRsAddr
)->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[
uiAbsP¨tIdxLB
] + (m_pcPic->
	`gëPicSym
()->
	`gëMöCUHeight
(Ë* 
uiP¨tUnôOff£t
)Ë>
m_pcSli˚
->
	`gëSPS
()->
	`gëPicHeightInLumaSam∂es
())

1110 
uiBLP¨tUnôIdx
 = 
MAX_UINT
;

1111  
NULL
;

1114 i‡–
Ra°îAddªss
::
	`ÀssTh™Row
–
uiAbsP¨tIdxLB
, 
m_pcPic
->
	`gëNumP¨tInCtuHeight
(Ë- 
uiP¨tUnôOff£t
, 
numP¨tInCtuWidth
 ) )

1116 i‡–!
Ra°îAddªss
::
	`isZîoCﬁ
–
uiAbsP¨tIdxLB
, 
numP¨tInCtuWidth
 ) )

1118 i‡–
uiCuºP¨tUnôIdx
 > 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxLB
 + 
uiP¨tUnôOff£t
 * 
numP¨tInCtuWidth
 - 1 ] )

1120 
uiBLP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxLB
 + 
uiP¨tUnôOff£t
 * 
numP¨tInCtuWidth
 - 1 ];

1121 i‡–
Ra°îAddªss
::
	`isEquÆRowOrCﬁ
–
uiAbsP¨tIdxLB
, 
uiAbsZ‹dîCUIdxLB
, 
numP¨tInCtuWidth
 ) )

1123  
m_pcPic
->
	`gëCtu
–
	`gëCtuRsAddr
() );

1127 
uiBLP¨tUnôIdx
 -
m_absZIdxInCtu
;

1128  
this
;

1131 
uiBLP¨tUnôIdx
 = 
MAX_UINT
;

1132  
NULL
;

1134 
uiBLP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxLB
 + (1+
uiP¨tUnôOff£t
Ë* 
numP¨tInCtuWidth
 - 1 ];

1135 i‡–
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚AndTûe
(
m_pCtuLe·
) )

1137  
NULL
;

1139  
m_pCtuLe·
;

1142 
uiBLP¨tUnôIdx
 = 
MAX_UINT
;

1143  
NULL
;

1144 
	}
}

1146 c⁄° 
TComD©aCU
* 
	gTComD©aCU
::
	$gëPUAboveRight
(
UI¡
& 
uiARP¨tUnôIdx
, UI¡ 
uiCuºP¨tUnôIdx
, UI¡ 
uiP¨tUnôOff£t
, 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
) const

1148 
UI¡
 
uiAbsP¨tIdxRT
 = 
g_auiZsˇnToRa°î
[
uiCuºP¨tUnôIdx
];

1149 
UI¡
 
uiAbsZ‹dîCUIdx
 = 
g_auiZsˇnToRa°î
[ 
m_absZIdxInCtu
 ] + (
m_puhWidth
[0] / 
m_pcPic
->
	`gëMöCUWidth
()) - 1;

1150 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

1152 if––
m_pcPic
->
	`gëCtu
(
m_˘uRsAddr
)->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[
uiAbsP¨tIdxRT
] + (m_pcPic->
	`gëPicSym
()->
	`gëMöCUHeight
(Ë* 
uiP¨tUnôOff£t
)Ë>
m_pcSli˚
->
	`gëSPS
()->
	`gëPicWidthInLumaSam∂es
() )

1154 
uiARP¨tUnôIdx
 = 
MAX_UINT
;

1155  
NULL
;

1158 i‡–
Ra°îAddªss
::
	`ÀssTh™Cﬁ
–
uiAbsP¨tIdxRT
, 
numP¨tInCtuWidth
 - 
uiP¨tUnôOff£t
,ÇumPartInCtuWidth ) )

1160 i‡–!
Ra°îAddªss
::
	`isZîoRow
–
uiAbsP¨tIdxRT
, 
numP¨tInCtuWidth
 ) )

1162 i‡–
uiCuºP¨tUnôIdx
 > 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxRT
 - 
numP¨tInCtuWidth
 + 
uiP¨tUnôOff£t
 ] )

1164 
uiARP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxRT
 - 
numP¨tInCtuWidth
 + 
uiP¨tUnôOff£t
 ];

1165 i‡–
Ra°îAddªss
::
	`isEquÆRowOrCﬁ
–
uiAbsP¨tIdxRT
, 
uiAbsZ‹dîCUIdx
, 
numP¨tInCtuWidth
 ) )

1167  
m_pcPic
->
	`gëCtu
–
	`gëCtuRsAddr
() );

1171 
uiARP¨tUnôIdx
 -
m_absZIdxInCtu
;

1172  
this
;

1175 
uiARP¨tUnôIdx
 = 
MAX_UINT
;

1176  
NULL
;

1179 
uiARP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxRT
 + 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë- 
numP¨tInCtuWidth
 + 
uiP¨tUnôOff£t
 ];

1180 i‡–
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚AndTûe
(
m_pCtuAbove
) )

1182  
NULL
;

1184  
m_pCtuAbove
;

1187 i‡–!
Ra°îAddªss
::
	`isZîoRow
–
uiAbsP¨tIdxRT
, 
numP¨tInCtuWidth
 ) )

1189 
uiARP¨tUnôIdx
 = 
MAX_UINT
;

1190  
NULL
;

1193 
uiARP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[ 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë- 
numP¨tInCtuWidth
 + 
uiP¨tUnôOff£t
-1 ];

1194 i‡–
bEnf‹˚Sli˚Re°ri˘i⁄
 && !
	`CUIsFromSameSli˚AndTûe
(
m_pCtuAboveRight
) )

1196  
NULL
;

1198  
m_pCtuAboveRight
;

1199 
	}
}

1206 c⁄° 
TComD©aCU
* 
	gTComD©aCU
::
	$gëQpMöCuLe·
–
UI¡
& 
uiLP¨tUnôIdx
, UI¡ 
uiCuºAbsIdxInCtu
 ) const

1208 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

1209 c⁄° 
UI¡
 
maxCUDïth
 = 
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxTŸÆCUDïth
();

1210 c⁄° 
UI¡
 
maxCuDQPDïth
 = 
	`gëSli˚
()->
	`gëPPS
()->
	`gëMaxCuDQPDïth
();

1211 c⁄° 
UI¡
 
doubÀDïthDif„ªn˚
 = ((
maxCUDïth
 - 
maxCuDQPDïth
)<<1);

1212 
UI¡
 
absZ‹dîQpMöCUIdx
 = (
uiCuºAbsIdxInCtu
>>
doubÀDïthDif„ªn˚
)<<doubleDepthDifference;

1213 
UI¡
 
absR‹dîQpMöCUIdx
 = 
g_auiZsˇnToRa°î
[
absZ‹dîQpMöCUIdx
];

1216 i‡–
Ra°îAddªss
::
	`isZîoCﬁ
(
absR‹dîQpMöCUIdx
, 
numP¨tInCtuWidth
) )

1218  
NULL
;

1222 
uiLP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[
absR‹dîQpMöCUIdx
 - 1];

1225  
m_pcPic
->
	`gëCtu
–
	`gëCtuRsAddr
() );

1226 
	}
}

1233 c⁄° 
TComD©aCU
* 
	gTComD©aCU
::
	$gëQpMöCuAbove
–
UI¡
& 
uiAP¨tUnôIdx
, UI¡ 
uiCuºAbsIdxInCtu
 ) const

1235 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

1236 c⁄° 
UI¡
 
maxCUDïth
 = 
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxTŸÆCUDïth
();

1237 c⁄° 
UI¡
 
maxCuDQPDïth
 = 
	`gëSli˚
()->
	`gëPPS
()->
	`gëMaxCuDQPDïth
();

1238 c⁄° 
UI¡
 
doubÀDïthDif„ªn˚
 = ((
maxCUDïth
 - 
maxCuDQPDïth
)<<1);

1239 
UI¡
 
absZ‹dîQpMöCUIdx
 = (
uiCuºAbsIdxInCtu
>>
doubÀDïthDif„ªn˚
)<<doubleDepthDifference;

1240 
UI¡
 
absR‹dîQpMöCUIdx
 = 
g_auiZsˇnToRa°î
[
absZ‹dîQpMöCUIdx
];

1243 i‡–
Ra°îAddªss
::
	`isZîoRow
–
absR‹dîQpMöCUIdx
, 
numP¨tInCtuWidth
) )

1245  
NULL
;

1249 
uiAP¨tUnôIdx
 = 
g_auiRa°îToZsˇn
[
absR‹dîQpMöCUIdx
 - 
numP¨tInCtuWidth
];

1252  
m_pcPic
->
	`gëCtu
–
	`gëCtuRsAddr
() );

1253 
	}
}

1261 
SCh¨
 
	gTComD©aCU
::
	$gëRefQP
–
UI¡
 
uiCuºAbsIdxInCtu
 ) const

1263 
UI¡
 
lP¨tIdx
 = 
MAX_UINT
;

1264 
UI¡
 
aP¨tIdx
 = 
MAX_UINT
;

1265 c⁄° 
TComD©aCU
* 
cULe·
 = 
	`gëQpMöCuLe·
 ( 
lP¨tIdx
, 
m_absZIdxInCtu
 + 
uiCuºAbsIdxInCtu
 );

1266 c⁄° 
TComD©aCU
* 
cUAbove
 = 
	`gëQpMöCuAbove
–
aP¨tIdx
, 
m_absZIdxInCtu
 + 
uiCuºAbsIdxInCtu
 );

1267  (((
cULe·
? cULe·->
	`gëQP
–
lP¨tIdx
 ): 
	`gëLa°CodedQP
–
uiCuºAbsIdxInCtu
 )Ë+ (
cUAbove
? cUAbove->gëQP–
aP¨tIdx
 ): getLastCodedQP( uiCurrAbsIdxInCtu )) + 1) >> 1);

1268 
	}
}

1270 
I¡
 
	gTComD©aCU
::
	$gëLa°VÆidP¨tIdx
–
I¡
 
iAbsP¨tIdx
 ) const

1272 
I¡
 
iLa°VÆidP¨tIdx
 = 
iAbsP¨tIdx
-1;

1273  
iLa°VÆidP¨tIdx
 >= 0

1274 && 
	`gëPªdi˘i⁄Mode
–
iLa°VÆidP¨tIdx
 ) =
NUMBER_OF_PREDICTION_MODES
 )

1276 
UI¡
 
uiDïth
 = 
	`gëDïth
–
iLa°VÆidP¨tIdx
 );

1277 
iLa°VÆidP¨tIdx
 -
m_uiNumP¨tôi⁄
>>(
uiDïth
<<1);

1279  
iLa°VÆidP¨tIdx
;

1280 
	}
}

1282 
SCh¨
 
	gTComD©aCU
::
	$gëLa°CodedQP
–
UI¡
 
uiAbsP¨tIdx
 ) const

1284 
UI¡
 
uiQUP¨tIdxMask
 = ~((1<<((
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxTŸÆCUDïth
(Ë- gëSli˚()->
	`gëPPS
()->
	`gëMaxCuDQPDïth
())<<1))-1);

1285 
I¡
 
iLa°VÆidP¨tIdx
 = 
	`gëLa°VÆidP¨tIdx
–
uiAbsP¨tIdx
&
uiQUP¨tIdxMask
 );

1287 i‡–
	`gëPic
()->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
()Ë=
	`gëCtuRsAddr
(Ë&& 
	`I¡
(
	`gëZ‹dîIdxInCtu
())+
iLa°VÆidP¨tIdx
<0)

1289  
	`gëSli˚
()->
	`gëSli˚Qp
();

1291 i‡–
iLa°VÆidP¨tIdx
 >= 0 )

1294  
	`gëQP
–
iLa°VÆidP¨tIdx
 );

1298 i‡–
	`gëZ‹dîIdxInCtu
() > 0 )

1301  
	`gëPic
()->
	`gëCtu
–
	`gëCtuRsAddr
(Ë)->
	`gëLa°CodedQP
–
	`gëZ‹dîIdxInCtu
() );

1303 i‡–
	`gëPic
()->
	`gëPicSym
()->
	`gëCtuRsToTsAddrM≠
(
	`gëCtuRsAddr
()) > 0

1304 && 
	`CUIsFromSameSli˚TûeAndWave‰⁄tRow
(
	`gëPic
()->
	`gëCtu
(gëPic()->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(gëPic()->gëPicSym()->
	`gëCtuRsToTsAddrM≠
(
	`gëCtuRsAddr
())-1))) )

1307  
	`gëPic
()->
	`gëCtu
–gëPic()->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(gëPic()->gëPicSym()->
	`gëCtuRsToTsAddrM≠
(
	`gëCtuRsAddr
())-1Ë)->
	`gëLa°CodedQP
–gëPic()->
	`gëNumP¨tôi⁄sInCtu
() );

1312  
	`gëSli˚
()->
	`gëSli˚Qp
();

1315 
	}
}

1322 
Boﬁ
 
	gTComD©aCU
::
	$isLos¶essCoded
(
UI¡
 
absP¨tIdx
) const

1324  (
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
(Ë&& 
	`gëCUTønsqu™tBy∑ss
 (
absP¨tIdx
));

1325 
	}
}

1334 
Void
 
	gTComD©aCU
::
	$gëAŒowedChromaDú
–
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiModeLi°
[
NUM_CHROMA_MODE
] ) const

1336 
uiModeLi°
[0] = 
PLANAR_IDX
;

1337 
uiModeLi°
[1] = 
VER_IDX
;

1338 
uiModeLi°
[2] = 
HOR_IDX
;

1339 
uiModeLi°
[3] = 
DC_IDX
;

1340 
uiModeLi°
[4] = 
DM_CHROMA_IDX
;

1341 
	`as£π
(4<
NUM_CHROMA_MODE
);

1343 
UI¡
 
uiLumaMode
 = 
	`gëI¡øDú
–
CHANNEL_TYPE_LUMA
, 
uiAbsP¨tIdx
 );

1345  
I¡
 
i
 = 0; i < 
NUM_CHROMA_MODE
 - 1; i++ )

1347 if–
uiLumaMode
 =
uiModeLi°
[
i
] )

1349 
uiModeLi°
[
i
] = 34;

1353 
	}
}

1362 
Void
 
	gTComD©aCU
::
	$gëI¡øDúPªdi˘‹
–
UI¡
 
uiAbsP¨tIdx
, 
I¡
 
uiI¡øDúPªd
[
NUM_MOST_PROBABLE_MODES
], c⁄° 
Comp⁄ítID
 
compID
, I¡* 
piMode
 ) const

1364 
UI¡
 
Le·P¨tIdx
 = 
MAX_UINT
;

1365 
UI¡
 
AboveP¨tIdx
 = 
MAX_UINT
;

1366 
I¡
 
iLe·I¡øDú
, 
iAboveI¡øDú
;

1367 c⁄° 
TComSPS
 *
•s
=
	`gëSli˚
()->
	`gëSPS
();

1368 c⁄° 
UI¡
 
∑πsPîMöCU
 = 1<<(2*(
•s
->
	`gëMaxTŸÆCUDïth
(Ë- sps->
	`gëLog2DiffMaxMöCodögBlockSize
()));

1370 c⁄° 
Ch™√lTy≥
 
chTy≥
 = 
	`toCh™√lTy≥
(
compID
);

1371 c⁄° 
ChromaF‹m©
 
chF‹m
 = 
	`gëPic
()->
	`gëChromaF‹m©
();

1373 c⁄° 
TComD©aCU
 *
pcCULe·
 = 
	`gëPULe·
–
Le·P¨tIdx
, 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
 );

1375 i‡(
	`isChroma
(
compID
))

1377 
Le·P¨tIdx
 = 
	`gëChromasC‹ª•⁄dögPULumaIdx
(Le·P¨tIdx, 
chF‹m
, 
∑πsPîMöCU
);

1379 
iLe·I¡øDú
 = 
pcCULe·
 ? (ÖcCULe·->
	`isI¡ø
–
Le·P¨tIdx
 ) ?ÖcCULe·->
	`gëI¡øDú
–
chTy≥
, Le·P¨tIdx ) : 
DC_IDX
 ) : DC_IDX;

1382 c⁄° 
TComD©aCU
 *
pcCUAbove
 = 
	`gëPUAbove
–
AboveP¨tIdx
, 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
, 
åue
,Årue );

1384 i‡(
	`isChroma
(
compID
))

1386 
AboveP¨tIdx
 = 
	`gëChromasC‹ª•⁄dögPULumaIdx
(AboveP¨tIdx, 
chF‹m
, 
∑πsPîMöCU
);

1388 
iAboveI¡øDú
 = 
pcCUAbove
 ? (ÖcCUAbove->
	`isI¡ø
–
AboveP¨tIdx
 ) ?ÖcCUAbove->
	`gëI¡øDú
–
chTy≥
, AboveP¨tIdx ) : 
DC_IDX
 ) : DC_IDX;

1390 i‡(
	`isChroma
(
chTy≥
))

1392 i‡(
iLe·I¡øDú
 =
DM_CHROMA_IDX
)

1394 
iLe·I¡øDú
 = 
pcCULe·
-> 
	`gëI¡øDú
–
CHANNEL_TYPE_LUMA
, 
Le·P¨tIdx
 );

1396 i‡(
iAboveI¡øDú
 =
DM_CHROMA_IDX
)

1398 
iAboveI¡øDú
 = 
pcCUAbove
->
	`gëI¡øDú
–
CHANNEL_TYPE_LUMA
, 
AboveP¨tIdx
 );

1402 
	`as£π
 (2<
NUM_MOST_PROBABLE_MODES
);

1403 if(
iLe·I¡øDú
 =
iAboveI¡øDú
)

1405 if–
piMode
 )

1407 *
piMode
 = 1;

1410 i‡(
iLe·I¡øDú
 > 1)

1412 
uiI¡øDúPªd
[0] = 
iLe·I¡øDú
;

1413 
uiI¡øDúPªd
[1] = ((
iLe·I¡øDú
 + 29) % 32) + 2;

1414 
uiI¡øDúPªd
[2] = ((
iLe·I¡øDú
 - 1 ) % 32) + 2;

1418 
uiI¡øDúPªd
[0] = 
PLANAR_IDX
;

1419 
uiI¡øDúPªd
[1] = 
DC_IDX
;

1420 
uiI¡øDúPªd
[2] = 
VER_IDX
;

1425 if–
piMode
 )

1427 *
piMode
 = 2;

1429 
uiI¡øDúPªd
[0] = 
iLe·I¡øDú
;

1430 
uiI¡øDúPªd
[1] = 
iAboveI¡øDú
;

1432 i‡(
iLe·I¡øDú
 && 
iAboveI¡øDú
 )

1434 
uiI¡øDúPªd
[2] = 
PLANAR_IDX
;

1438 
uiI¡øDúPªd
[2] = (
iLe·I¡øDú
+
iAboveI¡øDú
)<2? 
VER_IDX
 : 
DC_IDX
;

1441 
UI¡
 
i
=0; i<
NUM_MOST_PROBABLE_MODES
; i++)

1443 
	`as£π
(
uiI¡øDúPªd
[
i
] < 35);

1445 
	}
}

1447 
UI¡
 
	gTComD©aCU
::
	$gëCtxS∂ôFœg
–
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) const

1449 c⁄° 
TComD©aCU
* 
pcTempCU
;

1450 
UI¡
 
uiTempP¨tIdx
;

1451 
UI¡
 
uiCtx
;

1453 
pcTempCU
 = 
	`gëPULe·
–
uiTempP¨tIdx
, 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
 );

1454 
uiCtx
 = ( 
pcTempCU
 ) ? ( (ÖcTempCU->
	`gëDïth
–
uiTempP¨tIdx
 ) > 
uiDïth
 ) ? 1 : 0 ) : 0;

1457 
pcTempCU
 = 
	`gëPUAbove
–
uiTempP¨tIdx
, 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
 );

1458 
uiCtx
 +–
pcTempCU
 ) ? ( (ÖcTempCU->
	`gëDïth
–
uiTempP¨tIdx
 ) > 
uiDïth
 ) ? 1 : 0 ) : 0;

1460  
uiCtx
;

1461 
	}
}

1463 
UI¡
 
	gTComD©aCU
::
	$gëCtxQtCbf
–
TComTU
 &
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 ) const

1465 c⁄° 
UI¡
 
å™sf‹mDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

1467 i‡(
	`isChroma
(
chTy≥
))

1469  
å™sf‹mDïth
;

1473 c⁄° 
UI¡
 
uiCtx
 = ( 
å™sf‹mDïth
 == 0 ? 1 : 0 );

1474  
uiCtx
;

1476 
	}
}

1478 
UI¡
 
	gTComD©aCU
::
	$gëQuadåìTULog2MöSizeInCU
–
UI¡
 
absP¨tIdx
 ) const

1480 
UI¡
 
log2CbSize
 = 
g_aucC⁄vîtToBô
[
	`gëWidth
–
absP¨tIdx
 )] + 2;

1481 
P¨tSize
 
∑πSize
 = 
	`gëP¨tôi⁄Size
–
absP¨tIdx
 );

1482 
UI¡
 
quadåìTUMaxDïth
 = 
	`isI¡ø
–
absP¨tIdx
 ) ? 
m_pcSli˚
->
	`gëSPS
()->
	`gëQuadåìTUMaxDïthI¡ø
(Ë: m_pcSli˚->gëSPS()->
	`gëQuadåìTUMaxDïthI¡î
();

1483 
I¡
 
öåaS∂ôFœg
 = ( 
	`isI¡ø
–
absP¨tIdx
 ) && 
∑πSize
 =
SIZE_NxN
 ) ? 1 : 0;

1484 
I¡
 
öãrS∂ôFœg
 = ((
quadåìTUMaxDïth
 =1Ë&& 
	`isI¡î
–
absP¨tIdx
 ) && (
∑πSize
 !
SIZE_2Nx2N
) );

1486 
UI¡
 
log2MöTUSizeInCU
 = 0;

1487 i‡(
log2CbSize
 < (
m_pcSli˚
->
	`gëSPS
()->
	`gëQuadåìTULog2MöSize
(Ë+ 
quadåìTUMaxDïth
 - 1 + 
öãrS∂ôFœg
 + 
öåaS∂ôFœg
) )

1490 
log2MöTUSizeInCU
 = 
m_pcSli˚
->
	`gëSPS
()->
	`gëQuadåìTULog2MöSize
();

1495 
log2MöTUSizeInCU
 = 
log2CbSize
 - ( 
quadåìTUMaxDïth
 - 1 + 
öãrS∂ôFœg
 + 
öåaS∂ôFœg
);

1496 i‡–
log2MöTUSizeInCU
 > 
m_pcSli˚
->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
())

1499 
log2MöTUSizeInCU
 = 
m_pcSli˚
->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
();

1502  
log2MöTUSizeInCU
;

1503 
	}
}

1505 
UI¡
 
	gTComD©aCU
::
	$gëCtxSkùFœg
–
UI¡
 
uiAbsP¨tIdx
 ) const

1507 c⁄° 
TComD©aCU
* 
pcTempCU
;

1508 
UI¡
 
uiTempP¨tIdx
;

1509 
UI¡
 
uiCtx
 = 0;

1512 
pcTempCU
 = 
	`gëPULe·
–
uiTempP¨tIdx
, 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
 );

1513 
uiCtx
 = ( 
pcTempCU
 ) ?ÖcTempCU->
	`isSkù≥d
–
uiTempP¨tIdx
 ) : 0;

1516 
pcTempCU
 = 
	`gëPUAbove
–
uiTempP¨tIdx
, 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
 );

1517 
uiCtx
 +–
pcTempCU
 ) ?ÖcTempCU->
	`isSkù≥d
–
uiTempP¨tIdx
 ) : 0;

1519  
uiCtx
;

1520 
	}
}

1522 
UI¡
 
	gTComD©aCU
::
	$gëCtxI¡îDú
–
UI¡
 
uiAbsP¨tIdx
 ) const

1524  
	`gëDïth
–
uiAbsP¨tIdx
 );

1525 
	}
}

1528 
UCh¨
 
	gTComD©aCU
::
	$gëQtRoŸCbf
–
UI¡
 
uiIdx
 ) const

1530 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

1531  
	`gëCbf
–
uiIdx
, 
COMPONENT_Y
, 0 )

1532 || ((
numbîVÆidComp⁄íts
 > 
COMPONENT_Cb
Ë&& 
	`gëCbf
–
uiIdx
, COMPONENT_Cb, 0 ))

1533 || ((
numbîVÆidComp⁄íts
 > 
COMPONENT_Cr
Ë&& 
	`gëCbf
–
uiIdx
, COMPONENT_Cr, 0 ));

1534 
	}
}

1536 
Void
 
	gTComD©aCU
::
	$£tCbfSubP¨ts
–c⁄° 
UI¡
 
uiCbf
[
MAX_NUM_COMPONENT
], UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1538 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1539 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

1541 
	`mem£t
–
m_puhCbf
[
comp
] + 
uiAbsP¨tIdx
, 
uiCbf
[comp], –
UCh¨
 ) * 
uiCuºP¨tNumb
 );

1543 
	}
}

1545 
Void
 
	gTComD©aCU
::
	$£tCbfSubP¨ts
–
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1547 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1548 
	`mem£t
–
m_puhCbf
[
compID
] + 
uiAbsP¨tIdx
, 
uiCbf
, –
UCh¨
 ) * 
uiCuºP¨tNumb
 );

1549 
	}
}

1558 
Void
 
	gTComD©aCU
::
	$£tCbfSubP¨ts
 ( 
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 )

1560 
£tSubP¨t
<
UCh¨
>–
uiCbf
, 
m_puhCbf
[
compID
], 
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

1561 
	}
}

1563 
Void
 
	gTComD©aCU
::
	$£tCbfP¨tR™ge
 ( 
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 )

1565 
	`mem£t
((
m_puhCbf
[
compID
] + 
uiAbsP¨tIdx
), 
uiCbf
, ((
UCh¨
Ë* 
uiCovîedP¨tIdxes
));

1566 
	}
}

1568 
Void
 
	gTComD©aCU
::
	$bôwi£OrCbfP¨tR™ge
–
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 )

1570 c⁄° 
UI¡
 
°›AbsP¨tIdx
 = 
uiAbsP¨tIdx
 + 
uiCovîedP¨tIdxes
;

1572 
UI¡
 
subP¨tIdx
 = 
uiAbsP¨tIdx
; subP¨tIdx < 
°›AbsP¨tIdx
; subPartIdx++)

1574 
m_puhCbf
[
compID
][
subP¨tIdx
] |
uiCbf
;

1576 
	}
}

1578 
Void
 
	gTComD©aCU
::
	$£tDïthSubP¨ts
–
UI¡
 
uiDïth
, UI¡ 
uiAbsP¨tIdx
 )

1580 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1581 
	`mem£t
–
m_puhDïth
 + 
uiAbsP¨tIdx
, 
uiDïth
, (
UCh¨
)*
uiCuºP¨tNumb
 );

1582 
	}
}

1584 
Boﬁ
 
	gTComD©aCU
::
	$isFú°AbsZ‹dîIdxInDïth
 (
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
) const

1586 
UI¡
 
uiP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1587  (((
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
)% 
uiP¨tNumb
) == 0);

1588 
	}
}

1590 
Void
 
	gTComD©aCU
::
	$£tP¨tSizeSubP¨ts
–
P¨tSize
 
eMode
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1592 
	`as£π
––*
m_≥P¨tSize
) == 1 );

1593 
	`mem£t
–
m_≥P¨tSize
 + 
uiAbsP¨tIdx
, 
eMode
, 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> ( 2 * 
uiDïth
 ) );

1594 
	}
}

1596 
Void
 
	gTComD©aCU
::
	$£tCUTønsqu™tBy∑ssSubP¨ts
–
Boﬁ
 
Êag
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1598 
	`mem£t
–
m_CUTønsqu™tBy∑ss
 + 
uiAbsP¨tIdx
, 
Êag
, 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> ( 2 * 
uiDïth
 ) );

1599 
	}
}

1601 
Void
 
	gTComD©aCU
::
	$£tSkùFœgSubP¨ts
–
Boﬁ
 
skù
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
 )

1603 
	`as£π
––*
m_skùFœg
) == 1 );

1604 
	`mem£t
–
m_skùFœg
 + 
absP¨tIdx
, 
skù
, 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> ( 2 * 
dïth
 ) );

1605 
	}
}

1607 
Void
 
	gTComD©aCU
::
	$£tPªdModeSubP¨ts
–
PªdMode
 
eMode
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1609 
	`as£π
––*
m_≥PªdMode
) == 1 );

1610 
	`mem£t
–
m_≥PªdMode
 + 
uiAbsP¨tIdx
, 
eMode
, 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> ( 2 * 
uiDïth
 ) );

1611 
	}
}

1613 
Void
 
	gTComD©aCU
::
	$£tChromaQpAdjSubP¨ts
–
UCh¨
 
vÆ
, 
I¡
 
absP¨tIdx
, I¡ 
dïth
 )

1615 
	`as£π
–(*
m_ChromaQpAdj
) == 1 );

1616 
	`mem£t
–
m_ChromaQpAdj
 + 
absP¨tIdx
, 
vÆ
, 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> ( 2 * 
dïth
 ) );

1617 
	}
}

1619 
Void
 
	gTComD©aCU
::
	$£tQPSubCUs
–
I¡
 
qp
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
, 
Boﬁ
 &
foundN⁄ZîoCbf
 )

1621 
UI¡
 
cuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
dïth
 << 1);

1622 
UI¡
 
cuºP¨tNumQ
 = 
cuºP¨tNumb
 >> 2;

1623 c⁄° 
UI¡
 
numVÆidComp
 = 
m_pcPic
->
	`gëNumbîVÆidComp⁄íts
();

1625 if(!
foundN⁄ZîoCbf
)

1627 if(
	`gëDïth
(
absP¨tIdx
Ë> 
dïth
)

1629  
UI¡
 
∑πUnôIdx
 = 0;ÖartUnitIdx < 4;ÖartUnitIdx++ )

1631 
	`£tQPSubCUs
–
qp
, 
absP¨tIdx
+
∑πUnôIdx
*
cuºP¨tNumQ
, 
dïth
+1, 
foundN⁄ZîoCbf
 );

1636 if(
	`gëCbf
–
absP¨tIdx
, 
COMPONENT_Y
 ) || (
numVÆidComp
>
COMPONENT_Cb
 && gëCbf–absP¨tIdx, COMPONENT_Cb )Ë|| (numVÆidComp>
COMPONENT_Cr
 && getCbf(ábsPartIdx, COMPONENT_Cr) ) )

1638 
foundN⁄ZîoCbf
 = 
åue
;

1642 
	`£tQPSubP¨ts
(
qp
, 
absP¨tIdx
, 
dïth
);

1646 
	}
}

1648 
Void
 
	gTComD©aCU
::
	$£tQPSubP¨ts
–
I¡
 
qp
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1650 c⁄° 
UI¡
 
numP¨t
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1651 
	`mem£t
(
m_phQP
+
uiAbsP¨tIdx
, 
qp
, 
numP¨t
);

1652 
	}
}

1654 
Void
 
	gTComD©aCU
::
	$£tI¡øDúSubP¨ts
–c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
, c⁄° 
UI¡
 
dú
, c⁄° UI¡ 
absP¨tIdx
, c⁄° UI¡ 
dïth
 )

1656 
UI¡
 
numP¨t
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
dïth
 << 1);

1657 
	`mem£t
–
m_puhI¡øDú
[
ch™√lTy≥
] + 
absP¨tIdx
, 
dú
,(
UCh¨
)*
numP¨t
 );

1658 
	}
}

1660 
	gãm∂©e
<
ty≥«me
 
	gT
>

1661 
Void
 
	gTComD©aCU
::
	$£tSubP¨t
–
T
 
uiP¨amëî
, T* 
puhBa£Ctu
, 
UI¡
 
uiCUAddr
, UI¡ 
uiCUDïth
, UI¡ 
uiPUIdx
 )

1663 
	`as£π
–(
T
) == 1 );

1665 
UI¡
 
uiCuºP¨tNumQ
 = (
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (2 * 
uiCUDïth
)) >> 2;

1666  
m_≥P¨tSize
[ 
uiCUAddr
 ] )

1668 
SIZE_2Nx2N
:

1669 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, 4 * 
uiCuºP¨tNumQ
 );

1671 
SIZE_2NxN
:

1672 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, 2 * 
uiCuºP¨tNumQ
 );

1674 
SIZE_Nx2N
:

1675 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, 
uiCuºP¨tNumQ
 );

1676 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + 2 * 
uiCuºP¨tNumQ
, 
uiP¨amëî
, uiCurrPartNumQ );

1678 
SIZE_NxN
:

1679 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, 
uiCuºP¨tNumQ
 );

1681 
SIZE_2NxnU
:

1682 i‡–
uiPUIdx
 == 0 )

1684 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, (
uiCuºP¨tNumQ
 >> 1) );

1685 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + 
uiCuºP¨tNumQ
, 
uiP¨amëî
, (uiCurrPartNumQ >> 1) );

1687 i‡–
uiPUIdx
 == 1 )

1689 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, (
uiCuºP¨tNumQ
 >> 1) );

1690 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + 
uiCuºP¨tNumQ
, 
uiP¨amëî
, ((uiCurrPartNumQ >> 1) + (uiCurrPartNumQ << 1)) );

1694 
	`as£π
(0);

1697 
SIZE_2NxnD
:

1698 i‡–
uiPUIdx
 == 0 )

1700 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, ((
uiCuºP¨tNumQ
 << 1) + (uiCurrPartNumQ >> 1)) );

1701 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1Ë+ uiCuºP¨tNumQ, 
uiP¨amëî
, (uiCurrPartNumQ >> 1) );

1703 i‡–
uiPUIdx
 == 1 )

1705 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, (
uiCuºP¨tNumQ
 >> 1) );

1706 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + 
uiCuºP¨tNumQ
, 
uiP¨amëî
, (uiCurrPartNumQ >> 1) );

1710 
	`as£π
(0);

1713 
SIZE_nLx2N
:

1714 i‡–
uiPUIdx
 == 0 )

1716 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, (
uiCuºP¨tNumQ
 >> 2) );

1717 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 >> 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1718 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1719 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1Ë+ (uiCuºP¨tNumQ >> 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1721 i‡–
uiPUIdx
 == 1 )

1723 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, (
uiCuºP¨tNumQ
 >> 2) );

1724 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 >> 1), 
uiP¨amëî
, (uiCurrPartNumQ + (uiCurrPartNumQ >> 2)) );

1725 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1726 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1Ë+ (uiCuºP¨tNumQ >> 1), 
uiP¨amëî
, (uiCurrPartNumQ + (uiCurrPartNumQ >> 2)) );

1730 
	`as£π
(0);

1733 
SIZE_nRx2N
:

1734 i‡–
uiPUIdx
 == 0 )

1736 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, (
uiCuºP¨tNumQ
 + (uiCurrPartNumQ >> 2)) );

1737 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + 
uiCuºP¨tNumQ
 + (uiCuºP¨tNumQ >> 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1738 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1), 
uiP¨amëî
, (uiCurrPartNumQ + (uiCurrPartNumQ >> 2)) );

1739 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1Ë+ uiCuºP¨tNumQ + (uiCuºP¨tNumQ >> 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1741 i‡–
uiPUIdx
 == 1 )

1743 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
, 
uiP¨amëî
, (
uiCuºP¨tNumQ
 >> 2) );

1744 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 >> 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1745 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1746 
	`mem£t
–
puhBa£Ctu
 + 
uiCUAddr
 + (
uiCuºP¨tNumQ
 << 1Ë+ (uiCuºP¨tNumQ >> 1), 
uiP¨amëî
, (uiCurrPartNumQ >> 2) );

1750 
	`as£π
(0);

1754 
	`as£π
( 0 );

1757 
	}
}

1759 
Void
 
	gTComD©aCU
::
	$£tMîgeFœgSubP¨ts
 ( 
Boﬁ
 
bMîgeFœg
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 )

1761 
	`£tSubP¨t
–
bMîgeFœg
, 
m_pbMîgeFœg
, 
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

1762 
	}
}

1764 
Void
 
	gTComD©aCU
::
	$£tMîgeIndexSubP¨ts
 ( 
UI¡
 
uiMîgeIndex
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 )

1766 
£tSubP¨t
<
UCh¨
>–
uiMîgeIndex
, 
m_puhMîgeIndex
, 
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

1767 
	}
}

1769 
Void
 
	gTComD©aCU
::
	$£tI¡îDúSubP¨ts
–
UI¡
 
uiDú
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 )

1771 
£tSubP¨t
<
UCh¨
>–
uiDú
, 
m_puhI¡îDú
, 
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

1772 
	}
}

1774 
Void
 
	gTComD©aCU
::
	$£tMVPIdxSubP¨ts
–
I¡
 
iMVPIdx
, 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 )

1776 
£tSubP¨t
<
SCh¨
>–
iMVPIdx
, 
m_≠iMVPIdx
[
eRefPicLi°
], 
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

1777 
	}
}

1779 
Void
 
	gTComD©aCU
::
	$£tMVPNumSubP¨ts
–
I¡
 
iMVPNum
, 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 )

1781 
£tSubP¨t
<
SCh¨
>–
iMVPNum
, 
m_≠iMVPNum
[
eRefPicLi°
], 
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

1782 
	}
}

1785 
Void
 
	gTComD©aCU
::
	$£tTrIdxSubP¨ts
–
UI¡
 
uiTrIdx
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1787 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1789 
	`mem£t
–
m_puhTrIdx
 + 
uiAbsP¨tIdx
, 
uiTrIdx
, (
UCh¨
)*
uiCuºP¨tNumb
 );

1790 
	}
}

1792 
Void
 
	gTComD©aCU
::
	$£tTønsf‹mSkùSubP¨ts
–c⁄° 
UI¡
 
u£Tønsf‹mSkù
[
MAX_NUM_COMPONENT
], UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1794 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1796 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

1798 
	`mem£t
–
m_puhTønsf‹mSkù
[
i
] + 
uiAbsP¨tIdx
, 
u£Tønsf‹mSkù
[i], –
UCh¨
 ) * 
uiCuºP¨tNumb
 );

1800 
	}
}

1802 
Void
 
	gTComD©aCU
::
	$£tTønsf‹mSkùSubP¨ts
–
UI¡
 
u£Tønsf‹mSkù
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
)

1804 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1806 
	`mem£t
–
m_puhTønsf‹mSkù
[
compID
] + 
uiAbsP¨tIdx
, 
u£Tønsf‹mSkù
, –
UCh¨
 ) * 
uiCuºP¨tNumb
 );

1807 
	}
}

1809 
Void
 
	gTComD©aCU
::
	$£tTønsf‹mSkùP¨tR™ge
 ( 
UI¡
 
u£Tønsf‹mSkù
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 )

1811 
	`mem£t
((
m_puhTønsf‹mSkù
[
compID
] + 
uiAbsP¨tIdx
), 
u£Tønsf‹mSkù
, ((
UCh¨
Ë* 
uiCovîedP¨tIdxes
));

1812 
	}
}

1814 
Void
 
	gTComD©aCU
::
	$£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
–
SCh¨
 
ÆphaVÆue
, 
Comp⁄ítID
 
compID
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 )

1816 
	`mem£t
((
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[
compID
] + 
uiAbsP¨tIdx
), 
ÆphaVÆue
, ((
SCh¨
Ë* 
uiCovîedP¨tIdxes
));

1817 
	}
}

1819 
Void
 
	gTComD©aCU
::
	$£tEx∂icôRdpcmModeP¨tR™ge
 ( 
UI¡
 
rdpcmMode
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 )

1821 
	`mem£t
((
m_ex∂icôRdpcmMode
[
compID
] + 
uiAbsP¨tIdx
), 
rdpcmMode
, ((
UCh¨
Ë* 
uiCovîedP¨tIdxes
));

1822 
	}
}

1824 
Void
 
	gTComD©aCU
::
	$£tSizeSubP¨ts
–
UI¡
 
uiWidth
, UI¡ 
uiHeight
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1826 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

1828 
	`mem£t
–
m_puhWidth
 + 
uiAbsP¨tIdx
, 
uiWidth
, (
UCh¨
)*
uiCuºP¨tNumb
 );

1829 
	`mem£t
–
m_puhHeight
 + 
uiAbsP¨tIdx
, 
uiHeight
, (
UCh¨
)*
uiCuºP¨tNumb
 );

1830 
	}
}

1832 
UCh¨
 
	gTComD©aCU
::
	$gëNumP¨tôi⁄s
(c⁄° 
UI¡
 
uiAbsP¨tIdx
) const

1834 
UCh¨
 
iNumP¨t
 = 0;

1836  
m_≥P¨tSize
[
uiAbsP¨tIdx
] )

1838 
SIZE_2Nx2N
: 
iNumP¨t
 = 1; ;

1839 
SIZE_2NxN
: 
iNumP¨t
 = 2; ;

1840 
SIZE_Nx2N
: 
iNumP¨t
 = 2; ;

1841 
SIZE_NxN
: 
iNumP¨t
 = 4; ;

1842 
SIZE_2NxnU
: 
iNumP¨t
 = 2; ;

1843 
SIZE_2NxnD
: 
iNumP¨t
 = 2; ;

1844 
SIZE_nLx2N
: 
iNumP¨t
 = 2; ;

1845 
SIZE_nRx2N
: 
iNumP¨t
 = 2; ;

1846 : 
	`as£π
 (0); ;

1849  
iNumP¨t
;

1850 
	}
}

1853 
Void
 
	gTComD©aCU
::
	$gëP¨tIndexAndSize
–
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tAddr
, 
I¡
& 
riWidth
, I¡& 
riHeight
 ) const

1855  
m_≥P¨tSize
[0] )

1857 
SIZE_2NxN
:

1858 
riWidth
 = 
	`gëWidth
(0); 
riHeight
 = 
	`gëHeight
(0Ë>> 1; 
ruiP¨tAddr
 = ( 
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 1;

1860 
SIZE_Nx2N
:

1861 
riWidth
 = 
	`gëWidth
(0Ë>> 1; 
riHeight
 = 
	`gëHeight
(0); 
ruiP¨tAddr
 = ( 
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 2;

1863 
SIZE_NxN
:

1864 
riWidth
 = 
	`gëWidth
(0Ë>> 1; 
riHeight
 = 
	`gëHeight
(0Ë>> 1; 
ruiP¨tAddr
 = ( 
m_uiNumP¨tôi⁄
 >> 2 ) * 
uiP¨tIdx
;

1866 
SIZE_2NxnU
:

1867 
riWidth
 = 
	`gëWidth
(0);

1868 
riHeight
 = ( 
uiP¨tIdx
 =0 ) ? 
	`gëHeight
(0) >> 2 : ( getHeight(0) >> 2 ) + ( getHeight(0) >> 1 );

1869 
ruiP¨tAddr
 = ( 
uiP¨tIdx
 =0 ) ? 0 : 
m_uiNumP¨tôi⁄
 >> 3;

1871 
SIZE_2NxnD
:

1872 
riWidth
 = 
	`gëWidth
(0);

1873 
riHeight
 = ( 
uiP¨tIdx
 =0 ) ? ( 
	`gëHeight
(0) >> 2 ) + ( getHeight(0) >> 1 ) : getHeight(0) >> 2;

1874 
ruiP¨tAddr
 = ( 
uiP¨tIdx
 =0 ) ? 0 : (
m_uiNumP¨tôi⁄
 >> 1) + (m_uiNumPartition >> 3);

1876 
SIZE_nLx2N
:

1877 
riWidth
 = ( 
uiP¨tIdx
 =0 ) ? 
	`gëWidth
(0) >> 2 : ( getWidth(0) >> 2 ) + ( getWidth(0) >> 1 );

1878 
riHeight
 = 
	`gëHeight
(0);

1879 
ruiP¨tAddr
 = ( 
uiP¨tIdx
 =0 ) ? 0 : 
m_uiNumP¨tôi⁄
 >> 4;

1881 
SIZE_nRx2N
:

1882 
riWidth
 = ( 
uiP¨tIdx
 =0 ) ? ( 
	`gëWidth
(0) >> 2 ) + ( getWidth(0) >> 1 ) : getWidth(0) >> 2;

1883 
riHeight
 = 
	`gëHeight
(0);

1884 
ruiP¨tAddr
 = ( 
uiP¨tIdx
 =0 ) ? 0 : (
m_uiNumP¨tôi⁄
 >> 2) + (m_uiNumPartition >> 4);

1887 
	`as£π
 ( 
m_≥P¨tSize
[0] =
SIZE_2Nx2N
 );

1888 
riWidth
 = 
	`gëWidth
(0); 
riHeight
 = 
	`gëHeight
(0); 
ruiP¨tAddr
 = 0;

1891 
	}
}

1894 
Void
 
	gTComD©aCU
::
	$gëMvFõld
 ( c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefPicLi°
, 
TComMvFõld
& 
rcMvFõld
 )

1896 i‡–
pcCU
 =
NULL
 )

1898 
TComMv
 
cZîoMv
;

1899 
rcMvFõld
.
	`£tMvFõld
–
cZîoMv
, 
NOT_VALID
 );

1903 c⁄° 
TComCUMvFõld
* 
pcCUMvFõld
 = 
pcCU
->
	`gëCUMvFõld
–
eRefPicLi°
 );

1904 
rcMvFõld
.
	`£tMvFõld
–
pcCUMvFõld
->
	`gëMv
–
uiAbsP¨tIdx
 ),ÖcCUMvFõld->
	`gëRefIdx
( uiAbsPartIdx ) );

1905 
	}
}

1907 
Void
 
	gTComD©aCU
::
	$dîiveLe·RightT›IdxGíîÆ
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLT
, UI¡& 
ruiP¨tIdxRT
 ) const

1909 
ruiP¨tIdxLT
 = 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
;

1910 
UI¡
 
uiPUWidth
 = 0;

1912  
m_≥P¨tSize
[
uiAbsP¨tIdx
] )

1914 
SIZE_2Nx2N
: 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
]; ;

1915 
SIZE_2NxN
: 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
]; ;

1916 
SIZE_Nx2N
: 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
] >> 1; ;

1917 
SIZE_NxN
: 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
] >> 1; ;

1918 
SIZE_2NxnU
: 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
]; ;

1919 
SIZE_2NxnD
: 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
]; ;

1920 
SIZE_nLx2N
:

1921 i‡–
uiP¨tIdx
 == 0 )

1923 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
] >> 2;

1925 i‡–
uiP¨tIdx
 == 1 )

1927 
uiPUWidth
 = (
m_puhWidth
[
uiAbsP¨tIdx
] >> 1) + (m_puhWidth[uiAbsPartIdx] >> 2);

1931 
	`as£π
(0);

1934 
SIZE_nRx2N
:

1935 i‡–
uiP¨tIdx
 == 0 )

1937 
uiPUWidth
 = (
m_puhWidth
[
uiAbsP¨tIdx
] >> 1) + (m_puhWidth[uiAbsPartIdx] >> 2);

1939 i‡–
uiP¨tIdx
 == 1 )

1941 
uiPUWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
] >> 2;

1945 
	`as£π
(0);

1949 
	`as£π
 (0);

1953 
ruiP¨tIdxRT
 = 
g_auiRa°îToZsˇn
 [
g_auiZsˇnToRa°î
[ 
ruiP¨tIdxLT
 ] + 
uiPUWidth
 / 
m_pcPic
->
	`gëMöCUWidth
() - 1 ];

1954 
	}
}

1956 
Void
 
	gTComD©aCU
::
	$dîiveLe·BŸtomIdxGíîÆ
–
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLB
 ) const

1958 
UI¡
 
uiPUHeight
 = 0;

1959  
m_≥P¨tSize
[
uiAbsP¨tIdx
] )

1961 
SIZE_2Nx2N
: 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
]; ;

1962 
SIZE_2NxN
: 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
] >> 1; ;

1963 
SIZE_Nx2N
: 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
]; ;

1964 
SIZE_NxN
: 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
] >> 1; ;

1965 
SIZE_2NxnU
:

1966 i‡–
uiP¨tIdx
 == 0 )

1968 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
] >> 2;

1970 i‡–
uiP¨tIdx
 == 1 )

1972 
uiPUHeight
 = (
m_puhHeight
[
uiAbsP¨tIdx
] >> 1) + (m_puhHeight[uiAbsPartIdx] >> 2);

1976 
	`as£π
(0);

1979 
SIZE_2NxnD
:

1980 i‡–
uiP¨tIdx
 == 0 )

1982 
uiPUHeight
 = (
m_puhHeight
[
uiAbsP¨tIdx
] >> 1) + (m_puhHeight[uiAbsPartIdx] >> 2);

1984 i‡–
uiP¨tIdx
 == 1 )

1986 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
] >> 2;

1990 
	`as£π
(0);

1993 
SIZE_nLx2N
: 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
]; ;

1994 
SIZE_nRx2N
: 
uiPUHeight
 = 
m_puhHeight
[
uiAbsP¨tIdx
]; ;

1996 
	`as£π
 (0);

2000 
ruiP¨tIdxLB
 = 
g_auiRa°îToZsˇn
 [
g_auiZsˇnToRa°î
[ 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
 ] + ((
uiPUHeight
 / 
m_pcPic
->
	`gëMöCUHeight
()Ë- 1)*m_pcPic->
	`gëNumP¨tInCtuWidth
()];

2001 
	}
}

2003 
Void
 
	gTComD©aCU
::
	$dîiveLe·RightT›Idx
 ( 
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLT
, UI¡& 
ruiP¨tIdxRT
 ) const

2005 
ruiP¨tIdxLT
 = 
m_absZIdxInCtu
;

2006 
ruiP¨tIdxRT
 = 
g_auiRa°îToZsˇn
 [
g_auiZsˇnToRa°î
[ 
ruiP¨tIdxLT
 ] + 
m_puhWidth
[0] / 
m_pcPic
->
	`gëMöCUWidth
() - 1 ];

2008  
m_≥P¨tSize
[0] )

2010 
SIZE_2Nx2N
: ;

2011 
SIZE_2NxN
:

2012 
ruiP¨tIdxLT
 +–
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 1; 
ruiP¨tIdxRT
 += ( uiPartIdx == 0 )? 0 : m_uiNumPartition >> 1;

2014 
SIZE_Nx2N
:

2015 
ruiP¨tIdxLT
 +–
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 2; 
ruiP¨tIdxRT
 -= ( uiPartIdx == 1 )? 0 : m_uiNumPartition >> 2;

2017 
SIZE_NxN
:

2018 
ruiP¨tIdxLT
 +–
m_uiNumP¨tôi⁄
 >> 2 ) * 
uiP¨tIdx
; 
ruiP¨tIdxRT
 += ( m_uiNumPartition >> 2 ) * ( uiPartIdx - 1 );

2020 
SIZE_2NxnU
:

2021 
ruiP¨tIdxLT
 +–
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 3;

2022 
ruiP¨tIdxRT
 +–
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 3;

2024 
SIZE_2NxnD
:

2025 
ruiP¨tIdxLT
 +–
uiP¨tIdx
 =0 )? 0 : ( 
m_uiNumP¨tôi⁄
 >> 1 ) + ( m_uiNumPartition >> 3 );

2026 
ruiP¨tIdxRT
 +–
uiP¨tIdx
 =0 )? 0 : ( 
m_uiNumP¨tôi⁄
 >> 1 ) + ( m_uiNumPartition >> 3 );

2028 
SIZE_nLx2N
:

2029 
ruiP¨tIdxLT
 +–
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 4;

2030 
ruiP¨tIdxRT
 -–
uiP¨tIdx
 =1 )? 0 : ( 
m_uiNumP¨tôi⁄
 >> 2 ) + ( m_uiNumPartition >> 4 );

2032 
SIZE_nRx2N
:

2033 
ruiP¨tIdxLT
 +–
uiP¨tIdx
 =0 )? 0 : ( 
m_uiNumP¨tôi⁄
 >> 2 ) + ( m_uiNumPartition >> 4 );

2034 
ruiP¨tIdxRT
 -–
uiP¨tIdx
 =1 )? 0 : 
m_uiNumP¨tôi⁄
 >> 4;

2037 
	`as£π
 (0);

2041 
	}
}

2043 
Void
 
	gTComD©aCU
::
	$dîiveLe·BŸtomIdx
–
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLB
 ) const

2045 
ruiP¨tIdxLB
 = 
g_auiRa°îToZsˇn
 [
g_auiZsˇnToRa°î
[ 
m_absZIdxInCtu
 ] + ( ((
m_puhHeight
[0] / 
m_pcPic
->
	`gëMöCUHeight
())>>1Ë- 1)*m_pcPic->
	`gëNumP¨tInCtuWidth
()];

2047  
m_≥P¨tSize
[0] )

2049 
SIZE_2Nx2N
:

2050 
ruiP¨tIdxLB
 +
m_uiNumP¨tôi⁄
 >> 1;

2052 
SIZE_2NxN
:

2053 
ruiP¨tIdxLB
 +–
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 1;

2055 
SIZE_Nx2N
:

2056 
ruiP¨tIdxLB
 +–
uiP¨tIdx
 =0 )? 
m_uiNumP¨tôi⁄
 >> 1 : (m_uiNumPartition >> 2)*3;

2058 
SIZE_NxN
:

2059 
ruiP¨tIdxLB
 +–
m_uiNumP¨tôi⁄
 >> 2 ) * 
uiP¨tIdx
;

2061 
SIZE_2NxnU
:

2062 
ruiP¨tIdxLB
 +–
uiP¨tIdx
 =0 ) ? -((
I¡
)
m_uiNumP¨tôi⁄
 >> 3) : m_uiNumPartition >> 1;

2064 
SIZE_2NxnD
:

2065 
ruiP¨tIdxLB
 +–
uiP¨tIdx
 =0 ) ? (
m_uiNumP¨tôi⁄
 >> 2) + (m_uiNumPartition >> 3): m_uiNumPartition >> 1;

2067 
SIZE_nLx2N
:

2068 
ruiP¨tIdxLB
 +–
uiP¨tIdx
 =0 ) ? 
m_uiNumP¨tôi⁄
 >> 1 : (m_uiNumPartition >> 1) + (m_uiNumPartition >> 4);

2070 
SIZE_nRx2N
:

2071 
ruiP¨tIdxLB
 +–
uiP¨tIdx
 =0 ) ? 
m_uiNumP¨tôi⁄
 >> 1 : (m_uiNumPartition >> 1) + (m_uiNumPartition >> 2) + (m_uiNumPartition >> 4);

2074 
	`as£π
 (0);

2077 
	}
}

2083 
Void
 
	gTComD©aCU
::
	$dîiveRightBŸtomIdx
–
UI¡
 
uiP¨tIdx
, UI¡ &
ruiP¨tIdxRB
 ) const

2085 
ruiP¨tIdxRB
 = 
g_auiRa°îToZsˇn
 [
g_auiZsˇnToRa°î
[ 
m_absZIdxInCtu
 ] + ( ((
m_puhHeight
[0] / 
m_pcPic
->
	`gëMöCUHeight
())>>1Ë- 1)*m_pcPic->
	`gëNumP¨tInCtuWidth
(Ë+ 
m_puhWidth
[0] / m_pcPic->
	`gëMöCUWidth
() - 1];

2087  
m_≥P¨tSize
[0] )

2089 
SIZE_2Nx2N
:

2090 
ruiP¨tIdxRB
 +
m_uiNumP¨tôi⁄
 >> 1;

2092 
SIZE_2NxN
:

2093 
ruiP¨tIdxRB
 +–
uiP¨tIdx
 =0 )? 0 : 
m_uiNumP¨tôi⁄
 >> 1;

2095 
SIZE_Nx2N
:

2096 
ruiP¨tIdxRB
 +–
uiP¨tIdx
 =0 )? 
m_uiNumP¨tôi⁄
 >> 2 : (m_uiNumPartition >> 1);

2098 
SIZE_NxN
:

2099 
ruiP¨tIdxRB
 +–
m_uiNumP¨tôi⁄
 >> 2 ) * ( 
uiP¨tIdx
 - 1 );

2101 
SIZE_2NxnU
:

2102 
ruiP¨tIdxRB
 +–
uiP¨tIdx
 =0 ) ? -((
I¡
)
m_uiNumP¨tôi⁄
 >> 3) : m_uiNumPartition >> 1;

2104 
SIZE_2NxnD
:

2105 
ruiP¨tIdxRB
 +–
uiP¨tIdx
 =0 ) ? (
m_uiNumP¨tôi⁄
 >> 2) + (m_uiNumPartition >> 3): m_uiNumPartition >> 1;

2107 
SIZE_nLx2N
:

2108 
ruiP¨tIdxRB
 +–
uiP¨tIdx
 =0 ) ? (
m_uiNumP¨tôi⁄
 >> 3) + (m_uiNumPartition >> 4): m_uiNumPartition >> 1;

2110 
SIZE_nRx2N
:

2111 
ruiP¨tIdxRB
 +–
uiP¨tIdx
 =0 ) ? (
m_uiNumP¨tôi⁄
 >> 2) + (m_uiNumPartition >> 3) + (m_uiNumPartition >> 4) : m_uiNumPartition >> 1;

2114 
	`as£π
 (0);

2117 
	}
}

2119 
Boﬁ
 
	gTComD©aCU
::
	$hasEquÆMŸi⁄
–
UI¡
 
uiAbsP¨tIdx
, c⁄° 
TComD©aCU
* 
pcC™dCU
, UI¡ 
uiC™dAbsP¨tIdx
 ) const

2121 i‡–
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) !
pcC™dCU
->gëI¡îDú–
uiC™dAbsP¨tIdx
 ) )

2123  
Ál£
;

2126  
UI¡
 
uiRefLi°Idx
 = 0; uiRefListIdx < 2; uiRefListIdx++ )

2128 i‡–
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) & ( 1 << 
uiRefLi°Idx
 ) )

2130 i‡–
	`gëCUMvFõld
–
	`RefPicLi°
–
uiRefLi°Idx
 ) )->
	`gëMv
–
uiAbsP¨tIdx
 ) !
pcC™dCU
->gëCUMvFõld–RefPicLi°–uiRefLi°Idx ) )->gëMv–
uiC™dAbsP¨tIdx
 ) ||

2131 
	`gëCUMvFõld
–
	`RefPicLi°
–
uiRefLi°Idx
 ) )->
	`gëRefIdx
–
uiAbsP¨tIdx
 ) !
pcC™dCU
->gëCUMvFõld–RefPicLi°–uiRefLi°Idx ) )->gëRefIdx–
uiC™dAbsP¨tIdx
 ) )

2133  
Ál£
;

2138  
åue
;

2139 
	}
}

2142 #i‡
MCTS_ENC_CHECK


2143 
Void
 
	gTComD©aCU
::
	$gëI¡îMîgeC™did©es
–
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiPUIdx
, 
TComMvFõld
* 
pcMvFõldNeighbours
, 
UCh¨
* 
puhI¡îDúNeighbours
, 
I¡
& 
numVÆidMîgeC™d
, UI¡ &
numS∑tülMîgeC™did©es
, I¡ 
mrgC™dIdx
 ) const

2145 
Void
 
TComD©aCU
::
	$gëI¡îMîgeC™did©es
–
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiPUIdx
, 
TComMvFõld
* 
pcMvFõldNeighbours
, 
UCh¨
* 
puhI¡îDúNeighbours
, 
I¡
& 
numVÆidMîgeC™d
, I¡ 
mrgC™dIdx
 ) const

2148 
UI¡
 
uiAbsP¨tAddr
 = 
m_absZIdxInCtu
 + 
uiAbsP¨tIdx
;

2149 
Boﬁ
 
abC™dIsI¡î
[ 
MRG_MAX_NUM_CANDS
 ];

2150  
UI¡
 
ui
 = 0; uò< 
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
(); ++ui )

2152 
abC™dIsI¡î
[
ui
] = 
Ál£
;

2153 
pcMvFõldNeighbours
[ ( 
ui
 << 1 ) ].
	`£tRefIdx
(
NOT_VALID
);

2154 
pcMvFõldNeighbours
[ ( 
ui
 << 1 ) + 1 ].
	`£tRefIdx
(
NOT_VALID
);

2156 
numVÆidMîgeC™d
 = 
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
();

2158 
I¡
 
xP
, 
yP
, 
nPSW
, 
nPSH
;

2159 
this
->
	`gëP¨tPosôi⁄
(
uiPUIdx
, 
xP
, 
yP
, 
nPSW
, 
nPSH
);

2161 
I¡
 
iCou¡
 = 0;

2163 
UI¡
 
uiP¨tIdxLT
, 
uiP¨tIdxRT
, 
uiP¨tIdxLB
;

2164 
P¨tSize
 
cCurPS
 = 
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 );

2165 
	`dîiveLe·RightT›IdxGíîÆ
–
uiAbsP¨tIdx
, 
uiPUIdx
, 
uiP¨tIdxLT
, 
uiP¨tIdxRT
 );

2166 
	`dîiveLe·BŸtomIdxGíîÆ
–
uiAbsP¨tIdx
, 
uiPUIdx
, 
uiP¨tIdxLB
 );

2169 
UI¡
 
uiLe·P¨tIdx
 = 0;

2170 c⁄° 
TComD©aCU
 *
pcCULe·
 = 
	`gëPULe·
–
uiLe·P¨tIdx
, 
uiP¨tIdxLB
 );

2172 
Boﬁ
 
isAvaûabÀA1
 = 
pcCULe·
 &&

2173 
pcCULe·
->
	`isDiffMER
(
xP
 -1, 
yP
+
nPSH
-1, xP, yP) &&

2174 !–
uiPUIdx
 =1 && (
cCurPS
 =
SIZE_Nx2N
 || cCurPS =
SIZE_nLx2N
 || cCurPS =
SIZE_nRx2N
) ) &&

2175 
pcCULe·
->
	`isI¡î
–
uiLe·P¨tIdx
 ) ;

2177 i‡–
isAvaûabÀA1
 )

2179 
abC™dIsI¡î
[
iCou¡
] = 
åue
;

2181 
puhI¡îDúNeighbours
[
iCou¡
] = 
pcCULe·
->
	`gëI¡îDú
–
uiLe·P¨tIdx
 );

2183 
TComD©aCU
::
	`gëMvFõld
–
pcCULe·
, 
uiLe·P¨tIdx
, 
REF_PIC_LIST_0
, 
pcMvFõldNeighbours
[
iCou¡
<<1] );

2184 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2186 
TComD©aCU
::
	`gëMvFõld
–
pcCULe·
, 
uiLe·P¨tIdx
, 
REF_PIC_LIST_1
, 
pcMvFõldNeighbours
[(
iCou¡
<<1)+1] );

2188 i‡–
mrgC™dIdx
 =
iCou¡
 )

2190 #i‡
MCTS_ENC_CHECK


2191 
numS∑tülMîgeC™did©es
 = 
iCou¡
 + 1;

2195 
iCou¡
 ++;

2199 i‡(
iCou¡
 =
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2201 #i‡
MCTS_ENC_CHECK


2202 
numS∑tülMîgeC™did©es
 = 
iCou¡
;

2207 
UI¡
 
uiAboveP¨tIdx
 = 0;

2208 c⁄° 
TComD©aCU
 *
pcCUAbove
 = 
	`gëPUAbove
–
uiAboveP¨tIdx
, 
uiP¨tIdxRT
 );

2210 
Boﬁ
 
isAvaûabÀB1
 = 
pcCUAbove
 &&

2211 
pcCUAbove
->
	`isDiffMER
(
xP
+
nPSW
-1, 
yP
-1, xP, yP) &&

2212 !–
uiPUIdx
 =1 && (
cCurPS
 =
SIZE_2NxN
 || cCurPS =
SIZE_2NxnU
 || cCurPS =
SIZE_2NxnD
) ) &&

2213 
pcCUAbove
->
	`isI¡î
–
uiAboveP¨tIdx
 );

2215 i‡–
isAvaûabÀB1
 && (!
isAvaûabÀA1
 || !
pcCULe·
->
	`hasEquÆMŸi⁄
–
uiLe·P¨tIdx
, 
pcCUAbove
, 
uiAboveP¨tIdx
 ) ) )

2217 
abC™dIsI¡î
[
iCou¡
] = 
åue
;

2219 
puhI¡îDúNeighbours
[
iCou¡
] = 
pcCUAbove
->
	`gëI¡îDú
–
uiAboveP¨tIdx
 );

2221 
TComD©aCU
::
	`gëMvFõld
–
pcCUAbove
, 
uiAboveP¨tIdx
, 
REF_PIC_LIST_0
, 
pcMvFõldNeighbours
[
iCou¡
<<1] );

2222 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2224 
TComD©aCU
::
	`gëMvFõld
–
pcCUAbove
, 
uiAboveP¨tIdx
, 
REF_PIC_LIST_1
, 
pcMvFõldNeighbours
[(
iCou¡
<<1)+1] );

2226 i‡–
mrgC™dIdx
 =
iCou¡
 )

2228 #i‡
MCTS_ENC_CHECK


2229 
numS∑tülMîgeC™did©es
 = 
iCou¡
 + 1;

2233 
iCou¡
 ++;

2236 i‡(
iCou¡
 =
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2238 #i‡
MCTS_ENC_CHECK


2239 
numS∑tülMîgeC™did©es
 = 
iCou¡
;

2245 
UI¡
 
uiAboveRightP¨tIdx
 = 0;

2246 c⁄° 
TComD©aCU
 *
pcCUAboveRight
 = 
	`gëPUAboveRight
–
uiAboveRightP¨tIdx
, 
uiP¨tIdxRT
 );

2248 
Boﬁ
 
isAvaûabÀB0
 = 
pcCUAboveRight
 &&

2249 
pcCUAboveRight
->
	`isDiffMER
(
xP
+
nPSW
, 
yP
-1, xP, yP) &&

2250 
pcCUAboveRight
->
	`isI¡î
–
uiAboveRightP¨tIdx
 );

2252 i‡–
isAvaûabÀB0
 && ( !
isAvaûabÀB1
 || !
pcCUAbove
->
	`hasEquÆMŸi⁄
–
uiAboveP¨tIdx
, 
pcCUAboveRight
, 
uiAboveRightP¨tIdx
 ) ) )

2254 
abC™dIsI¡î
[
iCou¡
] = 
åue
;

2256 
puhI¡îDúNeighbours
[
iCou¡
] = 
pcCUAboveRight
->
	`gëI¡îDú
–
uiAboveRightP¨tIdx
 );

2258 
TComD©aCU
::
	`gëMvFõld
–
pcCUAboveRight
, 
uiAboveRightP¨tIdx
, 
REF_PIC_LIST_0
, 
pcMvFõldNeighbours
[
iCou¡
<<1] );

2259 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2261 
TComD©aCU
::
	`gëMvFõld
–
pcCUAboveRight
, 
uiAboveRightP¨tIdx
, 
REF_PIC_LIST_1
, 
pcMvFõldNeighbours
[(
iCou¡
<<1)+1] );

2263 i‡–
mrgC™dIdx
 =
iCou¡
 )

2265 #i‡
MCTS_ENC_CHECK


2266 
numS∑tülMîgeC™did©es
 = 
iCou¡
 + 1;

2270 
iCou¡
 ++;

2273 i‡(
iCou¡
 =
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2275 #i‡
MCTS_ENC_CHECK


2276 
numS∑tülMîgeC™did©es
 = 
iCou¡
;

2282 
UI¡
 
uiLe·BŸtomP¨tIdx
 = 0;

2283 c⁄° 
TComD©aCU
 *
pcCULe·BŸtom
 = 
this
->
	`gëPUBñowLe·
–
uiLe·BŸtomP¨tIdx
, 
uiP¨tIdxLB
 );

2285 
Boﬁ
 
isAvaûabÀA0
 = 
pcCULe·BŸtom
 &&

2286 
pcCULe·BŸtom
->
	`isDiffMER
(
xP
-1, 
yP
+
nPSH
, xP, yP) &&

2287 
pcCULe·BŸtom
->
	`isI¡î
–
uiLe·BŸtomP¨tIdx
 ) ;

2289 i‡–
isAvaûabÀA0
 && ( !
isAvaûabÀA1
 || !
pcCULe·
->
	`hasEquÆMŸi⁄
–
uiLe·P¨tIdx
, 
pcCULe·BŸtom
, 
uiLe·BŸtomP¨tIdx
 ) ) )

2291 
abC™dIsI¡î
[
iCou¡
] = 
åue
;

2293 
puhI¡îDúNeighbours
[
iCou¡
] = 
pcCULe·BŸtom
->
	`gëI¡îDú
–
uiLe·BŸtomP¨tIdx
 );

2295 
TComD©aCU
::
	`gëMvFõld
–
pcCULe·BŸtom
, 
uiLe·BŸtomP¨tIdx
, 
REF_PIC_LIST_0
, 
pcMvFõldNeighbours
[
iCou¡
<<1] );

2296 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2298 
TComD©aCU
::
	`gëMvFõld
–
pcCULe·BŸtom
, 
uiLe·BŸtomP¨tIdx
, 
REF_PIC_LIST_1
, 
pcMvFõldNeighbours
[(
iCou¡
<<1)+1] );

2300 i‡–
mrgC™dIdx
 =
iCou¡
 )

2302 #i‡
MCTS_ENC_CHECK


2303 
numS∑tülMîgeC™did©es
 = 
iCou¡
 + 1;

2307 
iCou¡
 ++;

2310 i‡(
iCou¡
 =
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2312 #i‡
MCTS_ENC_CHECK


2313 
numS∑tülMîgeC™did©es
 = 
iCou¡
;

2319 if–
iCou¡
 < 4 )

2321 
UI¡
 
uiAboveLe·P¨tIdx
 = 0;

2322 c⁄° 
TComD©aCU
 *
pcCUAboveLe·
 = 
	`gëPUAboveLe·
–
uiAboveLe·P¨tIdx
, 
uiAbsP¨tAddr
 );

2324 
Boﬁ
 
isAvaûabÀB2
 = 
pcCUAboveLe·
 &&

2325 
pcCUAboveLe·
->
	`isDiffMER
(
xP
-1, 
yP
-1, xP, yP) &&

2326 
pcCUAboveLe·
->
	`isI¡î
–
uiAboveLe·P¨tIdx
 );

2328 i‡–
isAvaûabÀB2
 && ( !
isAvaûabÀA1
 || !
pcCULe·
->
	`hasEquÆMŸi⁄
–
uiLe·P¨tIdx
, 
pcCUAboveLe·
, 
uiAboveLe·P¨tIdx
 ) )

2329 && ( !
isAvaûabÀB1
 || !
pcCUAbove
->
	`hasEquÆMŸi⁄
–
uiAboveP¨tIdx
, 
pcCUAboveLe·
, 
uiAboveLe·P¨tIdx
 ) ) )

2331 
abC™dIsI¡î
[
iCou¡
] = 
åue
;

2333 
puhI¡îDúNeighbours
[
iCou¡
] = 
pcCUAboveLe·
->
	`gëI¡îDú
–
uiAboveLe·P¨tIdx
 );

2335 
TComD©aCU
::
	`gëMvFõld
–
pcCUAboveLe·
, 
uiAboveLe·P¨tIdx
, 
REF_PIC_LIST_0
, 
pcMvFõldNeighbours
[
iCou¡
<<1] );

2336 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2338 
TComD©aCU
::
	`gëMvFõld
–
pcCUAboveLe·
, 
uiAboveLe·P¨tIdx
, 
REF_PIC_LIST_1
, 
pcMvFõldNeighbours
[(
iCou¡
<<1)+1] );

2340 i‡–
mrgC™dIdx
 =
iCou¡
 )

2342 #i‡
MCTS_ENC_CHECK


2343 
numS∑tülMîgeC™did©es
 = 
iCou¡
 + 1;

2347 
iCou¡
 ++;

2351 i‡(
iCou¡
 =
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2353 #i‡
MCTS_ENC_CHECK


2354 
numS∑tülMîgeC™did©es
 = 
iCou¡
;

2358 #i‡
MCTS_ENC_CHECK


2359 
numS∑tülMîgeC™did©es
 = 
iCou¡
;

2361 i‡–
	`gëSli˚
()->
	`gëE«bÀTMVPFœg
() )

2364 
UI¡
 
uiP¨tIdxRB
;

2366 
	`dîiveRightBŸtomIdx
–
uiPUIdx
, 
uiP¨tIdxRB
 );

2368 
UI¡
 
uiAbsP¨tIdxTmp
 = 
g_auiZsˇnToRa°î
[
uiP¨tIdxRB
];

2369 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

2370 c⁄° 
UI¡
 
numP¨tInCtuHeight
 = 
m_pcPic
->
	`gëNumP¨tInCtuHeight
();

2372 
TComMv
 
cCﬁMv
;

2373 
I¡
 
iRefIdx
;

2374 
I¡
 
˘uRsAddr
 = -1;

2376 i‡–––
m_pcPic
->
	`gëCtu
(
m_˘uRsAddr
)->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[
uiAbsP¨tIdxTmp
] + m_pcPic->
	`gëMöCUWidth
 (ËË< 
m_pcSli˚
->
	`gëSPS
()->
	`gëPicWidthInLumaSam∂es
 () )

2377 && ( ( 
m_pcPic
->
	`gëCtu
(
m_˘uRsAddr
)->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[
uiAbsP¨tIdxTmp
] + m_pcPic->
	`gëMöCUHeight
(ËË< 
m_pcSli˚
->
	`gëSPS
()->
	`gëPicHeightInLumaSam∂es
() ) )

2379 i‡––
uiAbsP¨tIdxTmp
 % 
numP¨tInCtuWidth
 <ÇumPartInCtuWidth - 1 ) &&

2380 –
uiAbsP¨tIdxTmp
 / 
numP¨tInCtuWidth
 < 
numP¨tInCtuHeight
 - 1 ) )

2382 
uiAbsP¨tAddr
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxTmp
 + 
numP¨tInCtuWidth
 + 1 ];

2383 
˘uRsAddr
 = 
	`gëCtuRsAddr
();

2385 i‡–
uiAbsP¨tIdxTmp
 % 
numP¨tInCtuWidth
 <ÇumPartInCtuWidth - 1 )

2387 
uiAbsP¨tAddr
 = 
g_auiRa°îToZsˇn
[ (
uiAbsP¨tIdxTmp
 + 
numP¨tInCtuWidth
 + 1Ë% 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
() ];

2389 i‡–
uiAbsP¨tIdxTmp
 / 
numP¨tInCtuWidth
 < 
numP¨tInCtuHeight
 - 1 )

2391 
uiAbsP¨tAddr
 = 
g_auiRa°îToZsˇn
[ 
uiAbsP¨tIdxTmp
 + 1 ];

2392 
˘uRsAddr
 = 
	`gëCtuRsAddr
() + 1;

2396 
uiAbsP¨tAddr
 = 0;

2400 
iRefIdx
 = 0;

2402 
Boﬁ
 
bExi°MV
 = 
Ál£
;

2403 
UI¡
 
uiP¨tIdxCíãr
;

2404 
I¡
 
dú
 = 0;

2405 
UI¡
 
uiAºayAddr
 = 
iCou¡
;

2406 
	`xDîiveCíãrIdx
–
uiPUIdx
, 
uiP¨tIdxCíãr
 );

2407 
bExi°MV
 = 
˘uRsAddr
 >0 && 
	`xGëCﬁMVP
–
REF_PIC_LIST_0
, ctuRsAddr, 
uiAbsP¨tAddr
, 
cCﬁMv
, 
iRefIdx
 );

2408 if–
bExi°MV
 =
Ál£
 )

2410 
bExi°MV
 = 
	`xGëCﬁMVP
–
REF_PIC_LIST_0
, 
	`gëCtuRsAddr
(), 
uiP¨tIdxCíãr
, 
cCﬁMv
, 
iRefIdx
 );

2412 if–
bExi°MV
 )

2414 
dú
 |= 1;

2415 
pcMvFõldNeighbours
[ 2 * 
uiAºayAddr
 ].
	`£tMvFõld
–
cCﬁMv
, 
iRefIdx
 );

2418 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2420 
bExi°MV
 = 
˘uRsAddr
 >0 && 
	`xGëCﬁMVP
–
REF_PIC_LIST_1
, ctuRsAddr, 
uiAbsP¨tAddr
, 
cCﬁMv
, 
iRefIdx
);

2421 if–
bExi°MV
 =
Ál£
 )

2423 
bExi°MV
 = 
	`xGëCﬁMVP
–
REF_PIC_LIST_1
, 
	`gëCtuRsAddr
(), 
uiP¨tIdxCíãr
, 
cCﬁMv
, 
iRefIdx
 );

2425 if–
bExi°MV
 )

2427 
dú
 |= 2;

2428 
pcMvFõldNeighbours
[ 2 * 
uiAºayAddr
 + 1 ].
	`£tMvFõld
–
cCﬁMv
, 
iRefIdx
 );

2432 i‡(
dú
 != 0)

2434 
puhI¡îDúNeighbours
[
uiAºayAddr
] = 
dú
;

2435 
abC™dIsI¡î
[
uiAºayAddr
] = 
åue
;

2437 i‡–
mrgC™dIdx
 =
iCou¡
 )

2441 
iCou¡
++;

2445 i‡(
iCou¡
 =
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2450 
UI¡
 
uiAºayAddr
 = 
iCou¡
;

2451 
UI¡
 
uiCutoff
 = 
uiAºayAddr
;

2453 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2455 c⁄° 
UI¡
 
NUM_PRIORITY_LIST
=12;

2456 c⁄° 
UI¡
 
uiPri‹ôyLi°0
[
NUM_PRIORITY_LIST
] = {0 , 1, 0, 2, 1, 2, 0, 3, 1, 3, 2, 3};

2457 c⁄° 
UI¡
 
uiPri‹ôyLi°1
[
NUM_PRIORITY_LIST
] = {1 , 0, 2, 0, 2, 1, 3, 0, 3, 1, 3, 2};

2459 
I¡
 
idx
=0; idx<
uiCutoff
*(uiCutoff-1Ë&& 
uiAºayAddr
!
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
(); idx++)

2461 
	`as£π
(
idx
<
NUM_PRIORITY_LIST
);

2462 
I¡
 
i
 = 
uiPri‹ôyLi°0
[
idx
];

2463 
I¡
 
j
 = 
uiPri‹ôyLi°1
[
idx
];

2464 i‡(
abC™dIsI¡î
[
i
] &&ábC™dIsI¡î[
j
]&& (
puhI¡îDúNeighbours
[i]&0x1)&&(puhInterDirNeighbours[j]&0x2))

2466 
abC™dIsI¡î
[
uiAºayAddr
] = 
åue
;

2467 
puhI¡îDúNeighbours
[
uiAºayAddr
] = 3;

2470 
pcMvFõldNeighbours
[
uiAºayAddr
 << 1].
	`£tMvFõld
’cMvFõldNeighbours[
i
<<1].
	`gëMv
(),ÖcMvFõldNeighbours[i<<1].
	`gëRefIdx
());

2471 
pcMvFõldNeighbours
[–
uiAºayAddr
 << 1 ) + 1].
	`£tMvFõld
’cMvFõldNeighbours[(
j
<<1)+1].
	`gëMv
(),ÖcMvFõldNeighbours[(j<<1)+1].
	`gëRefIdx
());

2473 
I¡
 
iRefPOCL0
 = 
m_pcSli˚
->
	`gëRefPOC
–
REF_PIC_LIST_0
, 
pcMvFõldNeighbours
[(
uiAºayAddr
<<1)].
	`gëRefIdx
() );

2474 
I¡
 
iRefPOCL1
 = 
m_pcSli˚
->
	`gëRefPOC
–
REF_PIC_LIST_1
, 
pcMvFõldNeighbours
[(
uiAºayAddr
<<1)+1].
	`gëRefIdx
() );

2475 i‡(
iRefPOCL0
 =
iRefPOCL1
 && 
pcMvFõldNeighbours
[(
uiAºayAddr
<<1)].
	`gëMv
() ==ÖcMvFieldNeighbours[(uiArrayAddr<<1)+1].getMv())

2477 
abC™dIsI¡î
[
uiAºayAddr
] = 
Ál£
;

2481 
uiAºayAddr
++;

2487 i‡(
uiAºayAddr
 =
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2492 
I¡
 
iNumRefIdx
 = (
	`gëSli˚
()->
	`isI¡îB
()Ë? 
	`mö
(
m_pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_0
), m_pcSli˚->gëNumRefIdx(
REF_PIC_LIST_1
)) : m_pcSlice->getNumRefIdx(REF_PIC_LIST_0);

2494 
I¡
 
r
 = 0;

2495 
I¡
 
ªf˙t
 = 0;

2496 
uiAºayAddr
 < 
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
())

2498 
abC™dIsI¡î
[
uiAºayAddr
] = 
åue
;

2499 
puhI¡îDúNeighbours
[
uiAºayAddr
] = 1;

2500 
pcMvFõldNeighbours
[
uiAºayAddr
 << 1].
	`£tMvFõld
–
	`TComMv
(0, 0), 
r
);

2502 i‡–
	`gëSli˚
()->
	`isI¡îB
() )

2504 
puhI¡îDúNeighbours
[
uiAºayAddr
] = 3;

2505 
pcMvFõldNeighbours
[(
uiAºayAddr
 << 1Ë+ 1].
	`£tMvFõld
(
	`TComMv
(0, 0), 
r
);

2507 
uiAºayAddr
++;

2509 i‡–
ªf˙t
 =
iNumRefIdx
 - 1 )

2511 
r
 = 0;

2515 ++
r
;

2516 ++
ªf˙t
;

2519 
numVÆidMîgeC™d
 = 
uiAºayAddr
;

2520 
	}
}

2526 
Boﬁ
 
	gTComD©aCU
::
	$isDiffMER
(
I¡
 
xN
, I¡ 
yN
, I¡ 
xP
, I¡ 
yP
) const

2529 
UI¡
 
∂evñ
 = 
this
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëLog2P¨ÆÀlMîgeLevñMöus2
() + 2;

2530 i‡((
xN
>>
∂evñ
)!(
xP
>>plevel))

2532  
åue
;

2534 i‡((
yN
>>
∂evñ
)!(
yP
>>plevel))

2536  
åue
;

2538  
Ál£
;

2539 
	}
}

2546 
Void
 
	gTComD©aCU
::
	$gëP¨tPosôi⁄
–
UI¡
 
∑πIdx
, 
I¡
& 
xP
, I¡& 
yP
, I¡& 
nPSW
, I¡& 
nPSH
) const

2548 
UI¡
 
cﬁ
 = 
m_uiCUPñX
;

2549 
UI¡
 
row
 = 
m_uiCUPñY
;

2551  
m_≥P¨tSize
[0] )

2553 
SIZE_2NxN
:

2554 
nPSW
 = 
	`gëWidth
(0);

2555 
nPSH
 = 
	`gëHeight
(0) >> 1;

2556 
xP
 = 
cﬁ
;

2557 
yP
 = (
∑πIdx
 ==0)? 
row
:Ñow + 
nPSH
;

2559 
SIZE_Nx2N
:

2560 
nPSW
 = 
	`gëWidth
(0) >> 1;

2561 
nPSH
 = 
	`gëHeight
(0);

2562 
xP
 = (
∑πIdx
 ==0)? 
cﬁ
: cﬁ + 
nPSW
;

2563 
yP
 = 
row
;

2565 
SIZE_NxN
:

2566 
nPSW
 = 
	`gëWidth
(0) >> 1;

2567 
nPSH
 = 
	`gëHeight
(0) >> 1;

2568 
xP
 = 
cﬁ
 + (
∑πIdx
&0x1)*
nPSW
;

2569 
yP
 = 
row
 + (
∑πIdx
>>1)*
nPSH
;

2571 
SIZE_2NxnU
:

2572 
nPSW
 = 
	`gëWidth
(0);

2573 
nPSH
 = ( 
∑πIdx
 =0 ) ? 
	`gëHeight
(0) >> 2 : ( getHeight(0) >> 2 ) + ( getHeight(0) >> 1 );

2574 
xP
 = 
cﬁ
;

2575 
yP
 = (
∑πIdx
 ==0)? 
row
:Ñow + 
	`gëHeight
(0Ë- 
nPSH
;

2578 
SIZE_2NxnD
:

2579 
nPSW
 = 
	`gëWidth
(0);

2580 
nPSH
 = ( 
∑πIdx
 =0 ) ? ( 
	`gëHeight
(0) >> 2 ) + ( getHeight(0) >> 1 ) : getHeight(0) >> 2;

2581 
xP
 = 
cﬁ
;

2582 
yP
 = (
∑πIdx
 ==0)? 
row
:Ñow + 
	`gëHeight
(0Ë- 
nPSH
;

2584 
SIZE_nLx2N
:

2585 
nPSW
 = ( 
∑πIdx
 =0 ) ? 
	`gëWidth
(0) >> 2 : ( getWidth(0) >> 2 ) + ( getWidth(0) >> 1 );

2586 
nPSH
 = 
	`gëHeight
(0);

2587 
xP
 = (
∑πIdx
 ==0)? 
cﬁ
: cﬁ + 
	`gëWidth
(0Ë- 
nPSW
;

2588 
yP
 = 
row
;

2590 
SIZE_nRx2N
:

2591 
nPSW
 = ( 
∑πIdx
 =0 ) ? ( 
	`gëWidth
(0) >> 2 ) + ( getWidth(0) >> 1 ) : getWidth(0) >> 2;

2592 
nPSH
 = 
	`gëHeight
(0);

2593 
xP
 = (
∑πIdx
 ==0)? 
cﬁ
: cﬁ + 
	`gëWidth
(0Ë- 
nPSW
;

2594 
yP
 = 
row
;

2597 
	`as£π
 ( 
m_≥P¨tSize
[0] =
SIZE_2Nx2N
 );

2598 
nPSW
 = 
	`gëWidth
(0);

2599 
nPSH
 = 
	`gëHeight
(0);

2600 
xP
 = 
cﬁ
 ;

2601 
yP
 = 
row
 ;

2605 
	}
}

2614 
Void
 
	gTComD©aCU
::
	$fûlMvpC™d
 ( c⁄° 
UI¡
 
∑πIdx
, c⁄° UI¡ 
∑πAddr
, c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
ªfIdx
, 
AMVPInfo
* 
pInfo
 ) const

2616 
pInfo
->
iN
 = 0;

2617 i‡(
ªfIdx
 < 0)

2619 #i‡
MCTS_ENC_CHECK


2620 
pInfo
->
numS∑tülMVPC™did©es
 = 0;

2626 
UI¡
 
∑πIdxLT
, 
∑πIdxRT
, 
∑πIdxLB
;

2627 
	`dîiveLe·RightT›Idx
–
∑πIdx
, 
∑πIdxLT
, 
∑πIdxRT
 );

2628 
	`dîiveLe·BŸtomIdx
–
∑πIdx
, 
∑πIdxLB
 );

2630 
Boﬁ
 
isSˇÀdFœgLX
 = 
Ál£
;

2632 
UI¡
 
idx
;

2633 c⁄° 
TComD©aCU
* 
tmpCU
 = 
	`gëPUBñowLe·
(
idx
, 
∑πIdxLB
);

2634 
isSˇÀdFœgLX
 = (
tmpCU
 !
NULL
Ë&& (tmpCU->
	`isI¡î
(
idx
));

2635 i‡(!
isSˇÀdFœgLX
)

2637 
tmpCU
 = 
	`gëPULe·
(
idx
, 
∑πIdxLB
);

2638 
isSˇÀdFœgLX
 = (
tmpCU
 !
NULL
Ë&& (tmpCU->
	`isI¡î
(
idx
));

2643 i‡(
isSˇÀdFœgLX
)

2645 
Boﬁ
 
bAdded
 = 
	`xAddMVPC™dUnsˇÀd
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxLB
, 
MD_BELOW_LEFT
);

2646 i‡(!
bAdded
)

2648 
bAdded
 = 
	`xAddMVPC™dUnsˇÀd
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxLB
, 
MD_LEFT
 );

2649 if(!
bAdded
)

2651 
bAdded
 = 
	`xAddMVPC™dWôhSˇlög
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxLB
, 
MD_BELOW_LEFT
);

2652 i‡(!
bAdded
)

2654 
	`xAddMVPC™dWôhSˇlög
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxLB
, 
MD_LEFT
 );

2662 
Boﬁ
 
bAdded
 = 
	`xAddMVPC™dUnsˇÀd
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxRT
, 
MD_ABOVE_RIGHT
);

2663 i‡(!
bAdded
)

2665 
bAdded
 = 
	`xAddMVPC™dUnsˇÀd
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxRT
, 
MD_ABOVE
);

2666 if(!
bAdded
)

2668 
	`xAddMVPC™dUnsˇÀd
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxLT
, 
MD_ABOVE_LEFT
);

2673 if(!
isSˇÀdFœgLX
)

2675 
Boﬁ
 
bAdded
 = 
	`xAddMVPC™dWôhSˇlög
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxRT
, 
MD_ABOVE_RIGHT
);

2676 i‡(!
bAdded
)

2678 
bAdded
 = 
	`xAddMVPC™dWôhSˇlög
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxRT
, 
MD_ABOVE
);

2679 if(!
bAdded
)

2681 
	`xAddMVPC™dWôhSˇlög
–*
pInfo
, 
eRefPicLi°
, 
ªfIdx
, 
∑πIdxLT
, 
MD_ABOVE_LEFT
);

2686 i‡–
pInfo
->
iN
 == 2 )

2688 i‡–
pInfo
->
m_acMvC™d
[ 0 ] ==ÖInfo->m_acMvCand[ 1 ] )

2690 
pInfo
->
iN
 = 1;

2693 #i‡
MCTS_ENC_CHECK


2694 
pInfo
->
numS∑tülMVPC™did©es
 =ÖInfo->
iN
;

2696 i‡(
pInfo
->
iN
 < 
AMVP_MAX_NUM_CANDS
 && 
	`gëSli˚
()->
	`gëE«bÀTMVPFœg
() )

2699 c⁄° 
UI¡
 
numP¨tInCtuWidth
 = 
m_pcPic
->
	`gëNumP¨tInCtuWidth
();

2700 c⁄° 
UI¡
 
numP¨tInCtuHeight
 = 
m_pcPic
->
	`gëNumP¨tInCtuHeight
();

2701 c⁄° 
I¡
 
ªfIdx_Cﬁ
 = 
ªfIdx
;

2702 
TComMv
 
cCﬁMv
;

2703 
UI¡
 
∑πIdxRB
;

2704 
UI¡
 
absP¨tIdx
;

2706 
	`dîiveRightBŸtomIdx
–
∑πIdx
, 
∑πIdxRB
 );

2707 
UI¡
 
absP¨tAddr
 = 
m_absZIdxInCtu
 + 
∑πAddr
;

2710 
absP¨tIdx
 = 
g_auiZsˇnToRa°î
[
∑πIdxRB
];

2711 
I¡
 
˘uRsAddr
 = -1;

2712 i‡–––
m_pcPic
->
	`gëCtu
(
m_˘uRsAddr
)->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[
absP¨tIdx
] + m_pcPic->
	`gëMöCUWidth
 (ËË< 
m_pcSli˚
->
	`gëSPS
()->
	`gëPicWidthInLumaSam∂es
 () )

2713 && ( ( 
m_pcPic
->
	`gëCtu
(
m_˘uRsAddr
)->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[
absP¨tIdx
] + m_pcPic->
	`gëMöCUHeight
(ËË< 
m_pcSli˚
->
	`gëSPS
()->
	`gëPicHeightInLumaSam∂es
() ) )

2715 i‡––
absP¨tIdx
 % 
numP¨tInCtuWidth
 <ÇumPartInCtuWidth - 1 ) &&

2716 –
absP¨tIdx
 / 
numP¨tInCtuWidth
 < 
numP¨tInCtuHeight
 - 1 ) )

2718 
absP¨tAddr
 = 
g_auiRa°îToZsˇn
[ 
absP¨tIdx
 + 
numP¨tInCtuWidth
 + 1 ];

2719 
˘uRsAddr
 = 
	`gëCtuRsAddr
();

2721 i‡–
absP¨tIdx
 % 
numP¨tInCtuWidth
 <ÇumPartInCtuWidth - 1 )

2723 
absP¨tAddr
 = 
g_auiRa°îToZsˇn
[ (
absP¨tIdx
 + 
numP¨tInCtuWidth
 + 1Ë% 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
() ];

2725 i‡–
absP¨tIdx
 / 
numP¨tInCtuWidth
 < 
numP¨tInCtuHeight
 - 1 )

2727 
absP¨tAddr
 = 
g_auiRa°îToZsˇn
[ 
absP¨tIdx
 + 1 ];

2728 
˘uRsAddr
 = 
	`gëCtuRsAddr
() + 1;

2732 
absP¨tAddr
 = 0;

2735 i‡–
˘uRsAddr
 >0 && 
	`xGëCﬁMVP
–
eRefPicLi°
, ctuRsAddr, 
absP¨tAddr
, 
cCﬁMv
, 
ªfIdx_Cﬁ
 ) )

2737 
pInfo
->
m_acMvC™d
[pInfo->
iN
++] = 
cCﬁMv
;

2741 
UI¡
 
uiP¨tIdxCíãr
;

2742 
	`xDîiveCíãrIdx
–
∑πIdx
, 
uiP¨tIdxCíãr
 );

2743 i‡(
	`xGëCﬁMVP
–
eRefPicLi°
, 
	`gëCtuRsAddr
(), 
uiP¨tIdxCíãr
, 
cCﬁMv
, 
ªfIdx_Cﬁ
 ))

2745 
pInfo
->
m_acMvC™d
[pInfo->
iN
++] = 
cCﬁMv
;

2751 
pInfo
->
iN
 < 
AMVP_MAX_NUM_CANDS
)

2753 
pInfo
->
m_acMvC™d
[pInfo->
iN
].
	`£t
(0,0);

2754 
pInfo
->
iN
++;

2757 
	}
}

2760 
Boﬁ
 
	gTComD©aCU
::
	$isBùªdRe°ri˘i⁄
(
UI¡
 
puIdx
) const

2762 
I¡
 
width
 = 0;

2763 
I¡
 
height
 = 0;

2764 
UI¡
 
∑πAddr
;

2766 
	`gëP¨tIndexAndSize
–
puIdx
, 
∑πAddr
, 
width
, 
height
 );

2767 i‡–
	`gëWidth
(0Ë=8 && (
width
 < 8 || 
height
 < 8) )

2769  
åue
;

2771  
Ál£
;

2772 
	}
}

2775 
Void
 
	gTComD©aCU
::
	$˛ùMv
 (
TComMv
& 
rcMv
) const

2777 c⁄° 
TComSPS
 &
•s
=*(
m_pcSli˚
->
	`gëSPS
());

2778 
I¡
 
iMvShi·
 = 2;

2779 
I¡
 
iOff£t
 = 8;

2780 
I¡
 
iH‹Max
 = ( 
•s
.
	`gëPicWidthInLumaSam∂es
(Ë+ 
iOff£t
 - (I¡)
m_uiCUPñX
 - 1 ) << 
iMvShi·
;

2781 
I¡
 
iH‹Mö
 = ( -(I¡)
•s
.
	`gëMaxCUWidth
(Ë- 
iOff£t
 - (I¡)
m_uiCUPñX
 + 1 ) << 
iMvShi·
;

2783 
I¡
 
iVîMax
 = ( 
•s
.
	`gëPicHeightInLumaSam∂es
(Ë+ 
iOff£t
 - (I¡)
m_uiCUPñY
 - 1 ) << 
iMvShi·
;

2784 
I¡
 
iVîMö
 = ( -(I¡)
•s
.
	`gëMaxCUHeight
(Ë- 
iOff£t
 - (I¡)
m_uiCUPñY
 + 1 ) << 
iMvShi·
;

2786 
rcMv
.
	`£tH‹
–
	`mö
 (
iH‹Max
, 
	`max
 (
iH‹Mö
,ÑcMv.
	`gëH‹
())) );

2787 
rcMv
.
	`£tVî
–
	`mö
 (
iVîMax
, 
	`max
 (
iVîMö
,ÑcMv.
	`gëVî
())) );

2788 
	}
}

2791 
UI¡
 
	gTComD©aCU
::
	$gëI¡øSizeIdx
(
UI¡
 
uiAbsP¨tIdx
) const

2793 
UI¡
 
uiShi·
 = ( 
m_≥P¨tSize
[
uiAbsP¨tIdx
]==
SIZE_NxN
 ? 1 : 0 );

2795 
UCh¨
 
uiWidth
 = 
m_puhWidth
[
uiAbsP¨tIdx
]>>
uiShi·
;

2796 
UI¡
 
uiC¡
 = 0;

2797  
uiWidth
 )

2799 
uiC¡
++;

2800 
uiWidth
>>=1;

2802 
uiC¡
-=2;

2803  
uiC¡
 > 6 ? 6 : uiCnt;

2804 
	}
}

2806 
Void
 
	gTComD©aCU
::
	$˛órCbf
–
UI¡
 
uiIdx
, 
Comp⁄ítID
 
compID
, UI¡ 
uiNumP¨ts
 )

2808 
	`mem£t
–&
m_puhCbf
[
compID
][
uiIdx
], 0, (
UCh¨
)*
uiNumP¨ts
);

2809 
	}
}

2817 
Void
 
	gTComD©aCU
::
	$£tIPCMFœgSubP¨ts
 (
Boﬁ
 
bIpcmFœg
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
)

2819 
UI¡
 
uiCuºP¨tNumb
 = 
m_pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
 << 1);

2821 
	`mem£t
(
m_pbIPCMFœg
 + 
uiAbsP¨tIdx
, 
bIpcmFœg
, (
Boﬁ
)*
uiCuºP¨tNumb
 );

2822 
	}
}

2828 
Boﬁ
 
	gTComD©aCU
::
	$isSkù≥d
–
UI¡
 
uiP¨tIdx
 ) const

2830  ( 
	`gëSkùFœg
–
uiP¨tIdx
 ) );

2831 
	}
}

2837 
Boﬁ
 
	gTComD©aCU
::
	$xAddMVPC™dUnsˇÀd
–
AMVPInfo
 &
öfo
, c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
iRefIdx
, c⁄° 
UI¡
 
uiP¨tUnôIdx
, c⁄° 
MVP_DIR
 
eDú
 ) const

2839 c⁄° 
TComD©aCU
* 
√ibCU
 = 
NULL
;

2840 
UI¡
 
√ibPUP¨tIdx
;

2841  
eDú
 )

2843 
MD_LEFT
:

2845 
√ibCU
 = 
	`gëPULe·
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2848 
MD_ABOVE
:

2850 
√ibCU
 = 
	`gëPUAbove
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2853 
MD_ABOVE_RIGHT
:

2855 
√ibCU
 = 
	`gëPUAboveRight
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2858 
MD_BELOW_LEFT
:

2860 
√ibCU
 = 
	`gëPUBñowLe·
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2863 
MD_ABOVE_LEFT
:

2865 
√ibCU
 = 
	`gëPUAboveLe·
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2874 i‡–
√ibCU
 =
NULL
 )

2876  
Ál£
;

2879 c⁄° 
I¡
 
cuºRefPOC
 = 
m_pcSli˚
->
	`gëRefPic
–
eRefPicLi°
, 
iRefIdx
)->
	`gëPOC
();

2880 c⁄° 
RefPicLi°
 
eRefPicLi°2nd
 = (
eRefPicLi°
 =
REF_PIC_LIST_0
Ë? 
REF_PIC_LIST_1
 : REF_PIC_LIST_0;

2882 
I¡
 
¥edi˘‹Sour˚
=0;ÖredictorSource<2;ÖredictorSource++)

2884 c⁄° 
RefPicLi°
 
eRefPicLi°Index
 = (
¥edi˘‹Sour˚
==0Ë? 
eRefPicLi°
 : 
eRefPicLi°2nd
;

2885 c⁄° 
I¡
 
√ibRefIdx
 = 
√ibCU
->
	`gëCUMvFõld
(
eRefPicLi°Index
)->
	`gëRefIdx
(
√ibPUP¨tIdx
);

2887 i‡–
√ibRefIdx
 >0 && 
cuºRefPOC
 =
√ibCU
->
	`gëSli˚
()->
	`gëRefPOC
–
eRefPicLi°Index
,ÇeibRefIdx ))

2889 
öfo
.
m_acMvC™d
[öfo.
iN
++] = 
√ibCU
->
	`gëCUMvFõld
(
eRefPicLi°Index
)->
	`gëMv
(
√ibPUP¨tIdx
);

2890  
åue
;

2894  
Ál£
;

2895 
	}
}

2905 
Boﬁ
 
	gTComD©aCU
::
	$xAddMVPC™dWôhSˇlög
–
AMVPInfo
 &
öfo
, c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
iRefIdx
, c⁄° 
UI¡
 
uiP¨tUnôIdx
, c⁄° 
MVP_DIR
 
eDú
 ) const

2907 c⁄° 
TComD©aCU
* 
√ibCU
 = 
NULL
;

2908 
UI¡
 
√ibPUP¨tIdx
;

2909  
eDú
 )

2911 
MD_LEFT
:

2913 
√ibCU
 = 
	`gëPULe·
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2916 
MD_ABOVE
:

2918 
√ibCU
 = 
	`gëPUAbove
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2921 
MD_ABOVE_RIGHT
:

2923 
√ibCU
 = 
	`gëPUAboveRight
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2926 
MD_BELOW_LEFT
:

2928 
√ibCU
 = 
	`gëPUBñowLe·
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2931 
MD_ABOVE_LEFT
:

2933 
√ibCU
 = 
	`gëPUAboveLe·
(
√ibPUP¨tIdx
, 
uiP¨tUnôIdx
);

2942 i‡–
√ibCU
 =
NULL
 )

2944  
Ál£
;

2947 c⁄° 
RefPicLi°
 
eRefPicLi°2nd
 = (
eRefPicLi°
 =
REF_PIC_LIST_0
Ë? 
REF_PIC_LIST_1
 : REF_PIC_LIST_0;

2949 c⁄° 
I¡
 
cuºPOC
 = 
m_pcSli˚
->
	`gëPOC
();

2950 c⁄° 
I¡
 
cuºRefPOC
 = 
m_pcSli˚
->
	`gëRefPic
–
eRefPicLi°
, 
iRefIdx
)->
	`gëPOC
();

2951 c⁄° 
Boﬁ
 
bIsCuºRefL⁄gTîm
 = 
m_pcSli˚
->
	`gëRefPic
–
eRefPicLi°
, 
iRefIdx
)->
	`gëIsL⁄gTîm
();

2952 c⁄° 
I¡
 
√ibPOC
 = 
cuºPOC
;

2954 
I¡
 
¥edi˘‹Sour˚
=0;ÖredictorSource<2;ÖredictorSource++)

2956 c⁄° 
RefPicLi°
 
eRefPicLi°Index
 = (
¥edi˘‹Sour˚
==0Ë? 
eRefPicLi°
 : 
eRefPicLi°2nd
;

2957 c⁄° 
I¡
 
√ibRefIdx
 = 
√ibCU
->
	`gëCUMvFõld
(
eRefPicLi°Index
)->
	`gëRefIdx
(
√ibPUP¨tIdx
);

2958 if–
√ibRefIdx
 >= 0)

2960 c⁄° 
Boﬁ
 
bIsNeibRefL⁄gTîm
 = 
√ibCU
->
	`gëSli˚
()->
	`gëRefPic
–
eRefPicLi°Index
, 
√ibRefIdx
 )->
	`gëIsL⁄gTîm
();

2962 i‡–
bIsCuºRefL⁄gTîm
 =
bIsNeibRefL⁄gTîm
 )

2964 c⁄° 
TComMv
 &
cMvPªd
 = 
√ibCU
->
	`gëCUMvFõld
(
eRefPicLi°Index
)->
	`gëMv
(
√ibPUP¨tIdx
);

2965 
TComMv
 
rcMv
;

2966 i‡–
bIsCuºRefL⁄gTîm
 )

2968 
rcMv
 = 
cMvPªd
;

2972 c⁄° 
I¡
 
√ibRefPOC
 = 
√ibCU
->
	`gëSli˚
()->
	`gëRefPOC
–
eRefPicLi°Index
, 
√ibRefIdx
 );

2973 c⁄° 
I¡
 
sˇÀ
 = 
	`xGëDi°SˇÀFa˘‹
–
cuºPOC
, 
cuºRefPOC
, 
√ibPOC
, 
√ibRefPOC
 );

2974 i‡–
sˇÀ
 == 4096 )

2976 
rcMv
 = 
cMvPªd
;

2980 
rcMv
 = 
cMvPªd
.
	`sˇÀMv
–
sˇÀ
 );

2984 
öfo
.
m_acMvC™d
[öfo.
iN
++] = 
rcMv
;

2985  
åue
;

2989  
Ál£
;

2990 
	}
}

2992 
Boﬁ
 
	gTComD©aCU
::
	$xGëCﬁMVP
–c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
˘uRsAddr
, c⁄° I¡ 
∑πUnôIdx
, 
TComMv
& 
rcMv
, c⁄° I¡ 
ªfIdx
 ) const

2994 c⁄° 
UI¡
 
absP¨tAddr
 = 
∑πUnôIdx
;

2997 c⁄° 
TComPic
 * c⁄° 
pCﬁPic
 = 
	`gëSli˚
()->
	`gëRefPic
–
	`RefPicLi°
(gëSli˚()->
	`isI¡îB
(Ë? 1-gëSli˚()->
	`gëCﬁFromL0Fœg
(Ë: 0), gëSli˚()->
	`gëCﬁRefIdx
());

2998 #i‡
REDUCED_ENCODER_MEMORY


2999 i‡(!
pCﬁPic
->
	`gëPicSym
()->
	`hasDPBPîCtuD©a
())

3001  
Ál£
;

3003 c⁄° 
TComPicSym
::
DPBPîCtuD©a
 * c⁄° 
pCﬁDpbCtu
 = &(
pCﬁPic
->
	`gëPicSym
()->
	`gëDPBPîCtuD©a
(
˘uRsAddr
));

3004 c⁄° 
TComSli˚
 * c⁄° 
pCﬁSli˚
 = 
pCﬁDpbCtu
->
	`gëSli˚
();

3005 if(
pCﬁDpbCtu
->
	`gëP¨tôi⁄Size
(
∑πUnôIdx
)==
NUMBER_OF_PART_SIZES
)

3007 c⁄° 
TComD©aCU
 * c⁄° 
pCﬁCtu
 = 
pCﬁPic
->
	`gëCtu
–
˘uRsAddr
 );

3008 if(
pCﬁCtu
->
	`gëPic
()==0 ||ÖCﬁCtu->
	`gëP¨tôi⁄Size
(
∑πUnôIdx
)==
NUMBER_OF_PART_SIZES
)

3011  
Ál£
;

3014 #i‡
REDUCED_ENCODER_MEMORY


3015 i‡(!
pCﬁDpbCtu
->
	`isI¡î
(
absP¨tAddr
))

3017 i‡(!
pCﬁCtu
->
	`isI¡î
(
absP¨tAddr
))

3020  
Ál£
;

3023 
RefPicLi°
 
eCﬁRefPicLi°
 = 
	`gëSli˚
()->
	`gëCheckLDC
(Ë? 
eRefPicLi°
 : 
	`RefPicLi°
(gëSli˚()->
	`gëCﬁFromL0Fœg
());

3024 #i‡
REDUCED_ENCODER_MEMORY


3025 
I¡
 
iCﬁRefIdx
 = 
pCﬁDpbCtu
->
	`gëCUMvFõld
(
	`RefPicLi°
(
eCﬁRefPicLi°
))->
	`gëRefIdx
(
absP¨tAddr
);

3027 
I¡
 
iCﬁRefIdx
 = 
pCﬁCtu
->
	`gëCUMvFõld
(
	`RefPicLi°
(
eCﬁRefPicLi°
))->
	`gëRefIdx
(
absP¨tAddr
);

3030 i‡(
iCﬁRefIdx
 < 0 )

3032 
eCﬁRefPicLi°
 = 
	`RefPicLi°
(1 -ÉColRefPicList);

3033 #i‡
REDUCED_ENCODER_MEMORY


3034 
iCﬁRefIdx
 = 
pCﬁDpbCtu
->
	`gëCUMvFõld
(
	`RefPicLi°
(
eCﬁRefPicLi°
))->
	`gëRefIdx
(
absP¨tAddr
);

3036 
iCﬁRefIdx
 = 
pCﬁCtu
->
	`gëCUMvFõld
(
	`RefPicLi°
(
eCﬁRefPicLi°
))->
	`gëRefIdx
(
absP¨tAddr
);

3039 i‡(
iCﬁRefIdx
 < 0 )

3041  
Ál£
;

3045 c⁄° 
Boﬁ
 
bIsCuºRefL⁄gTîm
 = 
m_pcSli˚
->
	`gëRefPic
(
eRefPicLi°
, 
ªfIdx
)->
	`gëIsL⁄gTîm
();

3046 #i‡
REDUCED_ENCODER_MEMORY


3047 c⁄° 
Boﬁ
 
bIsCﬁRefL⁄gTîm
 = 
pCﬁSli˚
->
	`gëIsU£dAsL⁄gTîm
(
eCﬁRefPicLi°
, 
iCﬁRefIdx
);

3049 c⁄° 
Boﬁ
 
bIsCﬁRefL⁄gTîm
 = 
pCﬁCtu
->
	`gëSli˚
()->
	`gëIsU£dAsL⁄gTîm
(
eCﬁRefPicLi°
, 
iCﬁRefIdx
);

3052 i‡–
bIsCuºRefL⁄gTîm
 !
bIsCﬁRefL⁄gTîm
 )

3054  
Ál£
;

3058 #i‡
REDUCED_ENCODER_MEMORY


3059 c⁄° 
TComMv
 &
cCﬁMv
 = 
pCﬁDpbCtu
->
	`gëCUMvFõld
(
eCﬁRefPicLi°
)->
	`gëMv
(
absP¨tAddr
);

3061 c⁄° 
TComMv
 &
cCﬁMv
 = 
pCﬁCtu
->
	`gëCUMvFõld
(
eCﬁRefPicLi°
)->
	`gëMv
(
absP¨tAddr
);

3063 i‡–
bIsCuºRefL⁄gTîm
 )

3065 
rcMv
 = 
cCﬁMv
;

3069 c⁄° 
I¡
 
cuºPOC
 = 
m_pcSli˚
->
	`gëPOC
();

3070 #i‡
REDUCED_ENCODER_MEMORY


3071 c⁄° 
I¡
 
cﬁPOC
 = 
pCﬁSli˚
->
	`gëPOC
();

3072 c⁄° 
I¡
 
cﬁRefPOC
 = 
pCﬁSli˚
->
	`gëRefPOC
(
eCﬁRefPicLi°
, 
iCﬁRefIdx
);

3074 c⁄° 
I¡
 
cﬁPOC
 = 
pCﬁCtu
->
	`gëSli˚
()->
	`gëPOC
();

3075 c⁄° 
I¡
 
cﬁRefPOC
 = 
pCﬁCtu
->
	`gëSli˚
()->
	`gëRefPOC
(
eCﬁRefPicLi°
, 
iCﬁRefIdx
);

3077 c⁄° 
I¡
 
cuºRefPOC
 = 
m_pcSli˚
->
	`gëRefPic
(
eRefPicLi°
, 
ªfIdx
)->
	`gëPOC
();

3078 c⁄° 
I¡
 
sˇÀ
 = 
	`xGëDi°SˇÀFa˘‹
(
cuºPOC
, 
cuºRefPOC
, 
cﬁPOC
, 
cﬁRefPOC
);

3079 i‡–
sˇÀ
 == 4096 )

3081 
rcMv
 = 
cCﬁMv
;

3085 
rcMv
 = 
cCﬁMv
.
	`sˇÀMv
–
sˇÀ
 );

3089  
åue
;

3090 
	}
}

3093 
I¡
 
	gTComD©aCU
::
	$xGëDi°SˇÀFa˘‹
(
I¡
 
iCuºPOC
, I¡ 
iCuºRefPOC
, I¡ 
iCﬁPOC
, I¡ 
iCﬁRefPOC
)

3095 
I¡
 
iDiffPocD
 = 
iCﬁPOC
 - 
iCﬁRefPOC
;

3096 
I¡
 
iDiffPocB
 = 
iCuºPOC
 - 
iCuºRefPOC
;

3098 if–
iDiffPocD
 =
iDiffPocB
 )

3104 
I¡
 
iTDB
 = 
	`Clù3
–-128, 127, 
iDiffPocB
 );

3105 
I¡
 
iTDD
 = 
	`Clù3
–-128, 127, 
iDiffPocD
 );

3106 
I¡
 
iX
 = (0x4000 + 
	`abs
(
iTDD
/2)) / iTDD;

3107 
I¡
 
iSˇÀ
 = 
	`Clù3
–-4096, 4095, (
iTDB
 * 
iX
 + 32) >> 6 );

3108  
iSˇÀ
;

3110 
	}
}

3112 
Void
 
	gTComD©aCU
::
	$xDîiveCíãrIdx
–
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxCíãr
 ) const

3114 
UI¡
 
uiP¨tAddr
;

3115 
I¡
 
iP¨tWidth
;

3116 
I¡
 
iP¨tHeight
;

3117 
	`gëP¨tIndexAndSize
–
uiP¨tIdx
, 
uiP¨tAddr
, 
iP¨tWidth
, 
iP¨tHeight
);

3119 
ruiP¨tIdxCíãr
 = 
m_absZIdxInCtu
+
uiP¨tAddr
;

3120 
ruiP¨tIdxCíãr
 = 
g_auiRa°îToZsˇn
[ 
g_auiZsˇnToRa°î
[ÑuiPartIdxCenter ]

3121 + ( 
iP¨tHeight
/
m_pcPic
->
	`gëMöCUHeight
(Ë)/2*m_pcPic->
	`gëNumP¨tInCtuWidth
()

3122 + ( 
iP¨tWidth
/
m_pcPic
->
	`gëMöCUWidth
() )/2];

3123 
	}
}

3125 
Void
 
	gTComD©aCU
::
	$com¥essMV
()

3127 #i‡
REDUCED_ENCODER_MEMORY


3128 c⁄° 
I¡
 
sˇÀFa˘‹
 = 
°d
::
max
<I¡>(1,4 * 
AMVP_DECIMATION_FACTOR
 / 
m_unôSize
);

3129 
TComPicSym
 &
picSym
=*(
	`gëPic
()->
	`gëPicSym
());

3130 
TComPicSym
::
DPBPîCtuD©a
 &
dpbF‹Ctu
=
picSym
.
	`gëDPBPîCtuD©a
(
	`gëCtuRsAddr
());

3132 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

3134 
dpbF‹Ctu
.
m_CUMvFõld
[
i
].
	`com¥ess
(dpbF‹Ctu.
m_≥PªdMode
, m_≥PªdMode, 
sˇÀFa˘‹
,
m_acCUMvFõld
[i]);

3135 
	`mem˝y
(
dpbF‹Ctu
.
m_≥P¨tSize
, m_≥P¨tSize, (*m_≥P¨tSize)*
m_uiNumP¨tôi⁄
);

3136 
dpbF‹Ctu
.
m_pSli˚
 = 
	`gëSli˚
();

3139 
I¡
 
sˇÀFa˘‹
 = 4 * 
AMVP_DECIMATION_FACTOR
 / 
m_unôSize
;

3140 i‡(
sˇÀFa˘‹
 > 0)

3142 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

3144 
m_acCUMvFõld
[
i
].
	`com¥ess
(
m_≥PªdMode
, 
sˇÀFa˘‹
);

3148 
	}
}

3150 
UI¡
 
	gTComD©aCU
::
	$gëC€fSˇnIdx
(c⁄° 
UI¡
 
uiAbsP¨tIdx
, c⁄° UI¡ 
uiWidth
, c⁄° UI¡ 
uiHeight
, c⁄° 
Comp⁄ítID
 
compID
) const

3156 i‡(!
	`isI¡ø
(
uiAbsP¨tIdx
))

3158  
SCAN_DIAG
;

3165 c⁄° 
ChromaF‹m©
 
f‹m©
 = 
	`gëPic
()->
	`gëChromaF‹m©
();

3167 c⁄° 
UI¡
 
maximumWidth
 = 
MDCS_MAXIMUM_WIDTH
 >> 
	`gëComp⁄ítSˇÀX
(
compID
, 
f‹m©
);

3168 c⁄° 
UI¡
 
maximumHeight
 = 
MDCS_MAXIMUM_HEIGHT
 >> 
	`gëComp⁄ítSˇÀY
(
compID
, 
f‹m©
);

3170 i‡((
uiWidth
 > 
maximumWidth
Ë|| (
uiHeight
 > 
maximumHeight
))

3172  
SCAN_DIAG
;

3179 
UI¡
 
uiDúMode
 = 
	`gëI¡øDú
(
	`toCh™√lTy≥
(
compID
), 
uiAbsP¨tIdx
);

3181 i‡(
uiDúMode
==
DM_CHROMA_IDX
)

3183 c⁄° 
TComSPS
 *
•s
=
	`gëSli˚
()->
	`gëSPS
();

3184 c⁄° 
UI¡
 
∑πsPîMöCU
 = 1<<(2*(
•s
->
	`gëMaxTŸÆCUDïth
(Ë- sps->
	`gëLog2DiffMaxMöCodögBlockSize
()));

3185 
uiDúMode
 = 
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
	`gëChromasC‹ª•⁄dögPULumaIdx
(
uiAbsP¨tIdx
, 
	`gëPic
()->
	`gëChromaF‹m©
(), 
∑πsPîMöCU
));

3188 i‡(
	`isChroma
(
compID
Ë&& (
f‹m©
 =
CHROMA_422
))

3190 
uiDúMode
 = 
g_chroma422I¡øAngÀM≠pögTabÀ
[uiDirMode];

3195 i‡(
	`abs
((
I¡
)
uiDúMode
 - 
VER_IDX
Ë<
MDCS_ANGLE_LIMIT
)

3197  
SCAN_HOR
;

3199 i‡(
	`abs
((
I¡
)
uiDúMode
 - 
HOR_IDX
Ë<
MDCS_ANGLE_LIMIT
)

3201  
SCAN_VER
;

3205  
SCAN_DIAG
;

3207 
	}
}

3209 #i‡
MCTS_ENC_CHECK


3210 
Boﬁ
 
	gTComD©aCU
::
	$isLa°CﬁumnCTUInTûe
() const

3212 
UI¡
 
cuºítTûeIdx
 = 
this
->
	`gëPic
()->
	`gëPicSym
()->
	`gëTûeIdxM≠
—his->
	`gëCtuRsAddr
());

3213 
TComTûe
 *
pCuºítTûe
 = 
m_pcPic
->
	`gëPicSym
()->
	`gëTComTûe
(
cuºítTûeIdx
);

3214 
UI¡
 
‰ameWidthInCtus
 = 
m_pcPic
->
	`gëPicSym
()->
	`gëFømeWidthInCtus
();

3215 
UI¡
 
rightEdgeCTUPosInCuºítTûe
 = 
pCuºítTûe
->
	`gëRightEdgePosInCtus
();

3216 
UI¡
 
˘uXPosInCtus
 = 
this
->
	`gëCtuRsAddr
(Ë% 
‰ameWidthInCtus
;

3218  (
rightEdgeCTUPosInCuºítTûe
 =
˘uXPosInCtus
);

3219 
	}
}

	@TLibCommon/TComDataCU.h

39 #i‚de‡
__TCOMDATACU__


40 
	#__TCOMDATACU__


	)

42 
	~<Æg‹ôhm
>

43 
	~<ve˘‹
>

46 
	~"Comm⁄Def.h
"

47 
	~"TComMŸi⁄Info.h
"

48 
	~"TComSli˚.h
"

49 
	~"TComRdCo°.h
"

50 
	~"TComP©ã∫.h
"

55 
˛ass
 
	gTComTU
;

57 c⁄° 
UI¡
 
	gNUM_MOST_PROBABLE_MODES
=3;

64 ˛as†
	cTComD©aCU


66 
	mpublic
:

72 
TComPic
* 
m_pcPic
;

73 
TComSli˚
* 
	mm_pcSli˚
;

79 
UI¡
 
	mm_˘uRsAddr
;

80 
UI¡
 
	mm_absZIdxInCtu
;

81 
UI¡
 
	mm_uiCUPñX
;

82 
UI¡
 
	mm_uiCUPñY
;

83 
UI¡
 
	mm_uiNumP¨tôi⁄
;

84 
UCh¨
* 
	mm_puhWidth
;

85 
UCh¨
* 
	mm_puhHeight
;

86 
UCh¨
* 
	mm_puhDïth
;

87 
I¡
 
	mm_unôSize
;

93 
Boﬁ
* 
	mm_skùFœg
;

94 
SCh¨
* 
	mm_≥P¨tSize
;

95 
SCh¨
* 
	mm_≥PªdMode
;

96 
SCh¨
* 
	mm_¸ossComp⁄ítPªdi˘i⁄AÕha
[
MAX_NUM_COMPONENT
];

97 
Boﬁ
* 
	mm_CUTønsqu™tBy∑ss
;

98 
SCh¨
* 
	mm_phQP
;

99 
UCh¨
* 
	mm_ChromaQpAdj
;

100 
UI¡
 
	mm_codedChromaQpAdj
;

101 
UCh¨
* 
	mm_puhTrIdx
;

102 
UCh¨
* 
	mm_puhTønsf‹mSkù
[
MAX_NUM_COMPONENT
];

103 
UCh¨
* 
	mm_puhCbf
[
MAX_NUM_COMPONENT
];

104 
TComCUMvFõld
 
	mm_acCUMvFõld
[
NUM_REF_PIC_LIST_01
];

105 
TC€ff
* 
	mm_pcTrC€ff
[
MAX_NUM_COMPONENT
];

106 #i‡
ADAPTIVE_QP_SELECTION


107 
TC€ff
* 
	mm_pcAæC€ff
[
MAX_NUM_COMPONENT
];

108 
Boﬁ
 
	mm_AæC€ffIsAlü£dAŒoˇti⁄
;

111 
Pñ
* 
	mm_pcIPCMSam∂e
[
MAX_NUM_COMPONENT
];

117 
TComD©aCU
* 
	mm_pCtuAboveLe·
;

118 
TComD©aCU
* 
	mm_pCtuAboveRight
;

119 
TComD©aCU
* 
	mm_pCtuAbove
;

120 
TComD©aCU
* 
	mm_pCtuLe·
;

121 
TComMvFõld
 
	mm_cMvFõldA
;

122 
TComMvFõld
 
	mm_cMvFõldB
;

123 
TComMvFõld
 
	mm_cMvFõldC
;

124 
TComMv
 
	mm_cMvPªd
;

130 
Boﬁ
* 
	mm_pbMîgeFœg
;

131 
UCh¨
* 
	mm_puhMîgeIndex
;

132 #i‡
AMP_MRG


133 
Boﬁ
 
	mm_bIsMîgeAMP
;

135 
UCh¨
* 
	mm_puhI¡øDú
[
MAX_NUM_CHANNEL_TYPE
];

136 
UCh¨
* 
	mm_puhI¡îDú
;

137 
SCh¨
* 
	mm_≠iMVPIdx
[
NUM_REF_PIC_LIST_01
];

138 
SCh¨
* 
	mm_≠iMVPNum
[
NUM_REF_PIC_LIST_01
];

139 
Boﬁ
* 
	mm_pbIPCMFœg
;

140 #i‡
MCTS_ENC_CHECK


141 
Boﬁ
 
	mm_tM˘sMvpIsVÆid
;

148 
Boﬁ
 
	mm_bDecSubCu
;

149 
DoubÀ
 
	mm_dTŸÆCo°
;

150 
Di°‹ti⁄
 
	mm_uiTŸÆDi°‹ti⁄
;

151 
UI¡
 
	mm_uiTŸÆBôs
;

152 
UI¡
 
	mm_uiTŸÆBös
;

153 
SCh¨
 
	mm_codedQP
;

154 
UCh¨
* 
	mm_ex∂icôRdpcmMode
[
MAX_NUM_COMPONENT
];

156 
	m¥Ÿe˘ed
:

159 
Boﬁ
 
	$xAddMVPC™dUnsˇÀd
 ( 
AMVPInfo
 &
öfo
, c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
iRefIdx
, c⁄° 
UI¡
 
uiP¨tUnôIdx
, c⁄° 
MVP_DIR
 
eDú
 ) const;

160 
Boﬁ
 
	$xAddMVPC™dWôhSˇlög
 ( 
AMVPInfo
 &
öfo
, c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
iRefIdx
, c⁄° 
UI¡
 
uiP¨tUnôIdx
, c⁄° 
MVP_DIR
 
eDú
 ) const;

162 
Void
 
	$dîiveRightBŸtomIdx
 ( 
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxRB
 ) const;

163 
Boﬁ
 
	$xGëCﬁMVP
 ( c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
˘uRsAddr
, c⁄° I¡ 
∑πUnôIdx
, 
TComMv
& 
rcMv
, c⁄° I¡ 
ªfIdx
 ) const;

166 
I¡
 
	`xGëDi°SˇÀFa˘‹
 ( I¡ 
iCuºPOC
, I¡ 
iCuºRefPOC
, I¡ 
iCﬁPOC
, I¡ 
iCﬁRefPOC
 );

168 
Void
 
	$xDîiveCíãrIdx
 ( 
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxCíãr
 ) const;

170 
public
:

171 
	`TComD©aCU
();

172 
vútuÆ
 ~
	`TComD©aCU
();

178 
Void
 
	`¸óã
 ( 
ChromaF‹m©
 
chromaF‹m©IDC
, 
UI¡
 
uiNumP¨tôi⁄
, UI¡ 
uiWidth
, UI¡ 
uiHeight
, 
Boﬁ
 
bDecSubCu
, 
I¡
 
unôSize


179 #i‡
ADAPTIVE_QP_SELECTION


180 , 
TC€ff
 *
pP¨ítARLBuf„r
 = 0

183 
Void
 
	`de°roy
 ( );

185 
Void
 
	`öôCtu
 ( 
TComPic
* 
pcPic
, 
UI¡
 
˘uRsAddr
 );

186 
Void
 
	`öôE°D©a
 ( c⁄° 
UI¡
 
uiDïth
, c⁄° 
I¡
 
qp
, c⁄° 
Boﬁ
 
bTønsqu™tBy∑ss
 );

187 
Void
 
	`öôSubCU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tUnôIdx
, UI¡ 
uiDïth
, 
I¡
 
qp
 );

188 
Void
 
	`£tOutsideCUP¨t
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

190 
Void
 
	`c›ySubCU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tUnôIdx
 );

191 
Void
 
	`c›yI¡îPªdInfoFrom
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefPicLi°
 );

192 
Void
 
	`c›yP¨tFrom
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tUnôIdx
, UI¡ 
uiDïth
 );

194 
Void
 
	`c›yToPic
 ( 
UCh¨
 
uiDïth
 );

200 
TComPic
* 
	$gëPic
 ( ) {  
m_pcPic
; }

201 c⁄° 
TComPic
* 
	$gëPic
 ( ) c⁄° {  
m_pcPic
; 
	}
}

202 
TComSli˚
* 
	$gëSli˚
 ( ) {  
m_pcSli˚
; 
	}
}

203 c⁄° 
TComSli˚
* 
	$gëSli˚
 ( ) c⁄° {  
m_pcSli˚
; 
	}
}

204 
	gUI¡
& 
	$gëCtuRsAddr
 ( ) {  
m_˘uRsAddr
; 
	}
}

205 
UI¡
 
	$gëCtuRsAddr
 ( ) c⁄° {  
m_˘uRsAddr
; 
	}
}

206 
UI¡
 
	$gëZ‹dîIdxInCtu
 ( ) c⁄° {  
m_absZIdxInCtu
; 
	}
}

207 
UI¡
 
	$gëCUPñX
 ( ) c⁄° {  
m_uiCUPñX
; 
	}
}

208 
UI¡
 
	$gëCUPñY
 ( ) c⁄° {  
m_uiCUPñY
; 
	}
}

210 
UCh¨
* 
	$gëDïth
 ( ) {  
m_puhDïth
; 
	}
}

211 
UCh¨
 
	$gëDïth
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_puhDïth
[uiIdx]; 
	}
}

212 
Void
 
	$£tDïth
 ( 
UI¡
 
uiIdx
, 
UCh¨
 
uh
 ) { 
m_puhDïth
[uiIdx] = uh; 
	}
}

214 
Void
 
£tDïthSubP¨ts
 ( 
UI¡
 
uiDïth
, UI¡ 
uiAbsP¨tIdx
 );

216 #i‡
MCTS_ENC_CHECK


217 
Void
 
	$£tTM˘sMvpIsVÆid
(
Boﬁ
 
b
Ë{ 
m_tM˘sMvpIsVÆid
 = b; 
	}
}

218 
Boﬁ
 
	$gëTM˘sMvpIsVÆid
(Ë{  
m_tM˘sMvpIsVÆid
; 
	}
}

219 
Boﬁ
 
	$isLa°CﬁumnCTUInTûe
() const;

226 
SCh¨
* 
	$gëP¨tôi⁄Size
 ( ) {  
m_≥P¨tSize
; 
	}
}

227 
P¨tSize
 
	$gëP¨tôi⁄Size
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
°©ic_ˇ°
<
P¨tSize
>–
m_≥P¨tSize
[uiIdx] ); 
	}
}

228 
Void
 
	$£tP¨tôi⁄Size
 ( 
UI¡
 
uiIdx
, 
P¨tSize
 
uh
 ) { 
m_≥P¨tSize
[uiIdx] = uh; 
	}
}

229 
Void
 
£tP¨tSizeSubP¨ts
 ( 
P¨tSize
 
eMode
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

230 
Void
 
£tCUTønsqu™tBy∑ssSubP¨ts
 ( 
Boﬁ
 
Êag
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

232 
Boﬁ
* 
	$gëSkùFœg
 ( ) {  
m_skùFœg
; 
	}
}

233 
Boﬁ
 
	$gëSkùFœg
 ( 
UI¡
 
idx
 ) c⁄° {  
m_skùFœg
[idx]; 
	}
}

234 
Void
 
	$£tSkùFœg
 ( 
UI¡
 
idx
, 
Boﬁ
 
skù
 ) { 
m_skùFœg
[idx] = skù; 
	}
}

235 
Void
 
£tSkùFœgSubP¨ts
 ( 
Boﬁ
 
skù
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
 );

237 
SCh¨
* 
	$gëPªdi˘i⁄Mode
 ( ) {  
m_≥PªdMode
; 
	}
}

238 
PªdMode
 
	$gëPªdi˘i⁄Mode
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
°©ic_ˇ°
<
PªdMode
>–
m_≥PªdMode
[uiIdx] ); 
	}
}

239 
Void
 
	$£tPªdi˘i⁄Mode
 ( 
UI¡
 
uiIdx
, 
PªdMode
 
uh
 ) { 
m_≥PªdMode
[uiIdx] = uh; 
	}
}

240 
Void
 
£tPªdModeSubP¨ts
 ( 
PªdMode
 
eMode
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

242 
SCh¨
* 
	$gëCrossComp⁄ítPªdi˘i⁄AÕha
–
Comp⁄ítID
 
compID
 ) {  
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[compID]; 
	}
}

243 
SCh¨
 
	$gëCrossComp⁄ítPªdi˘i⁄AÕha
–
UI¡
 
uiIdx
, 
Comp⁄ítID
 
compID
 ) {  
m_¸ossComp⁄ítPªdi˘i⁄AÕha
[compID][uiIdx]; 
	}
}

245 
Boﬁ
* 
	$gëCUTønsqu™tBy∑ss
 ( ) {  
m_CUTønsqu™tBy∑ss
; 
	}
}

246 
Boﬁ
 
	$gëCUTønsqu™tBy∑ss
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_CUTønsqu™tBy∑ss
[uiIdx]; 
	}
}

248 
UCh¨
* 
	$gëWidth
 ( ) {  
m_puhWidth
; 
	}
}

249 
UCh¨
 
	$gëWidth
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_puhWidth
[uiIdx]; 
	}
}

250 
Void
 
	$£tWidth
 ( 
UI¡
 
uiIdx
, 
UCh¨
 
uh
 ) { 
m_puhWidth
[uiIdx] = uh; 
	}
}

252 
UCh¨
* 
	$gëHeight
 ( ) {  
m_puhHeight
; 
	}
}

253 
UCh¨
 
	$gëHeight
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_puhHeight
[uiIdx]; 
	}
}

254 
Void
 
	$£tHeight
 ( 
UI¡
 
uiIdx
, 
UCh¨
 
uh
 ) { 
m_puhHeight
[uiIdx] = uh; 
	}
}

256 
Void
 
£tSizeSubP¨ts
 ( 
UI¡
 
uiWidth
, UI¡ 
uiHeight
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

258 
SCh¨
* 
	$gëQP
 ( ) {  
m_phQP
; 
	}
}

259 
SCh¨
 
	$gëQP
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_phQP
[uiIdx]; 
	}
}

260 
Void
 
	$£tQP
 ( 
UI¡
 
uiIdx
, 
SCh¨
 
vÆue
 ) { 
m_phQP
[uiIdx] = vÆue; 
	}
}

261 
Void
 
£tQPSubP¨ts
 ( 
I¡
 
qp
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

262 
I¡
 
	$gëLa°VÆidP¨tIdx
 ( 
I¡
 
iAbsP¨tIdx
 ) const;

263 
SCh¨
 
	$gëLa°CodedQP
 ( 
UI¡
 
uiAbsP¨tIdx
 ) const;

264 
Void
 
	`£tQPSubCUs
 ( 
I¡
 
qp
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
, 
Boﬁ
 &
foundN⁄ZîoCbf
 );

265 
Void
 
	$£tCodedQP
 ( 
SCh¨
 
qp
 ) { 
m_codedQP
 = qp; 
	}
}

266 
SCh¨
 
	$gëCodedQP
 ( ) c⁄° {  
m_codedQP
; 
	}
}

268 
UCh¨
* 
	$gëChromaQpAdj
 ( ) {  
m_ChromaQpAdj
; 
	}
}

269 
UCh¨
 
	$gëChromaQpAdj
 ( 
I¡
 
idx
 ) c⁄° {  
m_ChromaQpAdj
[idx]; 
	}
}

270 
Void
 
	$£tChromaQpAdj
 ( 
I¡
 
idx
, 
UCh¨
 
vÆ
 ) { 
m_ChromaQpAdj
[idx] = vÆ; 
	}
}

271 
Void
 
£tChromaQpAdjSubP¨ts
 ( 
UCh¨
 
vÆ
, 
I¡
 
absP¨tIdx
, I¡ 
dïth
 );

272 
Void
 
	$£tCodedChromaQpAdj
 ( 
SCh¨
 
qp
 ) { 
m_codedChromaQpAdj
 = qp; 
	}
}

273 
SCh¨
 
	$gëCodedChromaQpAdj
 ( ) c⁄° {  
m_codedChromaQpAdj
; 
	}
}

275 
Boﬁ
 
	$isLos¶essCoded
 ( 
UI¡
 
absP¨tIdx
 ) const;

277 
UCh¨
* 
	$gëTønsf‹mIdx
 ( ) {  
m_puhTrIdx
; 
	}
}

278 
UCh¨
 
	$gëTønsf‹mIdx
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_puhTrIdx
[uiIdx]; 
	}
}

279 
Void
 
£tTrIdxSubP¨ts
 ( 
UI¡
 
uiTrIdx
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

281 
UCh¨
* 
	$gëTønsf‹mSkù
 ( 
Comp⁄ítID
 
compID
 ) {  
m_puhTønsf‹mSkù
[compID]; 
	}
}

282 
UCh¨
 
	$gëTønsf‹mSkù
 ( 
UI¡
 
uiIdx
, 
Comp⁄ítID
 
compID
 ) c⁄° {  
m_puhTønsf‹mSkù
[compID][uiIdx]; 
	}
}

283 
Void
 
£tTønsf‹mSkùSubP¨ts
 ( 
UI¡
 
u£Tønsf‹mSkù
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

284 
Void
 
£tTønsf‹mSkùSubP¨ts
 ( c⁄° 
UI¡
 
u£Tønsf‹mSkù
[
MAX_NUM_COMPONENT
], UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

286 
UCh¨
* 
	$gëEx∂icôRdpcmMode
 ( 
Comp⁄ítID
 
comp⁄ít
 ) {  
m_ex∂icôRdpcmMode
[comp⁄ít]; 
	}
}

287 
UCh¨
 
	$gëEx∂icôRdpcmMode
 ( 
Comp⁄ítID
 
comp⁄ít
, 
UI¡
 
∑πIdx
 ) c⁄° {  
m_ex∂icôRdpcmMode
[comp⁄ít][∑πIdx]; 
	}
}

288 
Void
 
£tEx∂icôRdpcmModeP¨tR™ge
 ( 
UI¡
 
rdpcmMode
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 );

290 
Boﬁ
 
	$isRDPCME«bÀd
 ( 
UI¡
 
uiAbsP¨tIdx
 ) c⁄° {  
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëRdpcmE«bÀdFœg
(
	`isI¡ø
(uiAbsP¨tIdxË? 
RDPCM_SIGNAL_IMPLICIT
 : 
RDPCM_SIGNAL_EXPLICIT
); 
	}
}

292 
Void
 
£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
 ( 
SCh¨
 
ÆphaVÆue
, 
Comp⁄ítID
 
compID
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 );

293 
Void
 
£tTønsf‹mSkùP¨tR™ge
 ( 
UI¡
 
u£Tønsf‹mSkù
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 );

295 
UI¡
 
	$gëQuadåìTULog2MöSizeInCU
 ( 
UI¡
 
uiIdx
 ) const;

297 
TComCUMvFõld
* 
	$gëCUMvFõld
 ( 
RefPicLi°
 
e
 ) {  &
m_acCUMvFõld
[e]; 
	}
}

298 c⁄° 
TComCUMvFõld
* 
	$gëCUMvFõld
 ( 
RefPicLi°
 
e
 ) c⁄° {  &
m_acCUMvFõld
[e]; 
	}
}

300 
TC€ff
* 
	$gëC€ff
 ( 
Comp⁄ítID
 
comp⁄ít
 ) {  
m_pcTrC€ff
[comp⁄ít]; 
	}
}

302 #i‡
ADAPTIVE_QP_SELECTION


303 
TC€ff
* 
	$gëAæC€ff
 ( 
Comp⁄ítID
 
comp⁄ít
 ) {  
m_pcAæC€ff
[comp⁄ít]; 
	}
}

305 
Pñ
* 
	$gëPCMSam∂e
 ( 
Comp⁄ítID
 
comp⁄ít
 ) {  
m_pcIPCMSam∂e
[comp⁄ít]; 
	}
}

307 
UCh¨
 
	$gëCbf
 ( 
UI¡
 
uiIdx
, 
Comp⁄ítID
 
eTy≥
 ) c⁄° {  
m_puhCbf
[eTy≥][uiIdx]; 
	}
}

308 
UCh¨
* 
	$gëCbf
 ( 
Comp⁄ítID
 
eTy≥
 ) {  
m_puhCbf
[eTy≥]; 
	}
}

309 
UCh¨
 
	$gëCbf
 ( 
UI¡
 
uiIdx
, 
Comp⁄ítID
 
eTy≥
, UI¡ 
uiTrDïth
 ) c⁄° {  ( ( 
	`gëCbf
–uiIdx,ÉTy≥ ) >> uiTrDïth ) & 0x1 ); 
	}
}

310 
Void
 
	$£tCbf
 ( 
UI¡
 
uiIdx
, 
Comp⁄ítID
 
eTy≥
, 
UCh¨
 
uh
 ) { 
m_puhCbf
[eTy≥][uiIdx] = uh; 
	}
}

311 
Void
 
˛órCbf
 ( 
UI¡
 
uiIdx
, 
Comp⁄ítID
 
eTy≥
, UI¡ 
uiNumP¨ts
 );

312 
UCh¨
 
	$gëQtRoŸCbf
 ( 
UI¡
 
uiIdx
 ) const;

314 
Void
 
	`£tCbfSubP¨ts
 ( c⁄° 
UI¡
 
uiCbf
[
MAX_NUM_COMPONENT
], UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

315 
Void
 
	`£tCbfSubP¨ts
 ( 
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

316 
Void
 
	`£tCbfSubP¨ts
 ( 
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 );

318 
Void
 
	`£tCbfP¨tR™ge
 ( 
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 );

319 
Void
 
	`bôwi£OrCbfP¨tR™ge
 ( 
UI¡
 
uiCbf
, 
Comp⁄ítID
 
compID
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiCovîedP¨tIdxes
 );

325 
Boﬁ
* 
	$gëMîgeFœg
 ( ) {  
m_pbMîgeFœg
; 
	}
}

326 
Boﬁ
 
	$gëMîgeFœg
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_pbMîgeFœg
[uiIdx]; 
	}
}

327 
Void
 
	$£tMîgeFœg
 ( 
UI¡
 
uiIdx
, 
Boﬁ
 
b
 ) { 
m_pbMîgeFœg
[uiIdx] = b; 
	}
}

328 
Void
 
£tMîgeFœgSubP¨ts
 ( 
Boﬁ
 
bMîgeFœg
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 );

330 
UCh¨
* 
	$gëMîgeIndex
 ( ) {  
m_puhMîgeIndex
; 
	}
}

331 
UCh¨
 
	$gëMîgeIndex
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_puhMîgeIndex
[uiIdx]; 
	}
}

332 
Void
 
	$£tMîgeIndex
 ( 
UI¡
 
uiIdx
, UI¡ 
uiMîgeIndex
 ) { 
m_puhMîgeIndex
[uiIdx] = uiMîgeIndex; 
	}
}

333 
Void
 
£tMîgeIndexSubP¨ts
 ( 
UI¡
 
uiMîgeIndex
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 );

334 
	gãm∂©e
 <
ty≥«me
 
	gT
>

335 
Void
 
£tSubP¨t
 ( 
T
 
bP¨amëî
, T* 
pbBa£Ctu
, 
UI¡
 
uiCUAddr
, UI¡ 
uiCUDïth
, UI¡ 
uiPUIdx
 );

337 #i‡
AMP_MRG


338 
Void
 
	$£tMîgeAMP
 ( 
Boﬁ
 
b
 ) { 
m_bIsMîgeAMP
 = b; 
	}
}

339 
Boﬁ
 
	$gëMîgeAMP
 ( ) c⁄° {  
m_bIsMîgeAMP
; 
	}
}

342 
UCh¨
* 
	$gëI¡øDú
 ( c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
 ) c⁄° {  
m_puhI¡øDú
[ch™√lTy≥]; 
	}
}

343 
UCh¨
 
	$gëI¡øDú
 ( c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
, c⁄° 
UI¡
 
uiIdx
 ) c⁄° {  
m_puhI¡øDú
[ch™√lTy≥][uiIdx]; 
	}
}

345 
Void
 
£tI¡øDúSubP¨ts
 ( c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
,

346 c⁄° 
UI¡
 
uiDú
,

347 c⁄° 
UI¡
 
uiAbsP¨tIdx
,

348 c⁄° 
UI¡
 
uiDïth
 );

350 
UCh¨
* 
	$gëI¡îDú
 ( ) {  
m_puhI¡îDú
; 
	}
}

351 
UCh¨
 
	$gëI¡îDú
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_puhI¡îDú
[uiIdx]; 
	}
}

352 
Void
 
	$£tI¡îDú
 ( 
UI¡
 
uiIdx
, 
UCh¨
 
uh
 ) { 
m_puhI¡îDú
[uiIdx] = uh; 
	}
}

353 
Void
 
£tI¡îDúSubP¨ts
 ( 
UI¡
 
uiDú
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 );

354 
Boﬁ
* 
	$gëIPCMFœg
 ( ) {  
m_pbIPCMFœg
; 
	}
}

355 
Boﬁ
 
	$gëIPCMFœg
 ( 
UI¡
 
uiIdx
 ) c⁄° {  
m_pbIPCMFœg
[uiIdx]; 
	}
}

356 
Void
 
	$£tIPCMFœg
 ( 
UI¡
 
uiIdx
, 
Boﬁ
 
b
 ) { 
m_pbIPCMFœg
[uiIdx] = b; 
	}
}

357 
Void
 
£tIPCMFœgSubP¨ts
 ( 
Boﬁ
 
bIpcmFœg
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

363 
Void
 
	$gëP¨tIndexAndSize
 ( 
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tAddr
, 
I¡
& 
riWidth
, I¡& 
riHeight
 ) const;

364 
UCh¨
 
	$gëNumP¨tôi⁄s
 ( c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 0 ) const;

365 
Boﬁ
 
	$isFú°AbsZ‹dîIdxInDïth
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) const;

371 
Void
 
	`gëMvFõld
 ( c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefPicLi°
, 
TComMvFõld
& 
rcMvFõld
 );

373 
Void
 
	$fûlMvpC™d
 ( c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° UI¡ 
uiP¨tAddr
, c⁄° 
RefPicLi°
 
eRefPicLi°
, c⁄° 
I¡
 
iRefIdx
, 
AMVPInfo
* 
pInfo
 ) const;

374 
Boﬁ
 
	$isDiffMER
 ( 
I¡
 
xN
, I¡ 
yN
, I¡ 
xP
, I¡ 
yP
 ) const;

375 
Void
 
	$gëP¨tPosôi⁄
 ( 
UI¡
 
∑πIdx
, 
I¡
& 
xP
, I¡& 
yP
, I¡& 
nPSW
, I¡& 
nPSH
 ) const;

377 
Void
 
	$£tMVPIdx
 ( 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiIdx
, 
I¡
 
iMVPIdx
Ë{ 
m_≠iMVPIdx
[eRefPicLi°][uiIdx] = iMVPIdx; 
	}
}

378 
I¡
 
	$gëMVPIdx
 ( 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiIdx
Ëc⁄° {  
m_≠iMVPIdx
[eRefPicLi°][uiIdx]; 
	}
}

379 
SCh¨
* 
	$gëMVPIdx
 ( 
RefPicLi°
 
eRefPicLi°
 ) {  
m_≠iMVPIdx
[eRefPicLi°]; 
	}
}

381 
Void
 
	$£tMVPNum
 ( 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiIdx
, 
I¡
 
iMVPNum
 ) { 
m_≠iMVPNum
[eRefPicLi°][uiIdx] = iMVPNum; 
	}
}

382 
I¡
 
	$gëMVPNum
 ( 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiIdx
 ) c⁄° {  
m_≠iMVPNum
[eRefPicLi°][uiIdx]; 
	}
}

383 
SCh¨
* 
	$gëMVPNum
 ( 
RefPicLi°
 
eRefPicLi°
 ) {  
m_≠iMVPNum
[eRefPicLi°]; 
	}
}

385 
Void
 
£tMVPIdxSubP¨ts
 ( 
I¡
 
iMVPIdx
, 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 );

386 
Void
 
£tMVPNumSubP¨ts
 ( 
I¡
 
iMVPNum
, 
RefPicLi°
 
eRefPicLi°
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
 );

388 
Void
 
	$˛ùMv
 ( 
TComMv
& 
rcMv
 ) const;

389 
Void
 
	$gëMvPªdLe·
 ( 
TComMv
& 
rcMvPªd
 ) c⁄° {ÑcMvPªd = 
m_cMvFõldA
.
	`gëMv
(); 
	}
}

390 
Void
 
	$gëMvPªdAbove
 ( 
TComMv
& 
rcMvPªd
 ) c⁄° {ÑcMvPªd = 
m_cMvFõldB
.
	`gëMv
(); 
	}
}

391 
Void
 
	$gëMvPªdAboveRight
 ( 
TComMv
& 
rcMvPªd
 ) c⁄° {ÑcMvPªd = 
m_cMvFõldC
.
	`gëMv
(); 
	}
}

393 
Void
 
com¥essMV
 ();

399 
TComD©aCU
* 
	$gëCtuLe·
 ( ) {  
m_pCtuLe·
; 
	}
}

400 
TComD©aCU
* 
	$gëCtuAbove
 ( ) {  
m_pCtuAbove
; 
	}
}

401 
TComD©aCU
* 
	$gëCtuAboveLe·
 ( ) {  
m_pCtuAboveLe·
; 
	}
}

402 
TComD©aCU
* 
	$gëCtuAboveRight
 ( ) {  
m_pCtuAboveRight
; 
	}
}

403 
Boﬁ
 
	$CUIsFromSameSli˚
 ( c⁄° 
TComD©aCU
 *
pCU
 ) c⁄° {  (ÖCU!=
NULL
 &&ÖCU->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
(Ë=gëSli˚()->gëSli˚CurSèπCtuTsAddr(Ë); 
	}
}

404 
Boﬁ
 
	$CUIsFromSameTûe
 ( c⁄° 
TComD©aCU
 *
pCU
 ) const;

405 
Boﬁ
 
	$CUIsFromSameSli˚AndTûe
 ( c⁄° 
TComD©aCU
 *
pCU
 ) const;

406 
Boﬁ
 
	$CUIsFromSameSli˚TûeAndWave‰⁄tRow
–c⁄° 
TComD©aCU
 *
pCU
 ) const;

407 
Boﬁ
 
	$isLa°SubCUOfCtu
 ( c⁄° 
UI¡
 
absP¨tIdx
 ) const;

410 c⁄° 
TComD©aCU
* 
	$gëPULe·
 ( 
UI¡
& 
uiLP¨tUnôIdx
,

411 
UI¡
 
uiCuºP¨tUnôIdx
,

412 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
=
åue
,

413 
Boﬁ
 
bEnf‹˚TûeRe°ri˘i⁄
=
åue
 ) const;

415 c⁄° 
TComD©aCU
* 
	$gëPUAbove
 ( 
UI¡
& 
uiAP¨tUnôIdx
,

416 
UI¡
 
uiCuºP¨tUnôIdx
,

417 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
=
åue
,

418 
Boﬁ
 
∂™¨AtCTUBound¨y
 = 
Ál£
,

419 
Boﬁ
 
bEnf‹˚TûeRe°ri˘i⁄
=
åue
 ) const;

421 c⁄° 
TComD©aCU
* 
	$gëPUAboveLe·
 ( 
UI¡
& 
uiALP¨tUnôIdx
, UI¡ 
uiCuºP¨tUnôIdx
, 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
=
åue
 ) const;

423 c⁄° 
TComD©aCU
* 
	$gëQpMöCuLe·
 ( 
UI¡
& 
uiLP¨tUnôIdx
, UI¡ 
uiCuºAbsIdxInCtu
 ) const;

424 c⁄° 
TComD©aCU
* 
	$gëQpMöCuAbove
 ( 
UI¡
& 
uiAP¨tUnôIdx
, UI¡ 
uiCuºAbsIdxInCtu
 ) const;

427 c⁄° 
TComD©aCU
* 
	$gëPUAboveRight
 ( 
UI¡
& 
uiARP¨tUnôIdx
, UI¡ 
uiCuºP¨tUnôIdx
, UI¡ 
uiP¨tUnôOff£t
 = 1, 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
=
åue
 ) const;

429 c⁄° 
TComD©aCU
* 
	$gëPUBñowLe·
 ( 
UI¡
& 
uiBLP¨tUnôIdx
, UI¡ 
uiCuºP¨tUnôIdx
, UI¡ 
uiP¨tUnôOff£t
 = 1, 
Boﬁ
 
bEnf‹˚Sli˚Re°ri˘i⁄
=
åue
 ) const;

431 
SCh¨
 
	$gëRefQP
 ( 
UI¡
 
uiCuºAbsIdxInCtu
 ) const;

433 
Void
 
	$dîiveLe·RightT›Idx
 ( 
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLT
, UI¡& 
ruiP¨tIdxRT
 ) const;

434 
Void
 
	$dîiveLe·BŸtomIdx
 ( 
UI¡
 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLB
 ) const;

436 
Boﬁ
 
	$hasEquÆMŸi⁄
 ( 
UI¡
 
uiAbsP¨tIdx
, c⁄° 
TComD©aCU
* 
pcC™dCU
, UI¡ 
uiC™dAbsP¨tIdx
 ) const;

437 #i‡
MCTS_ENC_CHECK


438 
Void
 
	`gëI¡îMîgeC™did©es
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiPUIdx
, 
TComMvFõld
* 
pcMFõldNeighbours
, 
UCh¨
* 
puhI¡îDúNeighbours
, 
I¡
& 
numVÆidMîgeC™d
, UI¡& 
numS∑tülMîgeC™did©es
 , I¡ 
mrgC™dIdx
 = -1) const;

440 
Void
 
	`gëI¡îMîgeC™did©es
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiPUIdx
, 
TComMvFõld
* 
pcMFõldNeighbours
, 
UCh¨
* 
puhI¡îDúNeighbours
, 
I¡
& 
numVÆidMîgeC™d
, I¡ 
mrgC™dIdx
 = -1 ) const;

443 
Void
 
	$dîiveLe·RightT›IdxGíîÆ
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLT
, UI¡& 
ruiP¨tIdxRT
 ) const;

444 
Void
 
	$dîiveLe·BŸtomIdxGíîÆ
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡& 
ruiP¨tIdxLB
 ) const;

450 
Boﬁ
 
	$isI¡ø
 ( 
UI¡
 
uiP¨tIdx
 ) c⁄° {  
m_≥PªdMode
[ uiP¨tIdx ] =
MODE_INTRA
; 
	}
}

451 
Boﬁ
 
	$isI¡î
 ( 
UI¡
 
uiP¨tIdx
 ) c⁄° {  
m_≥PªdMode
[ uiP¨tIdx ] =
MODE_INTER
; 
	}
}

452 
Boﬁ
 
	$isSkù≥d
 ( 
UI¡
 
uiP¨tIdx
 ) const;

453 
Boﬁ
 
	$isBùªdRe°ri˘i⁄
 ( 
UI¡
 
puIdx
 ) const;

459 
UI¡
 
	$gëI¡øSizeIdx
 ( 
UI¡
 
uiAbsP¨tIdx
 ) const;

461 
Void
 
	$gëAŒowedChromaDú
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡* 
uiModeLi°
 ) const;

462 
Void
 
	$gëI¡øDúPªdi˘‹
 ( 
UI¡
 
uiAbsP¨tIdx
, 
I¡
 
uiI¡øDúPªd
[
NUM_MOST_PROBABLE_MODES
], c⁄° 
Comp⁄ítID
 
compID
, I¡* 
piMode
 = 
NULL
 ) const;

468 
UI¡
 
	$gëCtxS∂ôFœg
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) const;

469 
UI¡
 
	$gëCtxQtCbf
 ( 
TComTU
 &
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 ) const;

471 
UI¡
 
	$gëCtxSkùFœg
 ( 
UI¡
 
uiAbsP¨tIdx
 ) const;

472 
UI¡
 
	$gëCtxI¡îDú
 ( 
UI¡
 
uiAbsP¨tIdx
 ) const;

474 
UI¡
& 
	$gëTŸÆBös
 ( ) {  
m_uiTŸÆBös
; 
	}
}

479 
	gDoubÀ
& 
	$gëTŸÆCo°
 ( ) {  
m_dTŸÆCo°
; 
	}
}

480 
	gDi°‹ti⁄
& 
	$gëTŸÆDi°‹ti⁄
 ( ) {  
m_uiTŸÆDi°‹ti⁄
; 
	}
}

481 
	gUI¡
& 
	$gëTŸÆBôs
 ( ) {  
m_uiTŸÆBôs
; 
	}
}

482 
	gUI¡
& 
	$gëTŸÆNumP¨t
 ( ) {  
m_uiNumP¨tôi⁄
; 
	}
}

484 
UI¡
 
	$gëC€fSˇnIdx
 ( c⁄° 
UI¡
 
uiAbsP¨tIdx
, c⁄° UI¡ 
uiWidth
, c⁄° UI¡ 
uiHeight
, c⁄° 
Comp⁄ítID
 
compID
 ) const ;

486 
	}
};

488 
«me•a˚
 
	gRa°îAddªss


496 
ölöe
 
Boﬁ
 
isEquÆCﬁ
–
I¡
 
addrA
, I¡ 
addrB
, I¡ 
numUnôsPîRow
 )

499  (–
	gaddrA
 ^ 
	gaddrB
 ) & ( 
	gnumUnôsPîRow
 - 1 ) ) == 0;

508 
ölöe
 
Boﬁ
 
isEquÆRow
–
I¡
 
addrA
, I¡ 
addrB
, I¡ 
numUnôsPîRow
 )

511  (–
	gaddrA
 ^ 
	gaddrB
 ) &~ ( 
	gnumUnôsPîRow
 - 1 ) ) == 0;

520 
ölöe
 
Boﬁ
 
isEquÆRowOrCﬁ
–
I¡
 
addrA
, I¡ 
addrB
, I¡ 
numUnôsPîRow
 )

522  
isEquÆCﬁ
–
addrA
, 
addrB
, 
numUnôsPîRow
 ) | 
isEquÆRow
(áddrA,áddrB,ÇumUnitsPerRow );

530 
ölöe
 
Boﬁ
 
isZîoCﬁ
–
I¡
 
addr
, I¡ 
numUnôsPîRow
 )

533  ( 
	gaddr
 & ( 
	gnumUnôsPîRow
 - 1 ) ) == 0;

541 
ölöe
 
Boﬁ
 
isZîoRow
–
I¡
 
addr
, I¡ 
numUnôsPîRow
 )

544  ( 
	gaddr
 &~ ( 
	gnumUnôsPîRow
 - 1 ) ) == 0;

553 
ölöe
 
Boﬁ
 
ÀssTh™Cﬁ
–
I¡
 
addr
, I¡ 
vÆ
, I¡ 
numUnôsPîRow
 )

556  ( 
	gaddr
 & ( 
	gnumUnôsPîRow
 - 1 ) ) < 
	gvÆ
;

565 
ölöe
 
Boﬁ
 
ÀssTh™Row
–
I¡
 
addr
, I¡ 
vÆ
, I¡ 
numUnôsPîRow
 )

568  
	gaddr
 < 
vÆ
 * 
	gnumUnôsPîRow
;

	@TLibCommon/TComInterpolationFilter.cpp

43 
	~"TComRom.h
"

44 
	~"TComI¡îpﬁ©i⁄Fûãr.h
"

45 
	~<as£π.h
>

47 
	~"TComChromaF‹m©.h
"

49 #i‡
VECTOR_CODING__INTERPOLATION_FILTER
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

50 
	~<emmöåö.h
>

60 c⁄° 
TFûãrC€ff
 
	gTComI¡îpﬁ©i⁄Fûãr
::
m_lumaFûãr
[
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
][
NTAPS_LUMA
] =

68 c⁄° 
TFûãrC€ff
 
	gTComI¡îpﬁ©i⁄Fûãr
::
m_chromaFûãr
[
CHROMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
][
NTAPS_CHROMA
] =

80 #i‡
VECTOR_CODING__INTERPOLATION_FILTER
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

81 
ölöe
 
__m128i
 
	$simdI¡îpﬁ©eLuma4
–
Sh‹t
 c⁄° *
§c
 , 
I¡
 
§cSåide
 , 
__m128i
 *
mmC€ff
 , c⁄° __m128ò& 
mmOff£t
 , I¡ 
shi·
 )

83 
__m128i
 
sumHi
 = 
	`_mm_£tzîo_si128
();

84 
__m128i
 
sumLo
 = 
	`_mm_£tzîo_si128
();

85  
I¡
 
n
 = 0 ;Ç < 8 ;Ç++ )

87 
__m128i
 
mmPix
 = 
	`_mm_lﬂdl_ïi64
––__m128i* )
§c
 );

88 
__m128i
 
hi
 = 
	`_mm_mulhi_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

89 
__m128i
 
lo
 = 
	`_mm_muŒo_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

90 
sumHi
 = 
	`_mm_add_ïi32
–sumHò, 
	`_mm_u≈ackhi_ïi16
–
lo
 , 
hi
 ) );

91 
sumLo
 = 
	`_mm_add_ïi32
–sumLÿ, 
	`_mm_u≈acklo_ïi16
–
lo
 , 
hi
 ) );

92 
§c
 +
§cSåide
;

94 
sumHi
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumHò, 
mmOff£t
 ) , 
shi·
 );

95 
sumLo
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumLÿ, 
mmOff£t
 ) , 
shi·
 );

96 –
	`_mm_∑cks_ïi32
–
sumLo
 , 
sumHi
 ) );

97 
	}
}

99 
ölöe
 
__m128i
 
	$simdI¡îpﬁ©eChroma4
–
Sh‹t
 c⁄° *
§c
 , 
I¡
 
§cSåide
 , 
__m128i
 *
mmC€ff
 , c⁄° __m128ò& 
mmOff£t
 , I¡ 
shi·
 )

101 
__m128i
 
sumHi
 = 
	`_mm_£tzîo_si128
();

102 
__m128i
 
sumLo
 = 
	`_mm_£tzîo_si128
();

103  
I¡
 
n
 = 0 ;Ç < 4 ;Ç++ )

105 
__m128i
 
mmPix
 = 
	`_mm_lﬂdl_ïi64
––__m128i* )
§c
 );

106 
__m128i
 
hi
 = 
	`_mm_mulhi_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

107 
__m128i
 
lo
 = 
	`_mm_muŒo_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

108 
sumHi
 = 
	`_mm_add_ïi32
–sumHò, 
	`_mm_u≈ackhi_ïi16
–
lo
 , 
hi
 ) );

109 
sumLo
 = 
	`_mm_add_ïi32
–sumLÿ, 
	`_mm_u≈acklo_ïi16
–
lo
 , 
hi
 ) );

110 
§c
 +
§cSåide
;

112 
sumHi
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumHò, 
mmOff£t
 ) , 
shi·
 );

113 
sumLo
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumLÿ, 
mmOff£t
 ) , 
shi·
 );

114 –
	`_mm_∑cks_ïi32
–
sumLo
 , 
sumHi
 ) );

115 
	}
}

117 
ölöe
 
__m128i
 
	$simdI¡îpﬁ©eLuma8
–
Sh‹t
 c⁄° *
§c
 , 
I¡
 
§cSåide
 , 
__m128i
 *
mmC€ff
 , c⁄° __m128ò& 
mmOff£t
 , I¡ 
shi·
 )

119 
__m128i
 
sumHi
 = 
	`_mm_£tzîo_si128
();

120 
__m128i
 
sumLo
 = 
	`_mm_£tzîo_si128
();

121  
I¡
 
n
 = 0 ;Ç < 8 ;Ç++ )

123 
__m128i
 
mmPix
 = 
	`_mm_lﬂdu_si128
––__m128i* )
§c
 );

124 
__m128i
 
hi
 = 
	`_mm_mulhi_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

125 
__m128i
 
lo
 = 
	`_mm_muŒo_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

126 
sumHi
 = 
	`_mm_add_ïi32
–sumHò, 
	`_mm_u≈ackhi_ïi16
–
lo
 , 
hi
 ) );

127 
sumLo
 = 
	`_mm_add_ïi32
–sumLÿ, 
	`_mm_u≈acklo_ïi16
–
lo
 , 
hi
 ) );

128 
§c
 +
§cSåide
;

130 
sumHi
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumHò, 
mmOff£t
 ) , 
shi·
 );

131 
sumLo
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumLÿ, 
mmOff£t
 ) , 
shi·
 );

132 –
	`_mm_∑cks_ïi32
–
sumLo
 , 
sumHi
 ) );

133 
	}
}

135 
ölöe
 
__m128i
 
	$simdI¡îpﬁ©eLuma2P8
–
Sh‹t
 c⁄° *
§c
 , 
I¡
 
§cSåide
 , 
__m128i
 *
mmC€ff
 , c⁄° __m128ò& 
mmOff£t
 , I¡ 
shi·
 )

137 
__m128i
 
sumHi
 = 
	`_mm_£tzîo_si128
();

138 
__m128i
 
sumLo
 = 
	`_mm_£tzîo_si128
();

139  
I¡
 
n
 = 0 ;Ç < 2 ;Ç++ )

141 
__m128i
 
mmPix
 = 
	`_mm_lﬂdu_si128
––__m128i* )
§c
 );

142 
__m128i
 
hi
 = 
	`_mm_mulhi_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

143 
__m128i
 
lo
 = 
	`_mm_muŒo_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

144 
sumHi
 = 
	`_mm_add_ïi32
–sumHò, 
	`_mm_u≈ackhi_ïi16
–
lo
 , 
hi
 ) );

145 
sumLo
 = 
	`_mm_add_ïi32
–sumLÿ, 
	`_mm_u≈acklo_ïi16
–
lo
 , 
hi
 ) );

146 
§c
 +
§cSåide
;

148 
sumHi
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumHò, 
mmOff£t
 ) , 
shi·
 );

149 
sumLo
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumLÿ, 
mmOff£t
 ) , 
shi·
 );

150 –
	`_mm_∑cks_ïi32
–
sumLo
 , 
sumHi
 ) );

151 
	}
}

153 
ölöe
 
__m128i
 
	$simdI¡îpﬁ©eLuma2P4
–
Sh‹t
 c⁄° *
§c
 , 
I¡
 
§cSåide
 , 
__m128i
 *
mmC€ff
 , c⁄° __m128ò& 
mmOff£t
 , I¡ 
shi·
 )

155 
__m128i
 
sumHi
 = 
	`_mm_£tzîo_si128
();

156 
__m128i
 
sumLo
 = 
	`_mm_£tzîo_si128
();

157  
I¡
 
n
 = 0 ;Ç < 2 ;Ç++ )

159 
__m128i
 
mmPix
 = 
	`_mm_lﬂdl_ïi64
––__m128i* )
§c
 );

160 
__m128i
 
hi
 = 
	`_mm_mulhi_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

161 
__m128i
 
lo
 = 
	`_mm_muŒo_ïi16
–
mmPix
 , 
mmC€ff
[
n
] );

162 
sumHi
 = 
	`_mm_add_ïi32
–sumHò, 
	`_mm_u≈ackhi_ïi16
–
lo
 , 
hi
 ) );

163 
sumLo
 = 
	`_mm_add_ïi32
–sumLÿ, 
	`_mm_u≈acklo_ïi16
–
lo
 , 
hi
 ) );

164 
§c
 +
§cSåide
;

166 
sumHi
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumHò, 
mmOff£t
 ) , 
shi·
 );

167 
sumLo
 = 
	`_mm_§ai_ïi32
–
	`_mm_add_ïi32
–sumLÿ, 
mmOff£t
 ) , 
shi·
 );

168 –
	`_mm_∑cks_ïi32
–
sumLo
 , 
sumHi
 ) );

169 
	}
}

171 
ölöe
 
__m128i
 
	$simdClù3
–
__m128i
 
mmMö
 , __m128ò
mmMax
 , __m128ò
mmPix
 )

173 
__m128i
 
mmMask
 = 
	`_mm_cmpgt_ïi16
–
mmPix
 , 
mmMö
 );

174 
mmPix
 = 
	`_mm_‹_si128
–
	`_mm_™d_si128
–
mmMask
 , mmPix ) , 
	`_mm_™dnŸ_si128
–mmMask , 
mmMö
 ) );

175 
mmMask
 = 
	`_mm_cm∂t_ïi16
–
mmPix
 , 
mmMax
 );

176 
mmPix
 = 
	`_mm_‹_si128
–
	`_mm_™d_si128
–
mmMask
 , mmPix ) , 
	`_mm_™dnŸ_si128
–mmMask , 
mmMax
 ) );

177 –
mmPix
 );

178 
	}
}

198 
Void
 
	gTComI¡îpﬁ©i⁄Fûãr
::
	$fûãrC›y
(
I¡
 
bôDïth
, c⁄° 
Pñ
 *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
Boﬁ
 
isFú°
, Boﬁ 
isLa°
)

200 
I¡
 
row
, 
cﬁ
;

202 i‡–
isFú°
 =
isLa°
 )

204 
row
 = 0;Ñow < 
height
;Ñow++)

206 
cﬁ
 = 0; cﬁ < 
width
; col++)

208 
d°
[
cﬁ
] = 
§c
[col];

211 
§c
 +
§cSåide
;

212 
d°
 +
d°Såide
;

215 i‡–
isFú°
 )

217 c⁄° 
I¡
 
shi·
 = 
°d
::
max
<I¡>(2, (
IF_INTERNAL_PREC
 - 
bôDïth
));

219 
row
 = 0;Ñow < 
height
;Ñow++)

221 
cﬁ
 = 0; cﬁ < 
width
; col++)

223 
Pñ
 
vÆ
 = 
	`À·Shi·_round
(
§c
[
cﬁ
], 
shi·
);

224 
d°
[
cﬁ
] = 
vÆ
 - (
Pñ
)
IF_INTERNAL_OFFS
;

227 
§c
 +
§cSåide
;

228 
d°
 +
d°Såide
;

233 c⁄° 
I¡
 
shi·
 = 
°d
::
max
<I¡>(2, (
IF_INTERNAL_PREC
 - 
bôDïth
));

235 
Pñ
 
maxVÆ
 = (1 << 
bôDïth
) - 1;

236 
Pñ
 
möVÆ
 = 0;

237 
row
 = 0;Ñow < 
height
;Ñow++)

239 
cﬁ
 = 0; cﬁ < 
width
; col++)

241 
Pñ
 
vÆ
 = 
§c
[ 
cﬁ
 ];

242 
vÆ
 = 
	`rightShi·_round
((vÆ + 
IF_INTERNAL_OFFS
), 
shi·
);

243 i‡(
vÆ
 < 
möVÆ
)

245 
vÆ
 = 
möVÆ
;

247 i‡(
vÆ
 > 
maxVÆ
)

249 
vÆ
 = 
maxVÆ
;

251 
d°
[
cﬁ
] = 
vÆ
;

254 
§c
 +
§cSåide
;

255 
d°
 +
d°Såide
;

258 
	}
}

276 
	gãm∂©e
<
I¡
 
	gN
, 
Boﬁ
 
	gisVîtiˇl
, Boﬁ 
	gisFú°
, Boﬁ 
	gisLa°
>

277 
Void
 
	gTComI¡îpﬁ©i⁄Fûãr
::
	$fûãr
(
I¡
 
bôDïth
, 
Pñ
 c⁄° *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
TFûãrC€ff
 c⁄° *
c€ff
)

279 
I¡
 
row
, 
cﬁ
;

281 
Pñ
 
c
[8];

282 
c
[0] = 
c€ff
[0];

283 
c
[1] = 
c€ff
[1];

284 i‡–
N
 >= 4 )

286 
c
[2] = 
c€ff
[2];

287 
c
[3] = 
c€ff
[3];

289 i‡–
N
 >= 6 )

291 
c
[4] = 
c€ff
[4];

292 
c
[5] = 
c€ff
[5];

294 i‡–
N
 == 8 )

296 
c
[6] = 
c€ff
[6];

297 
c
[7] = 
c€ff
[7];

300 
I¡
 
cSåide
 = ( 
isVîtiˇl
 ) ? 
§cSåide
 : 1;

301 
§c
 -–
N
/2 - 1 ) * 
cSåide
;

303 
I¡
 
off£t
;

304 
Pñ
 
maxVÆ
;

305 
I¡
 
hódRoom
 = 
°d
::
max
<I¡>(2, (
IF_INTERNAL_PREC
 - 
bôDïth
));

306 
I¡
 
shi·
 = 
IF_FILTER_PREC
;

309 
	`as£π
(
shi·
 >= 0);

311 i‡–
isLa°
 )

313 
shi·
 +(
isFú°
Ë? 0 : 
hódRoom
;

314 
off£t
 = 1 << (
shi·
 - 1);

315 
off£t
 +(
isFú°
Ë? 0 : 
IF_INTERNAL_OFFS
 << 
IF_FILTER_PREC
;

316 
maxVÆ
 = (1 << 
bôDïth
) - 1;

320 
shi·
 -(
isFú°
Ë? 
hódRoom
 : 0;

321 
off£t
 = (
isFú°
Ë? -
IF_INTERNAL_OFFS
 << 
shi·
 : 0;

322 
maxVÆ
 = 0;

325 #i‡
VECTOR_CODING__INTERPOLATION_FILTER
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

326 if–
bôDïth
 <= 10 )

328 if–
N
 =8 && !–
width
 & 0x07 ) )

330 
Sh‹t
 
möVÆ
 = 0;

331 
__m128i
 
mmOff£t
 = 
	`_mm_£t1_ïi32
–
off£t
 );

332 
__m128i
 
mmC€ff
[8];

333 
__m128i
 
mmMö
 = 
	`_mm_£t1_ïi16
–
möVÆ
 );

334 
__m128i
 
mmMax
 = 
	`_mm_£t1_ïi16
–
maxVÆ
 );

335  
I¡
 
n
 = 0 ;Ç < 8 ;Ç++ )

336 
mmC€ff
[
n
] = 
	`_mm_£t1_ïi16
–
c
[n] );

337  
row
 = 0 ;Ñow < 
height
 ;Ñow++ )

339  
cﬁ
 = 0 ; cﬁ < 
width
 ; col += 8 )

341 
__m128i
 
mmFûãªd
 = 
	`simdI¡îpﬁ©eLuma8
–
§c
 + 
cﬁ
 , 
cSåide
 , 
mmC€ff
 , 
mmOff£t
 , 
shi·
 );

342 if–
isLa°
 )

344 
mmFûãªd
 = 
	`simdClù3
–
mmMö
 , 
mmMax
 , mmFiltered );

346 
	`_mm_°‹eu_si128
––
__m128i
 * )–
d°
 + 
cﬁ
 ) , 
mmFûãªd
 );

348 
§c
 +
§cSåide
;

349 
d°
 +
d°Såide
;

353 if–
N
 =8 && !–
width
 & 0x03 ) )

355 
Sh‹t
 
möVÆ
 = 0;

356 
__m128i
 
mmOff£t
 = 
	`_mm_£t1_ïi32
–
off£t
 );

357 
__m128i
 
mmC€ff
[8];

358 
__m128i
 
mmMö
 = 
	`_mm_£t1_ïi16
–
möVÆ
 );

359 
__m128i
 
mmMax
 = 
	`_mm_£t1_ïi16
–
maxVÆ
 );

360  
I¡
 
n
 = 0 ;Ç < 8 ;Ç++ )

361 
mmC€ff
[
n
] = 
	`_mm_£t1_ïi16
–
c
[n] );

362  
row
 = 0 ;Ñow < 
height
 ;Ñow++ )

364  
cﬁ
 = 0 ; cﬁ < 
width
 ; col += 4 )

366 
__m128i
 
mmFûãªd
 = 
	`simdI¡îpﬁ©eLuma4
–
§c
 + 
cﬁ
 , 
cSåide
 , 
mmC€ff
 , 
mmOff£t
 , 
shi·
 );

367 if–
isLa°
 )

369 
mmFûãªd
 = 
	`simdClù3
–
mmMö
 , 
mmMax
 , mmFiltered );

371 
	`_mm_°‹ñ_ïi64
––
__m128i
 * )–
d°
 + 
cﬁ
 ) , 
mmFûãªd
 );

373 
§c
 +
§cSåide
;

374 
d°
 +
d°Såide
;

378 if–
N
 =4 && !–
width
 & 0x03 ) )

380 
Sh‹t
 
möVÆ
 = 0;

381 
__m128i
 
mmOff£t
 = 
	`_mm_£t1_ïi32
–
off£t
 );

382 
__m128i
 
mmC€ff
[8];

383 
__m128i
 
mmMö
 = 
	`_mm_£t1_ïi16
–
möVÆ
 );

384 
__m128i
 
mmMax
 = 
	`_mm_£t1_ïi16
–
maxVÆ
 );

385  
I¡
 
n
 = 0 ;Ç < 4 ;Ç++ )

386 
mmC€ff
[
n
] = 
	`_mm_£t1_ïi16
–
c
[n] );

387  
row
 = 0 ;Ñow < 
height
 ;Ñow++ )

389  
cﬁ
 = 0 ; cﬁ < 
width
 ; col += 4 )

391 
__m128i
 
mmFûãªd
 = 
	`simdI¡îpﬁ©eChroma4
–
§c
 + 
cﬁ
 , 
cSåide
 , 
mmC€ff
 , 
mmOff£t
 , 
shi·
 );

392 if–
isLa°
 )

394 
mmFûãªd
 = 
	`simdClù3
–
mmMö
 , 
mmMax
 , mmFiltered );

396 
	`_mm_°‹ñ_ïi64
––
__m128i
 * )–
d°
 + 
cﬁ
 ) , 
mmFûãªd
 );

398 
§c
 +
§cSåide
;

399 
d°
 +
d°Såide
;

403 if–
N
 =2 && !–
width
 & 0x07 ) )

405 
Sh‹t
 
möVÆ
 = 0;

406 
__m128i
 
mmOff£t
 = 
	`_mm_£t1_ïi32
–
off£t
 );

407 
__m128i
 
mmC€ff
[2];

408 
__m128i
 
mmMö
 = 
	`_mm_£t1_ïi16
–
möVÆ
 );

409 
__m128i
 
mmMax
 = 
	`_mm_£t1_ïi16
–
maxVÆ
 );

410  
I¡
 
n
 = 0 ;Ç < 2 ;Ç++ )

411 
mmC€ff
[
n
] = 
	`_mm_£t1_ïi16
–
c
[n] );

412  
row
 = 0 ;Ñow < 
height
 ;Ñow++ )

414  
cﬁ
 = 0 ; cﬁ < 
width
 ; col += 8 )

416 
__m128i
 
mmFûãªd
 = 
	`simdI¡îpﬁ©eLuma2P8
–
§c
 + 
cﬁ
 , 
cSåide
 , 
mmC€ff
 , 
mmOff£t
 , 
shi·
 );

417 if–
isLa°
 )

419 
mmFûãªd
 = 
	`simdClù3
–
mmMö
 , 
mmMax
 , mmFiltered );

421 
	`_mm_°‹eu_si128
––
__m128i
 * )–
d°
 + 
cﬁ
 ) , 
mmFûãªd
 );

423 
§c
 +
§cSåide
;

424 
d°
 +
d°Såide
;

428 if–
N
 =2 && !–
width
 & 0x03 ) )

430 
Sh‹t
 
möVÆ
 = 0;

431 
__m128i
 
mmOff£t
 = 
	`_mm_£t1_ïi32
–
off£t
 );

432 
__m128i
 
mmC€ff
[8];

433 
__m128i
 
mmMö
 = 
	`_mm_£t1_ïi16
–
möVÆ
 );

434 
__m128i
 
mmMax
 = 
	`_mm_£t1_ïi16
–
maxVÆ
 );

435  
I¡
 
n
 = 0 ;Ç < 2 ;Ç++ )

436 
mmC€ff
[
n
] = 
	`_mm_£t1_ïi16
–
c
[n] );

437  
row
 = 0 ;Ñow < 
height
 ;Ñow++ )

439  
cﬁ
 = 0 ; cﬁ < 
width
 ; col += 4 )

441 
__m128i
 
mmFûãªd
 = 
	`simdI¡îpﬁ©eLuma2P4
–
§c
 + 
cﬁ
 , 
cSåide
 , 
mmC€ff
 , 
mmOff£t
 , 
shi·
 );

442 if–
isLa°
 )

444 
mmFûãªd
 = 
	`simdClù3
–
mmMö
 , 
mmMax
 , mmFiltered );

446 
	`_mm_°‹ñ_ïi64
––
__m128i
 * )–
d°
 + 
cﬁ
 ) , 
mmFûãªd
 );

448 
§c
 +
§cSåide
;

449 
d°
 +
d°Såide
;

456 
row
 = 0;Ñow < 
height
;Ñow++)

458 
cﬁ
 = 0; cﬁ < 
width
; col++)

460 
I¡
 
sum
;

462 
sum
 = 
§c
[ 
cﬁ
 + 0 * 
cSåide
] * 
c
[0];

463 
sum
 +
§c
[ 
cﬁ
 + 1 * 
cSåide
] * 
c
[1];

464 i‡–
N
 >= 4 )

466 
sum
 +
§c
[ 
cﬁ
 + 2 * 
cSåide
] * 
c
[2];

467 
sum
 +
§c
[ 
cﬁ
 + 3 * 
cSåide
] * 
c
[3];

469 i‡–
N
 >= 6 )

471 
sum
 +
§c
[ 
cﬁ
 + 4 * 
cSåide
] * 
c
[4];

472 
sum
 +
§c
[ 
cﬁ
 + 5 * 
cSåide
] * 
c
[5];

474 i‡–
N
 == 8 )

476 
sum
 +
§c
[ 
cﬁ
 + 6 * 
cSåide
] * 
c
[6];

477 
sum
 +
§c
[ 
cﬁ
 + 7 * 
cSåide
] * 
c
[7];

480 
Pñ
 
vÆ
 = ( 
sum
 + 
off£t
 ) >> 
shi·
;

481 i‡–
isLa°
 )

483 
vÆ
 = ( val < 0 ) ? 0 : val;

484 
vÆ
 = ( vÆ > 
maxVÆ
 ) ? maxVal : val;

486 
d°
[
cﬁ
] = 
vÆ
;

489 
§c
 +
§cSåide
;

490 
d°
 +
d°Såide
;

492 
	}
}

508 
	gãm∂©e
<
I¡
 
	gN
>

509 
Void
 
	gTComI¡îpﬁ©i⁄Fûãr
::
	$fûãrH‹
(
I¡
 
bôDïth
, 
Pñ
 *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
Boﬁ
 
isLa°
, 
TFûãrC€ff
 c⁄° *
c€ff
)

511 i‡–
isLa°
 )

513 
fûãr
<
N
, 
Ál£
, 
åue
,Årue>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
c€ff
);

517 
fûãr
<
N
, 
Ál£
, 
åue
, fÆ£>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
c€ff
);

519 
	}
}

536 
	gãm∂©e
<
I¡
 
	gN
>

537 
Void
 
	gTComI¡îpﬁ©i⁄Fûãr
::
	$fûãrVî
(
I¡
 
bôDïth
, 
Pñ
 *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
Boﬁ
 
isFú°
, Boﬁ 
isLa°
, 
TFûãrC€ff
 c⁄° *
c€ff
)

539 i‡–
isFú°
 && 
isLa°
 )

541 
fûãr
<
N
, 
åue
,Årue,Årue>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
c€ff
);

543 i‡–
isFú°
 && !
isLa°
 )

545 
fûãr
<
N
, 
åue
,Årue, 
Ál£
>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
c€ff
);

547 i‡–!
isFú°
 && 
isLa°
 )

549 
fûãr
<
N
, 
åue
, 
Ál£
,Årue>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
c€ff
);

553 
fûãr
<
N
, 
åue
, 
Ál£
, fÆ£>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
c€ff
);

555 
	}
}

576 
Void
 
	gTComI¡îpﬁ©i⁄Fûãr
::
	$fûãrH‹
(c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
 *
§c
, 
I¡
 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, I¡ 
‰ac
, 
Boﬁ
 
isLa°
, c⁄° 
ChromaF‹m©
 
fmt
, c⁄° I¡ 
bôDïth
 )

578 i‡–
‰ac
 == 0 )

580 
	`fûãrC›y
(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
åue
, 
isLa°
 );

582 i‡(
	`isLuma
(
compID
))

584 
	`as£π
(
‰ac
 >0 && fø¯< 
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
);

585 
fûãrH‹
<
NTAPS_LUMA
>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
isLa°
, 
m_lumaFûãr
[
‰ac
]);

589 c⁄° 
UI¡
 
csx
 = 
	`gëComp⁄ítSˇÀX
(
compID
, 
fmt
);

590 
	`as£π
(
‰ac
 >=0 && 
csx
<2 && (‰ac<<(1-csx)Ë< 
CHROMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
);

591 
fûãrH‹
<
NTAPS_CHROMA
>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
isLa°
, 
m_chromaFûãr
[
‰ac
<<(1-
csx
)]);

593 
	}
}

612 
Void
 
	gTComI¡îpﬁ©i⁄Fûãr
::
	$fûãrVî
(c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
 *
§c
, 
I¡
 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, I¡ 
‰ac
, 
Boﬁ
 
isFú°
, Boﬁ 
isLa°
, c⁄° 
ChromaF‹m©
 
fmt
, c⁄° I¡ 
bôDïth
 )

614 i‡–
‰ac
 == 0 )

616 
	`fûãrC›y
(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
isFú°
, 
isLa°
 );

618 i‡(
	`isLuma
(
compID
))

620 
	`as£π
(
‰ac
 >0 && fø¯< 
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
);

621 
fûãrVî
<
NTAPS_LUMA
>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
isFú°
, 
isLa°
, 
m_lumaFûãr
[
‰ac
]);

625 c⁄° 
UI¡
 
csy
 = 
	`gëComp⁄ítSˇÀY
(
compID
, 
fmt
);

626 
	`as£π
(
‰ac
 >=0 && 
csy
<2 && (‰ac<<(1-csy)Ë< 
CHROMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
);

627 
fûãrVî
<
NTAPS_CHROMA
>(
bôDïth
, 
§c
, 
§cSåide
, 
d°
, 
d°Såide
, 
width
, 
height
, 
isFú°
, 
isLa°
, 
m_chromaFûãr
[
‰ac
<<(1-
csy
)]);

629 
	}
}

	@TLibCommon/TComInterpolationFilter.h

39 #i‚de‡
__TCOMINTERPOLATIONFILTER__


40 
	#__TCOMINTERPOLATIONFILTER__


	)

42 
	~"Comm⁄Def.h
"

47 
	#NTAPS_LUMA
 8

48 
	#NTAPS_CHROMA
 4

49 
	#IF_INTERNAL_PREC
 14

50 
	#IF_FILTER_PREC
 6

51 
	#IF_INTERNAL_OFFS
 (1<<(
IF_INTERNAL_PREC
-1))

52 

	)

56 ˛as†
	cTComI¡îpﬁ©i⁄Fûãr


58 c⁄° 
TFûãrC€ff
 
	mm_lumaFûãr
[
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
][
NTAPS_LUMA
];

59 c⁄° 
TFûãrC€ff
 
	mm_chromaFûãr
[
CHROMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
][
NTAPS_CHROMA
];

61 
Void
 
fûãrC›y
(
I¡
 
bôDïth
, c⁄° 
Pñ
 *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
Boﬁ
 
isFú°
, Boﬁ 
isLa°
);

63 
	mãm∂©e
<
I¡
 
	mN
, 
Boﬁ
 
	misVîtiˇl
, Boﬁ 
	misFú°
, Boﬁ 
	misLa°
>

64 
Void
 
fûãr
(
I¡
 
bôDïth
, 
Pñ
 c⁄° *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
TFûãrC€ff
 c⁄° *
c€ff
);

66 
	mãm∂©e
<
I¡
 
	mN
>

67 
Void
 
fûãrH‹
(
I¡
 
bôDïth
, 
Pñ
 *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
Boﬁ
 
isLa°
, 
TFûãrC€ff
 c⁄° *
c€ff
);

68 
	mãm∂©e
<
I¡
 
	mN
>

69 
Void
 
fûãrVî
(
I¡
 
bôDïth
, 
Pñ
 *
§c
, I¡ 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, 
Boﬁ
 
isFú°
, Boﬁ 
isLa°
, 
TFûãrC€ff
 c⁄° *
c€ff
);

71 
	mpublic
:

72 
	$TComI¡îpﬁ©i⁄Fûãr
() {}

73 ~
	$TComI¡îpﬁ©i⁄Fûãr
(Ë{
	}
}

75 
Void
 
fûãrH‹
(c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
 *
§c
, 
I¡
 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, I¡ 
‰ac
, 
Boﬁ
 
isLa°
, c⁄° 
ChromaF‹m©
 
fmt
, c⁄° I¡ 
bôDïth
 );

76 
Void
 
fûãrVî
(c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
 *
§c
, 
I¡
 
§cSåide
, Pñ *
d°
, I¡ 
d°Såide
, I¡ 
width
, I¡ 
height
, I¡ 
‰ac
, 
Boﬁ
 
isFú°
, Boﬁ 
isLa°
, c⁄° 
ChromaF‹m©
 
fmt
, c⁄° I¡ 
bôDïth
 );

	@TLibCommon/TComList.h

38 #i‚de‡
__TCOMLIST__


39 
	#__TCOMLIST__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~<li°
>

46 
	~<as£π.h
>

47 
	~"Comm⁄Def.h
"

49 
	~<c°dlib
>

50 
usög
 
«me•a˚
 
	g°d
;

60 
	gãm∂©e
< 
˛ass
 
	gC
 >

61 
˛ass
 
	gTComLi°
 : 
public
 
°d
::
li°
< 
C
 >

63 
public
:

64 
ty≥«me
 
	t°d
::
	tli°
<
	tC
>::
	tôî©‹
 
	tTComIãøt‹
;

66 
	gTComLi°
& 
	g›î©‹
 +–c⁄° 
TComLi°
& 
rcTComLi°
)

68 if–! 
rcTComLi°
.
em±y
() )

70 
ö£π
–
this
->
íd
(), 
rcTComLi°
.
begö
(),ÑcTComList.end());

72  *
	gthis
;

75 
C
 
p›Back
()

77 
C
 
	gcT
 = 
this
->
back
();

78 
	gthis
->
p›_back
();

79  
	gcT
;

82 
C
 
p›Fr⁄t
()

84 
C
 
	gcT
 = 
this
->
‰⁄t
();

85 
	gthis
->
p›_‰⁄t
();

86  
	gcT
;

89 
Void
 
pushBack
–c⁄° 
C
& 
rcT
 )

92 if–
	grcT
 !
NULL
 )

94 
this
->
push_back
–
rcT
);

98 
Void
 
pushFr⁄t
–c⁄° 
C
& 
rcT
 )

101 if–
	grcT
 !
NULL
 )

103 
this
->
push_‰⁄t
–
rcT
);

107 
TComIãøt‹
 
föd
–c⁄° 
C
& 
rcT
 )

109  
	g°d
::
li°
< 
C
 >::
föd
–
this
->
begö
(),Åhis->
íd
(), 
rcT
 );

	@TLibCommon/TComLoopFilter.cpp

38 
	~"TComLo›Fûãr.h
"

39 
	~"TComSli˚.h
"

40 
	~"TComMv.h
"

41 
	~"TComTU.h
"

53 
	#DEFAULT_INTRA_TC_OFFSET
 2

54 

	)

59 c⁄° 
UCh¨
 
	gTComLo›Fûãr
::
sm_tcTabÀ
[
MAX_QP
 + 1 + 
DEFAULT_INTRA_TC_OFFSET
] =

64 c⁄° 
UCh¨
 
	gTComLo›Fûãr
::
sm_bëaTabÀ
[
MAX_QP
 + 1] =

73 
	gTComLo›Fûãr
::
	$TComLo›Fûãr
()

74 : 
	`m_uiNumP¨tôi⁄s
(0)

75 , 
	$m_bLFCrossTûeBound¨y
(
åue
)

77  
I¡
 
edgeDú
 = 0;ÉdgeDú < 
NUM_EDGE_DIR
;ÉdgeDir++ )

79 
m_ØpucBS
 [
edgeDú
] = 
NULL
;

80 
m_ØpbEdgeFûãr
[
edgeDú
] = 
NULL
;

82 
	}
}

84 
	gTComLo›Fûãr
::~
	$TComLo›Fûãr
()

86 
	}
}

91 
Void
 
TComLo›Fûãr
::
	$£tCfg
–
Boﬁ
 
bLFCrossTûeBound¨y
 )

93 
m_bLFCrossTûeBound¨y
 = 
bLFCrossTûeBound¨y
;

94 
	}
}

96 
Void
 
	gTComLo›Fûãr
::
	$¸óã
–
UI¡
 
uiMaxCUDïth
 )

98 
	`de°roy
();

99 
m_uiNumP¨tôi⁄s
 = 1 << ( 
uiMaxCUDïth
<<1 );

100  
I¡
 
edgeDú
 = 0;ÉdgeDú < 
NUM_EDGE_DIR
;ÉdgeDir++ )

102 
m_ØpucBS
 [
edgeDú
] = 
√w
 
UCh¨
[
m_uiNumP¨tôi⁄s
];

103 
m_ØpbEdgeFûãr
[
edgeDú
] = 
√w
 
Boﬁ
 [
m_uiNumP¨tôi⁄s
];

105 
	}
}

107 
Void
 
	gTComLo›Fûãr
::
	$de°roy
()

109  
I¡
 
edgeDú
 = 0;ÉdgeDú < 
NUM_EDGE_DIR
;ÉdgeDir++ )

111 i‡(
m_ØpucBS
[
edgeDú
] !
NULL
)

113 
dñëe
 [] 
m_ØpucBS
[
edgeDú
];

114 
m_ØpucBS
[
edgeDú
] = 
NULL
;

117 i‡(
m_ØpbEdgeFûãr
[
edgeDú
])

119 
dñëe
 [] 
m_ØpbEdgeFûãr
[
edgeDú
];

120 
m_ØpbEdgeFûãr
[
edgeDú
] = 
NULL
;

123 
	}
}

130 
Void
 
	gTComLo›Fûãr
::
	$lo›FûãrPic
–
TComPic
* 
pcPic
 )

133  
UI¡
 
˘uRsAddr
 = 0; ctuRsAdd∏< 
pcPic
->
	`gëNumbîOfCtusInFøme
(); ctuRsAddr++ )

135 
TComD©aCU
* 
pCtu
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 );

137 ::
	`mem£t
–
m_ØpucBS
 [
EDGE_VER
], 0, –
UCh¨
 ) * 
m_uiNumP¨tôi⁄s
 );

138 ::
	`mem£t
–
m_ØpbEdgeFûãr
[
EDGE_VER
], 0, –
Boﬁ
 ) * 
m_uiNumP¨tôi⁄s
 );

141 
	`xDeblockCU
–
pCtu
, 0, 0, 
EDGE_VER
 );

145  
UI¡
 
˘uRsAddr
 = 0; ctuRsAdd∏< 
pcPic
->
	`gëNumbîOfCtusInFøme
(); ctuRsAddr++ )

147 
TComD©aCU
* 
pCtu
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 );

149 ::
	`mem£t
–
m_ØpucBS
 [
EDGE_HOR
], 0, –
UCh¨
 ) * 
m_uiNumP¨tôi⁄s
 );

150 ::
	`mem£t
–
m_ØpbEdgeFûãr
[
EDGE_HOR
], 0, –
Boﬁ
 ) * 
m_uiNumP¨tôi⁄s
 );

153 
	`xDeblockCU
–
pCtu
, 0, 0, 
EDGE_HOR
 );

155 
	}
}

170 
Void
 
	gTComLo›Fûãr
::
	$xDeblockCU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
, UI¡ 
uiDïth
, 
DeblockEdgeDú
 
edgeDú
 )

172 if(
pcCU
->
	`gëPic
()==0||pcCU->
	`gëP¨tôi⁄Size
(
uiAbsZ‹dîIdx
)==
NUMBER_OF_PART_SIZES
)

176 
TComPic
* 
pcPic
 = 
pcCU
->
	`gëPic
();

177 
UI¡
 
uiCurNumP¨ts
 = 
pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
<<1);

178 
UI¡
 
uiQNumP¨ts
 = 
uiCurNumP¨ts
>>2;

179 c⁄° 
TComSPS
 &
•s
 = *(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

181 if–
pcCU
->
	`gëDïth
(
uiAbsZ‹dîIdx
Ë> 
uiDïth
 )

183  
UI¡
 
uiP¨tIdx
 = 0; uiP¨tIdx < 4; uiP¨tIdx++, 
uiAbsZ‹dîIdx
+=
uiQNumP¨ts
 )

185 
UI¡
 
uiLPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
] ];

186 
UI¡
 
uiTPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
] ];

187 if––
uiLPñX
 < 
•s
.
	`gëPicWidthInLumaSam∂es
(ËË&& ( 
uiTPñY
 < sps.
	`gëPicHeightInLumaSam∂es
() ) )

189 
	`xDeblockCU
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
+1, 
edgeDú
 );

195 
	`xSëLo›fûãrP¨am
–
pcCU
, 
uiAbsZ‹dîIdx
 );

196 
TComTURecur£
 
	`tuRecur£
(
pcCU
, 
uiAbsZ‹dîIdx
);

197 
	`xSëEdgefûãrTU
 ( 
tuRecur£
 );

198 
	`xSëEdgefûãrPU
 ( 
pcCU
, 
uiAbsZ‹dîIdx
 );

200 c⁄° 
UI¡
 
uiPñsInP¨t
 = 
•s
.
	`gëMaxCUWidth
(Ë>> sps.
	`gëMaxTŸÆCUDïth
();

202  
UI¡
 
uiP¨tIdx
 = 
uiAbsZ‹dîIdx
; uiP¨tIdx < uiAbsZ‹dîIdx + 
uiCurNumP¨ts
; uiPartIdx++ )

204 
UI¡
 
uiBSCheck
;

205 if–
uiPñsInP¨t
 == 4 )

207 
uiBSCheck
 = (
edgeDú
 =
EDGE_VER
 && 
uiP¨tIdx
%2 =0Ë|| (edgeDú =
EDGE_HOR
 && (uiPartIdx-((uiPartIdx>>2)<<2))/2 == 0);

211 
uiBSCheck
 = 1;

214 i‡–
m_ØpbEdgeFûãr
[
edgeDú
][
uiP¨tIdx
] && 
uiBSCheck
 )

216 
	`xGëBound¨ySåígthSögÀ
 ( 
pcCU
, 
edgeDú
, 
uiP¨tIdx
 );

220 
UI¡
 
P¨tIdxIn¸
 = 
DEBLOCK_SMALLEST_BLOCK
 / 
uiPñsInP¨t
 ? DEBLOCK_SMALLEST_BLOCK / uiPelsInPart : 1 ;

222 
UI¡
 
uiSizeInPU
 = 
pcPic
->
	`gëNumP¨tInCtuWidth
()>>(
uiDïth
);

223 c⁄° 
ChromaF‹m©
 
chFmt
=
pcPic
->
	`gëChromaF‹m©
();

224 c⁄° 
UI¡
 
shi·Fa˘‹
 = 
edgeDú
 =
EDGE_VER
 ? 
pcPic
->
	`gëComp⁄ítSˇÀX
(
COMPONENT_Cb
Ë:ÖcPic->
	`gëComp⁄ítSˇÀY
(COMPONENT_Cb);

225 c⁄° 
Boﬁ
 
bAlwaysDoChroma
=
chFmt
==
CHROMA_444
;

227  
I¡
 
iEdge
 = 0; iEdgê< 
uiSizeInPU
 ; iEdge+=
P¨tIdxIn¸
)

229 
	`xEdgeFûãrLuma
 ( 
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
edgeDú
, 
iEdge
 );

230 i‡–
chFmt
!=
CHROMA_400
 && (
bAlwaysDoChroma
 ||

231 (
uiPñsInP¨t
>
DEBLOCK_SMALLEST_BLOCK
) ||

232 (
iEdge
 % ( (
DEBLOCK_SMALLEST_BLOCK
<<
shi·Fa˘‹
)/
uiPñsInP¨t
 ) ) == 0

236 
	`xEdgeFûãrChroma
 ( 
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
edgeDú
, 
iEdge
 );

239 
	}
}

241 
Void
 
	gTComLo›Fûãr
::
	$xSëEdgefûãrMu…ùÀ
–
TComD©aCU
* 
pcCU
,

242 
UI¡
 
uiAbsZ‹dîIdx
,

243 
UI¡
 
uiDïth
,

244 
DeblockEdgeDú
 
edgeDú
,

245 
I¡
 
iEdgeIdx
,

246 
Boﬁ
 
bVÆue
,

247 
UI¡
 
uiWidthInBa£Unôs
,

248 
UI¡
 
uiHeightInBa£Unôs
,

249 c⁄° 
TComRe˘™gÀ
 *
ª˘
)

251 i‡–
uiWidthInBa£Unôs
 == 0 )

253 
uiWidthInBa£Unôs
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
 (Ë>> 
uiDïth
;

255 i‡–
uiHeightInBa£Unôs
 == 0 )

257 
uiHeightInBa£Unôs
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuHeight
(Ë>> 
uiDïth
;

259 c⁄° 
UI¡
 
uiNumEÀm
 = 
edgeDú
 =
EDGE_VER
 ? 
uiHeightInBa£Unôs
 : 
uiWidthInBa£Unôs
;

260 
	`as£π
–
uiNumEÀm
 > 0 );

261 
	`as£π
–
uiWidthInBa£Unôs
 > 0 );

262 
	`as£π
–
uiHeightInBa£Unôs
 > 0 );

263  
UI¡
 
ui
 = 0; uò< 
uiNumEÀm
; ui++ )

265 c⁄° 
UI¡
 
uiBsIdx
 = 
	`xCÆcBsIdx
–
pcCU
, 
uiAbsZ‹dîIdx
, 
edgeDú
, 
iEdgeIdx
, 
ui
, 
ª˘
 );

266 
m_ØpbEdgeFûãr
[
edgeDú
][
uiBsIdx
] = 
bVÆue
;

267 i‡(
iEdgeIdx
 == 0)

269 
m_ØpucBS
[
edgeDú
][
uiBsIdx
] = 
bVÆue
;

272 
	}
}

274 
Void
 
	gTComLo›Fûãr
::
	$xSëEdgefûãrTU
–
TComTU
 &
rTu
 )

276 
TComD©aCU
* 
pcCU
 = 
rTu
.
	`gëCU
();

277 
UI¡
 
uiTønsDïthTŸÆ
 = 
rTu
.
	`GëTønsf‹mDïthTŸÆ
();

279 if–
pcCU
->
	`gëTønsf‹mIdx
–
rTu
.
	`GëAbsP¨tIdxTU
(ËË+ÖcCU->
	`gëDïth
–rTu.GëAbsP¨tIdxTU()Ë> 
uiTønsDïthTŸÆ
 )

281 
TComTURecur£
 
	`tuChûd
(
rTu
, 
Ál£
);

284 
	`xSëEdgefûãrTU
–
tuChûd
 );

285 } 
tuChûd
.
	`√xtSe˘i⁄
(
rTu
));

289 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
COMPONENT_Y
);

290 c⁄° 
TComSPS
 &
•s
=*(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

292 c⁄° 
UI¡
 
uiWidthInBa£Unôs
 = 
ª˘
.
width
 / (
•s
.
	`gëMaxCUWidth
(Ë>> sps.
	`gëMaxTŸÆCUDïth
());

293 c⁄° 
UI¡
 
uiHeightInBa£Unôs
 = 
ª˘
.
height
 / (
•s
.
	`gëMaxCUHeight
(Ë>> sps.
	`gëMaxTŸÆCUDïth
());

295 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
rTu
.
	`GëAbsP¨tIdxCU
(), 
uiTønsDïthTŸÆ
, 
EDGE_VER
, 0, 
m_°LFCUP¨am
.
bI¡î«lEdge
, 
uiWidthInBa£Unôs
, 
uiHeightInBa£Unôs
, &
ª˘
 );

296 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
rTu
.
	`GëAbsP¨tIdxCU
(), 
uiTønsDïthTŸÆ
, 
EDGE_HOR
, 0, 
m_°LFCUP¨am
.
bI¡î«lEdge
, 
uiWidthInBa£Unôs
, 
uiHeightInBa£Unôs
, &
ª˘
 );

297 
	}
}

299 
Void
 
	gTComLo›Fûãr
::
	$xSëEdgefûãrPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
 )

301 c⁄° 
UI¡
 
uiDïth
 = 
pcCU
->
	`gëDïth
–
uiAbsZ‹dîIdx
 );

302 c⁄° 
UI¡
 
uiWidthInBa£Unôs
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
 (Ë>> 
uiDïth
;

303 c⁄° 
UI¡
 
uiHeightInBa£Unôs
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuHeight
(Ë>> 
uiDïth
;

304 c⁄° 
UI¡
 
uiHWidthInBa£Unôs
 = 
uiWidthInBa£Unôs
 >> 1;

305 c⁄° 
UI¡
 
uiHHeightInBa£Unôs
 = 
uiHeightInBa£Unôs
 >> 1;

306 c⁄° 
UI¡
 
uiQWidthInBa£Unôs
 = 
uiWidthInBa£Unôs
 >> 2;

307 c⁄° 
UI¡
 
uiQHeightInBa£Unôs
 = 
uiHeightInBa£Unôs
 >> 2;

309 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_VER
, 0, 
m_°LFCUP¨am
.
bLe·Edge
 );

310 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_HOR
, 0, 
m_°LFCUP¨am
.
bT›Edge
 );

312  
pcCU
->
	`gëP¨tôi⁄Size
–
uiAbsZ‹dîIdx
 ) )

314 
SIZE_2Nx2N
:

318 
SIZE_2NxN
:

320 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_HOR
, 
uiHHeightInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

323 
SIZE_Nx2N
:

325 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_VER
, 
uiHWidthInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

328 
SIZE_NxN
:

330 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_VER
, 
uiHWidthInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

331 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_HOR
, 
uiHHeightInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

334 
SIZE_2NxnU
:

336 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_HOR
, 
uiQHeightInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

339 
SIZE_2NxnD
:

341 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_HOR
, 
uiHeightInBa£Unôs
 - 
uiQHeightInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

344 
SIZE_nLx2N
:

346 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_VER
, 
uiQWidthInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

349 
SIZE_nRx2N
:

351 
	`xSëEdgefûãrMu…ùÀ
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
EDGE_VER
, 
uiWidthInBa£Unôs
 - 
uiQWidthInBa£Unôs
, 
m_°LFCUP¨am
.
bI¡î«lEdge
 );

359 
	}
}

362 
Void
 
	gTComLo›Fûãr
::
	$xSëLo›fûãrP¨am
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
 )

364 
UI¡
 
uiX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[ 
uiAbsZ‹dîIdx
 ] ];

365 
UI¡
 
uiY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[ 
uiAbsZ‹dîIdx
 ] ];

367 
UI¡
 
uiTempP¨tIdx
;

369 
m_°LFCUP¨am
.
bI¡î«lEdge
 = ! 
pcCU
->
	`gëSli˚
()->
	`gëDeblockögFûãrDißbÀ
();

371 i‡–(
uiX
 =0Ë|| 
pcCU
->
	`gëSli˚
()->
	`gëDeblockögFûãrDißbÀ
() )

373 
m_°LFCUP¨am
.
bLe·Edge
 = 
Ál£
;

377 
m_°LFCUP¨am
.
bLe·Edge
 = 
åue
;

379 i‡–
m_°LFCUP¨am
.
bLe·Edge
 )

381 c⁄° 
TComD©aCU
* 
pcTempCU
 = 
pcCU
->
	`gëPULe·
–
uiTempP¨tIdx
, 
uiAbsZ‹dîIdx
, !pcCU->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
(), !
m_bLFCrossTûeBound¨y
);

383 i‡–
pcTempCU
 !
NULL
 )

385 
m_°LFCUP¨am
.
bLe·Edge
 = 
åue
;

389 
m_°LFCUP¨am
.
bLe·Edge
 = 
Ál£
;

393 i‡–(
uiY
 =0 ) || 
pcCU
->
	`gëSli˚
()->
	`gëDeblockögFûãrDißbÀ
() )

395 
m_°LFCUP¨am
.
bT›Edge
 = 
Ál£
;

399 
m_°LFCUP¨am
.
bT›Edge
 = 
åue
;

401 i‡–
m_°LFCUP¨am
.
bT›Edge
 )

403 c⁄° 
TComD©aCU
* 
pcTempCU
 = 
pcCU
->
	`gëPUAbove
–
uiTempP¨tIdx
, 
uiAbsZ‹dîIdx
, !pcCU->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
(), 
Ál£
, !
m_bLFCrossTûeBound¨y
);

405 i‡–
pcTempCU
 !
NULL
 )

407 
m_°LFCUP¨am
.
bT›Edge
 = 
åue
;

411 
m_°LFCUP¨am
.
bT›Edge
 = 
Ál£
;

414 
	}
}

416 
Void
 
	gTComLo›Fûãr
::
	$xGëBound¨ySåígthSögÀ
 ( 
TComD©aCU
* 
pCtu
, 
DeblockEdgeDú
 
edgeDú
, 
UI¡
 
uiAbsP¨tIdx4x4BlockWôhöCtu
 )

418 
TComSli˚
 * c⁄° 
pcSli˚
 = 
pCtu
->
	`gëSli˚
();

420 c⁄° 
Boﬁ
 
lfCrossSli˚Bound¨yFœg
=
pCtu
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
();

422 c⁄° 
UI¡
 
uiP¨tQ
 = 
uiAbsP¨tIdx4x4BlockWôhöCtu
;

423 
TComD©aCU
* c⁄° 
pcCUQ
 = 
pCtu
;

425 
UI¡
 
uiP¨tP
;

426 c⁄° 
TComD©aCU
* 
pcCUP
;

427 
UI¡
 
uiBs
 = 0;

430 i‡(
edgeDú
 =
EDGE_VER
)

432 
pcCUP
 = 
pcCUQ
->
	`gëPULe·
(
uiP¨tP
, 
uiP¨tQ
, !
lfCrossSli˚Bound¨yFœg
, !
m_bLFCrossTûeBound¨y
);

436 
pcCUP
 = 
pcCUQ
->
	`gëPUAbove
(
uiP¨tP
, 
uiP¨tQ
, !
pCtu
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
(), 
Ál£
, !
m_bLFCrossTûeBound¨y
);

440 i‡–
pcCUP
->
	`isI¡ø
(
uiP¨tP
Ë|| 
pcCUQ
->isI¡ø(
uiP¨tQ
) )

442 
uiBs
 = 2;

446 i‡–!
pcCUP
->
	`isI¡ø
(
uiP¨tP
Ë&& !
pcCUQ
->isI¡ø(
uiP¨tQ
) )

448 
UI¡
 
nsP¨tQ
 = 
uiP¨tQ
;

449 
UI¡
 
nsP¨tP
 = 
uiP¨tP
;

451 i‡–
m_ØpucBS
[
edgeDú
][
uiAbsP¨tIdx4x4BlockWôhöCtu
] && (
pcCUQ
->
	`gëCbf
–
nsP¨tQ
, 
COMPONENT_Y
,ÖcCUQ->
	`gëTønsf‹mIdx
“sP¨tQ)Ë!0 || 
pcCUP
->gëCbf–
nsP¨tP
, COMPONENT_Y,ÖcCUP->getTransformIdx(nsPartP) ) != 0) )

453 
uiBs
 = 1;

457 i‡(
pcSli˚
->
	`isI¡îB
(Ë|| 
pcCUP
->
	`gëSli˚
()->isInterB())

459 
I¡
 
iRefIdx
;

460 
iRefIdx
 = 
pcCUP
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëRefIdx
(
uiP¨tP
);

461 c⁄° 
TComPic
 *
piRefP0
 = (
iRefIdx
 < 0Ë? 
NULL
 : 
pcCUP
->
	`gëSli˚
()->
	`gëRefPic
(
REF_PIC_LIST_0
, iRefIdx);

462 
iRefIdx
 = 
pcCUP
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`gëRefIdx
(
uiP¨tP
);

463 c⁄° 
TComPic
 *
piRefP1
 = (
iRefIdx
 < 0Ë? 
NULL
 : 
pcCUP
->
	`gëSli˚
()->
	`gëRefPic
(
REF_PIC_LIST_1
, iRefIdx);

464 
iRefIdx
 = 
pcCUQ
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëRefIdx
(
uiP¨tQ
);

465 c⁄° 
TComPic
 *
piRefQ0
 = (
iRefIdx
 < 0Ë? 
NULL
 : 
pcSli˚
->
	`gëRefPic
(
REF_PIC_LIST_0
, iRefIdx);

466 
iRefIdx
 = 
pcCUQ
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`gëRefIdx
(
uiP¨tQ
);

467 c⁄° 
TComPic
 *
piRefQ1
 = (
iRefIdx
 < 0Ë? 
NULL
 : 
pcSli˚
->
	`gëRefPic
(
REF_PIC_LIST_1
, iRefIdx);

469 
TComMv
 
pcMvP0
 = 
pcCUP
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëMv
(
uiP¨tP
);

470 
TComMv
 
pcMvP1
 = 
pcCUP
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`gëMv
(
uiP¨tP
);

471 
TComMv
 
pcMvQ0
 = 
pcCUQ
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëMv
(
uiP¨tQ
);

472 
TComMv
 
pcMvQ1
 = 
pcCUQ
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`gëMv
(
uiP¨tQ
);

474 i‡(
piRefP0
 =
NULL
)

476 
pcMvP0
.
	`£tZîo
();

478 i‡(
piRefP1
 =
NULL
)

480 
pcMvP1
.
	`£tZîo
();

482 i‡(
piRefQ0
 =
NULL
)

484 
pcMvQ0
.
	`£tZîo
();

486 i‡(
piRefQ1
 =
NULL
)

488 
pcMvQ1
.
	`£tZîo
();

491 i‡–((
piRefP0
==
piRefQ0
)&&(
piRefP1
==
piRefQ1
)) || ((piRefP0==piRefQ1)&&(piRefP1==piRefQ0)) )

493 i‡–
piRefP0
 !
piRefP1
 )

495 i‡–
piRefP0
 =
piRefQ0
 )

497 
uiBs
 = ((
	`abs
(
pcMvQ0
.
	`gëH‹
(Ë- 
pcMvP0
.getHor()) >= 4) ||

498 (
	`abs
(
pcMvQ0
.
	`gëVî
(Ë- 
pcMvP0
.getVer()) >= 4) ||

499 (
	`abs
(
pcMvQ1
.
	`gëH‹
(Ë- 
pcMvP1
.getHor()) >= 4) ||

500 (
	`abs
(
pcMvQ1
.
	`gëVî
(Ë- 
pcMvP1
.getVer()) >= 4)) ? 1 : 0;

504 
uiBs
 = ((
	`abs
(
pcMvQ1
.
	`gëH‹
(Ë- 
pcMvP0
.getHor()) >= 4) ||

505 (
	`abs
(
pcMvQ1
.
	`gëVî
(Ë- 
pcMvP0
.getVer()) >= 4) ||

506 (
	`abs
(
pcMvQ0
.
	`gëH‹
(Ë- 
pcMvP1
.getHor()) >= 4) ||

507 (
	`abs
(
pcMvQ0
.
	`gëVî
(Ë- 
pcMvP1
.getVer()) >= 4)) ? 1 : 0;

512 
uiBs
 = ((
	`abs
(
pcMvQ0
.
	`gëH‹
(Ë- 
pcMvP0
.getHor()) >= 4) ||

513 (
	`abs
(
pcMvQ0
.
	`gëVî
(Ë- 
pcMvP0
.getVer()) >= 4) ||

514 (
	`abs
(
pcMvQ1
.
	`gëH‹
(Ë- 
pcMvP1
.getHor()) >= 4) ||

515 (
	`abs
(
pcMvQ1
.
	`gëVî
(Ë- 
pcMvP1
.getVer()) >= 4)) &&

516 ((
	`abs
(
pcMvQ1
.
	`gëH‹
(Ë- 
pcMvP0
.getHor()) >= 4) ||

517 (
	`abs
(
pcMvQ1
.
	`gëVî
(Ë- 
pcMvP0
.getVer()) >= 4) ||

518 (
	`abs
(
pcMvQ0
.
	`gëH‹
(Ë- 
pcMvP1
.getHor()) >= 4) ||

519 (
	`abs
(
pcMvQ0
.
	`gëVî
(Ë- 
pcMvP1
.getVer()) >= 4)) ? 1 : 0;

524 
uiBs
 = 1;

529 
I¡
 
iRefIdx
;

530 
iRefIdx
 = 
pcCUP
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëRefIdx
(
uiP¨tP
);

531 c⁄° 
TComPic
 *
piRefP0
 = (
iRefIdx
 < 0Ë? 
NULL
 : 
pcCUP
->
	`gëSli˚
()->
	`gëRefPic
(
REF_PIC_LIST_0
, iRefIdx);

532 
iRefIdx
 = 
pcCUQ
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëRefIdx
(
uiP¨tQ
);

533 c⁄° 
TComPic
 *
piRefQ0
 = (
iRefIdx
 < 0Ë? 
NULL
 : 
pcSli˚
->
	`gëRefPic
(
REF_PIC_LIST_0
, iRefIdx);

534 
TComMv
 
pcMvP0
 = 
pcCUP
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëMv
(
uiP¨tP
);

535 
TComMv
 
pcMvQ0
 = 
pcCUQ
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëMv
(
uiP¨tQ
);

537 i‡(
piRefP0
 =
NULL
)

539 
pcMvP0
.
	`£tZîo
();

541 i‡(
piRefQ0
 =
NULL
)

543 
pcMvQ0
.
	`£tZîo
();

546 
uiBs
 = ((
piRefP0
 !
piRefQ0
) ||

547 (
	`abs
(
pcMvQ0
.
	`gëH‹
(Ë- 
pcMvP0
.getHor()) >= 4) ||

548 (
	`abs
(
pcMvQ0
.
	`gëVî
(Ë- 
pcMvP0
.getVer()) >= 4)) ? 1 : 0;

553 
m_ØpucBS
[
edgeDú
][
uiAbsP¨tIdx4x4BlockWôhöCtu
] = 
uiBs
;

554 
	}
}

557 
Void
 
	gTComLo›Fûãr
::
	$xEdgeFûãrLuma
–
TComD©aCU
* c⁄° 
pcCU
, c⁄° 
UI¡
 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiDïth
, c⁄° 
DeblockEdgeDú
 
edgeDú
, c⁄° 
I¡
 
iEdge
 )

559 
TComPicYuv
 *
pcPicYuvRec
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
();

560 
Pñ
 *
piSrc
 = 
pcPicYuvRec
->
	`gëAddr
(
COMPONENT_Y
, 
pcCU
->
	`gëCtuRsAddr
(), 
uiAbsZ‹dîIdx
 );

561 
Pñ
 *
piTmpSrc
 = 
piSrc
;

562 c⁄° 
TComSPS
 &
•s
 = *(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

563 c⁄° 
Boﬁ
 
µsTønsqu™tBy∑ssE«bÀdFœg
 = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
();

564 c⁄° 
I¡
 
bôDïthLuma
 = 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
);

565 c⁄° 
Boﬁ
 
lfCrossSli˚Bound¨yFœg
 = 
pcCU
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
();

567 
I¡
 
iSåide
 = 
pcPicYuvRec
->
	`gëSåide
(
COMPONENT_Y
);

568 
I¡
 
iQP
 = 0;

569 
I¡
 
iQP_P
 = 0;

570 
I¡
 
iQP_Q
 = 0;

571 
UI¡
 
uiNumP¨ts
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
()>>
uiDïth
;

573 
UI¡
 
uiPñsInP¨t
 = 
•s
.
	`gëMaxCUWidth
(Ë>> sps.
	`gëMaxTŸÆCUDïth
();

574 
UI¡
 
uiBsAbsIdx
 = 0, 
uiBs
 = 0;

575 
I¡
 
iOff£t
, 
iSrcSãp
;

577 
Boﬁ
 
bPCMFûãr
 = (
•s
.
	`gëU£PCM
(Ë&& sps.
	`gëPCMFûãrDißbÀFœg
())? 
åue
 : 
Ál£
;

578 
Boﬁ
 
bP¨tPNoFûãr
 = 
Ál£
;

579 
Boﬁ
 
bP¨tQNoFûãr
 = 
Ál£
;

580 
UI¡
 
uiP¨tPIdx
 = 0;

581 
UI¡
 
uiP¨tQIdx
 = 0;

582 c⁄° 
TComD©aCU
* 
pcCUP
 = 
pcCU
;

583 
TComD©aCU
* 
pcCUQ
 = 
pcCU
;

584 
I¡
 
bëaOff£tDiv2
 = 
pcCUQ
->
	`gëSli˚
()->
	`gëDeblockögFûãrBëaOff£tDiv2
();

585 
I¡
 
tcOff£tDiv2
 = 
pcCUQ
->
	`gëSli˚
()->
	`gëDeblockögFûãrTcOff£tDiv2
();

587 i‡(
edgeDú
 =
EDGE_VER
)

589 
iOff£t
 = 1;

590 
iSrcSãp
 = 
iSåide
;

591 
piTmpSrc
 +
iEdge
*
uiPñsInP¨t
;

595 
iOff£t
 = 
iSåide
;

596 
iSrcSãp
 = 1;

597 
piTmpSrc
 +
iEdge
*
uiPñsInP¨t
*
iSåide
;

600 c⁄° 
I¡
 
iBôdïthSˇÀ
 = 1 << (
bôDïthLuma
-8);

602  
UI¡
 
iIdx
 = 0; iIdx < 
uiNumP¨ts
; iIdx++ )

604 
uiBsAbsIdx
 = 
	`xCÆcBsIdx
–
pcCU
, 
uiAbsZ‹dîIdx
, 
edgeDú
, 
iEdge
, 
iIdx
);

605 
uiBs
 = 
m_ØpucBS
[
edgeDú
][
uiBsAbsIdx
];

606 i‡–
uiBs
 )

608 
iQP_Q
 = 
pcCU
->
	`gëQP
–
uiBsAbsIdx
 );

609 
uiP¨tQIdx
 = 
uiBsAbsIdx
;

611 i‡(
edgeDú
 =
EDGE_VER
)

613 
pcCUP
 = 
pcCUQ
->
	`gëPULe·
 (
uiP¨tPIdx
, 
uiP¨tQIdx
,!
lfCrossSli˚Bound¨yFœg
, !
m_bLFCrossTûeBound¨y
);

617 
pcCUP
 = 
pcCUQ
->
	`gëPUAbove
(
uiP¨tPIdx
, 
uiP¨tQIdx
,!
lfCrossSli˚Bound¨yFœg
, 
Ál£
, !
m_bLFCrossTûeBound¨y
);

620 
iQP_P
 = 
pcCUP
->
	`gëQP
(
uiP¨tPIdx
);

621 
iQP
 = (
iQP_P
 + 
iQP_Q
 + 1) >> 1;

623 
I¡
 
iIndexTC
 = 
	`Clù3
(0, 
MAX_QP
+
DEFAULT_INTRA_TC_OFFSET
, 
	`I¡
(
iQP
 + DEFAULT_INTRA_TC_OFFSET*(
uiBs
-1Ë+ (
tcOff£tDiv2
 << 1)));

624 
I¡
 
iIndexB
 = 
	`Clù3
(0, 
MAX_QP
, 
iQP
 + (
bëaOff£tDiv2
 << 1));

626 
I¡
 
iTc
 = 
sm_tcTabÀ
[
iIndexTC
]*
iBôdïthSˇÀ
;

627 
I¡
 
iBëa
 = 
sm_bëaTabÀ
[
iIndexB
]*
iBôdïthSˇÀ
;

628 
I¡
 
iSideThªshﬁd
 = (
iBëa
+(iBeta>>1))>>3;

629 
I¡
 
iThrCut
 = 
iTc
*10;

632 
UI¡
 
uiBlocksInP¨t
 = 
uiPñsInP¨t
 / 4 ? uiPelsInPart / 4 : 1;

633 
UI¡
 
iBlkIdx
 = 0; iBlkIdx<
uiBlocksInP¨t
; iBlkIdx ++)

635 
I¡
 
dp0
 = 
	`xCÆcDP
–
piTmpSrc
+
iSrcSãp
*(
iIdx
*
uiPñsInP¨t
+
iBlkIdx
*4+0), 
iOff£t
);

636 
I¡
 
dq0
 = 
	`xCÆcDQ
–
piTmpSrc
+
iSrcSãp
*(
iIdx
*
uiPñsInP¨t
+
iBlkIdx
*4+0), 
iOff£t
);

637 
I¡
 
dp3
 = 
	`xCÆcDP
–
piTmpSrc
+
iSrcSãp
*(
iIdx
*
uiPñsInP¨t
+
iBlkIdx
*4+3), 
iOff£t
);

638 
I¡
 
dq3
 = 
	`xCÆcDQ
–
piTmpSrc
+
iSrcSãp
*(
iIdx
*
uiPñsInP¨t
+
iBlkIdx
*4+3), 
iOff£t
);

639 
I¡
 
d0
 = 
dp0
 + 
dq0
;

640 
I¡
 
d3
 = 
dp3
 + 
dq3
;

642 
I¡
 
dp
 = 
dp0
 + 
dp3
;

643 
I¡
 
dq
 = 
dq0
 + 
dq3
;

644 
I¡
 
d
 = 
d0
 + 
d3
;

646 i‡(
bPCMFûãr
 || 
µsTønsqu™tBy∑ssE«bÀdFœg
)

649 
bP¨tPNoFûãr
 = (
bPCMFûãr
 && 
pcCUP
->
	`gëIPCMFœg
(
uiP¨tPIdx
));

650 
bP¨tQNoFûãr
 = (
bPCMFûãr
 && 
pcCUQ
->
	`gëIPCMFœg
(
uiP¨tQIdx
));

653 
bP¨tPNoFûãr
 = bP¨tPNoFûã∏|| (
pcCUP
->
	`isLos¶essCoded
(
uiP¨tPIdx
) );

654 
bP¨tQNoFûãr
 = bP¨tQNoFûã∏|| (
pcCUQ
->
	`isLos¶essCoded
(
uiP¨tQIdx
) );

657 i‡(
d
 < 
iBëa
)

659 
Boﬁ
 
bFûãrP
 = (
dp
 < 
iSideThªshﬁd
);

660 
Boﬁ
 
bFûãrQ
 = (
dq
 < 
iSideThªshﬁd
);

662 
Boﬁ
 
sw
 = 
	`xU£Så⁄gFûãrög
–
iOff£t
, 2*
d0
, 
iBëa
, 
iTc
, 
piTmpSrc
+
iSrcSãp
*(
iIdx
*
uiPñsInP¨t
+
iBlkIdx
*4+0))

663 && 
	`xU£Så⁄gFûãrög
–
iOff£t
, 2*
d3
, 
iBëa
, 
iTc
, 
piTmpSrc
+
iSrcSãp
*(
iIdx
*
uiPñsInP¨t
+
iBlkIdx
*4+3));

665  
I¡
 
i
 = 0; i < 
DEBLOCK_SMALLEST_BLOCK
/2; i++)

667 
	`xPñFûãrLuma
–
piTmpSrc
+
iSrcSãp
*(
iIdx
*
uiPñsInP¨t
+
iBlkIdx
*4+
i
), 
iOff£t
, 
iTc
, 
sw
, 
bP¨tPNoFûãr
, 
bP¨tQNoFûãr
, 
iThrCut
, 
bFûãrP
, 
bFûãrQ
, 
bôDïthLuma
);

673 
	}
}

676 
Void
 
	gTComLo›Fûãr
::
	$xEdgeFûãrChroma
–
TComD©aCU
* c⁄° 
pcCU
, c⁄° 
UI¡
 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiDïth
, c⁄° 
DeblockEdgeDú
 
edgeDú
, c⁄° 
I¡
 
iEdge
 )

678 
TComPicYuv
 *
pcPicYuvRec
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
();

679 
I¡
 
iSåide
 = 
pcPicYuvRec
->
	`gëSåide
(
COMPONENT_Cb
);

680 
Pñ
 *
piSrcCb
 = 
pcPicYuvRec
->
	`gëAddr
–
COMPONENT_Cb
, 
pcCU
->
	`gëCtuRsAddr
(), 
uiAbsZ‹dîIdx
 );

681 
Pñ
 *
piSrcCr
 = 
pcPicYuvRec
->
	`gëAddr
–
COMPONENT_Cr
, 
pcCU
->
	`gëCtuRsAddr
(), 
uiAbsZ‹dîIdx
 );

682 c⁄° 
TComSPS
 &
•s
 = *(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

683 c⁄° 
I¡
 
bôDïthChroma
 = 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_CHROMA
);

685 c⁄° 
UI¡
 
uiPñsInP¨tChromaH
 = 
•s
.
	`gëMaxCUWidth
(Ë>> (•s.
	`gëMaxTŸÆCUDïth
()+
pcPicYuvRec
->
	`gëComp⁄ítSˇÀX
(
COMPONENT_Cb
));

686 c⁄° 
UI¡
 
uiPñsInP¨tChromaV
 = 
•s
.
	`gëMaxCUHeight
(Ë>> (•s.
	`gëMaxTŸÆCUDïth
()+
pcPicYuvRec
->
	`gëComp⁄ítSˇÀY
(
COMPONENT_Cb
));

688 
I¡
 
iQP
 = 0;

689 
I¡
 
iQP_P
 = 0;

690 
I¡
 
iQP_Q
 = 0;

692 
I¡
 
iOff£t
, 
iSrcSãp
;

693 
UI¡
 
uiLo›Lígth
;

695 c⁄° 
UI¡
 
uiCtuWidthInBa£Unôs
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
();

697 
Boﬁ
 
bPCMFûãr
 = (
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëU£PCM
(Ë&&ÖcCU->gëSli˚()->gëSPS()->
	`gëPCMFûãrDißbÀFœg
())? 
åue
 : 
Ál£
;

698 
Boﬁ
 
bP¨tPNoFûãr
 = 
Ál£
;

699 
Boﬁ
 
bP¨tQNoFûãr
 = 
Ál£
;

700 
TComD©aCU
* 
pcCUQ
 = 
pcCU
;

701 
I¡
 
tcOff£tDiv2
 = 
pcCU
->
	`gëSli˚
()->
	`gëDeblockögFûãrTcOff£tDiv2
();

704 
UI¡
 
uiEdgeNumInCtuVît
 = 
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
]%
uiCtuWidthInBa£Unôs
 + 
iEdge
;

705 
UI¡
 
uiEdgeNumInCtuH‹
 = 
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
]/
uiCtuWidthInBa£Unôs
 + 
iEdge
;

707 i‡–(
uiPñsInP¨tChromaH
 < 
DEBLOCK_SMALLEST_BLOCK
Ë&& (
uiPñsInP¨tChromaV
 < DEBLOCK_SMALLEST_BLOCK) &&

709 –(
uiEdgeNumInCtuVît
%(
DEBLOCK_SMALLEST_BLOCK
/
uiPñsInP¨tChromaH
)Ë&& (
edgeDú
==
EDGE_VER
) ) ||

710 –(
uiEdgeNumInCtuH‹
 %(
DEBLOCK_SMALLEST_BLOCK
/
uiPñsInP¨tChromaV
)Ë&& (
edgeDú
==
EDGE_HOR
) )

718 c⁄° 
Boﬁ
 
lfCrossSli˚Bound¨yFœg
=
pcCU
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
();

720 
UI¡
 
uiNumP¨ts
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
()>>
uiDïth
;

722 
UI¡
 
uiBsAbsIdx
;

723 
UCh¨
 
ucBs
;

725 
Pñ
* 
piTmpSrcCb
 = 
piSrcCb
;

726 
Pñ
* 
piTmpSrcCr
 = 
piSrcCr
;

728 i‡(
edgeDú
 =
EDGE_VER
)

730 
iOff£t
 = 1;

731 
iSrcSãp
 = 
iSåide
;

732 
piTmpSrcCb
 +
iEdge
*
uiPñsInP¨tChromaH
;

733 
piTmpSrcCr
 +
iEdge
*
uiPñsInP¨tChromaH
;

734 
uiLo›Lígth
=
uiPñsInP¨tChromaV
;

738 
iOff£t
 = 
iSåide
;

739 
iSrcSãp
 = 1;

740 
piTmpSrcCb
 +
iEdge
*
iSåide
*
uiPñsInP¨tChromaV
;

741 
piTmpSrcCr
 +
iEdge
*
iSåide
*
uiPñsInP¨tChromaV
;

742 
uiLo›Lígth
=
uiPñsInP¨tChromaH
;

745 c⁄° 
I¡
 
iBôdïthSˇÀ
 = 1 << (
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_CHROMA
)-8);

747  
UI¡
 
iIdx
 = 0; iIdx < 
uiNumP¨ts
; iIdx++ )

749 
uiBsAbsIdx
 = 
	`xCÆcBsIdx
–
pcCU
, 
uiAbsZ‹dîIdx
, 
edgeDú
, 
iEdge
, 
iIdx
);

750 
ucBs
 = 
m_ØpucBS
[
edgeDú
][
uiBsAbsIdx
];

752 i‡–
ucBs
 > 1)

754 
iQP_Q
 = 
pcCU
->
	`gëQP
–
uiBsAbsIdx
 );

755 
UI¡
 
uiP¨tQIdx
 = 
uiBsAbsIdx
;

757 c⁄° 
TComD©aCU
* 
pcCUP
;

758 
UI¡
 
uiP¨tPIdx
;

760 i‡(
edgeDú
 =
EDGE_VER
)

762 
pcCUP
 = 
pcCUQ
->
	`gëPULe·
 (
uiP¨tPIdx
, 
uiP¨tQIdx
,!
lfCrossSli˚Bound¨yFœg
, !
m_bLFCrossTûeBound¨y
);

766 
pcCUP
 = 
pcCUQ
->
	`gëPUAbove
(
uiP¨tPIdx
, 
uiP¨tQIdx
,!
lfCrossSli˚Bound¨yFœg
, 
Ál£
, !
m_bLFCrossTûeBound¨y
);

769 
iQP_P
 = 
pcCUP
->
	`gëQP
(
uiP¨tPIdx
);

771 i‡(
bPCMFûãr
 || 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

774 
bP¨tPNoFûãr
 = (
bPCMFûãr
 && 
pcCUP
->
	`gëIPCMFœg
(
uiP¨tPIdx
));

775 
bP¨tQNoFûãr
 = (
bPCMFûãr
 && 
pcCUQ
->
	`gëIPCMFœg
(
uiP¨tQIdx
));

778 
bP¨tPNoFûãr
 = bP¨tPNoFûã∏|| (
pcCUP
->
	`isLos¶essCoded
(
uiP¨tPIdx
));

779 
bP¨tQNoFûãr
 = bP¨tQNoFûã∏|| (
pcCUQ
->
	`isLos¶essCoded
(
uiP¨tQIdx
));

782  
UI¡
 
chromaIdx
 = 0; chromaIdx < 2; chromaIdx++ )

784 
I¡
 
chromaQPOff£t
 = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëQpOff£t
(
	`Comp⁄ítID
(
chromaIdx
 + 1));

785 
Pñ
* 
piTmpSrcChroma
 = (
chromaIdx
 =0Ë? 
piTmpSrcCb
 : 
piTmpSrcCr
;

787 
iQP
 = ((
iQP_P
 + 
iQP_Q
 + 1Ë>> 1Ë+ 
chromaQPOff£t
;

788 i‡(
iQP
 >
chromaQPM≠pögTabÀSize
)

790 i‡(
pcPicYuvRec
->
	`gëChromaF‹m©
()==
CHROMA_420
)

792 
iQP
 -=6;

794 i‡(
iQP
>51)

796 
iQP
=51;

799 i‡(
iQP
 >= 0 )

801 
iQP
 = 
	`gëSˇÀdChromaQP
(iQP, 
pcPicYuvRec
->
	`gëChromaF‹m©
());

804 
I¡
 
iIndexTC
 = 
	`Clù3
(0, 
MAX_QP
+
DEFAULT_INTRA_TC_OFFSET
, 
iQP
 + DEFAULT_INTRA_TC_OFFSET*(
ucBs
 - 1Ë+ (
tcOff£tDiv2
 << 1));

805 
I¡
 
iTc
 = 
sm_tcTabÀ
[
iIndexTC
]*
iBôdïthSˇÀ
;

807  
UI¡
 
uiSãp
 = 0; uiSã∞< 
uiLo›Lígth
; uiStep++ )

809 
	`xPñFûãrChroma
–
piTmpSrcChroma
 + 
iSrcSãp
*(
uiSãp
+
iIdx
*
uiLo›Lígth
), 
iOff£t
, 
iTc
 , 
bP¨tPNoFûãr
, 
bP¨tQNoFûãr
, 
bôDïthChroma
);

814 
	}
}

830 
__ölöe
 
Void
 
	gTComLo›Fûãr
::
	$xPñFûãrLuma
–
Pñ
* 
piSrc
, 
I¡
 
iOff£t
, I¡ 
tc
, 
Boﬁ
 
sw
, Boﬁ 
bP¨tPNoFûãr
, Boﬁ 
bP¨tQNoFûãr
, I¡ 
iThrCut
, Boﬁ 
bFûãrSec⁄dP
, Boﬁ 
bFûãrSec⁄dQ
, c⁄° I¡ 
bôDïthLuma
)

832 
I¡
 
dñè
;

834 
Pñ
 
m4
 = 
piSrc
[0];

835 
Pñ
 
m3
 = 
piSrc
[-
iOff£t
];

836 
Pñ
 
m5
 = 
piSrc
[ 
iOff£t
];

837 
Pñ
 
m2
 = 
piSrc
[-
iOff£t
*2];

838 
Pñ
 
m6
 = 
piSrc
[ 
iOff£t
*2];

839 
Pñ
 
m1
 = 
piSrc
[-
iOff£t
*3];

840 
Pñ
 
m7
 = 
piSrc
[ 
iOff£t
*3];

841 
Pñ
 
m0
 = 
piSrc
[-
iOff£t
*4];

843 i‡(
sw
)

845 
piSrc
[-
iOff£t
] = 
	`Clù3
(
m3
-2*
tc
, m3+2*tc, ((
m1
 + 2*
m2
 + 2*m3 + 2*
m4
 + 
m5
 + 4) >> 3));

846 
piSrc
[0] = 
	`Clù3
(
m4
-2*
tc
, m4+2*tc, ((
m2
 + 2*
m3
 + 2*m4 + 2*
m5
 + 
m6
 + 4) >> 3));

847 
piSrc
[-
iOff£t
*2] = 
	`Clù3
(
m2
-2*
tc
, m2+2*tc, ((
m1
 + m2 + 
m3
 + 
m4
 + 2)>>2));

848 
piSrc
[ 
iOff£t
] = 
	`Clù3
(
m5
-2*
tc
, m5+2*tc, ((
m3
 + 
m4
 + m5 + 
m6
 + 2)>>2));

849 
piSrc
[-
iOff£t
*3] = 
	`Clù3
(
m1
-2*
tc
, m1+2*tc, ((2*
m0
 + 3*m1 + 
m2
 + 
m3
 + 
m4
 + 4 )>>3));

850 
piSrc
[ 
iOff£t
*2] = 
	`Clù3
(
m6
-2*
tc
, m6+2*tc, ((
m3
 + 
m4
 + 
m5
 + 3*m6 + 2*
m7
 +4 )>>3));

855 
dñè
 = (9*(
m4
-
m3
Ë-3*(
m5
-
m2
) + 8)>>4 ;

857 i‡–
	`abs
(
dñè
Ë< 
iThrCut
 )

859 
dñè
 = 
	`Clù3
(-
tc
,Åc, delta);

860 
piSrc
[-
iOff£t
] = 
	`ClùBD
((
m3
+
dñè
), 
bôDïthLuma
);

861 
piSrc
[0] = 
	`ClùBD
((
m4
-
dñè
), 
bôDïthLuma
);

863 
I¡
 
tc2
 = 
tc
>>1;

864 if(
bFûãrSec⁄dP
)

866 
I¡
 
dñè1
 = 
	`Clù3
(-
tc2
,Åc2, (–((
m1
+
m3
+1)>>1)- 
m2
+
dñè
)>>1));

867 
piSrc
[-
iOff£t
*2] = 
	`ClùBD
((
m2
+
dñè1
), 
bôDïthLuma
);

869 if(
bFûãrSec⁄dQ
)

871 
I¡
 
dñè2
 = 
	`Clù3
(-
tc2
,Åc2, (–((
m6
+
m4
+1)>>1)- 
m5
-
dñè
)>>1));

872 
piSrc
[ 
iOff£t
] = 
	`ClùBD
((
m5
+
dñè2
), 
bôDïthLuma
);

877 if(
bP¨tPNoFûãr
)

879 
piSrc
[-
iOff£t
] = 
m3
;

880 
piSrc
[-
iOff£t
*2] = 
m2
;

881 
piSrc
[-
iOff£t
*3] = 
m1
;

883 if(
bP¨tQNoFûãr
)

885 
piSrc
[0] = 
m4
;

886 
piSrc
[ 
iOff£t
] = 
m5
;

887 
piSrc
[ 
iOff£t
*2] = 
m6
;

889 
	}
}

901 
__ölöe
 
Void
 
	gTComLo›Fûãr
::
	$xPñFûãrChroma
–
Pñ
* 
piSrc
, 
I¡
 
iOff£t
, I¡ 
tc
, 
Boﬁ
 
bP¨tPNoFûãr
, Boﬁ 
bP¨tQNoFûãr
, c⁄° I¡ 
bôDïthChroma
)

903 
I¡
 
dñè
;

905 
Pñ
 
m4
 = 
piSrc
[0];

906 
Pñ
 
m3
 = 
piSrc
[-
iOff£t
];

907 
Pñ
 
m5
 = 
piSrc
[ 
iOff£t
];

908 
Pñ
 
m2
 = 
piSrc
[-
iOff£t
*2];

910 
dñè
 = 
	`Clù3
(-
tc
,tc, (((–
m4
 - 
m3
 ) << 2 ) + 
m2
 - 
m5
 + 4 ) >> 3) );

911 
piSrc
[-
iOff£t
] = 
	`ClùBD
((
m3
+
dñè
), 
bôDïthChroma
);

912 
piSrc
[0] = 
	`ClùBD
((
m4
-
dñè
), 
bôDïthChroma
);

914 if(
bP¨tPNoFûãr
)

916 
piSrc
[-
iOff£t
] = 
m3
;

918 if(
bP¨tQNoFûãr
)

920 
piSrc
[0] = 
m4
;

922 
	}
}

933 
__ölöe
 
Boﬁ
 
	gTComLo›Fûãr
::
	$xU£Så⁄gFûãrög
–
I¡
 
off£t
, I¡ 
d
, I¡ 
bëa
, I¡ 
tc
, 
Pñ
* 
piSrc
)

935 
Pñ
 
m4
 = 
piSrc
[0];

936 
Pñ
 
m3
 = 
piSrc
[-
off£t
];

937 
Pñ
 
m7
 = 
piSrc
[ 
off£t
*3];

938 
Pñ
 
m0
 = 
piSrc
[-
off£t
*4];

940 
I¡
 
d_°r⁄g
 = 
	`abs
(
m0
-
m3
Ë+ábs(
m7
-
m4
);

942  ( (
d_°r⁄g
 < (
bëa
>>3)Ë&& (
d
<(bëa>>2)Ë&& ( 
	`abs
(
m3
-
m4
Ë< ((
tc
*5+1)>>1)) );

943 
	}
}

945 
__ölöe
 
I¡
 
	gTComLo›Fûãr
::
	$xCÆcDP
–
Pñ
* 
piSrc
, 
I¡
 
iOff£t
)

947  
	`abs
–
piSrc
[-
iOff£t
*3] - 2*piSrc[-iOffset*2] +ÖiSrc[-iOffset] ) ;

948 
	}
}

950 
__ölöe
 
I¡
 
	gTComLo›Fûãr
::
	$xCÆcDQ
–
Pñ
* 
piSrc
, 
I¡
 
iOff£t
)

952  
	`abs
–
piSrc
[0] - 2*piSrc[
iOff£t
] +ÖiSrc[iOffset*2] );

953 
	}
}

	@TLibCommon/TComLoopFilter.h

38 #i‚de‡
__TCOMLOOPFILTER__


39 
	#__TCOMLOOPFILTER__


	)

41 
	~"Comm⁄Def.h
"

42 
	~"TComPic.h
"

47 
	#DEBLOCK_SMALLEST_BLOCK
 8

	)

54 ˛as†
	cTComLo›Fûãr


56 
	m¥iv©e
:

58 
UI¡
 
m_uiNumP¨tôi⁄s
;

59 
UCh¨
* 
	mm_ØpucBS
[
NUM_EDGE_DIR
];

60 
Boﬁ
* 
	mm_ØpbEdgeFûãr
[
NUM_EDGE_DIR
];

61 
LFCUP¨am
 
	mm_°LFCUP¨am
;

63 
Boﬁ
 
	mm_bLFCrossTûeBound¨y
;

65 
	m¥Ÿe˘ed
:

67 
Void
 
xDeblockCU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
, UI¡ 
uiDïth
, 
DeblockEdgeDú
 
edgeDú
 );

70 
Void
 
xSëLo›fûãrP¨am
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
 );

72 
Void
 
xSëEdgefûãrTU
 ( 
TComTU
 &
rTu
 );

73 
Void
 
xSëEdgefûãrPU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
 );

74 
Void
 
xGëBound¨ySåígthSögÀ
 ( 
TComD©aCU
* 
pCtu
, 
DeblockEdgeDú
 
edgeDú
, 
UI¡
 
uiP¨tIdx
 );

75 
UI¡
 
	$xCÆcBsIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
absZIdxInCtu
, 
DeblockEdgeDú
 
edgeDú
, 
I¡
 
iEdgeIdx
, I¡ 
iBa£UnôIdx
, c⁄° 
TComRe˘™gÀ
 *
ª˘
=
NULL
 )

77 
TComPic
* c⁄° 
pcPic
 = 
pcCU
->
	`gëPic
();

78 c⁄° 
UI¡
 
˘uWidthInBa£Unôs
 = 
pcPic
->
	`gëNumP¨tInCtuWidth
();

79 
I¡
 
ø°îOff£tTU
=0;

80 i‡(
ª˘
 !
NULL
)

82 c⁄° 
UI¡
 
möCuWidth
 =
pcPic
->
	`gëMöCUWidth
();

83 c⁄° 
UI¡
 
möCuHeight
=
pcPic
->
	`gëMöCUHeight
();

84 
ø°îOff£tTU
 = 
ª˘
->
x0
/
möCuWidth
 + (ª˘->
y0
/
möCuHeight
)*
˘uWidthInBa£Unôs
;

86 if–
edgeDú
 =
EDGE_VER
 )

88  
g_auiRa°îToZsˇn
[
g_auiZsˇnToRa°î
[
absZIdxInCtu
] + 
iBa£UnôIdx
 * 
˘uWidthInBa£Unôs
 + 
iEdgeIdx
 + 
ø°îOff£tTU
 ];

92  
g_auiRa°îToZsˇn
[
g_auiZsˇnToRa°î
[
absZIdxInCtu
] + 
iEdgeIdx
 * 
˘uWidthInBa£Unôs
 + 
iBa£UnôIdx
 + 
ø°îOff£tTU
 ];

96 
Void
 
	`xSëEdgefûãrMu…ùÀ
–
TComD©aCU
* 
pcCU
,

97 
UI¡
 
uiAbsZ‹dîIdx
,

98 
UI¡
 
uiDïth
,

99 
DeblockEdgeDú
 
edgeDú
,

100 
I¡
 
iEdgeIdx
,

101 
Boﬁ
 
bVÆue
,

102 
UI¡
 
uiWidthInBa£Unôs
 = 0,

103 
UI¡
 
uiHeightInBa£Unôs
 = 0,

104 c⁄° 
TComRe˘™gÀ
 *
ª˘
 = 0

107 
Void
 
	`xEdgeFûãrLuma
 ( 
TComD©aCU
* c⁄° 
pcCU
, c⁄° 
UI¡
 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiDïth
, c⁄° 
DeblockEdgeDú
 
edgeDú
, c⁄° 
I¡
 
iEdge
 );

108 
Void
 
	`xEdgeFûãrChroma
 ( 
TComD©aCU
* c⁄° 
pcCU
, c⁄° 
UI¡
 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiDïth
, c⁄° 
DeblockEdgeDú
 
edgeDú
, c⁄° 
I¡
 
iEdge
 );

110 
__ölöe
 
Void
 
	`xPñFûãrLuma
–
Pñ
* 
piSrc
, 
I¡
 
iOff£t
, I¡ 
tc
, 
Boﬁ
 
sw
, Boﬁ 
bP¨tPNoFûãr
, Boﬁ 
bP¨tQNoFûãr
, I¡ 
iThrCut
, Boﬁ 
bFûãrSec⁄dP
, Boﬁ 
bFûãrSec⁄dQ
, c⁄° I¡ 
bôDïthLuma
);

111 
__ölöe
 
Void
 
	`xPñFûãrChroma
–
Pñ
* 
piSrc
, 
I¡
 
iOff£t
, I¡ 
tc
, 
Boﬁ
 
bP¨tPNoFûãr
, Boﬁ 
bP¨tQNoFûãr
, c⁄° I¡ 
bôDïthChroma
);

114 
__ölöe
 
Boﬁ
 
	`xU£Så⁄gFûãrög
–
I¡
 
off£t
, I¡ 
d
, I¡ 
bëa
, I¡ 
tc
, 
Pñ
* 
piSrc
);

115 
__ölöe
 
I¡
 
	`xCÆcDP
–
Pñ
* 
piSrc
, I¡ 
iOff£t
);

116 
__ölöe
 
I¡
 
	`xCÆcDQ
–
Pñ
* 
piSrc
, I¡ 
iOff£t
);

118 c⁄° 
UCh¨
 
sm_tcTabÀ
[54];

119 c⁄° 
UCh¨
 
sm_bëaTabÀ
[52];

121 
public
:

122 
	`TComLo›Fûãr
();

123 
vútuÆ
 ~
	`TComLo›Fûãr
();

125 
Void
 
	`¸óã
 ( 
UI¡
 
uiMaxCUDïth
 );

126 
Void
 
	`de°roy
 ();

129 
Void
 
	`£tCfg
–
Boﬁ
 
bLFCrossTûeBound¨y
 );

132 
Void
 
	`lo›FûãrPic
–
TComPic
* 
pcPic
 );

134 
I¡
 
	$gëBëa
–
I¡
 
qp
 )

136 
I¡
 
ödexB
 = 
	`Clù3
–0, 
MAX_QP
, 
qp
 );

137  
sm_bëaTabÀ
[ 
ödexB
 ];

138 
	}
}

	@TLibCommon/TComMotionInfo.cpp

38 
	~<mem‹y.h
>

39 
	~"TComMŸi⁄Info.h
"

40 
	~"as£π.h
"

41 
	~<°dlib.h
>

54 
Void
 
	gTComCUMvFõld
::
	$¸óã
–
UI¡
 
uiNumP¨tôi⁄
 )

56 
	`as£π
(
m_pcMv
 =
NULL
);

57 
	`as£π
(
m_pcMvd
 =
NULL
);

58 
	`as£π
(
m_piRefIdx
 =
NULL
);

60 
m_pcMv
 = 
√w
 
TComMv
[ 
uiNumP¨tôi⁄
 ];

61 
m_pcMvd
 = 
√w
 
TComMv
[ 
uiNumP¨tôi⁄
 ];

62 
m_piRefIdx
 = 
√w
 
SCh¨
 [ 
uiNumP¨tôi⁄
 ];

64 
m_uiNumP¨tôi⁄
 = 
uiNumP¨tôi⁄
;

65 
	}
}

67 
Void
 
	gTComCUMvFõld
::
	$de°roy
()

69 
	`as£π
(
m_pcMv
 !
NULL
);

70 
	`as£π
(
m_pcMvd
 !
NULL
);

71 
	`as£π
(
m_piRefIdx
 !
NULL
);

73 
dñëe
[] 
m_pcMv
;

74 
dñëe
[] 
m_pcMvd
;

75 
dñëe
[] 
m_piRefIdx
;

77 
m_pcMv
 = 
NULL
;

78 
m_pcMvd
 = 
NULL
;

79 
m_piRefIdx
 = 
NULL
;

81 
m_uiNumP¨tôi⁄
 = 0;

82 
	}
}

88 
Void
 
	gTComCUMvFõld
::
	$˛órMvFõld
()

90  
I¡
 
i
 = 0; i < 
m_uiNumP¨tôi⁄
; i++ )

92 
m_pcMv
 [ 
i
 ].
	`£tZîo
();

93 
m_pcMvd
[ 
i
 ].
	`£tZîo
();

95 
	`as£π
––*
m_piRefIdx
 ) == 1 );

96 
	`mem£t
–
m_piRefIdx
, 
NOT_VALID
, 
m_uiNumP¨tôi⁄
 * ( *m_piRefIdx ) );

97 
	}
}

99 
Void
 
	gTComCUMvFõld
::
	$c›yFrom
–
TComCUMvFõld
 c⁄° * 
pcCUMvFõldSrc
, 
I¡
 
iNumP¨tSrc
, I¡ 
iP¨tAddrD°
 )

101 
I¡
 
iSizeInTComMv
 = –
TComMv
 ) * 
iNumP¨tSrc
;

103 
	`mem˝y
–
m_pcMv
 + 
iP¨tAddrD°
, 
pcCUMvFõldSrc
->m_pcMv, 
iSizeInTComMv
 );

104 
	`mem˝y
–
m_pcMvd
 + 
iP¨tAddrD°
, 
pcCUMvFõldSrc
->m_pcMvd, 
iSizeInTComMv
 );

105 
	`mem˝y
–
m_piRefIdx
 + 
iP¨tAddrD°
, 
pcCUMvFõldSrc
->m_piRefIdx, –*m_piRefIdx ) * 
iNumP¨tSrc
 );

106 
	}
}

108 
Void
 
	gTComCUMvFõld
::
	$c›yTo
–
TComCUMvFõld
* 
pcCUMvFõldD°
, 
I¡
 
iP¨tAddrD°
 ) const

110 
	`c›yTo
–
pcCUMvFõldD°
, 
iP¨tAddrD°
, 0, 
m_uiNumP¨tôi⁄
 );

111 
	}
}

113 
Void
 
	gTComCUMvFõld
::
	$c›yTo
–
TComCUMvFõld
* 
pcCUMvFõldD°
, 
I¡
 
iP¨tAddrD°
, 
UI¡
 
uiOff£t
, UI¡ 
uiNumP¨t
 ) const

115 
I¡
 
iSizeInTComMv
 = –
TComMv
 ) * 
uiNumP¨t
;

116 
I¡
 
iOff£t
 = 
uiOff£t
 + 
iP¨tAddrD°
;

118 
	`mem˝y
–
pcCUMvFõldD°
->
m_pcMv
 + 
iOff£t
, m_pcMv + 
uiOff£t
, 
iSizeInTComMv
 );

119 
	`mem˝y
–
pcCUMvFõldD°
->
m_pcMvd
 + 
iOff£t
, m_pcMvd + 
uiOff£t
, 
iSizeInTComMv
 );

120 
	`mem˝y
–
pcCUMvFõldD°
->
m_piRefIdx
 + 
iOff£t
, m_piRefIdx + 
uiOff£t
, –*m_piRefIdx ) * 
uiNumP¨t
 );

121 
	}
}

127 
	gãm∂©e
 <
ty≥«me
 
	gT
>

128 
Void
 
	gTComCUMvFõld
::
	$£tAŒ
–
T
 *
p
, T c⁄° & 
vÆ
, 
P¨tSize
 
eCUMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
 )

130 
I¡
 
i
;

131 
p
 +
iP¨tAddr
;

132 
I¡
 
numEÀmíts
 = 
m_uiNumP¨tôi⁄
 >> ( 2 * 
uiDïth
 );

134  
eCUMode
 )

136 
SIZE_2Nx2N
:

137  
i
 = 0; i < 
numEÀmíts
; i++ )

139 
p
[ 
i
 ] = 
vÆ
;

143 
SIZE_2NxN
:

144 
numEÀmíts
 >>= 1;

145  
i
 = 0; i < 
numEÀmíts
; i++ )

147 
p
[ 
i
 ] = 
vÆ
;

151 
SIZE_Nx2N
:

152 
numEÀmíts
 >>= 2;

153  
i
 = 0; i < 
numEÀmíts
; i++ )

155 
p
[ 
i
 ] = 
vÆ
;

156 
p
[ 
i
 + 2 * 
numEÀmíts
 ] = 
vÆ
;

160 
SIZE_NxN
:

161 
numEÀmíts
 >>= 2;

162  
i
 = 0; i < 
numEÀmíts
; i++)

164 
p
[ 
i
 ] = 
vÆ
;

167 
SIZE_2NxnU
:

169 
I¡
 
iCuºP¨tNumQ
 = 
numEÀmíts
>>2;

170 if–
iP¨tIdx
 == 0 )

172 
T
 *
pT
 = 
p
;

173 
T
 *
pT2
 = 
p
 + 
iCuºP¨tNumQ
;

174 
i
 = 0; i < (
iCuºP¨tNumQ
>>1); i++)

176 
pT
 [
i
] = 
vÆ
;

177 
pT2
[
i
] = 
vÆ
;

182 
T
 *
pT
 = 
p
;

183 
i
 = 0; i < (
iCuºP¨tNumQ
>>1); i++)

185 
pT
[
i
] = 
vÆ
;

188 
pT
 = 
p
 + 
iCuºP¨tNumQ
;

189 
i
 = 0; i < ( (
iCuºP¨tNumQ
>>1) + (iCurrPartNumQ<<1) ); i++)

191 
pT
[
i
] = 
vÆ
;

196 
SIZE_2NxnD
:

198 
I¡
 
iCuºP¨tNumQ
 = 
numEÀmíts
>>2;

199 if–
iP¨tIdx
 == 0 )

201 
T
 *
pT
 = 
p
;

202 
i
 = 0; i < ( (
iCuºP¨tNumQ
>>1) + (iCurrPartNumQ<<1) ); i++)

204 
pT
[
i
] = 
vÆ
;

206 
pT
 = 
p
 + ( 
numEÀmíts
 - 
iCuºP¨tNumQ
 );

207 
i
 = 0; i < (
iCuºP¨tNumQ
>>1); i++)

209 
pT
[
i
] = 
vÆ
;

214 
T
 *
pT
 = 
p
;

215 
T
 *
pT2
 = 
p
 + 
iCuºP¨tNumQ
;

216 
i
 = 0; i < (
iCuºP¨tNumQ
>>1); i++)

218 
pT
 [
i
] = 
vÆ
;

219 
pT2
[
i
] = 
vÆ
;

224 
SIZE_nLx2N
:

226 
I¡
 
iCuºP¨tNumQ
 = 
numEÀmíts
>>2;

227 if–
iP¨tIdx
 == 0 )

229 
T
 *
pT
 = 
p
;

230 
T
 *
pT2
 = 
p
 + (
iCuºP¨tNumQ
<<1);

231 
T
 *
pT3
 = 
p
 + (
iCuºP¨tNumQ
>>1);

232 
T
 *
pT4
 = 
p
 + (
iCuºP¨tNumQ
<<1) + (iCurrPartNumQ>>1);

234 
i
 = 0; i < (
iCuºP¨tNumQ
>>2); i++)

236 
pT
 [
i
] = 
vÆ
;

237 
pT2
[
i
] = 
vÆ
;

238 
pT3
[
i
] = 
vÆ
;

239 
pT4
[
i
] = 
vÆ
;

244 
T
 *
pT
 = 
p
;

245 
T
 *
pT2
 = 
p
 + (
iCuºP¨tNumQ
<<1);

246 
i
 = 0; i < (
iCuºP¨tNumQ
>>2); i++)

248 
pT
 [
i
] = 
vÆ
;

249 
pT2
[
i
] = 
vÆ
;

252 
pT
 = 
p
 + (
iCuºP¨tNumQ
>>1);

253 
pT2
 = 
p
 + (
iCuºP¨tNumQ
<<1) + (iCurrPartNumQ>>1);

254 
i
 = 0; i < ( (
iCuºP¨tNumQ
>>2) + iCurrPartNumQ ); i++)

256 
pT
 [
i
] = 
vÆ
;

257 
pT2
[
i
] = 
vÆ
;

262 
SIZE_nRx2N
:

264 
I¡
 
iCuºP¨tNumQ
 = 
numEÀmíts
>>2;

265 if–
iP¨tIdx
 == 0 )

267 
T
 *
pT
 = 
p
;

268 
T
 *
pT2
 = 
p
 + (
iCuºP¨tNumQ
<<1);

269 
i
 = 0; i < ( (
iCuºP¨tNumQ
>>2) + iCurrPartNumQ ); i++)

271 
pT
 [
i
] = 
vÆ
;

272 
pT2
[
i
] = 
vÆ
;

275 
pT
 = 
p
 + 
iCuºP¨tNumQ
 + (iCurrPartNumQ>>1);

276 
pT2
 = 
p
 + 
numEÀmíts
 - 
iCuºP¨tNumQ
 + (iCurrPartNumQ>>1);

277 
i
 = 0; i < (
iCuºP¨tNumQ
>>2); i++)

279 
pT
 [
i
] = 
vÆ
;

280 
pT2
[
i
] = 
vÆ
;

285 
T
 *
pT
 = 
p
;

286 
T
 *
pT2
 = 
p
 + (
iCuºP¨tNumQ
>>1);

287 
T
 *
pT3
 = 
p
 + (
iCuºP¨tNumQ
<<1);

288 
T
 *
pT4
 = 
p
 + (
iCuºP¨tNumQ
<<1) + (iCurrPartNumQ>>1);

289 
i
 = 0; i < (
iCuºP¨tNumQ
>>2); i++)

291 
pT
 [
i
] = 
vÆ
;

292 
pT2
[
i
] = 
vÆ
;

293 
pT3
[
i
] = 
vÆ
;

294 
pT4
[
i
] = 
vÆ
;

300 
	`as£π
(0);

303 
	}
}

305 
Void
 
	gTComCUMvFõld
::
	$£tAŒMv
–
TComMv
 c⁄° & 
mv
, 
P¨tSize
 
eCUMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
 )

307 
	`£tAŒ
(
m_pcMv
, 
mv
, 
eCUMode
, 
iP¨tAddr
, 
uiDïth
, 
iP¨tIdx
);

308 
	}
}

310 
Void
 
	gTComCUMvFõld
::
	$£tAŒMvd
–
TComMv
 c⁄° & 
mvd
, 
P¨tSize
 
eCUMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
 )

312 
	`£tAŒ
(
m_pcMvd
, 
mvd
, 
eCUMode
, 
iP¨tAddr
, 
uiDïth
, 
iP¨tIdx
);

313 
	}
}

315 
Void
 
	gTComCUMvFõld
::
	$£tAŒRefIdx
 ( 
I¡
 
iRefIdx
, 
P¨tSize
 
eCUMode
, I¡ 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
 )

317 
	`£tAŒ
(
m_piRefIdx
, 
°©ic_ˇ°
<
SCh¨
>(
iRefIdx
), 
eCUMode
, 
iP¨tAddr
, 
uiDïth
, 
iP¨tIdx
);

318 
	}
}

320 
Void
 
	gTComCUMvFõld
::
	$£tAŒMvFõld
–
TComMvFõld
 c⁄° & 
mvFõld
, 
P¨tSize
 
eCUMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
 )

322 
	`£tAŒMv
 ( 
mvFõld
.
	`gëMv
(), 
eCUMode
, 
iP¨tAddr
, 
uiDïth
, 
iP¨tIdx
 );

323 
	`£tAŒRefIdx
–
mvFõld
.
	`gëRefIdx
(), 
eCUMode
, 
iP¨tAddr
, 
uiDïth
, 
iP¨tIdx
 );

324 
	}
}

330 #i‡
REDUCED_ENCODER_MEMORY


331 
Void
 
	gTComCUMvFõld
::
	$com¥ess
(
SCh¨
 *
≥PªdMode
, c⁄° SCh¨* 
≥PªdModeSour˚
, c⁄° 
I¡
 
sˇÀ
, c⁄° 
TComCUMvFõld
 &
sour˚
)

333 c⁄° 
I¡
 
numSub∑πsWôhIdítiˇlMŸi⁄
 = 
sˇÀ
 * scale;

334 
	`as£π
–
numSub∑πsWôhIdítiˇlMŸi⁄
 > 0 &&ÇumSub∑πsWôhIdítiˇlMŸi⁄ <
m_uiNumP¨tôi⁄
);

335 
	`as£π
(
sour˚
.
m_uiNumP¨tôi⁄
 == m_uiNumPartition);

337  
I¡
 
∑πIdx
 = 0;Ö¨tIdx < 
m_uiNumP¨tôi⁄
;Ö¨tIdx +
numSub∑πsWôhIdítiˇlMŸi⁄
 )

339 
TComMv
 
	`cMv
(0,0);

340 
I¡
 
iRefIdx
 = 0;

342 
cMv
 = 
sour˚
.
m_pcMv
[ 
∑πIdx
 ];

343 
PªdMode
 
¥edMode
 = 
°©ic_ˇ°
<PªdMode>–
≥PªdModeSour˚
[ 
∑πIdx
 ] );

344 
iRefIdx
 = 
sour˚
.
m_piRefIdx
[ 
∑πIdx
 ];

345  
I¡
 
i
 = 0; i < 
numSub∑πsWôhIdítiˇlMŸi⁄
; i++ )

347 
m_pcMv
[ 
∑πIdx
 + 
i
 ] = 
cMv
;

348 
≥PªdMode
[ 
∑πIdx
 + 
i
 ] = 
¥edMode
;

349 
m_piRefIdx
[ 
∑πIdx
 + 
i
 ] = 
iRefIdx
;

352 
	}
}

354 
Void
 
	gTComCUMvFõld
::
	$com¥ess
(
SCh¨
* 
≥PªdMode
, 
I¡
 
sˇÀ
)

356 
I¡
 
N
 = 
sˇÀ
 * scale;

357 
	`as£π
–
N
 > 0 && N <
m_uiNumP¨tôi⁄
);

359  
I¡
 
uiP¨tIdx
 = 0; uiP¨tIdx < 
m_uiNumP¨tôi⁄
; uiP¨tIdx +
N
 )

361 
TComMv
 
	`cMv
(0,0);

362 
I¡
 
iRefIdx
 = 0;

364 
cMv
 = 
m_pcMv
[ 
uiP¨tIdx
 ];

365 
PªdMode
 
¥edMode
 = 
°©ic_ˇ°
<PªdMode>–
≥PªdMode
[ 
uiP¨tIdx
 ] );

366 
iRefIdx
 = 
m_piRefIdx
[ 
uiP¨tIdx
 ];

367  
I¡
 
i
 = 0; i < 
N
; i++ )

369 
m_pcMv
[ 
uiP¨tIdx
 + 
i
 ] = 
cMv
;

370 
≥PªdMode
[ 
uiP¨tIdx
 + 
i
 ] = 
¥edMode
;

371 
m_piRefIdx
[ 
uiP¨tIdx
 + 
i
 ] = 
iRefIdx
;

374 
	}
}

	@TLibCommon/TComMotionInfo.h

39 #i‚de‡
__TCOMMOTIONINFO__


40 
	#__TCOMMOTIONINFO__


	)

42 
	~<mem‹y.h
>

43 
	~"Comm⁄Def.h
"

44 
	~"TComMv.h
"

54 
	s_AMVPInfo


56 
TComMv
 
	mm_acMvC™d
[ 
AMVP_MAX_NUM_CANDS
 ];

57 
I¡
 
	miN
;

58 #i‡
MCTS_ENC_CHECK


59 
UI¡
 
	mnumS∑tülMVPC™did©es
;

61 } 
	tAMVPInfo
;

68 ˛as†
	cTComMvFõld


70 
	m¥iv©e
:

71 
TComMv
 
m_acMv
;

72 
I¡
 
	mm_iRefIdx
;

74 
	mpublic
:

75 
	$TComMvFõld
(Ë: 
	$m_iRefIdx
–
NOT_VALID
 ) {}

77 
Void
 
	$£tMvFõld
–
TComMv
 c⁄° & 
cMv
, 
I¡
 
iRefIdx
 )

79 
m_acMv
 = 
cMv
;

80 
m_iRefIdx
 = 
iRefIdx
;

81 
	}
}

83 
Void
 
	$£tRefIdx
–
I¡
 
ªfIdx
 ) { 
m_iRefIdx
 =ÑefIdx; 
	}
}

85 
TComMv
 c⁄° & 
	$gëMv
(Ëc⁄° {  
m_acMv
; 
	}
}

86 
	gTComMv
 & 
	$gëMv
(Ë{  
m_acMv
; 
	}
}

88 
I¡
 
	$gëRefIdx
(Ëc⁄° {  
m_iRefIdx
; 
	}
}

89 
I¡
 
	$gëH‹
 (Ëc⁄° {  
m_acMv
.
	`gëH‹
(); 
	}
}

90 
I¡
 
	$gëVî
 (Ëc⁄° {  
m_acMv
.
	`gëVî
(); 
	}
}

94 ˛as†
	cTComCUMvFõld


96 
	mpublic
:

97 
TComMv
* 
m_pcMv
;

98 
TComMv
* 
	mm_pcMvd
;

99 
SCh¨
* 
	mm_piRefIdx
;

100 
UI¡
 
	mm_uiNumP¨tôi⁄
;

101 
AMVPInfo
 
	mm_cAMVPInfo
;

103 
	mãm∂©e
 <
ty≥«me
 
	mT
>

104 
Void
 
£tAŒ
–
T
 *
p
, T c⁄° & 
vÆ
, 
P¨tSize
 
eCUMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
 );

106 
	mpublic
:

107 
	$TComCUMvFõld
(Ë: 
	`m_pcMv
(
NULL
), 
	`m_pcMvd
(NULL), 
	`m_piRefIdx
(NULL), 
	$m_uiNumP¨tôi⁄
(0) {}

108 ~
	$TComCUMvFõld
(Ë{
	}
}

114 
Void
 
¸óã
–
UI¡
 
uiNumP¨tôi⁄
 );

115 
Void
 
de°roy
();

121 
Void
 
˛órMvFõld
();

123 
Void
 
c›yFrom
–
TComCUMvFõld
 c⁄° * 
pcCUMvFõldSrc
, 
I¡
 
iNumP¨tSrc
, I¡ 
iP¨tAddrD°
 );

124 
Void
 
	$c›yTo
 ( 
TComCUMvFõld
* 
pcCUMvFõldD°
, 
I¡
 
iP¨tAddrD°
 ) const;

125 
Void
 
	$c›yTo
 ( 
TComCUMvFõld
* 
pcCUMvFõldD°
, 
I¡
 
iP¨tAddrD°
, 
UI¡
 
uiOff£t
, UI¡ 
uiNumP¨t
 ) const;

131 
TComMv
 c⁄° & 
	$gëMv
 ( 
I¡
 
iIdx
 ) c⁄° {  
m_pcMv
 [iIdx]; 
	}
}

132 
TComMv
 c⁄° & 
	$gëMvd
 ( 
I¡
 
iIdx
 ) c⁄° {  
m_pcMvd
 [iIdx]; 
	}
}

133 
I¡
 
	$gëRefIdx
–
I¡
 
iIdx
 ) c⁄° {  
m_piRefIdx
[iIdx]; 
	}
}

135 
AMVPInfo
* 
	$gëAMVPInfo
 (Ë{  &
m_cAMVPInfo
; 
	}
}

141 
Void
 
£tAŒMv
 ( 
TComMv
 c⁄° & 
rcMv
, 
P¨tSize
 
eCUMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
=0 );

142 
Void
 
£tAŒMvd
 ( 
TComMv
 c⁄° & 
rcMvd
, 
P¨tSize
 
eCUMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
=0 );

143 
Void
 
£tAŒRefIdx
 ( 
I¡
 
iRefIdx
, 
P¨tSize
 
eMbMode
, I¡ 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
=0 );

144 
Void
 
£tAŒMvFõld
–
TComMvFõld
 c⁄° & 
mvFõld
, 
P¨tSize
 
eMbMode
, 
I¡
 
iP¨tAddr
, 
UI¡
 
uiDïth
, I¡ 
iP¨tIdx
=0 );

146 
Void
 
	$£tNumP¨tôi⁄
–
I¡
 
iNumP¨t
 )

148 
m_uiNumP¨tôi⁄
 = 
iNumP¨t
;

149 
	}
}

151 
Void
 
	$lökToWôhOff£t
–
TComCUMvFõld
 c⁄° * 
§c
, 
I¡
 
off£t
 )

153 
m_pcMv
 = 
§c
->m_pcMv + 
off£t
;

154 
m_pcMvd
 = 
§c
->m_pcMvd + 
off£t
;

155 
m_piRefIdx
 = 
§c
->m_piRefIdx + 
off£t
;

156 
	}
}

158 #i‡
REDUCED_ENCODER_MEMORY


159 
Void
 
com¥ess
(
SCh¨
 *
≥PªdMode
, c⁄° SCh¨* 
≥PªdModeSour˚
, c⁄° 
I¡
 
sˇÀ
, c⁄° 
TComCUMvFõld
 &
sour˚
);

161 
Void
 
com¥ess
(
SCh¨
* 
≥PªdMode
, 
I¡
 
sˇÀ
);

	@TLibCommon/TComMv.h

38 #i‚de‡
__TCOMMV__


39 
	#__TCOMMV__


	)

41 
	~"Comm⁄Def.h
"

51 ˛as†
	cTComMv


53 
	mpublic
:

54 
Sh‹t
 
m_iH‹
;

55 
Sh‹t
 
	mm_iVî
;

57 
	mpublic
:

63 
	$TComMv
() :

64 
	`m_iH‹
(0),

65 
	$m_iVî
(0)

69 
	$TComMv
–
Sh‹t
 
iH‹
, Sh‹à
iVî
 ) :

70 
	`m_iH‹
(
iH‹
),

71 
	$m_iVî
(
iVî
)

73 
	}
}

79 
Void
 
	$£t
 ( 
Sh‹t
 
iH‹
, Sh‹à
iVî
Ë{ 
m_iH‹
 = iH‹; 
m_iVî
 = iVî; 
	}
}

80 
Void
 
	$£tH‹
 ( 
Sh‹t
 
i
 ) { 
m_iH‹
 = i; 
	}
}

81 
Void
 
	$£tVî
 ( 
Sh‹t
 
i
 ) { 
m_iVî
 = i; 
	}
}

82 
Void
 
	$£tZîo
 (Ë{ 
m_iH‹
 = 
m_iVî
 = 0; 
	}
}

88 
I¡
 
	$gëH‹
 (Ëc⁄° {  
m_iH‹
; 
	}
}

89 
I¡
 
	$gëVî
 (Ëc⁄° {  
m_iVî
; 
	}
}

90 
I¡
 
	$gëAbsH‹
 (Ëc⁄° {  
	`abs
–
m_iH‹
 ); 
	}
}

91 
I¡
 
	$gëAbsVî
 (Ëc⁄° {  
	`abs
–
m_iVî
 ); 
	}
}

97 c⁄° 
	gTComMv
& 
	g›î©‹
 +(c⁄° 
TComMv
& 
rcMv
)

99 
m_iH‹
 +
rcMv
.m_iHor;

100 
	gm_iVî
 +
rcMv
.
m_iVî
;

101  *
	gthis
;

104 c⁄° 
	gTComMv
& 
	g›î©‹
-(c⁄° 
TComMv
& 
rcMv
)

106 
m_iH‹
 -
rcMv
.m_iHor;

107 
	gm_iVî
 -
rcMv
.
m_iVî
;

108  *
	gthis
;

111 #i‡!
ME_ENABLE_ROUNDING_OF_MVS


112 c⁄° 
	gTComMv
& 
	g›î©‹
>>(c⁄° 
I¡
 
i
)

114 
m_iH‹
 >>
i
;

115 
	gm_iVî
 >>
i
;

116  *
	gthis
;

120 #i‡
ME_ENABLE_ROUNDING_OF_MVS


122 
Void
 
	$divideByPowîOf2
 (c⁄° 
I¡
 
i
)

124 
I¡
 
off£t
 = (
i
 == 0) ? 0 : 1 << (i - 1);

125 
m_iH‹
 +
off£t
;

126 
m_iVî
 +
off£t
;

128 
m_iH‹
 >>
i
;

129 
m_iVî
 >>
i
;

130 
	}
}

133 c⁄° 
	gTComMv
& 
	g›î©‹
<<(c⁄° 
I¡
 
i
)

135 
m_iH‹
 <<
i
;

136 
	gm_iVî
 <<
i
;

137  *
	gthis
;

140 c⁄° 
TComMv
 
	g›î©‹
 - ( c⁄° 
	gTComMv
& 
	grcMv
 ) const

142  
TComMv
–
m_iH‹
 - 
rcMv
.m_iH‹, 
m_iVî
 -ÑcMv.m_iVer );

145 c⁄° 
TComMv
 
	g›î©‹
 + ( c⁄° 
	gTComMv
& 
	grcMv
 ) const

147  
TComMv
–
m_iH‹
 + 
rcMv
.m_iH‹, 
m_iVî
 +ÑcMv.m_iVer );

150 
Boﬁ
 
	g›î©‹
=–c⁄° 
TComMv
& 
rcMv
 ) const

152  (
m_iH‹
==
rcMv
.m_iH‹ && 
m_iVî
==rcMv.m_iVer);

155 
Boﬁ
 
	g›î©‹
!–c⁄° 
TComMv
& 
rcMv
 ) const

157  (
m_iH‹
!=
rcMv
.m_iH‹ || 
m_iVî
!=rcMv.m_iVer);

160 c⁄° 
TComMv
 
	$sˇÀMv
–
I¡
 
iSˇÀ
 ) const

162 
I¡
 
mvx
 = 
	`Clù3
–-32768, 32767, (
iSˇÀ
 * 
	`gëH‹
() + 127 + (iScale * getHor() < 0)) >> 8 );

163 
I¡
 
mvy
 = 
	`Clù3
–-32768, 32767, (
iSˇÀ
 * 
	`gëVî
() + 127 + (iScale * getVer() < 0)) >> 8 );

164  
	`TComMv
–
mvx
, 
mvy
 );

165 
	}
}

	@TLibCommon/TComPattern.cpp

38 
	~"TComPic.h
"

39 
	~"TComP©ã∫.h
"

40 
	~"TComD©aCU.h
"

41 
	~"TComTU.h
"

42 
	~"Debug.h
"

43 
	~"TComPªdi˘i⁄.h
"

51 
Void
 
fûlRe„ªn˚Sam∂es
–c⁄° 
I¡
 
bôDïth
,

52 #i‡
O0043_BEST_EFFORT_DECODING


53 c⁄° 
I¡
 
bôDïthDñè
,

55 c⁄° 
Pñ
* 
piRoiOrigö
,

56 
Pñ
* 
piI¡øTemp
,

57 c⁄° 
Boﬁ
* 
bNeighb‹Fœgs
,

58 c⁄° 
I¡
 
iNumI¡øNeighb‹
,

59 c⁄° 
I¡
 
unôWidth
,

60 c⁄° 
I¡
 
unôHeight
,

61 c⁄° 
I¡
 
iAboveUnôs
,

62 c⁄° 
I¡
 
iLe·Unôs
,

63 c⁄° 
UI¡
 
uiWidth
,

64 c⁄° 
UI¡
 
uiHeight
,

65 c⁄° 
I¡
 
iPicSåide
 );

68 
Boﬁ
 
isAboveLe·AvaûabÀ
 ( c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
 );

69 
I¡
 
isAboveAvaûabÀ
 ( c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxRT
, 
Boﬁ
* 
bVÆidFœgs
 );

70 
I¡
 
isLe·AvaûabÀ
 ( c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxLB
, 
Boﬁ
* 
bVÆidFœgs
 );

71 
I¡
 
isAboveRightAvaûabÀ
 ( c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxRT
, 
Boﬁ
* 
bVÆidFœgs
 );

72 
I¡
 
isBñowLe·AvaûabÀ
 ( c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxLB
, 
Boﬁ
* 
bVÆidFœgs
 );

80 #i‡
MCTS_ENC_CHECK


81 
Void
 
	gTComP©ã∫
::
	$öôP©ã∫
(
Pñ
* 
piY
,

82 
I¡
 
roiWidth
,

83 
I¡
 
roiHeight
,

84 
I¡
 
°ride
,

85 
I¡
 
bôDïthLuma
,

86 
I¡
 
roiPosX
,

87 
I¡
 
roiPosY
)

89 
Void
 
TComP©ã∫
::
	$öôP©ã∫
 (
Pñ
* 
piY
,

90 
I¡
 
roiWidth
,

91 
I¡
 
roiHeight
,

92 
I¡
 
°ride
,

93 
I¡
 
bôDïthLuma
)

96 
m_piROIOrigö
 = 
piY
;

97 
m_roiWidth
 = 
roiWidth
;

98 
m_roiHeight
 = 
roiHeight
;

99 
m_∑âînSåide
 = 
°ride
;

100 
m_bôDïth
 = 
bôDïthLuma
;

101 #i‡
MCTS_ENC_CHECK


102 
m_roiPosX
 = 
roiPosX
;

103 
m_roiPosY
 = 
roiPosY
;

105 
	}
}

107 #i‡
MCTS_ENC_CHECK


108 
Void
 
	gTComP©ã∫
::
	$£tTûeB‹dîs
(
I¡
 
tûeLe·T›PñPosX
, I¡ 
tûeLe·T›PñPosY
, I¡ 
tûeRightBŸtomPñPosX
, I¡ 
tûeRightBŸtomPñPosY
)

110 
m_tûeLe·T›PñPosX
 = 
tûeLe·T›PñPosX
;

111 
m_tûeLe·T›PñPosY
 = 
tûeLe·T›PñPosY
;

112 
m_tûeRightBŸtomPñPosX
 = 
tûeRightBŸtomPñPosX
;

113 
m_tûeRightBŸtomPñPosY
 = 
tûeRightBŸtomPñPosY
;

114 
	}
}

119 
Void
 
	gTComPªdi˘i⁄
::
öôI¡øP©ã∫ChTy≥
–
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
bFûãrRefSam∂es
 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
))

121 c⁄° 
Ch™√lTy≥
 
chTy≥
 = 
	`toCh™√lTy≥
(
compID
);

123 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

124 c⁄° 
TComSPS
 &
•s
 = *(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

125 c⁄° 
UI¡
 
uiZ‹dîIdxInP¨t
=
rTu
.
	`GëAbsP¨tIdxTU
();

126 c⁄° 
UI¡
 
uiTuWidth
 = 
rTu
.
	`gëRe˘
(
compID
).
width
;

127 c⁄° 
UI¡
 
uiTuHeight
 = 
rTu
.
	`gëRe˘
(
compID
).
height
;

128 c⁄° 
UI¡
 
uiTuWidth2
 = 
uiTuWidth
 << 1;

129 c⁄° 
UI¡
 
uiTuHeight2
 = 
uiTuHeight
 << 1;

131 c⁄° 
I¡
 
iBa£UnôSize
 = 
•s
.
	`gëMaxCUWidth
(Ë>> sps.
	`gëMaxTŸÆCUDïth
();

132 c⁄° 
I¡
 
iUnôWidth
 = 
iBa£UnôSize
 >> 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëComp⁄ítSˇÀX
(
compID
);

133 c⁄° 
I¡
 
iUnôHeight
 = 
iBa£UnôSize
 >> 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëComp⁄ítSˇÀY
(
compID
);

134 c⁄° 
I¡
 
iTUWidthInUnôs
 = 
uiTuWidth
 / 
iUnôWidth
;

135 c⁄° 
I¡
 
iTUHeightInUnôs
 = 
uiTuHeight
 / 
iUnôHeight
;

136 c⁄° 
I¡
 
iAboveUnôs
 = 
iTUWidthInUnôs
 << 1;

137 c⁄° 
I¡
 
iLe·Unôs
 = 
iTUHeightInUnôs
 << 1;

138 c⁄° 
I¡
 
bôDïthF‹Ch™√l
 = 
•s
.
	`gëBôDïth
(
chTy≥
);

140 
	`as£π
(
iTUHeightInUnôs
 > 0 && 
iTUWidthInUnôs
 > 0);

142 c⁄° 
I¡
 
iP¨tIdxSåide
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
();

143 c⁄° 
UI¡
 
uiP¨tIdxLT
 = 
pcCU
->
	`gëZ‹dîIdxInCtu
(Ë+ 
uiZ‹dîIdxInP¨t
;

144 c⁄° 
UI¡
 
uiP¨tIdxRT
 = 
g_auiRa°îToZsˇn
[ 
g_auiZsˇnToRa°î
[ 
uiP¨tIdxLT
 ] + 
iTUWidthInUnôs
 - 1 ];

145 c⁄° 
UI¡
 
uiP¨tIdxLB
 = 
g_auiRa°îToZsˇn
[ 
g_auiZsˇnToRa°î
[ 
uiP¨tIdxLT
 ] + ((
iTUHeightInUnôs
 - 1Ë* 
iP¨tIdxSåide
)];

147 
I¡
 
iPicSåide
 = 
pcCU
->
	`gëPic
()->
	`gëSåide
(
compID
);

148 
Boﬁ
 
bNeighb‹Fœgs
[4 * 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
 + 1];

149 
I¡
 
iNumI¡øNeighb‹
 = 0;

151 
bNeighb‹Fœgs
[
iLe·Unôs
] = 
	`isAboveLe·AvaûabÀ
–
pcCU
, 
uiP¨tIdxLT
 );

152 
iNumI¡øNeighb‹
 +
bNeighb‹Fœgs
[
iLe·Unôs
] ? 1 : 0;

153 
iNumI¡øNeighb‹
 +
	`isAboveAvaûabÀ
 ( 
pcCU
, 
uiP¨tIdxLT
, 
uiP¨tIdxRT
, (
bNeighb‹Fœgs
 + 
iLe·Unôs
 + 1) );

154 
iNumI¡øNeighb‹
 +
	`isAboveRightAvaûabÀ
–
pcCU
, 
uiP¨tIdxLT
, 
uiP¨tIdxRT
, (
bNeighb‹Fœgs
 + 
iLe·Unôs
 + 1 + 
iTUWidthInUnôs
 ) );

155 
iNumI¡øNeighb‹
 +
	`isLe·AvaûabÀ
 ( 
pcCU
, 
uiP¨tIdxLT
, 
uiP¨tIdxLB
, (
bNeighb‹Fœgs
 + 
iLe·Unôs
 - 1) );

156 
iNumI¡øNeighb‹
 +
	`isBñowLe·AvaûabÀ
 ( 
pcCU
, 
uiP¨tIdxLT
, 
uiP¨tIdxLB
, (
bNeighb‹Fœgs
 + 
iLe·Unôs
 - 1 - 
iTUHeightInUnôs
) );

158 c⁄° 
UI¡
 
uiROIWidth
 = 
uiTuWidth2
+1;

159 c⁄° 
UI¡
 
uiROIHeight
 = 
uiTuHeight2
+1;

161 
	`as£π
(
uiROIWidth
*
uiROIHeight
 <
m_iYuvExtSize
);

163 #i‡
DEBUG_STRING


164 
°d
::
°rög°ªam
 
	`ss
(°rög°ªam::
out
);

168 
Pñ
 *
piI¡øTemp
 = 
m_piYuvExt
[
compID
][
PRED_BUF_UNFILTERED
];

169 
Pñ
 *
piRoiOrigö
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
(
compID
,ÖcCU->
	`gëCtuRsAddr
(),ÖcCU->
	`gëZ‹dîIdxInCtu
()+
uiZ‹dîIdxInP¨t
);

170 #i‡
O0043_BEST_EFFORT_DECODING


171 c⁄° 
I¡
 
bôDïthF‹Ch™√lInSåóm
 = 
•s
.
	`gëSåómBôDïth
(
chTy≥
);

172 
	`fûlRe„ªn˚Sam∂es
 (
bôDïthF‹Ch™√lInSåóm
, bôDïthF‹Ch™√lInSåóm - 
bôDïthF‹Ch™√l
,

174 
	`fûlRe„ªn˚Sam∂es
 (
bôDïthF‹Ch™√l
,

176 
piRoiOrigö
, 
piI¡øTemp
, 
bNeighb‹Fœgs
, 
iNumI¡øNeighb‹
, 
iUnôWidth
, 
iUnôHeight
, 
iAboveUnôs
, 
iLe·Unôs
,

177 
uiROIWidth
, 
uiROIHeight
, 
iPicSåide
);

180 #i‡
DEBUG_STRING


181 i‡(
DebugO±i⁄Li°
::
DebugSåög_Pªd
.
	`gëI¡
()&
	`DebugSåögGëPªdModeMask
(
MODE_INTRA
))

183 
ss
 << "###: gíî©ög Re‡Sam∂e†f‹ ch™√»" << 
compID
 << "ánd " << 
rTu
.
	`gëRe˘
(compID).
width
 << " x " <<ÑTu.gëRe˘(compID).
height
 << "\n";

184 
UI¡
 
y
=0; y<
uiROIHeight
; y++)

186 
ss
 << "###: - ";

187 
UI¡
 
x
=0; x<
uiROIWidth
; x++)

189 i‡(
x
==0 || 
y
==0)

191 
ss
 << 
piI¡øTemp
[
y
*
uiROIWidth
 + 
x
] << ", ";

195 
ss
 << "\n";

200 i‡(
bFûãrRefSam∂es
)

204 
I¡
 
°ride
 = 
uiROIWidth
;

205 c⁄° 
Pñ
 *
piSrcPå
 = 
piI¡øTemp
 + (
°ride
 * 
uiTuHeight2
);

206 
Pñ
 *
piDe°På
 = 
m_piYuvExt
[
compID
][
PRED_BUF_FILTERED
] + (
°ride
 * 
uiTuHeight2
);

210 
Boﬁ
 
u£Så⁄gI¡øSmoŸhög
 = 
	`isLuma
(
chTy≥
Ë&& 
•s
.
	`gëU£Så⁄gI¡øSmoŸhög
();

212 c⁄° 
Pñ
 
bŸtomLe·
 = 
piI¡øTemp
[
°ride
 * 
uiTuHeight2
];

213 c⁄° 
Pñ
 
t›Le·
 = 
piI¡øTemp
[0];

214 c⁄° 
Pñ
 
t›Right
 = 
piI¡øTemp
[
uiTuWidth2
];

216 i‡(
u£Så⁄gI¡øSmoŸhög
)

218 #i‡
O0043_BEST_EFFORT_DECODING


219 c⁄° 
I¡
 
thªshﬁd
 = 1 << (
bôDïthF‹Ch™√lInSåóm
 - 5);

221 c⁄° 
I¡
 
thªshﬁd
 = 1 << (
bôDïthF‹Ch™√l
 - 5);

223 c⁄° 
Boﬁ
 
bûöórLe·
 = 
	`abs
((
bŸtomLe·
 + 
t›Le·
 ) - (2 * 
piI¡øTemp
[
°ride
 * 
uiTuHeight
])Ë< 
thªshﬁd
;

224 c⁄° 
Boﬁ
 
bûöórAbove
 = 
	`abs
((
t›Le·
 + 
t›Right
Ë- (2 * 
piI¡øTemp
[ 
uiTuWidth
 ])Ë< 
thªshﬁd
;

225 i‡((
uiTuWidth
 < 32Ë|| (!
bûöórLe·
Ë|| (!
bûöórAbove
))

227 
u£Så⁄gI¡øSmoŸhög
 = 
Ál£
;

231 *
piDe°På
 = *
piSrcPå
;

232 
piDe°På
 -
°ride
;

233 
piSrcPå
 -
°ride
;

239 i‡(
u£Så⁄gI¡øSmoŸhög
)

241 c⁄° 
I¡
 
shi·
 = 
g_aucC⁄vîtToBô
[
uiTuHeight
] + 3;

243 
UI¡
 
i
=1; i<
uiTuHeight2
; i++, 
piDe°På
-=
°ride
)

245 *
piDe°På
 = (((
uiTuHeight2
 - 
i
Ë* 
bŸtomLe·
Ë+ (ò* 
t›Le·
Ë+ 
uiTuHeight
Ë>> 
shi·
;

248 
piSrcPå
 -
°ride
 * (
uiTuHeight2
 - 1);

252 
UI¡
 
i
=1; i<
uiTuHeight2
; i++, 
piDe°På
-=
°ride
, 
piSrcPå
-=stride)

254 *
piDe°På
 = ( 
piSrcPå
[
°ride
] + 2*piSrcPtr[0] +ÖiSrcPtr[-stride] + 2 ) >> 2;

262 i‡(
u£Så⁄gI¡øSmoŸhög
)

264 *
piDe°På
 = 
piSrcPå
[0];

268 *
piDe°På
 = ( 
piSrcPå
[
°ride
] + 2*piSrcPtr[0] +ÖiSrcPtr[1] + 2 ) >> 2;

270 
piDe°På
 += 1;

271 
piSrcPå
 += 1;

277 i‡(
u£Så⁄gI¡øSmoŸhög
)

279 c⁄° 
I¡
 
shi·
 = 
g_aucC⁄vîtToBô
[
uiTuWidth
] + 3;

281 
UI¡
 
i
=1; i<
uiTuWidth2
; i++, 
piDe°På
++)

283 *
piDe°På
 = (((
uiTuWidth2
 - 
i
Ë* 
t›Le·
Ë+ (ò* 
t›Right
Ë+ 
uiTuWidth
Ë>> 
shi·
;

286 
piSrcPå
 +
uiTuWidth2
 - 1;

290 
UI¡
 
i
=1; i<
uiTuWidth2
; i++, 
piDe°På
++, 
piSrcPå
++)

292 *
piDe°På
 = ( 
piSrcPå
[1] + 2*piSrcPtr[0] +ÖiSrcPtr[-1] + 2 ) >> 2;

298 *
piDe°På
=*
piSrcPå
;

300 #i‡
DEBUG_STRING


301 i‡(
DebugO±i⁄Li°
::
DebugSåög_Pªd
.
	`gëI¡
()&
	`DebugSåögGëPªdModeMask
(
MODE_INTRA
))

303 
ss
 << "###: fûãªdÑesu… f‹ ch™√»" << 
compID
 <<"\n";

304 
UI¡
 
y
=0; y<
uiROIHeight
; y++)

306 
ss
 << "###: - ";

307 
UI¡
 
x
=0; x<
uiROIWidth
; x++)

309 i‡(
x
==0 || 
y
==0)

311 
ss
 << 
m_piYuvExt
[
compID
][
PRED_BUF_FILTERED
][
y
*
uiROIWidth
 + 
x
] << ", ";

315 
ss
 << "\n";

323 
	`DEBUG_STRING_APPEND
(
sDebug
, 
ss
.
	`°r
())

324 
	}
}

326 
Void
 
fûlRe„ªn˚Sam∂es
–c⁄° 
I¡
 
bôDïth
,

327 #i‡
O0043_BEST_EFFORT_DECODING


328 c⁄° 
I¡
 
bôDïthDñè
,

330 c⁄° 
Pñ
* 
piRoiOrigö
,

331 
Pñ
* 
piI¡øTemp
,

332 c⁄° 
Boﬁ
* 
bNeighb‹Fœgs
,

333 c⁄° 
I¡
 
iNumI¡øNeighb‹
,

334 c⁄° 
I¡
 
unôWidth
,

335 c⁄° 
I¡
 
unôHeight
,

336 c⁄° 
I¡
 
iAboveUnôs
,

337 c⁄° 
I¡
 
iLe·Unôs
,

338 c⁄° 
UI¡
 
uiWidth
,

339 c⁄° 
UI¡
 
uiHeight
,

340 c⁄° 
I¡
 
iPicSåide
 )

342 c⁄° 
Pñ
* 
	gpiRoiTemp
;

343 
I¡
 
	gi
, 
	gj
;

344 
I¡
 
	giDCVÆue
 = 1 << (
bôDïth
 - 1);

345 c⁄° 
I¡
 
	giTŸÆUnôs
 = 
iAboveUnôs
 + 
iLe·Unôs
 + 1;

347 i‡(
	giNumI¡øNeighb‹
 == 0)

350 
i
=0; 
	gi
<
	guiWidth
; i++)

352 
	gpiI¡øTemp
[
i
] = 
iDCVÆue
;

354 
	gi
=1; i<
	guiHeight
; i++)

356 
	gpiI¡øTemp
[
i
*
uiWidth
] = 
iDCVÆue
;

359 i‡(
	giNumI¡øNeighb‹
 =
iTŸÆUnôs
)

362 
piRoiTemp
 = 
piRoiOrigö
 - 
iPicSåide
 - 1;

364 
	gi
=0; i<
	guiWidth
; i++)

366 #i‡
O0043_BEST_EFFORT_DECODING


367 
	gpiI¡øTemp
[
i
] = 
piRoiTemp
[i] << 
bôDïthDñè
;

369 
	gpiI¡øTemp
[
i
] = 
piRoiTemp
[i];

374 
	gpiRoiTemp
 = 
piRoiOrigö
 - 1;

376 
	gi
=1; i<
	guiHeight
; i++)

378 #i‡
O0043_BEST_EFFORT_DECODING


379 
	gpiI¡øTemp
[
i
*
uiWidth
] = (*(
piRoiTemp
)Ë<< 
bôDïthDñè
;

381 
	gpiI¡øTemp
[
i
*
uiWidth
] = *(
piRoiTemp
);

383 
	gpiRoiTemp
 +
iPicSåide
;

389 c⁄° 
I¡
 
	giTŸÆSam∂es
 = (
iLe·Unôs
 * 
unôHeight
Ë+ ((
iAboveUnôs
 + 1Ë* 
unôWidth
);

390 
Pñ
 
	gpiI¡øLöe
[5 * 
MAX_CU_SIZE
];

391 
Pñ
 *
	gpiI¡øLöeTemp
;

392 c⁄° 
Boﬁ
 *
	gpbNeighb‹Fœgs
;

396 
	gi
=0; i<
	giTŸÆSam∂es
; i++)

398 
	gpiI¡øLöe
[
i
] = 
iDCVÆue
;

402 
	gpiRoiTemp
 = 
piRoiOrigö
 - 
iPicSåide
 - 1;

403 
	gpiI¡øLöeTemp
 = 
piI¡øLöe
 + (
iLe·Unôs
 * 
unôHeight
);

404 
	gpbNeighb‹Fœgs
 = 
bNeighb‹Fœgs
 + 
iLe·Unôs
;

405 i‡(*
	gpbNeighb‹Fœgs
)

407 #i‡
O0043_BEST_EFFORT_DECODING


408 
Pñ
 
	gt›Le·VÆ
=
piRoiTemp
[0] << 
bôDïthDñè
;

410 
Pñ
 
	gt›Le·VÆ
=
piRoiTemp
[0];

412 
	gi
=0; i<
	gunôWidth
; i++)

414 
	gpiI¡øLöeTemp
[
i
] = 
t›Le·VÆ
;

419 
	gpiRoiTemp
 +
iPicSåide
;

420 
	gpiI¡øLöeTemp
--;

421 
	gpbNeighb‹Fœgs
--;

423 
	gj
=0; j<
	giLe·Unôs
; j++)

425 i‡(*
	gpbNeighb‹Fœgs
)

427 
	gi
=0; i<
	gunôHeight
; i++)

429 #i‡
O0043_BEST_EFFORT_DECODING


430 
	gpiI¡øLöeTemp
[-
i
] = 
piRoiTemp
[i*
iPicSåide
] << 
bôDïthDñè
;

432 
	gpiI¡øLöeTemp
[-
i
] = 
piRoiTemp
[i*
iPicSåide
];

436 
	gpiRoiTemp
 +
unôHeight
*
iPicSåide
;

437 
	gpiI¡øLöeTemp
 -
unôHeight
;

438 
	gpbNeighb‹Fœgs
--;

442 
	gpiRoiTemp
 = 
piRoiOrigö
 - 
iPicSåide
;

444 
	gpiI¡øLöeTemp
 = 
piI¡øLöe
 + (
iLe·Unôs
 * 
unôHeight
Ë+ 
unôWidth
;

445 
	gpbNeighb‹Fœgs
 = 
bNeighb‹Fœgs
 + 
iLe·Unôs
 + 1;

446 
	gj
=0; j<
	giAboveUnôs
; j++)

448 i‡(*
	gpbNeighb‹Fœgs
)

450 
	gi
=0; i<
	gunôWidth
; i++)

452 #i‡
O0043_BEST_EFFORT_DECODING


453 
	gpiI¡øLöeTemp
[
i
] = 
piRoiTemp
[i] << 
bôDïthDñè
;

455 
	gpiI¡øLöeTemp
[
i
] = 
piRoiTemp
[i];

459 
	gpiRoiTemp
 +
unôWidth
;

460 
	gpiI¡øLöeTemp
 +
unôWidth
;

461 
	gpbNeighb‹Fœgs
++;

465 
I¡
 
	giCuºJnô
 = 0;

466 
Pñ
 *
	gpiI¡øLöeCur
 = 
piI¡øLöe
;

467 c⁄° 
UI¡
 
	gpiI¡øLöeT›RowOff£t
 = 
iLe·Unôs
 * (
unôHeight
 - 
unôWidth
);

469 i‡(!
	gbNeighb‹Fœgs
[0])

473 
I¡
 
	giNext
 = 1;

474 
	giNext
 < 
	giTŸÆUnôs
 && !
	gbNeighb‹Fœgs
[
iNext
])

476 
	giNext
++;

478 
Pñ
 *
	gpiI¡øLöeNext
 = 
piI¡øLöe
 + ((
iNext
 < 
iLe·Unôs
Ë? (iNexà* 
unôHeight
Ë: (
piI¡øLöeT›RowOff£t
 + (iNexà* 
unôWidth
)));

479 c⁄° 
Pñ
 
	gªfSam∂e
 = *
piI¡øLöeNext
;

481 
I¡
 
	giNextOrT›
 = 
°d
::
mö
<I¡>(
iNext
, 
	giLe·Unôs
);

483 
	giCuºJnô
 < 
	giNextOrT›
)

485 
	gi
=0; i<
	gunôHeight
; i++)

487 
	gpiI¡øLöeCur
[
i
] = 
ªfSam∂e
;

489 
	gpiI¡øLöeCur
 +
unôHeight
;

490 
	giCuºJnô
++;

493 
	giCuºJnô
 < 
	giNext
)

495 
	gi
=0; i<
	gunôWidth
; i++)

497 
	gpiI¡øLöeCur
[
i
] = 
ªfSam∂e
;

499 
	gpiI¡øLöeCur
 +
unôWidth
;

500 
	giCuºJnô
++;

506 
	giCuºJnô
 < 
	giTŸÆUnôs
)

508 i‡(!
	gbNeighb‹Fœgs
[
iCuºJnô
])

511 c⁄° 
I¡
 
	gnumSam∂esInCuºUnô
 = (
iCuºJnô
 >
iLe·Unôs
Ë? 
unôWidth
 : 
unôHeight
;

512 c⁄° 
Pñ
 
	gªfSam∂e
 = *(
piI¡øLöeCur
-1);

513 
	gi
=0; i<
	gnumSam∂esInCuºUnô
; i++)

515 
	gpiI¡øLöeCur
[
i
] = 
ªfSam∂e
;

517 
	gpiI¡øLöeCur
 +
numSam∂esInCuºUnô
;

518 
	giCuºJnô
++;

523 
	gpiI¡øLöeCur
 +(
iCuºJnô
 >
iLe·Unôs
Ë? 
unôWidth
 : 
unôHeight
;

524 
	giCuºJnô
++;

530 
	gpiI¡øLöeTemp
 = 
piI¡øLöe
 + 
uiHeight
 + 
unôWidth
 - 2;

532 
	gi
=0; i<
	guiWidth
; i++)

534 
	gpiI¡øTemp
[
i
] = 
piI¡øLöeTemp
[i];

537 
	gpiI¡øLöeTemp
 = 
piI¡øLöe
 + 
uiHeight
 - 1;

538 
	gi
=1; i<
	guiHeight
; i++)

540 
	gpiI¡øTemp
[
i
*
uiWidth
] = 
piI¡øLöeTemp
[-i];

545 
Boﬁ
 
	gTComPªdi˘i⁄
::
	$fûãrögI¡øRe„ªn˚Sam∂es
(c⁄° 
Comp⁄ítID
 
compID
, 
UI¡
 
uiDúMode
, UI¡ 
uiTuChWidth
, UI¡ 
uiTuChHeight
, c⁄° 
ChromaF‹m©
 
chFmt
, c⁄° 
Boﬁ
 
öåaRe„ªn˚SmoŸhögDißbÀd
)

547 
Boﬁ
 
bFûãr
;

549 i‡(!
	`fûãrI¡øRe„ªn˚Sam∂es
(
	`toCh™√lTy≥
(
compID
), 
chFmt
, 
öåaRe„ªn˚SmoŸhögDißbÀd
))

551 
bFûãr
=
Ál£
;

555 
	`as£π
(
uiTuChWidth
>=4 && 
uiTuChHeight
>=4 && uiTuChWidth<128 && uiTuChHeight<128);

557 i‡(
uiDúMode
 =
DC_IDX
)

559 
bFûãr
=
Ál£
;

563 
I¡
 
diff
 = 
mö
<I¡>(
	`abs
((I¡Ë
uiDúMode
 - 
HOR_IDX
),ábs((I¡)uiDúModê- 
VER_IDX
));

564 
UI¡
 
sizeIndex
=
g_aucC⁄vîtToBô
[
uiTuChWidth
];

565 
	`as£π
(
sizeIndex
 < 
MAX_INTRA_FILTER_DEPTHS
);

566 
bFûãr
 = 
diff
 > 
m_aucI¡øFûãr
[
	`toCh™√lTy≥
(
compID
)][
sizeIndex
];

569  
bFûãr
;

570 
	}
}

572 
Boﬁ
 
	$isAboveLe·AvaûabÀ
–c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
 )

574 
Boﬁ
 
bAboveLe·Fœg
;

575 
UI¡
 
uiP¨tAboveLe·
;

576 c⁄° 
TComD©aCU
* 
pcCUAboveLe·
 = 
pcCU
->
	`gëPUAboveLe·
–
uiP¨tAboveLe·
, 
uiP¨tIdxLT
 );

577 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëC⁄°øöedI¡øPªd
())

579 
bAboveLe·Fœg
 = ( 
pcCUAboveLe·
 &&ÖcCUAboveLe·->
	`isI¡ø
–
uiP¨tAboveLe·
 ) );

583 
bAboveLe·Fœg
 = (
pcCUAboveLe·
 ? 
åue
 : 
Ál£
);

585  
bAboveLe·Fœg
;

586 
	}
}

588 
I¡
 
	$isAboveAvaûabÀ
–c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxRT
, 
Boﬁ
 *
bVÆidFœgs
 )

590 c⁄° 
UI¡
 
uiRa°îP¨tBegö
 = 
g_auiZsˇnToRa°î
[
uiP¨tIdxLT
];

591 c⁄° 
UI¡
 
uiRa°îP¨tEnd
 = 
g_auiZsˇnToRa°î
[
uiP¨tIdxRT
]+1;

592 c⁄° 
UI¡
 
uiIdxSãp
 = 1;

593 
Boﬁ
 *
pbVÆidFœgs
 = 
bVÆidFœgs
;

594 
I¡
 
iNumI¡ø
 = 0;

596  
UI¡
 
uiRa°îP¨t
 = 
uiRa°îP¨tBegö
; uiRa°îP¨à< 
uiRa°îP¨tEnd
; uiRa°îP¨à+
uiIdxSãp
 )

598 
UI¡
 
uiP¨tAbove
;

599 c⁄° 
TComD©aCU
* 
pcCUAbove
 = 
pcCU
->
	`gëPUAbove
–
uiP¨tAbove
, 
g_auiRa°îToZsˇn
[
uiRa°îP¨t
] );

600 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëC⁄°øöedI¡øPªd
())

602 i‡–
pcCUAbove
 &&ÖcCUAbove->
	`isI¡ø
–
uiP¨tAbove
 ) )

604 
iNumI¡ø
++;

605 *
pbVÆidFœgs
 = 
åue
;

609 *
pbVÆidFœgs
 = 
Ál£
;

614 i‡(
pcCUAbove
)

616 
iNumI¡ø
++;

617 *
pbVÆidFœgs
 = 
åue
;

621 *
pbVÆidFœgs
 = 
Ál£
;

624 
pbVÆidFœgs
++;

626  
iNumI¡ø
;

627 
	}
}

629 
I¡
 
	$isLe·AvaûabÀ
–c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxLB
, 
Boﬁ
 *
bVÆidFœgs
 )

631 c⁄° 
UI¡
 
uiRa°îP¨tBegö
 = 
g_auiZsˇnToRa°î
[
uiP¨tIdxLT
];

632 c⁄° 
UI¡
 
uiRa°îP¨tEnd
 = 
g_auiZsˇnToRa°î
[
uiP¨tIdxLB
]+1;

633 c⁄° 
UI¡
 
uiIdxSãp
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
();

634 
Boﬁ
 *
pbVÆidFœgs
 = 
bVÆidFœgs
;

635 
I¡
 
iNumI¡ø
 = 0;

637  
UI¡
 
uiRa°îP¨t
 = 
uiRa°îP¨tBegö
; uiRa°îP¨à< 
uiRa°îP¨tEnd
; uiRa°îP¨à+
uiIdxSãp
 )

639 
UI¡
 
uiP¨tLe·
;

640 c⁄° 
TComD©aCU
* 
pcCULe·
 = 
pcCU
->
	`gëPULe·
–
uiP¨tLe·
, 
g_auiRa°îToZsˇn
[
uiRa°îP¨t
] );

641 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëC⁄°øöedI¡øPªd
())

643 i‡–
pcCULe·
 &&ÖcCULe·->
	`isI¡ø
–
uiP¨tLe·
 ) )

645 
iNumI¡ø
++;

646 *
pbVÆidFœgs
 = 
åue
;

650 *
pbVÆidFœgs
 = 
Ál£
;

655 i‡–
pcCULe·
 )

657 
iNumI¡ø
++;

658 *
pbVÆidFœgs
 = 
åue
;

662 *
pbVÆidFœgs
 = 
Ál£
;

665 
pbVÆidFœgs
--;

668  
iNumI¡ø
;

669 
	}
}

671 
I¡
 
	$isAboveRightAvaûabÀ
–c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxRT
, 
Boﬁ
 *
bVÆidFœgs
 )

673 c⁄° 
UI¡
 
uiNumUnôsInPU
 = 
g_auiZsˇnToRa°î
[
uiP¨tIdxRT
] - g_auiZsˇnToRa°î[
uiP¨tIdxLT
] + 1;

674 
Boﬁ
 *
pbVÆidFœgs
 = 
bVÆidFœgs
;

675 
I¡
 
iNumI¡ø
 = 0;

677  
UI¡
 
uiOff£t
 = 1; uiOff£à<
uiNumUnôsInPU
; uiOffset++ )

679 
UI¡
 
uiP¨tAboveRight
;

680 c⁄° 
TComD©aCU
* 
pcCUAboveRight
 = 
pcCU
->
	`gëPUAboveRight
–
uiP¨tAboveRight
, 
uiP¨tIdxRT
, 
uiOff£t
 );

681 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëC⁄°øöedI¡øPªd
())

683 i‡–
pcCUAboveRight
 &&ÖcCUAboveRight->
	`isI¡ø
–
uiP¨tAboveRight
 ) )

685 
iNumI¡ø
++;

686 *
pbVÆidFœgs
 = 
åue
;

690 *
pbVÆidFœgs
 = 
Ál£
;

695 i‡–
pcCUAboveRight
 )

697 
iNumI¡ø
++;

698 *
pbVÆidFœgs
 = 
åue
;

702 *
pbVÆidFœgs
 = 
Ál£
;

705 
pbVÆidFœgs
++;

708  
iNumI¡ø
;

709 
	}
}

711 
I¡
 
	$isBñowLe·AvaûabÀ
–c⁄° 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdxLT
, UI¡ 
uiP¨tIdxLB
, 
Boﬁ
 *
bVÆidFœgs
 )

713 c⁄° 
UI¡
 
uiNumUnôsInPU
 = (
g_auiZsˇnToRa°î
[
uiP¨tIdxLB
] - g_auiZsˇnToRa°î[
uiP¨tIdxLT
]Ë/ 
pcCU
->
	`gëPic
()->
	`gëNumP¨tInCtuWidth
() + 1;

714 
Boﬁ
 *
pbVÆidFœgs
 = 
bVÆidFœgs
;

715 
I¡
 
iNumI¡ø
 = 0;

717  
UI¡
 
uiOff£t
 = 1; uiOff£à<
uiNumUnôsInPU
; uiOffset++ )

719 
UI¡
 
uiP¨tBñowLe·
;

720 c⁄° 
TComD©aCU
* 
pcCUBñowLe·
 = 
pcCU
->
	`gëPUBñowLe·
–
uiP¨tBñowLe·
, 
uiP¨tIdxLB
, 
uiOff£t
 );

721 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëC⁄°øöedI¡øPªd
())

723 i‡–
pcCUBñowLe·
 &&ÖcCUBñowLe·->
	`isI¡ø
–
uiP¨tBñowLe·
 ) )

725 
iNumI¡ø
++;

726 *
pbVÆidFœgs
 = 
åue
;

730 *
pbVÆidFœgs
 = 
Ál£
;

735 i‡–
pcCUBñowLe·
 )

737 
iNumI¡ø
++;

738 *
pbVÆidFœgs
 = 
åue
;

742 *
pbVÆidFœgs
 = 
Ál£
;

745 
pbVÆidFœgs
--;

748  
iNumI¡ø
;

749 
	}
}

	@TLibCommon/TComPattern.h

38 #i‚de‡
__TCOMPATTERN__


39 
	#__TCOMPATTERN__


	)

42 
	~"Comm⁄Def.h
"

51 
˛ass
 
	gTComD©aCU
;

52 
˛ass
 
	gTComTU
;

55 ˛as†
	cTComP©ã∫


57 
	m¥iv©e
:

58 
Pñ
* 
m_piROIOrigö
;

59 
I¡
 
	mm_roiWidth
;

60 
I¡
 
	mm_roiHeight
;

61 
I¡
 
	mm_∑âînSåide
;

62 
I¡
 
	mm_bôDïth
;

64 #i‡
MCTS_ENC_CHECK


65 
I¡
 
	mm_roiPosX
;

66 
I¡
 
	mm_roiPosY
;

67 
I¡
 
	mm_tûeLe·T›PñPosX
;

68 
I¡
 
	mm_tûeLe·T›PñPosY
;

69 
I¡
 
	mm_tûeRightBŸtomPñPosX
;

70 
I¡
 
	mm_tûeRightBŸtomPñPosY
;

73 
	mpublic
:

75 
I¡
 
	$gëROIYWidth
(Ëc⁄° {  
m_roiWidth
; }

76 
I¡
 
	$gëROIYHeight
(Ëc⁄° {  
m_roiHeight
; 
	}
}

77 
I¡
 
	$gëP©ã∫LSåide
(Ëc⁄° {  
m_∑âînSåide
; 
	}
}

78 
I¡
 
	$gëBôDïthY
(Ëc⁄° {  
m_bôDïth
; 
	}
}

79 #i‡
MCTS_ENC_CHECK


80 
I¡
 
	$gëROIYPosX
(Ëc⁄° {  
m_roiPosX
; 
	}
}

81 
I¡
 
	$gëROIYPosY
(Ëc⁄° {  
m_roiPosY
; 
	}
}

83 
I¡
 
	$gëTûeLe·T›PñPosX
(Ëc⁄° {  
m_tûeLe·T›PñPosX
; 
	}
}

84 
I¡
 
	$gëTûeLe·T›PñPosY
(Ëc⁄° {  
m_tûeLe·T›PñPosY
; 
	}
}

85 
I¡
 
	$gëTûeRightBŸtomPñPosX
(Ëc⁄° {  
m_tûeRightBŸtomPñPosX
; 
	}
}

86 
I¡
 
	$gëTûeRightBŸtomPñPosY
(Ëc⁄° {  
m_tûeRightBŸtomPñPosY
; 
	}
}

89 
__ölöe
 
Pñ
* 
	$gëROIY
()

91  
m_piROIOrigö
;

92 
	}
}

93 
__ölöe
 c⁄° 
Pñ
* 
	$gëROIY
() const

95  
m_piROIOrigö
;

96 
	}
}

98 
	$TComP©ã∫
()

99 : 
	`m_piROIOrigö
(
NULL
)

100 , 
	`m_roiWidth
(0)

101 , 
	`m_roiHeight
(0)

102 , 
	`m_∑âînSåide
(0)

103 , 
	$m_bôDïth
(0)

104 #i‡
MCTS_ENC_CHECK


105 , 
	`m_roiPosX
(0)

106 , 
	`m_roiPosY
(0)

107 , 
	`m_tûeLe·T›PñPosX
(0)

108 , 
	`m_tûeLe·T›PñPosY
(0)

109 , 
	`m_tûeRightBŸtomPñPosX
(0)

110 , 
	$m_tûeRightBŸtomPñPosY
(0)

112 {
	}
};

120 #i‡
MCTS_ENC_CHECK


121 
Void
 
öôP©ã∫
(
Pñ
* 
piY
, 
I¡
 
roiWidth
, I¡ 
roiHeight
, I¡ 
°ride
, I¡ 
bôDïthLuma
, I¡ 
roiPosX
, I¡ 
roiPosY
);

122 
Void
 
£tTûeB‹dîs
(
I¡
 
tûeLe·T›PñPosX
, I¡ 
tûeLe·T›PñPosY
, I¡ 
tûeRightBŸtomPñPosX
, I¡ 
tûeRightBŸtomPñPosY
);

124 
Void
 
öôP©ã∫
(
Pñ
* 
piY
, 
I¡
 
roiWidth
, I¡ 
roiHeight
, I¡ 
°ride
, I¡ 
bôDïthLuma
);

	@TLibCommon/TComPic.cpp

38 
	~"TComPic.h
"

39 
	~"SEI.h
"

48 
	gTComPic
::
	$TComPic
()

49 : 
	`m_uiTLayî
 (0)

50 , 
	`m_bU£dByCuº
 (
Ál£
)

51 , 
	`m_bIsL⁄gTîm
 (
Ál£
)

52 , 
	`m_pcPicYuvPªd
 (
NULL
)

53 , 
	`m_pcPicYuvResi
 (
NULL
)

54 , 
	`m_bRec⁄°ru˘ed
 (
Ál£
)

55 , 
	`m_bNìdedF‹Ouçut
 (
Ál£
)

56 , 
	`m_uiCuºSli˚Idx
 (0)

57 , 
	$m_bCheckLTMSB
 (
Ál£
)

59 
UI¡
 
i
=0; i<
NUM_PIC_YUV
; i++)

61 
m_≠cPicYuv
[
i
] = 
NULL
;

63 #i‡
FGS_RDD5_ENABLE


64 
m_gøöCh¨a˘îi°ic
 = 
NULL
;

65 
m_gøöBuf
 = 
NULL
;

67 
	}
}

69 
	gTComPic
::~
	$TComPic
()

71 
	`de°roy
();

72 
	}
}

74 #i‡
REDUCED_ENCODER_MEMORY


75 
Void
 
	gTComPic
::
	$¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, c⁄° 
Boﬁ
 
bCª©eEncodîSour˚PicYuv
, c⁄° Boﬁ 
bCª©eF‹ImmedüãRec⁄°ru˘i⁄
 )

77 
Void
 
TComPic
::
	$¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, c⁄° 
Boﬁ
 
bIsVútuÆ
)

80 
	`de°roy
();

82 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
 = 
•s
.
	`gëChromaF‹m©Idc
();

83 c⁄° 
I¡
 
iWidth
 = 
•s
.
	`gëPicWidthInLumaSam∂es
();

84 c⁄° 
I¡
 
iHeight
 = 
•s
.
	`gëPicHeightInLumaSam∂es
();

85 c⁄° 
UI¡
 
uiMaxCuWidth
 = 
•s
.
	`gëMaxCUWidth
();

86 c⁄° 
UI¡
 
uiMaxCuHeight
 = 
•s
.
	`gëMaxCUHeight
();

87 c⁄° 
UI¡
 
uiMaxDïth
 = 
•s
.
	`gëMaxTŸÆCUDïth
();

89 #i‡
REDUCED_ENCODER_MEMORY


90 
m_picSym
.
	`¸óã
–
•s
, 
µs
, 
uiMaxDïth
, 
bCª©eF‹ImmedüãRec⁄°ru˘i⁄
 );

91 i‡(
bCª©eEncodîSour˚PicYuv
)

93 
m_picSym
.
	`¸óã
–
•s
, 
µs
, 
uiMaxDïth
 );

94 i‡(!
bIsVútuÆ
)

97 
m_≠cPicYuv
[
PIC_YUV_ORG
 ] = 
√w
 
TComPicYuv
; m_≠cPicYuv[PIC_YUV_ORG ]->
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©IDC
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
uiMaxDïth
, 
åue
 );

98 
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
] = 
√w
 
TComPicYuv
; m_≠cPicYuv[PIC_YUV_TRUE_ORG]->
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©IDC
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
uiMaxDïth
, 
åue
 );

100 #i‡
REDUCED_ENCODER_MEMORY


101 i‡(
bCª©eF‹ImmedüãRec⁄°ru˘i⁄
)

104 
m_≠cPicYuv
[
PIC_YUV_REC
] = 
√w
 
TComPicYuv
; m_≠cPicYuv[PIC_YUV_REC]->
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©IDC
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
uiMaxDïth
, 
åue
 );

105 #i‡
REDUCED_ENCODER_MEMORY


110 i‡(
m_SEIs
.
	`size
() > 0)

112 
	`dñëeSEIs
 (
m_SEIs
);

114 
m_bU£dByCuº
 = 
Ál£
;

115 
	}
}

117 #i‡
REDUCED_ENCODER_MEMORY


118 
Void
 
	gTComPic
::
	$¥ï¨eF‹EncodîSour˚PicYuv
()

120 c⁄° 
TComSPS
 &
•s
=
m_picSym
.
	`gëSPS
();

122 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
 = 
•s
.
	`gëChromaF‹m©Idc
();

123 c⁄° 
I¡
 
iWidth
 = 
•s
.
	`gëPicWidthInLumaSam∂es
();

124 c⁄° 
I¡
 
iHeight
 = 
•s
.
	`gëPicHeightInLumaSam∂es
();

125 c⁄° 
UI¡
 
uiMaxCuWidth
 = 
•s
.
	`gëMaxCUWidth
();

126 c⁄° 
UI¡
 
uiMaxCuHeight
 = 
•s
.
	`gëMaxCUHeight
();

127 c⁄° 
UI¡
 
uiMaxDïth
 = 
•s
.
	`gëMaxTŸÆCUDïth
();

129 i‡(
m_≠cPicYuv
[
PIC_YUV_ORG
 ]==
NULL
)

131 
m_≠cPicYuv
[
PIC_YUV_ORG
 ] = 
√w
 
TComPicYuv
; m_≠cPicYuv[PIC_YUV_ORG ]->
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©IDC
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
uiMaxDïth
, 
åue
 );

133 i‡(
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
 ]==
NULL
)

135 
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
] = 
√w
 
TComPicYuv
; m_≠cPicYuv[PIC_YUV_TRUE_ORG]->
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©IDC
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
uiMaxDïth
, 
åue
 );

137 
	}
}

139 
Void
 
	gTComPic
::
	$¥ï¨eF‹Rec⁄°ru˘i⁄
()

141 i‡(
m_≠cPicYuv
[
PIC_YUV_REC
] =
NULL
)

143 c⁄° 
TComSPS
 &
•s
=
m_picSym
.
	`gëSPS
();

144 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
 = 
•s
.
	`gëChromaF‹m©Idc
();

145 c⁄° 
I¡
 
iWidth
 = 
•s
.
	`gëPicWidthInLumaSam∂es
();

146 c⁄° 
I¡
 
iHeight
 = 
•s
.
	`gëPicHeightInLumaSam∂es
();

147 c⁄° 
UI¡
 
uiMaxCuWidth
 = 
•s
.
	`gëMaxCUWidth
();

148 c⁄° 
UI¡
 
uiMaxCuHeight
 = 
•s
.
	`gëMaxCUHeight
();

149 c⁄° 
UI¡
 
uiMaxDïth
 = 
•s
.
	`gëMaxTŸÆCUDïth
();

151 
m_≠cPicYuv
[
PIC_YUV_REC
] = 
√w
 
TComPicYuv
; m_≠cPicYuv[PIC_YUV_REC]->
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©IDC
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
uiMaxDïth
, 
åue
 );

155 
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`£tB‹dîExãnsi⁄
(
Ál£
);

157 
m_picSym
.
	`¥ï¨eF‹Rec⁄°ru˘i⁄
();

158 
	}
}

160 
Void
 
	gTComPic
::
	$ªÀa£Rec⁄°ru˘i⁄I¡îmedüãD©a
()

162 
m_picSym
.
	`ªÀa£Rec⁄°ru˘i⁄I¡îmedüãD©a
();

163 
	}
}

165 
Void
 
	gTComPic
::
	$ªÀa£EncodîSour˚ImageD©a
()

167 i‡(
m_≠cPicYuv
[
PIC_YUV_ORG
 ])

169 
m_≠cPicYuv
[
PIC_YUV_ORG
]->
	`de°roy
();

170 
dñëe
 
m_≠cPicYuv
[
PIC_YUV_ORG
];

171 
m_≠cPicYuv
[
PIC_YUV_ORG
] = 
NULL
;

173 i‡(
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
 ])

175 
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
]->
	`de°roy
();

176 
dñëe
 
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
];

177 
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
] = 
NULL
;

179 
	}
}

181 
Void
 
	gTComPic
::
	$ªÀa£AŒRec⁄°ru˘i⁄D©a
()

183 i‡(
m_≠cPicYuv
[
PIC_YUV_REC
 ])

185 
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`de°roy
();

186 
dñëe
 
m_≠cPicYuv
[
PIC_YUV_REC
];

187 
m_≠cPicYuv
[
PIC_YUV_REC
] = 
NULL
;

189 
m_picSym
.
	`ªÀa£AŒRec⁄°ru˘i⁄D©a
();

190 
	}
}

193 
Void
 
	gTComPic
::
	$de°roy
()

195 
m_picSym
.
	`de°roy
();

197 
UI¡
 
i
=0; i<
NUM_PIC_YUV
; i++)

199 i‡(
m_≠cPicYuv
[
i
])

201 
m_≠cPicYuv
[
i
]->
	`de°roy
();

202 
dñëe
 
m_≠cPicYuv
[
i
];

203 
m_≠cPicYuv
[
i
] = 
NULL
;

207 
	`dñëeSEIs
(
m_SEIs
);

208 #i‡
FGS_RDD5_ENABLE


209 
m_gøöBuf
 = 
NULL
;

211 
	}
}

213 
Void
 
	gTComPic
::
	$com¥essMŸi⁄
()

215 
TComPicSym
* 
pPicSym
 = 
	`gëPicSym
();

216  
UI¡
 
uiCUAddr
 = 0; uiCUAdd∏< 
pPicSym
->
	`gëNumbîOfCtusInFøme
(); uiCUAddr++ )

218 
TComD©aCU
* 
pCtu
 = 
pPicSym
->
	`gëCtu
(
uiCUAddr
);

219 
pCtu
->
	`com¥essMV
();

221 
	}
}

223 
Boﬁ
 
	gTComPic
::
	$gëSAOMîgeAvaûabûôy
(
I¡
 
cuºAddr
, I¡ 
mîgeAddr
)

225 
Boﬁ
 
mîgeCtbInSli˚Seg
 = (
mîgeAddr
 >
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
	`gëCtu
(
cuºAddr
)->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
()));

226 
Boﬁ
 
mîgeCtbInTûe
 = (
	`gëPicSym
()->
	`gëTûeIdxM≠
(
mîgeAddr
Ë=gëPicSym()->gëTûeIdxM≠(
cuºAddr
));

227  (
mîgeCtbInSli˚Seg
 && 
mîgeCtbInTûe
);

228 
	}
}

230 
UI¡
 
	gTComPic
::
	$gëSub°ªamF‹CtuAddr
(c⁄° 
UI¡
 
˘uAddr
, c⁄° 
Boﬁ
 
bAddªssInRa°î
, 
TComSli˚
 *
pcSli˚
)

232 
UI¡
 
subSåm
;

233 c⁄° 
boﬁ
 
bWPPE«bÀd
=
pcSli˚
->
	`gëPPS
()->
	`gëE¡r›yCodögSyncE«bÀdFœg
();

234 c⁄° 
TComPicSym
 &
picSym
 = *(
	`gëPicSym
());

236 i‡((
bWPPE«bÀd
 && 
picSym
.
	`gëFømeHeightInCtus
()>1Ë|| (picSym.
	`gëNumTûes
()>1))

238 i‡(
bWPPE«bÀd
)

240 c⁄° 
UI¡
 
˘uRsAddr
 = 
bAddªssInRa°î
?
˘uAddr
 : 
picSym
.
	`gëCtuTsToRsAddrM≠
(ctuAddr);

241 c⁄° 
UI¡
 
‰ameWidthInCtus
 = 
picSym
.
	`gëFømeWidthInCtus
();

242 c⁄° 
UI¡
 
tûeIndex
 = 
picSym
.
	`gëTûeIdxM≠
(
˘uRsAddr
);

243 c⁄° 
UI¡
 
numTûeCﬁumns
 = (
picSym
.
	`gëNumTûeCﬁumnsMöus1
()+1);

244 c⁄° 
TComTûe
 *
pTûe
 = 
picSym
.
	`gëTComTûe
(
tûeIndex
);

245 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
pTûe
->
	`gëFú°CtuRsAddr
();

246 c⁄° 
UI¡
 
tûeYInCtus
 = 
fú°CtuRsAddrOfTûe
 / 
‰ameWidthInCtus
;

248 c⁄° 
UI¡
 
˘uLöe
 = 
˘uRsAddr
 / 
‰ameWidthInCtus
;

249 c⁄° 
UI¡
 
°¨tögSub°ªamF‹Tûe
 =(
tûeYInCtus
*
numTûeCﬁumns
Ë+ (
pTûe
->
	`gëTûeHeightInCtus
()*(
tûeIndex
%numTileColumns));

250 
subSåm
 = 
°¨tögSub°ªamF‹Tûe
 + (
˘uLöe
 - 
tûeYInCtus
);

254 c⁄° 
UI¡
 
˘uRsAddr
 = 
bAddªssInRa°î
?
˘uAddr
 : 
picSym
.
	`gëCtuTsToRsAddrM≠
(ctuAddr);

255 c⁄° 
UI¡
 
tûeIndex
 = 
picSym
.
	`gëTûeIdxM≠
(
˘uRsAddr
);

256 
subSåm
=
tûeIndex
;

262 
subSåm
 = 0;

264  
subSåm
;

265 
	}
}

267 #i‡
FGS_RDD5_ENABLE


269 
	gTComPic
::
	$¸óãGøöSy¡hesizî
(
Boﬁ
 
bFú°Pi˘uªInSequí˚
, 
SEIFûmGøöSy¡hesizî
* 
pGøöCh¨a˘îi°ics
, 
TComPicYuv
* 
pGøöBuf
, c⁄° 
TComSPS
* 
•s
)

271 
m_gøöCh¨a˘îi°ic
 = 
pGøöCh¨a˘îi°ics
;

272 
m_gøöBuf
 = 
pGøöBuf
;

274 i‡(
bFú°Pi˘uªInSequí˚
)

277 
m_gøöCh¨a˘îi°ic
->
	`¸óã
(
•s
->
	`gëPicWidthInLumaSam∂es
(), sps->
	`gëPicHeightInLumaSam∂es
(),

278 
•s
->
	`gëChromaF‹m©Idc
(), sps->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
), 0, 1);

281 
m_gøöBuf
->
	`¸óãWôhoutCUInfo
(
•s
->
	`gëPicWidthInLumaSam∂es
(), sps->
	`gëPicHeightInLumaSam∂es
(),

282 
•s
->
	`gëChromaF‹m©Idc
(), 
Ál£
, 0, 0);

284 
m_gøöCh¨a˘îi°ic
->
	`fgsInô
();

286 
	}
}

288 
TComPicYuv
* 
	gTComPic
::
	$gëPicYuvDi•
()

290 
I¡
 
∑ylﬂdTy≥
 = 0;

291 
°d
::
li°
<
SEI
*>::
ôî©‹
 
mesßge
;

293 
m_gøöCh¨a˘îi°ic
->
m_îr‹Code
 = -1;

294 
mesßge
 = 
m_SEIs
.
	`begö
(); mesßgê!m_SEIs.
	`íd
(); ++message)

296 
∑ylﬂdTy≥
 = (*
mesßge
)->
	`∑ylﬂdTy≥
();

297 i‡(
∑ylﬂdTy≥
 =
SEI
::
FILM_GRAIN_CHARACTERISTICS
)

299 
m_gøöCh¨a˘îi°ic
->
m_pFgcP¨amëîs
 = 
°©ic_ˇ°
<
SEIFûmGøöCh¨a˘îi°ics
*>(*
mesßge
);

301 
m_gøöCh¨a˘îi°ic
->
m_îr‹Code
 = m_gøöCh¨a˘îi°ic->
	`gøöVÆid©eP¨ams
();

306 i‡(
FGS_SUCCESS
 =
m_gøöCh¨a˘îi°ic
->
m_îr‹Code
)

308 
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`c›yToPic
(
m_gøöBuf
);

309 
m_gøöCh¨a˘îi°ic
->
m_poc
 = 
	`gëPOC
();

310 
m_gøöCh¨a˘îi°ic
->
	`gøöSy¡hesizeAndBÀnd
(
m_gøöBuf
, 
	`gëSli˚
(0)->
	`gëIdrPicFœg
());

311  
m_gøöBuf
;

315 i‡(
∑ylﬂdTy≥
 =
SEI
::
FILM_GRAIN_CHARACTERISTICS
)

317 
	`Ârötf
(
°dout
, "Fûm Gøö sy¡hesi†i†nŸÖîf‹med. Eº‹ code: 0x%x \n", 
m_gøöCh¨a˘îi°ic
->
m_îr‹Code
);

319  
m_≠cPicYuv
[
PIC_YUV_REC
];

322 
	}
}

	@TLibCommon/TComPic.h

38 #i‚de‡
__TCOMPIC__


39 
	#__TCOMPIC__


	)

42 
	~"Comm⁄Def.h
"

43 
	~"TComPicSym.h
"

44 
	~"TComPicYuv.h
"

45 
	~"TComBôSåóm.h
"

46 #i‡
FGS_RDD5_ENABLE


47 
	~"SEIFûmGøöSy¡hesizî.h
"

59 ˛as†
	cTComPic


61 
	mpublic
:

62 íum { 
PIC_YUV_ORG
=0, 
	mPIC_YUV_REC
=1, 
	mPIC_YUV_TRUE_ORG
=2, 
	mNUM_PIC_YUV
=3 } 
	tPIC_YUV_T
;

64 
TComPicYuv
* 
	$gëPicYuvTrueOrg
(Ë{  
m_≠cPicYuv
[
PIC_YUV_TRUE_ORG
]; 
	}
}

66 
	g¥iv©e
:

67 
UI¡
 
m_uiTLayî
;

68 
Boﬁ
 
	gm_bU£dByCuº
;

69 
Boﬁ
 
	gm_bIsL⁄gTîm
;

70 
TComPicSym
 
	gm_picSym
;

71 
TComPicYuv
* 
	gm_≠cPicYuv
[
NUM_PIC_YUV
];

73 
TComPicYuv
* 
	gm_pcPicYuvPªd
;

74 
TComPicYuv
* 
	gm_pcPicYuvResi
;

75 
Boﬁ
 
	gm_bRec⁄°ru˘ed
;

76 
Boﬁ
 
	gm_bNìdedF‹Ouçut
;

77 
UI¡
 
	gm_uiCuºSli˚Idx
;

78 
Boﬁ
 
	gm_bCheckLTMSB
;

80 
Boﬁ
 
	gm_isT›
;

81 
Boﬁ
 
	gm_isFõld
;

83 
	g°d
::
ve˘‹
<
°d
::ve˘‹<
TComD©aCU
*> > 
m_vSli˚CUD©aLök
;

85 
SEIMesßges
 
	gm_SEIs
;

87 
	gpublic
:

88 
TComPic
();

89 
	gvútuÆ
 ~
TComPic
();

91 #i‡
REDUCED_ENCODER_MEMORY


92 
Void
 
¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, c⁄° 
Boﬁ
 
bCª©eEncodîSour˚PicYuv
, c⁄° Boﬁ 
bCª©eF‹ImmedüãRec⁄°ru˘i⁄
 );

93 
Void
 
¥ï¨eF‹EncodîSour˚PicYuv
();

94 
Void
 
¥ï¨eF‹Rec⁄°ru˘i⁄
();

95 
Void
 
ªÀa£Rec⁄°ru˘i⁄I¡îmedüãD©a
();

96 
Void
 
ªÀa£AŒRec⁄°ru˘i⁄D©a
();

97 
Void
 
ªÀa£EncodîSour˚ImageD©a
();

99 
Void
 
¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, c⁄° 
Boﬁ
 
bIsVútuÆ
 );

102 
vútuÆ
 
Void
 
de°roy
();

104 
UI¡
 
	$gëTLayî
(Ëc⁄° {  
m_uiTLayî
; 
	}
}

105 
Void
 
	$£tTLayî
–
UI¡
 
uiTLayî
 ) { 
m_uiTLayî
 = uiTLayî; 
	}
}

107 
Boﬁ
 
	$gëU£dByCuº
(Ëc⁄° {  
m_bU£dByCuº
; 
	}
}

108 
Void
 
	$£tU£dByCuº
–
Boﬁ
 
bU£d
 ) { 
m_bU£dByCuº
 = bU£d; 
	}
}

109 
Boﬁ
 
	$gëIsL⁄gTîm
(Ëc⁄° {  
m_bIsL⁄gTîm
; 
	}
}

110 
Void
 
	$£tIsL⁄gTîm
–
Boﬁ
 
…
 ) { 
m_bIsL⁄gTîm
 =Üt; 
	}
}

111 
Void
 
	$£tCheckLTMSBPª£¡
 (
Boﬁ
 
b
 ) {
m_bCheckLTMSB
=b;
	}
}

112 
Boﬁ
 
	$gëCheckLTMSBPª£¡
 (Ë{  
m_bCheckLTMSB
;
	}
}

114 
TComPicSym
* 
	$gëPicSym
(Ë{  &
m_picSym
; 
	}
}

115 c⁄° 
TComPicSym
* 
	$gëPicSym
(Ëc⁄° {  &
m_picSym
; 
	}
}

116 
TComSli˚
* 
	$gëSli˚
(
I¡
 
i
Ë{  
m_picSym
.
	`gëSli˚
(i); 
	}
}

117 c⁄° 
TComSli˚
* 
	$gëSli˚
(
I¡
 
i
Ëc⁄° {  
m_picSym
.
	`gëSli˚
(i); 
	}
}

118 
I¡
 
	$gëPOC
(Ëc⁄° {  
m_picSym
.
	`gëSli˚
(
m_uiCuºSli˚Idx
)->
	`gëPOC
(); 
	}
}

119 
TComD©aCU
* 
	$gëCtu
–
UI¡
 
˘uRsAddr
 ) {  
m_picSym
.
	`gëCtu
–˘uRsAdd∏); 
	}
}

120 c⁄° 
TComD©aCU
* 
	$gëCtu
–
UI¡
 
˘uRsAddr
 ) c⁄° {  
m_picSym
.
	`gëCtu
–˘uRsAdd∏); 
	}
}

122 
TComPicYuv
* 
	$gëPicYuvOrg
(Ë{  
m_≠cPicYuv
[
PIC_YUV_ORG
]; 
	}
}

123 
TComPicYuv
* 
	$gëPicYuvRec
(Ë{  
m_≠cPicYuv
[
PIC_YUV_REC
]; 
	}
}

125 #i‡
FGS_RDD5_ENABLE


126 
Void
 
¸óãGøöSy¡hesizî
(
Boﬁ
 
bFú°Pi˘uªInSequí˚
, 
SEIFûmGøöSy¡hesizî
* 
pGøöCh¨a˘îi°ics
, 
TComPicYuv
* 
pGøöBuf
, c⁄° 
TComSPS
* 
•s
);

127 
SEIFûmGøöSy¡hesizî
 *
	gm_gøöCh¨a˘îi°ic
;

128 
TComPicYuv
 *
	gm_gøöBuf
;

129 
TComPicYuv
* 
gëPicYuvDi•
();

132 
TComPicYuv
* 
	$gëPicYuvPªd
(Ë{  
m_pcPicYuvPªd
; 
	}
}

133 
TComPicYuv
* 
	$gëPicYuvResi
(Ë{  
m_pcPicYuvResi
; 
	}
}

134 
Void
 
	$£tPicYuvPªd
–
TComPicYuv
* 
pcPicYuv
 ) { 
m_pcPicYuvPªd
 =ÖcPicYuv; 
	}
}

135 
Void
 
	$£tPicYuvResi
–
TComPicYuv
* 
pcPicYuv
 ) { 
m_pcPicYuvResi
 =ÖcPicYuv; 
	}
}

137 
UI¡
 
	$gëNumbîOfCtusInFøme
(Ëc⁄° {  
m_picSym
.
	`gëNumbîOfCtusInFøme
(); 
	}
}

138 
UI¡
 
	$gëNumP¨tInCtuWidth
(Ëc⁄° {  
m_picSym
.
	`gëNumP¨tInCtuWidth
(); 
	}
}

139 
UI¡
 
	$gëNumP¨tInCtuHeight
(Ëc⁄° {  
m_picSym
.
	`gëNumP¨tInCtuHeight
(); 
	}
}

140 
UI¡
 
	$gëNumP¨tôi⁄sInCtu
(Ëc⁄° {  
m_picSym
.
	`gëNumP¨tôi⁄sInCtu
(); 
	}
}

141 
UI¡
 
	$gëFømeWidthInCtus
(Ëc⁄° {  
m_picSym
.
	`gëFømeWidthInCtus
(); 
	}
}

142 
UI¡
 
	$gëFømeHeightInCtus
(Ëc⁄° {  
m_picSym
.
	`gëFømeHeightInCtus
(); 
	}
}

143 
UI¡
 
	$gëMöCUWidth
(Ëc⁄° {  
m_picSym
.
	`gëMöCUWidth
(); 
	}
}

144 
UI¡
 
	$gëMöCUHeight
(Ëc⁄° {  
m_picSym
.
	`gëMöCUHeight
(); 
	}
}

146 
I¡
 
	$gëSåide
(c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`gëSåide
(id); 
	}
}

147 
I¡
 
	$gëComp⁄ítSˇÀX
(c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`gëComp⁄ítSˇÀX
(id); 
	}
}

148 
I¡
 
	$gëComp⁄ítSˇÀY
(c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`gëComp⁄ítSˇÀY
(id); 
	}
}

149 
ChromaF‹m©
 
	$gëChromaF‹m©
(Ëc⁄° {  
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`gëChromaF‹m©
(); 
	}
}

150 
I¡
 
	$gëNumbîVÆidComp⁄íts
(Ëc⁄° {  
m_≠cPicYuv
[
PIC_YUV_REC
]->
	`gëNumbîVÆidComp⁄íts
(); 
	}
}

152 
Void
 
	$£tRec⁄M¨k
 (
Boﬁ
 
b
Ë{ 
m_bRec⁄°ru˘ed
 = b; 
	}
}

153 
Boﬁ
 
	$gëRec⁄M¨k
 (Ëc⁄° {  
m_bRec⁄°ru˘ed
; 
	}
}

154 
Void
 
	$£tOuçutM¨k
 (
Boﬁ
 
b
Ë{ 
m_bNìdedF‹Ouçut
 = b; 
	}
}

155 
Boﬁ
 
	$gëOuçutM¨k
 (Ëc⁄° {  
m_bNìdedF‹Ouçut
; 
	}
}

157 
Void
 
com¥essMŸi⁄
();

158 
UI¡
 
	$gëCuºSli˚Idx
(Ëc⁄° {  
m_uiCuºSli˚Idx
; 
	}
}

159 
Void
 
	$£tCuºSli˚Idx
(
UI¡
 
i
Ë{ 
m_uiCuºSli˚Idx
 = i; 
	}
}

160 
UI¡
 
	$gëNumAŒoˇãdSli˚
(Ëc⁄° { 
m_picSym
.
	`gëNumAŒoˇãdSli˚
();
	}
}

161 
Void
 
	$ÆloˇãNewSli˚
(Ë{
m_picSym
.
	`ÆloˇãNewSli˚
(); 
	}
}

162 
Void
 
	$˛órSli˚Buf„r
(Ë{
m_picSym
.
	`˛órSli˚Buf„r
(); 
	}
}

164 c⁄° 
	gWödow
& 
	$gëC⁄f‹m™˚Wödow
(Ëc⁄° {  
m_picSym
.
	`gëSPS
().
	`gëC⁄f‹m™˚Wödow
(); 
	}
}

165 
Wödow
 
	$gëDefDi•œyWödow
(Ëc⁄° {  
m_picSym
.
	`gëSPS
().
	`gëVuiP¨amëîsPª£¡Fœg
(Ë? m_picSym.gëSPS().
	`gëVuiP¨amëîs
()->
	`gëDeÁu…Di•œyWödow
(Ë: 
	`Wödow
(); 
	}
}

167 
Boﬁ
 
gëSAOMîgeAvaûabûôy
(
I¡
 
cuºAddr
, I¡ 
mîgeAddr
);

169 
UI¡
 
gëSub°ªamF‹CtuAddr
(c⁄° UI¡ 
˘uAddr
, c⁄° 
Boﬁ
 
bAddªssInRa°î
, 
TComSli˚
 *
pcSli˚
);

173 
Void
 
	$£tT›Fõld
(
Boﬁ
 
b
Ë{
m_isT›
 = b;
	}
}

174 
Boﬁ
 
	$isT›Fõld
(Ë{ 
m_isT›
;
	}
}

175 
Void
 
	$£tFõld
(
Boﬁ
 
b
Ë{
m_isFõld
 = b;
	}
}

176 
Boﬁ
 
	$isFõld
(Ëc⁄° { 
m_isFõld
;
	}
}

179 
Void
 
	$£tSEIs
(
SEIMesßges
& 
£is
Ë{ 
m_SEIs
 = seis; 
	}
}

184 
	gSEIMesßges
& 
	$gëSEIs
(Ë{  
m_SEIs
; 
	}
}

189 c⁄° 
	gSEIMesßges
& 
	$gëSEIs
(Ëc⁄° {  
m_SEIs
; 
	}
}

	@TLibCommon/TComPicSym.cpp

38 
	~"TComPicSym.h
"

39 
	~"TComSam∂eAd≠tiveOff£t.h
"

40 
	~"TComSli˚.h
"

49 
	gTComPicSym
::
	$TComPicSym
()

50 :
	`m_‰ameWidthInCtus
(0)

51 ,
	`m_‰ameHeightInCtus
(0)

52 ,
	`m_uiMöCUWidth
(0)

53 ,
	`m_uiMöCUHeight
(0)

54 ,
	`m_uhTŸÆDïth
(0)

55 ,
	`m_numP¨tôi⁄sInCtu
(0)

56 ,
	`m_numP¨tInCtuWidth
(0)

57 ,
	`m_numP¨tInCtuHeight
(0)

58 ,
	`m_numCtusInFøme
(0)

59 ,
	`m_≠Sli˚s
()

60 ,
	`m_pi˘uªCtuAºay
(
NULL
)

61 ,
	`m_numTûeCﬁumnsMöus1
(0)

62 ,
	`m_numTûeRowsMöus1
(0)

63 ,
	`m_˘uTsToRsAddrM≠
(
NULL
)

64 ,
	`m_puiTûeIdxM≠
(
NULL
)

65 ,
	$m_˘uRsToTsAddrM≠
(
NULL
)

66 #i‡
REDUCED_ENCODER_MEMORY


67 ,
	$m_dpbPîCtuD©a
(
NULL
)

69 ,
	$m_ßoBlkP¨ams
(
NULL
)

70 #i‡
ADAPTIVE_QP_SELECTION


71 ,
	$m_pP¨ítARLBuf„r
(
NULL
)

73 {
	}
}

76 
	gTComPicSym
::~
	$TComPicSym
()

78 
	`de°roy
();

79 
	}
}

82 #i‡
REDUCED_ENCODER_MEMORY


83 
Void
 
	gTComPicSym
::
	$¸óã
 ( c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxDïth
, c⁄° 
Boﬁ
 
bAŒoˇãCtuAºay
 )

85 
Void
 
TComPicSym
::
	$¸óã
 ( c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxDïth
 )

88 
	`de°roy
();

90 
m_•s
 = 
•s
;

91 
m_µs
 = 
µs
;

93 #i‡!
REDUCED_ENCODER_MEMORY


94 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
 = 
•s
.
	`gëChromaF‹m©Idc
();

96 c⁄° 
I¡
 
iPicWidth
 = 
•s
.
	`gëPicWidthInLumaSam∂es
();

97 c⁄° 
I¡
 
iPicHeight
 = 
•s
.
	`gëPicHeightInLumaSam∂es
();

98 c⁄° 
UI¡
 
uiMaxCuWidth
 = 
•s
.
	`gëMaxCUWidth
();

99 c⁄° 
UI¡
 
uiMaxCuHeight
 = 
•s
.
	`gëMaxCUHeight
();

101 
m_uhTŸÆDïth
 = 
uiMaxDïth
;

102 
m_numP¨tôi⁄sInCtu
 = 1<<(
m_uhTŸÆDïth
<<1);

104 
m_uiMöCUWidth
 = 
uiMaxCuWidth
 >> 
m_uhTŸÆDïth
;

105 
m_uiMöCUHeight
 = 
uiMaxCuHeight
 >> 
m_uhTŸÆDïth
;

107 
m_numP¨tInCtuWidth
 = 
uiMaxCuWidth
 / 
m_uiMöCUWidth
;

108 
m_numP¨tInCtuHeight
 = 
uiMaxCuHeight
 / 
m_uiMöCUHeight
;

110 
m_‰ameWidthInCtus
 = ( 
iPicWidth
 %
uiMaxCuWidth
 ) ? iPicWidth /uiMaxCuWidth + 1 : iPicWidth /uiMaxCuWidth;

111 
m_‰ameHeightInCtus
 = ( 
iPicHeight
%
uiMaxCuHeight
 ) ? iPicHeight/uiMaxCuHeight + 1 : iPicHeight/uiMaxCuHeight;

113 
m_numCtusInFøme
 = 
m_‰ameWidthInCtus
 * 
m_‰ameHeightInCtus
;

114 #i‡
REDUCED_ENCODER_MEMORY


115 
m_pi˘uªCtuAºay
 = 
NULL
;

117 
m_pi˘uªCtuAºay
 = 
√w
 
TComD©aCU
*[
m_numCtusInFøme
];

120 
	`˛órSli˚Buf„r
();

121 
	`ÆloˇãNewSli˚
();

123 #i‡
ADAPTIVE_QP_SELECTION


124 i‡(
m_pP¨ítARLBuf„r
 =
NULL
)

126 
m_pP¨ítARLBuf„r
 = 
√w
 
TC€ff
[
uiMaxCuWidth
*
uiMaxCuHeight
*
MAX_NUM_COMPONENT
];

130 #i‡
REDUCED_ENCODER_MEMORY


131 i‡(
bAŒoˇãCtuAºay
)

133 
	`¥ï¨eF‹Rec⁄°ru˘i⁄
();

136 
UI¡
 
i
=0; i<
m_numCtusInFøme
 ; i++ )

138 
m_pi˘uªCtuAºay
[
i
] = 
√w
 
TComD©aCU
;

139 
m_pi˘uªCtuAºay
[
i
]->
	`¸óã
–
chromaF‹m©IDC
, 
m_numP¨tôi⁄sInCtu
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
Ál£
, uiMaxCuWidth >> 
m_uhTŸÆDïth


140 #i‡
ADAPTIVE_QP_SELECTION


141 , 
m_pP¨ítARLBuf„r


147 
m_˘uTsToRsAddrM≠
 = 
√w
 
UI¡
[
m_numCtusInFøme
+1];

148 
m_puiTûeIdxM≠
 = 
√w
 
UI¡
[
m_numCtusInFøme
];

149 
m_˘uRsToTsAddrM≠
 = 
√w
 
UI¡
[
m_numCtusInFøme
+1];

151 
UI¡
 
i
=0; i<
m_numCtusInFøme
; i++ )

153 
m_˘uTsToRsAddrM≠
[
i
] = i;

154 
m_˘uRsToTsAddrM≠
[
i
] = i;

157 
m_ßoBlkP¨ams
 = 
√w
 
SAOBlkP¨am
[
m_numCtusInFøme
];

160 
	`xInôTûes
();

161 
	`xInôCtuTsRsAddrM≠s
();

163 
	}
}

165 #i‡
REDUCED_ENCODER_MEMORY


166 
Void
 
	gTComPicSym
::
	$¥ï¨eF‹Rec⁄°ru˘i⁄
()

168 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
 = 
m_•s
.
	`gëChromaF‹m©Idc
();

169 c⁄° 
UI¡
 
uiMaxCuWidth
 = 
m_•s
.
	`gëMaxCUWidth
();

170 c⁄° 
UI¡
 
uiMaxCuHeight
 = 
m_•s
.
	`gëMaxCUHeight
();

171 i‡(
m_pi˘uªCtuAºay
 =
NULL
)

173 
m_pi˘uªCtuAºay
 = 
√w
 
TComD©aCU
*[
m_numCtusInFøme
];

175 
UI¡
 
i
=0; i<
m_numCtusInFøme
 ; i++ )

177 
m_pi˘uªCtuAºay
[
i
] = 
√w
 
TComD©aCU
;

178 
m_pi˘uªCtuAºay
[
i
]->
	`¸óã
–
chromaF‹m©IDC
, 
m_numP¨tôi⁄sInCtu
, 
uiMaxCuWidth
, 
uiMaxCuHeight
, 
Ál£
, uiMaxCuWidth >> 
m_uhTŸÆDïth


179 #i‡
ADAPTIVE_QP_SELECTION


180 , 
m_pP¨ítARLBuf„r


185 i‡(
m_dpbPîCtuD©a
 =
NULL
)

187 
m_dpbPîCtuD©a
 = 
√w
 
DPBPîCtuD©a
[
m_numCtusInFøme
];

188 
UI¡
 
i
=0; i<
m_numCtusInFøme
; i++)

190 
I¡
 
j
=0; j<
NUM_REF_PIC_LIST_01
; j++)

192 
m_dpbPîCtuD©a
[
i
].
m_CUMvFõld
[
j
].
	`¸óã
–
m_numP¨tôi⁄sInCtu
 );

194 
m_dpbPîCtuD©a
[
i
].
m_≥PªdMode
 = 
√w
 
SCh¨
[
m_numP¨tôi⁄sInCtu
];

195 
	`mem£t
(
m_dpbPîCtuD©a
[
i
].
m_≥PªdMode
, 
NUMBER_OF_PREDICTION_MODES
, 
m_numP¨tôi⁄sInCtu
);

196 
m_dpbPîCtuD©a
[
i
].
m_≥P¨tSize
 = 
√w
 
SCh¨
[
m_numP¨tôi⁄sInCtu
];

197 
	`mem£t
(
m_dpbPîCtuD©a
[
i
].
m_≥P¨tSize
, 
NUMBER_OF_PART_SIZES
, 
m_numP¨tôi⁄sInCtu
);

198 
m_dpbPîCtuD©a
[
i
].
m_pSli˚
=
NULL
;

201 
	}
}

203 
Void
 
	gTComPicSym
::
	$ªÀa£Rec⁄°ru˘i⁄I¡îmedüãD©a
()

205 i‡(
m_pi˘uªCtuAºay
)

207 
I¡
 
i
 = 0; i < 
m_numCtusInFøme
; i++)

209 i‡(
m_pi˘uªCtuAºay
[
i
])

211 
m_pi˘uªCtuAºay
[
i
]->
	`de°roy
();

212 
dñëe
 
m_pi˘uªCtuAºay
[
i
];

213 
m_pi˘uªCtuAºay
[
i
] = 
NULL
;

216 
dñëe
 [] 
m_pi˘uªCtuAºay
;

217 
m_pi˘uªCtuAºay
 = 
NULL
;

219 
	}
}

221 
Void
 
	gTComPicSym
::
	$ªÀa£AŒRec⁄°ru˘i⁄D©a
()

223 
	`ªÀa£Rec⁄°ru˘i⁄I¡îmedüãD©a
();

225 i‡(
m_dpbPîCtuD©a
 !
NULL
)

227 
UI¡
 
i
=0; i<
m_numCtusInFøme
; i++)

229 
I¡
 
j
=0; j<
NUM_REF_PIC_LIST_01
; j++)

231 
m_dpbPîCtuD©a
[
i
].
m_CUMvFõld
[
j
].
	`de°roy
();

233 
dñëe
 [] 
m_dpbPîCtuD©a
[
i
].
m_≥PªdMode
;

234 
dñëe
 [] 
m_dpbPîCtuD©a
[
i
].
m_≥P¨tSize
;

236 
dñëe
 [] 
m_dpbPîCtuD©a
;

237 
m_dpbPîCtuD©a
=
NULL
;

239 
	}
}

242 
Void
 
	gTComPicSym
::
	$de°roy
()

244 
	`˛órSli˚Buf„r
();

246 #i‡
REDUCED_ENCODER_MEMORY


247 
	`ªÀa£AŒRec⁄°ru˘i⁄D©a
();

249 i‡(
m_pi˘uªCtuAºay
)

251 
I¡
 
i
 = 0; i < 
m_numCtusInFøme
; i++)

253 i‡(
m_pi˘uªCtuAºay
[
i
])

255 
m_pi˘uªCtuAºay
[
i
]->
	`de°roy
();

256 
dñëe
 
m_pi˘uªCtuAºay
[
i
];

257 
m_pi˘uªCtuAºay
[
i
] = 
NULL
;

260 
dñëe
 [] 
m_pi˘uªCtuAºay
;

261 
m_pi˘uªCtuAºay
 = 
NULL
;

265 
dñëe
 [] 
m_˘uTsToRsAddrM≠
;

266 
m_˘uTsToRsAddrM≠
 = 
NULL
;

268 
dñëe
 [] 
m_puiTûeIdxM≠
;

269 
m_puiTûeIdxM≠
 = 
NULL
;

271 
dñëe
 [] 
m_˘uRsToTsAddrM≠
;

272 
m_˘uRsToTsAddrM≠
 = 
NULL
;

274 if(
m_ßoBlkP¨ams
)

276 
dñëe
[] 
m_ßoBlkP¨ams
; m_ßoBlkP¨am†
NULL
;

279 #i‡
ADAPTIVE_QP_SELECTION


280 
dñëe
 [] 
m_pP¨ítARLBuf„r
;

281 
m_pP¨ítARLBuf„r
 = 
NULL
;

283 
	}
}

285 
Void
 
	gTComPicSym
::
	$ÆloˇãNewSli˚
()

287 
m_≠Sli˚s
.
	`push_back
(
√w
 
TComSli˚
);

288 
m_≠Sli˚s
.
	`back
()->
	`£tPPS
(&
m_µs
);

289 
m_≠Sli˚s
.
	`back
()->
	`£tSPS
(&
m_•s
);

290 i‡(
m_≠Sli˚s
.
	`size
()>=2)

292 
m_≠Sli˚s
.
	`back
()->
	`c›ySli˚Info
–m_≠Sli˚s[m_≠Sli˚s.
	`size
()-2] );

293 
m_≠Sli˚s
.
	`back
()->
	`öôSli˚
();

295 
	}
}

297 
Void
 
	gTComPicSym
::
	$˛órSli˚Buf„r
()

299 
UI¡
 
i
 = 0; i < 
	`UI¡
(
m_≠Sli˚s
.
	`size
()); i++)

301 
dñëe
 
m_≠Sli˚s
[
i
];

303 
m_≠Sli˚s
.
	`˛ór
();

304 
	}
}

306 
Void
 
	gTComPicSym
::
	$xInôCtuTsRsAddrM≠s
()

309 
I¡
 
˘uTsAddr
=0, 
˘uRsAddr
=0; ctuTsAddr<
	`gëNumbîOfCtusInFøme
(); ctuTsAddr++, ctuRsAdd∏
	`xCÆcuœãNextCtuRSAddr
(ctuRsAddr))

311 
	`£tCtuTsToRsAddrM≠
(
˘uTsAddr
, 
˘uRsAddr
);

312 
	`£tCtuRsToTsAddrM≠
(
˘uRsAddr
, 
˘uTsAddr
);

314 
	`£tCtuTsToRsAddrM≠
(
	`gëNumbîOfCtusInFøme
(), getNumberOfCtusInFrame());

315 
	`£tCtuRsToTsAddrM≠
(
	`gëNumbîOfCtusInFøme
(), getNumberOfCtusInFrame());

316 
	}
}

318 
Void
 
	gTComPicSym
::
	$xInôTûes
()

321 
	`£tNumTûeCﬁumnsMöus1
–
m_µs
.
	`gëNumTûeCﬁumnsMöus1
() );

322 
	`£tNumTûeRowsMöus1
–
m_µs
.
	`gëNumTûeRowsMöus1
() );

324 c⁄° 
I¡
 
numCﬁs
 = 
m_µs
.
	`gëNumTûeCﬁumnsMöus1
() + 1;

325 c⁄° 
I¡
 
numRows
 = 
m_µs
.
	`gëNumTûeRowsMöus1
() + 1;

326 c⁄° 
I¡
 
numTûes
 = 
numRows
 * 
numCﬁs
;

329 
m_tûeP¨amëîs
.
	`ªsize
(
numTûes
);

331 if–
m_µs
.
	`gëTûeUnif‹mS∑cögFœg
() )

334 
I¡
 
row
=0;Ñow < 
numRows
;Ñow++)

336 
I¡
 
cﬁ
=0; cﬁ < 
numCﬁs
; col++)

338 c⁄° 
I¡
 
tûeIdx
 = 
row
 * 
numCﬁs
 + 
cﬁ
;

339 
m_tûeP¨amëîs
[
tûeIdx
].
	`£tTûeWidthInCtus
–(
cﬁ
+1)*
	`gëFømeWidthInCtus
–)/
numCﬁs
 - (col*getFrameWidthInCtus( ))/numCols );

340 
m_tûeP¨amëîs
[
tûeIdx
].
	`£tTûeHeightInCtus
–(
row
+1)*
	`gëFømeHeightInCtus
()/
numRows
 - (row*getFrameHeightInCtus())/numRows );

347 
I¡
 
row
=0;Ñow < 
numRows
;Ñow++)

349 
I¡
 
cumuœtiveTûeWidth
 = 0;

350 
I¡
 
cﬁ
=0; cﬁ < 
	`gëNumTûeCﬁumnsMöus1
(); col++)

352 
m_tûeP¨amëîs
[
row
 * 
numCﬁs
 + 
cﬁ
].
	`£tTûeWidthInCtus
–
m_µs
.
	`gëTûeCﬁumnWidth
(col) );

353 
cumuœtiveTûeWidth
 +
m_µs
.
	`gëTûeCﬁumnWidth
(
cﬁ
);

355 
m_tûeP¨amëîs
[
row
 * 
numCﬁs
 + 
	`gëNumTûeCﬁumnsMöus1
()].
	`£tTûeWidthInCtus
–
	`gëFømeWidthInCtus
()-
cumuœtiveTûeWidth
 );

359 
I¡
 
cﬁ
=0; cﬁ < 
numCﬁs
; col++)

361 
I¡
 
cumuœtiveTûeHeight
 = 0;

362 
I¡
 
row
=0;Ñow < 
	`gëNumTûeRowsMöus1
();Ñow++)

364 
m_tûeP¨amëîs
[
row
 * 
numCﬁs
 + 
cﬁ
].
	`£tTûeHeightInCtus
–
m_µs
.
	`gëTûeRowHeight
(row) );

365 
cumuœtiveTûeHeight
 +
m_µs
.
	`gëTûeRowHeight
(
row
);

367 
m_tûeP¨amëîs
[
	`gëNumTûeRowsMöus1
(Ë* 
numCﬁs
 + 
cﬁ
].
	`£tTûeHeightInCtus
–
	`gëFømeHeightInCtus
()-
cumuœtiveTûeHeight
 );

372 
I¡
 
möWidth
 = 1;

373 
I¡
 
möHeight
 = 1;

374 c⁄° 
I¡
 
¥ofûeIdc
 = 
m_•s
.
	`gëPTL
()->
	`gëGíîÆPTL
()->
	`gëProfûeIdc
();

375 i‡–
¥ofûeIdc
 =
Profûe
::
MAIN
 ||ÖrofûeId¯=Profûe::
MAIN10
)

377 i‡(
m_µs
.
	`gëTûesE«bÀdFœg
())

379 
möHeight
 = 64 / 
m_•s
.
	`gëMaxCUHeight
();

380 
möWidth
 = 256 / 
m_•s
.
	`gëMaxCUWidth
();

383 
I¡
 
row
=0;Ñow < 
numRows
;Ñow++)

385 
I¡
 
cﬁ
=0; cﬁ < 
numCﬁs
; col++)

387 c⁄° 
I¡
 
tûeIdx
 = 
row
 * 
numCﬁs
 + 
cﬁ
;

388 
	`as£π
 (
m_tûeP¨amëîs
[
tûeIdx
].
	`gëTûeWidthInCtus
(Ë>
möWidth
);

389 
	`as£π
 (
m_tûeP¨amëîs
[
tûeIdx
].
	`gëTûeHeightInCtus
(Ë>
möHeight
);

394  
I¡
 
row
=0;Ñow < 
numRows
;Ñow++ )

396  
I¡
 
cﬁ
=0; cﬁ < 
numCﬁs
; col++ )

398 c⁄° 
I¡
 
tûeIdx
 = 
row
 * 
numCﬁs
 + 
cﬁ
;

401 
I¡
 
rightEdgePosInCTU
 = 0;

402  
I¡
 
i
=0; i <
cﬁ
; i++ )

404 
rightEdgePosInCTU
 +
m_tûeP¨amëîs
[
row
 * 
numCﬁs
 + 
i
].
	`gëTûeWidthInCtus
();

406 
m_tûeP¨amëîs
[
tûeIdx
].
	`£tRightEdgePosInCtus
(
rightEdgePosInCTU
-1);

409 
I¡
 
bŸtomEdgePosInCTU
 = 0;

410  
I¡
 
i
=0; i <
row
; i++ )

412 
bŸtomEdgePosInCTU
 +
m_tûeP¨amëîs
[
i
 * 
numCﬁs
 + 
cﬁ
].
	`gëTûeHeightInCtus
();

414 
m_tûeP¨amëîs
[
tûeIdx
].
	`£tBŸtomEdgePosInCtus
(
bŸtomEdgePosInCTU
-1);

417 
m_tûeP¨amëîs
[
tûeIdx
].
	`£tFú°CtuRsAddr
–(m_tûeP¨amëîs[tûeIdx].
	`gëBŸtomEdgePosInCtus
(Ë- m_tûeP¨amëîs[tûeIdx].
	`gëTûeHeightInCtus
(Ë+ 1Ë* 
	`gëFømeWidthInCtus
() +

418 
m_tûeP¨amëîs
[
tûeIdx
].
	`gëRightEdgePosInCtus
(Ë- m_tûeP¨amëîs[tûeIdx].
	`gëTûeWidthInCtus
() + 1);

422 
I¡
 
cﬁumnIdx
 = 0;

423 
I¡
 
rowIdx
 = 0;

426  
I¡
 
i
=0; i<
m_numCtusInFøme
; i++)

428  
I¡
 
cﬁ
=0; cﬁ < 
numCﬁs
; col++)

430 if(
i
 % 
	`gëFømeWidthInCtus
(Ë<
m_tûeP¨amëîs
[
cﬁ
].
	`gëRightEdgePosInCtus
())

432 
cﬁumnIdx
 = 
cﬁ
;

436 
I¡
 
row
=0;Ñow < 
numRows
;Ñow++)

438 if(
i
 / 
	`gëFømeWidthInCtus
(Ë<
m_tûeP¨amëîs
[
row
*
numCﬁs
].
	`gëBŸtomEdgePosInCtus
())

440 
rowIdx
 = 
row
;

444 
m_puiTûeIdxM≠
[
i
] = 
rowIdx
 * 
numCﬁs
 + 
cﬁumnIdx
;

446 
	}
}

447 
UI¡
 
	gTComPicSym
::
	$xCÆcuœãNextCtuRSAddr
–
UI¡
 
cuºCtuRsAddr
 )

449 
UI¡
 
√xtCtuRsAddr
;

452 c⁄° 
UI¡
 
uiTûeIdx
 = 
	`gëTûeIdxM≠
(
cuºCtuRsAddr
);

455 if–
cuºCtuRsAddr
 % 
m_‰ameWidthInCtus
 =
	`gëTComTûe
(
uiTûeIdx
)->
	`gëRightEdgePosInCtus
(Ë&& cuºCtuRsAdd∏/ m_‰ameWidthInCtu†=gëTComTûe(uiTûeIdx)->
	`gëBŸtomEdgePosInCtus
() )

458 if(
uiTûeIdx
+1 =
	`gëNumTûes
())

460 
√xtCtuRsAddr
 = 
m_numCtusInFøme
;

464 
√xtCtuRsAddr
 = 
	`gëTComTûe
(
uiTûeIdx
+1)->
	`gëFú°CtuRsAddr
();

469 if–
cuºCtuRsAddr
 % 
m_‰ameWidthInCtus
 =
	`gëTComTûe
(
uiTûeIdx
)->
	`gëRightEdgePosInCtus
() )

471 
√xtCtuRsAddr
 = 
cuºCtuRsAddr
 + 
m_‰ameWidthInCtus
 - 
	`gëTComTûe
(
uiTûeIdx
)->
	`gëTûeWidthInCtus
() + 1;

475 
√xtCtuRsAddr
 = 
cuºCtuRsAddr
 + 1;

479  
√xtCtuRsAddr
;

480 
	}
}

482 
Void
 
	gTComPicSym
::
	$dîiveLo›FûãrBound¨yAvaûibûôy
(
I¡
 
˘uRsAddr
,

483 
Boﬁ
& 
isLe·Avaû
,

484 
Boﬁ
& 
isRightAvaû
,

485 
Boﬁ
& 
isAboveAvaû
,

486 
Boﬁ
& 
isBñowAvaû
,

487 
Boﬁ
& 
isAboveLe·Avaû
,

488 
Boﬁ
& 
isAboveRightAvaû
,

489 
Boﬁ
& 
isBñowLe·Avaû
,

490 
Boﬁ
& 
isBñowRightAvaû


494 
isLe·Avaû
 = (
˘uRsAddr
 % 
m_‰ameWidthInCtus
 != 0);

495 
isRightAvaû
 = (
˘uRsAddr
 % 
m_‰ameWidthInCtus
 != m_frameWidthInCtus-1);

496 
isAboveAvaû
 = (
˘uRsAddr
 >
m_‰ameWidthInCtus
 );

497 
isBñowAvaû
 = (
˘uRsAddr
 < 
m_numCtusInFøme
 - 
m_‰ameWidthInCtus
);

498 
isAboveLe·Avaû
 = (
isAboveAvaû
 && 
isLe·Avaû
);

499 
isAboveRightAvaû
(
isAboveAvaû
 && 
isRightAvaû
);

500 
isBñowLe·Avaû
 = (
isBñowAvaû
 && 
isLe·Avaû
);

501 
isBñowRightAvaû
(
isBñowAvaû
 && 
isRightAvaû
);

503 
Boﬁ
 
isLo›FûtA¸ossTûePPS
 = 
	`gëCtu
(
˘uRsAddr
)->
	`gëSli˚
()->
	`gëPPS
()->
	`gëLo›FûãrA¸ossTûesE«bÀdFœg
();

506 
TComD©aCU
* 
˘uCuº
 = 
	`gëCtu
(
˘uRsAddr
);

507 
TComD©aCU
* 
˘uLe·
 = 
isLe·Avaû
 ?
	`gëCtu
(
˘uRsAddr
-1):
NULL
;

508 
TComD©aCU
* 
˘uRight
 = 
isRightAvaû
?
	`gëCtu
(
˘uRsAddr
+1):
NULL
;

509 
TComD©aCU
* 
˘uAbove
 = 
isAboveAvaû
?
	`gëCtu
(
˘uRsAddr
-
m_‰ameWidthInCtus
):
NULL
;

510 
TComD©aCU
* 
˘uBñow
 = 
isBñowAvaû
?
	`gëCtu
(
˘uRsAddr
+
m_‰ameWidthInCtus
):
NULL
;

511 
TComD©aCU
* 
˘uAboveLe·
 = 
isAboveLe·Avaû
 ? 
	`gëCtu
(
˘uRsAddr
-
m_‰ameWidthInCtus
-1):
NULL
;

512 
TComD©aCU
* 
˘uAboveRight
 = 
isAboveRightAvaû
? 
	`gëCtu
(
˘uRsAddr
-
m_‰ameWidthInCtus
+1):
NULL
;

513 
TComD©aCU
* 
˘uBñowLe·
 = 
isBñowLe·Avaû
 ? 
	`gëCtu
(
˘uRsAddr
+
m_‰ameWidthInCtus
-1):
NULL
;

514 
TComD©aCU
* 
˘uBñowRight
 = 
isBñowRightAvaû
? 
	`gëCtu
(
˘uRsAddr
+
m_‰ameWidthInCtus
+1):
NULL
;

518 if(
˘uLe·
 !
NULL
)

520 
isLe·Avaû
 = (
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
(Ë!
˘uLe·
->gëSli˚()->gëSli˚CurSèπCtuTsAddr())?˘uCuº->gëSli˚()->
	`gëLFCrossSli˚Bound¨yFœg
():
åue
;

523 if(
˘uAbove
 !
NULL
)

525 
isAboveAvaû
 = (
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
(Ë!
˘uAbove
->gëSli˚()->gëSli˚CurSèπCtuTsAddr())?˘uCuº->gëSli˚()->
	`gëLFCrossSli˚Bound¨yFœg
():
åue
;

528 if(
˘uRight
 !
NULL
)

530 
isRightAvaû
 = (
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
(Ë!
˘uRight
->gëSli˚()->gëSli˚CurSèπCtuTsAddr())?˘uRight->gëSli˚()->
	`gëLFCrossSli˚Bound¨yFœg
():
åue
;

533 if(
˘uBñow
 !
NULL
)

535 
isBñowAvaû
 = (
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
(Ë!
˘uBñow
->gëSli˚()->gëSli˚CurSèπCtuTsAddr())?˘uBñow->gëSli˚()->
	`gëLFCrossSli˚Bound¨yFœg
():
åue
;

538 if(
˘uAboveLe·
 !
NULL
)

540 
isAboveLe·Avaû
 = (
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
(Ë!
˘uAboveLe·
->gëSli˚()->gëSli˚CurSèπCtuTsAddr())?˘uCuº->gëSli˚()->
	`gëLFCrossSli˚Bound¨yFœg
():
åue
;

543 if(
˘uBñowRight
 !
NULL
)

545 
isBñowRightAvaû
 = (
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
(Ë!
˘uBñowRight
->gëSli˚()->gëSli˚CurSèπCtuTsAddr())?˘uBñowRight->gëSli˚()->
	`gëLFCrossSli˚Bound¨yFœg
():
åue
;

549 if(
˘uAboveRight
 !
NULL
)

551 
I¡
 
curSli˚SèπTsAddr
 = 
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
();

552 
I¡
 
aboveRightSli˚SèπTsAddr
 = 
˘uAboveRight
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
();

554 
isAboveRightAvaû
 = (
curSli˚SèπTsAddr
 =
aboveRightSli˚SèπTsAddr
)?(
åue
):

556 (
curSli˚SèπTsAddr
 > 
aboveRightSli˚SèπTsAddr
)?(
˘uCuº
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
())

557 :(
˘uAboveRight
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
())

561 if(
˘uBñowLe·
 !
NULL
)

563 
I¡
 
curSli˚SèπTsAddr
 = 
˘uCuº
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
();

564 
I¡
 
bñowLe·Sli˚SèπTsAddr
 = 
˘uBñowLe·
->
	`gëSli˚
()->
	`gëSli˚CurSèπCtuTsAddr
();

566 
isBñowLe·Avaû
 = (
curSli˚SèπTsAddr
 =
bñowLe·Sli˚SèπTsAddr
)?(
åue
):

568 (
curSli˚SèπTsAddr
 > 
bñowLe·Sli˚SèπTsAddr
)?(
˘uCuº
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
())

569 :(
˘uBñowLe·
->
	`gëSli˚
()->
	`gëLFCrossSli˚Bound¨yFœg
())

574 if(!
isLo›FûtA¸ossTûePPS
)

576 
isLe·Avaû
 = (!isLe·Avaû ) ?
Ál£
:(
	`gëTûeIdxM≠
–
˘uLe·
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

577 
isAboveAvaû
 = (!isAboveAvaû ) ?
Ál£
:(
	`gëTûeIdxM≠
–
˘uAbove
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

578 
isRightAvaû
 = (!isRightAvaû ) ?
Ál£
:(
	`gëTûeIdxM≠
–
˘uRight
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

579 
isBñowAvaû
 = (!isBñowAvaû ) ?
Ál£
:(
	`gëTûeIdxM≠
–
˘uBñow
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

580 
isAboveLe·Avaû
 = (!isAboveLe·Avaû ) ?
Ál£
:(
	`gëTûeIdxM≠
–
˘uAboveLe·
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

581 
isAboveRightAvaû
(!isAboveRightAvaûË?
Ál£
:(
	`gëTûeIdxM≠
–
˘uAboveRight
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

582 
isBñowLe·Avaû
 = (!isBñowLe·Avaû ) ?
Ál£
:(
	`gëTûeIdxM≠
–
˘uBñowLe·
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

583 
isBñowRightAvaû
(!isBñowRightAvaûË?
Ál£
:(
	`gëTûeIdxM≠
–
˘uBñowRight
->
	`gëCtuRsAddr
(ËË=gëTûeIdxM≠–
˘uRsAddr
 ));

587 
	}
}

590 
	gTComTûe
::
	$TComTûe
()

591 : 
	`m_tûeWidthInCtus
 (0)

592 , 
	`m_tûeHeightInCtus
 (0)

593 , 
	`m_rightEdgePosInCtus
 (0)

594 , 
	`m_bŸtomEdgePosInCtus
 (0)

595 , 
	$m_fú°CtuRsAddr
 (0)

597 
	}
}

599 
	gTComTûe
::~
	$TComTûe
()

601 
	}
}

603 #i‡
MCTS_ENC_CHECK


605 
Void
 
	$gëTûePosôi⁄
(c⁄° 
TComD©aCU
* c⁄° 
pcCU
, 
UI¡
 &
tûeXPosInCtus
, UI¡ &
tûeYPosInCtus
, UI¡ &
tûeWidthtInCtus
, UI¡ &
tûeHeightInCtus
)

607 c⁄° 
UI¡
 
cuºítTûeIdx
 = 
pcCU
->
	`gëPic
()->
	`gëPicSym
()->
	`gëTûeIdxM≠
’cCU->
	`gëCtuRsAddr
());

608 c⁄° 
TComTûe
 *
pCuºítTûe
 = 
pcCU
->
	`gëPic
()->
	`gëPicSym
()->
	`gëTComTûe
(
cuºítTûeIdx
);

609 c⁄° 
UI¡
 
‰ameWidthInCtus
 = 
pcCU
->
	`gëPic
()->
	`gëPicSym
()->
	`gëFømeWidthInCtus
();

610 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
pcCU
->
	`gëPic
()->
	`gëPicSym
()->
	`gëTComTûe
’cCU->gëPic()->gëPicSym()->
	`gëTûeIdxM≠
’cCU->
	`gëCtuRsAddr
()))->
	`gëFú°CtuRsAddr
();

612 
tûeXPosInCtus
 = 
fú°CtuRsAddrOfTûe
 % 
‰ameWidthInCtus
;

613 
tûeYPosInCtus
 = 
fú°CtuRsAddrOfTûe
 / 
‰ameWidthInCtus
;

614 
tûeWidthtInCtus
 = 
pCuºítTûe
->
	`gëTûeWidthInCtus
();

615 
tûeHeightInCtus
 = 
pCuºítTûe
->
	`gëTûeHeightInCtus
();

616 
	}
}

	@TLibCommon/TComPicSym.h

38 #i‚de‡
__TCOMPICSYM__


39 
	#__TCOMPICSYM__


	)

43 
	~<deque
>

44 
	~"Comm⁄Def.h
"

45 
	~"TComSli˚.h
"

46 
	~"TComD©aCU.h
"

47 
˛ass
 
	gTComSam∂eAd≠tiveOff£t
;

48 
˛ass
 
	gTComPPS
;

57 ˛as†
	cTComTûe


59 
	m¥iv©e
:

60 
UI¡
 
m_tûeWidthInCtus
;

61 
UI¡
 
	mm_tûeHeightInCtus
;

62 
UI¡
 
	mm_rightEdgePosInCtus
;

63 
UI¡
 
	mm_bŸtomEdgePosInCtus
;

64 
UI¡
 
	mm_fú°CtuRsAddr
;

66 
	mpublic
:

67 
TComTûe
();

68 
	mvútuÆ
 ~
TComTûe
();

70 
Void
 
	$£tTûeWidthInCtus
 ( 
UI¡
 
i
 ) { 
m_tûeWidthInCtus
 = i; }

71 
UI¡
 
	$gëTûeWidthInCtus
 (Ëc⁄° {  
m_tûeWidthInCtus
; 
	}
}

72 
Void
 
	$£tTûeHeightInCtus
 ( 
UI¡
 
i
 ) { 
m_tûeHeightInCtus
 = i; 
	}
}

73 
UI¡
 
	$gëTûeHeightInCtus
 (Ëc⁄° {  
m_tûeHeightInCtus
; 
	}
}

74 
Void
 
	$£tRightEdgePosInCtus
 ( 
UI¡
 
i
 ) { 
m_rightEdgePosInCtus
 = i; 
	}
}

75 
UI¡
 
	$gëRightEdgePosInCtus
 (Ëc⁄° {  
m_rightEdgePosInCtus
; 
	}
}

76 
Void
 
	$£tBŸtomEdgePosInCtus
 ( 
UI¡
 
i
 ) { 
m_bŸtomEdgePosInCtus
 = i; 
	}
}

77 
UI¡
 
	$gëBŸtomEdgePosInCtus
 (Ëc⁄° {  
m_bŸtomEdgePosInCtus
; 
	}
}

78 
Void
 
	$£tFú°CtuRsAddr
 ( 
UI¡
 
i
 ) { 
m_fú°CtuRsAddr
 = i; 
	}
}

79 
UI¡
 
	$gëFú°CtuRsAddr
 (Ëc⁄° {  
m_fú°CtuRsAddr
; 
	}
}

83 ˛as†
	cTComPicSym


85 
	m¥iv©e
:

86 
UI¡
 
m_‰ameWidthInCtus
;

87 
UI¡
 
	mm_‰ameHeightInCtus
;

89 
UI¡
 
	mm_uiMöCUWidth
;

90 
UI¡
 
	mm_uiMöCUHeight
;

92 
UCh¨
 
	mm_uhTŸÆDïth
;

93 
UI¡
 
	mm_numP¨tôi⁄sInCtu
;

94 
UI¡
 
	mm_numP¨tInCtuWidth
;

95 
UI¡
 
	mm_numP¨tInCtuHeight
;

96 
UI¡
 
	mm_numCtusInFøme
;

98 
	m°d
::
deque
<
TComSli˚
*> 
m_≠Sli˚s
;

99 
TComD©aCU
** 
	mm_pi˘uªCtuAºay
;

101 
I¡
 
	mm_numTûeCﬁumnsMöus1
;

102 
I¡
 
	mm_numTûeRowsMöus1
;

103 
	m°d
::
ve˘‹
<
TComTûe
> 
m_tûeP¨amëîs
;

104 
UI¡
* 
	mm_˘uTsToRsAddrM≠
;

105 
UI¡
* 
	mm_puiTûeIdxM≠
;

106 
UI¡
* 
	mm_˘uRsToTsAddrM≠
;

108 #i‡
REDUCED_ENCODER_MEMORY


109 
	mpublic
:

110 #i‡
MCTS_EXTRACTION


111 
‰õnd
 
˛ass
 
M˘sExåa˘‹TComPicSym
;

113 
	sDPBPîCtuD©a


115 
Boﬁ
 
isI¡î
(c⁄° 
UI¡
 
absP¨tAddr
Ëc⁄° {  
	mm_≥PªdMode
[absP¨tAddr] =
MODE_INTER
; }

116 
P¨tSize
 
gëP¨tôi⁄Size
–c⁄° 
UI¡
 
absP¨tAddr
 ) c⁄° {  
	m°©ic_ˇ°
<
	mP¨tSize
>–
	mm_≥P¨tSize
[absPartAddr] ); }

117 c⁄° 
TComCUMvFõld
* 
gëCUMvFõld
 ( 
RefPicLi°
 
e
 ) c⁄° {  &
	mm_CUMvFõld
[e]; }

118 c⁄° 
TComSli˚
* 
gëSli˚
(Ëc⁄° {  
	mm_pSli˚
; }

120 
SCh¨
 * 
	mm_≥PªdMode
;

121 
SCh¨
 * 
	mm_≥P¨tSize
;

122 
TComCUMvFõld
 
	mm_CUMvFõld
[
NUM_REF_PIC_LIST_01
];

123 
TComSli˚
 * 
	mm_pSli˚
;

126 
	g¥iv©e
:

127 
DPBPîCtuD©a
 *
m_dpbPîCtuD©a
;

129 
SAOBlkP¨am
 *
	gm_ßoBlkP¨ams
;

130 #i‡
ADAPTIVE_QP_SELECTION


131 
TC€ff
* 
	gm_pP¨ítARLBuf„r
;

133 
TComSPS
 
	gm_•s
;

134 
TComPPS
 
	gm_µs
;

136 
Void
 
xInôTûes
( );

137 
Void
 
xInôCtuTsRsAddrM≠s
();

138 
Void
 
	$£tNumTûeCﬁumnsMöus1
–
I¡
 
i
 ) { 
m_numTûeCﬁumnsMöus1
 = i; 
	}
}

139 
Void
 
	$£tNumTûeRowsMöus1
–
I¡
 
i
 ) { 
m_numTûeRowsMöus1
 = i; 
	}
}

140 
Void
 
	$£tCtuTsToRsAddrM≠
–
I¡
 
˘uTsAddr
, I¡ 
˘uRsAddr
 ) { *(
m_˘uTsToRsAddrM≠
 + ctuTsAddrË˘uRsAddr; 
	}
}

141 
Void
 
	$£tCtuRsToTsAddrM≠
–
I¡
 
˘uRsAddr
, I¡ 
˘uTsOrdî
 ) { *(
m_˘uRsToTsAddrM≠
 + ctuRsAddrË˘uTsOrdî; 
	}
}

143 
	gpublic
:

144 #i‡
REDUCED_ENCODER_MEMORY


145 
Void
 
¸óã
 ( c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxDïth
, c⁄° 
Boﬁ
 
bAŒoˇãCtuAºay
 );

146 
Void
 
¥ï¨eF‹Rec⁄°ru˘i⁄
();

147 
Void
 
ªÀa£Rec⁄°ru˘i⁄I¡îmedüãD©a
();

148 
Void
 
ªÀa£AŒRec⁄°ru˘i⁄D©a
();

150 
Void
 
¸óã
 ( c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxDïth
 );

152 
Void
 
de°roy
 ();

154 
TComPicSym
 ();

155 ~
TComPicSym
();

157 
TComSli˚
* 
	$gëSli˚
(
UI¡
 
i
Ë{  
m_≠Sli˚s
[i]; 
	}
}

158 c⁄° 
TComSli˚
* 
	$gëSli˚
(
UI¡
 
i
Ëc⁄° {  
m_≠Sli˚s
[i]; 
	}
}

159 
UI¡
 
	$gëFømeWidthInCtus
(Ëc⁄° {  
m_‰ameWidthInCtus
; 
	}
}

160 
UI¡
 
	$gëFømeHeightInCtus
(Ëc⁄° {  
m_‰ameHeightInCtus
; 
	}
}

161 
UI¡
 
	$gëMöCUWidth
(Ëc⁄° {  
m_uiMöCUWidth
; 
	}
}

162 
UI¡
 
	$gëMöCUHeight
(Ëc⁄° {  
m_uiMöCUHeight
; 
	}
}

163 
UI¡
 
	$gëNumbîOfCtusInFøme
(Ëc⁄° {  
m_numCtusInFøme
; 
	}
}

164 
TComD©aCU
* 
	$gëCtu
–
UI¡
 
˘uRsAddr
 ) {  
m_pi˘uªCtuAºay
[˘uRsAddr]; 
	}
}

165 c⁄° 
TComD©aCU
* 
	$gëCtu
–
UI¡
 
˘uRsAddr
 ) c⁄° {  
m_pi˘uªCtuAºay
[˘uRsAddr]; 
	}
}

166 c⁄° 
	gTComSPS
& 
	$gëSPS
(Ëc⁄° {  
m_•s
; 
	}
}

167 c⁄° 
	gTComPPS
& 
	$gëPPS
(Ëc⁄° {  
m_µs
; 
	}
}

168 #i‡
REDUCED_ENCODER_MEMORY


169 
Boﬁ
 
	$hasDPBPîCtuD©a
(Ëc⁄° {  (
m_dpbPîCtuD©a
!=0); 
	}
};

170 
	gDPBPîCtuD©a
& 
	$gëDPBPîCtuD©a
(
UI¡
 
˘uRsAddr
Ë{  
m_dpbPîCtuD©a
[˘uRsAddr]; 
	}
}

171 c⁄° 
	gDPBPîCtuD©a
& 
	$gëDPBPîCtuD©a
(
UI¡
 
˘uRsAddr
Ëc⁄° {  
m_dpbPîCtuD©a
[˘uRsAddr]; 
	}
}

174 
TComSli˚
 * 
	$sw≠Sli˚Obje˘
(
TComSli˚
* 
p
, 
UI¡
 
i
Ë{Ö->
	`£tSPS
(&
m_•s
);Ö->
	`£tPPS
(&
m_µs
); TComSli˚ *
pTmp
=
m_≠Sli˚s
[i];m_≠Sli˚s[i] =Ö;ÖTmp->£tSPS(0);ÖTmp->£tPPS(0); ÖTmp; 
	}
}

175 
UI¡
 
	$gëNumAŒoˇãdSli˚
(Ëc⁄° {  
	`UI¡
(
m_≠Sli˚s
.
	`size
()); 
	}
}

176 
Void
 
ÆloˇãNewSli˚
();

177 
Void
 
˛órSli˚Buf„r
();

178 
UI¡
 
	$gëNumP¨tôi⁄sInCtu
(Ëc⁄° {  
m_numP¨tôi⁄sInCtu
; 
	}
}

179 
UI¡
 
	$gëNumP¨tInCtuWidth
(Ëc⁄° {  
m_numP¨tInCtuWidth
; 
	}
}

180 
UI¡
 
	$gëNumP¨tInCtuHeight
(Ëc⁄° {  
m_numP¨tInCtuHeight
; 
	}
}

181 
I¡
 
	$gëNumTûeCﬁumnsMöus1
(Ëc⁄° {  
m_numTûeCﬁumnsMöus1
; 
	}
}

182 
I¡
 
	$gëNumTûeRowsMöus1
(Ëc⁄° {  
m_numTûeRowsMöus1
; 
	}
}

183 
I¡
 
	$gëNumTûes
(Ëc⁄° {  (
m_numTûeRowsMöus1
+1)*(
m_numTûeCﬁumnsMöus1
+1); 
	}
}

184 
TComTûe
* 
	$gëTComTûe
 ( 
UI¡
 
tûeIdx
 ) {  &(
m_tûeP¨amëîs
[tûeIdx]); 
	}
}

185 c⁄° 
TComTûe
* 
	$gëTComTûe
 ( 
UI¡
 
tûeIdx
 ) c⁄° {  &(
m_tûeP¨amëîs
[tûeIdx]); 
	}
}

186 
UI¡
 
	$gëCtuTsToRsAddrM≠
–
I¡
 
˘uTsAddr
 ) c⁄° {  *(
m_˘uTsToRsAddrM≠
 + (˘uTsAddr>=
m_numCtusInFøme
 ? m_numCtusInFømê: ctuTsAddr)); 
	}
}

187 
UI¡
 
	$gëTûeIdxM≠
–
I¡
 
˘uRsAddr
 ) c⁄° {  *(
m_puiTûeIdxM≠
 + ctuRsAddr); 
	}
}

188 
UI¡
 
	$gëCtuRsToTsAddrM≠
–
I¡
 
˘uRsAddr
 ) c⁄° {  *(
m_˘uRsToTsAddrM≠
 + (˘uRsAddr>=
m_numCtusInFøme
 ? m_numCtusInFømê: ctuRsAddr)); 
	}
}

189 
SAOBlkP¨am
* 
	$gëSAOBlkP¨am
(Ë{  
m_ßoBlkP¨ams
;
	}
}

190 c⁄° 
SAOBlkP¨am
* 
	$gëSAOBlkP¨am
(Ëc⁄° {  
m_ßoBlkP¨ams
;
	}
}

191 
Void
 
dîiveLo›FûãrBound¨yAvaûibûôy
(
I¡
 
˘uRsAddr
,

192 
Boﬁ
& 
isLe·Avaû
, Boﬁ& 
isRightAvaû
, Boﬁ& 
isAboveAvaû
, Boﬁ& 
isBñowAvaû
,

193 
Boﬁ
& 
isAboveLe·Avaû
, Boﬁ& 
isAboveRightAvaû
, Boﬁ& 
isBñowLe·Avaû
, Boﬁ& 
isBñowRightAvaû
);

194 
	g¥Ÿe˘ed
:

195 
UI¡
 
xCÆcuœãNextCtuRSAddr
–UI¡ 
uiCuºCtuRSAddr
 );

200 #i‡
MCTS_EXTRACTION


202 ˛as†
	cM˘sExåa˘‹TComPicSym
 {

203 
	mpublic
:

204 
Void
 
	$£tNumbîOfCtusInFøme
(
TComPicSym
 *
picsym
, 
UI¡
 
numOfCtusInFøme
Ë{Öicsym->
m_numCtusInFøme
 =ÇumOfCtusInFrame; }

205 
	}
};

211 #i‡
MCTS_ENC_CHECK


212 
Void
 
gëTûePosôi⁄
(c⁄° 
TComD©aCU
* c⁄° 
pcCU
, 
UI¡
 &
tûeXPosInCtus
, UI¡ &
tûeYPosInCtus
, UI¡ &
tûeWidthtInCtus
, UI¡ &
tûeHeightInCtus
);

	@TLibCommon/TComPicYuv.cpp

38 
	~<c°dlib
>

39 
	~<as£π.h
>

40 
	~<mem‹y.h
>

42 #ifde‡
__APPLE__


43 
	~<mÆloc/mÆloc.h
>

45 
	~<mÆloc.h
>

48 
	~"TComPicYuv.h
"

49 
	~"Utûôõs/TVideoIOYuv.h
"

54 
	gTComPicYuv
::
	$TComPicYuv
()

56 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

58 
m_≠iPicBuf
[
i
] = 
NULL
;

59 
m_piPicOrg
[
i
] = 
NULL
;

62 
UI¡
 
i
=0; i<
MAX_NUM_CHANNEL_TYPE
; i++)

64 
m_˘uOff£tInBuf„r
[
i
]=0;

65 
m_subCuOff£tInBuf„r
[
i
]=0;

68 
m_bIsB‹dîExãnded
 = 
Ál£
;

69 
	}
}

74 
	gTComPicYuv
::~
	$TComPicYuv
()

76 
	`de°roy
();

77 
	}
}

81 
Void
 
	gTComPicYuv
::
	$¸óãWôhoutCUInfo
 ( c⁄° 
I¡
 
picWidth
,

82 c⁄° 
I¡
 
picHeight
,

83 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
,

84 c⁄° 
Boﬁ
 
bU£M¨gö
,

85 c⁄° 
UI¡
 
maxCUWidth
,

86 c⁄° 
UI¡
 
maxCUHeight
)

89 
	`de°roy
();

91 
m_picWidth
 = 
picWidth
;

92 
m_picHeight
 = 
picHeight
;

93 
m_chromaF‹m©IDC
 = 
chromaF‹m©IDC
;

94 
m_m¨göX
 = (
bU£M¨gö
?
maxCUWidth
:0) + 16;

95 
m_m¨göY
 = (
bU£M¨gö
?
maxCUHeight
:0) + 16;

96 
m_bIsB‹dîExãnded
 = 
Ál£
;

99 
UI¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

101 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
comp
);

102 
m_≠iPicBuf
[
comp
] = (
Pñ
*)
	`xMÆloc
–Pñ, 
	`gëSåide
(
ch
Ë* 
	`gëTŸÆHeight
(ch));

103 
m_piPicOrg
[
comp
] = 
m_≠iPicBuf
[comp] + (
m_m¨göY
 >> 
	`gëComp⁄ítSˇÀY
(
ch
)Ë* 
	`gëSåide
(chË+ (
m_m¨göX
 >> 
	`gëComp⁄ítSˇÀX
(ch));

106 
UI¡
 
comp
=
	`gëNumbîVÆidComp⁄íts
();comp<
MAX_NUM_COMPONENT
; comp++)

108 
m_≠iPicBuf
[
comp
] = 
NULL
;

109 
m_piPicOrg
[
comp
] = 
NULL
;

112 
I¡
 
ch™
=0; ch™<
MAX_NUM_CHANNEL_TYPE
; chan++)

114 
m_˘uOff£tInBuf„r
[
ch™
] = 
NULL
;

115 
m_subCuOff£tInBuf„r
[
ch™
] = 
NULL
;

117 
	}
}

121 
Void
 
	gTComPicYuv
::
	$¸óã
 ( c⁄° 
I¡
 
picWidth
,

122 c⁄° 
I¡
 
picHeight
,

123 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
,

124 c⁄° 
UI¡
 
maxCUWidth
,

125 c⁄° 
UI¡
 
maxCUHeight
,

126 c⁄° 
UI¡
 
maxCUDïth
,

127 c⁄° 
Boﬁ
 
bU£M¨gö
)

130 
	`¸óãWôhoutCUInfo
(
picWidth
, 
picHeight
, 
chromaF‹m©IDC
, 
bU£M¨gö
, 
maxCUWidth
, 
maxCUHeight
);

133 c⁄° 
I¡
 
numCuInWidth
 = 
m_picWidth
 / 
maxCUWidth
 + (m_picWidth % maxCUWidth != 0);

134 c⁄° 
I¡
 
numCuInHeight
 = 
m_picHeight
 / 
maxCUHeight
 + (m_picHeight % maxCUHeight != 0);

135 
I¡
 
ch™
=0; ch™<
MAX_NUM_CHANNEL_TYPE
; chan++)

137 c⁄° 
Ch™√lTy≥
 
ch

	`Ch™√lTy≥
(
ch™
);

138 c⁄° 
I¡
 
˘uHeight
 = 
maxCUHeight
>>
	`gëCh™√lTy≥SˇÀY
(
ch
);

139 c⁄° 
I¡
 
˘uWidth
 = 
maxCUWidth
>>
	`gëCh™√lTy≥SˇÀX
(
ch
);

140 c⁄° 
I¡
 
°ride
 = 
	`gëSåide
(
ch
);

142 
m_˘uOff£tInBuf„r
[
ch™
] = 
√w
 
I¡
[
numCuInWidth
 * 
numCuInHeight
];

144 
I¡
 
cuRow
 = 0; cuRow < 
numCuInHeight
; cuRow++)

146 
I¡
 
cuCﬁ
 = 0; cuCﬁ < 
numCuInWidth
; cuCol++)

148 
m_˘uOff£tInBuf„r
[
ch™
][
cuRow
 * 
numCuInWidth
 + 
cuCﬁ
] = 
°ride
 * cuRow * 
˘uHeight
 + cuCﬁ * 
˘uWidth
;

152 
m_subCuOff£tInBuf„r
[
ch™
] = 
√w
 
I¡
[(
size_t
)1 << (2 * 
maxCUDïth
)];

154 c⁄° 
I¡
 
numSubBlockP¨tôi⁄s
=(1<<
maxCUDïth
);

155 c⁄° 
I¡
 
möSubBlockHeight
 =(
˘uHeight
 >> 
maxCUDïth
);

156 c⁄° 
I¡
 
möSubBlockWidth
 =(
˘uWidth
 >> 
maxCUDïth
);

158 
I¡
 
buRow
 = 0; buRow < 
numSubBlockP¨tôi⁄s
; buRow++)

160 
I¡
 
buCﬁ
 = 0; buCﬁ < 
numSubBlockP¨tôi⁄s
; buCol++)

162 
m_subCuOff£tInBuf„r
[
ch™
][(
buRow
 << 
maxCUDïth
Ë+ 
buCﬁ
] = 
°ride
 * buRow * 
möSubBlockHeight
 + buCﬁ * 
möSubBlockWidth
;

166 
	}
}

168 
Void
 
	gTComPicYuv
::
	$de°roy
()

170 
I¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

172 
m_piPicOrg
[
comp
] = 
NULL
;

174 if–
m_≠iPicBuf
[
comp
] )

176 
	`xFªe
–
m_≠iPicBuf
[
comp
] );

177 
m_≠iPicBuf
[
comp
] = 
NULL
;

181 
UI¡
 
ch™
=0; ch™<
MAX_NUM_CHANNEL_TYPE
; chan++)

183 i‡(
m_˘uOff£tInBuf„r
[
ch™
])

185 
dñëe
[] 
m_˘uOff£tInBuf„r
[
ch™
];

186 
m_˘uOff£tInBuf„r
[
ch™
] = 
NULL
;

188 i‡(
m_subCuOff£tInBuf„r
[
ch™
])

190 
dñëe
[] 
m_subCuOff£tInBuf„r
[
ch™
];

191 
m_subCuOff£tInBuf„r
[
ch™
] = 
NULL
;

194 
	}
}

198 
Void
 
	gTComPicYuv
::
	$c›yToPic
 (
TComPicYuv
* 
pcPicYuvD°
) const

200 
	`as£π
–
m_chromaF‹m©IDC
 =
pcPicYuvD°
->
	`gëChromaF‹m©
() );

202 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

204 c⁄° 
Comp⁄ítID
 
compId
=
	`Comp⁄ítID
(
comp
);

205 c⁄° 
I¡
 
width
 = 
	`gëWidth
(
compId
);

206 c⁄° 
I¡
 
height
 = 
	`gëHeight
(
compId
);

207 c⁄° 
I¡
 
°rideSrc
 = 
	`gëSåide
(
compId
);

208 
	`as£π
(
pcPicYuvD°
->
	`gëWidth
(
compId
Ë=
width
);

209 
	`as£π
(
pcPicYuvD°
->
	`gëHeight
(
compId
Ë=
height
);

210 i‡(
°rideSrc
==
pcPicYuvD°
->
	`gëSåide
(
compId
))

212 ::
	`mem˝y
 ( 
pcPicYuvD°
->
	`gëBuf
(
compId
), gëBuf(compId), (
Pñ
)*
°rideSrc
*
	`gëTŸÆHeight
(compId));

216 c⁄° 
Pñ
 *
pSrc
 = 
	`gëAddr
(
compId
);

217 
Pñ
 *
pDe°
 = 
pcPicYuvD°
->
	`gëAddr
(
compId
);

218 c⁄° 
UI¡
 
°rideDe°
 = 
pcPicYuvD°
->
	`gëSåide
(
compId
);

220 
I¡
 
y
=0; y<
height
; y++, 
pSrc
+=
°rideSrc
, 
pDe°
+=
°rideDe°
)

222 ::
	`mem˝y
(
pDe°
, 
pSrc
, 
width
*(
Pñ
));

226 
	}
}

229 
Void
 
	gTComPicYuv
::
	$exãndPicB‹dî
 ()

231 i‡–
m_bIsB‹dîExãnded
 )

236 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

238 c⁄° 
Comp⁄ítID
 
compId
=
	`Comp⁄ítID
(
comp
);

239 
Pñ
 *
piTxt
=
	`gëAddr
(
compId
);

240 c⁄° 
I¡
 
°ride
=
	`gëSåide
(
compId
);

241 c⁄° 
I¡
 
width
=
	`gëWidth
(
compId
);

242 c⁄° 
I¡
 
height
=
	`gëHeight
(
compId
);

243 c⁄° 
I¡
 
m¨göX
=
	`gëM¨göX
(
compId
);

244 c⁄° 
I¡
 
m¨göY
=
	`gëM¨göY
(
compId
);

246 
Pñ
* 
pi
 = 
piTxt
;

248 
I¡
 
y
 = 0; y < 
height
; y++)

250 
I¡
 
x
 = 0; x < 
m¨göX
; x++ )

252 
pi
[ -
m¨göX
 + 
x
 ] =Öi[0];

253 
pi
[ 
width
 + 
x
 ] =Öi[width-1];

255 
pi
 +
°ride
;

259 
pi
 -(
°ride
 + 
m¨göX
);

261 
I¡
 
y
 = 0; y < 
m¨göY
; y++ )

263 ::
	`mem˝y
–
pi
 + (
y
+1)*
°ride
,Öi, (
Pñ
)*(
width
 + (
m¨göX
<<1)) );

267 
pi
 -((
height
-1Ë* 
°ride
);

269 
I¡
 
y
 = 0; y < 
m¨göY
; y++ )

271 ::
	`mem˝y
–
pi
 - (
y
+1)*
°ride
,Öi, (
Pñ
)*(
width
 + (
m¨göX
<<1)) );

275 
m_bIsB‹dîExãnded
 = 
åue
;

276 
	}
}

281 
Void
 
	gTComPicYuv
::
	$dump
 (c⁄° 
°d
::
°rög
 &
fûeName
, c⁄° 
BôDïths
 &
bôDïths
, c⁄° 
Boﬁ
 
bAµíd
, c⁄° Boﬁ 
bF‹˚To8Bô
) const

283 
FILE
 *
pFûe
 = 
	`f›í
 (
fûeName
.
	`c_°r
(), 
bAµíd
?"ab":"wb");

285 
Boﬁ
 
is16bô
=
Ál£
;

286 
I¡
 
comp
 = 0; com∞< 
	`gëNumbîVÆidComp⁄íts
(Ë&& !
bF‹˚To8Bô
; comp++)

288 i‡(
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
	`Comp⁄ítID
(
comp
))]>8)

290 
is16bô
=
åue
;

294 
I¡
 
comp
 = 0; com∞< 
	`gëNumbîVÆidComp⁄íts
(); comp++)

296 c⁄° 
Comp⁄ítID
 
compId
 = 
	`Comp⁄ítID
(
comp
);

297 c⁄° 
Pñ
 *
pi
 = 
	`gëAddr
(
compId
);

298 c⁄° 
I¡
 
°ride
 = 
	`gëSåide
(
compId
);

299 c⁄° 
I¡
 
height
 = 
	`gëHeight
(
compId
);

300 c⁄° 
I¡
 
width
 = 
	`gëWidth
(
compId
);

302 i‡(
is16bô
)

304 
I¡
 
y
 = 0; y < 
height
; y++ )

306 
I¡
 
x
 = 0; x < 
width
; x++ )

308 
UCh¨
 
uc
 = (UCh¨)((
pi
[
x
]>>0) & 0xff);

309 
	`fwrôe
–&
uc
, (
UCh¨
), 1, 
pFûe
 );

310 
uc
 = (
UCh¨
)((
pi
[
x
]>>8) & 0xff);

311 
	`fwrôe
–&
uc
, (
UCh¨
), 1, 
pFûe
 );

313 
pi
 +
°ride
;

318 c⁄° 
I¡
 
shi·
 = 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compId
)] - 8;

319 c⁄° 
I¡
 
off£t
 = (
shi·
>0)?(1<<(shift-1)):0;

320 
I¡
 
y
 = 0; y < 
height
; y++ )

322 
I¡
 
x
 = 0; x < 
width
; x++ )

324 
UCh¨
 
uc
 = (UCh¨)
Clù3
<
Pñ
>(0, 255, (
pi
[
x
]+
off£t
)>>
shi·
);

325 
	`fwrôe
–&
uc
, (
UCh¨
), 1, 
pFûe
 );

327 
pi
 +
°ride
;

332 
	`f˛o£
(
pFûe
);

333 
	}
}

	@TLibCommon/TComPicYuv.h

38 #i‚de‡
__TCOMPICYUV__


39 
	#__TCOMPICYUV__


	)

41 
	~<°dio.h
>

42 
	~"Comm⁄Def.h
"

43 
	~"TComRom.h
"

44 
	~"TComChromaF‹m©.h
"

45 
	~"SEI.h
"

55 ˛as†
	cTComPicYuv


57 
	m¥iv©e
:

63 
Pñ
* 
m_≠iPicBuf
[
MAX_NUM_COMPONENT
];

65 
Pñ
* 
	mm_piPicOrg
[
MAX_NUM_COMPONENT
];

71 
I¡
 
	mm_picWidth
;

72 
I¡
 
	mm_picHeight
;

73 
ChromaF‹m©
 
	mm_chromaF‹m©IDC
;

75 
I¡
* 
	mm_˘uOff£tInBuf„r
[
MAX_NUM_CHANNEL_TYPE
];

76 
I¡
* 
	mm_subCuOff£tInBuf„r
[
MAX_NUM_CHANNEL_TYPE
];

78 
I¡
 
	mm_m¨göX
;

79 
I¡
 
	mm_m¨göY
;

81 
Boﬁ
 
	mm_bIsB‹dîExãnded
;

83 
	mpublic
:

84 
TComPicYuv
 ();

85 
	mvútuÆ
 ~
TComPicYuv
 ();

91 
Void
 
¸óã
 (c⁄° 
I¡
 
picWidth
,

92 c⁄° 
I¡
 
picHeight
,

93 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
,

94 c⁄° 
UI¡
 
maxCUWidth
,

95 c⁄° 
UI¡
 
maxCUHeight
,

96 c⁄° 
UI¡
 
maxCUDïth
,

97 c⁄° 
Boﬁ
 
bU£M¨gö
);

99 
Void
 
¸óãWôhoutCUInfo
(c⁄° 
I¡
 
picWidth
,

100 c⁄° 
I¡
 
picHeight
,

101 c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
,

102 c⁄° 
Boﬁ
 
bU£M¨gö
=
Ál£
,

103 c⁄° 
UI¡
 
maxCUWidth
=0,

104 c⁄° 
UI¡
 
maxCUHeight
=0);

106 
Void
 
de°roy
 ();

116 
I¡
 
	$gëWidth
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_picWidth
 >> 
	`gëComp⁄ítSˇÀX
(id); }

117 
I¡
 
	$gëHeight
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_picHeight
 >> 
	`gëComp⁄ítSˇÀY
(id); 
	}
}

118 
ChromaF‹m©
 
	$gëChromaF‹m©
 (Ëc⁄° {  
m_chromaF‹m©IDC
; 
	}
}

119 
UI¡
 
	$gëNumbîVÆidComp⁄íts
(Ëc⁄° {  ::
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
); 
	}
}

121 
I¡
 
	$gëSåide
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  ((
m_picWidth
 ) + (
m_m¨göX
 <<1)Ë>> 
	`gëComp⁄ítSˇÀX
(id); 
	}
}

122 
	g¥iv©e
:

123 
I¡
 
	$gëSåide
 (c⁄° 
Ch™√lTy≥
 
id
Ëc⁄° {  ((
m_picWidth
 ) + (
m_m¨göX
 <<1)Ë>> 
	`gëCh™√lTy≥SˇÀX
(id); 
	}
}

124 
	gpublic
:

125 
I¡
 
	$gëTŸÆHeight
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  ((
m_picHeight
 ) + (
m_m¨göY
 <<1)Ë>> 
	`gëComp⁄ítSˇÀY
(id); 
	}
}

127 
I¡
 
	$gëM¨göX
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_m¨göX
 >> 
	`gëComp⁄ítSˇÀX
(id); 
	}
}

128 
I¡
 
	$gëM¨göY
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_m¨göY
 >> 
	`gëComp⁄ítSˇÀY
(id); 
	}
}

135 
Pñ
* 
	$gëBuf
 (c⁄° 
Comp⁄ítID
 
ch
Ë{  
m_≠iPicBuf
[ch]; 
	}
}

136 c⁄° 
Pñ
* 
	$gëBuf
 (c⁄° 
Comp⁄ítID
 
ch
Ëc⁄° {  
m_≠iPicBuf
[ch]; 
	}
}

139 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
ch
Ë{  
m_piPicOrg
[ch]; 
	}
}

140 c⁄° 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
ch
Ëc⁄° {  
m_piPicOrg
[ch]; 
	}
}

143 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
ch
, c⁄° 
I¡
 
˘uRSAddr
 ) {  
m_piPicOrg
[ch] + 
m_˘uOff£tInBuf„r
[ch==0?0:1][ ctuRSAdd∏]; 
	}
}

144 c⁄° 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
ch
, c⁄° 
I¡
 
˘uRSAddr
 ) c⁄° {  
m_piPicOrg
[ch] + 
m_˘uOff£tInBuf„r
[ch==0?0:1][ ctuRSAdd∏]; 
	}
}

145 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
ch
, c⁄° 
I¡
 
˘uRSAddr
, c⁄° I¡ 
uiAbsZ‹dîIdx
 )

146 {  
m_piPicOrg
[
ch
] + 
m_˘uOff£tInBuf„r
[ch==0?0:1][
˘uRSAddr
] + 
m_subCuOff£tInBuf„r
[ch==0?0:1][
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
]]; 
	}
}

147 c⁄° 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
ch
, c⁄° 
I¡
 
˘uRSAddr
, c⁄° I¡ 
uiAbsZ‹dîIdx
 ) const

148 {  
m_piPicOrg
[
ch
] + 
m_˘uOff£tInBuf„r
[ch==0?0:1][
˘uRSAddr
] + 
m_subCuOff£tInBuf„r
[ch==0?0:1][
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
]]; 
	}
}

150 
UI¡
 
	$gëComp⁄ítSˇÀX
(c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  ::
	`gëComp⁄ítSˇÀX
(id, 
m_chromaF‹m©IDC
); 
	}
}

151 
UI¡
 
	$gëComp⁄ítSˇÀY
(c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  ::
	`gëComp⁄ítSˇÀY
(id, 
m_chromaF‹m©IDC
); 
	}
}

153 
UI¡
 
	$gëCh™√lTy≥SˇÀX
(c⁄° 
Ch™√lTy≥
 
id
Ëc⁄° {  ::
	`gëCh™√lTy≥SˇÀX
(id, 
m_chromaF‹m©IDC
); 
	}
}

154 
UI¡
 
	$gëCh™√lTy≥SˇÀY
(c⁄° 
Ch™√lTy≥
 
id
Ëc⁄° {  ::
	`gëCh™√lTy≥SˇÀY
(id, 
m_chromaF‹m©IDC
); 
	}
}

161 
Void
 
	$c›yToPic
 ( 
TComPicYuv
* 
pcPicYuvD°
 ) const ;

164 
Void
 
	`exãndPicB‹dî
 ();

167 
Void
 
	$dump
 (c⁄° 
°d
::
°rög
 &
fûeName
, c⁄° 
BôDïths
 &
bôDïths
, c⁄° 
Boﬁ
 
bAµíd
=
Ál£
, c⁄° Boﬁ 
bF‹˚To8Bô
=false) const ;

170 
Void
 
	$£tB‹dîExãnsi⁄
(
Boﬁ
 
b
Ë{ 
m_bIsB‹dîExãnded
 = b; 
	}
}

175 
UI¡
 
ˇlcChecksum
(c⁄° 
TComPicYuv
& 
pic
, 
TComPi˘uªHash
 &
dige°
, c⁄° 
BôDïths
 &
bôDïths
);

176 
UI¡
 
ˇlcCRC
 (c⁄° 
TComPicYuv
& 
pic
, 
TComPi˘uªHash
 &
dige°
, c⁄° 
BôDïths
 &
bôDïths
);

177 
UI¡
 
ˇlcMD5
 (c⁄° 
TComPicYuv
& 
pic
, 
TComPi˘uªHash
 &
dige°
, c⁄° 
BôDïths
 &
bôDïths
);

178 
	g°d
::
°rög
 
hashToSåög
(c⁄° 
TComPi˘uªHash
 &
dige°
, 
I¡
 
numCh¨
);

	@TLibCommon/TComPicYuvMD5.cpp

34 
	~"TComPicYuv.h
"

35 
	~"libmd5/MD5.h
"

44 
	gãm∂©e
<
UI¡
 
	gOUTPUT_BITDEPTH_DIV8
>

45 
Void
 
	$md5_block
(
MD5
& 
md5
, c⁄° 
Pñ
* 
∂™e
, 
UI¡
 
n
)

48 
UCh¨
 
buf
[64/
OUTPUT_BITDEPTH_DIV8
][OUTPUT_BITDEPTH_DIV8];

49 
UI¡
 
i
 = 0; i < 
n
; i++)

51 
Pñ
 
≥l
 = 
∂™e
[
i
];

53 
UI¡
 
d
 = 0; d < 
OUTPUT_BITDEPTH_DIV8
; d++)

55 
buf
[
i
][
d
] = 
≥l
 >> (d*8);

58 
md5
.
	`upd©e
((
UCh¨
*)
buf
, 
n
 * 
OUTPUT_BITDEPTH_DIV8
);

59 
	}
}

65 
	gãm∂©e
<
UI¡
 
	gOUTPUT_BITDEPTH_DIV8
>

66 
Void
 
	$md5_∂™e
(
MD5
& 
md5
, c⁄° 
Pñ
* 
∂™e
, 
UI¡
 
width
, UI¡ 
height
, UI¡ 
°ride
)

70 
UI¡
 
N
 = 32;

71 
UI¡
 
width_modN
 = 
width
 % 
N
;

72 
UI¡
 
width_Àss_modN
 = 
width
 - 
width_modN
;

74 
UI¡
 
y
 = 0; y < 
height
; y++)

78 
UI¡
 
x
 = 0; x < 
width_Àss_modN
; x +
N
)

80 
md5_block
<
OUTPUT_BITDEPTH_DIV8
>(
md5
, &
∂™e
[
y
*
°ride
 + 
x
], 
N
);

84 
md5_block
<
OUTPUT_BITDEPTH_DIV8
>(
md5
, &
∂™e
[
y
*
°ride
 + 
width_Àss_modN
], 
width_modN
);

86 
	}
}

89 
UI¡
 
	$compCRC
(
I¡
 
bôdïth
, c⁄° 
Pñ
* 
∂™e
, 
UI¡
 
width
, UI¡ 
height
, UI¡ 
°ride
, 
TComPi˘uªHash
 &
dige°
)

91 
UI¡
 
¸cMsb
;

92 
UI¡
 
bôVÆ
;

93 
UI¡
 
¸cVÆ
 = 0xffff;

94 
UI¡
 
bôIdx
;

95 
UI¡
 
y
 = 0; y < 
height
; y++)

97 
UI¡
 
x
 = 0; x < 
width
; x++)

100 
bôIdx
=0; bitIdx<8; bitIdx++)

102 
¸cMsb
 = (
¸cVÆ
 >> 15) & 1;

103 
bôVÆ
 = (
∂™e
[
y
*
°ride
+
x
] >> (7 - 
bôIdx
)) & 1;

104 
¸cVÆ
 = (((¸cVÆ << 1Ë+ 
bôVÆ
Ë& 0xffffË^ (
¸cMsb
 * 0x1021);

107 if(
bôdïth
 > 8)

109 
bôIdx
=0; bitIdx<8; bitIdx++)

111 
¸cMsb
 = (
¸cVÆ
 >> 15) & 1;

112 
bôVÆ
 = (
∂™e
[
y
*
°ride
+
x
] >> (15 - 
bôIdx
)) & 1;

113 
¸cVÆ
 = (((¸cVÆ << 1Ë+ 
bôVÆ
Ë& 0xffffË^ (
¸cMsb
 * 0x1021);

118 
bôIdx
=0; bitIdx<16; bitIdx++)

120 
¸cMsb
 = (
¸cVÆ
 >> 15) & 1;

121 
¸cVÆ
 = ((¸cVÆ << 1Ë& 0xffffË^ (
¸cMsb
 * 0x1021);

124 
dige°
.
hash
.
	`push_back
((
¸cVÆ
>>8) & 0xff);

125 
dige°
.
hash
.
	`push_back
–
¸cVÆ
 & 0xff);

127 
	}
}

129 
UI¡
 
	$ˇlcCRC
(c⁄° 
TComPicYuv
& 
pic
, 
TComPi˘uªHash
 &
dige°
, c⁄° 
BôDïths
 &
bôDïths
)

131 
UI¡
 
dige°Lí
=0;

132 
dige°
.
hash
.
	`˛ór
();

133 
I¡
 
ch™
=0; ch™<
pic
.
	`gëNumbîVÆidComp⁄íts
(); chan++)

135 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch™
);

136 
dige°Lí
=
	`compCRC
(
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)], 
pic
.
	`gëAddr
(compID),Öic.
	`gëWidth
(compID),Öic.
	`gëHeight
(compID),Öic.
	`gëSåide
(compID), 
dige°
);

138  
dige°Lí
;

139 
	}
}

141 
UI¡
 
	$compChecksum
(
I¡
 
bôdïth
, c⁄° 
Pñ
* 
∂™e
, 
UI¡
 
width
, UI¡ 
height
, UI¡ 
°ride
, 
TComPi˘uªHash
 &
dige°
, c⁄° 
BôDïths
 & )

143 
UI¡
 
checksum
 = 0;

144 
UCh¨
 
x‹_mask
;

146 
UI¡
 
y
 = 0; y < 
height
; y++)

148 
UI¡
 
x
 = 0; x < 
width
; x++)

150 
x‹_mask
 = (
x
 & 0xffË^ (
y
 & 0xff) ^ (x >> 8) ^ (y >> 8);

151 
checksum
 = (checksum + ((
∂™e
[
y
*
°ride
+
x
] & 0xffË^ 
x‹_mask
)) & 0xffffffff;

153 if(
bôdïth
 > 8)

155 
checksum
 = (checksum + ((
∂™e
[
y
*
°ride
+
x
]>>8Ë^ 
x‹_mask
)) & 0xffffffff;

160 
dige°
.
hash
.
	`push_back
((
checksum
>>24) & 0xff);

161 
dige°
.
hash
.
	`push_back
((
checksum
>>16) & 0xff);

162 
dige°
.
hash
.
	`push_back
((
checksum
>>8) & 0xff);

163 
dige°
.
hash
.
	`push_back
–
checksum
 & 0xff);

165 
	}
}

167 
UI¡
 
	$ˇlcChecksum
(c⁄° 
TComPicYuv
& 
pic
, 
TComPi˘uªHash
 &
dige°
, c⁄° 
BôDïths
 &
bôDïths
)

169 
UI¡
 
dige°Lí
=0;

170 
dige°
.
hash
.
	`˛ór
();

171 
I¡
 
ch™
=0; ch™<
pic
.
	`gëNumbîVÆidComp⁄íts
(); chan++)

173 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch™
);

174 
dige°Lí
=
	`compChecksum
(
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)], 
pic
.
	`gëAddr
(compID),Öic.
	`gëWidth
(compID),Öic.
	`gëHeight
(compID),Öic.
	`gëSåide
(compID), 
dige°
, bitDepths);

176  
dige°Lí
;

177 
	}
}

185 
UI¡
 
	$ˇlcMD5
(c⁄° 
TComPicYuv
& 
pic
, 
TComPi˘uªHash
 &
dige°
, c⁄° 
BôDïths
 &
bôDïths
)

188 
	`Void
 (*
	tMD5Pœ√Func
)(
	tMD5
&, c⁄° 
	tPñ
*, 
	tUI¡
, UInt, UInt);

189 
MD5Pœ√Func
 
md5_∂™e_func
;

191 
MD5
 
md5
[
MAX_NUM_COMPONENT
];

193 
dige°
.
hash
.
	`˛ór
();

194 
I¡
 
ch™
=0; ch™<
pic
.
	`gëNumbîVÆidComp⁄íts
(); chan++)

196 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch™
);

197 
md5_∂™e_func
 = 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)] <8 ? (
MD5Pœ√Func
)
md5_∂™e
<1> : (MD5PlaneFunc)md5_plane<2>;

198 
UCh¨
 
tmp_dige°
[
MD5_DIGEST_STRING_LENGTH
];

199 
	`md5_∂™e_func
(
md5
[
compID
], 
pic
.
	`gëAddr
(compID),Öic.
	`gëWidth
(compID),Öic.
	`gëHeight
(compID),Öic.
	`gëSåide
(compID));

200 
md5
[
compID
].
	`föÆize
(
tmp_dige°
);

201 
UI¡
 
i
=0; i<
MD5_DIGEST_STRING_LENGTH
; i++)

203 
dige°
.
hash
.
	`push_back
(
tmp_dige°
[
i
]);

207 
	}
}

209 
	g°d
::
°rög
 
	$hashToSåög
(c⁄° 
TComPi˘uªHash
 &
dige°
, 
I¡
 
numCh¨
)

211 c⁄° 
TCh¨
* 
hex
 = "0123456789abcdef";

212 
°d
::
°rög
 
ªsu…
;

214 
I¡
 
pos
=0;Öos<
	`I¡
(
dige°
.
hash
.
	`size
());Öos++)

216 i‡((
pos
 % 
numCh¨
) == 0 &&Öos!=0 )

218 
ªsu…
 += ',';

220 
ªsu…
 +
hex
[
dige°
.
hash
[
pos
] >> 4];

221 
ªsu…
 +
hex
[
dige°
.
hash
[
pos
] & 0xf];

224  
ªsu…
;

225 
	}
}

	@TLibCommon/TComPrediction.cpp

38 
	~<mem‹y.h
>

39 
	~"TComPªdi˘i⁄.h
"

40 
	~"TComPic.h
"

41 
	~"TComTU.h
"

50 c⁄° 
UCh¨
 
	gTComPªdi˘i⁄
::
m_aucI¡øFûãr
[
MAX_NUM_CHANNEL_TYPE
][
MAX_INTRA_FILTER_DEPTHS
] =

73 
	gTComPªdi˘i⁄
::
	$TComPªdi˘i⁄
()

74 : 
	`m_pLumaRecBuf„r
(0)

75 , 
	$m_iLumaRecSåide
(0)

77 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

79 
UI¡
 
buf
=0; buf<2; buf++)

81 
m_piYuvExt
[
ch
][
buf
] = 
NULL
;

84 
	}
}

86 
	gTComPªdi˘i⁄
::~
	$TComPªdi˘i⁄
()

88 
	`de°roy
();

89 
	}
}

91 
Void
 
	gTComPªdi˘i⁄
::
	$de°roy
()

93 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

95 
UI¡
 
buf
=0; buf<
NUM_PRED_BUF
; buf++)

97 
dñëe
 [] 
m_piYuvExt
[
ch
][
buf
];

98 
m_piYuvExt
[
ch
][
buf
] = 
NULL
;

102 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

104 
m_acYuvPªd
[
i
].
	`de°roy
();

107 
m_cYuvPªdTemp
.
	`de°roy
();

109 if–
m_pLumaRecBuf„r
 )

111 
dñëe
 [] 
m_pLumaRecBuf„r
;

112 
m_pLumaRecBuf„r
 = 0;

114 
m_iLumaRecSåide
 = 0;

116 
UI¡
 
i
 = 0; i < 
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
; i++)

118 
UI¡
 
j
 = 0; j < 
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
; j++)

120 
m_fûãªdBlock
[
i
][
j
].
	`de°roy
();

122 
m_fûãªdBlockTmp
[
i
].
	`de°roy
();

124 
	}
}

126 
Void
 
	gTComPªdi˘i⁄
::
	$öôTempBuff
(
ChromaF‹m©
 
chromaF‹m©IDC
)

129 if–
m_piYuvExt
[
COMPONENT_Y
][
PRED_BUF_UNFILTERED
] !
NULL
 && 
m_cYuvPªdTemp
.
	`gëChromaF‹m©
()!=
chromaF‹m©IDC
)

131 
	`de°roy
();

134 if–
m_piYuvExt
[
COMPONENT_Y
][
PRED_BUF_UNFILTERED
] =
NULL
 )

136 
I¡
 
extWidth
 = 
MAX_CU_SIZE
 + 16;

137 
I¡
 
extHeight
 = 
MAX_CU_SIZE
 + 1;

139 
UI¡
 
i
 = 0; i < 
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
; i++)

141 
m_fûãªdBlockTmp
[
i
].
	`¸óã
(
extWidth
, 
extHeight
 + 7, 
chromaF‹m©IDC
);

142 
UI¡
 
j
 = 0; j < 
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
; j++)

144 
m_fûãªdBlock
[
i
][
j
].
	`¸óã
(
extWidth
, 
extHeight
, 
chromaF‹m©IDC
);

148 
m_iYuvExtSize
 = (
MAX_CU_SIZE
*2+1) * (MAX_CU_SIZE*2+1);

149 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

151 
UI¡
 
buf
=0; buf<
NUM_PRED_BUF
; buf++)

153 
m_piYuvExt
[
ch
][
buf
] = 
√w
 
Pñ
[ 
m_iYuvExtSize
 ];

158 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

160 
m_acYuvPªd
[
i
] .
	`¸óã
–
MAX_CU_SIZE
, MAX_CU_SIZE, 
chromaF‹m©IDC
 );

163 
m_cYuvPªdTemp
.
	`¸óã
–
MAX_CU_SIZE
, MAX_CU_SIZE, 
chromaF‹m©IDC
 );

167 i‡(
m_iLumaRecSåide
 !(
MAX_CU_SIZE
>>1) + 1)

169 
m_iLumaRecSåide
 = (
MAX_CU_SIZE
>>1) + 1;

170 i‡(!
m_pLumaRecBuf„r
)

172 
m_pLumaRecBuf„r
 = 
√w
 
Pñ
[ 
m_iLumaRecSåide
 * m_iLumaRecStride ];

175 
	}
}

183 
Pñ
 
	gTComPªdi˘i⁄
::
	$¥edI¡øGëPªdVÆDC
–c⁄° 
Pñ
* 
pSrc
, 
I¡
 
iSrcSåide
, 
UI¡
 
iWidth
, UI¡ 
iHeight
)

185 
	`as£π
(
iWidth
 > 0 && 
iHeight
 > 0);

186 
I¡
 
iInd
, 
iSum
 = 0;

187 
Pñ
 
pDcVÆ
;

189 
iInd
 = 0;iInd < 
iWidth
;iInd++)

191 
iSum
 +
pSrc
[
iInd
-
iSrcSåide
];

193 
iInd
 = 0;iInd < 
iHeight
;iInd++)

195 
iSum
 +
pSrc
[
iInd
*
iSrcSåide
-1];

198 
pDcVÆ
 = (
iSum
 + 
iWidth
Ë/ (iWidth + 
iHeight
);

200  
pDcVÆ
;

201 
	}
}

229 
Void
 
	gTComPªdi˘i⁄
::
	$xPªdI¡øAng
–
I¡
 
bôDïth
,

230 c⁄° 
Pñ
* 
pSrc
, 
I¡
 
§cSåide
,

231 
Pñ
* 
pTrueD°
, 
I¡
 
d°SåideTrue
,

232 
UI¡
 
uiWidth
, UI¡ 
uiHeight
, 
Ch™√lTy≥
 
ch™√lTy≥
,

233 
UI¡
 
dúMode
, c⁄° 
Boﬁ
 
bE«bÀEdgeFûãrs


236 
I¡
 
width
=
	`I¡
(
uiWidth
);

237 
I¡
 
height
=
	`I¡
(
uiHeight
);

240 
	`as£π
–
dúMode
 !
PLANAR_IDX
 );

241 c⁄° 
Boﬁ
 
modeDC
 = 
dúMode
==
DC_IDX
;

244 i‡(
modeDC
)

246 c⁄° 
Pñ
 
dcvÆ
 = 
	`¥edI¡øGëPªdVÆDC
(
pSrc
, 
§cSåide
, 
width
, 
height
);

248 
I¡
 
y
=
height
;y>0;y--, 
pTrueD°
+=
d°SåideTrue
)

250 
I¡
 
x
=0; x<
width
;)

252 
pTrueD°
[
x
++] = 
dcvÆ
;

258 c⁄° 
Boﬁ
 
bIsModeVî
 = (
dúMode
 >= 18);

259 c⁄° 
I¡
 
öåaPªdAngÀMode
 = (
bIsModeVî
Ë? (I¡)
dúMode
 - 
VER_IDX
 : -((I¡)dúModê- 
HOR_IDX
);

260 c⁄° 
I¡
 
absAngMode
 = 
	`abs
(
öåaPªdAngÀMode
);

261 c⁄° 
I¡
 
signAng
 = 
öåaPªdAngÀMode
 < 0 ? -1 : 1;

262 c⁄° 
Boﬁ
 
edgeFûãr
 = 
bE«bÀEdgeFûãrs
 && 
	`isLuma
(
ch™√lTy≥
Ë&& (
width
 <
MAXIMUM_INTRA_FILTERED_WIDTH
Ë&& (
height
 <
MAXIMUM_INTRA_FILTERED_HEIGHT
);

265 c⁄° 
I¡
 
™gTabÀ
[9] = {0, 2, 5, 9, 13, 17, 21, 26, 32};

266 c⁄° 
I¡
 
övAngTabÀ
[9] = {0, 4096, 1638, 910, 630, 482, 390, 315, 256};

267 
I¡
 
övAngÀ
 = 
övAngTabÀ
[
absAngMode
];

268 
I¡
 
absAng
 = 
™gTabÀ
[
absAngMode
];

269 
I¡
 
öåaPªdAngÀ
 = 
signAng
 * 
absAng
;

271 
Pñ
* 
ªfMaö
;

272 
Pñ
* 
ªfSide
;

274 
Pñ
 
ªfAbove
[2*
MAX_CU_SIZE
+1];

275 
Pñ
 
ªfLe·
[2*
MAX_CU_SIZE
+1];

278 i‡(
öåaPªdAngÀ
 < 0)

280 c⁄° 
I¡
 
ªfMaöOff£tPªSˇÀ
 = (
bIsModeVî
 ? 
height
 : 
width
 ) - 1;

281 c⁄° 
I¡
 
ªfMaöOff£t
 = 
height
 - 1;

282 
I¡
 
x
=0;x<
width
+1;x++)

284 
ªfAbove
[
x
+
ªfMaöOff£t
] = 
pSrc
[x-
§cSåide
-1];

286 
I¡
 
y
=0;y<
height
+1;y++)

288 
ªfLe·
[
y
+
ªfMaöOff£t
] = 
pSrc
[(y-1)*
§cSåide
-1];

290 
ªfMaö
 = (
bIsModeVî
 ? 
ªfAbove
 : 
ªfLe·
Ë+ 
ªfMaöOff£t
;

291 
ªfSide
 = (
bIsModeVî
 ? 
ªfLe·
 : 
ªfAbove
Ë+ 
ªfMaöOff£t
;

294 
I¡
 
övAngÀSum
 = 128;

295 
I¡
 
k
=-1; k>(
ªfMaöOff£tPªSˇÀ
+1)*
öåaPªdAngÀ
>>5; k--)

297 
övAngÀSum
 +
övAngÀ
;

298 
ªfMaö
[
k
] = 
ªfSide
[
övAngÀSum
>>8];

303 
I¡
 
x
=0;x<2*
width
+1;x++)

305 
ªfAbove
[
x
] = 
pSrc
[x-
§cSåide
-1];

307 
I¡
 
y
=0;y<2*
height
+1;y++)

309 
ªfLe·
[
y
] = 
pSrc
[(y-1)*
§cSåide
-1];

311 
ªfMaö
 = 
bIsModeVî
 ? 
ªfAbove
 : 
ªfLe·
 ;

312 
ªfSide
 = 
bIsModeVî
 ? 
ªfLe·
 : 
ªfAbove
;

316 
Pñ
 
ãmpAºay
[
MAX_CU_SIZE
*MAX_CU_SIZE];

317 c⁄° 
I¡
 
d°Såide
 = 
bIsModeVî
 ? 
d°SåideTrue
 : 
MAX_CU_SIZE
;

318 
Pñ
 *
pD°
 = 
bIsModeVî
 ? 
pTrueD°
 : 
ãmpAºay
;

319 i‡(!
bIsModeVî
)

321 
°d
::
	`sw≠
(
width
, 
height
);

324 i‡(
öåaPªdAngÀ
 == 0)

326 
I¡
 
y
=0;y<
height
;y++)

328 
I¡
 
x
=0;x<
width
;x++)

330 
pD°
[
y
*
d°Såide
+
x
] = 
ªfMaö
[x+1];

334 i‡(
edgeFûãr
)

336 
I¡
 
y
=0;y<
height
;y++)

338 
pD°
[
y
*
d°Såide
] = 
	`Clù3
 (0, ((1 << 
bôDïth
Ë- 1),ÖD°[y*d°Såide] + (–
ªfSide
[y+1] -ÑefSide[0] ) >> 1) );

344 
Pñ
 *
pD°y
=
pD°
;

346 
I¡
 
y
=0, 
dñèPos
=
öåaPªdAngÀ
; y<
height
; y++, dñèPos+=öåaPªdAngÀ, 
pD°y
+=
d°Såide
)

348 c⁄° 
I¡
 
dñèI¡
 = 
dñèPos
 >> 5;

349 c⁄° 
I¡
 
dñèFø˘
 = 
dñèPos
 & (32 - 1);

351 i‡(
dñèFø˘
)

354 c⁄° 
Pñ
 *
pRM
=
ªfMaö
+
dñèI¡
+1;

355 
I¡
 
œ°RefMaöPñ
=*
pRM
++;

356 
I¡
 
x
=0;x<
width
;
pRM
++,x++)

358 
I¡
 
thisRefMaöPñ
=*
pRM
;

359 
pD°y
[
x
+0] = (
Pñ
Ë–((32-
dñèFø˘
)*
œ°RefMaöPñ
 + dñèFø˘*
thisRefMaöPñ
 +16) >> 5 );

360 
œ°RefMaöPñ
=
thisRefMaöPñ
;

366 
I¡
 
x
=0;x<
width
; x++)

368 
pD°y
[
x
] = 
ªfMaö
[x+
dñèI¡
+1];

375 i‡(!
bIsModeVî
)

377 
I¡
 
y
=0; y<
height
; y++)

379 
I¡
 
x
=0; x<
width
; x++)

381 
pTrueD°
[
x
*
d°SåideTrue
] = 
pD°
[x];

383 
pTrueD°
++;

384 
pD°
+=
d°Såide
;

388 
	}
}

390 
Void
 
	gTComPªdi˘i⁄
::
	$¥edI¡øAng
–c⁄° 
Comp⁄ítID
 
compID
, 
UI¡
 
uiDúMode
, 
Pñ
* 
piOrg
 , UI¡ 
uiOrgSåide
, Pñ* 
piPªd
, UI¡ 
uiSåide
, 
TComTU
 &
rTu
, c⁄° 
Boﬁ
 
bU£FûãªdPªdSam∂es
, c⁄° Boﬁ 
bU£Los¶essDPCM
 )

392 c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
 = 
	`toCh™√lTy≥
(
compID
);

393 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
	`isLuma
(
compID
Ë? 
COMPONENT_Y
 : 
COMPONENT_Cb
);

394 c⁄° 
I¡
 
iWidth
 = 
ª˘
.
width
;

395 c⁄° 
I¡
 
iHeight
 = 
ª˘
.
height
;

397 
	`as£π
–
g_aucC⁄vîtToBô
[ 
iWidth
 ] >= 0 );

398 
	`as£π
–
g_aucC⁄vîtToBô
[ 
iWidth
 ] <= 5 );

401 
Pñ
 *
pD°
 = 
piPªd
;

404 c⁄° 
I¡
 
sw
 = (2 * 
iWidth
 + 1);

406 i‡–
bU£Los¶essDPCM
 )

408 c⁄° 
Pñ
 *
±rSrc
 = 
	`gëPªdi˘‹På
–
compID
, 
Ál£
 );

410 i‡(
uiDúMode
==
HOR_IDX
)

414 
I¡
 
y
=0; y<
iHeight
; y++)

416 
piPªd
[
y
*
uiSåide
+0] = 
±rSrc
[(y+1)*
sw
];

418 i‡(
piOrg
!=0)

420 
piPªd
+=1;

421 
I¡
 
y
=0; y<
iHeight
; y++, 
piPªd
+=
uiSåide
, 
piOrg
+=
uiOrgSåide
)

423 
	`mem˝y
(
piPªd
, 
piOrg
, (
iWidth
-1)*(
Pñ
));

431 
I¡
 
x
=0; x<
iWidth
; x++)

433 
piPªd
[
x
] = 
±rSrc
[x+1];

435 i‡(
piOrg
!=0)

437 
piPªd
+=
uiSåide
;

438 
I¡
 
y
=1; y<
iHeight
; y++, 
piPªd
+=
uiSåide
, 
piOrg
+=
uiOrgSåide
)

440 
	`mem˝y
(
piPªd
, 
piOrg
, 
iWidth
*(
Pñ
));

447 c⁄° 
Pñ
 *
±rSrc
 = 
	`gëPªdi˘‹På
–
compID
, 
bU£FûãªdPªdSam∂es
 );

449 i‡–
uiDúMode
 =
PLANAR_IDX
 )

451 
	`xPªdI¡øPœ«r
–
±rSrc
+
sw
+1, sw, 
pD°
, 
uiSåide
, 
iWidth
, 
iHeight
 );

456 
TComD©aCU
 *c⁄° 
pcCU
 = 
rTu
.
	`gëCU
();

457 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

458 c⁄° 
Boﬁ
 
íabÀEdgeFûãrs
 = !(
pcCU
->
	`isRDPCME«bÀd
(
uiAbsP¨tIdx
Ë&&ÖcCU->
	`gëCUTønsqu™tBy∑ss
(uiAbsPartIdx));

459 #i‡
O0043_BEST_EFFORT_DECODING


460 c⁄° 
I¡
 
ch™√lsBôDïthF‹Pªdi˘i⁄
 = 
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSåómBôDïth
(
ch™√lTy≥
);

462 c⁄° 
I¡
 
ch™√lsBôDïthF‹Pªdi˘i⁄
 = 
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
ch™√lTy≥
);

464 
	`xPªdI¡øAng
–
ch™√lsBôDïthF‹Pªdi˘i⁄
, 
±rSrc
+
sw
+1, sw, 
pD°
, 
uiSåide
, 
iWidth
, 
iHeight
, 
ch™√lTy≥
, 
uiDúMode
, 
íabÀEdgeFûãrs
 );

466 if–
uiDúMode
 =
DC_IDX
 )

468 
	`xDCPªdFûãrög
–
±rSrc
+
sw
+1, sw, 
pD°
, 
uiSåide
, 
iWidth
, 
iHeight
, 
ch™√lTy≥
 );

473 
	}
}

478 
Boﬁ
 
	gTComPªdi˘i⁄
::
	$xCheckIdítiˇlMŸi⁄
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
P¨tAddr
 )

480 if–
pcCU
->
	`gëSli˚
()->
	`isI¡îB
(Ë&& !pcCU->gëSli˚()->
	`gëPPS
()->
	`gëWPBiPªd
() )

482 if–
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëRefIdx
(
P¨tAddr
Ë>0 &&ÖcCU->gëCUMvFõld(
REF_PIC_LIST_1
)->getRefIdx(PartAddr) >= 0)

484 
I¡
 
RefPOCL0
 = 
pcCU
->
	`gëSli˚
()->
	`gëRefPic
(
REF_PIC_LIST_0
,ÖcCU->
	`gëCUMvFõld
(REF_PIC_LIST_0)->
	`gëRefIdx
(
P¨tAddr
))->
	`gëPOC
();

485 
I¡
 
RefPOCL1
 = 
pcCU
->
	`gëSli˚
()->
	`gëRefPic
(
REF_PIC_LIST_1
,ÖcCU->
	`gëCUMvFõld
(REF_PIC_LIST_1)->
	`gëRefIdx
(
P¨tAddr
))->
	`gëPOC
();

486 if(
RefPOCL0
 =
RefPOCL1
 && 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëMv
(
P¨tAddr
Ë=pcCU->gëCUMvFõld(
REF_PIC_LIST_1
)->getMv(PartAddr))

488  
åue
;

492  
Ál£
;

493 
	}
}

495 
Void
 
	gTComPªdi˘i⁄
::
	$mŸi⁄Com≥nßti⁄
 ( 
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcYuvPªd
, 
RefPicLi°
 
eRefPicLi°
, 
I¡
 
iP¨tIdx
 )

497 
I¡
 
iWidth
;

498 
I¡
 
iHeight
;

499 
UI¡
 
uiP¨tAddr
;

500 c⁄° 
TComSli˚
 *
pSli˚
 = 
pcCU
->
	`gëSli˚
();

501 c⁄° 
Sli˚Ty≥
 
¶i˚Ty≥
 = 
pSli˚
->
	`gëSli˚Ty≥
();

502 c⁄° 
TComPPS
 &
µs
 = *(
pSli˚
->
	`gëPPS
());

504 i‡–
iP¨tIdx
 >= 0 )

506 
pcCU
->
	`gëP¨tIndexAndSize
–
iP¨tIdx
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
 );

507 i‡–
eRefPicLi°
 !
REF_PIC_LIST_X
 )

509 if–(
¶i˚Ty≥
 =
P_SLICE
 && 
µs
.
	`gëU£WP
()Ë|| (¶i˚Ty≥ =
B_SLICE
 &&Öps.
	`gëWPBiPªd
()))

511 
	`xPªdI¡îUni
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
, 
pcYuvPªd
, 
åue
 );

512 
	`xWeighãdPªdi˘i⁄Uni
–
pcCU
, 
pcYuvPªd
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
,ÖcYuvPred );

516 
	`xPªdI¡îUni
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
, 
pcYuvPªd
 );

521 i‡–
	`xCheckIdítiˇlMŸi⁄
–
pcCU
, 
uiP¨tAddr
 ) )

523 
	`xPªdI¡îUni
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
REF_PIC_LIST_0
, 
pcYuvPªd
 );

527 
	`xPªdI¡îBi
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
pcYuvPªd
 );

533  
iP¨tIdx
 = 0; iP¨tIdx < 
pcCU
->
	`gëNumP¨tôi⁄s
(); iPartIdx++ )

535 
pcCU
->
	`gëP¨tIndexAndSize
–
iP¨tIdx
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
 );

537 i‡–
eRefPicLi°
 !
REF_PIC_LIST_X
 )

539 if–(
¶i˚Ty≥
 =
P_SLICE
 && 
µs
.
	`gëU£WP
()Ë|| (¶i˚Ty≥ =
B_SLICE
 &&Öps.
	`gëWPBiPªd
()))

541 
	`xPªdI¡îUni
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
, 
pcYuvPªd
, 
åue
 );

542 
	`xWeighãdPªdi˘i⁄Uni
–
pcCU
, 
pcYuvPªd
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
,ÖcYuvPred );

546 
	`xPªdI¡îUni
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
, 
pcYuvPªd
 );

551 i‡–
	`xCheckIdítiˇlMŸi⁄
–
pcCU
, 
uiP¨tAddr
 ) )

553 
	`xPªdI¡îUni
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
REF_PIC_LIST_0
, 
pcYuvPªd
 );

557 
	`xPªdI¡îBi
 (
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
pcYuvPªd
 );

562 
	}
}

564 
Void
 
	gTComPªdi˘i⁄
::
	$xPªdI¡îUni
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tAddr
, 
I¡
 
iWidth
, I¡ 
iHeight
, 
RefPicLi°
 
eRefPicLi°
, 
TComYuv
* 
pcYuvPªd
, 
Boﬁ
 
bi
 )

566 
I¡
 
iRefIdx
 = 
pcCU
->
	`gëCUMvFõld
–
eRefPicLi°
 )->
	`gëRefIdx
–
uiP¨tAddr
 ); 
	`as£π
 (iRefIdx >= 0);

567 
TComMv
 
cMv
 = 
pcCU
->
	`gëCUMvFõld
–
eRefPicLi°
 )->
	`gëMv
–
uiP¨tAddr
 );

568 
pcCU
->
	`˛ùMv
(
cMv
);

570 
UI¡
 
comp
=
COMPONENT_Y
; comp<
pcYuvPªd
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

572 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

573 
	`xPªdI¡îBlk
 (
compID
, 
pcCU
,ÖcCU->
	`gëSli˚
()->
	`gëRefPic
–
eRefPicLi°
, 
iRefIdx
 )->
	`gëPicYuvRec
(), 
uiP¨tAddr
, &
cMv
, 
iWidth
, 
iHeight
, 
pcYuvPªd
, 
bi
,ÖcCU->gëSli˚()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(compID)) );

575 
	}
}

577 
Void
 
	gTComPªdi˘i⁄
::
	$xPªdI¡îBi
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tAddr
, 
I¡
 
iWidth
, I¡ 
iHeight
, 
TComYuv
* 
pcYuvPªd
 )

579 
TComYuv
* 
pcMbYuv
;

580 
I¡
 
iRefIdx
[
NUM_REF_PIC_LIST_01
] = {-1, -1};

582  
UI¡
 
ªfLi°
 = 0;ÑefLi° < 
NUM_REF_PIC_LIST_01
;ÑefList++ )

584 
RefPicLi°
 
eRefPicLi°
 = (
ªfLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
);

585 
iRefIdx
[
ªfLi°
] = 
pcCU
->
	`gëCUMvFõld
–
eRefPicLi°
 )->
	`gëRefIdx
–
uiP¨tAddr
 );

587 i‡–
iRefIdx
[
ªfLi°
] < 0 )

592 
	`as£π
–
iRefIdx
[
ªfLi°
] < 
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
eRefPicLi°
) );

594 
pcMbYuv
 = &
m_acYuvPªd
[
ªfLi°
];

595 if–
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_0
 )->
	`gëRefIdx
–
uiP¨tAddr
 ) >0 &&ÖcCU->gëCUMvFõld–
REF_PIC_LIST_1
 )->getRefIdx( uiPartAddr ) >= 0 )

597 
	`xPªdI¡îUni
 ( 
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
, 
pcMbYuv
, 
åue
 );

601 i‡––
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£WP
(Ë&&ÖcCU->gëSli˚()->
	`gëSli˚Ty≥
(Ë=
P_SLICE
 ) ||

602 –
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëWPBiPªd
(Ë&&ÖcCU->gëSli˚()->
	`gëSli˚Ty≥
(Ë=
B_SLICE
 ) )

604 
	`xPªdI¡îUni
 ( 
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
, 
pcMbYuv
, 
åue
 );

608 
	`xPªdI¡îUni
 ( 
pcCU
, 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
eRefPicLi°
, 
pcMbYuv
 );

613 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëWPBiPªd
(Ë&&ÖcCU->gëSli˚()->
	`gëSli˚Ty≥
(Ë=
B_SLICE
 )

615 
	`xWeighãdPªdi˘i⁄Bi
–
pcCU
, &
m_acYuvPªd
[
REF_PIC_LIST_0
], &m_acYuvPªd[
REF_PIC_LIST_1
], 
iRefIdx
[REF_PIC_LIST_0], iRefIdx[REF_PIC_LIST_1], 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
pcYuvPªd
 );

617 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£WP
(Ë&&ÖcCU->gëSli˚()->
	`gëSli˚Ty≥
(Ë=
P_SLICE
 )

619 
	`xWeighãdPªdi˘i⁄Uni
–
pcCU
, &
m_acYuvPªd
[
REF_PIC_LIST_0
], 
uiP¨tAddr
, 
iWidth
, 
iHeight
, REF_PIC_LIST_0, 
pcYuvPªd
 );

623 
	`xWeighãdAvîage
–&
m_acYuvPªd
[
REF_PIC_LIST_0
], &m_acYuvPªd[
REF_PIC_LIST_1
], 
iRefIdx
[REF_PIC_LIST_0], iRefIdx[REF_PIC_LIST_1], 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
pcYuvPªd
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïths
() );

625 
	}
}

643 
Void
 
	gTComPªdi˘i⁄
::
	$xPªdI¡îBlk
(c⁄° 
Comp⁄ítID
 
compID
, 
TComD©aCU
 *
cu
, 
TComPicYuv
 *
ªfPic
, 
UI¡
 
∑πAddr
, 
TComMv
 *
mv
, 
I¡
 
width
, I¡ 
height
, 
TComYuv
 *
d°Pic
, 
Boﬁ
 
bi
, c⁄° I¡ 
bôDïth
 )

645 
I¡
 
ªfSåide
 = 
ªfPic
->
	`gëSåide
(
compID
);

646 
I¡
 
d°Såide
 = 
d°Pic
->
	`gëSåide
(
compID
);

647 
I¡
 
shi·H‹
=(2+
ªfPic
->
	`gëComp⁄ítSˇÀX
(
compID
));

648 
I¡
 
shi·Vî
=(2+
ªfPic
->
	`gëComp⁄ítSˇÀY
(
compID
));

650 
I¡
 
ªfOff£t
 = (
mv
->
	`gëH‹
(Ë>> 
shi·H‹
Ë+ (mv->
	`gëVî
(Ë>> 
shi·Vî
Ë* 
ªfSåide
;

652 
Pñ
* 
ªf
 = 
ªfPic
->
	`gëAddr
(
compID
, 
cu
->
	`gëCtuRsAddr
(), cu->
	`gëZ‹dîIdxInCtu
(Ë+ 
∑πAddr
 ) + 
ªfOff£t
;

654 
Pñ
* 
d°
 = 
d°Pic
->
	`gëAddr
–
compID
, 
∑πAddr
 );

656 
I¡
 
xFøc
 = 
mv
->
	`gëH‹
(Ë& ((1<<
shi·H‹
)-1);

657 
I¡
 
yFøc
 = 
mv
->
	`gëVî
(Ë& ((1<<
shi·Vî
)-1);

658 
UI¡
 
cxWidth
 = 
width
 >> 
ªfPic
->
	`gëComp⁄ítSˇÀX
(
compID
);

659 
UI¡
 
cxHeight
 = 
height
 >> 
ªfPic
->
	`gëComp⁄ítSˇÀY
(
compID
);

661 c⁄° 
ChromaF‹m©
 
chFmt
 = 
cu
->
	`gëPic
()->
	`gëChromaF‹m©
();

663 i‡–
yFøc
 == 0 )

665 
m_if
.
	`fûãrH‹
(
compID
, 
ªf
, 
ªfSåide
, 
d°
, 
d°Såide
, 
cxWidth
, 
cxHeight
, 
xFøc
, !
bi
, 
chFmt
, 
bôDïth
);

667 i‡–
xFøc
 == 0 )

669 
m_if
.
	`fûãrVî
(
compID
, 
ªf
, 
ªfSåide
, 
d°
, 
d°Såide
, 
cxWidth
, 
cxHeight
, 
yFøc
, 
åue
, !
bi
, 
chFmt
, 
bôDïth
);

673 
I¡
 
tmpSåide
 = 
m_fûãªdBlockTmp
[0].
	`gëSåide
(
compID
);

674 
Pñ
* 
tmp
 = 
m_fûãªdBlockTmp
[0].
	`gëAddr
(
compID
);

676 c⁄° 
I¡
 
vFûãrSize
 = 
	`isLuma
(
compID
Ë? 
NTAPS_LUMA
 : 
NTAPS_CHROMA
;

678 
m_if
.
	`fûãrH‹
(
compID
, 
ªf
 - ((
vFûãrSize
>>1Ë-1)*
ªfSåide
,ÑefSåide, 
tmp
, 
tmpSåide
, 
cxWidth
, 
cxHeight
+vFûãrSize-1, 
xFøc
, 
Ál£
, 
chFmt
, 
bôDïth
);

679 
m_if
.
	`fûãrVî
(
compID
, 
tmp
 + ((
vFûãrSize
>>1Ë-1)*
tmpSåide
,ÅmpSåide, 
d°
, 
d°Såide
, 
cxWidth
, 
cxHeight
, 
yFøc
, 
Ál£
, !
bi
, 
chFmt
, 
bôDïth
);

681 
	}
}

683 
Void
 
	gTComPªdi˘i⁄
::
	$xWeighãdAvîage
–
TComYuv
* 
pcYuvSrc0
, TComYuv* 
pcYuvSrc1
, 
I¡
 
iRefIdx0
, I¡ 
iRefIdx1
, 
UI¡
 
uiP¨tIdx
, I¡ 
iWidth
, I¡ 
iHeight
, TComYuv* 
pcYuvD°
, c⁄° 
BôDïths
 &
˛ùBôDïths
 )

685 if–
iRefIdx0
 >0 && 
iRefIdx1
 >= 0 )

687 
pcYuvD°
->
	`addAvg
–
pcYuvSrc0
, 
pcYuvSrc1
, 
uiP¨tIdx
, 
iWidth
, 
iHeight
, 
˛ùBôDïths
 );

689 i‡–
iRefIdx0
 >0 && 
iRefIdx1
 < 0 )

691 
pcYuvSrc0
->
	`c›yP¨tToP¨tYuv
–
pcYuvD°
, 
uiP¨tIdx
, 
iWidth
, 
iHeight
 );

693 i‡–
iRefIdx0
 < 0 && 
iRefIdx1
 >= 0 )

695 
pcYuvSrc1
->
	`c›yP¨tToP¨tYuv
–
pcYuvD°
, 
uiP¨tIdx
, 
iWidth
, 
iHeight
 );

697 
	}
}

700 
Void
 
	gTComPªdi˘i⁄
::
	$gëMvPªdAMVP
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdx
, UI¡ 
uiP¨tAddr
, 
RefPicLi°
 
eRefPicLi°
, 
TComMv
& 
rcMvPªd
 )

702 
AMVPInfo
* 
pcAMVPInfo
 = 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëAMVPInfo
();

704 if–
pcAMVPInfo
->
iN
 <= 1 )

706 
rcMvPªd
 = 
pcAMVPInfo
->
m_acMvC™d
[0];

708 
pcCU
->
	`£tMVPIdxSubP¨ts
–0, 
eRefPicLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

709 
pcCU
->
	`£tMVPNumSubP¨ts
–
pcAMVPInfo
->
iN
, 
eRefPicLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

713 
	`as£π
(
pcCU
->
	`gëMVPIdx
(
eRefPicLi°
,
uiP¨tAddr
) >= 0);

714 
rcMvPªd
 = 
pcAMVPInfo
->
m_acMvC™d
[
pcCU
->
	`gëMVPIdx
(
eRefPicLi°
,
uiP¨tAddr
)];

716 
	}
}

731 
Void
 
	gTComPªdi˘i⁄
::
	$xPªdI¡øPœ«r
–c⁄° 
Pñ
* 
pSrc
, 
I¡
 
§cSåide
, Pñ* 
ΩD°
, I¡ 
d°Såide
, 
UI¡
 
width
, UI¡ 
height
 )

733 
	`as£π
(
width
 <
height
);

735 
I¡
 
À·Cﬁumn
[
MAX_CU_SIZE
+1] = {0};

736 
I¡
 
t›Row
[
MAX_CU_SIZE
+1] = {0};

737 
I¡
 
bŸtomRow
[
MAX_CU_SIZE
] = {0};

738 
I¡
 
rightCﬁumn
[
MAX_CU_SIZE
] = {0};

739 
UI¡
 
shi·1Dh‹
 = 
g_aucC⁄vîtToBô
[ 
width
 ] + 2;

740 
UI¡
 
shi·1Dvî
 = 
g_aucC⁄vîtToBô
[ 
height
 ] + 2;

743 
I¡
 
k
=0;k<
width
+1;k++)

745 
t›Row
[
k
] = 
pSrc
[k-
§cSåide
];

748 
I¡
 
k
=0; k < 
height
+1; k++)

750 
À·Cﬁumn
[
k
] = 
pSrc
[k*
§cSåide
-1];

754 
I¡
 
bŸtomLe·
 = 
À·Cﬁumn
[
height
];

755 
I¡
 
t›Right
 = 
t›Row
[
width
];

757 
I¡
 
k
=0;k<
width
;k++)

759 
bŸtomRow
[
k
] = 
bŸtomLe·
 - 
t›Row
[k];

760 
t›Row
[
k
] <<
shi·1Dvî
;

763 
I¡
 
k
=0;k<
height
;k++)

765 
rightCﬁumn
[
k
] = 
t›Right
 - 
À·Cﬁumn
[k];

766 
À·Cﬁumn
[
k
] <<
shi·1Dh‹
;

769 c⁄° 
UI¡
 
t›RowShi·
 = 0;

772 
I¡
 
y
=0;y<
height
;y++)

774 
I¡
 
h‹Pªd
 = 
À·Cﬁumn
[
y
] + 
width
;

775 
I¡
 
x
=0;x<
width
;x++)

777 
h‹Pªd
 +
rightCﬁumn
[
y
];

778 
t›Row
[
x
] +
bŸtomRow
[x];

780 
I¡
 
vîtPªd
 = ((
t›Row
[
x
] + 
t›RowShi·
)>>topRowShift);

781 
ΩD°
[
y
*
d°Såide
+
x
] = ( 
h‹Pªd
 + 
vîtPªd
 ) >> (
shi·1Dh‹
+1);

784 
	}
}

797 
Void
 
	gTComPªdi˘i⁄
::
	$xDCPªdFûãrög
–c⁄° 
Pñ
* 
pSrc
, 
I¡
 
iSrcSåide
, Pñ* 
pD°
, I¡ 
iD°Såide
, I¡ 
iWidth
, I¡ 
iHeight
, 
Ch™√lTy≥
 
ch™√lTy≥
 )

799 
I¡
 
x
, 
y
, 
iD°Såide2
, 
iSrcSåide2
;

801 i‡(
	`isLuma
(
ch™√lTy≥
Ë&& (
iWidth
 <
MAXIMUM_INTRA_FILTERED_WIDTH
Ë&& (
iHeight
 <
MAXIMUM_INTRA_FILTERED_HEIGHT
))

804 
pD°
[0] = (
Pñ
)((
pSrc
[-
iSrcSåide
] +ÖSrc[-1] + 2 *ÖDst[0] + 2) >> 2);

807  
x
 = 1; x < 
iWidth
; x++ )

809 
pD°
[
x
] = (
Pñ
)((
pSrc
[x - 
iSrcSåide
] + 3 *ÖDst[x] + 2) >> 2);

813  
y
 = 1, 
iD°Såide2
 = 
iD°Såide
, 
iSrcSåide2
 = 
iSrcSåide
-1; y < 
iHeight
; y++, iDstStride2+=iDstStride, iSrcStride2+=iSrcStride )

815 
pD°
[
iD°Såide2
] = (
Pñ
)((
pSrc
[
iSrcSåide2
] + 3 *ÖDst[iDstStride2] + 2) >> 2);

820 
	}
}

823 
Boﬁ
 
	gTComPªdi˘i⁄
::
	$U£DPCMF‹Fú°PassI¡øE°im©i⁄
(
TComTU
 &
rTu
, c⁄° 
UI¡
 
uiDúMode
)

825  (
rTu
.
	`gëCU
()->
	`isRDPCME«bÀd
‘Tu.
	`GëAbsP¨tIdxTU
()) ) &&

826 
rTu
.
	`gëCU
()->
	`gëCUTønsqu™tBy∑ss
‘Tu.
	`GëAbsP¨tIdxTU
()) &&

827 (
uiDúMode
==
HOR_IDX
 || uiDúMode==
VER_IDX
);

828 
	}
}

830 #i‡
MCTS_ENC_CHECK


832 
Void
 
	$gëRefPUP¨tPos
(
TComD©aCU
* 
pcCU
, 
TComMv
& 
cMv
, 
I¡
 
uiP¨tIdx
, I¡& 
ruiPªdXLe·
, I¡& 
ruiPªdYT›
, I¡& 
ruiPªdXRight
, I¡& 
ruiPªdYBŸtom
, I¡ 
iWidth
, I¡ 
iHeight
)

834 
ruiPªdXLe·
 = 
pcCU
->
	`gëCUPñX
();

835 
ruiPªdYT›
 = 
pcCU
->
	`gëCUPñY
();

837 
pcCU
->
	`gëP¨tôi⁄Size
(0))

839 
SIZE_2NxN
:

840 i‡(
uiP¨tIdx
 == 0)

842 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

843 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

847 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

848 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + (
iHeight
 << 1);

849 
ruiPªdYT›
 +
iHeight
;

852 
SIZE_Nx2N
:

853 i‡(
uiP¨tIdx
 == 0)

855 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

856 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

860 
ruiPªdXRight
 = 
ruiPªdXLe·
 + (
iWidth
 << 1);

861 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

862 
ruiPªdXLe·
 +
iWidth
;

865 
SIZE_NxN
:

866 i‡(
uiP¨tIdx
 == 0)

868 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

869 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

871 i‡(
uiP¨tIdx
 == 1)

873 
ruiPªdXRight
 = 
ruiPªdXLe·
 + (
iWidth
 << 1);

874 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

875 
ruiPªdXLe·
 +
iWidth
;

877 i‡(
uiP¨tIdx
 == 2)

879 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

880 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + (
iHeight
 << 1);

881 
ruiPªdYT›
 +
iHeight
;

883 i‡(
uiP¨tIdx
 == 3)

885 
ruiPªdXRight
 = 
ruiPªdXLe·
 + (
iWidth
 << 1);

886 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + (
iHeight
 << 1);

887 
ruiPªdXLe·
 +
iWidth
;

888 
ruiPªdYT›
 +
iHeight
;

891 
SIZE_2NxnU
:

892 i‡(
uiP¨tIdx
 == 0)

894 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

895 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

899 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

900 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
pcCU
->
	`gëHeight
(0);

901 
ruiPªdYT›
 +(
iHeight
 / 3);

904 
SIZE_2NxnD
:

905 i‡(
uiP¨tIdx
 == 0)

907 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

908 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

912 
I¡
 
‹iHeight
 = 
iHeight
 << 2;

913 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

914 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
‹iHeight
;

915 
ruiPªdYT›
 +(
‹iHeight
 >> 2) + (oriHeight >> 1);

918 
SIZE_nLx2N
:

919 i‡(
uiP¨tIdx
 == 0)

921 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

922 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

926 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
pcCU
->
	`gëWidth
(0);

927 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

928 
ruiPªdXLe·
 +(
iWidth
 / 3);

931 
SIZE_nRx2N
:

932 i‡(
uiP¨tIdx
 == 0)

934 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

935 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

939 
I¡
 
‹iWidth
 = (
iWidth
 << 2);

940 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
‹iWidth
;

941 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

942 
ruiPªdXLe·
 +(
‹iWidth
 >> 2) + (oriWidth >> 1);

946 
ruiPªdXRight
 = 
ruiPªdXLe·
 + 
iWidth
;

947 
ruiPªdYBŸtom
 = 
ruiPªdYT›
 + 
iHeight
;

951 
ruiPªdXLe·
 +(
cMv
.
	`gëH‹
() >> 2);

952 
ruiPªdYT›
 +(
cMv
.
	`gëVî
() >> 2);

953 
ruiPªdXRight
 +(
cMv
.
	`gëH‹
() >> 2) - 1;

954 
ruiPªdYBŸtom
 +(
cMv
.
	`gëVî
() >> 2) - 1;

955 
	}
}

957 
Boﬁ
 
	$checkMVPR™ge
(
TComMv
& 
cMv
, 
UI¡
 
˘uLígth
, UI¡ 
tûeXPosInCtus
, UI¡ 
tûeYPosInCtus
, UI¡ 
tûeWidthtInCtus
, UI¡ 
tûeHeightInCtus
, 
I¡
 
PªdXLe·
, I¡ 
PªdXRight
, I¡ 
PªdYT›
, I¡ 
PªdYBŸtom
, 
ChromaF‹m©
 
chromaF‹m©
)

960 c⁄° 
UI¡
 
LumaLTSam∂eOff£t
 = 3;

961 c⁄° 
UI¡
 
LumaRBSam∂eOff£t
 = 4;

962 c⁄° 
UI¡
 
CromaLTSam∂eoff£t
 = 1;

963 c⁄° 
UI¡
 
CromaRBSam∂eoff£t
 = 2;

966 c⁄° 
I¡
 
À·T›PñPosX
 = 
˘uLígth
 * 
tûeXPosInCtus
;

967 c⁄° 
I¡
 
À·T›PñPosY
 = 
˘uLígth
 * 
tûeYPosInCtus
;

968 c⁄° 
I¡
 
rightBŸtomPñPosX
 = ((
tûeWidthtInCtus
 + 
tûeXPosInCtus
Ë* 
˘uLígth
) - 1;

969 c⁄° 
I¡
 
rightBŸtomPñPosY
 = ((
tûeHeightInCtus
 + 
tûeYPosInCtus
Ë* 
˘uLígth
) - 1;

972 c⁄° 
Boﬁ
 
isFuŒPñH‹Luma
 = (
cMv
.
	`gëH‹
() % 4 == 0);

973 c⁄° 
Boﬁ
 
isFuŒPñVîLuma
 = (
cMv
.
	`gëVî
() % 4 == 0);

975 c⁄° 
I¡
 
lR™geXLe·
 = 
À·T›PñPosX
 + (
isFuŒPñH‹Luma
 ? 0 : 
LumaLTSam∂eOff£t
);

976 c⁄° 
I¡
 
lR™geYT›
 = 
À·T›PñPosY
 + (
isFuŒPñVîLuma
 ? 0 : 
LumaLTSam∂eOff£t
);

977 c⁄° 
I¡
 
lR™geXRight
 = 
rightBŸtomPñPosX
 - (
isFuŒPñH‹Luma
 ? 0 : 
LumaRBSam∂eOff£t
);

978 c⁄° 
I¡
 
lR™geYBŸtom
 = 
rightBŸtomPñPosY
 - (
isFuŒPñVîLuma
 ? 0 : 
LumaRBSam∂eOff£t
);

980 i‡(!(
PªdXLe·
 >
lR™geXLe·
 && PªdXLe· <
lR™geXRight
Ë|| !(
PªdXRight
 >=ÜRangeXLeft && PredXRight <=ÜRangeXRight))

982  
Ál£
;

984 i‡(!(
PªdYT›
 >
lR™geYT›
 && PªdYT› <
lR™geYBŸtom
Ë|| !(
PªdYBŸtom
 >=ÜRangeYTop && PredYBottom <=ÜRangeYBottom))

986  
Ál£
;

989 i‡((
chromaF‹m©
 !
CHROMA_444
Ë&& (chromaF‹m© !
CHROMA_400
))

992 c⁄° 
Boﬁ
 
isFuŒPñH‹Chroma
 = (
cMv
.
	`gëH‹
() % 8 == 0);

993 c⁄° 
Boﬁ
 
isFuŒPñVîChroma
 = (
cMv
.
	`gëVî
() % 8 == 0);

995 c⁄° 
I¡
 
cR™geXLe·
 = 
À·T›PñPosX
 + (
isFuŒPñH‹Chroma
 ? 0 : 
CromaLTSam∂eoff£t
);

996 c⁄° 
I¡
 
cR™geYT›
 = 
À·T›PñPosY
 + (
isFuŒPñVîChroma
 ? 0 : 
CromaLTSam∂eoff£t
);

997 c⁄° 
I¡
 
cR™geXRight
 = 
rightBŸtomPñPosX
 - (
isFuŒPñH‹Chroma
 ? 0 : 
CromaRBSam∂eoff£t
);

998 c⁄° 
I¡
 
cR™geYBŸtom
 = 
rightBŸtomPñPosY
 - (
isFuŒPñVîChroma
 ? 0 : 
CromaRBSam∂eoff£t
);

1000 i‡(!(
PªdXLe·
 >
cR™geXLe·
 && PªdXLe· <
cR™geXRight
Ë|| !(
PªdXRight
 >= cRangeXLeft && PredXRight <= cRangeXRight))

1002  
Ál£
;

1004 i‡((!(
PªdYT›
 >
cR™geYT›
 && PªdYT› <
cR™geYBŸtom
Ë|| !(
PªdYBŸtom
 >cR™geYT› && PªdYBŸtom <cR™geYBŸtom)Ë&& (
chromaF‹m©
 !
CHROMA_422
))

1006  
Ál£
;

1010  
åue
;

1011 
	}
}

1013 
Boﬁ
 
	gTComPªdi˘i⁄
::
	$checkTM˘sMvp
(
TComD©aCU
* 
pcCU
, 
I¡
 
∑πIdx
)

1015 
I¡
 
∑πWidth
 = 0;

1016 
I¡
 
∑πHeight
 = 0;

1017 
UI¡
 
∑πAddr
 = 0;

1019 
UI¡
 
tûeXPosInCtus
 = 0;

1020 
UI¡
 
tûeYPosInCtus
 = 0;

1021 
UI¡
 
tûeWidthtInCtus
 = 0;

1022 
UI¡
 
tûeHeightInCtus
 = 0;

1024 
	`gëTûePosôi⁄
(
pcCU
, 
tûeXPosInCtus
, 
tûeYPosInCtus
, 
tûeWidthtInCtus
, 
tûeHeightInCtus
);

1026 c⁄° 
UI¡
 
˘uLígth
 = 
pcCU
->
	`gëPic
()->
	`gëPicSym
()->
	`gëSPS
().
	`gëMaxCUWidth
();

1027 c⁄° 
ChromaF‹m©
 
chromaF‹m©
 = 
pcCU
->
	`gëPic
()->
	`gëPicSym
()->
	`gëSPS
().
	`gëChromaF‹m©Idc
();

1029 
I¡
 
¥edXLe·
;

1030 
I¡
 
¥edYT›
;

1031 
I¡
 
¥edXRight
;

1032 
I¡
 
¥edYBŸtom
;

1034 i‡(
∑πIdx
 >= 0)

1036 
pcCU
->
	`gëP¨tIndexAndSize
(
∑πIdx
, 
∑πAddr
, 
∑πWidth
, 
∑πHeight
);

1038 i‡(
	`xCheckIdítiˇlMŸi⁄
(
pcCU
, 
∑πAddr
))

1040 
RefPicLi°
 
eRefPicLi°
 = 
REF_PIC_LIST_0
;

1041 
TComMv
 
cMv
 = 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëMv
(
∑πAddr
);

1042 
	`gëRefPUP¨tPos
(
pcCU
, 
cMv
, 
∑πIdx
, 
¥edXLe·
, 
¥edYT›
, 
¥edXRight
, 
¥edYBŸtom
, 
∑πWidth
, 
∑πHeight
);

1043 i‡(!
	`checkMVPR™ge
(
cMv
, 
˘uLígth
, 
tûeXPosInCtus
, 
tûeYPosInCtus
, 
tûeWidthtInCtus
, 
tûeHeightInCtus
, 
¥edXLe·
, 
¥edXRight
, 
¥edYT›
, 
¥edYBŸtom
, 
chromaF‹m©
))

1045  
Ál£
;

1050 
UI¡
 
ªfLi°
 = 0;ÑefLi° < 
NUM_REF_PIC_LIST_01
;ÑefList++)

1052 
RefPicLi°
 
eRefPicLi°
 = (
ªfLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
);

1054 
TComMv
 
cMv
 = 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëMv
(
∑πAddr
);

1055 
	`gëRefPUP¨tPos
(
pcCU
, 
cMv
, 
∑πIdx
, 
¥edXLe·
, 
¥edYT›
, 
¥edXRight
, 
¥edYBŸtom
, 
∑πWidth
, 
∑πHeight
);

1056 i‡(!
	`checkMVPR™ge
(
cMv
, 
˘uLígth
, 
tûeXPosInCtus
, 
tûeYPosInCtus
, 
tûeWidthtInCtus
, 
tûeHeightInCtus
, 
¥edXLe·
, 
¥edXRight
, 
¥edYT›
, 
¥edYBŸtom
, 
chromaF‹m©
))

1058  
Ál£
;

1062  
åue
;

1065 
∑πIdx
 = 0;Ö¨tIdx < 
pcCU
->
	`gëNumP¨tôi⁄s
();ÖartIdx++)

1067 
pcCU
->
	`gëP¨tIndexAndSize
(
∑πIdx
, 
∑πAddr
, 
∑πWidth
, 
∑πHeight
);

1069 i‡(
	`xCheckIdítiˇlMŸi⁄
(
pcCU
, 
∑πAddr
))

1071 
RefPicLi°
 
eRefPicLi°
 = 
REF_PIC_LIST_0
;

1072 
TComMv
 
cMv
 = 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëMv
(
∑πAddr
);

1073 
	`gëRefPUP¨tPos
(
pcCU
, 
cMv
, 
∑πIdx
, 
¥edXLe·
, 
¥edYT›
, 
¥edXRight
, 
¥edYBŸtom
, 
∑πWidth
, 
∑πHeight
);

1074 i‡(!
	`checkMVPR™ge
(
cMv
, 
˘uLígth
, 
tûeXPosInCtus
, 
tûeYPosInCtus
, 
tûeWidthtInCtus
, 
tûeHeightInCtus
, 
¥edXLe·
, 
¥edXRight
, 
¥edYT›
, 
¥edYBŸtom
, 
chromaF‹m©
))

1076  
Ál£
;

1081 
UI¡
 
ªfLi°
 = 0;ÑefLi° < 
NUM_REF_PIC_LIST_01
;ÑefList++)

1083 
RefPicLi°
 
eRefPicLi°
 = (
ªfLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
);

1085 
TComMv
 
cMv
 = 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëMv
(
∑πAddr
);

1086 
	`gëRefPUP¨tPos
(
pcCU
, 
cMv
, 
∑πIdx
, 
¥edXLe·
, 
¥edYT›
, 
¥edXRight
, 
¥edYBŸtom
, 
∑πWidth
, 
∑πHeight
);

1087 i‡(!
	`checkMVPR™ge
(
cMv
, 
˘uLígth
, 
tûeXPosInCtus
, 
tûeYPosInCtus
, 
tûeWidthtInCtus
, 
tûeHeightInCtus
, 
¥edXLe·
, 
¥edXRight
, 
¥edYT›
, 
¥edYBŸtom
, 
chromaF‹m©
))

1089  
Ál£
;

1094  
åue
;

1095 
	}
}

	@TLibCommon/TComPrediction.h

38 #i‚de‡
__TCOMPREDICTION__


39 
	#__TCOMPREDICTION__


	)

43 
	~"TComYuv.h
"

44 
	~"TComI¡îpﬁ©i⁄Fûãr.h
"

45 
	~"TComWeightPªdi˘i⁄.h
"

48 
˛ass
 
	gTComMv
;

49 
˛ass
 
	gTComTU
;

59 
	ePRED_BUF_E


61 
	mPRED_BUF_UNFILTERED
=0,

62 
	mPRED_BUF_FILTERED
=1,

63 
	mNUM_PRED_BUF
=2

64 } 
	tPRED_BUF
;

66 c⁄° 
UI¡
 
	gMAX_INTRA_FILTER_DEPTHS
=5;

68 ˛as†
	cTComPªdi˘i⁄
 : 
public
 
TComWeightPªdi˘i⁄


70 
¥iv©e
:

71 c⁄° 
UCh¨
 
m_aucI¡øFûãr
[
MAX_NUM_CHANNEL_TYPE
][
MAX_INTRA_FILTER_DEPTHS
];

73 
	m¥Ÿe˘ed
:

74 
Pñ
* 
m_piYuvExt
[
MAX_NUM_COMPONENT
][
NUM_PRED_BUF
];

75 
I¡
 
	mm_iYuvExtSize
;

77 
TComYuv
 
	mm_acYuvPªd
[
NUM_REF_PIC_LIST_01
];

78 
TComYuv
 
	mm_cYuvPªdTemp
;

79 
TComYuv
 
	mm_fûãªdBlock
[
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
][LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS];

80 
TComYuv
 
	mm_fûãªdBlockTmp
[
LUMA_INTERPOLATION_FILTER_SUB_SAMPLE_POSITIONS
];

82 
TComI¡îpﬁ©i⁄Fûãr
 
	mm_if
;

84 
Pñ
* 
	mm_pLumaRecBuf„r
;

85 
I¡
 
	mm_iLumaRecSåide
;

87 
Void
 
xPªdI¡øAng
 ( 
I¡
 
bôDïth
, c⁄° 
Pñ
* 
pSrc
, I¡ 
§cSåide
, Pñ* 
pD°
, I¡ 
d°Såide
, 
UI¡
 
width
, UI¡ 
height
, 
Ch™√lTy≥
 
ch™√lTy≥
, UI¡ 
dúMode
, c⁄° 
Boﬁ
 
bE«bÀEdgeFûãrs
 );

88 
Void
 
xPªdI¡øPœ«r
 ( c⁄° 
Pñ
* 
pSrc
, 
I¡
 
§cSåide
, Pñ* 
ΩD°
, I¡ 
d°Såide
, 
UI¡
 
width
, UI¡ 
height
 );

91 
Void
 
xPªdI¡îUni
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tAddr
, 
I¡
 
iWidth
, I¡ 
iHeight
, 
RefPicLi°
 
eRefPicLi°
, 
TComYuv
* 
pcYuvPªd
, 
Boﬁ
 
bi
=
Ál£
 );

92 
Void
 
xPªdI¡îBi
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tAddr
, 
I¡
 
iWidth
, I¡ 
iHeight
, 
TComYuv
* 
pcYuvPªd
 );

93 
Void
 
xPªdI¡îBlk
(c⁄° 
Comp⁄ítID
 
compID
, 
TComD©aCU
 *
cu
, 
TComPicYuv
 *
ªfPic
, 
UI¡
 
∑πAddr
, 
TComMv
 *
mv
, 
I¡
 
width
, I¡ 
height
, 
TComYuv
 *
d°Pic
, 
Boﬁ
 
bi
, c⁄° I¡ 
bôDïth
 );

94 
Void
 
xWeighãdAvîage
 ( 
TComYuv
* 
pcYuvSrc0
, TComYuv* 
pcYuvSrc1
, 
I¡
 
iRefIdx0
, I¡ 
iRefIdx1
, 
UI¡
 
uiP¨tAddr
, I¡ 
iWidth
, I¡ 
iHeight
, TComYuv* 
pcYuvD°
, c⁄° 
BôDïths
 &
˛ùBôDïths
 );

96 
Void
 
xGëLLSPªdi˘i⁄
 ( c⁄° 
Pñ
* 
pSrc0
, 
I¡
 
iSrcSåide
, Pñ* 
pD°0
, I¡ 
iD°Såide
, 
UI¡
 
uiWidth
, UI¡ 
uiHeight
, UI¡ 
uiExt0
, c⁄° 
ChromaF‹m©
 
chFmt
 
DEBUG_STRING_FN_DECLARE
(
sDebug
) );

98 
Void
 
xDCPªdFûãrög
–c⁄° 
Pñ
* 
pSrc
, 
I¡
 
iSrcSåide
, Pñ* 
pD°
, I¡ 
iD°Såide
, I¡ 
iWidth
, I¡ 
iHeight
, 
Ch™√lTy≥
 
ch™√lTy≥
 );

99 
Boﬁ
 
xCheckIdítiˇlMŸi⁄
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
P¨tAddr
);

100 
Void
 
de°roy
();

102 
	mpublic
:

103 
TComPªdi˘i⁄
();

104 
	mvútuÆ
 ~
TComPªdi˘i⁄
();

106 
Void
 
öôTempBuff
(
ChromaF‹m©
 
chromaF‹m©IDC
);

108 
ChromaF‹m©
 
	$gëChromaF‹m©
(Ëc⁄° {  
m_cYuvPªdTemp
.
	`gëChromaF‹m©
(); }

111 
Void
 
	`mŸi⁄Com≥nßti⁄
 ( 
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcYuvPªd
, 
RefPicLi°
 
eRefPicLi°
 = 
REF_PIC_LIST_X
, 
I¡
 
iP¨tIdx
 = -1 );

114 
Void
 
	`gëMvPªdAMVP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdx
, UI¡ 
uiP¨tAddr
, 
RefPicLi°
 
eRefPicLi°
, 
TComMv
& 
rcMvPªd
 );

117 
Void
 
	`¥edI¡øAng
 ( c⁄° 
Comp⁄ítID
 
compID
, 
UI¡
 
uiDúMode
, 
Pñ
 *
piOrg
 , UI¡ 
uiOrgSåide
, Pñ* 
piPªd
, UI¡ 
uiSåide
, 
TComTU
 &
rTu
, c⁄° 
Boﬁ
 
bU£FûãªdPªdSam∂es
, c⁄° Boﬁ 
bU£Los¶essDPCM
 = 
Ál£
 );

119 
Pñ
 
	`¥edI¡øGëPªdVÆDC
 ( c⁄° Pñ* 
pSrc
, 
I¡
 
iSrcSåide
, 
UI¡
 
iWidth
, UI¡ 
iHeight
);

121 
Pñ
* 
	$gëPªdi˘‹På
 ( c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
bU£FûãªdPªdi˘i⁄s
 )

123  
m_piYuvExt
[
compID
][
bU£FûãªdPªdi˘i⁄s
?
PRED_BUF_FILTERED
:
PRED_BUF_UNFILTERED
];

124 
	}
}

128 
Void
 
öôI¡øP©ã∫ChTy≥
 ( 
TComTU
 &
rTu
,

129 c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
bFûãrRefSam∂es


130 
DEBUG_STRING_FN_DECLARE
(
sDebug
)

133 
Boﬁ
 
fûãrögI¡øRe„ªn˚Sam∂es
(c⁄° 
Comp⁄ítID
 
compID
, 
UI¡
 
uiDúMode
, UI¡ 
uiTuChWidth
, UI¡ 
uiTuChHeight
, c⁄° 
ChromaF‹m©
 
chFmt
, c⁄° Boﬁ 
öåaRe„ªn˚SmoŸhögDißbÀd
);

135 
Boﬁ
 
U£DPCMF‹Fú°PassI¡øE°im©i⁄
(
TComTU
 &
rTu
, c⁄° 
UI¡
 
uiDúMode
);

137 #i‡
MCTS_ENC_CHECK


138 
Boﬁ
 
checkTM˘sMvp
(
TComD©aCU
* 
pcCU
, 
I¡
 
∑πIdx
 = -1);

	@TLibCommon/TComRdCost.cpp

38 
	~<m©h.h
>

39 
	~<as£π.h
>

40 
	~<limôs
>

41 
	~"TComRom.h
"

42 
	~"TComRdCo°.h
"

44 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

45 
	~<emmöåö.h
>

46 
	~<xmmöåö.h
>

52 
	gTComRdCo°
::
	$TComRdCo°
()

54 
	`öô
();

55 
	}
}

57 
	gTComRdCo°
::~
	$TComRdCo°
()

59 
	}
}

62 
DoubÀ
 
TComRdCo°
::
	$ˇlcRdCo°
–
DoubÀ
 
numBôs
, 
Di°‹ti⁄
 
di°‹ti⁄
, 
DFunc
 
eDFunc
 )

64 
DoubÀ
 
œmbda
 = 1.0;

66  
eDFunc
 )

68 
DF_SSE
:

69 
	`as£π
(0);

71 
DF_SAD
:

72 
œmbda
 = 
m_dLambdaMŸi⁄SAD
[0];

74 
DF_DEFAULT
:

75 
œmbda
 = 
m_dLambda
;

77 
DF_SSE_FRAME
:

78 
œmbda
 = 
m_dFømeLambda
;

81 
	`as£π
 (0);

85 i‡(
eDFunc
 =
DF_SAD
)

87 i‡(
m_co°Mode
 !
COST_STANDARD_LOSSY
)

89  ((
di°‹ti⁄
 * 65536.0Ë/ 
œmbda
Ë+ 
numBôs
;

93  
di°‹ti⁄
 + (((
numBôs
 * 
œmbda
) ) / 65536.0);

98 i‡(
m_co°Mode
 !
COST_STANDARD_LOSSY
)

100  (
di°‹ti⁄
 / 
œmbda
Ë+ 
numBôs
;

104  
di°‹ti⁄
 + (
numBôs
 * 
œmbda
);

107 
	}
}

109 
Void
 
	gTComRdCo°
::
	$£tLambda
–
DoubÀ
 
dLambda
, c⁄° 
BôDïths
 &
bôDïths
 )

111 
m_dLambda
 = 
dLambda
;

112 
m_sqπLambda
 = 
	`sqπ
(
m_dLambda
);

113 
m_dLambdaMŸi⁄SAD
[0] = 65536.0 * 
m_sqπLambda
;

114 
m_dLambdaMŸi⁄SSE
[0] = 65536.0 * 
m_dLambda
;

115 #i‡
FULL_NBIT


116 
dLambda
 = 0.57 * 
	`pow
(2.0, ((
LOSSLESS_AND_MIXED_LOSSLESS_RD_COST_TEST_QP_PRIME
 - 12) / 3.0));

118 
dLambda
 = 0.57 * 
	`pow
(2.0, ((
LOSSLESS_AND_MIXED_LOSSLESS_RD_COST_TEST_QP_PRIME
 - 12 - 6 * (
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_LUMA
] - 8)) / 3.0));

120 
m_dLambdaMŸi⁄SAD
[1] = 65536.0 * 
	`sqπ
(
dLambda
);

121 
m_dLambdaMŸi⁄SSE
[1] = 65536.0 * 
dLambda
;

122 
	}
}

126 
Void
 
	gTComRdCo°
::
	$öô
()

128 
m_aÂDi°‹tFunc
[
DF_DEFAULT
] = 
NULL
;

130 
m_aÂDi°‹tFunc
[
DF_SSE
 ] = 
TComRdCo°
::
xGëSSE
;

131 
m_aÂDi°‹tFunc
[
DF_SSE4
 ] = 
TComRdCo°
::
xGëSSE4
;

132 
m_aÂDi°‹tFunc
[
DF_SSE8
 ] = 
TComRdCo°
::
xGëSSE8
;

133 
m_aÂDi°‹tFunc
[
DF_SSE16
 ] = 
TComRdCo°
::
xGëSSE16
;

134 
m_aÂDi°‹tFunc
[
DF_SSE32
 ] = 
TComRdCo°
::
xGëSSE32
;

135 
m_aÂDi°‹tFunc
[
DF_SSE64
 ] = 
TComRdCo°
::
xGëSSE64
;

136 
m_aÂDi°‹tFunc
[
DF_SSE16N
 ] = 
TComRdCo°
::
xGëSSE16N
;

138 
m_aÂDi°‹tFunc
[
DF_SAD
 ] = 
TComRdCo°
::
xGëSAD
;

139 
m_aÂDi°‹tFunc
[
DF_SAD4
 ] = 
TComRdCo°
::
xGëSAD4
;

140 
m_aÂDi°‹tFunc
[
DF_SAD8
 ] = 
TComRdCo°
::
xGëSAD8
;

141 
m_aÂDi°‹tFunc
[
DF_SAD16
 ] = 
TComRdCo°
::
xGëSAD16
;

142 
m_aÂDi°‹tFunc
[
DF_SAD32
 ] = 
TComRdCo°
::
xGëSAD32
;

143 
m_aÂDi°‹tFunc
[
DF_SAD64
 ] = 
TComRdCo°
::
xGëSAD64
;

144 
m_aÂDi°‹tFunc
[
DF_SAD16N
 ] = 
TComRdCo°
::
xGëSAD16N
;

146 
m_aÂDi°‹tFunc
[
DF_SADS
 ] = 
TComRdCo°
::
xGëSAD
;

147 
m_aÂDi°‹tFunc
[
DF_SADS4
 ] = 
TComRdCo°
::
xGëSAD4
;

148 
m_aÂDi°‹tFunc
[
DF_SADS8
 ] = 
TComRdCo°
::
xGëSAD8
;

149 
m_aÂDi°‹tFunc
[
DF_SADS16
 ] = 
TComRdCo°
::
xGëSAD16
;

150 
m_aÂDi°‹tFunc
[
DF_SADS32
 ] = 
TComRdCo°
::
xGëSAD32
;

151 
m_aÂDi°‹tFunc
[
DF_SADS64
 ] = 
TComRdCo°
::
xGëSAD64
;

152 
m_aÂDi°‹tFunc
[
DF_SADS16N
] = 
TComRdCo°
::
xGëSAD16N
;

154 
m_aÂDi°‹tFunc
[
DF_SAD12
 ] = 
TComRdCo°
::
xGëSAD12
;

155 
m_aÂDi°‹tFunc
[
DF_SAD24
 ] = 
TComRdCo°
::
xGëSAD24
;

156 
m_aÂDi°‹tFunc
[
DF_SAD48
 ] = 
TComRdCo°
::
xGëSAD48
;

158 
m_aÂDi°‹tFunc
[
DF_SADS12
 ] = 
TComRdCo°
::
xGëSAD12
;

159 
m_aÂDi°‹tFunc
[
DF_SADS24
 ] = 
TComRdCo°
::
xGëSAD24
;

160 
m_aÂDi°‹tFunc
[
DF_SADS48
 ] = 
TComRdCo°
::
xGëSAD48
;

162 
m_aÂDi°‹tFunc
[
DF_HADS
 ] = 
TComRdCo°
::
xGëHADs
;

163 
m_aÂDi°‹tFunc
[
DF_HADS4
 ] = 
TComRdCo°
::
xGëHADs
;

164 
m_aÂDi°‹tFunc
[
DF_HADS8
 ] = 
TComRdCo°
::
xGëHADs
;

165 
m_aÂDi°‹tFunc
[
DF_HADS16
 ] = 
TComRdCo°
::
xGëHADs
;

166 
m_aÂDi°‹tFunc
[
DF_HADS32
 ] = 
TComRdCo°
::
xGëHADs
;

167 
m_aÂDi°‹tFunc
[
DF_HADS64
 ] = 
TComRdCo°
::
xGëHADs
;

168 
m_aÂDi°‹tFunc
[
DF_HADS16N
] = 
TComRdCo°
::
xGëHADs
;

170 
m_co°Mode
 = 
COST_STANDARD_LOSSY
;

172 
m_mŸi⁄Lambda
 = 0;

173 
m_iCo°SˇÀ
 = 0;

174 
	}
}

177 
UI¡
 
	gTComRdCo°
::
	$xGëExpGﬁombNumbîOfBôs
–
I¡
 
iVÆ
 )

179 
	`as£π
(
iVÆ
 !
°d
::
numîic_limôs
<
I¡
>::
	`mö
());

180 
UI¡
 
uiLígth
 = 1;

181 
UI¡
 
uiTemp
 = ( 
iVÆ
 <0Ë? (
	`UI¡
(-iVal)<<1)+1: UInt(iVal<<1);

183  1 !
uiTemp
 )

185 
uiTemp
 >>= 1;

186 
uiLígth
 += 2;

189  
uiLígth
;

190 
	}
}

192 
Void
 
	gTComRdCo°
::
	$£tDi°P¨am
–
UI¡
 
uiBlkWidth
, UI¡ 
uiBlkHeight
, 
DFunc
 
eDFunc
, 
Di°P¨am
& 
rcDi°P¨am
 )

195 
rcDi°P¨am
.
iCﬁs
 = 
uiBlkWidth
;

196 
rcDi°P¨am
.
iRows
 = 
uiBlkHeight
;

197 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
eDFunc
 + 
g_aucC⁄vîtToBô
[ÑcDi°P¨am.
iCﬁs
 ] + 1 ];

200 
rcDi°P¨am
.
iSubShi·
 = 0;

201 
rcDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
°d
::
numîic_limôs
<
Di°‹ti⁄
>::
	`max
();

202 
	}
}

205 
Void
 
	gTComRdCo°
::
	$£tDi°P¨am
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, c⁄° 
Pñ
* 
piRefY
, 
I¡
 
iRefSåide
, 
Di°P¨am
& 
rcDi°P¨am
 )

208 
rcDi°P¨am
.
pOrg
 = 
pcP©ã∫Key
->
	`gëROIY
();

209 
rcDi°P¨am
.
pCur
 = 
piRefY
;

211 
rcDi°P¨am
.
iSåideOrg
 = 
pcP©ã∫Key
->
	`gëP©ã∫LSåide
();

212 
rcDi°P¨am
.
iSåideCur
 = 
iRefSåide
;

215 
rcDi°P¨am
.
iCﬁs
 = 
pcP©ã∫Key
->
	`gëROIYWidth
();

216 
rcDi°P¨am
.
iRows
 = 
pcP©ã∫Key
->
	`gëROIYHeight
();

217 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SAD
 + 
g_aucC⁄vîtToBô
[ÑcDi°P¨am.
iCﬁs
 ] + 1 ];

218 
rcDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
°d
::
numîic_limôs
<
Di°‹ti⁄
>::
	`max
();

220 i‡(
rcDi°P¨am
.
iCﬁs
 == 12)

222 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SAD12
];

224 i‡(
rcDi°P¨am
.
iCﬁs
 == 24)

226 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SAD24
];

228 i‡(
rcDi°P¨am
.
iCﬁs
 == 48)

230 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SAD48
];

234 
rcDi°P¨am
.
iSubShi·
 = 0;

235 
	}
}

238 
Void
 
	gTComRdCo°
::
	$£tDi°P¨am
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, c⁄° 
Pñ
* 
piRefY
, 
I¡
 
iRefSåide
, I¡ 
iSãp
, 
Di°P¨am
& 
rcDi°P¨am
, 
Boﬁ
 
bHADME
 )

241 
rcDi°P¨am
.
pOrg
 = 
pcP©ã∫Key
->
	`gëROIY
();

242 
rcDi°P¨am
.
pCur
 = 
piRefY
;

244 
rcDi°P¨am
.
iSåideOrg
 = 
pcP©ã∫Key
->
	`gëP©ã∫LSåide
();

245 
rcDi°P¨am
.
iSåideCur
 = 
iRefSåide
 * 
iSãp
;

248 
rcDi°P¨am
.
iSãp
 = iStep;

251 
rcDi°P¨am
.
iCﬁs
 = 
pcP©ã∫Key
->
	`gëROIYWidth
();

252 
rcDi°P¨am
.
iRows
 = 
pcP©ã∫Key
->
	`gëROIYHeight
();

254 
rcDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
°d
::
numîic_limôs
<
Di°‹ti⁄
>::
	`max
();

257 i‡–!
bHADME
 )

259 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SADS
 + 
g_aucC⁄vîtToBô
[ÑcDi°P¨am.
iCﬁs
 ] + 1 ];

260 i‡(
rcDi°P¨am
.
iCﬁs
 == 12)

262 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SADS12
];

264 i‡(
rcDi°P¨am
.
iCﬁs
 == 24)

266 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SADS24
];

268 i‡(
rcDi°P¨am
.
iCﬁs
 == 48)

270 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_SADS48
];

275 
rcDi°P¨am
.
Di°Func
 = 
m_aÂDi°‹tFunc
[
DF_HADS
 + 
g_aucC⁄vîtToBô
[ÑcDi°P¨am.
iCﬁs
 ] + 1 ];

279 
rcDi°P¨am
.
iSubShi·
 = 0;

280 
	}
}

282 
Void
 
	gTComRdCo°
::
	$£tDi°P¨am
–
Di°P¨am
& 
rcDP
, 
I¡
 
bôDïth
, c⁄° 
Pñ
* 
p1
, I¡ 
iSåide1
, c⁄° Pñ* 
p2
, I¡ 
iSåide2
, I¡ 
iWidth
, I¡ 
iHeight
, 
Boﬁ
 
bHadam¨d
 )

284 
rcDP
.
pOrg
 = 
p1
;

285 
rcDP
.
pCur
 = 
p2
;

286 
rcDP
.
iSåideOrg
 = 
iSåide1
;

287 
rcDP
.
iSåideCur
 = 
iSåide2
;

288 
rcDP
.
iCﬁs
 = 
iWidth
;

289 
rcDP
.
iRows
 = 
iHeight
;

290 
rcDP
.
iSãp
 = 1;

291 
rcDP
.
iSubShi·
 = 0;

292 
rcDP
.
bôDïth
 = bitDepth;

293 
rcDP
.
Di°Func
 = 
m_aÂDi°‹tFunc
[ ( 
bHadam¨d
 ? 
DF_HADS
 : 
DF_SADS
 ) + 
g_aucC⁄vîtToBô
[ 
iWidth
 ] + 1 ];

294 
rcDP
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
°d
::
numîic_limôs
<
Di°‹ti⁄
>::
	`max
();

295 
	}
}

297 
Di°‹ti⁄
 
	gTComRdCo°
::
	$ˇlcHAD
–
I¡
 
bôDïth
, c⁄° 
Pñ
* 
pi0
, I¡ 
iSåide0
, c⁄° Pñ* 
pi1
, I¡ 
iSåide1
, I¡ 
iWidth
, I¡ 
iHeight
 )

299 
Di°‹ti⁄
 
uiSum
 = 0;

300 
I¡
 
x
, 
y
;

302 i‡––(
iWidth
 % 8Ë=0 ) && ( (
iHeight
 % 8) == 0 ) )

304  
y
=0; y<
iHeight
; y+= 8 )

306  
x
=0; x<
iWidth
; x+= 8 )

308 
uiSum
 +
	`xCÆcHADs8x8
–&
pi0
[
x
], &
pi1
[x], 
iSåide0
, 
iSåide1
, 1

309 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

310 , 
bôDïth


314 
pi0
 +
iSåide0
*8;

315 
pi1
 +
iSåide1
*8;

320 
	`as£π
 ( ( (
iWidth
 % 4Ë=0 ) && ( (
iHeight
 % 4) == 0 ) );

322  
y
=0; y<
iHeight
; y+= 4 )

324  
x
=0; x<
iWidth
; x+= 4 )

326 
uiSum
 +
	`xCÆcHADs4x4
–&
pi0
[
x
], &
pi1
[x], 
iSåide0
, 
iSåide1
, 1 );

328 
pi0
 +
iSåide0
*4;

329 
pi1
 +
iSåide1
*4;

333  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
bôDïth
-8) );

334 
	}
}

336 
Di°‹ti⁄
 
	gTComRdCo°
::
	$gëDi°P¨t
–
I¡
 
bôDïth
, c⁄° 
Pñ
* 
piCur
, I¡ 
iCurSåide
, c⁄° Pñ* 
piOrg
, I¡ 
iOrgSåide
, 
UI¡
 
uiBlkWidth
, UI¡ 
uiBlkHeight
, c⁄° 
Comp⁄ítID
 
compID
, 
DFunc
 
eDFunc
 )

338 
Di°P¨am
 
cDtP¨am
;

339 
	`£tDi°P¨am
–
uiBlkWidth
, 
uiBlkHeight
, 
eDFunc
, 
cDtP¨am
 );

340 
cDtP¨am
.
pOrg
 = 
piOrg
;

341 
cDtP¨am
.
pCur
 = 
piCur
;

342 
cDtP¨am
.
iSåideOrg
 = 
iOrgSåide
;

343 
cDtP¨am
.
iSåideCur
 = 
iCurSåide
;

344 
cDtP¨am
.
iSãp
 = 1;

346 
cDtP¨am
.
bAµlyWeight
 = 
Ál£
;

347 
cDtP¨am
.
compIdx
 = 
MAX_NUM_COMPONENT
;

348 
cDtP¨am
.
bôDïth
 = bitDepth;

350 i‡(
	`isChroma
(
compID
))

352  ((
Di°‹ti⁄
Ë(
m_di°‹ti⁄Weight
[
compID
] * 
cDtP¨am
.
	`Di°Func
( &cDtParam )));

356  
cDtP¨am
.
	`Di°Func
( &cDtParam );

358 
	}
}

364 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

365 
ölöe
 
I¡
 
	$simdSADLöe4n16b
–c⁄° 
Pñ
 * 
piOrg
 , c⁄° Pñ * 
piCur
 , 
I¡
 
nWidth
 )

368 
	`as£π
–!–
nWidth
 & 0x03 ) );

369 
__m128i
 
‹g
 , 
cur
 , 
abs
 , 
sum
;

370 
sum
 = 
	`_mm_£tzîo_si128
();

371  
I¡
 
n
 = 0 ;Ç < 
nWidth
 ;Ç += 4 )

373 
‹g
 = 
	`_mm_lﬂdl_ïi64
––
__m128i
* )–
piOrg
 + 
n
 ) );

374 
cur
 = 
	`_mm_lﬂdl_ïi64
––
__m128i
* )–
piCur
 + 
n
 ) );

375 
abs
 = 
	`_mm_subs_ïi16
–
	`_mm_max_ïi16
–
‹g
 , 
cur
 ) , 
	`_mm_mö_ïi16
( org , cur ) );

376 
sum
 = 
	`_mm_adds_ïu16
–
abs
 , sum );

378 
__m128i
 
zîo
 = 
	`_mm_£tzîo_si128
();

379 
sum
 = 
	`_mm_u≈acklo_ïi16
–sum , 
zîo
 );

380 
sum
 = 
	`_mm_add_ïi32
–sum , 
	`_mm_shufÊe_ïi32
–sum , 
	`_MM_SHUFFLE
( 2 , 3 , 0 , 1 ) ) );

381 
sum
 = 
	`_mm_add_ïi32
–sum , 
	`_mm_shufÊe_ïi32
–sum , 
	`_MM_SHUFFLE
( 1 , 0 , 3 , 2 ) ) );

382 –
	`_mm_cvtsi128_si32
–
sum
 ) );

383 
	}
}

385 
ölöe
 
I¡
 
	$simdSADLöe8n16b
–c⁄° 
Pñ
 * 
piOrg
 , c⁄° Pñ * 
piCur
 , 
I¡
 
nWidth
 )

388 
	`as£π
–!–
nWidth
 & 0x07 ) );

389 
__m128i
 
‹g
 , 
cur
 , 
abs
 , 
sum
;

390 
sum
 = 
	`_mm_£tzîo_si128
();

391  
I¡
 
n
 = 0 ;Ç < 
nWidth
 ;Ç += 8 )

393 
‹g
 = 
	`_mm_lﬂdu_si128
––
__m128i
* )–
piOrg
 + 
n
 ) );

394 
cur
 = 
	`_mm_lﬂdu_si128
––
__m128i
* )–
piCur
 + 
n
 ) );

395 
abs
 = 
	`_mm_subs_ïi16
–
	`_mm_max_ïi16
–
‹g
 , 
cur
 ) , 
	`_mm_mö_ïi16
( org , cur ) );

396 
sum
 = 
	`_mm_adds_ïu16
–
abs
 , sum );

398 
__m128i
 
zîo
 = 
	`_mm_£tzîo_si128
();

399 
__m128i
 
hi
 = 
	`_mm_u≈ackhi_ïi16
–
sum
 , 
zîo
 );

400 
__m128i
 
lo
 = 
	`_mm_u≈acklo_ïi16
–
sum
 , 
zîo
 );

401 
sum
 = 
	`_mm_add_ïi32
–
lo
 , 
hi
 );

402 
sum
 = 
	`_mm_add_ïi32
–sum , 
	`_mm_shufÊe_ïi32
–sum , 
	`_MM_SHUFFLE
( 2 , 3 , 0 , 1 ) ) );

403 
sum
 = 
	`_mm_add_ïi32
–sum , 
	`_mm_shufÊe_ïi32
–sum , 
	`_MM_SHUFFLE
( 1 , 0 , 3 , 2 ) ) );

404 –
	`_mm_cvtsi128_si32
–
sum
 ) );

405 
	}
}

407 
ölöe
 
Void
 
	$simd8x8Tøn•o£32b
–
__m128i
 * 
pBuf„r
 )

409 
__m128
 
tmp
[16];

410  
I¡
 
n
 = 0 ;Ç < 16 ;Ç++ )

412 
tmp
[
n
] = 
	`_mm_ˇ°si128_ps
–
pBuf„r
[n] );

414 
	`_MM_TRANSPOSE4_PS
–
tmp
[0] ,Åmp[2] ,Åmp[4] ,Åmp[6] );

415 
	`_MM_TRANSPOSE4_PS
–
tmp
[1] ,Åmp[3] ,Åmp[5] ,Åmp[7] );

416 
	`_MM_TRANSPOSE4_PS
–
tmp
[8] ,Åmp[10] ,Åmp[12] ,Åmp[14] );

417 
	`_MM_TRANSPOSE4_PS
–
tmp
[9] ,Åmp[11] ,Åmp[13] ,Åmp[15] );

418  
I¡
 
n
 = 0 ;Ç < 8 ;Ç += 2 )

420 
pBuf„r
[
n
] = 
	`_mm_ˇ°ps_si128
–
tmp
[n] );

421 
pBuf„r
[
n
+1] = 
	`_mm_ˇ°ps_si128
–
tmp
[n+8] );

422 
pBuf„r
[
n
+8] = 
	`_mm_ˇ°ps_si128
–
tmp
[n+1] );

423 
pBuf„r
[
n
+9] = 
	`_mm_ˇ°ps_si128
–
tmp
[n+9] );

425 
	}
}

427 #ifde‡
__GNUC__


428 
	#GCC_VERSION
 (
__GNUC__
 * 10000 + 
__GNUC_MINOR__
 * 100 + 
__GNUC_PATCHLEVEL__
)

	)

429 #i‡
GCC_VERSION
 > 40600 && GCC_VERSION < 40700

430 
__©åibuã__
((
›timize
("no-tree-vrp")))

433 
Void
 
	$simd8x8HAD1D32b
–
__m128i
 * 
pI≈ut
 , __m128ò* 
pOuçut
 )

435 
__m128i
 
m1
[8][2] , 
m2
[8][2];

437 
m2
[0][0] = 
	`_mm_add_ïi32
–
pI≈ut
[0] ,pInput[8 ] ); m2[0][1] = _mm_add_epi32(ÖInput[1] ,pInput[9 ] );

438 
m2
[1][0] = 
	`_mm_add_ïi32
–
pI≈ut
[2] ,pInput[10] ); m2[1][1] = _mm_add_epi32(ÖInput[3] ,pInput[11] );

439 
m2
[2][0] = 
	`_mm_add_ïi32
–
pI≈ut
[4] ,pInput[12] ); m2[2][1] = _mm_add_epi32(ÖInput[5] ,pInput[13] );

440 
m2
[3][0] = 
	`_mm_add_ïi32
–
pI≈ut
[6] ,pInput[14] ); m2[3][1] = _mm_add_epi32(ÖInput[7] ,pInput[15] );

441 
m2
[4][0] = 
	`_mm_sub_ïi32
–
pI≈ut
[0] ,pInput[8 ] ); m2[4][1] = _mm_sub_epi32(ÖInput[1] ,pInput[9 ] );

442 
m2
[5][0] = 
	`_mm_sub_ïi32
–
pI≈ut
[2] ,pInput[10] ); m2[5][1] = _mm_sub_epi32(ÖInput[3] ,pInput[11] );

443 
m2
[6][0] = 
	`_mm_sub_ïi32
–
pI≈ut
[4] ,pInput[12] ); m2[6][1] = _mm_sub_epi32(ÖInput[5] ,pInput[13] );

444 
m2
[7][0] = 
	`_mm_sub_ïi32
–
pI≈ut
[6] ,pInput[14] ); m2[7][1] = _mm_sub_epi32(ÖInput[7] ,pInput[15] );

446 
m1
[0][0] = 
	`_mm_add_ïi32
–
m2
[0][0] , m2[2][0] ); m1[0][1] = _mm_add_epi32( m2[0][1] , m2[2][1] );

447 
m1
[1][0] = 
	`_mm_add_ïi32
–
m2
[1][0] , m2[3][0] ); m1[1][1] = _mm_add_epi32( m2[1][1] , m2[3][1] );

448 
m1
[2][0] = 
	`_mm_sub_ïi32
–
m2
[0][0] , m2[2][0] ); m1[2][1] = _mm_sub_epi32( m2[0][1] , m2[2][1] );

449 
m1
[3][0] = 
	`_mm_sub_ïi32
–
m2
[1][0] , m2[3][0] ); m1[3][1] = _mm_sub_epi32( m2[1][1] , m2[3][1] );

450 
m1
[4][0] = 
	`_mm_add_ïi32
–
m2
[4][0] , m2[6][0] ); m1[4][1] = _mm_add_epi32( m2[4][1] , m2[6][1] );

451 
m1
[5][0] = 
	`_mm_add_ïi32
–
m2
[5][0] , m2[7][0] ); m1[5][1] = _mm_add_epi32( m2[5][1] , m2[7][1] );

452 
m1
[6][0] = 
	`_mm_sub_ïi32
–
m2
[4][0] , m2[6][0] ); m1[6][1] = _mm_sub_epi32( m2[4][1] , m2[6][1] );

453 
m1
[7][0] = 
	`_mm_sub_ïi32
–
m2
[5][0] , m2[7][0] ); m1[7][1] = _mm_sub_epi32( m2[5][1] , m2[7][1] );

455 
pI≈ut
[0 ] = 
	`_mm_add_ïi32
–
m1
[0][0] , m1[1][0] );ÖInput[1 ] = _mm_add_epi32( m1[0][1] , m1[1][1] );

456 
pI≈ut
[2 ] = 
	`_mm_sub_ïi32
–
m1
[0][0] , m1[1][0] );ÖInput[3 ] = _mm_sub_epi32( m1[0][1] , m1[1][1] );

457 
pI≈ut
[4 ] = 
	`_mm_add_ïi32
–
m1
[2][0] , m1[3][0] );ÖInput[5 ] = _mm_add_epi32( m1[2][1] , m1[3][1] );

458 
pI≈ut
[6 ] = 
	`_mm_sub_ïi32
–
m1
[2][0] , m1[3][0] );ÖInput[7 ] = _mm_sub_epi32( m1[2][1] , m1[3][1] );

459 
pI≈ut
[8 ] = 
	`_mm_add_ïi32
–
m1
[4][0] , m1[5][0] );ÖInput[9 ] = _mm_add_epi32( m1[4][1] , m1[5][1] );

460 
pI≈ut
[10] = 
	`_mm_sub_ïi32
–
m1
[4][0] , m1[5][0] );ÖInput[11] = _mm_sub_epi32( m1[4][1] , m1[5][1] );

461 
pI≈ut
[12] = 
	`_mm_add_ïi32
–
m1
[6][0] , m1[7][0] );ÖInput[13] = _mm_add_epi32( m1[6][1] , m1[7][1] );

462 
pI≈ut
[14] = 
	`_mm_sub_ïi32
–
m1
[6][0] , m1[7][0] );ÖInput[15] = _mm_sub_epi32( m1[6][1] , m1[7][1] );

463 
	}
}

465 
ölöe
 
__m128i
 
	$simdAbs32b
–
__m128i
 
m
 )

467 c⁄° 
__m128i
 
zîo
 = 
	`_mm_£tzîo_si128
();

468 
__m128i
 
tmp
 = 
	`_mm_sub_ïi32
–
zîo
 , 
m
 );

469 
__m128i
 
mask
 = 
	`_mm_cmpgt_ïi32
–
m
 , 
tmp
 );

470 –
	`_mm_‹_si128
–
	`_mm_™d_si128
–
mask
 , 
m
 ) , 
	`_mm_™dnŸ_si128
–mask , 
tmp
 ) ) );

471 
	}
}

473 
UI¡
 
	$simdHADs8x8
–c⁄° 
Pñ
 * 
piOrg
, c⁄° Pñ * 
piCur
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
 )

475 
__m128i
 
mmDiff
[8][2];

476 
__m128i
 
mmZîo
 = 
	`_mm_£tzîo_si128
();

477  
I¡
 
n
 = 0 ;Ç < 8 ;Ç++ , 
piOrg
 +
iSåideOrg
 , 
piCur
 +
iSåideCur
 )

479 
__m128i
 
diff
 = 
	`_mm_sub_ïi16
–
	`_mm_lﬂdu_si128
––__m128i* )
piOrg
 ) , _mm_lﬂdu_si128––__m128i* )
piCur
 ) );

481 
__m128i
 
mask
 = 
	`_mm_cm∂t_ïi16
–
diff
 , 
mmZîo
 );

482 
mmDiff
[
n
][0] = 
	`_mm_u≈acklo_ïi16
–
diff
 , 
mask
 );

483 
mmDiff
[
n
][1] = 
	`_mm_u≈ackhi_ïi16
–
diff
 , 
mask
 );

487 
	`simd8x8Tøn•o£32b
–&
mmDiff
[0][0] );

490 
	`simd8x8HAD1D32b
–&
mmDiff
[0][0] , &mmDiff[0][0] );

493 
	`simd8x8Tøn•o£32b
–&
mmDiff
[0][0] );

496 
	`simd8x8HAD1D32b
–&
mmDiff
[0][0] , &mmDiff[0][0] );

498 
__m128i
 
mmSum
 = 
	`_mm_£tzîo_si128
();

499  
I¡
 
n
 = 0 ;Ç < 8 ;Ç++ )

501 
mmSum
 = 
	`_mm_add_ïi32
–mmSum , 
	`simdAbs32b
–
mmDiff
[
n
][0] ) );

502 
mmSum
 = 
	`_mm_add_ïi32
–mmSum , 
	`simdAbs32b
–
mmDiff
[
n
][1] ) );

504 
mmSum
 = 
	`_mm_add_ïi32
–mmSum , 
	`_mm_shufÊe_ïi32
–mmSum , 
	`_MM_SHUFFLE
( 2 , 3 , 0 , 1 ) ) );

505 
mmSum
 = 
	`_mm_add_ïi32
–mmSum , 
	`_mm_shufÊe_ïi32
–mmSum , 
	`_MM_SHUFFLE
( 1 , 0 , 3 , 2 ) ) );

507 
UI¡
 
ßd
 = 
	`_mm_cvtsi128_si32
–
mmSum
 );

508 
ßd
 = ( sad + 2 ) >> 2;

510 –
ßd
 );

511 
	}
}

518 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD
–
Di°P¨am
* 
pcDtP¨am
 )

520 i‡–
pcDtP¨am
->
bAµlyWeight
 )

522  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

524 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

525 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

526 c⁄° 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

527 c⁄° 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

528 c⁄° 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

529 c⁄° 
UI¡
 
di°‹ti⁄Shi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
 - 8);

531 
Di°‹ti⁄
 
uiSum
 = 0;

533 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

534 if–
pcDtP¨am
->
bôDïth
 <= 10 )

536 if––
iCﬁs
 & 0x07 ) == 0 )

538  
I¡
 
iRows
 = 
pcDtP¨am
->iRows ; iRows != 0; iRows-- )

540 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 
iCﬁs
 );

541 
piOrg
 +
iSåideOrg
;

542 
piCur
 +
iSåideCur
;

547  
I¡
 
iRows
 = 
pcDtP¨am
->iRows; iRows != 0; iRows-- )

549 
uiSum
 +
	`simdSADLöe4n16b
–
piOrg
 , 
piCur
 , 
iCﬁs
 );

550 
piOrg
 +
iSåideOrg
;

551 
piCur
 +
iSåideCur
;

558 
I¡
 
iRows
 = 
pcDtP¨am
->iRows ; iRows != 0; iRows-- )

560 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

562 
uiSum
 +
	`abs
–
piOrg
[
n
] - 
piCur
[n] );

564 i‡(
pcDtP¨am
->
m_maximumDi°‹ti⁄F‹E¨lyExô
 < ( 
uiSum
 >> 
di°‹ti⁄Shi·
 ))

566  ( 
uiSum
 >> 
di°‹ti⁄Shi·
 );

568 
piOrg
 +
iSåideOrg
;

569 
piCur
 +
iSåideCur
;

571 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

575  ( 
uiSum
 >> 
di°‹ti⁄Shi·
 );

576 
	}
}

578 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD4
–
Di°P¨am
* 
pcDtP¨am
 )

580 i‡–
pcDtP¨am
->
bAµlyWeight
 )

582  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

584 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

585 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

586 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

587 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

588 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

589 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

590 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

592 
Di°‹ti⁄
 
uiSum
 = 0;

594 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

595 if–
pcDtP¨am
->
bôDïth
 <= 10 )

597  ; 
iRows
 !0; iRows-=
iSubSãp
 )

599 
uiSum
 +
	`simdSADLöe4n16b
–
piOrg
 , 
piCur
 , 4 );

600 
piOrg
 +
iSåideOrg
;

601 
piCur
 +
iSåideCur
;

607  ; 
iRows
 !0; iRows-=
iSubSãp
 )

609 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

610 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

611 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

612 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

614 
piOrg
 +
iSåideOrg
;

615 
piCur
 +
iSåideCur
;

617 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

621 
uiSum
 <<
iSubShi·
;

622  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

623 
	}
}

625 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD8
–
Di°P¨am
* 
pcDtP¨am
 )

627 i‡–
pcDtP¨am
->
bAµlyWeight
 )

629  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

631 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

632 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

633 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

634 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

635 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

636 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

637 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

639 
Di°‹ti⁄
 
uiSum
 = 0;

641 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

642 if–
pcDtP¨am
->
bôDïth
 <= 10 )

644  ; 
iRows
 !0; iRows-=
iSubSãp
 )

646 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 8 );

647 
piOrg
 +
iSåideOrg
;

648 
piCur
 +
iSåideCur
;

654  ; 
iRows
 !0; iRows-=
iSubSãp
 )

656 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

657 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

658 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

659 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

660 
uiSum
 +
	`abs
–
piOrg
[4] - 
piCur
[4] );

661 
uiSum
 +
	`abs
–
piOrg
[5] - 
piCur
[5] );

662 
uiSum
 +
	`abs
–
piOrg
[6] - 
piCur
[6] );

663 
uiSum
 +
	`abs
–
piOrg
[7] - 
piCur
[7] );

665 
piOrg
 +
iSåideOrg
;

666 
piCur
 +
iSåideCur
;

668 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

672 
uiSum
 <<
iSubShi·
;

673  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

674 
	}
}

676 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD16
–
Di°P¨am
* 
pcDtP¨am
 )

678 i‡–
pcDtP¨am
->
bAµlyWeight
 )

680  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

682 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

683 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

684 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

685 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

686 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

687 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

688 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

690 
Di°‹ti⁄
 
uiSum
 = 0;

692 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

693 if–
pcDtP¨am
->
bôDïth
 <= 10 )

695  ; 
iRows
 !0; iRows-=
iSubSãp
 )

697 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 16 );

698 
piOrg
 +
iSåideOrg
;

699 
piCur
 +
iSåideCur
;

705  ; 
iRows
 !0; iRows-=
iSubSãp
 )

707 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

708 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

709 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

710 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

711 
uiSum
 +
	`abs
–
piOrg
[4] - 
piCur
[4] );

712 
uiSum
 +
	`abs
–
piOrg
[5] - 
piCur
[5] );

713 
uiSum
 +
	`abs
–
piOrg
[6] - 
piCur
[6] );

714 
uiSum
 +
	`abs
–
piOrg
[7] - 
piCur
[7] );

715 
uiSum
 +
	`abs
–
piOrg
[8] - 
piCur
[8] );

716 
uiSum
 +
	`abs
–
piOrg
[9] - 
piCur
[9] );

717 
uiSum
 +
	`abs
–
piOrg
[10] - 
piCur
[10] );

718 
uiSum
 +
	`abs
–
piOrg
[11] - 
piCur
[11] );

719 
uiSum
 +
	`abs
–
piOrg
[12] - 
piCur
[12] );

720 
uiSum
 +
	`abs
–
piOrg
[13] - 
piCur
[13] );

721 
uiSum
 +
	`abs
–
piOrg
[14] - 
piCur
[14] );

722 
uiSum
 +
	`abs
–
piOrg
[15] - 
piCur
[15] );

724 
piOrg
 +
iSåideOrg
;

725 
piCur
 +
iSåideCur
;

727 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

731 
uiSum
 <<
iSubShi·
;

732  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

733 
	}
}

735 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD12
–
Di°P¨am
* 
pcDtP¨am
 )

737 i‡–
pcDtP¨am
->
bAµlyWeight
 )

739  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

741 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

742 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

743 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

744 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

745 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

746 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

747 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

749 
Di°‹ti⁄
 
uiSum
 = 0;

751  ; 
iRows
 !0; iRows-=
iSubSãp
 )

753 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

754 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

755 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

756 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

757 
uiSum
 +
	`abs
–
piOrg
[4] - 
piCur
[4] );

758 
uiSum
 +
	`abs
–
piOrg
[5] - 
piCur
[5] );

759 
uiSum
 +
	`abs
–
piOrg
[6] - 
piCur
[6] );

760 
uiSum
 +
	`abs
–
piOrg
[7] - 
piCur
[7] );

761 
uiSum
 +
	`abs
–
piOrg
[8] - 
piCur
[8] );

762 
uiSum
 +
	`abs
–
piOrg
[9] - 
piCur
[9] );

763 
uiSum
 +
	`abs
–
piOrg
[10] - 
piCur
[10] );

764 
uiSum
 +
	`abs
–
piOrg
[11] - 
piCur
[11] );

766 
piOrg
 +
iSåideOrg
;

767 
piCur
 +
iSåideCur
;

770 
uiSum
 <<
iSubShi·
;

771  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

772 
	}
}

774 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD16N
–
Di°P¨am
* 
pcDtP¨am
 )

776 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

777 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

778 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

779 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

780 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

781 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

782 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

783 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

785 
Di°‹ti⁄
 
uiSum
 = 0;

787 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

788 if–
pcDtP¨am
->
bôDïth
 <= 10 )

790  ; 
iRows
 !0; iRows-=
iSubSãp
 )

792 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 
iCﬁs
 );

793 
piOrg
 +
iSåideOrg
;

794 
piCur
 +
iSåideCur
;

800  ; 
iRows
 !0; iRows-=
iSubSãp
 )

802 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç+=16 )

804 
uiSum
 +
	`abs
–
piOrg
[
n
+ 0] - 
piCur
[n+ 0] );

805 
uiSum
 +
	`abs
–
piOrg
[
n
+ 1] - 
piCur
[n+ 1] );

806 
uiSum
 +
	`abs
–
piOrg
[
n
+ 2] - 
piCur
[n+ 2] );

807 
uiSum
 +
	`abs
–
piOrg
[
n
+ 3] - 
piCur
[n+ 3] );

808 
uiSum
 +
	`abs
–
piOrg
[
n
+ 4] - 
piCur
[n+ 4] );

809 
uiSum
 +
	`abs
–
piOrg
[
n
+ 5] - 
piCur
[n+ 5] );

810 
uiSum
 +
	`abs
–
piOrg
[
n
+ 6] - 
piCur
[n+ 6] );

811 
uiSum
 +
	`abs
–
piOrg
[
n
+ 7] - 
piCur
[n+ 7] );

812 
uiSum
 +
	`abs
–
piOrg
[
n
+ 8] - 
piCur
[n+ 8] );

813 
uiSum
 +
	`abs
–
piOrg
[
n
+ 9] - 
piCur
[n+ 9] );

814 
uiSum
 +
	`abs
–
piOrg
[
n
+10] - 
piCur
[n+10] );

815 
uiSum
 +
	`abs
–
piOrg
[
n
+11] - 
piCur
[n+11] );

816 
uiSum
 +
	`abs
–
piOrg
[
n
+12] - 
piCur
[n+12] );

817 
uiSum
 +
	`abs
–
piOrg
[
n
+13] - 
piCur
[n+13] );

818 
uiSum
 +
	`abs
–
piOrg
[
n
+14] - 
piCur
[n+14] );

819 
uiSum
 +
	`abs
–
piOrg
[
n
+15] - 
piCur
[n+15] );

821 
piOrg
 +
iSåideOrg
;

822 
piCur
 +
iSåideCur
;

824 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

828 
uiSum
 <<
iSubShi·
;

829  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

830 
	}
}

832 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD32
–
Di°P¨am
* 
pcDtP¨am
 )

834 i‡–
pcDtP¨am
->
bAµlyWeight
 )

836  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

838 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

839 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

840 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

841 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

842 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

843 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

844 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

846 
Di°‹ti⁄
 
uiSum
 = 0;

848 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

849 if–
pcDtP¨am
->
bôDïth
 <= 10 )

851  ; 
iRows
 !0; iRows-=
iSubSãp
 )

853 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 32 );

854 
piOrg
 +
iSåideOrg
;

855 
piCur
 +
iSåideCur
;

861  ; 
iRows
 !0; iRows-=
iSubSãp
 )

863 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

864 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

865 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

866 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

867 
uiSum
 +
	`abs
–
piOrg
[4] - 
piCur
[4] );

868 
uiSum
 +
	`abs
–
piOrg
[5] - 
piCur
[5] );

869 
uiSum
 +
	`abs
–
piOrg
[6] - 
piCur
[6] );

870 
uiSum
 +
	`abs
–
piOrg
[7] - 
piCur
[7] );

871 
uiSum
 +
	`abs
–
piOrg
[8] - 
piCur
[8] );

872 
uiSum
 +
	`abs
–
piOrg
[9] - 
piCur
[9] );

873 
uiSum
 +
	`abs
–
piOrg
[10] - 
piCur
[10] );

874 
uiSum
 +
	`abs
–
piOrg
[11] - 
piCur
[11] );

875 
uiSum
 +
	`abs
–
piOrg
[12] - 
piCur
[12] );

876 
uiSum
 +
	`abs
–
piOrg
[13] - 
piCur
[13] );

877 
uiSum
 +
	`abs
–
piOrg
[14] - 
piCur
[14] );

878 
uiSum
 +
	`abs
–
piOrg
[15] - 
piCur
[15] );

879 
uiSum
 +
	`abs
–
piOrg
[16] - 
piCur
[16] );

880 
uiSum
 +
	`abs
–
piOrg
[17] - 
piCur
[17] );

881 
uiSum
 +
	`abs
–
piOrg
[18] - 
piCur
[18] );

882 
uiSum
 +
	`abs
–
piOrg
[19] - 
piCur
[19] );

883 
uiSum
 +
	`abs
–
piOrg
[20] - 
piCur
[20] );

884 
uiSum
 +
	`abs
–
piOrg
[21] - 
piCur
[21] );

885 
uiSum
 +
	`abs
–
piOrg
[22] - 
piCur
[22] );

886 
uiSum
 +
	`abs
–
piOrg
[23] - 
piCur
[23] );

887 
uiSum
 +
	`abs
–
piOrg
[24] - 
piCur
[24] );

888 
uiSum
 +
	`abs
–
piOrg
[25] - 
piCur
[25] );

889 
uiSum
 +
	`abs
–
piOrg
[26] - 
piCur
[26] );

890 
uiSum
 +
	`abs
–
piOrg
[27] - 
piCur
[27] );

891 
uiSum
 +
	`abs
–
piOrg
[28] - 
piCur
[28] );

892 
uiSum
 +
	`abs
–
piOrg
[29] - 
piCur
[29] );

893 
uiSum
 +
	`abs
–
piOrg
[30] - 
piCur
[30] );

894 
uiSum
 +
	`abs
–
piOrg
[31] - 
piCur
[31] );

896 
piOrg
 +
iSåideOrg
;

897 
piCur
 +
iSåideCur
;

899 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

903 
uiSum
 <<
iSubShi·
;

904  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

905 
	}
}

907 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD24
–
Di°P¨am
* 
pcDtP¨am
 )

909 i‡–
pcDtP¨am
->
bAµlyWeight
 )

911  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

913 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

914 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

915 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

916 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

917 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

918 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

919 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

921 
Di°‹ti⁄
 
uiSum
 = 0;

923 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

924 if–
pcDtP¨am
->
bôDïth
 <= 10 )

926  ; 
iRows
 !0; iRows-=
iSubSãp
 )

928 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 24 );

929 
piOrg
 +
iSåideOrg
;

930 
piCur
 +
iSåideCur
;

936  ; 
iRows
 !0; iRows-=
iSubSãp
 )

938 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

939 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

940 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

941 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

942 
uiSum
 +
	`abs
–
piOrg
[4] - 
piCur
[4] );

943 
uiSum
 +
	`abs
–
piOrg
[5] - 
piCur
[5] );

944 
uiSum
 +
	`abs
–
piOrg
[6] - 
piCur
[6] );

945 
uiSum
 +
	`abs
–
piOrg
[7] - 
piCur
[7] );

946 
uiSum
 +
	`abs
–
piOrg
[8] - 
piCur
[8] );

947 
uiSum
 +
	`abs
–
piOrg
[9] - 
piCur
[9] );

948 
uiSum
 +
	`abs
–
piOrg
[10] - 
piCur
[10] );

949 
uiSum
 +
	`abs
–
piOrg
[11] - 
piCur
[11] );

950 
uiSum
 +
	`abs
–
piOrg
[12] - 
piCur
[12] );

951 
uiSum
 +
	`abs
–
piOrg
[13] - 
piCur
[13] );

952 
uiSum
 +
	`abs
–
piOrg
[14] - 
piCur
[14] );

953 
uiSum
 +
	`abs
–
piOrg
[15] - 
piCur
[15] );

954 
uiSum
 +
	`abs
–
piOrg
[16] - 
piCur
[16] );

955 
uiSum
 +
	`abs
–
piOrg
[17] - 
piCur
[17] );

956 
uiSum
 +
	`abs
–
piOrg
[18] - 
piCur
[18] );

957 
uiSum
 +
	`abs
–
piOrg
[19] - 
piCur
[19] );

958 
uiSum
 +
	`abs
–
piOrg
[20] - 
piCur
[20] );

959 
uiSum
 +
	`abs
–
piOrg
[21] - 
piCur
[21] );

960 
uiSum
 +
	`abs
–
piOrg
[22] - 
piCur
[22] );

961 
uiSum
 +
	`abs
–
piOrg
[23] - 
piCur
[23] );

963 
piOrg
 +
iSåideOrg
;

964 
piCur
 +
iSåideCur
;

966 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

970 
uiSum
 <<
iSubShi·
;

971  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

972 
	}
}

974 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD64
–
Di°P¨am
* 
pcDtP¨am
 )

976 i‡–
pcDtP¨am
->
bAµlyWeight
 )

978  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

980 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

981 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

982 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

983 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

984 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

985 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

986 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

988 
Di°‹ti⁄
 
uiSum
 = 0;

990 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

991 if–
pcDtP¨am
->
bôDïth
 <= 10 )

993  ; 
iRows
 !0; iRows-=
iSubSãp
 )

995 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 64 );

996 
piOrg
 +
iSåideOrg
;

997 
piCur
 +
iSåideCur
;

1003  ; 
iRows
 !0; iRows-=
iSubSãp
 )

1005 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

1006 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

1007 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

1008 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

1009 
uiSum
 +
	`abs
–
piOrg
[4] - 
piCur
[4] );

1010 
uiSum
 +
	`abs
–
piOrg
[5] - 
piCur
[5] );

1011 
uiSum
 +
	`abs
–
piOrg
[6] - 
piCur
[6] );

1012 
uiSum
 +
	`abs
–
piOrg
[7] - 
piCur
[7] );

1013 
uiSum
 +
	`abs
–
piOrg
[8] - 
piCur
[8] );

1014 
uiSum
 +
	`abs
–
piOrg
[9] - 
piCur
[9] );

1015 
uiSum
 +
	`abs
–
piOrg
[10] - 
piCur
[10] );

1016 
uiSum
 +
	`abs
–
piOrg
[11] - 
piCur
[11] );

1017 
uiSum
 +
	`abs
–
piOrg
[12] - 
piCur
[12] );

1018 
uiSum
 +
	`abs
–
piOrg
[13] - 
piCur
[13] );

1019 
uiSum
 +
	`abs
–
piOrg
[14] - 
piCur
[14] );

1020 
uiSum
 +
	`abs
–
piOrg
[15] - 
piCur
[15] );

1021 
uiSum
 +
	`abs
–
piOrg
[16] - 
piCur
[16] );

1022 
uiSum
 +
	`abs
–
piOrg
[17] - 
piCur
[17] );

1023 
uiSum
 +
	`abs
–
piOrg
[18] - 
piCur
[18] );

1024 
uiSum
 +
	`abs
–
piOrg
[19] - 
piCur
[19] );

1025 
uiSum
 +
	`abs
–
piOrg
[20] - 
piCur
[20] );

1026 
uiSum
 +
	`abs
–
piOrg
[21] - 
piCur
[21] );

1027 
uiSum
 +
	`abs
–
piOrg
[22] - 
piCur
[22] );

1028 
uiSum
 +
	`abs
–
piOrg
[23] - 
piCur
[23] );

1029 
uiSum
 +
	`abs
–
piOrg
[24] - 
piCur
[24] );

1030 
uiSum
 +
	`abs
–
piOrg
[25] - 
piCur
[25] );

1031 
uiSum
 +
	`abs
–
piOrg
[26] - 
piCur
[26] );

1032 
uiSum
 +
	`abs
–
piOrg
[27] - 
piCur
[27] );

1033 
uiSum
 +
	`abs
–
piOrg
[28] - 
piCur
[28] );

1034 
uiSum
 +
	`abs
–
piOrg
[29] - 
piCur
[29] );

1035 
uiSum
 +
	`abs
–
piOrg
[30] - 
piCur
[30] );

1036 
uiSum
 +
	`abs
–
piOrg
[31] - 
piCur
[31] );

1037 
uiSum
 +
	`abs
–
piOrg
[32] - 
piCur
[32] );

1038 
uiSum
 +
	`abs
–
piOrg
[33] - 
piCur
[33] );

1039 
uiSum
 +
	`abs
–
piOrg
[34] - 
piCur
[34] );

1040 
uiSum
 +
	`abs
–
piOrg
[35] - 
piCur
[35] );

1041 
uiSum
 +
	`abs
–
piOrg
[36] - 
piCur
[36] );

1042 
uiSum
 +
	`abs
–
piOrg
[37] - 
piCur
[37] );

1043 
uiSum
 +
	`abs
–
piOrg
[38] - 
piCur
[38] );

1044 
uiSum
 +
	`abs
–
piOrg
[39] - 
piCur
[39] );

1045 
uiSum
 +
	`abs
–
piOrg
[40] - 
piCur
[40] );

1046 
uiSum
 +
	`abs
–
piOrg
[41] - 
piCur
[41] );

1047 
uiSum
 +
	`abs
–
piOrg
[42] - 
piCur
[42] );

1048 
uiSum
 +
	`abs
–
piOrg
[43] - 
piCur
[43] );

1049 
uiSum
 +
	`abs
–
piOrg
[44] - 
piCur
[44] );

1050 
uiSum
 +
	`abs
–
piOrg
[45] - 
piCur
[45] );

1051 
uiSum
 +
	`abs
–
piOrg
[46] - 
piCur
[46] );

1052 
uiSum
 +
	`abs
–
piOrg
[47] - 
piCur
[47] );

1053 
uiSum
 +
	`abs
–
piOrg
[48] - 
piCur
[48] );

1054 
uiSum
 +
	`abs
–
piOrg
[49] - 
piCur
[49] );

1055 
uiSum
 +
	`abs
–
piOrg
[50] - 
piCur
[50] );

1056 
uiSum
 +
	`abs
–
piOrg
[51] - 
piCur
[51] );

1057 
uiSum
 +
	`abs
–
piOrg
[52] - 
piCur
[52] );

1058 
uiSum
 +
	`abs
–
piOrg
[53] - 
piCur
[53] );

1059 
uiSum
 +
	`abs
–
piOrg
[54] - 
piCur
[54] );

1060 
uiSum
 +
	`abs
–
piOrg
[55] - 
piCur
[55] );

1061 
uiSum
 +
	`abs
–
piOrg
[56] - 
piCur
[56] );

1062 
uiSum
 +
	`abs
–
piOrg
[57] - 
piCur
[57] );

1063 
uiSum
 +
	`abs
–
piOrg
[58] - 
piCur
[58] );

1064 
uiSum
 +
	`abs
–
piOrg
[59] - 
piCur
[59] );

1065 
uiSum
 +
	`abs
–
piOrg
[60] - 
piCur
[60] );

1066 
uiSum
 +
	`abs
–
piOrg
[61] - 
piCur
[61] );

1067 
uiSum
 +
	`abs
–
piOrg
[62] - 
piCur
[62] );

1068 
uiSum
 +
	`abs
–
piOrg
[63] - 
piCur
[63] );

1070 
piOrg
 +
iSåideOrg
;

1071 
piCur
 +
iSåideCur
;

1073 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

1077 
uiSum
 <<
iSubShi·
;

1078  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

1079 
	}
}

1081 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSAD48
–
Di°P¨am
* 
pcDtP¨am
 )

1083 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1085  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSADw
–
pcDtP¨am
 );

1087 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1088 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1089 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1090 
I¡
 
iSubShi·
 = 
pcDtP¨am
->iSubShift;

1091 
I¡
 
iSubSãp
 = ( 1 << 
iSubShi·
 );

1092 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iSåideCur*
iSubSãp
;

1093 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iSåideOrg*
iSubSãp
;

1095 
Di°‹ti⁄
 
uiSum
 = 0;

1097 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

1098 if–
pcDtP¨am
->
bôDïth
 <= 10 )

1100  ; 
iRows
 !0; iRows-=
iSubSãp
 )

1102 
uiSum
 +
	`simdSADLöe8n16b
–
piOrg
 , 
piCur
 , 48 );

1103 
piOrg
 +
iSåideOrg
;

1104 
piCur
 +
iSåideCur
;

1110  ; 
iRows
 !0; iRows-=
iSubSãp
 )

1112 
uiSum
 +
	`abs
–
piOrg
[0] - 
piCur
[0] );

1113 
uiSum
 +
	`abs
–
piOrg
[1] - 
piCur
[1] );

1114 
uiSum
 +
	`abs
–
piOrg
[2] - 
piCur
[2] );

1115 
uiSum
 +
	`abs
–
piOrg
[3] - 
piCur
[3] );

1116 
uiSum
 +
	`abs
–
piOrg
[4] - 
piCur
[4] );

1117 
uiSum
 +
	`abs
–
piOrg
[5] - 
piCur
[5] );

1118 
uiSum
 +
	`abs
–
piOrg
[6] - 
piCur
[6] );

1119 
uiSum
 +
	`abs
–
piOrg
[7] - 
piCur
[7] );

1120 
uiSum
 +
	`abs
–
piOrg
[8] - 
piCur
[8] );

1121 
uiSum
 +
	`abs
–
piOrg
[9] - 
piCur
[9] );

1122 
uiSum
 +
	`abs
–
piOrg
[10] - 
piCur
[10] );

1123 
uiSum
 +
	`abs
–
piOrg
[11] - 
piCur
[11] );

1124 
uiSum
 +
	`abs
–
piOrg
[12] - 
piCur
[12] );

1125 
uiSum
 +
	`abs
–
piOrg
[13] - 
piCur
[13] );

1126 
uiSum
 +
	`abs
–
piOrg
[14] - 
piCur
[14] );

1127 
uiSum
 +
	`abs
–
piOrg
[15] - 
piCur
[15] );

1128 
uiSum
 +
	`abs
–
piOrg
[16] - 
piCur
[16] );

1129 
uiSum
 +
	`abs
–
piOrg
[17] - 
piCur
[17] );

1130 
uiSum
 +
	`abs
–
piOrg
[18] - 
piCur
[18] );

1131 
uiSum
 +
	`abs
–
piOrg
[19] - 
piCur
[19] );

1132 
uiSum
 +
	`abs
–
piOrg
[20] - 
piCur
[20] );

1133 
uiSum
 +
	`abs
–
piOrg
[21] - 
piCur
[21] );

1134 
uiSum
 +
	`abs
–
piOrg
[22] - 
piCur
[22] );

1135 
uiSum
 +
	`abs
–
piOrg
[23] - 
piCur
[23] );

1136 
uiSum
 +
	`abs
–
piOrg
[24] - 
piCur
[24] );

1137 
uiSum
 +
	`abs
–
piOrg
[25] - 
piCur
[25] );

1138 
uiSum
 +
	`abs
–
piOrg
[26] - 
piCur
[26] );

1139 
uiSum
 +
	`abs
–
piOrg
[27] - 
piCur
[27] );

1140 
uiSum
 +
	`abs
–
piOrg
[28] - 
piCur
[28] );

1141 
uiSum
 +
	`abs
–
piOrg
[29] - 
piCur
[29] );

1142 
uiSum
 +
	`abs
–
piOrg
[30] - 
piCur
[30] );

1143 
uiSum
 +
	`abs
–
piOrg
[31] - 
piCur
[31] );

1144 
uiSum
 +
	`abs
–
piOrg
[32] - 
piCur
[32] );

1145 
uiSum
 +
	`abs
–
piOrg
[33] - 
piCur
[33] );

1146 
uiSum
 +
	`abs
–
piOrg
[34] - 
piCur
[34] );

1147 
uiSum
 +
	`abs
–
piOrg
[35] - 
piCur
[35] );

1148 
uiSum
 +
	`abs
–
piOrg
[36] - 
piCur
[36] );

1149 
uiSum
 +
	`abs
–
piOrg
[37] - 
piCur
[37] );

1150 
uiSum
 +
	`abs
–
piOrg
[38] - 
piCur
[38] );

1151 
uiSum
 +
	`abs
–
piOrg
[39] - 
piCur
[39] );

1152 
uiSum
 +
	`abs
–
piOrg
[40] - 
piCur
[40] );

1153 
uiSum
 +
	`abs
–
piOrg
[41] - 
piCur
[41] );

1154 
uiSum
 +
	`abs
–
piOrg
[42] - 
piCur
[42] );

1155 
uiSum
 +
	`abs
–
piOrg
[43] - 
piCur
[43] );

1156 
uiSum
 +
	`abs
–
piOrg
[44] - 
piCur
[44] );

1157 
uiSum
 +
	`abs
–
piOrg
[45] - 
piCur
[45] );

1158 
uiSum
 +
	`abs
–
piOrg
[46] - 
piCur
[46] );

1159 
uiSum
 +
	`abs
–
piOrg
[47] - 
piCur
[47] );

1161 
piOrg
 +
iSåideOrg
;

1162 
piCur
 +
iSåideCur
;

1164 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

1168 
uiSum
 <<
iSubShi·
;

1169  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

1170 
	}
}

1176 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSSE
–
Di°P¨am
* 
pcDtP¨am
 )

1178 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1180  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSSEw
–
pcDtP¨am
 );

1182 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1183 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1184 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1185 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

1186 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1187 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1189 
Di°‹ti⁄
 
uiSum
 = 0;

1190 
UI¡
 
uiShi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

1192 
I¡îmedüã_I¡
 
iTemp
;

1194  ; 
iRows
 != 0; iRows-- )

1196 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

1198 
iTemp
 = 
piOrg
[
n
 ] - 
piCur
[n ];

1199 
uiSum
 +
	`Di°‹ti⁄
(–
iTemp
 * iTem∞Ë>> 
uiShi·
);

1201 
piOrg
 +
iSåideOrg
;

1202 
piCur
 +
iSåideCur
;

1205  ( 
uiSum
 );

1206 
	}
}

1208 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSSE4
–
Di°P¨am
* 
pcDtP¨am
 )

1210 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1212 
	`as£π
–
pcDtP¨am
->
iCﬁs
 == 4 );

1213  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSSEw
–
pcDtP¨am
 );

1215 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1216 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1217 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1218 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1219 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1221 
Di°‹ti⁄
 
uiSum
 = 0;

1222 
UI¡
 
uiShi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

1224 
I¡îmedüã_I¡
 
iTemp
;

1226  ; 
iRows
 != 0; iRows-- )

1229 
iTemp
 = 
piOrg
[0] - 
piCur
[0]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1230 
iTemp
 = 
piOrg
[1] - 
piCur
[1]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1231 
iTemp
 = 
piOrg
[2] - 
piCur
[2]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1232 
iTemp
 = 
piOrg
[3] - 
piCur
[3]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1234 
piOrg
 +
iSåideOrg
;

1235 
piCur
 +
iSåideCur
;

1238  ( 
uiSum
 );

1239 
	}
}

1241 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSSE8
–
Di°P¨am
* 
pcDtP¨am
 )

1243 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1245 
	`as£π
–
pcDtP¨am
->
iCﬁs
 == 8 );

1246  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSSEw
–
pcDtP¨am
 );

1248 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1249 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1250 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1251 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1252 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1254 
Di°‹ti⁄
 
uiSum
 = 0;

1255 
UI¡
 
uiShi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

1257 
I¡îmedüã_I¡
 
iTemp
;

1259  ; 
iRows
 != 0; iRows-- )

1261 
iTemp
 = 
piOrg
[0] - 
piCur
[0]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1262 
iTemp
 = 
piOrg
[1] - 
piCur
[1]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1263 
iTemp
 = 
piOrg
[2] - 
piCur
[2]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1264 
iTemp
 = 
piOrg
[3] - 
piCur
[3]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1265 
iTemp
 = 
piOrg
[4] - 
piCur
[4]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1266 
iTemp
 = 
piOrg
[5] - 
piCur
[5]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1267 
iTemp
 = 
piOrg
[6] - 
piCur
[6]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1268 
iTemp
 = 
piOrg
[7] - 
piCur
[7]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1270 
piOrg
 +
iSåideOrg
;

1271 
piCur
 +
iSåideCur
;

1274  ( 
uiSum
 );

1275 
	}
}

1277 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSSE16
–
Di°P¨am
* 
pcDtP¨am
 )

1279 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1281 
	`as£π
–
pcDtP¨am
->
iCﬁs
 == 16 );

1282  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSSEw
–
pcDtP¨am
 );

1284 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1285 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1286 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1287 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1288 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1290 
Di°‹ti⁄
 
uiSum
 = 0;

1291 
UI¡
 
uiShi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

1293 
I¡îmedüã_I¡
 
iTemp
;

1295  ; 
iRows
 != 0; iRows-- )

1298 
iTemp
 = 
piOrg
[ 0] - 
piCur
[ 0]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1299 
iTemp
 = 
piOrg
[ 1] - 
piCur
[ 1]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1300 
iTemp
 = 
piOrg
[ 2] - 
piCur
[ 2]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1301 
iTemp
 = 
piOrg
[ 3] - 
piCur
[ 3]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1302 
iTemp
 = 
piOrg
[ 4] - 
piCur
[ 4]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1303 
iTemp
 = 
piOrg
[ 5] - 
piCur
[ 5]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1304 
iTemp
 = 
piOrg
[ 6] - 
piCur
[ 6]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1305 
iTemp
 = 
piOrg
[ 7] - 
piCur
[ 7]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1306 
iTemp
 = 
piOrg
[ 8] - 
piCur
[ 8]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1307 
iTemp
 = 
piOrg
[ 9] - 
piCur
[ 9]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1308 
iTemp
 = 
piOrg
[10] - 
piCur
[10]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1309 
iTemp
 = 
piOrg
[11] - 
piCur
[11]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1310 
iTemp
 = 
piOrg
[12] - 
piCur
[12]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1311 
iTemp
 = 
piOrg
[13] - 
piCur
[13]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1312 
iTemp
 = 
piOrg
[14] - 
piCur
[14]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1313 
iTemp
 = 
piOrg
[15] - 
piCur
[15]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1315 
piOrg
 +
iSåideOrg
;

1316 
piCur
 +
iSåideCur
;

1319  ( 
uiSum
 );

1320 
	}
}

1322 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSSE16N
–
Di°P¨am
* 
pcDtP¨am
 )

1324 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1326  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSSEw
–
pcDtP¨am
 );

1328 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1329 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1330 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1331 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

1332 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1333 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1335 
Di°‹ti⁄
 
uiSum
 = 0;

1336 
UI¡
 
uiShi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

1338 
I¡îmedüã_I¡
 
iTemp
;

1340  ; 
iRows
 != 0; iRows-- )

1342 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç+=16 )

1345 
iTemp
 = 
piOrg
[
n
+ 0] - 
piCur
[n+ 0]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1346 
iTemp
 = 
piOrg
[
n
+ 1] - 
piCur
[n+ 1]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1347 
iTemp
 = 
piOrg
[
n
+ 2] - 
piCur
[n+ 2]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1348 
iTemp
 = 
piOrg
[
n
+ 3] - 
piCur
[n+ 3]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1349 
iTemp
 = 
piOrg
[
n
+ 4] - 
piCur
[n+ 4]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1350 
iTemp
 = 
piOrg
[
n
+ 5] - 
piCur
[n+ 5]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1351 
iTemp
 = 
piOrg
[
n
+ 6] - 
piCur
[n+ 6]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1352 
iTemp
 = 
piOrg
[
n
+ 7] - 
piCur
[n+ 7]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1353 
iTemp
 = 
piOrg
[
n
+ 8] - 
piCur
[n+ 8]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1354 
iTemp
 = 
piOrg
[
n
+ 9] - 
piCur
[n+ 9]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1355 
iTemp
 = 
piOrg
[
n
+10] - 
piCur
[n+10]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1356 
iTemp
 = 
piOrg
[
n
+11] - 
piCur
[n+11]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1357 
iTemp
 = 
piOrg
[
n
+12] - 
piCur
[n+12]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1358 
iTemp
 = 
piOrg
[
n
+13] - 
piCur
[n+13]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1359 
iTemp
 = 
piOrg
[
n
+14] - 
piCur
[n+14]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1360 
iTemp
 = 
piOrg
[
n
+15] - 
piCur
[n+15]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1363 
piOrg
 +
iSåideOrg
;

1364 
piCur
 +
iSåideCur
;

1367  ( 
uiSum
 );

1368 
	}
}

1370 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSSE32
–
Di°P¨am
* 
pcDtP¨am
 )

1372 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1374 
	`as£π
–
pcDtP¨am
->
iCﬁs
 == 32 );

1375  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSSEw
–
pcDtP¨am
 );

1377 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1378 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1379 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1380 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1381 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1383 
Di°‹ti⁄
 
uiSum
 = 0;

1384 
UI¡
 
uiShi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

1386 
I¡îmedüã_I¡
 
iTemp
;

1388  ; 
iRows
 != 0; iRows-- )

1391 
iTemp
 = 
piOrg
[ 0] - 
piCur
[ 0]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1392 
iTemp
 = 
piOrg
[ 1] - 
piCur
[ 1]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1393 
iTemp
 = 
piOrg
[ 2] - 
piCur
[ 2]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1394 
iTemp
 = 
piOrg
[ 3] - 
piCur
[ 3]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1395 
iTemp
 = 
piOrg
[ 4] - 
piCur
[ 4]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1396 
iTemp
 = 
piOrg
[ 5] - 
piCur
[ 5]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1397 
iTemp
 = 
piOrg
[ 6] - 
piCur
[ 6]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1398 
iTemp
 = 
piOrg
[ 7] - 
piCur
[ 7]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1399 
iTemp
 = 
piOrg
[ 8] - 
piCur
[ 8]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1400 
iTemp
 = 
piOrg
[ 9] - 
piCur
[ 9]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1401 
iTemp
 = 
piOrg
[10] - 
piCur
[10]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1402 
iTemp
 = 
piOrg
[11] - 
piCur
[11]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1403 
iTemp
 = 
piOrg
[12] - 
piCur
[12]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1404 
iTemp
 = 
piOrg
[13] - 
piCur
[13]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1405 
iTemp
 = 
piOrg
[14] - 
piCur
[14]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1406 
iTemp
 = 
piOrg
[15] - 
piCur
[15]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1407 
iTemp
 = 
piOrg
[16] - 
piCur
[16]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1408 
iTemp
 = 
piOrg
[17] - 
piCur
[17]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1409 
iTemp
 = 
piOrg
[18] - 
piCur
[18]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1410 
iTemp
 = 
piOrg
[19] - 
piCur
[19]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1411 
iTemp
 = 
piOrg
[20] - 
piCur
[20]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1412 
iTemp
 = 
piOrg
[21] - 
piCur
[21]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1413 
iTemp
 = 
piOrg
[22] - 
piCur
[22]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1414 
iTemp
 = 
piOrg
[23] - 
piCur
[23]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1415 
iTemp
 = 
piOrg
[24] - 
piCur
[24]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1416 
iTemp
 = 
piOrg
[25] - 
piCur
[25]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1417 
iTemp
 = 
piOrg
[26] - 
piCur
[26]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1418 
iTemp
 = 
piOrg
[27] - 
piCur
[27]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1419 
iTemp
 = 
piOrg
[28] - 
piCur
[28]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1420 
iTemp
 = 
piOrg
[29] - 
piCur
[29]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1421 
iTemp
 = 
piOrg
[30] - 
piCur
[30]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1422 
iTemp
 = 
piOrg
[31] - 
piCur
[31]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1424 
piOrg
 +
iSåideOrg
;

1425 
piCur
 +
iSåideCur
;

1428  ( 
uiSum
 );

1429 
	}
}

1431 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëSSE64
–
Di°P¨am
* 
pcDtP¨am
 )

1433 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1435 
	`as£π
–
pcDtP¨am
->
iCﬁs
 == 64 );

1436  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëSSEw
–
pcDtP¨am
 );

1438 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1439 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1440 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1441 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1442 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1444 
Di°‹ti⁄
 
uiSum
 = 0;

1445 
UI¡
 
uiShi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

1447 
I¡îmedüã_I¡
 
iTemp
;

1449  ; 
iRows
 != 0; iRows-- )

1451 
iTemp
 = 
piOrg
[ 0] - 
piCur
[ 0]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1452 
iTemp
 = 
piOrg
[ 1] - 
piCur
[ 1]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1453 
iTemp
 = 
piOrg
[ 2] - 
piCur
[ 2]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1454 
iTemp
 = 
piOrg
[ 3] - 
piCur
[ 3]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1455 
iTemp
 = 
piOrg
[ 4] - 
piCur
[ 4]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1456 
iTemp
 = 
piOrg
[ 5] - 
piCur
[ 5]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1457 
iTemp
 = 
piOrg
[ 6] - 
piCur
[ 6]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1458 
iTemp
 = 
piOrg
[ 7] - 
piCur
[ 7]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1459 
iTemp
 = 
piOrg
[ 8] - 
piCur
[ 8]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1460 
iTemp
 = 
piOrg
[ 9] - 
piCur
[ 9]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1461 
iTemp
 = 
piOrg
[10] - 
piCur
[10]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1462 
iTemp
 = 
piOrg
[11] - 
piCur
[11]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1463 
iTemp
 = 
piOrg
[12] - 
piCur
[12]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1464 
iTemp
 = 
piOrg
[13] - 
piCur
[13]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1465 
iTemp
 = 
piOrg
[14] - 
piCur
[14]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1466 
iTemp
 = 
piOrg
[15] - 
piCur
[15]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1467 
iTemp
 = 
piOrg
[16] - 
piCur
[16]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1468 
iTemp
 = 
piOrg
[17] - 
piCur
[17]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1469 
iTemp
 = 
piOrg
[18] - 
piCur
[18]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1470 
iTemp
 = 
piOrg
[19] - 
piCur
[19]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1471 
iTemp
 = 
piOrg
[20] - 
piCur
[20]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1472 
iTemp
 = 
piOrg
[21] - 
piCur
[21]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1473 
iTemp
 = 
piOrg
[22] - 
piCur
[22]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1474 
iTemp
 = 
piOrg
[23] - 
piCur
[23]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1475 
iTemp
 = 
piOrg
[24] - 
piCur
[24]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1476 
iTemp
 = 
piOrg
[25] - 
piCur
[25]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1477 
iTemp
 = 
piOrg
[26] - 
piCur
[26]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1478 
iTemp
 = 
piOrg
[27] - 
piCur
[27]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1479 
iTemp
 = 
piOrg
[28] - 
piCur
[28]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1480 
iTemp
 = 
piOrg
[29] - 
piCur
[29]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1481 
iTemp
 = 
piOrg
[30] - 
piCur
[30]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1482 
iTemp
 = 
piOrg
[31] - 
piCur
[31]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1483 
iTemp
 = 
piOrg
[32] - 
piCur
[32]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1484 
iTemp
 = 
piOrg
[33] - 
piCur
[33]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1485 
iTemp
 = 
piOrg
[34] - 
piCur
[34]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1486 
iTemp
 = 
piOrg
[35] - 
piCur
[35]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1487 
iTemp
 = 
piOrg
[36] - 
piCur
[36]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1488 
iTemp
 = 
piOrg
[37] - 
piCur
[37]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1489 
iTemp
 = 
piOrg
[38] - 
piCur
[38]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1490 
iTemp
 = 
piOrg
[39] - 
piCur
[39]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1491 
iTemp
 = 
piOrg
[40] - 
piCur
[40]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1492 
iTemp
 = 
piOrg
[41] - 
piCur
[41]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1493 
iTemp
 = 
piOrg
[42] - 
piCur
[42]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1494 
iTemp
 = 
piOrg
[43] - 
piCur
[43]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1495 
iTemp
 = 
piOrg
[44] - 
piCur
[44]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1496 
iTemp
 = 
piOrg
[45] - 
piCur
[45]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1497 
iTemp
 = 
piOrg
[46] - 
piCur
[46]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1498 
iTemp
 = 
piOrg
[47] - 
piCur
[47]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1499 
iTemp
 = 
piOrg
[48] - 
piCur
[48]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1500 
iTemp
 = 
piOrg
[49] - 
piCur
[49]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1501 
iTemp
 = 
piOrg
[50] - 
piCur
[50]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1502 
iTemp
 = 
piOrg
[51] - 
piCur
[51]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1503 
iTemp
 = 
piOrg
[52] - 
piCur
[52]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1504 
iTemp
 = 
piOrg
[53] - 
piCur
[53]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1505 
iTemp
 = 
piOrg
[54] - 
piCur
[54]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1506 
iTemp
 = 
piOrg
[55] - 
piCur
[55]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1507 
iTemp
 = 
piOrg
[56] - 
piCur
[56]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1508 
iTemp
 = 
piOrg
[57] - 
piCur
[57]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1509 
iTemp
 = 
piOrg
[58] - 
piCur
[58]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1510 
iTemp
 = 
piOrg
[59] - 
piCur
[59]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1511 
iTemp
 = 
piOrg
[60] - 
piCur
[60]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1512 
iTemp
 = 
piOrg
[61] - 
piCur
[61]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1513 
iTemp
 = 
piOrg
[62] - 
piCur
[62]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1514 
iTemp
 = 
piOrg
[63] - 
piCur
[63]; 
uiSum
 +
	`Di°‹ti⁄
(–iTem∞* iTem∞Ë>> 
uiShi·
);

1516 
piOrg
 +
iSåideOrg
;

1517 
piCur
 +
iSåideCur
;

1520  ( 
uiSum
 );

1521 
	}
}

1527 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xCÆcHADs2x2
–c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCur
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 )

1529 
Di°‹ti⁄
 
ßtd
 = 0;

1530 
TC€ff
 
diff
[4], 
m
[4];

1531 
	`as£π
–
iSãp
 == 1 );

1532 
diff
[0] = 
piOrg
[0 ] - 
piCur
[0];

1533 
diff
[1] = 
piOrg
[1 ] - 
piCur
[1];

1534 
diff
[2] = 
piOrg
[
iSåideOrg
 ] - 
piCur
[0 + 
iSåideCur
];

1535 
diff
[3] = 
piOrg
[
iSåideOrg
 + 1] - 
piCur
[1 + 
iSåideCur
];

1536 
m
[0] = 
diff
[0] + diff[2];

1537 
m
[1] = 
diff
[1] + diff[3];

1538 
m
[2] = 
diff
[0] - diff[2];

1539 
m
[3] = 
diff
[1] - diff[3];

1541 
ßtd
 +
	`abs
(
m
[0] + m[1]);

1542 
ßtd
 +
	`abs
(
m
[0] - m[1]);

1543 
ßtd
 +
	`abs
(
m
[2] + m[3]);

1544 
ßtd
 +
	`abs
(
m
[2] - m[3]);

1546  
ßtd
;

1547 
	}
}

1549 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xCÆcHADs4x4
–c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCur
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 )

1551 
I¡
 
k
;

1552 
Di°‹ti⁄
 
ßtd
 = 0;

1553 
TC€ff
 
diff
[16], 
m
[16], 
d
[16];

1555 
	`as£π
–
iSãp
 == 1 );

1556  
k
 = 0; k < 16; k+=4 )

1558 
diff
[
k
+0] = 
piOrg
[0] - 
piCur
[0];

1559 
diff
[
k
+1] = 
piOrg
[1] - 
piCur
[1];

1560 
diff
[
k
+2] = 
piOrg
[2] - 
piCur
[2];

1561 
diff
[
k
+3] = 
piOrg
[3] - 
piCur
[3];

1563 
piCur
 +
iSåideCur
;

1564 
piOrg
 +
iSåideOrg
;

1568 
m
[ 0] = 
diff
[ 0] + diff[12];

1569 
m
[ 1] = 
diff
[ 1] + diff[13];

1570 
m
[ 2] = 
diff
[ 2] + diff[14];

1571 
m
[ 3] = 
diff
[ 3] + diff[15];

1572 
m
[ 4] = 
diff
[ 4] + diff[ 8];

1573 
m
[ 5] = 
diff
[ 5] + diff[ 9];

1574 
m
[ 6] = 
diff
[ 6] + diff[10];

1575 
m
[ 7] = 
diff
[ 7] + diff[11];

1576 
m
[ 8] = 
diff
[ 4] - diff[ 8];

1577 
m
[ 9] = 
diff
[ 5] - diff[ 9];

1578 
m
[10] = 
diff
[ 6] - diff[10];

1579 
m
[11] = 
diff
[ 7] - diff[11];

1580 
m
[12] = 
diff
[ 0] - diff[12];

1581 
m
[13] = 
diff
[ 1] - diff[13];

1582 
m
[14] = 
diff
[ 2] - diff[14];

1583 
m
[15] = 
diff
[ 3] - diff[15];

1585 
d
[ 0] = 
m
[ 0] + m[ 4];

1586 
d
[ 1] = 
m
[ 1] + m[ 5];

1587 
d
[ 2] = 
m
[ 2] + m[ 6];

1588 
d
[ 3] = 
m
[ 3] + m[ 7];

1589 
d
[ 4] = 
m
[ 8] + m[12];

1590 
d
[ 5] = 
m
[ 9] + m[13];

1591 
d
[ 6] = 
m
[10] + m[14];

1592 
d
[ 7] = 
m
[11] + m[15];

1593 
d
[ 8] = 
m
[ 0] - m[ 4];

1594 
d
[ 9] = 
m
[ 1] - m[ 5];

1595 
d
[10] = 
m
[ 2] - m[ 6];

1596 
d
[11] = 
m
[ 3] - m[ 7];

1597 
d
[12] = 
m
[12] - m[ 8];

1598 
d
[13] = 
m
[13] - m[ 9];

1599 
d
[14] = 
m
[14] - m[10];

1600 
d
[15] = 
m
[15] - m[11];

1602 
m
[ 0] = 
d
[ 0] + d[ 3];

1603 
m
[ 1] = 
d
[ 1] + d[ 2];

1604 
m
[ 2] = 
d
[ 1] - d[ 2];

1605 
m
[ 3] = 
d
[ 0] - d[ 3];

1606 
m
[ 4] = 
d
[ 4] + d[ 7];

1607 
m
[ 5] = 
d
[ 5] + d[ 6];

1608 
m
[ 6] = 
d
[ 5] - d[ 6];

1609 
m
[ 7] = 
d
[ 4] - d[ 7];

1610 
m
[ 8] = 
d
[ 8] + d[11];

1611 
m
[ 9] = 
d
[ 9] + d[10];

1612 
m
[10] = 
d
[ 9] - d[10];

1613 
m
[11] = 
d
[ 8] - d[11];

1614 
m
[12] = 
d
[12] + d[15];

1615 
m
[13] = 
d
[13] + d[14];

1616 
m
[14] = 
d
[13] - d[14];

1617 
m
[15] = 
d
[12] - d[15];

1619 
d
[ 0] = 
m
[ 0] + m[ 1];

1620 
d
[ 1] = 
m
[ 0] - m[ 1];

1621 
d
[ 2] = 
m
[ 2] + m[ 3];

1622 
d
[ 3] = 
m
[ 3] - m[ 2];

1623 
d
[ 4] = 
m
[ 4] + m[ 5];

1624 
d
[ 5] = 
m
[ 4] - m[ 5];

1625 
d
[ 6] = 
m
[ 6] + m[ 7];

1626 
d
[ 7] = 
m
[ 7] - m[ 6];

1627 
d
[ 8] = 
m
[ 8] + m[ 9];

1628 
d
[ 9] = 
m
[ 8] - m[ 9];

1629 
d
[10] = 
m
[10] + m[11];

1630 
d
[11] = 
m
[11] - m[10];

1631 
d
[12] = 
m
[12] + m[13];

1632 
d
[13] = 
m
[12] - m[13];

1633 
d
[14] = 
m
[14] + m[15];

1634 
d
[15] = 
m
[15] - m[14];

1636 
k
=0; k<16; ++k)

1638 
ßtd
 +
	`abs
(
d
[
k
]);

1640 
ßtd
 = ((satd+1)>>1);

1642  
ßtd
;

1643 
	}
}

1645 
Di°‹ti⁄
 
	gTComRdCo°
::
xCÆcHADs8x8
–c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCur
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp


1646 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

1647 , 
I¡
 
bôDïth


1651 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

1652 if–
	gbôDïth
 <= 10 )

1654 –
simdHADs8x8
–
piOrg
 , 
piCur
 , 
iSåideOrg
 , 
iSåideCur
 ) );

1657 
I¡
 
	gk
, 
	gi
, 
	gj
, 
	gjj
;

1658 
Di°‹ti⁄
 
	gßd
 = 0;

1659 
TC€ff
 
	gdiff
[64], 
	gm1
[8][8], 
	gm2
[8][8], 
	gm3
[8][8];

1660 
as£π
–
iSãp
 == 1 );

1661  
	gk
 = 0; k < 64; k += 8 )

1663 
diff
[
k
+0] = 
piOrg
[0] - 
piCur
[0];

1664 
	gdiff
[
k
+1] = 
piOrg
[1] - 
piCur
[1];

1665 
	gdiff
[
k
+2] = 
piOrg
[2] - 
piCur
[2];

1666 
	gdiff
[
k
+3] = 
piOrg
[3] - 
piCur
[3];

1667 
	gdiff
[
k
+4] = 
piOrg
[4] - 
piCur
[4];

1668 
	gdiff
[
k
+5] = 
piOrg
[5] - 
piCur
[5];

1669 
	gdiff
[
k
+6] = 
piOrg
[6] - 
piCur
[6];

1670 
	gdiff
[
k
+7] = 
piOrg
[7] - 
piCur
[7];

1672 
	gpiCur
 +
iSåideCur
;

1673 
	gpiOrg
 +
iSåideOrg
;

1677 
	gj
=0; j < 8; j++)

1679 
	gjj
 = 
j
 << 3;

1680 
	gm2
[
j
][0] = 
diff
[
jj
 ] + diff[jj+4];

1681 
	gm2
[
j
][1] = 
diff
[
jj
+1] + diff[jj+5];

1682 
	gm2
[
j
][2] = 
diff
[
jj
+2] + diff[jj+6];

1683 
	gm2
[
j
][3] = 
diff
[
jj
+3] + diff[jj+7];

1684 
	gm2
[
j
][4] = 
diff
[
jj
 ] - diff[jj+4];

1685 
	gm2
[
j
][5] = 
diff
[
jj
+1] - diff[jj+5];

1686 
	gm2
[
j
][6] = 
diff
[
jj
+2] - diff[jj+6];

1687 
	gm2
[
j
][7] = 
diff
[
jj
+3] - diff[jj+7];

1689 
	gm1
[
j
][0] = 
m2
[j][0] + m2[j][2];

1690 
	gm1
[
j
][1] = 
m2
[j][1] + m2[j][3];

1691 
	gm1
[
j
][2] = 
m2
[j][0] - m2[j][2];

1692 
	gm1
[
j
][3] = 
m2
[j][1] - m2[j][3];

1693 
	gm1
[
j
][4] = 
m2
[j][4] + m2[j][6];

1694 
	gm1
[
j
][5] = 
m2
[j][5] + m2[j][7];

1695 
	gm1
[
j
][6] = 
m2
[j][4] - m2[j][6];

1696 
	gm1
[
j
][7] = 
m2
[j][5] - m2[j][7];

1698 
	gm2
[
j
][0] = 
m1
[j][0] + m1[j][1];

1699 
	gm2
[
j
][1] = 
m1
[j][0] - m1[j][1];

1700 
	gm2
[
j
][2] = 
m1
[j][2] + m1[j][3];

1701 
	gm2
[
j
][3] = 
m1
[j][2] - m1[j][3];

1702 
	gm2
[
j
][4] = 
m1
[j][4] + m1[j][5];

1703 
	gm2
[
j
][5] = 
m1
[j][4] - m1[j][5];

1704 
	gm2
[
j
][6] = 
m1
[j][6] + m1[j][7];

1705 
	gm2
[
j
][7] = 
m1
[j][6] - m1[j][7];

1709 
	gi
=0; i < 8; i++)

1711 
	gm3
[0][
i
] = 
m2
[0][i] + m2[4][i];

1712 
	gm3
[1][
i
] = 
m2
[1][i] + m2[5][i];

1713 
	gm3
[2][
i
] = 
m2
[2][i] + m2[6][i];

1714 
	gm3
[3][
i
] = 
m2
[3][i] + m2[7][i];

1715 
	gm3
[4][
i
] = 
m2
[0][i] - m2[4][i];

1716 
	gm3
[5][
i
] = 
m2
[1][i] - m2[5][i];

1717 
	gm3
[6][
i
] = 
m2
[2][i] - m2[6][i];

1718 
	gm3
[7][
i
] = 
m2
[3][i] - m2[7][i];

1720 
	gm1
[0][
i
] = 
m3
[0][i] + m3[2][i];

1721 
	gm1
[1][
i
] = 
m3
[1][i] + m3[3][i];

1722 
	gm1
[2][
i
] = 
m3
[0][i] - m3[2][i];

1723 
	gm1
[3][
i
] = 
m3
[1][i] - m3[3][i];

1724 
	gm1
[4][
i
] = 
m3
[4][i] + m3[6][i];

1725 
	gm1
[5][
i
] = 
m3
[5][i] + m3[7][i];

1726 
	gm1
[6][
i
] = 
m3
[4][i] - m3[6][i];

1727 
	gm1
[7][
i
] = 
m3
[5][i] - m3[7][i];

1729 
	gm2
[0][
i
] = 
m1
[0][i] + m1[1][i];

1730 
	gm2
[1][
i
] = 
m1
[0][i] - m1[1][i];

1731 
	gm2
[2][
i
] = 
m1
[2][i] + m1[3][i];

1732 
	gm2
[3][
i
] = 
m1
[2][i] - m1[3][i];

1733 
	gm2
[4][
i
] = 
m1
[4][i] + m1[5][i];

1734 
	gm2
[5][
i
] = 
m1
[4][i] - m1[5][i];

1735 
	gm2
[6][
i
] = 
m1
[6][i] + m1[7][i];

1736 
	gm2
[7][
i
] = 
m1
[6][i] - m1[7][i];

1739 
	gi
 = 0; i < 8; i++)

1741 
	gj
 = 0; j < 8; j++)

1743 
	gßd
 +
abs
(
m2
[
i
][
j
]);

1747 
	gßd
=((
ßd
+2)>>2);

1749  
	gßd
;

1753 
Di°‹ti⁄
 
	gTComRdCo°
::
	$xGëHADs
–
Di°P¨am
* 
pcDtP¨am
 )

1755 i‡–
pcDtP¨am
->
bAµlyWeight
 )

1757  
TComRdCo°WeightPªdi˘i⁄
::
	`xGëHADsw
–
pcDtP¨am
 );

1759 c⁄° 
Pñ
* 
piOrg
 = 
pcDtP¨am
->
pOrg
;

1760 c⁄° 
Pñ
* 
piCur
 = 
pcDtP¨am
->
pCur
;

1761 c⁄° 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

1762 c⁄° 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

1763 c⁄° 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

1764 c⁄° 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

1765 c⁄° 
I¡
 
iSãp
 = 
pcDtP¨am
->iStep;

1767 
I¡
 
x
, 
y
;

1769 
Di°‹ti⁄
 
uiSum
 = 0;

1771 if––
iRows
 % 8 =0Ë&& (
iCﬁs
 % 8 == 0) )

1773 
I¡
 
iOff£tOrg
 = 
iSåideOrg
<<3;

1774 
I¡
 
iOff£tCur
 = 
iSåideCur
<<3;

1775  
y
=0; y<
iRows
; y+= 8 )

1777  
x
=0; x<
iCﬁs
; x+= 8 )

1779 
uiSum
 +
	`xCÆcHADs8x8
–&
piOrg
[
x
], &
piCur
[x*
iSãp
], 
iSåideOrg
, 
iSåideCur
, iStep

1780 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

1781 , 
pcDtP¨am
->
bôDïth


1785 
piOrg
 +
iOff£tOrg
;

1786 
piCur
 +
iOff£tCur
;

1789 if––
iRows
 % 4 =0Ë&& (
iCﬁs
 % 4 == 0) )

1791 
I¡
 
iOff£tOrg
 = 
iSåideOrg
<<2;

1792 
I¡
 
iOff£tCur
 = 
iSåideCur
<<2;

1794  
y
=0; y<
iRows
; y+= 4 )

1796  
x
=0; x<
iCﬁs
; x+= 4 )

1798 
uiSum
 +
	`xCÆcHADs4x4
–&
piOrg
[
x
], &
piCur
[x*
iSãp
], 
iSåideOrg
, 
iSåideCur
, iStep );

1800 
piOrg
 +
iOff£tOrg
;

1801 
piCur
 +
iOff£tCur
;

1804 if––
iRows
 % 2 =0Ë&& (
iCﬁs
 % 2 == 0) )

1806 
I¡
 
iOff£tOrg
 = 
iSåideOrg
<<1;

1807 
I¡
 
iOff£tCur
 = 
iSåideCur
<<1;

1808  
y
=0; y<
iRows
; y+=2 )

1810  
x
=0; x<
iCﬁs
; x+=2 )

1812 
uiSum
 +
	`xCÆcHADs2x2
–&
piOrg
[
x
], &
piCur
[x*
iSãp
], 
iSåideOrg
, 
iSåideCur
, iStep );

1814 
piOrg
 +
iOff£tOrg
;

1815 
piCur
 +
iOff£tCur
;

1820 
	`as£π
(
Ál£
);

1823  ( 
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8) );

1824 
	}
}

	@TLibCommon/TComRdCost.h

38 #i‚de‡
__TCOMRDCOST__


39 
	#__TCOMRDCOST__


	)

42 
	~"Comm⁄Def.h
"

43 
	~"TComP©ã∫.h
"

44 
	~"TComMv.h
"

46 
	~"TComSli˚.h
"

47 
	~"TComRdCo°WeightPªdi˘i⁄.h
"

52 
˛ass
 
	gDi°P¨am
;

53 
˛ass
 
	gTComP©ã∫
;

60 
	$Di°‹ti⁄
 (*
	tFpDi°Func
Ë(
	tDi°P¨am
*);

67 ˛as†
	cDi°P¨am


69 
public
:

70 c⁄° 
Pñ
* 
pOrg
;

71 c⁄° 
Pñ
* 
pCur
;

72 
I¡
 
iSåideOrg
;

73 
I¡
 
iSåideCur
;

74 
I¡
 
iRows
;

75 
I¡
 
iCﬁs
;

76 
I¡
 
iSãp
;

77 
FpDi°Func
 
Di°Func
;

78 
I¡
 
bôDïth
;

80 
Boﬁ
 
bAµlyWeight
;

81 
Boﬁ
 
bIsBiPªd
;

83 c⁄° 
WPSˇlögP¨am
 *
wpCur
;

84 
Comp⁄ítID
 
compIdx
;

85 
Di°‹ti⁄
 
m_maximumDi°‹ti⁄F‹E¨lyExô
;

89 
I¡
 
iSubShi·
;

91 
	$Di°P¨am
()

92 : 
	`pOrg
(
NULL
),

93 
	`pCur
(
NULL
),

94 
	`iSåideOrg
(0),

95 
	`iSåideCur
(0),

96 
	`iRows
(0),

97 
	`iCﬁs
(0),

98 
	`iSãp
(1),

99 
	`Di°Func
(
NULL
),

100 
	`bôDïth
(0),

101 
	`bAµlyWeight
(
Ál£
),

102 
	`bIsBiPªd
(
Ál£
),

103 
	`wpCur
(
NULL
),

104 
	`compIdx
(
MAX_NUM_COMPONENT
),

105 
	`m_maximumDi°‹ti⁄F‹E¨lyExô
(
°d
::
numîic_limôs
<
Di°‹ti⁄
>::
	`max
()),

106 
	$iSubShi·
(0)

108 
	}
};

111 ˛as†
	cTComRdCo°


113 
	m¥iv©e
:

116 
FpDi°Func
 
m_aÂDi°‹tFunc
[
DF_TOTAL_FUNCTIONS
];

117 
Co°Mode
 
	mm_co°Mode
;

118 
DoubÀ
 
	mm_di°‹ti⁄Weight
[
MAX_NUM_COMPONENT
];

119 
DoubÀ
 
	mm_dLambda
;

120 
DoubÀ
 
	mm_sqπLambda
;

121 
DoubÀ
 
	mm_dLambdaMŸi⁄SAD
[2 ];

122 
DoubÀ
 
	mm_dLambdaMŸi⁄SSE
[2 ];

123 
DoubÀ
 
	mm_dFømeLambda
;

126 
TComMv
 
	mm_mvPªdi˘‹
;

127 
DoubÀ
 
	mm_mŸi⁄Lambda
;

128 
I¡
 
	mm_iCo°SˇÀ
;

130 
	mpublic
:

131 
TComRdCo°
();

132 
	mvútuÆ
 ~
TComRdCo°
();

134 
DoubÀ
 
ˇlcRdCo°
–DoubÀ 
numBôs
, 
Di°‹ti⁄
 
di°‹ti⁄
, 
DFunc
 
eDFunc
 = 
DF_DEFAULT
 );

136 
Void
 
	$£tDi°‹ti⁄Weight
 ( c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
DoubÀ
 
di°‹ti⁄Weight
 ) { 
m_di°‹ti⁄Weight
[compID] = distortionWeight; }

137 
Void
 
	`£tLambda
 ( 
DoubÀ
 
dLambda
, c⁄° 
BôDïths
 &
bôDïths
 );

138 
Void
 
	$£tFømeLambda
 ( 
DoubÀ
 
dLambda
 ) { 
m_dFømeLambda
 = dLambda; 
	}
}

140 
DoubÀ
 
	$gëSqπLambda
 (Ë{  
m_sqπLambda
; 
	}
}

142 
DoubÀ
 
	$gëLambda
(Ë{  
m_dLambda
; 
	}
}

143 
DoubÀ
 
	$gëChromaWeight
 (Ë{  ((
m_di°‹ti⁄Weight
[
COMPONENT_Cb
] + m_di°‹ti⁄Weight[
COMPONENT_Cr
]Ë/ 2.0); 
	}
}

145 
Void
 
	$£tCo°Mode
(
Co°Mode
 
m
 ) { 
m_co°Mode
 = m; 
	}
}

148 
Void
 
öô
();

150 
Void
 
£tDi°P¨am
–
UI¡
 
uiBlkWidth
, UI¡ 
uiBlkHeight
, 
DFunc
 
eDFunc
, 
Di°P¨am
& 
rcDi°P¨am
 );

151 
Void
 
£tDi°P¨am
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, c⁄° 
Pñ
* 
piRefY
, 
I¡
 
iRefSåide
, 
Di°P¨am
& 
rcDi°P¨am
 );

152 
Void
 
£tDi°P¨am
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, c⁄° 
Pñ
* 
piRefY
, 
I¡
 
iRefSåide
, I¡ 
iSãp
, 
Di°P¨am
& 
rcDi°P¨am
, 
Boﬁ
 
bHADME
=
Ál£
 );

153 
Void
 
£tDi°P¨am
–
Di°P¨am
& 
rcDP
, 
I¡
 
bôDïth
, c⁄° 
Pñ
* 
p1
, I¡ 
iSåide1
, c⁄° Pñ* 
p2
, I¡ 
iSåide2
, I¡ 
iWidth
, I¡ 
iHeight
, 
Boﬁ
 
bHadam¨d
 = 
Ál£
 );

155 
Di°‹ti⁄
 
ˇlcHAD
(
I¡
 
bôDïth
, c⁄° 
Pñ
* 
pi0
, I¡ 
iSåide0
, c⁄° Pñ* 
pi1
, I¡ 
iSåide1
, I¡ 
iWidth
, I¡ 
iHeight
 );

158 
UI¡
 
xGëExpGﬁombNumbîOfBôs
–
I¡
 
iVÆ
 );

159 
Void
 
	$£À˘MŸi⁄Lambda
–
Boﬁ
 
bSad
, 
I¡
 
iAdd
, Boﬁ 
bIsTønsqu™tBy∑ss
 ) { 
m_mŸi⁄Lambda
 = (bSad ? 
m_dLambdaMŸi⁄SAD
[(bIsTønsqu™tBy∑s†&& 
m_co°Mode
==
COST_MIXED_LOSSLESS_LOSSY_CODING
Ë?1:0] + iAdd : 
m_dLambdaMŸi⁄SSE
[(bIsTønsqu™tBy∑s†&& m_co°Mode==COST_MIXED_LOSSLESS_LOSSY_CODING)?1:0] + iAdd); 
	}
}

160 
Void
 
	$£tPªdi˘‹
–
TComMv
& 
rcMv
 )

162 
m_mvPªdi˘‹
 = 
rcMv
;

163 
	}
}

164 
Void
 
	$£tCo°SˇÀ
–
I¡
 
iCo°SˇÀ
 ) { 
m_iCo°SˇÀ
 = iCo°SˇÀ; 
	}
}

165 
Di°‹ti⁄
 
	$gëCo°
–
UI¡
 
b
 ) {  
	`Di°‹ti⁄
(–
m_mŸi⁄Lambda
 * b ) / 65536.0); 
	}
}

166 
Di°‹ti⁄
 
	$gëCo°OfVe˘‹WôhPªdi˘‹
–c⁄° 
I¡
 
x
, c⁄° I¡ 
y
 )

168  
	`Di°‹ti⁄
((
m_mŸi⁄Lambda
 * 
	`gëBôsOfVe˘‹WôhPªdi˘‹
(
x
, 
y
)) / 65536.0);

169 
	}
}

170 
UI¡
 
	$gëBôsOfVe˘‹WôhPªdi˘‹
–c⁄° 
I¡
 
x
, c⁄° I¡ 
y
 )

172  
	`xGëExpGﬁombNumbîOfBôs
((
x
 << 
m_iCo°SˇÀ
Ë- 
m_mvPªdi˘‹
.
	`gëH‹
())

173 + 
	`xGëExpGﬁombNumbîOfBôs
((
y
 << 
m_iCo°SˇÀ
Ë- 
m_mvPªdi˘‹
.
	`gëVî
());

174 
	}
}

176 
	g¥iv©e
:

178 
Di°‹ti⁄
 
xGëSSE
 ( 
Di°P¨am
* 
pcDtP¨am
 );

179 
Di°‹ti⁄
 
xGëSSE4
 ( 
Di°P¨am
* 
pcDtP¨am
 );

180 
Di°‹ti⁄
 
xGëSSE8
 ( 
Di°P¨am
* 
pcDtP¨am
 );

181 
Di°‹ti⁄
 
xGëSSE16
 ( 
Di°P¨am
* 
pcDtP¨am
 );

182 
Di°‹ti⁄
 
xGëSSE32
 ( 
Di°P¨am
* 
pcDtP¨am
 );

183 
Di°‹ti⁄
 
xGëSSE64
 ( 
Di°P¨am
* 
pcDtP¨am
 );

184 
Di°‹ti⁄
 
xGëSSE16N
 ( 
Di°P¨am
* 
pcDtP¨am
 );

186 
Di°‹ti⁄
 
xGëSAD
 ( 
Di°P¨am
* 
pcDtP¨am
 );

187 
Di°‹ti⁄
 
xGëSAD4
 ( 
Di°P¨am
* 
pcDtP¨am
 );

188 
Di°‹ti⁄
 
xGëSAD8
 ( 
Di°P¨am
* 
pcDtP¨am
 );

189 
Di°‹ti⁄
 
xGëSAD16
 ( 
Di°P¨am
* 
pcDtP¨am
 );

190 
Di°‹ti⁄
 
xGëSAD32
 ( 
Di°P¨am
* 
pcDtP¨am
 );

191 
Di°‹ti⁄
 
xGëSAD64
 ( 
Di°P¨am
* 
pcDtP¨am
 );

192 
Di°‹ti⁄
 
xGëSAD16N
 ( 
Di°P¨am
* 
pcDtP¨am
 );

194 
Di°‹ti⁄
 
xGëSAD12
 ( 
Di°P¨am
* 
pcDtP¨am
 );

195 
Di°‹ti⁄
 
xGëSAD24
 ( 
Di°P¨am
* 
pcDtP¨am
 );

196 
Di°‹ti⁄
 
xGëSAD48
 ( 
Di°P¨am
* 
pcDtP¨am
 );

198 
Di°‹ti⁄
 
xGëHADs
 ( 
Di°P¨am
* 
pcDtP¨am
 );

199 
Di°‹ti⁄
 
xCÆcHADs2x2
 ( c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCuº
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 );

200 
Di°‹ti⁄
 
xCÆcHADs4x4
 ( c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCuº
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 );

201 
Di°‹ti⁄
 
xCÆcHADs8x8
 ( c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCuº
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp


202 #i‡
VECTOR_CODING__DISTORTION_CALCULATIONS
 && (
RExt__HIGH_BIT_DEPTH_SUPPORT
==0)

203 , 
I¡
 
bôDïth


207 
	gpublic
:

209 
Di°‹ti⁄
 
gëDi°P¨t
(
I¡
 
bôDïth
, c⁄° 
Pñ
* 
piCur
, I¡ 
iCurSåide
, c⁄° Pñ* 
piOrg
, I¡ 
iOrgSåide
, 
UI¡
 
uiBlkWidth
, UI¡ 
uiBlkHeight
, c⁄° 
Comp⁄ítID
 
compID
, 
DFunc
 
eDFunc
 = 
DF_SSE
 );

	@TLibCommon/TComRdCostWeightPrediction.cpp

38 
	~<m©h.h
>

39 
	~<as£π.h
>

40 
	~"TComRdCo°.h
"

41 
	~"TComRdCo°WeightPªdi˘i⁄.h
"

43 
Di°‹ti⁄
 
xCÆcHADs2x2w
–c⁄° 
WPSˇlögP¨am
 &
wpCur
, c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCuº
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 );

44 
Di°‹ti⁄
 
xCÆcHADs4x4w
–c⁄° 
WPSˇlögP¨am
 &
wpCur
, c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCuº
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 );

45 
Di°‹ti⁄
 
xCÆcHADs8x8w
–c⁄° 
WPSˇlögP¨am
 &
wpCur
, c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCuº
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 );

55 
Di°‹ti⁄
 
	gTComRdCo°WeightPªdi˘i⁄
::
	$xGëSADw
–
Di°P¨am
* 
pcDtP¨am
 )

57 c⁄° 
Pñ
 *
piOrg
 = 
pcDtP¨am
->
pOrg
;

58 c⁄° 
Pñ
 *
piCur
 = 
pcDtP¨am
->
pCur
;

59 c⁄° 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

60 c⁄° 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

61 c⁄° 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

62 c⁄° 
Comp⁄ítID
 
compID
 = 
pcDtP¨am
->
compIdx
;

64 
	`as£π
(
compID
<
MAX_NUM_COMPONENT
);

66 c⁄° 
WPSˇlögP¨am
 &
wpCur
 = 
pcDtP¨am
->wpCur[
compID
];

68 c⁄° 
I¡
 
w0
 = 
wpCur
.
w
;

69 c⁄° 
I¡
 
off£t
 = 
wpCur
.offset;

70 c⁄° 
I¡
 
shi·
 = 
wpCur
.shift;

71 c⁄° 
I¡
 
round
 = 
wpCur
.round;

72 c⁄° 
I¡
 
di°‹ti⁄Shi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8);

74 
Di°‹ti⁄
 
uiSum
 = 0;

77 i‡(
w0
 =1 << 
shi·
)

80 i‡(
off£t
 == 0)

82 
I¡
 
iRows
 = 
pcDtP¨am
->iRows; iRows != 0; iRows-- )

84 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

86 
uiSum
 +
	`abs
–
piOrg
[
n
] - 
piCur
[n] );

88 i‡(
pcDtP¨am
->
m_maximumDi°‹ti⁄F‹E¨lyExô
 < ( 
uiSum
 >> 
di°‹ti⁄Shi·
))

90  
uiSum
 >> 
di°‹ti⁄Shi·
;

92 
piOrg
 +
iSåideOrg
;

93 
piCur
 +
iSåideCur
;

101 i‡(
pcDtP¨am
->
bIsBiPªd
)

103 
I¡
 
iRows
 = 
pcDtP¨am
->iRows; iRows != 0; iRows-- )

105 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

107 
uiSum
 +
	`abs
–
piOrg
[
n
] - (
piCur
[n] + 
off£t
) );

109 i‡(
pcDtP¨am
->
m_maximumDi°‹ti⁄F‹E¨lyExô
 < ( 
uiSum
 >> 
di°‹ti⁄Shi·
))

111  
uiSum
 >> 
di°‹ti⁄Shi·
;

114 
piOrg
 +
iSåideOrg
;

115 
piCur
 +
iSåideCur
;

120 c⁄° 
Pñ
 
iMaxVÆue
 = (PñË((1 << 
pcDtP¨am
->
bôDïth
) - 1);

121 
I¡
 
iRows
 = 
pcDtP¨am
->iRows; iRows != 0; iRows-- )

123 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

125 c⁄° 
Pñ
 
¥ed
 = 
	`Clù3
((PñË0, 
iMaxVÆue
, (PñË(
piCur
[
n
] + 
off£t
)) ;

127 
uiSum
 +
	`abs
–
piOrg
[
n
] - 
¥ed
 );

129 i‡(
pcDtP¨am
->
m_maximumDi°‹ti⁄F‹E¨lyExô
 < ( 
uiSum
 >> 
di°‹ti⁄Shi·
))

131  
uiSum
 >> 
di°‹ti⁄Shi·
;

133 
piOrg
 +
iSåideOrg
;

134 
piCur
 +
iSåideCur
;

144 i‡(
pcDtP¨am
->
bIsBiPªd
)

146 
I¡
 
iRows
 = 
pcDtP¨am
->iRows; iRows != 0; iRows-- )

148 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

150 c⁄° 
Pñ
 
¥ed
 = ( (
w0
*
piCur
[
n
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

151 
uiSum
 +
	`abs
–
piOrg
[
n
] - 
¥ed
 );

153 i‡(
pcDtP¨am
->
m_maximumDi°‹ti⁄F‹E¨lyExô
 < ( 
uiSum
 >> 
di°‹ti⁄Shi·
))

155  
uiSum
 >> 
di°‹ti⁄Shi·
;

158 
piOrg
 +
iSåideOrg
;

159 
piCur
 +
iSåideCur
;

164 c⁄° 
Pñ
 
iMaxVÆue
 = (PñË((1 << 
pcDtP¨am
->
bôDïth
) - 1);

166 i‡(
off£t
 == 0)

168 
I¡
 
iRows
 = 
pcDtP¨am
->iRows; iRows != 0; iRows-- )

170 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

172 c⁄° 
Pñ
 
¥ed
 = 
	`Clù3
((PñË0, 
iMaxVÆue
, (PñË(–(
w0
*
piCur
[
n
] + 
round
Ë>> 
shi·
 ))) ;

174 
uiSum
 +
	`abs
–
piOrg
[
n
] - 
¥ed
 );

176 i‡(
pcDtP¨am
->
m_maximumDi°‹ti⁄F‹E¨lyExô
 < ( 
uiSum
 >> 
di°‹ti⁄Shi·
))

178  
uiSum
 >> 
di°‹ti⁄Shi·
;

180 
piOrg
 +
iSåideOrg
;

181 
piCur
 +
iSåideCur
;

186 
I¡
 
iRows
 = 
pcDtP¨am
->iRows; iRows != 0; iRows-- )

188 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

190 c⁄° 
Pñ
 
¥ed
 = 
	`Clù3
((PñË0, 
iMaxVÆue
, (PñË(–(
w0
*
piCur
[
n
] + 
round
Ë>> 
shi·
 ) + 
off£t
)) ;

192 
uiSum
 +
	`abs
–
piOrg
[
n
] - 
¥ed
 );

194 i‡(
pcDtP¨am
->
m_maximumDi°‹ti⁄F‹E¨lyExô
 < ( 
uiSum
 >> 
di°‹ti⁄Shi·
))

196  
uiSum
 >> 
di°‹ti⁄Shi·
;

198 
piOrg
 +
iSåideOrg
;

199 
piCur
 +
iSåideCur
;

206  
uiSum
 >> 
di°‹ti⁄Shi·
;

207 
	}
}

217 
Di°‹ti⁄
 
	gTComRdCo°WeightPªdi˘i⁄
::
	$xGëSSEw
–
Di°P¨am
* 
pcDtP¨am
 )

219 c⁄° 
Pñ
 *
piOrg
 = 
pcDtP¨am
->
pOrg
;

220 c⁄° 
Pñ
 *
piCur
 = 
pcDtP¨am
->
pCur
;

221 c⁄° 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

222 c⁄° 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

223 c⁄° 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

224 c⁄° 
Comp⁄ítID
 
compIdx
 = 
pcDtP¨am
->compIdx;

226 
	`as£π
–
pcDtP¨am
->
iSubShi·
 == 0 );

228 
	`as£π
(
compIdx
<
MAX_NUM_COMPONENT
);

229 c⁄° 
WPSˇlögP¨am
 &
wpCur
 = 
pcDtP¨am
->wpCur[
compIdx
];

230 c⁄° 
I¡
 
w0
 = 
wpCur
.
w
;

231 c⁄° 
I¡
 
off£t
 = 
wpCur
.offset;

232 c⁄° 
I¡
 
shi·
 = 
wpCur
.shift;

233 c⁄° 
I¡
 
round
 = 
wpCur
.round;

234 c⁄° 
UI¡
 
di°‹ti⁄Shi·
 = 
	`DISTORTION_PRECISION_ADJUSTMENT
((
pcDtP¨am
->
bôDïth
-8) << 1);

236 
Di°‹ti⁄
 
sum
 = 0;

238 i‡(
pcDtP¨am
->
bIsBiPªd
)

240 
I¡
 
iRows
 = 
pcDtP¨am
->iRows ; iRows != 0; iRows-- )

242 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

244 c⁄° 
Pñ
 
¥ed
 = ( (
w0
*
piCur
[
n
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

245 c⁄° 
Pñ
 
ªsiduÆ
 = 
piOrg
[
n
] - 
¥ed
;

246 
sum
 +–
	`Di°‹ti⁄
(
ªsiduÆ
Ë* Di°‹ti⁄‘esiduÆËË>> 
di°‹ti⁄Shi·
;

248 
piOrg
 +
iSåideOrg
;

249 
piCur
 +
iSåideCur
;

254 c⁄° 
Pñ
 
iMaxVÆue
 = (PñË((1 << 
pcDtP¨am
->
bôDïth
) - 1);

256 
I¡
 
iRows
 = 
pcDtP¨am
->iRows ; iRows != 0; iRows-- )

258 
I¡
 
n
 = 0;Ç < 
iCﬁs
;Ç++ )

260 c⁄° 
Pñ
 
¥ed
 = 
	`Clù3
((PñË0, 
iMaxVÆue
, (PñË(–(
w0
*
piCur
[
n
] + 
round
Ë>> 
shi·
 ) + 
off£t
)) ;

261 c⁄° 
Pñ
 
ªsiduÆ
 = 
piOrg
[
n
] - 
¥ed
;

262 
sum
 +–
	`Di°‹ti⁄
(
ªsiduÆ
Ë* Di°‹ti⁄‘esiduÆËË>> 
di°‹ti⁄Shi·
;

264 
piOrg
 +
iSåideOrg
;

265 
piCur
 +
iSåideCur
;

271  
sum
;

272 
	}
}

279 
Di°‹ti⁄
 
	$xCÆcHADs2x2w
–c⁄° 
WPSˇlögP¨am
 &
wpCur
, c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCur
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 )

281 c⁄° 
I¡
 
round
 = 
wpCur
.round;

282 c⁄° 
I¡
 
shi·
 = 
wpCur
.shift;

283 c⁄° 
I¡
 
off£t
 = 
wpCur
.offset;

284 c⁄° 
I¡
 
w0
 = 
wpCur
.
w
;

286 
Di°‹ti⁄
 
ßtd
 = 0;

287 
TC€ff
 
diff
[4];

288 
TC€ff
 
m
[4];

290 
Pñ
 
¥ed
;

292 
¥ed
 = ( (
w0
*
piCur
[0*
iSãp
 ] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

293 
diff
[0] = 
piOrg
[0 ] - 
¥ed
;

294 
¥ed
 = ( (
w0
*
piCur
[1*
iSãp
 ] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

295 
diff
[1] = 
piOrg
[1 ] - 
¥ed
;

296 
¥ed
 = ( (
w0
*
piCur
[0*
iSãp
 + 
iSåideCur
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

297 
diff
[2] = 
piOrg
[
iSåideOrg
 ] - 
¥ed
;

298 
¥ed
 = ( (
w0
*
piCur
[1*
iSãp
 + 
iSåideCur
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

299 
diff
[3] = 
piOrg
[
iSåideOrg
 + 1] - 
¥ed
;

301 
m
[0] = 
diff
[0] + diff[2];

302 
m
[1] = 
diff
[1] + diff[3];

303 
m
[2] = 
diff
[0] - diff[2];

304 
m
[3] = 
diff
[1] - diff[3];

306 
ßtd
 +
	`abs
(
m
[0] + m[1]);

307 
ßtd
 +
	`abs
(
m
[0] - m[1]);

308 
ßtd
 +
	`abs
(
m
[2] + m[3]);

309 
ßtd
 +
	`abs
(
m
[2] - m[3]);

311  
ßtd
;

312 
	}
}

316 
Di°‹ti⁄
 
	$xCÆcHADs4x4w
–c⁄° 
WPSˇlögP¨am
 &
wpCur
, c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCur
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 )

318 c⁄° 
I¡
 
round
 = 
wpCur
.round;

319 c⁄° 
I¡
 
shi·
 = 
wpCur
.shift;

320 c⁄° 
I¡
 
off£t
 = 
wpCur
.offset;

321 c⁄° 
I¡
 
w0
 = 
wpCur
.
w
;

323 
Di°‹ti⁄
 
ßtd
 = 0;

324 
TC€ff
 
diff
[16];

325 
TC€ff
 
m
[16];

326 
TC€ff
 
d
[16];

329 
I¡
 
k
 = 0; k < 16; k+=4 )

331 
Pñ
 
¥ed
;

332 
¥ed
 = ( (
w0
*
piCur
[0*
iSãp
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

333 
diff
[
k
+0] = 
piOrg
[0] - 
¥ed
;

334 
¥ed
 = ( (
w0
*
piCur
[1*
iSãp
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

335 
diff
[
k
+1] = 
piOrg
[1] - 
¥ed
;

336 
¥ed
 = ( (
w0
*
piCur
[2*
iSãp
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

337 
diff
[
k
+2] = 
piOrg
[2] - 
¥ed
;

338 
¥ed
 = ( (
w0
*
piCur
[3*
iSãp
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

339 
diff
[
k
+3] = 
piOrg
[3] - 
¥ed
;

341 
piCur
 +
iSåideCur
;

342 
piOrg
 +
iSåideOrg
;

346 
m
[ 0] = 
diff
[ 0] + diff[12];

347 
m
[ 1] = 
diff
[ 1] + diff[13];

348 
m
[ 2] = 
diff
[ 2] + diff[14];

349 
m
[ 3] = 
diff
[ 3] + diff[15];

350 
m
[ 4] = 
diff
[ 4] + diff[ 8];

351 
m
[ 5] = 
diff
[ 5] + diff[ 9];

352 
m
[ 6] = 
diff
[ 6] + diff[10];

353 
m
[ 7] = 
diff
[ 7] + diff[11];

354 
m
[ 8] = 
diff
[ 4] - diff[ 8];

355 
m
[ 9] = 
diff
[ 5] - diff[ 9];

356 
m
[10] = 
diff
[ 6] - diff[10];

357 
m
[11] = 
diff
[ 7] - diff[11];

358 
m
[12] = 
diff
[ 0] - diff[12];

359 
m
[13] = 
diff
[ 1] - diff[13];

360 
m
[14] = 
diff
[ 2] - diff[14];

361 
m
[15] = 
diff
[ 3] - diff[15];

363 
d
[ 0] = 
m
[ 0] + m[ 4];

364 
d
[ 1] = 
m
[ 1] + m[ 5];

365 
d
[ 2] = 
m
[ 2] + m[ 6];

366 
d
[ 3] = 
m
[ 3] + m[ 7];

367 
d
[ 4] = 
m
[ 8] + m[12];

368 
d
[ 5] = 
m
[ 9] + m[13];

369 
d
[ 6] = 
m
[10] + m[14];

370 
d
[ 7] = 
m
[11] + m[15];

371 
d
[ 8] = 
m
[ 0] - m[ 4];

372 
d
[ 9] = 
m
[ 1] - m[ 5];

373 
d
[10] = 
m
[ 2] - m[ 6];

374 
d
[11] = 
m
[ 3] - m[ 7];

375 
d
[12] = 
m
[12] - m[ 8];

376 
d
[13] = 
m
[13] - m[ 9];

377 
d
[14] = 
m
[14] - m[10];

378 
d
[15] = 
m
[15] - m[11];

380 
m
[ 0] = 
d
[ 0] + d[ 3];

381 
m
[ 1] = 
d
[ 1] + d[ 2];

382 
m
[ 2] = 
d
[ 1] - d[ 2];

383 
m
[ 3] = 
d
[ 0] - d[ 3];

384 
m
[ 4] = 
d
[ 4] + d[ 7];

385 
m
[ 5] = 
d
[ 5] + d[ 6];

386 
m
[ 6] = 
d
[ 5] - d[ 6];

387 
m
[ 7] = 
d
[ 4] - d[ 7];

388 
m
[ 8] = 
d
[ 8] + d[11];

389 
m
[ 9] = 
d
[ 9] + d[10];

390 
m
[10] = 
d
[ 9] - d[10];

391 
m
[11] = 
d
[ 8] - d[11];

392 
m
[12] = 
d
[12] + d[15];

393 
m
[13] = 
d
[13] + d[14];

394 
m
[14] = 
d
[13] - d[14];

395 
m
[15] = 
d
[12] - d[15];

397 
d
[ 0] = 
m
[ 0] + m[ 1];

398 
d
[ 1] = 
m
[ 0] - m[ 1];

399 
d
[ 2] = 
m
[ 2] + m[ 3];

400 
d
[ 3] = 
m
[ 3] - m[ 2];

401 
d
[ 4] = 
m
[ 4] + m[ 5];

402 
d
[ 5] = 
m
[ 4] - m[ 5];

403 
d
[ 6] = 
m
[ 6] + m[ 7];

404 
d
[ 7] = 
m
[ 7] - m[ 6];

405 
d
[ 8] = 
m
[ 8] + m[ 9];

406 
d
[ 9] = 
m
[ 8] - m[ 9];

407 
d
[10] = 
m
[10] + m[11];

408 
d
[11] = 
m
[11] - m[10];

409 
d
[12] = 
m
[12] + m[13];

410 
d
[13] = 
m
[12] - m[13];

411 
d
[14] = 
m
[14] + m[15];

412 
d
[15] = 
m
[15] - m[14];

414 
I¡
 
k
=0; k<16; ++k)

416 
ßtd
 +
	`abs
(
d
[
k
]);

418 
ßtd
 = ((satd+1)>>1);

420  
ßtd
;

421 
	}
}

425 
Di°‹ti⁄
 
	$xCÆcHADs8x8w
–c⁄° 
WPSˇlögP¨am
 &
wpCur
, c⁄° 
Pñ
 *
piOrg
, c⁄° Pñ *
piCur
, 
I¡
 
iSåideOrg
, I¡ 
iSåideCur
, I¡ 
iSãp
 )

427 
Di°‹ti⁄
 
ßd
=0;

428 
TC€ff
 
diff
[64], 
m1
[8][8], 
m2
[8][8], 
m3
[8][8];

429 
I¡
 
iSãp2
 = 
iSãp
<<1;

430 
I¡
 
iSãp3
 = 
iSãp2
 + 
iSãp
;

431 
I¡
 
iSãp4
 = 
iSãp3
 + 
iSãp
;

432 
I¡
 
iSãp5
 = 
iSãp4
 + 
iSãp
;

433 
I¡
 
iSãp6
 = 
iSãp5
 + 
iSãp
;

434 
I¡
 
iSãp7
 = 
iSãp6
 + 
iSãp
;

435 c⁄° 
I¡
 
round
 = 
wpCur
.round;

436 c⁄° 
I¡
 
shi·
 = 
wpCur
.shift;

437 c⁄° 
I¡
 
off£t
 = 
wpCur
.offset;

438 c⁄° 
I¡
 
w0
 = 
wpCur
.
w
;

440 
Pñ
 
¥ed
;

442 
I¡
 
k
 = 0; k < 64; k+=8 )

444 
¥ed
 = ( (
w0
*
piCur
[ 0] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

445 
diff
[
k
+0] = 
piOrg
[0] - 
¥ed
;

446 
¥ed
 = ( (
w0
*
piCur
[
iSãp
 ] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

447 
diff
[
k
+1] = 
piOrg
[1] - 
¥ed
;

448 
¥ed
 = ( (
w0
*
piCur
[
iSãp2
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

449 
diff
[
k
+2] = 
piOrg
[2] - 
¥ed
;

450 
¥ed
 = ( (
w0
*
piCur
[
iSãp3
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

451 
diff
[
k
+3] = 
piOrg
[3] - 
¥ed
;

452 
¥ed
 = ( (
w0
*
piCur
[
iSãp4
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

453 
diff
[
k
+4] = 
piOrg
[4] - 
¥ed
;

454 
¥ed
 = ( (
w0
*
piCur
[
iSãp5
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

455 
diff
[
k
+5] = 
piOrg
[5] - 
¥ed
;

456 
¥ed
 = ( (
w0
*
piCur
[
iSãp6
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

457 
diff
[
k
+6] = 
piOrg
[6] - 
¥ed
;

458 
¥ed
 = ( (
w0
*
piCur
[
iSãp7
] + 
round
Ë>> 
shi·
 ) + 
off£t
 ;

459 
diff
[
k
+7] = 
piOrg
[7] - 
¥ed
;

461 
piCur
 +
iSåideCur
;

462 
piOrg
 +
iSåideOrg
;

466 
I¡
 
j
=0; j < 8; j++)

468 c⁄° 
I¡
 
jj
 = 
j
 << 3;

469 
m2
[
j
][0] = 
diff
[
jj
 ] + diff[jj+4];

470 
m2
[
j
][1] = 
diff
[
jj
+1] + diff[jj+5];

471 
m2
[
j
][2] = 
diff
[
jj
+2] + diff[jj+6];

472 
m2
[
j
][3] = 
diff
[
jj
+3] + diff[jj+7];

473 
m2
[
j
][4] = 
diff
[
jj
 ] - diff[jj+4];

474 
m2
[
j
][5] = 
diff
[
jj
+1] - diff[jj+5];

475 
m2
[
j
][6] = 
diff
[
jj
+2] - diff[jj+6];

476 
m2
[
j
][7] = 
diff
[
jj
+3] - diff[jj+7];

478 
m1
[
j
][0] = 
m2
[j][0] + m2[j][2];

479 
m1
[
j
][1] = 
m2
[j][1] + m2[j][3];

480 
m1
[
j
][2] = 
m2
[j][0] - m2[j][2];

481 
m1
[
j
][3] = 
m2
[j][1] - m2[j][3];

482 
m1
[
j
][4] = 
m2
[j][4] + m2[j][6];

483 
m1
[
j
][5] = 
m2
[j][5] + m2[j][7];

484 
m1
[
j
][6] = 
m2
[j][4] - m2[j][6];

485 
m1
[
j
][7] = 
m2
[j][5] - m2[j][7];

487 
m2
[
j
][0] = 
m1
[j][0] + m1[j][1];

488 
m2
[
j
][1] = 
m1
[j][0] - m1[j][1];

489 
m2
[
j
][2] = 
m1
[j][2] + m1[j][3];

490 
m2
[
j
][3] = 
m1
[j][2] - m1[j][3];

491 
m2
[
j
][4] = 
m1
[j][4] + m1[j][5];

492 
m2
[
j
][5] = 
m1
[j][4] - m1[j][5];

493 
m2
[
j
][6] = 
m1
[j][6] + m1[j][7];

494 
m2
[
j
][7] = 
m1
[j][6] - m1[j][7];

498 
I¡
 
i
=0; i < 8; i++)

500 
m3
[0][
i
] = 
m2
[0][i] + m2[4][i];

501 
m3
[1][
i
] = 
m2
[1][i] + m2[5][i];

502 
m3
[2][
i
] = 
m2
[2][i] + m2[6][i];

503 
m3
[3][
i
] = 
m2
[3][i] + m2[7][i];

504 
m3
[4][
i
] = 
m2
[0][i] - m2[4][i];

505 
m3
[5][
i
] = 
m2
[1][i] - m2[5][i];

506 
m3
[6][
i
] = 
m2
[2][i] - m2[6][i];

507 
m3
[7][
i
] = 
m2
[3][i] - m2[7][i];

509 
m1
[0][
i
] = 
m3
[0][i] + m3[2][i];

510 
m1
[1][
i
] = 
m3
[1][i] + m3[3][i];

511 
m1
[2][
i
] = 
m3
[0][i] - m3[2][i];

512 
m1
[3][
i
] = 
m3
[1][i] - m3[3][i];

513 
m1
[4][
i
] = 
m3
[4][i] + m3[6][i];

514 
m1
[5][
i
] = 
m3
[5][i] + m3[7][i];

515 
m1
[6][
i
] = 
m3
[4][i] - m3[6][i];

516 
m1
[7][
i
] = 
m3
[5][i] - m3[7][i];

518 
m2
[0][
i
] = 
m1
[0][i] + m1[1][i];

519 
m2
[1][
i
] = 
m1
[0][i] - m1[1][i];

520 
m2
[2][
i
] = 
m1
[2][i] + m1[3][i];

521 
m2
[3][
i
] = 
m1
[2][i] - m1[3][i];

522 
m2
[4][
i
] = 
m1
[4][i] + m1[5][i];

523 
m2
[5][
i
] = 
m1
[4][i] - m1[5][i];

524 
m2
[6][
i
] = 
m1
[6][i] + m1[7][i];

525 
m2
[7][
i
] = 
m1
[6][i] - m1[7][i];

528 
I¡
 
j
=0; j < 8; j++)

530 
I¡
 
i
=0; i < 8; i++)

532 
ßd
 +(
	`abs
(
m2
[
j
][
i
]));

536 
ßd
=((sad+2)>>2);

538  
ßd
;

539 
	}
}

543 
Di°‹ti⁄
 
	gTComRdCo°WeightPªdi˘i⁄
::
	$xGëHADsw
–
Di°P¨am
* 
pcDtP¨am
 )

545 c⁄° 
Pñ
 *
piOrg
 = 
pcDtP¨am
->
pOrg
;

546 c⁄° 
Pñ
 *
piCur
 = 
pcDtP¨am
->
pCur
;

547 c⁄° 
I¡
 
iRows
 = 
pcDtP¨am
->iRows;

548 c⁄° 
I¡
 
iCﬁs
 = 
pcDtP¨am
->iCols;

549 c⁄° 
I¡
 
iSåideCur
 = 
pcDtP¨am
->iStrideCur;

550 c⁄° 
I¡
 
iSåideOrg
 = 
pcDtP¨am
->iStrideOrg;

551 c⁄° 
I¡
 
iSãp
 = 
pcDtP¨am
->iStep;

552 c⁄° 
Comp⁄ítID
 
compIdx
 = 
pcDtP¨am
->compIdx;

553 
	`as£π
(
compIdx
<
MAX_NUM_COMPONENT
);

554 c⁄° 
WPSˇlögP¨am
 &
wpCur
 = 
pcDtP¨am
->wpCur[
compIdx
];

556 
Di°‹ti⁄
 
uiSum
 = 0;

558 if––
iRows
 % 8 =0Ë&& (
iCﬁs
 % 8 == 0) )

560 c⁄° 
I¡
 
iOff£tOrg
 = 
iSåideOrg
<<3;

561 c⁄° 
I¡
 
iOff£tCur
 = 
iSåideCur
<<3;

562 
I¡
 
y
=0; y<
iRows
; y+= 8 )

564 
I¡
 
x
=0; x<
iCﬁs
; x+= 8 )

566 
uiSum
 +
	`xCÆcHADs8x8w
–
wpCur
, &
piOrg
[
x
], &
piCur
[x*
iSãp
], 
iSåideOrg
, 
iSåideCur
, iStep );

568 
piOrg
 +
iOff£tOrg
;

569 
piCur
 +
iOff£tCur
;

572 if––
iRows
 % 4 =0Ë&& (
iCﬁs
 % 4 == 0) )

574 c⁄° 
I¡
 
iOff£tOrg
 = 
iSåideOrg
<<2;

575 c⁄° 
I¡
 
iOff£tCur
 = 
iSåideCur
<<2;

577 
I¡
 
y
=0; y<
iRows
; y+= 4 )

579 
I¡
 
x
=0; x<
iCﬁs
; x+= 4 )

581 
uiSum
 +
	`xCÆcHADs4x4w
–
wpCur
, &
piOrg
[
x
], &
piCur
[x*
iSãp
], 
iSåideOrg
, 
iSåideCur
, iStep );

583 
piOrg
 +
iOff£tOrg
;

584 
piCur
 +
iOff£tCur
;

589 
I¡
 
y
=0; y<
iRows
; y+=2 )

591 
I¡
 
x
=0; x<
iCﬁs
; x+=2 )

593 
uiSum
 +
	`xCÆcHADs2x2w
–
wpCur
, &
piOrg
[
x
], &
piCur
[x*
iSãp
], 
iSåideOrg
, 
iSåideCur
, iStep );

595 
piOrg
 +
iSåideOrg
;

596 
piCur
 +
iSåideCur
;

600  
uiSum
 >> 
	`DISTORTION_PRECISION_ADJUSTMENT
(
pcDtP¨am
->
bôDïth
-8);

601 
	}
}

	@TLibCommon/TComRdCostWeightPrediction.h

38 #i‚de‡
__TCOMRDCOSTWEIGHTPREDICTION__


39 
	#__TCOMRDCOSTWEIGHTPREDICTION__


	)

42 
	~"Comm⁄Def.h
"

44 
˛ass
 
	gDi°P¨am
;

45 
˛ass
 
	gTComP©ã∫
;

52 
«me•a˚
 
	gTComRdCo°WeightPªdi˘i⁄


54 
Di°‹ti⁄
 
xGëSSEw
 ( 
Di°P¨am
* 
pcDtP¨am
 );

55 
Di°‹ti⁄
 
xGëSADw
 ( 
Di°P¨am
* 
pcDtP¨am
 );

56 
Di°‹ti⁄
 
xGëHADsw
–
Di°P¨am
* 
pcDtP¨am
 );

	@TLibCommon/TComRectangle.h

35 #i‚de‡
__TCOMRECTANGLE__


36 
	#__TCOMRECTANGLE__


	)

39 
	sTComRe˘™gÀ


41 
UI¡
 
	mwidth
;

42 
UI¡
 
	mheight
;

43 
UI¡
 
	mx0
;

44 
UI¡
 
	my0
;

	@TLibCommon/TComRom.cpp

38 
	~"TComRom.h
"

39 
	~<mem‹y.h
>

40 
	~<°dlib.h
>

41 
	~<°dio.h
>

42 
	~<iom™ù
>

43 
	~<as£π.h
>

44 
	~"TComD©aCU.h
"

45 
	~"Debug.h
"

53 c⁄° 
TCh¨
* 
	$«lUnôTy≥ToSåög
(
NÆUnôTy≥
 
ty≥
)

55 
ty≥
)

57 
NAL_UNIT_CODED_SLICE_TRAIL_R
:  "TRAIL_R";

58 
NAL_UNIT_CODED_SLICE_TRAIL_N
:  "TRAIL_N";

59 
NAL_UNIT_CODED_SLICE_TSA_R
:  "TSA_R";

60 
NAL_UNIT_CODED_SLICE_TSA_N
:  "TSA_N";

61 
NAL_UNIT_CODED_SLICE_STSA_R
:  "STSA_R";

62 
NAL_UNIT_CODED_SLICE_STSA_N
:  "STSA_N";

63 
NAL_UNIT_CODED_SLICE_BLA_W_LP
:  "BLA_W_LP";

64 
NAL_UNIT_CODED_SLICE_BLA_W_RADL
:  "BLA_W_RADL";

65 
NAL_UNIT_CODED_SLICE_BLA_N_LP
:  "BLA_N_LP";

66 
NAL_UNIT_CODED_SLICE_IDR_W_RADL
:  "IDR_W_RADL";

67 
NAL_UNIT_CODED_SLICE_IDR_N_LP
:  "IDR_N_LP";

68 
NAL_UNIT_CODED_SLICE_CRA
:  "CRA";

69 
NAL_UNIT_CODED_SLICE_RADL_R
:  "RADL_R";

70 
NAL_UNIT_CODED_SLICE_RADL_N
:  "RADL_N";

71 
NAL_UNIT_CODED_SLICE_RASL_R
:  "RASL_R";

72 
NAL_UNIT_CODED_SLICE_RASL_N
:  "RASL_N";

73 
NAL_UNIT_VPS
:  "VPS";

74 
NAL_UNIT_SPS
:  "SPS";

75 
NAL_UNIT_PPS
:  "PPS";

76 
NAL_UNIT_ACCESS_UNIT_DELIMITER
:  "AUD";

77 
NAL_UNIT_EOS
:  "EOS";

78 
NAL_UNIT_EOB
:  "EOB";

79 
NAL_UNIT_FILLER_DATA
:  "FILLER";

80 
NAL_UNIT_PREFIX_SEI
:  "Prefix SEI";

81 
NAL_UNIT_SUFFIX_SEI
:  "Suffix SEI";

84 
	}
}

86 ˛as†
	cSˇnGíî©‹


88 
	m¥iv©e
:

89 
UI¡
 
m_löe
, 
	mm_cﬁumn
;

90 c⁄° 
UI¡
 
	mm_blockWidth
, 
	mm_blockHeight
;

91 c⁄° 
UI¡
 
	mm_°ride
;

92 c⁄° 
COEFF_SCAN_TYPE
 
	mm_sˇnTy≥
;

94 
	mpublic
:

95 
	$SˇnGíî©‹
(
UI¡
 
blockWidth
, UI¡ 
blockHeight
, UI¡ 
°ride
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
)

96 : 
	`m_löe
(0), 
	`m_cﬁumn
(0), 
	`m_blockWidth
(
blockWidth
), 
	`m_blockHeight
(
blockHeight
), 
	`m_°ride
(
°ride
), 
	$m_sˇnTy≥
(
sˇnTy≥
)

99 
UI¡
 
	$GëCuºítX
(Ëc⁄° {  
m_cﬁumn
; 
	}
}

100 
UI¡
 
	$GëCuºítY
(Ëc⁄° {  
m_löe
; 
	}
}

102 
UI¡
 
	$GëNextIndex
(
UI¡
 
blockOff£tX
, UI¡ 
blockOff£tY
)

104 
I¡
 
πn
=((
m_löe
 + 
blockOff£tY
Ë* 
m_°ride
Ë+ 
m_cﬁumn
 + 
blockOff£tX
;

107 
m_sˇnTy≥
)

111 
SCAN_DIAG
:

113 i‡((
m_cﬁumn
 =(
m_blockWidth
 - 1)Ë|| (
m_löe
 == 0))

115 
m_löe
 +
m_cﬁumn
 + 1;

116 
m_cﬁumn
 = 0;

118 i‡(
m_löe
 >
m_blockHeight
)

120 
m_cﬁumn
 +
m_löe
 - (
m_blockHeight
 - 1);

121 
m_löe
 = 
m_blockHeight
 - 1;

126 
m_cﬁumn
++;

127 
m_löe
--;

134 
SCAN_HOR
:

136 i‡(
m_cﬁumn
 =(
m_blockWidth
 - 1))

138 
m_löe
++;

139 
m_cﬁumn
 = 0;

143 
m_cﬁumn
++;

150 
SCAN_VER
:

152 i‡(
m_löe
 =(
m_blockHeight
 - 1))

154 
m_cﬁumn
++;

155 
m_löe
 = 0;

159 
m_löe
++;

168 
°d
::
˚º
 << "ERROR: Unknow¿sˇ¿ty≥ \"" << 
m_sˇnTy≥
 << "\"ö SˇnGíî©‹::GëNextIndex" << std::
ídl
;

169 
	`exô
(1);

174  
πn
;

175 
	}
}

179 
Void
 
	$öôROM
()

181 
I¡
 
i
, 
c
;

184 ::
	`mem£t
–
g_aucC⁄vîtToBô
, -1, ( g_aucConvertToBit ) );

185 
c
=0;

186  
i
=4; i<=
MAX_CU_SIZE
; i*=2 )

188 
g_aucC⁄vîtToBô
[ 
i
 ] = 
c
;

189 
c
++;

193 
UI¡
 
log2BlockHeight
 = 0;Üog2BlockHeighà< 
MAX_CU_DEPTH
;Üog2BlockHeight++)

195 
UI¡
 
log2BlockWidth
 = 0;Üog2BlockWidth < 
MAX_CU_DEPTH
;Üog2BlockWidth++)

197 c⁄° 
UI¡
 
blockWidth
 = 1 << 
log2BlockWidth
;

198 c⁄° 
UI¡
 
blockHeight
 = 1 << 
log2BlockHeight
;

199 c⁄° 
UI¡
 
tŸÆVÆues
 = 
blockWidth
 * 
blockHeight
;

205 
UI¡
 
sˇnTy≥Index
 = 0; sˇnTy≥Index < 
SCAN_NUMBER_OF_TYPES
; scanTypeIndex++)

207 c⁄° 
COEFF_SCAN_TYPE
 
sˇnTy≥
 = 
	`COEFF_SCAN_TYPE
(
sˇnTy≥Index
);

209 
g_sˇnOrdî
[
SCAN_UNGROUPED
][
sˇnTy≥
][
log2BlockWidth
][
log2BlockHeight
] = 
√w
 
UI¡
[
tŸÆVÆues
];

211 
SˇnGíî©‹
 
	`fuŒBlockSˇn
(
blockWidth
, 
blockHeight
, blockWidth, 
sˇnTy≥
);

213 
UI¡
 
sˇnPosôi⁄
 = 0; sˇnPosôi⁄ < 
tŸÆVÆues
; scanPosition++)

215 
g_sˇnOrdî
[
SCAN_UNGROUPED
][
sˇnTy≥
][
log2BlockWidth
][
log2BlockHeight
][
sˇnPosôi⁄
] = 
fuŒBlockSˇn
.
	`GëNextIndex
(0, 0);

223 c⁄° 
UI¡
 
groupWidth
 = 1 << 
MLS_CG_LOG2_WIDTH
;

224 c⁄° 
UI¡
 
groupHeight
 = 1 << 
MLS_CG_LOG2_HEIGHT
;

225 c⁄° 
UI¡
 
widthInGroups
 = 
blockWidth
 >> 
MLS_CG_LOG2_WIDTH
;

226 c⁄° 
UI¡
 
heightInGroups
 = 
blockHeight
 >> 
MLS_CG_LOG2_HEIGHT
;

228 c⁄° 
UI¡
 
groupSize
 = 
groupWidth
 * 
groupHeight
;

229 c⁄° 
UI¡
 
tŸÆGroups
 = 
widthInGroups
 * 
heightInGroups
;

231 
UI¡
 
sˇnTy≥Index
 = 0; sˇnTy≥Index < 
SCAN_NUMBER_OF_TYPES
; scanTypeIndex++)

233 c⁄° 
COEFF_SCAN_TYPE
 
sˇnTy≥
 = 
	`COEFF_SCAN_TYPE
(
sˇnTy≥Index
);

235 
g_sˇnOrdî
[
SCAN_GROUPED_4x4
][
sˇnTy≥
][
log2BlockWidth
][
log2BlockHeight
] = 
√w
 
UI¡
[
tŸÆVÆues
];

237 
SˇnGíî©‹
 
	`fuŒBlockSˇn
(
widthInGroups
, 
heightInGroups
, 
groupWidth
, 
sˇnTy≥
);

239 
UI¡
 
groupIndex
 = 0; groupIndex < 
tŸÆGroups
; groupIndex++)

241 c⁄° 
UI¡
 
groupPosôi⁄Y
 = 
fuŒBlockSˇn
.
	`GëCuºítY
();

242 c⁄° 
UI¡
 
groupPosôi⁄X
 = 
fuŒBlockSˇn
.
	`GëCuºítX
();

243 c⁄° 
UI¡
 
groupOff£tX
 = 
groupPosôi⁄X
 * 
groupWidth
;

244 c⁄° 
UI¡
 
groupOff£tY
 = 
groupPosôi⁄Y
 * 
groupHeight
;

245 c⁄° 
UI¡
 
groupOff£tSˇn
 = 
groupIndex
 * 
groupSize
;

247 
SˇnGíî©‹
 
	`groupSˇn
(
groupWidth
, 
groupHeight
, 
blockWidth
, 
sˇnTy≥
);

249 
UI¡
 
sˇnPosôi⁄
 = 0; sˇnPosôi⁄ < 
groupSize
; scanPosition++)

251 
g_sˇnOrdî
[
SCAN_GROUPED_4x4
][
sˇnTy≥
][
log2BlockWidth
][
log2BlockHeight
][
groupOff£tSˇn
 + 
sˇnPosôi⁄
] = 
groupSˇn
.
	`GëNextIndex
(
groupOff£tX
, 
groupOff£tY
);

254 
fuŒBlockSˇn
.
	`GëNextIndex
(0,0);

261 
	}
}

263 
Void
 
	$de°royROM
()

265 
UI¡
 
groupTy≥Index
 = 0; groupTy≥Index < 
SCAN_NUMBER_OF_GROUP_TYPES
; groupTypeIndex++)

267 
UI¡
 
sˇnOrdîIndex
 = 0; sˇnOrdîIndex < 
SCAN_NUMBER_OF_TYPES
; scanOrderIndex++)

269 
UI¡
 
log2BlockWidth
 = 0;Üog2BlockWidth < 
MAX_CU_DEPTH
;Üog2BlockWidth++)

271 
UI¡
 
log2BlockHeight
 = 0;Üog2BlockHeighà< 
MAX_CU_DEPTH
;Üog2BlockHeight++)

273 
dñëe
 [] 
g_sˇnOrdî
[
groupTy≥Index
][
sˇnOrdîIndex
][
log2BlockWidth
][
log2BlockHeight
];

278 
	}
}

284 
UI¡
 
	gg_auiZsˇnToRa°î
 [ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ] = { 0, };

285 
UI¡
 
	gg_auiRa°îToZsˇn
 [ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ] = { 0, };

286 
UI¡
 
	gg_auiRa°îToPñX
 [ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ] = { 0, };

287 
UI¡
 
	gg_auiRa°îToPñY
 [ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ] = { 0, };

289 c⁄° 
UI¡
 
	gg_auiPUOff£t
[
NUMBER_OF_PART_SIZES
] = { 0, 8, 4, 4, 2, 10, 1, 5};

291 
Void
 
	$öôZsˇnToRa°î
 ( 
I¡
 
iMaxDïth
, I¡ 
iDïth
, 
UI¡
 
uiSèπVÆ
, UI¡*& 
ΩuiCuºIdx
 )

293 
I¡
 
iSåide
 = 1 << ( 
iMaxDïth
 - 1 );

295 i‡–
iDïth
 =
iMaxDïth
 )

297 
ΩuiCuºIdx
[0] = 
uiSèπVÆ
;

298 
ΩuiCuºIdx
++;

302 
I¡
 
iSãp
 = 
iSåide
 >> 
iDïth
;

303 
	`öôZsˇnToRa°î
–
iMaxDïth
, 
iDïth
+1, 
uiSèπVÆ
, 
ΩuiCuºIdx
 );

304 
	`öôZsˇnToRa°î
–
iMaxDïth
, 
iDïth
+1, 
uiSèπVÆ
+
iSãp
, 
ΩuiCuºIdx
 );

305 
	`öôZsˇnToRa°î
–
iMaxDïth
, 
iDïth
+1, 
uiSèπVÆ
+
iSãp
*
iSåide
, 
ΩuiCuºIdx
 );

306 
	`öôZsˇnToRa°î
–
iMaxDïth
, 
iDïth
+1, 
uiSèπVÆ
+
iSãp
*
iSåide
+iSãp, 
ΩuiCuºIdx
 );

308 
	}
}

310 
Void
 
	$öôRa°îToZsˇn
 ( 
UI¡
 
uiMaxCUWidth
, UI¡ 
uiMaxCUHeight
, UI¡ 
uiMaxDïth
 )

312 
UI¡
 
uiMöCUWidth
 = 
uiMaxCUWidth
 >> ( 
uiMaxDïth
 - 1 );

313 
UI¡
 
uiMöCUHeight
 = 
uiMaxCUHeight
 >> ( 
uiMaxDïth
 - 1 );

315 
UI¡
 
uiNumP¨tInWidth
 = (UI¡)
uiMaxCUWidth
 / 
uiMöCUWidth
;

316 
UI¡
 
uiNumP¨tInHeight
 = (UI¡)
uiMaxCUHeight
 / 
uiMöCUHeight
;

318  
UI¡
 
i
 = 0; i < 
uiNumP¨tInWidth
*
uiNumP¨tInHeight
; i++ )

320 
g_auiRa°îToZsˇn
[ 
g_auiZsˇnToRa°î
[
i
] ] = i;

322 
	}
}

324 
Void
 
	$öôRa°îToPñXY
 ( 
UI¡
 
uiMaxCUWidth
, UI¡ 
uiMaxCUHeight
, UI¡ 
uiMaxDïth
 )

326 
UI¡
 
i
;

328 
UI¡
* 
uiTempX
 = &
g_auiRa°îToPñX
[0];

329 
UI¡
* 
uiTempY
 = &
g_auiRa°îToPñY
[0];

331 
UI¡
 
uiMöCUWidth
 = 
uiMaxCUWidth
 >> ( 
uiMaxDïth
 - 1 );

332 
UI¡
 
uiMöCUHeight
 = 
uiMaxCUHeight
 >> ( 
uiMaxDïth
 - 1 );

334 
UI¡
 
uiNumP¨tInWidth
 = 
uiMaxCUWidth
 / 
uiMöCUWidth
;

335 
UI¡
 
uiNumP¨tInHeight
 = 
uiMaxCUHeight
 / 
uiMöCUHeight
;

337 
uiTempX
[0] = 0; uiTempX++;

338  
i
 = 1; i < 
uiNumP¨tInWidth
; i++ )

340 
uiTempX
[0] = uiTempX[-1] + 
uiMöCUWidth
; uiTempX++;

342  
i
 = 1; i < 
uiNumP¨tInHeight
; i++ )

344 
	`mem˝y
(
uiTempX
, uiTempX-
uiNumP¨tInWidth
, (
UI¡
)*uiNumPartInWidth);

345 
uiTempX
 +
uiNumP¨tInWidth
;

348  
i
 = 1; i < 
uiNumP¨tInWidth
*
uiNumP¨tInHeight
; i++ )

350 
uiTempY
[
i
] = ( i / 
uiNumP¨tInWidth
 ) * 
uiMöCUWidth
;

352 
	}
}

354 c⁄° 
I¡
 
	gg_qu™tSˇÀs
[
SCALING_LIST_REM_NUM
] =

359 c⁄° 
I¡
 
	gg_övQu™tSˇÀs
[
SCALING_LIST_REM_NUM
] =

368 
	#DEFINE_DST4x4_MATRIX
(
a
,
b
,
c
,
d
) \

370 { 
a
, 
b
, 
c
, 
d
 }, \

371 { 
c
, c, 0, -c }, \

372 { 
d
, -
a
, -
c
, 
b
 }, \

373 { 
b
, -
d
, 
c
, -
a
 }, \

374 }

	)

376 
	#DEFINE_DCT4x4_MATRIX
(
a
,
b
,
c
) \

378 { 
a
,á,á,á}, \

379 { 
b
, 
c
, -c, -b}, \

380 { 
a
, -a, -a,á}, \

381 { 
c
, -
b
, b, -c} \

382 }

	)

384 
	#DEFINE_DCT8x8_MATRIX
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

386 { 
a
,á,á,á,á,á,á,á}, \

387 { 
d
, 
e
, 
f
, 
g
, -g, -f, -e, -d}, \

388 { 
b
, 
c
, -c, -b, -b, -c, c, b}, \

389 { 
e
, -
g
, -
d
, -
f
, f, d, g, -e}, \

390 { 
a
, -a, -a,á,á, -a, -a,á}, \

391 { 
f
, -
d
, 
g
, 
e
, -e, -g, d, -f}, \

392 { 
c
, -
b
, b, -c, -c, b, -b, c}, \

393 { 
g
, -
f
, 
e
, -
d
, d, -e, f, -g} \

394 }

	)

396 
	#DEFINE_DCT16x16_MATRIX
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
i
,
j
,
k
,
l
,
m
,
n
,
o
) \

398 { 
a
,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á}, \

399 { 
h
, 
i
, 
j
, 
k
, 
l
, 
m
, 
n
, 
o
, -o, -n, -m, -l, -k, -j, -i, -h}, \

400 { 
d
, 
e
, 
f
, 
g
, -g, -f, -e, -d, -d, -e, -f, -g, g, f,É, d}, \

401 { 
i
, 
l
, 
o
, -
m
, -
j
, -
h
, -
k
, -
n
,Ç, k, h, j, m, -o, -l, -i}, \

402 { 
b
, 
c
, -c, -b, -b, -c, c, b, b, c, -c, -b, -b, -c, c, b}, \

403 { 
j
, 
o
, -
k
, -
i
, -
n
, 
l
, 
h
, 
m
, -m, -h, -l,Ç, i, k, -o, -j}, \

404 { 
e
, -
g
, -
d
, -
f
, f, d, g, -e, -e, g, d, f, -f, -d, -g,É}, \

405 { 
k
, -
m
, -
i
, 
o
, 
h
, 
n
, -
j
, -
l
,Ü, j, -n, -h, -o, i, m, -k}, \

406 { 
a
, -a, -a,á,á, -a, -a,á,á, -a, -a,á,á, -a, -a,á}, \

407 { 
l
, -
j
, -
n
, 
h
, -
o
, -
i
, 
m
, 
k
, -k, -m, i, o, -h,Ç, j, -l}, \

408 { 
f
, -
d
, 
g
, 
e
, -e, -g, d, -f, -f, d, -g, -e,É, g, -d, f}, \

409 { 
m
, -
h
, 
l
, 
n
, -
i
, 
k
, 
o
, -
j
, j, -o, -k, i, -n, -l, h, -m}, \

410 { 
c
, -
b
, b, -c, -c, b, -b, c, c, -b, b, -c, -c, b, -b, c}, \

411 { 
n
, -
k
, 
h
, -
j
, 
m
, 
o
, -
l
, 
i
, -i,Ü, -o, -m, j, -h, k, -n}, \

412 { 
g
, -
f
, 
e
, -
d
, d, -e, f, -g, -g, f, -e, d, -d,É, -f, g}, \

413 { 
o
, -
n
, 
m
, -
l
, 
k
, -
j
, 
i
, -
h
, h, -i, j, -k,Ü, -m,Ç, -o} \

414 }

	)

416 
	#DEFINE_DCT32x32_MATRIX
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
i
,
j
,
k
,
l
,
m
,
n
,
o
,
p
,
q
,
r
,
s
,
t
,
u
,
v
,
w
,
x
,
y
,
z
,
A
,
B
,
C
,
D
,
E
) \

418 { 
a
,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á,á}, \

419 { 
p
, 
q
, 
r
, 
s
, 
t
, 
u
, 
v
, 
w
, 
x
, 
y
, 
z
, 
A
, 
B
, 
C
, 
D
, 
E
, -E, -D, -C, -B, -A, -z, -y, -x, -w, -v, -u, -t, -s, -r, -q, -p}, \

420 { 
h
, 
i
, 
j
, 
k
, 
l
, 
m
, 
n
, 
o
, -o, -n, -m, -l, -k, -j, -i, -h, -h, -i, -j, -k, -l, -m, -n, -o, o,Ç, m,Ü, k, j, i, h}, \

421 { 
q
, 
t
, 
w
, 
z
, 
C
, -
E
, -
B
, -
y
, -
v
, -
s
, -
p
, -
r
, -
u
, -
x
, -
A
, -
D
, D, A, x, u,Ñ,Ö, s, v, y, B, E, -C, -z, -w, -t, -q}, \

422 { 
d
, 
e
, 
f
, 
g
, -g, -f, -e, -d, -d, -e, -f, -g, g, f,É, d, d,É, f, g, -g, -f, -e, -d, -d, -e, -f, -g, g, f,É, d}, \

423 { 
r
, 
w
, 
B
, -
D
, -
y
, -
t
, -
p
, -
u
, -
z
, -
E
, 
A
, 
v
, 
q
, 
s
, 
x
, 
C
, -C, -x, -s, -q, -v, -A, E, z, u,Ö,Å, y, D, -B, -w, -r}, \

424 { 
i
, 
l
, 
o
, -
m
, -
j
, -
h
, -
k
, -
n
,Ç, k, h, j, m, -o, -l, -i, -i, -l, -o, m, j, h, k,Ç, -n, -k, -h, -j, -m, o,Ü, i}, \

425 { 
s
, 
z
, -
D
, -
w
, -
p
, -
v
, -
C
, 
A
, 
t
, 
r
, 
y
, -
E
, -
x
, -
q
, -
u
, -
B
, B, u, q, x, E, -y, -r, -t, -A, C, v,Ö, w, D, -z, -s}, \

426 { 
b
, 
c
, -c, -b, -b, -c, c, b, b, c, -c, -b, -b, -c, c, b, b, c, -c, -b, -b, -c, c, b, b, c, -c, -b, -b, -c, c, b}, \

427 { 
t
, 
C
, -
y
, -
p
, -
x
, 
D
, 
u
, 
s
, 
B
, -
z
, -
q
, -
w
, 
E
, 
v
, 
r
, 
A
, -A, -r, -v, -E, w, q, z, -B, -s, -u, -D, x,Ö, y, -C, -t}, \

428 { 
j
, 
o
, -
k
, -
i
, -
n
, 
l
, 
h
, 
m
, -m, -h, -l,Ç, i, k, -o, -j, -j, -o, k, i,Ç, -l, -h, -m, m, h,Ü, -n, -i, -k, o, j}, \

429 { 
u
, -
E
, -
t
, -
v
, 
D
, 
s
, 
w
, -
C
, -
r
, -
x
, 
B
, 
q
, 
y
, -
A
, -
p
, -
z
, z,Ö, A, -y, -q, -B, x,Ñ, C, -w, -s, -D, v,Å, E, -u}, \

430 { 
e
, -
g
, -
d
, -
f
, f, d, g, -e, -e, g, d, f, -f, -d, -g,É,É, -g, -d, -f, f, d, g, -e, -e, g, d, f, -f, -d, -g,É}, \

431 { 
v
, -
B
, -
p
, -
C
, 
u
, 
w
, -
A
, -
q
, -
D
, 
t
, 
x
, -
z
, -
r
, -
E
, 
s
, 
y
, -y, -s, E,Ñ, z, -x, -t, D, q, A, -w, -u, C,Ö, B, -v}, \

432 { 
k
, -
m
, -
i
, 
o
, 
h
, 
n
, -
j
, -
l
,Ü, j, -n, -h, -o, i, m, -k, -k, m, i, -o, -h, -n, j,Ü, -l, -j,Ç, h, o, -i, -m, k}, \

433 { 
w
, -
y
, -
u
, 
A
, 
s
, -
C
, -
q
, 
E
, 
p
, 
D
, -
r
, -
B
, 
t
, 
z
, -
v
, -
x
, x, v, -z, -t, B,Ñ, -D, -p, -E, q, C, -s, -A, u, y, -w}, \

434 { 
a
, -a, -a,á,á, -a, -a,á,á, -a, -a,á,á, -a, -a,á,á, -a, -a,á,á, -a, -a,á,á, -a, -a,á,á, -a, -a,á}, \

435 { 
x
, -
v
, -
z
, 
t
, 
B
, -
r
, -
D
, 
p
, -
E
, -
q
, 
C
, 
s
, -
A
, -
u
, 
y
, 
w
, -w, -y, u, A, -s, -C, q, E, -p, D,Ñ, -B, -t, z, v, -x}, \

436 { 
l
, -
j
, -
n
, 
h
, -
o
, -
i
, 
m
, 
k
, -k, -m, i, o, -h,Ç, j, -l, -l, j,Ç, -h, o, i, -m, -k, k, m, -i, -o, h, -n, -j,Ü}, \

437 { 
y
, -
s
, -
E
, 
r
, -
z
, -
x
, 
t
, 
D
, -
q
, 
A
, 
w
, -
u
, -
C
, 
p
, -
B
, -
v
, v, B, -p, C, u, -w, -A, q, -D, -t, x, z, -r, E, s, -y}, \

438 { 
f
, -
d
, 
g
, 
e
, -e, -g, d, -f, -f, d, -g, -e,É, g, -d, f, f, -d, g,É, -e, -g, d, -f, -f, d, -g, -e,É, g, -d, f}, \

439 { 
z
, -
p
, 
A
, 
y
, -
q
, 
B
, 
x
, -
r
, 
C
, 
w
, -
s
, 
D
, 
v
, -
t
, 
E
, 
u
, -u, -E,Å, -v, -D, s, -w, -C,Ñ, -x, -B, q, -y, -A,Ö, -z}, \

440 { 
m
, -
h
, 
l
, 
n
, -
i
, 
k
, 
o
, -
j
, j, -o, -k, i, -n, -l, h, -m, -m, h, -l, -n, i, -k, -o, j, -j, o, k, -i,Ç,Ü, -h, m}, \

441 { 
A
, -
r
, 
v
, -
E
, -
w
, 
q
, -
z
, -
B
, 
s
, -
u
, 
D
, 
x
, -
p
, 
y
, 
C
, -
t
,Å, -C, -y,Ö, -x, -D, u, -s, B, z, -q, w, E, -v,Ñ, -A}, \

442 { 
c
, -
b
, b, -c, -c, b, -b, c, c, -b, b, -c, -c, b, -b, c, c, -b, b, -c, -c, b, -b, c, c, -b, b, -c, -c, b, -b, c}, \

443 { 
B
, -
u
, 
q
, -
x
, 
E
, 
y
, -
r
, 
t
, -
A
, -
C
, 
v
, -
p
, 
w
, -
D
, -
z
, 
s
, -s, z, D, -w,Ö, -v, C, A, -t,Ñ, -y, -E, x, -q, u, -B}, \

444 { 
n
, -
k
, 
h
, -
j
, 
m
, 
o
, -
l
, 
i
, -i,Ü, -o, -m, j, -h, k, -n, -n, k, -h, j, -m, -o,Ü, -i, i, -l, o, m, -j, h, -k,Ç}, \

445 { 
C
, -
x
, 
s
, -
q
, 
v
, -
A
, -
E
, 
z
, -
u
, 
p
, -
t
, 
y
, -
D
, -
B
, 
w
, -
r
,Ñ, -w, B, D, -y,Å, -p, u, -z, E, A, -v, q, -s, x, -C}, \

446 { 
g
, -
f
, 
e
, -
d
, d, -e, f, -g, -g, f, -e, d, -d,É, -f, g, g, -f,É, -d, d, -e, f, -g, -g, f, -e, d, -d,É, -f, g}, \

447 { 
D
, -
A
, 
x
, -
u
, 
r
, -
p
, 
s
, -
v
, 
y
, -
B
, 
E
, 
C
, -
z
, 
w
, -
t
, 
q
, -q,Å, -w, z, -C, -E, B, -y, v, -s,Ö, -r, u, -x, A, -D}, \

448 { 
o
, -
n
, 
m
, -
l
, 
k
, -
j
, 
i
, -
h
, h, -i, j, -k,Ü, -m,Ç, -o, -o,Ç, -m,Ü, -k, j, -i, h, -h, i, -j, k, -l, m, -n, o}, \

449 { 
E
, -
D
, 
C
, -
B
, 
A
, -
z
, 
y
, -
x
, 
w
, -
v
, 
u
, -
t
, 
s
, -
r
, 
q
, -
p
,Ö, -q,Ñ, -s,Å, -u, v, -w, x, -y, z, -A, B, -C, D, -E} \

450 }

	)

456 #i‡
RExt__HIGH_PRECISION_FORWARD_TRANSFORM


457 c⁄° 
TM©rixC€ff
 
	gg_aiT4
 [
TRANSFORM_NUMBER_OF_DIRECTIONS
][4][4] =

459 
DEFINE_DCT4x4_MATRIX
 (16384, 21266, 9224),

460 
DEFINE_DCT4x4_MATRIX
 ( 64, 83, 36)

463 c⁄° 
TM©rixC€ff
 
	gg_aiT8
 [
TRANSFORM_NUMBER_OF_DIRECTIONS
][8][8] =

465 
DEFINE_DCT8x8_MATRIX
 (16384, 21266, 9224, 22813, 19244, 12769, 4563),

466 
DEFINE_DCT8x8_MATRIX
 ( 64, 83, 36, 89, 75, 50, 18)

469 c⁄° 
TM©rixC€ff
 
	gg_aiT16
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][16][16] =

471 
DEFINE_DCT16x16_MATRIX
(16384, 21266, 9224, 22813, 19244, 12769, 4563, 23120, 22063, 20450, 17972, 14642, 11109, 6446, 2316),

472 
DEFINE_DCT16x16_MATRIX
( 64, 83, 36, 89, 75, 50, 18, 90, 87, 80, 70, 57, 43, 25, 9)

475 c⁄° 
TM©rixC€ff
 
	gg_aiT32
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][32][32] =

477 
DEFINE_DCT32x32_MATRIX
(16384, 21266, 9224, 22813, 19244, 12769, 4563, 23120, 22063, 20450, 17972, 14642, 11109, 6446, 2316, 23106, 22852, 22445, 21848, 20995, 19810, 18601, 17143, 15718, 13853, 11749, 9846, 7908, 5573, 3281, 946),

478 
DEFINE_DCT32x32_MATRIX
( 64, 83, 36, 89, 75, 50, 18, 90, 87, 80, 70, 57, 43, 25, 9, 90, 90, 88, 85, 82, 78, 73, 67, 61, 54, 46, 38, 31, 22, 13, 4)

481 c⁄° 
TM©rixC€ff
 
	gg_as_DST_MAT_4
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][4][4] =

483 
DEFINE_DST4x4_MATRIX
( 7424, 14081, 18893, 21505),

484 
DEFINE_DST4x4_MATRIX
( 29, 55, 74, 84)

489 c⁄° 
TM©rixC€ff
 
	gg_aiT4
 [
TRANSFORM_NUMBER_OF_DIRECTIONS
][4][4] =

491 
DEFINE_DCT4x4_MATRIX
 ( 64, 83, 36),

492 
DEFINE_DCT4x4_MATRIX
 ( 64, 83, 36)

495 c⁄° 
TM©rixC€ff
 
	gg_aiT8
 [
TRANSFORM_NUMBER_OF_DIRECTIONS
][8][8] =

497 
DEFINE_DCT8x8_MATRIX
 ( 64, 83, 36, 89, 75, 50, 18),

498 
DEFINE_DCT8x8_MATRIX
 ( 64, 83, 36, 89, 75, 50, 18)

501 c⁄° 
TM©rixC€ff
 
	gg_aiT16
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][16][16] =

503 
DEFINE_DCT16x16_MATRIX
( 64, 83, 36, 89, 75, 50, 18, 90, 87, 80, 70, 57, 43, 25, 9),

504 
DEFINE_DCT16x16_MATRIX
( 64, 83, 36, 89, 75, 50, 18, 90, 87, 80, 70, 57, 43, 25, 9)

507 c⁄° 
TM©rixC€ff
 
	gg_aiT32
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][32][32] =

509 
DEFINE_DCT32x32_MATRIX
( 64, 83, 36, 89, 75, 50, 18, 90, 87, 80, 70, 57, 43, 25, 9, 90, 90, 88, 85, 82, 78, 73, 67, 61, 54, 46, 38, 31, 22, 13, 4),

510 
DEFINE_DCT32x32_MATRIX
( 64, 83, 36, 89, 75, 50, 18, 90, 87, 80, 70, 57, 43, 25, 9, 90, 90, 88, 85, 82, 78, 73, 67, 61, 54, 46, 38, 31, 22, 13, 4)

513 c⁄° 
TM©rixC€ff
 
	gg_as_DST_MAT_4
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][4][4] =

515 
DEFINE_DST4x4_MATRIX
( 29, 55, 74, 84),

516 
DEFINE_DST4x4_MATRIX
( 29, 55, 74, 84)

523 #unde‡
DEFINE_DST4x4_MATRIX


524 #unde‡
DEFINE_DCT4x4_MATRIX


525 #unde‡
DEFINE_DCT8x8_MATRIX


526 #unde‡
DEFINE_DCT16x16_MATRIX


527 #unde‡
DEFINE_DCT32x32_MATRIX


532 c⁄° 
UCh¨
 
	gg_aucChromaSˇÀ
[
NUM_CHROMA_FORMAT
][
chromaQPM≠pögTabÀSize
]=

545 c⁄° 
UCh¨
 
	gg_aucI¡øModeNumFa°_U£MPM
[
MAX_CU_DEPTH
] =

554 c⁄° 
UCh¨
 
	gg_aucI¡øModeNumFa°_NŸU£MPM
[
MAX_CU_DEPTH
] =

564 c⁄° 
UCh¨
 
	gg_chroma422I¡øAngÀM≠pögTabÀ
[
NUM_INTRA_MODE
] =

566 { 0, 1, 2, 2, 2, 2, 3, 5, 7, 8, 10, 12, 13, 15, 17, 18, 19, 20, 21, 22, 23, 23, 24, 24, 25, 25, 26, 27, 27, 28, 28, 29, 29, 30, 31, 
DM_CHROMA_IDX
};

572 
SCh¨
 
	gg_aucC⁄vîtToBô
 [ 
MAX_CU_SIZE
+1 ];

574 #i‡
ENC_DEC_TRACE


575 
FILE
* 
	gg_hTø˚
 = 
NULL
;

576 c⁄° 
Boﬁ
 
	gg_bEncDecTø˚E«bÀ
 = 
åue
;

577 c⁄° 
Boﬁ
 
	gg_bEncDecTø˚DißbÀ
 = 
Ál£
;

578 
Boﬁ
 
	gg_HLSTø˚E«bÀ
 = 
åue
;

579 
Boﬁ
 
	gg_bJu°DoIt
 = 
Ál£
;

580 
UI¡64
 
	gg_nSymbﬁCou¡î
 = 0;

587 
UI¡
* 
	gg_sˇnOrdî
[
SCAN_NUMBER_OF_GROUP_TYPES
][
SCAN_NUMBER_OF_TYPES
][ 
MAX_CU_DEPTH
 ][ MAX_CU_DEPTH ];

589 c⁄° 
UI¡
 
	g˘xIndM≠4x4
[4*4] =

597 c⁄° 
UI¡
 
	gg_uiMöInGroup
[ 
LAST_SIGNIFICANT_GROUPS
 ] = {0,1,2,3,4,6,8,12,16,24};

598 c⁄° 
UI¡
 
	gg_uiGroupIdx
[ 
MAX_TU_SIZE
 ] = {0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9};

600 c⁄° 
TCh¨
 *
	gM©rixTy≥
[
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
] =

636 c⁄° 
TCh¨
 *
	gM©rixTy≥_DC
[
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
] =

660 c⁄° 
I¡
 
	gg_qu™tTSDeÁu…4x4
[4*4] =

668 c⁄° 
I¡
 
	gg_qu™tI¡øDeÁu…8x8
[8*8] =

680 c⁄° 
I¡
 
	gg_qu™tI¡îDeÁu…8x8
[8*8] =

692 c⁄° 
UI¡
 
	gg_sˇlögLi°Size
 [
SCALING_LIST_SIZE_NUM
] = {16,64,256,1024};

693 c⁄° 
UI¡
 
	gg_sˇlögLi°SizeX
 [
SCALING_LIST_SIZE_NUM
] = { 4, 8, 16, 32};

	@TLibCommon/TComRom.h

38 #i‚de‡
__TCOMROM__


39 
	#__TCOMROM__


	)

41 
	~"Comm⁄Def.h
"

43 
	~<°dio.h
>

44 
	~<io°ªam
>

53 
Void
 
öôROM
();

54 
Void
 
de°royROM
();

61 
UI¡
 
g_auiZsˇnToRa°î
[ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ];

62 
UI¡
 
g_auiRa°îToZsˇn
[ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ];

63 
UI¡
* 
g_sˇnOrdî
[
SCAN_NUMBER_OF_GROUP_TYPES
][
SCAN_NUMBER_OF_TYPES
][ 
MAX_CU_DEPTH
 ][ MAX_CU_DEPTH ];

65 
Void
 
öôZsˇnToRa°î
 ( 
I¡
 
iMaxDïth
, I¡ 
iDïth
, 
UI¡
 
uiSèπVÆ
, UI¡*& 
ΩuiCuºIdx
 );

66 
Void
 
öôRa°îToZsˇn
 ( 
UI¡
 
uiMaxCUWidth
, UI¡ 
uiMaxCUHeight
, UI¡ 
uiMaxDïth
 );

69 
UI¡
 
g_auiRa°îToPñX
[ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ];

70 
UI¡
 
g_auiRa°îToPñY
[ 
MAX_NUM_PART_IDXS_IN_CTU_WIDTH
*MAX_NUM_PART_IDXS_IN_CTU_WIDTH ];

72 
Void
 
öôRa°îToPñXY
 ( 
UI¡
 
uiMaxCUWidth
, UI¡ 
uiMaxCUHeight
, UI¡ 
uiMaxDïth
 );

74 c⁄° 
UI¡
 
g_auiPUOff£t
[
NUMBER_OF_PART_SIZES
];

76 c⁄° 
I¡
 
g_qu™tSˇÀs
[
SCALING_LIST_REM_NUM
];

77 c⁄° 
I¡
 
g_övQu™tSˇÀs
[
SCALING_LIST_REM_NUM
];

79 #i‡
RExt__HIGH_PRECISION_FORWARD_TRANSFORM


80 c⁄° 
I¡
 
	gg_å™sf‹mM©rixShi·
[
TRANSFORM_NUMBER_OF_DIRECTIONS
] = { 14, 6 };

82 c⁄° 
I¡
 
	gg_å™sf‹mM©rixShi·
[
TRANSFORM_NUMBER_OF_DIRECTIONS
] = { 6, 6 };

85 c⁄° 
TM©rixC€ff
 
g_aiT4
 [
TRANSFORM_NUMBER_OF_DIRECTIONS
][4][4];

86 c⁄° 
TM©rixC€ff
 
g_aiT8
 [
TRANSFORM_NUMBER_OF_DIRECTIONS
][8][8];

87 c⁄° 
TM©rixC€ff
 
g_aiT16
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][16][16];

88 c⁄° 
TM©rixC€ff
 
g_aiT32
[
TRANSFORM_NUMBER_OF_DIRECTIONS
][32][32];

94 c⁄° 
I¡
 
	gchromaQPM≠pögTabÀSize
 = 58;

96 c⁄° 
UCh¨
 
g_aucChromaSˇÀ
[
NUM_CHROMA_FORMAT
][
chromaQPM≠pögTabÀSize
];

103 c⁄° 
UI¡
 
˘xIndM≠4x4
[4*4];

105 c⁄° 
UI¡
 
g_uiGroupIdx
[ 
MAX_TU_SIZE
 ];

106 c⁄° 
UI¡
 
g_uiMöInGroup
[ 
LAST_SIGNIFICANT_GROUPS
 ];

112 c⁄° 
UCh¨
 
g_aucI¡øModeNumFa°_U£MPM
[
MAX_CU_DEPTH
];

113 c⁄° 
UCh¨
 
g_aucI¡øModeNumFa°_NŸU£MPM
[
MAX_CU_DEPTH
];

115 c⁄° 
UCh¨
 
g_chroma422I¡øAngÀM≠pögTabÀ
[
NUM_INTRA_MODE
];

121 c⁄° 
TM©rixC€ff
 
g_as_DST_MAT_4
 [
TRANSFORM_NUMBER_OF_DIRECTIONS
][4][4];

127 
SCh¨
 
g_aucC⁄vîtToBô
 [ 
MAX_CU_SIZE
+1 ];

130 #i‡
ENC_DEC_TRACE


131 
FILE
* 
g_hTø˚
;

132 
Boﬁ
 
g_bJu°DoIt
;

133 c⁄° 
Boﬁ
 
g_bEncDecTø˚E«bÀ
;

134 c⁄° 
Boﬁ
 
g_bEncDecTø˚DißbÀ
;

135 
Boﬁ
 
g_HLSTø˚E«bÀ
;

136 
UI¡64
 
g_nSymbﬁCou¡î
;

138 
	#COUNTER_START
 1

	)

139 
	#COUNTER_END
 0

140 

	)

141 
	#DTRACE_CABAC_F
(
x
Ëi‡––
g_nSymbﬁCou¡î
 >
COUNTER_START
 && g_nSymbﬁCou¡î <
COUNTER_END
 )|| 
g_bJu°DoIt
 ) 
	`Ârötf
–
g_hTø˚
, "%f", x );

	)

142 
	#DTRACE_CABAC_V
(
x
Ëi‡––
g_nSymbﬁCou¡î
 >
COUNTER_START
 && g_nSymbﬁCou¡î <
COUNTER_END
 )|| 
g_bJu°DoIt
 ) 
	`Ârötf
–
g_hTø˚
, "%d", x );

	)

143 
	#DTRACE_CABAC_VL
(
x
Ëi‡––
g_nSymbﬁCou¡î
 >
COUNTER_START
 && g_nSymbﬁCou¡î <
COUNTER_END
 )|| 
g_bJu°DoIt
 ) 
	`Ârötf
–
g_hTø˚
, "%Œd", x );

	)

144 
	#DTRACE_CABAC_T
(
x
Ëi‡––
g_nSymbﬁCou¡î
 >
COUNTER_START
 && g_nSymbﬁCou¡î <
COUNTER_END
 )|| 
g_bJu°DoIt
 ) 
	`Ârötf
–
g_hTø˚
, "%s", x );

	)

145 
	#DTRACE_CABAC_X
(
x
Ëi‡––
g_nSymbﬁCou¡î
 >
COUNTER_START
 && g_nSymbﬁCou¡î <
COUNTER_END
 )|| 
g_bJu°DoIt
 ) 
	`Ârötf
–
g_hTø˚
, "%x", x );

	)

146 
	#DTRACE_CABAC_R
–
x
,
y
 ) i‡––
g_nSymbﬁCou¡î
 >
COUNTER_START
 && g_nSymbﬁCou¡î <
COUNTER_END
 )|| 
g_bJu°DoIt
 ) 
	`Ârötf
–
g_hTø˚
, x, y );

	)

147 
	#DTRACE_CABAC_N
 i‡––
g_nSymbﬁCou¡î
 >
COUNTER_START
 && g_nSymbﬁCou¡î <
COUNTER_END
 )|| 
g_bJu°DoIt
 ) 
	`Ârötf
–
g_hTø˚
, "\n" );

	)

151 
	#DTRACE_CABAC_F
(
x
)

	)

152 
	#DTRACE_CABAC_V
(
x
)

	)

153 
	#DTRACE_CABAC_VL
(
x
)

	)

154 
	#DTRACE_CABAC_T
(
x
)

	)

155 
	#DTRACE_CABAC_X
(
x
)

	)

156 
	#DTRACE_CABAC_R
–
x
,
y
 )

	)

157 
	#DTRACE_CABAC_N


	)

161 c⁄° 
TCh¨
* 
«lUnôTy≥ToSåög
(
NÆUnôTy≥
 
ty≥
);

163 c⁄° 
TCh¨
 *
M©rixTy≥
[
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
];

164 c⁄° 
TCh¨
 *
M©rixTy≥_DC
[
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
];

166 c⁄° 
I¡
 
g_qu™tTSDeÁu…4x4
[4*4];

167 c⁄° 
I¡
 
g_qu™tI¡øDeÁu…8x8
[8*8];

168 c⁄° 
I¡
 
g_qu™tI¡îDeÁu…8x8
[8*8];

170 c⁄° 
UI¡
 
g_sˇlögLi°Size
 [
SCALING_LIST_SIZE_NUM
];

171 c⁄° 
UI¡
 
g_sˇlögLi°SizeX
[
SCALING_LIST_SIZE_NUM
];

	@TLibCommon/TComSampleAdaptiveOffset.cpp

38 
	~"TComSam∂eAd≠tiveOff£t.h
"

39 
	~<°rög.h
>

40 
	~<°dlib.h
>

41 
	~<°dio.h
>

42 
	~<m©h.h
>

47 
	gSAOOff£t
::
	$SAOOff£t
()

49 
	`ª£t
();

50 
	}
}

52 
	gSAOOff£t
::~
	$SAOOff£t
()

55 
	}
}

57 
Void
 
SAOOff£t
::
	$ª£t
()

59 
modeIdc
 = 
SAO_MODE_OFF
;

60 
ty≥Idc
 = -1;

61 
ty≥AuxInfo
 = -1;

62 ::
	`mem£t
(
off£t
, 0, (
I¡
)* 
MAX_NUM_SAO_CLASSES
);

63 
	}
}

65 c⁄° 
	gSAOOff£t
& SAOOff£t::
›î©‹
(c⁄° 
SAOOff£t
& 
§c
)

67 
modeIdc
 = 
§c
.modeIdc;

68 
	gty≥Idc
 = 
§c
.
ty≥Idc
;

69 
	gty≥AuxInfo
 = 
§c
.
ty≥AuxInfo
;

70 ::
mem˝y
(
off£t
, 
§c
.off£t, (
I¡
)* 
MAX_NUM_SAO_CLASSES
);

72  *
	gthis
;

76 
	gSAOBlkP¨am
::
	$SAOBlkP¨am
()

78 
	`ª£t
();

79 
	}
}

81 
	gSAOBlkP¨am
::~
	$SAOBlkP¨am
()

84 
	}
}

86 
Void
 
SAOBlkP¨am
::
	$ª£t
()

88 
I¡
 
compIdx
 = 0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

90 
off£tP¨am
[
compIdx
].
	`ª£t
();

92 
	}
}

94 c⁄° 
	gSAOBlkP¨am
& SAOBlkP¨am::
›î©‹
(c⁄° 
SAOBlkP¨am
& 
§c
)

96 
I¡
 
compIdx
 = 0; 
	gcompIdx
 < 
	gMAX_NUM_COMPONENT
; compIdx++)

98 
	goff£tP¨am
[
compIdx
] = 
§c
.
off£tP¨am
[compIdx];

100  *
	gthis
;

104 
	gTComSam∂eAd≠tiveOff£t
::
	$TComSam∂eAd≠tiveOff£t
()

106 
m_ãmpPicYuv
 = 
NULL
;

107 
m_löeBufWidth
 = 0;

108 
m_signLöeBuf1
 = 
NULL
;

109 
m_signLöeBuf2
 = 
NULL
;

110 
	}
}

113 
	gTComSam∂eAd≠tiveOff£t
::~
	$TComSam∂eAd≠tiveOff£t
()

115 
	`de°roy
();

117 i‡(
m_signLöeBuf1
)

119 
dñëe
[] 
m_signLöeBuf1
;

120 
m_signLöeBuf1
 = 
NULL
;

122 i‡(
m_signLöeBuf2
)

124 
dñëe
[] 
m_signLöeBuf2
;

125 
m_signLöeBuf2
 = 
NULL
;

127 
	}
}

129 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$¸óã
–
I¡
 
picWidth
, I¡ 
picHeight
, 
ChromaF‹m©
 
f‹m©
, 
UI¡
 
maxCUWidth
, UI¡ 
maxCUHeight
, UI¡ 
maxCUDïth
, UI¡ 
lumaBôShi·
, UI¡ 
chromaBôShi·
 )

131 
	`de°roy
();

133 
m_picWidth
 = 
picWidth
;

134 
m_picHeight
 = 
picHeight
;

135 
m_chromaF‹m©IDC
 = 
f‹m©
;

136 
m_maxCUWidth
 = 
maxCUWidth
;

137 
m_maxCUHeight
 = 
maxCUHeight
;

139 
m_numCTUInWidth
 = (
m_picWidth
/
m_maxCUWidth
) + ((m_picWidth % m_maxCUWidth)?1:0);

140 
m_numCTUInHeight
 = (
m_picHeight
/
m_maxCUHeight
) + ((m_picHeight % m_maxCUHeight)?1:0);

141 
m_numCTUsPic
 = 
m_numCTUInHeight
*
m_numCTUInWidth
;

144 i‡–!
m_ãmpPicYuv
 )

146 
m_ãmpPicYuv
 = 
√w
 
TComPicYuv
;

147 
m_ãmpPicYuv
->
	`¸óã
–
m_picWidth
, 
m_picHeight
, 
m_chromaF‹m©IDC
, 
m_maxCUWidth
, 
m_maxCUHeight
, 
maxCUDïth
, 
åue
 );

151 
I¡
 
compIdx
 = 0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

153 
m_off£tSãpLog2
 [
compIdx
] = 
	`isLuma
(
	`Comp⁄ítID
(compIdx))? 
lumaBôShi·
 : 
chromaBôShi·
;

155 
	}
}

157 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$de°roy
()

159 i‡–
m_ãmpPicYuv
 )

161 
m_ãmpPicYuv
->
	`de°roy
();

162 
dñëe
 
m_ãmpPicYuv
;

163 
m_ãmpPicYuv
 = 
NULL
;

165 
	}
}

167 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$övîtQu™tOff£ts
(
Comp⁄ítID
 
compIdx
, 
I¡
 
ty≥Idc
, I¡ 
ty≥AuxInfo
, I¡* 
d°Off£ts
, I¡* 
§cOff£ts
)

169 
I¡
 
codedOff£t
[
MAX_NUM_SAO_CLASSES
];

171 ::
	`mem˝y
(
codedOff£t
, 
§cOff£ts
, (
I¡
)*
MAX_NUM_SAO_CLASSES
);

172 ::
	`mem£t
(
d°Off£ts
, 0, (
I¡
)*
MAX_NUM_SAO_CLASSES
);

174 if(
ty≥Idc
 =
SAO_TYPE_START_BO
)

176 
I¡
 
i
=0; i< 4; i++)

178 
d°Off£ts
[(
ty≥AuxInfo
+ 
i
)%
NUM_SAO_BO_CLASSES
] = 
codedOff£t
[—y≥AuxInfo+ i)%NUM_SAO_BO_CLASSES]*(1<<
m_off£tSãpLog2
[
compIdx
]);

183 
I¡
 
i
=0; i< 
NUM_SAO_EO_CLASSES
; i++)

185 
d°Off£ts
[
i
] = 
codedOff£t
[i] *(1<<
m_off£tSãpLog2
[
compIdx
]);

187 
	`as£π
(
d°Off£ts
[
SAO_CLASS_EO_PLAIN
] == 0);

190 
	}
}

192 
I¡
 
	gTComSam∂eAd≠tiveOff£t
::
	$gëMîgeLi°
(
TComPic
* 
pic
, 
I¡
 
˘uRsAddr
, 
SAOBlkP¨am
* 
blkP¨ams
, SAOBlkP¨am* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
])

194 
I¡
 
˘uX
 = 
˘uRsAddr
 % 
m_numCTUInWidth
;

195 
I¡
 
˘uY
 = 
˘uRsAddr
 / 
m_numCTUInWidth
;

196 
I¡
 
mîgedCTUPos
;

197 
I¡
 
numVÆidMîgeC™did©es
 = 0;

199 
I¡
 
mîgeTy≥
=0; mîgeTy≥< 
NUM_SAO_MERGE_TYPES
; mergeType++)

201 
SAOBlkP¨am
* 
mîgeC™did©e
 = 
NULL
;

203 
mîgeTy≥
)

205 
SAO_MERGE_ABOVE
:

207 if(
˘uY
 > 0)

209 
mîgedCTUPos
 = 
˘uRsAddr
- 
m_numCTUInWidth
;

210 if–
pic
->
	`gëSAOMîgeAvaûabûôy
(
˘uRsAddr
, 
mîgedCTUPos
) )

212 
mîgeC™did©e
 = &(
blkP¨ams
[
mîgedCTUPos
]);

217 
SAO_MERGE_LEFT
:

219 if(
˘uX
 > 0)

221 
mîgedCTUPos
 = 
˘uRsAddr
- 1;

222 if–
pic
->
	`gëSAOMîgeAvaûabûôy
(
˘uRsAddr
, 
mîgedCTUPos
) )

224 
mîgeC™did©e
 = &(
blkP¨ams
[
mîgedCTUPos
]);

231 
	`¥ötf
("notá supported mergeÅype");

232 
	`as£π
(0);

233 
	`exô
(-1);

237 
mîgeLi°
[
mîgeTy≥
]=
mîgeC™did©e
;

238 i‡(
mîgeC™did©e
 !
NULL
)

240 
numVÆidMîgeC™did©es
++;

244  
numVÆidMîgeC™did©es
;

245 
	}
}

248 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$ªc⁄°ru˘BlkSAOP¨am
(
SAOBlkP¨am
& 
ªcP¨am
, SAOBlkP¨am* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
])

250 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

251 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

253 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
compIdx
);

254 
SAOOff£t
& 
off£tP¨am
 = 
ªcP¨am
[
comp⁄ít
];

256 if(
off£tP¨am
.
modeIdc
 =
SAO_MODE_OFF
)

261 
off£tP¨am
.
modeIdc
)

263 
SAO_MODE_NEW
:

265 
	`övîtQu™tOff£ts
(
comp⁄ít
, 
off£tP¨am
.
ty≥Idc
, off£tP¨am.
ty≥AuxInfo
, off£tP¨am.
off£t
, offsetParam.offset);

268 
SAO_MODE_MERGE
:

270 
SAOBlkP¨am
* 
mîgeT¨gë
 = 
mîgeLi°
[
off£tP¨am
.
ty≥Idc
];

271 
	`as£π
(
mîgeT¨gë
 !
NULL
);

273 
off£tP¨am
 = (*
mîgeT¨gë
)[
comp⁄ít
];

278 
	`¥ötf
("Notá supported mode");

279 
	`as£π
(0);

280 
	`exô
(-1);

284 
	}
}

286 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$ªc⁄°ru˘BlkSAOP¨ams
(
TComPic
* 
pic
, 
SAOBlkP¨am
* 
ßoBlkP¨ams
)

288 
I¡
 
compIdx
 = 0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

290 
m_picSAOE«bÀd
[
compIdx
] = 
Ál£
;

293 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

295 
I¡
 
˘uRsAddr
=0; ctuRsAddr< 
m_numCTUsPic
; ctuRsAddr++)

297 
SAOBlkP¨am
* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
] = { 
NULL
 };

298 
	`gëMîgeLi°
(
pic
, 
˘uRsAddr
, 
ßoBlkP¨ams
, 
mîgeLi°
);

300 
	`ªc⁄°ru˘BlkSAOP¨am
(
ßoBlkP¨ams
[
˘uRsAddr
], 
mîgeLi°
);

302 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

304 if(
ßoBlkP¨ams
[
˘uRsAddr
][
compIdx
].
modeIdc
 !
SAO_MODE_OFF
)

306 
m_picSAOE«bÀd
[
compIdx
] = 
åue
;

310 
	}
}

313 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$off£tBlock
(c⁄° 
I¡
 
ch™√lBôDïth
, I¡ 
ty≥Idx
, I¡* 
off£t


314 , 
Pñ
* 
§cBlk
, Pñ* 
ªsBlk
, 
I¡
 
§cSåide
, I¡ 
ªsSåide
, I¡ 
width
, I¡ 
height


315 , 
Boﬁ
 
isLe·Avaû
, Boﬁ 
isRightAvaû
, Boﬁ 
isAboveAvaû
, Boﬁ 
isBñowAvaû
, Boﬁ 
isAboveLe·Avaû
, Boﬁ 
isAboveRightAvaû
, Boﬁ 
isBñowLe·Avaû
, Boﬁ 
isBñowRightAvaû
)

317 if(
m_löeBufWidth
 !
m_maxCUWidth
)

319 
m_löeBufWidth
 = 
m_maxCUWidth
;

321 i‡(
m_signLöeBuf1
)

323 
dñëe
[] 
m_signLöeBuf1
;

324 
m_signLöeBuf1
 = 
NULL
;

326 
m_signLöeBuf1
 = 
√w
 
SCh¨
[
m_löeBufWidth
+1];

328 i‡(
m_signLöeBuf2
)

330 
dñëe
[] 
m_signLöeBuf2
;

331 
m_signLöeBuf2
 = 
NULL
;

333 
m_signLöeBuf2
 = 
√w
 
SCh¨
[
m_löeBufWidth
+1];

336 c⁄° 
I¡
 
maxSam∂eVÆueIn˛
 = (1<< 
ch™√lBôDïth
 )-1;

338 
I¡
 
x
,
y
, 
°¨tX
, 
°¨tY
, 
ídX
, 
ídY
, 
edgeTy≥
;

339 
I¡
 
fú°LöeSèπX
, 
fú°LöeEndX
, 
œ°LöeSèπX
, 
œ°LöeEndX
;

340 
SCh¨
 
signLe·
, 
signRight
, 
signDown
;

342 
Pñ
* 
§cLöe
 = 
§cBlk
;

343 
Pñ
* 
ªsLöe
 = 
ªsBlk
;

345 
ty≥Idx
)

347 
SAO_TYPE_EO_0
:

349 
off£t
 += 2;

350 
°¨tX
 = 
isLe·Avaû
 ? 0 : 1;

351 
ídX
 = 
isRightAvaû
 ? 
width
 : (width -1);

352 
y
=0; y< 
height
; y++)

354 
signLe·
 = (
SCh¨
)
	`sgn
(
§cLöe
[
°¨tX
] - srcLine[startX-1]);

355 
x
=
°¨tX
; x< 
ídX
; x++)

357 
signRight
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - srcLine[x+1]);

358 
edgeTy≥
 = 
signRight
 + 
signLe·
;

359 
signLe·
 = -
signRight
;

361 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

363 
§cLöe
 +
§cSåide
;

364 
ªsLöe
 +
ªsSåide
;

369 
SAO_TYPE_EO_90
:

371 
off£t
 += 2;

372 
SCh¨
 *
signUpLöe
 = 
m_signLöeBuf1
;

374 
°¨tY
 = 
isAboveAvaû
 ? 0 : 1;

375 
ídY
 = 
isBñowAvaû
 ? 
height
 : height-1;

376 i‡(!
isAboveAvaû
)

378 
§cLöe
 +
§cSåide
;

379 
ªsLöe
 +
ªsSåide
;

382 
Pñ
* 
§cLöeAbove

§cLöe
- 
§cSåide
;

383 
x
=0; x< 
width
; x++)

385 
signUpLöe
[
x
] = (
SCh¨
)
	`sgn
(
§cLöe
[x] - 
§cLöeAbove
[x]);

388 
Pñ
* 
§cLöeBñow
;

389 
y
=
°¨tY
; y<
ídY
; y++)

391 
§cLöeBñow

§cLöe
+ 
§cSåide
;

393 
x
=0; x< 
width
; x++)

395 
signDown
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x]);

396 
edgeTy≥
 = 
signDown
 + 
signUpLöe
[
x
];

397 
signUpLöe
[
x
]-
signDown
;

399 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

401 
§cLöe
 +
§cSåide
;

402 
ªsLöe
 +
ªsSåide
;

407 
SAO_TYPE_EO_135
:

409 
off£t
 += 2;

410 
SCh¨
 *
signUpLöe
, *
signDownLöe
, *
signTmpLöe
;

412 
signUpLöe
 = 
m_signLöeBuf1
;

413 
signDownLöe

m_signLöeBuf2
;

415 
°¨tX
 = 
isLe·Avaû
 ? 0 : 1 ;

416 
ídX
 = 
isRightAvaû
 ? 
width
 : (width-1);

419 
Pñ
* 
§cLöeBñow

§cLöe
+ 
§cSåide
;

420 
x
=
°¨tX
; x< 
ídX
+1; x++)

422 
signUpLöe
[
x
] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[x] - 
§cLöe
[x- 1]);

426 
Pñ
* 
§cLöeAbove

§cLöe
- 
§cSåide
;

427 
fú°LöeSèπX
 = 
isAboveLe·Avaû
 ? 0 : 1;

428 
fú°LöeEndX
 = 
isAboveAvaû
? 
ídX
: 1;

429 
x

fú°LöeSèπX
; x< 
fú°LöeEndX
; x++)

431 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeAbove
[x- 1]Ë- 
signUpLöe
[x+1];

433 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

435 
§cLöe
 +
§cSåide
;

436 
ªsLöe
 +
ªsSåide
;

440 
y
1; y< 
height
-1; y++)

442 
§cLöeBñow

§cLöe
+ 
§cSåide
;

444 
x
=
°¨tX
; x<
ídX
; x++)

446 
signDown
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x+ 1]);

447 
edgeTy≥
 = 
signDown
 + 
signUpLöe
[
x
];

448 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

450 
signDownLöe
[
x
+1] = -
signDown
;

452 
signDownLöe
[
°¨tX
] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[°¨tX] - 
§cLöe
[startX-1]);

454 
signTmpLöe
 = 
signUpLöe
;

455 
signUpLöe
 = 
signDownLöe
;

456 
signDownLöe
 = 
signTmpLöe
;

458 
§cLöe
 +
§cSåide
;

459 
ªsLöe
 +
ªsSåide
;

463 
§cLöeBñow

§cLöe
+ 
§cSåide
;

464 
œ°LöeSèπX
 = 
isBñowAvaû
 ? 
°¨tX
 : (
width
 -1);

465 
œ°LöeEndX
 = 
isBñowRightAvaû
 ? 
width
 : (width -1);

466 
x

œ°LöeSèπX
; x< 
œ°LöeEndX
; x++)

468 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x+ 1]Ë+ 
signUpLöe
[x];

469 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

474 
SAO_TYPE_EO_45
:

476 
off£t
 += 2;

477 
SCh¨
 *
signUpLöe
 = 
m_signLöeBuf1
+1;

479 
°¨tX
 = 
isLe·Avaû
 ? 0 : 1;

480 
ídX
 = 
isRightAvaû
 ? 
width
 : (width -1);

483 
Pñ
* 
§cLöeBñow

§cLöe
+ 
§cSåide
;

484 
x
=
°¨tX
-1; x< 
ídX
; x++)

486 
signUpLöe
[
x
] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[x] - 
§cLöe
[x+1]);

491 
Pñ
* 
§cLöeAbove

§cLöe
- 
§cSåide
;

492 
fú°LöeSèπX
 = 
isAboveAvaû
 ? 
°¨tX
 : (
width
 -1 );

493 
fú°LöeEndX
 = 
isAboveRightAvaû
 ? 
width
 : (width-1);

494 
x

fú°LöeSèπX
; x< 
fú°LöeEndX
; x++)

496 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeAbove
[x+1]Ë-
signUpLöe
[x-1];

497 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

499 
§cLöe
 +
§cSåide
;

500 
ªsLöe
 +
ªsSåide
;

503 
y
1; y< 
height
-1; y++)

505 
§cLöeBñow

§cLöe
+ 
§cSåide
;

507 
x

°¨tX
; x< 
ídX
; x++)

509 
signDown
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x-1]);

510 
edgeTy≥
 = 
signDown
 + 
signUpLöe
[
x
];

511 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

512 
signUpLöe
[
x
-1] = -
signDown
;

514 
signUpLöe
[
ídX
-1] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[ídX-1] - 
§cLöe
[endX]);

515 
§cLöe
 +
§cSåide
;

516 
ªsLöe
 +
ªsSåide
;

520 
§cLöeBñow

§cLöe
+ 
§cSåide
;

521 
œ°LöeSèπX
 = 
isBñowLe·Avaû
 ? 0 : 1;

522 
œ°LöeEndX
 = 
isBñowAvaû
 ? 
ídX
 : 1;

523 
x

œ°LöeSèπX
; x< 
œ°LöeEndX
; x++)

525 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x-1]Ë+ 
signUpLöe
[x];

526 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[
edgeTy≥
]);

531 
SAO_TYPE_BO
:

533 c⁄° 
I¡
 
shi·Bôs
 = 
ch™√lBôDïth
 - 
NUM_SAO_BO_CLASSES_LOG2
;

534 
y
=0; y< 
height
; y++)

536 
x
=0; x< 
width
; x++)

538 
ªsLöe
[
x
] = 
Clù3
<
I¡
>(0, 
maxSam∂eVÆueIn˛
, 
§cLöe
[x] + 
off£t
[§cLöe[x] >> 
shi·Bôs
] );

540 
§cLöe
 +
§cSåide
;

541 
ªsLöe
 +
ªsSåide
;

547 
	`¥ötf
("Notá supported SAOÅypes\n");

548 
	`as£π
(0);

549 
	`exô
(-1);

552 
	}
}

554 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$off£tCTU
(
I¡
 
˘uRsAddr
, 
TComPicYuv
* 
§cYuv
, TComPicYuv* 
ªsYuv
, 
SAOBlkP¨am
& 
ßoblkP¨am
, 
TComPic
* 
pPic
)

556 
Boﬁ
 
isLe·Avaû
,
isRightAvaû
,
isAboveAvaû
,
isBñowAvaû
,
isAboveLe·Avaû
,
isAboveRightAvaû
,
isBñowLe·Avaû
,
isBñowRightAvaû
;

558 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

559 
Boﬁ
 
bAŒOff
=
åue
;

560 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

562 i‡(
ßoblkP¨am
[
compIdx
].
modeIdc
 !
SAO_MODE_OFF
)

564 
bAŒOff
=
Ál£
;

567 i‡(
bAŒOff
)

573 
pPic
->
	`gëPicSym
()->
	`dîiveLo›FûãrBound¨yAvaûibûôy
(
˘uRsAddr
, 
isLe·Avaû
,
isRightAvaû
,
isAboveAvaû
,
isBñowAvaû
,
isAboveLe·Avaû
,
isAboveRightAvaû
,
isBñowLe·Avaû
,
isBñowRightAvaû
);

575 
I¡
 
yPos
 = (
˘uRsAddr
 / 
m_numCTUInWidth
)*
m_maxCUHeight
;

576 
I¡
 
xPos
 = (
˘uRsAddr
 % 
m_numCTUInWidth
)*
m_maxCUWidth
;

577 
I¡
 
height
 = (
yPos
 + 
m_maxCUHeight
 > 
m_picHeight
)?(m_picHeight- yPos):m_maxCUHeight;

578 
I¡
 
width
 = (
xPos
 + 
m_maxCUWidth
 > 
m_picWidth
 )?(m_picWidth - xPos):m_maxCUWidth;

580 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

582 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
compIdx
);

583 
SAOOff£t
& 
˘bOff£t
 = 
ßoblkP¨am
[
compIdx
];

585 if(
˘bOff£t
.
modeIdc
 !
SAO_MODE_OFF
)

587 c⁄° 
UI¡
 
comp⁄ítSˇÀX
 = 
	`gëComp⁄ítSˇÀX
(
comp⁄ít
, 
pPic
->
	`gëChromaF‹m©
());

588 c⁄° 
UI¡
 
comp⁄ítSˇÀY
 = 
	`gëComp⁄ítSˇÀY
(
comp⁄ít
, 
pPic
->
	`gëChromaF‹m©
());

590 
I¡
 
blkWidth
 = (
width
 >> 
comp⁄ítSˇÀX
);

591 
I¡
 
blkHeight
 = (
height
 >> 
comp⁄ítSˇÀY
);

592 
I¡
 
blkXPos
 = (
xPos
 >> 
comp⁄ítSˇÀX
);

593 
I¡
 
blkYPos
 = (
yPos
 >> 
comp⁄ítSˇÀY
);

595 
I¡
 
§cSåide
 = 
§cYuv
->
	`gëSåide
(
comp⁄ít
);

596 
Pñ
* 
§cBlk
 = 
§cYuv
->
	`gëAddr
(
comp⁄ít
Ë+ 
blkYPos
*
§cSåide
 + 
blkXPos
;

598 
I¡
 
ªsSåide
 = 
ªsYuv
->
	`gëSåide
(
comp⁄ít
);

599 
Pñ
* 
ªsBlk
 = 
ªsYuv
->
	`gëAddr
(
comp⁄ít
Ë+ 
blkYPos
*
ªsSåide
 + 
blkXPos
;

601 
	`off£tBlock
–
pPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïth
(
	`toCh™√lTy≥
(
comp⁄ít
)), 
˘bOff£t
.
ty≥Idc
, ctbOff£t.
off£t


602 , 
§cBlk
, 
ªsBlk
, 
§cSåide
, 
ªsSåide
, 
blkWidth
, 
blkHeight


603 , 
isLe·Avaû
, 
isRightAvaû


604 , 
isAboveAvaû
, 
isBñowAvaû


605 , 
isAboveLe·Avaû
, 
isAboveRightAvaû


606 , 
isBñowLe·Avaû
, 
isBñowRightAvaû


611 
	}
}

614 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$SAOPro˚ss
(
TComPic
* 
pDecPic
)

616 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

617 
Boﬁ
 
bAŒDißbÀd
=
åue
;

618 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

620 i‡(
m_picSAOE«bÀd
[
compIdx
])

622 
bAŒDißbÀd
=
Ál£
;

625 i‡(
bAŒDißbÀd
)

630 
TComPicYuv
* 
ªsYuv
 = 
pDecPic
->
	`gëPicYuvRec
();

631 
TComPicYuv
* 
§cYuv
 = 
m_ãmpPicYuv
;

632 
ªsYuv
->
	`c›yToPic
(
§cYuv
);

633 
I¡
 
˘uRsAddr
0; ctuRsAdd∏< 
m_numCTUsPic
; ctuRsAddr++)

635 
	`off£tCTU
(
˘uRsAddr
, 
§cYuv
, 
ªsYuv
, (
pDecPic
->
	`gëPicSym
()->
	`gëSAOBlkP¨am
())[ctuRsAddr],ÖDecPic);

637 
	}
}

645 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$PCMLFDißbÀPro˚ss
 (
TComPic
* 
pcPic
)

647 
	`xPCMRe°‹©i⁄
(
pcPic
);

648 
	}
}

653 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$xPCMRe°‹©i⁄
(
TComPic
* 
pcPic
)

655 
Boﬁ
 
bPCMFûãr
 = (
pcPic
->
	`gëSli˚
(0)->
	`gëSPS
()->
	`gëU£PCM
(Ë&&ÖcPic->gëSli˚(0)->gëSPS()->
	`gëPCMFûãrDißbÀFœg
())? 
åue
 : 
Ál£
;

657 if(
bPCMFûãr
 || 
pcPic
->
	`gëSli˚
(0)->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

659  
UI¡
 
˘uRsAddr
 = 0; ctuRsAdd∏< 
pcPic
->
	`gëNumbîOfCtusInFøme
() ; ctuRsAddr++ )

661 
TComD©aCU
* 
pcCU
 = 
pcPic
->
	`gëCtu
(
˘uRsAddr
);

663 
	`xPCMCURe°‹©i⁄
(
pcCU
, 0, 0);

666 
	}
}

673 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$xPCMCURe°‹©i⁄
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
, UI¡ 
uiDïth
 )

675 
TComPic
* 
pcPic
 = 
pcCU
->
	`gëPic
();

676 
UI¡
 
uiCurNumP¨ts
 = 
pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
<<1);

677 
UI¡
 
uiQNumP¨ts
 = 
uiCurNumP¨ts
>>2;

680 if–
pcCU
->
	`gëDïth
(
uiAbsZ‹dîIdx
Ë> 
uiDïth
 )

682  
UI¡
 
uiP¨tIdx
 = 0; uiP¨tIdx < 4; uiP¨tIdx++, 
uiAbsZ‹dîIdx
+=
uiQNumP¨ts
 )

684 
UI¡
 
uiLPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
] ];

685 
UI¡
 
uiTPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiAbsZ‹dîIdx
] ];

686 if––
uiLPñX
 < 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPicWidthInLumaSam∂es
(ËË&& ( 
uiTPñY
 <ÖcCU->gëSli˚()->gëSPS()->
	`gëPicHeightInLumaSam∂es
() ) )

688 
	`xPCMCURe°‹©i⁄
–
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
+1 );

695 i‡((
pcCU
->
	`gëIPCMFœg
(
uiAbsZ‹dîIdx
)&& 
pcPic
->
	`gëSli˚
(0)->
	`gëSPS
()->
	`gëPCMFûãrDißbÀFœg
()Ë||ÖcCU->
	`isLos¶essCoded
( uiAbsZorderIdx))

697 c⁄° 
UI¡
 
numComp⁄íts
=
pcPic
->
	`gëNumbîVÆidComp⁄íts
();

698 
UI¡
 
comp
=0; comp<
numComp⁄íts
; comp++)

700 
	`xPCMSam∂eRe°‹©i⁄
 (
pcCU
, 
uiAbsZ‹dîIdx
, 
uiDïth
, 
	`Comp⁄ítID
(
comp
));

703 
	}
}

711 
Void
 
	gTComSam∂eAd≠tiveOff£t
::
	$xPCMSam∂eRe°‹©i⁄
 (
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
, UI¡ 
uiDïth
, c⁄° 
Comp⁄ítID
 
compID
)

713 
TComPicYuv
* 
pcPicYuvRec
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
();

714 
UI¡
 
uiPcmLe·Shi·Bô
;

715 c⁄° 
UI¡
 
uiMöC€ffSize
 = 
pcCU
->
	`gëPic
()->
	`gëMöCUWidth
()*pcCU->gëPic()->
	`gëMöCUHeight
();

716 c⁄° 
UI¡
 
csx
=
pcPicYuvRec
->
	`gëComp⁄ítSˇÀX
(
compID
);

717 c⁄° 
UI¡
 
csy
=
pcPicYuvRec
->
	`gëComp⁄ítSˇÀY
(
compID
);

718 c⁄° 
UI¡
 
uiOff£t
 = (
uiMöC€ffSize
*
uiAbsZ‹dîIdx
)>>(
csx
+
csy
);

720 
Pñ
 *
piSrc
 = 
pcPicYuvRec
->
	`gëAddr
(
compID
, 
pcCU
->
	`gëCtuRsAddr
(), 
uiAbsZ‹dîIdx
);

721 c⁄° 
Pñ
 *
piPcm
 = 
pcCU
->
	`gëPCMSam∂e
(
compID
Ë+ 
uiOff£t
;

722 c⁄° 
UI¡
 
uiSåide
 = 
pcPicYuvRec
->
	`gëSåide
(
compID
);

723 c⁄° 
TComSPS
 &
•s
 = *(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

724 c⁄° 
UI¡
 
uiWidth
 = ((
•s
.
	`gëMaxCUWidth
(Ë>> 
uiDïth
Ë>> 
csx
);

725 c⁄° 
UI¡
 
uiHeight
 = ((
•s
.
	`gëMaxCUHeight
(Ë>> 
uiDïth
Ë>> 
csy
);

727 i‡–
pcCU
->
	`isLos¶essCoded
(
uiAbsZ‹dîIdx
Ë&& !pcCU->
	`gëIPCMFœg
(uiAbsZorderIdx) )

729 
uiPcmLe·Shi·Bô
 = 0;

733 
uiPcmLe·Shi·Bô
 = 
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
)Ë- sps.
	`gëPCMBôDïth
(toChannelType(compID));

736 
UI¡
 
uiY
 = 0; uiY < 
uiHeight
; uiY++ )

738 
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

740 
piSrc
[
uiX
] = (
piPcm
[uiX] << 
uiPcmLe·Shi·Bô
);

742 
piPcm
 +
uiWidth
;

743 
piSrc
 +
uiSåide
;

745 
	}
}

	@TLibCommon/TComSampleAdaptiveOffset.h

38 #i‚de‡
__TCOMSAMPLEADAPTIVEOFFSET__


39 
	#__TCOMSAMPLEADAPTIVEOFFSET__


	)

41 
	~"Comm⁄Def.h
"

42 
	~"TComPic.h
"

52 
	#MAX_SAO_TRUNCATED_BITDEPTH
 10

	)

58 
	gãm∂©e
 <
ty≥«me
 
	gT
> 
I¡
 
	$sgn
(
T
 
vÆ
)

60  (
	`T
(0Ë< 
vÆ
) - (val < T(0));

61 
	}
}

63 ˛as†
	cTComSam∂eAd≠tiveOff£t


65 
	mpublic
:

66 
TComSam∂eAd≠tiveOff£t
();

67 
	mvútuÆ
 ~
TComSam∂eAd≠tiveOff£t
();

68 
Void
 
SAOPro˚ss
(
TComPic
* 
pDecPic
);

69 
Void
 
¸óã
–
I¡
 
picWidth
, I¡ 
picHeight
, 
ChromaF‹m©
 
f‹m©
, 
UI¡
 
maxCUWidth
, UI¡ 
maxCUHeight
, UI¡ 
maxCUDïth
, UI¡ 
lumaBôShi·
, UI¡ 
chromaBôShi·
 );

70 
Void
 
de°roy
();

71 
Void
 
ªc⁄°ru˘BlkSAOP¨ams
(
TComPic
* 
pic
, 
SAOBlkP¨am
* 
ßoBlkP¨ams
);

72 
Void
 
PCMLFDißbÀPro˚ss
 (
TComPic
* 
pcPic
);

73 
I¡
 
	$gëMaxOff£tQVÆ
(c⁄° 
I¡
 
ch™√lBôDïth
Ë{  (1<<(
°d
::
mö
<I¡>(ch™√lBôDïth,
MAX_SAO_TRUNCATED_BITDEPTH
)-5))-1; }

75 
¥Ÿe˘ed
:

76 
Void
 
	`off£tBlock
(c⁄° 
I¡
 
ch™√lBôDïth
, I¡ 
ty≥Idx
, I¡* 
off£t
, 
Pñ
* 
§cBlk
, Pñ* 
ªsBlk
, I¡ 
§cSåide
, I¡ 
ªsSåide
, I¡ 
width
, I¡ 
height


77 , 
Boﬁ
 
isLe·Avaû
, Boﬁ 
isRightAvaû
, Boﬁ 
isAboveAvaû
, Boﬁ 
isBñowAvaû
, Boﬁ 
isAboveLe·Avaû
, Boﬁ 
isAboveRightAvaû
, Boﬁ 
isBñowLe·Avaû
, Boﬁ 
isBñowRightAvaû
);

78 
Void
 
	`övîtQu™tOff£ts
(
Comp⁄ítID
 
compIdx
, 
I¡
 
ty≥Idc
, I¡ 
ty≥AuxInfo
, I¡* 
d°Off£ts
, I¡* 
§cOff£ts
);

79 
Void
 
	`ªc⁄°ru˘BlkSAOP¨am
(
SAOBlkP¨am
& 
ªcP¨am
, SAOBlkP¨am* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
]);

80 
I¡
 
	`gëMîgeLi°
(
TComPic
* 
pic
, I¡ 
˘uRsAddr
, 
SAOBlkP¨am
* 
blkP¨ams
, SAOBlkP¨am* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
]);

81 
Void
 
	`off£tCTU
(
I¡
 
˘uRsAddr
, 
TComPicYuv
* 
§cYuv
, TComPicYuv* 
ªsYuv
, 
SAOBlkP¨am
& 
ßoblkP¨am
, 
TComPic
* 
pPic
);

82 
Void
 
	`xPCMRe°‹©i⁄
(
TComPic
* 
pcPic
);

83 
Void
 
	`xPCMCURe°‹©i⁄
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
, UI¡ 
uiDïth
 );

84 
Void
 
	`xPCMSam∂eRe°‹©i⁄
 (
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsZ‹dîIdx
, UI¡ 
uiDïth
, c⁄° 
Comp⁄ítID
 
compID
);

85 
¥Ÿe˘ed
:

86 
UI¡
 
m_off£tSãpLog2
[
MAX_NUM_COMPONENT
];

87 
TComPicYuv
* 
m_ãmpPicYuv
;

88 
I¡
 
m_picWidth
;

89 
I¡
 
m_picHeight
;

90 
I¡
 
m_maxCUWidth
;

91 
I¡
 
m_maxCUHeight
;

92 
I¡
 
m_numCTUInWidth
;

93 
I¡
 
m_numCTUInHeight
;

94 
I¡
 
m_numCTUsPic
;

97 
I¡
 
m_löeBufWidth
;

98 
SCh¨
* 
m_signLöeBuf1
;

99 
SCh¨
* 
m_signLöeBuf2
;

100 
ChromaF‹m©
 
m_chromaF‹m©IDC
;

101 
¥iv©e
:

102 
Boﬁ
 
m_picSAOE«bÀd
[
MAX_NUM_COMPONENT
];

103 
	}
};

	@TLibCommon/TComSlice.cpp

38 
	~"Comm⁄Def.h
"

39 
	~"TComSli˚.h
"

40 
	~"TComPic.h
"

41 
	~"TLibEncodî/TEncSbac.h
"

42 
	~"TLibDecodî/TDecSbac.h
"

48 
	gTComSli˚
::
	$TComSli˚
()

49 : 
	`m_iPPSId
 ( -1 )

50 , 
	`m_PicOuçutFœg
 ( 
åue
 )

51 , 
	`m_iPOC
 ( 0 )

52 , 
	`m_iLa°IDR
 ( 0 )

53 , 
	`m_iAssocüãdIRAP
 ( 0 )

54 , 
	`m_iAssocüãdIRAPTy≥
 ( 
NAL_UNIT_INVALID
 )

55 , 
	`m_pRPS
 ( 0 )

56 , 
	`m_loˇlRPS
 ( )

57 , 
	`m_ΩsIdx
 ( 0 )

58 , 
	`m_RefPicLi°Modifiˇti⁄
 ( )

59 , 
	`m_eNÆUnôTy≥
 ( 
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 )

60 , 
	`m_eSli˚Ty≥
 ( 
I_SLICE
 )

61 , 
	`m_iSli˚Qp
 ( 0 )

62 , 
	$m_dïídítSli˚SegmítFœg
 ( 
Ál£
 )

63 #i‡
ADAPTIVE_QP_SELECTION


64 , 
	$m_iSli˚QpBa£
 ( 0 )

66 , 
	`m_ChromaQpAdjE«bÀd
 ( 
Ál£
 )

67 , 
	`m_deblockögFûãrDißbÀ
 ( 
Ál£
 )

68 , 
	`m_deblockögFûãrOvîrideFœg
 ( 
Ál£
 )

69 , 
	`m_deblockögFûãrBëaOff£tDiv2
( 0 )

70 , 
	`m_deblockögFûãrTcOff£tDiv2
 ( 0 )

71 , 
	`m_bCheckLDC
 ( 
Ál£
 )

72 , 
	`m_iSli˚QpDñè
 ( 0 )

73 , 
	`m_iDïth
 ( 0 )

74 , 
	`m_bRe„n˚d
 ( 
Ál£
 )

75 , 
	`m_pcVPS
 ( 
NULL
 )

76 , 
	`m_pcSPS
 ( 
NULL
 )

77 , 
	`m_pcPPS
 ( 
NULL
 )

78 , 
	`m_pcPic
 ( 
NULL
 )

79 , 
	`m_cﬁFromL0Fœg
 ( 
åue
 )

80 , 
	`m_noOuçutPri‹PicsFœg
 ( 
Ál£
 )

81 , 
	`m_noRa¶OuçutFœg
 ( 
Ál£
 )

82 , 
	`m_h™dÀCøAsBœFœg
 ( 
Ál£
 )

83 , 
	`m_cﬁRefIdx
 ( 0 )

84 , 
	`m_maxNumMîgeC™d
 ( 0 )

85 , 
	`m_uiTLayî
 ( 0 )

86 , 
	`m_bTLayîSwôchögFœg
 ( 
Ál£
 )

87 , 
	`m_¶i˚Mode
 ( 
NO_SLICES
 )

88 , 
	`m_¶i˚Argumít
 ( 0 )

89 , 
	`m_¶i˚CurSèπCtuTsAddr
 ( 0 )

90 , 
	`m_¶i˚CurEndCtuTsAddr
 ( 0 )

91 , 
	`m_¶i˚Idx
 ( 0 )

92 , 
	`m_¶i˚SegmítMode
 ( 
NO_SLICES
 )

93 , 
	`m_¶i˚SegmítArgumít
 ( 0 )

94 , 
	`m_¶i˚SegmítCurSèπCtuTsAddr
 ( 0 )

95 , 
	`m_¶i˚SegmítCurEndCtuTsAddr
 ( 0 )

96 , 
	`m_√xtSli˚
 ( 
Ál£
 )

97 , 
	`m_√xtSli˚Segmít
 ( 
Ál£
 )

98 , 
	`m_¶i˚Bôs
 ( 0 )

99 , 
	`m_¶i˚SegmítBôs
 ( 0 )

100 , 
	`m_bFöÆized
 ( 
Ál£
 )

101 , 
	`m_bTe°WeightPªd
 ( 
Ál£
 )

102 , 
	`m_bTe°WeightBiPªd
 ( 
Ál£
 )

103 , 
	`m_sub°ªamSizes
 ( )

104 , 
	`m_ˇbacInôFœg
 ( 
Ál£
 )

105 , 
	`m_bLMvdL1Zîo
 ( 
Ál£
 )

106 , 
	`m_ãmp‹ÆLayîN⁄Re„ªn˚Fœg
 ( 
Ál£
 )

107 , 
	`m_LFCrossSli˚Bound¨yFœg
 ( 
Ál£
 )

108 , 
	`m_íabÀTMVPFœg
 ( 
åue
 )

109 , 
	$m_ícCABACTabÀIdx
 (
I_SLICE
)

111 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

113 
m_aiNumRefIdx
[
i
] = 0;

116 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< 
MAX_NUM_COMPONENT
; component++)

118 
m_œmbdas
 [
comp⁄ít
] = 0.0;

119 
m_iSli˚ChromaQpDñè
[
comp⁄ít
] = 0;

122 
	`öôEquÆRef
();

124  
I¡
 
idx
 = 0; idx < 
MAX_NUM_REF
; idx++ )

126 
m_li°1IdxToLi°0Idx
[
idx
] = -1;

129 
I¡
 
iNumCou¡
 = 0; iNumCou¡ < 
MAX_NUM_REF
; iNumCount++)

131 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

133 
m_≠cRefPicLi°
 [
i
][
iNumCou¡
] = 
NULL
;

134 
m_aiRefPOCLi°
 [
i
][
iNumCou¡
] = 0;

138 
	`ª£tWpSˇlög
();

139 
	`öôWpAcDcP¨am
();

141 
I¡
 
ch
=0; ch < 
MAX_NUM_CHANNEL_TYPE
; ch++)

143 
m_ßoE«bÀdFœg
[
ch
] = 
Ál£
;

145 
	}
}

147 
	gTComSli˚
::~
	$TComSli˚
()

149 
	}
}

152 
Void
 
TComSli˚
::
	$öôSli˚
()

154 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

156 
m_aiNumRefIdx
[
i
] = 0;

158 
m_cﬁFromL0Fœg
 = 
åue
;

160 
m_cﬁRefIdx
 = 0;

161 
	`öôEquÆRef
();

163 
m_bCheckLDC
 = 
Ál£
;

165 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< 
MAX_NUM_COMPONENT
; component++)

167 
m_iSli˚ChromaQpDñè
[
comp⁄ít
] = 0;

170 
m_maxNumMîgeC™d
 = 
MRG_MAX_NUM_CANDS
;

172 
m_bFöÆized
=
Ál£
;

174 
m_sub°ªamSizes
.
	`˛ór
();

175 
m_ˇbacInôFœg
 = 
Ál£
;

176 
m_íabÀTMVPFœg
 = 
åue
;

177 
	}
}

179 
Boﬁ
 
	gTComSli˚
::
	$gëR≠PicFœg
() const

181  
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL


182 || 
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP


183 || 
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP


184 || 
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


185 || 
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


186 || 
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
;

187 
	}
}

190 
Void
 
	gTComSli˚
::
s‹tPicLi°
 (
TComLi°
<
TComPic
*>& 
rcLi°Pic
)

192 
TComPic
* 
pcPicExåa˘
;

193 
TComPic
* 
	gpcPicIn£π
;

195 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPicExåa˘
;

196 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPicExåa˘_1
;

197 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPicIn£π
;

199 
I¡
 
	gi
 = 1; i < (
	gI¡
)(
	grcLi°Pic
.
size
()); i++)

201 
	gôîPicExåa˘
 = 
rcLi°Pic
.
begö
();

202 
I¡
 
	gj
 = 0; j < 
	gi
; j++)

204 
	gôîPicExåa˘
++;

206 
	gpcPicExåa˘
 = *(
ôîPicExåa˘
);

207 
	gpcPicExåa˘
->
£tCuºSli˚Idx
(0);

209 
	gôîPicIn£π
 = 
rcLi°Pic
.
begö
();

210 
	gôîPicIn£π
 !
ôîPicExåa˘
)

212 
pcPicIn£π
 = *(
ôîPicIn£π
);

213 
	gpcPicIn£π
->
£tCuºSli˚Idx
(0);

214 i‡(
	gpcPicIn£π
->
gëPOC
(Ë>
pcPicExåa˘
->getPOC())

219 
	gôîPicIn£π
++;

222 
	gôîPicExåa˘_1
 = 
ôîPicExåa˘
; iterPicExtract_1++;

225 
	grcLi°Pic
.
ö£π
 (
ôîPicIn£π
, 
ôîPicExåa˘
, 
ôîPicExåa˘_1
);

226 
	grcLi°Pic
.
îa£
 (
ôîPicExåa˘
);

230 
TComPic
* 
	gTComSli˚
::
xGëRefPic
 (
TComLi°
<TComPic*>& 
rcLi°Pic
, 
I¡
 
poc
)

232 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

233 
TComPic
* 
	gpcPic
 = *(
ôîPic
);

234  
	gôîPic
 !
rcLi°Pic
.
íd
() )

236 if(
pcPic
->
gëPOC
(Ë=
poc
)

240 
	gôîPic
++;

241 
	gpcPic
 = *(
ôîPic
);

243  
	gpcPic
;

247 
TComPic
* 
	gTComSli˚
::
xGëL⁄gTîmRefPic
(
TComLi°
<TComPic*>& 
rcLi°Pic
, 
I¡
 
poc
, 
Boﬁ
 
pocHasMsb
)

249 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

250 
TComPic
* 
	gpcPic
 = *(
ôîPic
);

251 
TComPic
* 
	gpcStPic
 = 
pcPic
;

253 
I¡
 
	gpocCy˛e
 = 1 << 
gëSPS
()->
gëBôsF‹POC
();

254 i‡(!
	gpocHasMsb
)

256 
	gpoc
 = 
poc
 & (
pocCy˛e
 - 1);

259  
	gôîPic
 !
rcLi°Pic
.
íd
() )

261 
pcPic
 = *(
ôîPic
);

262 i‡(
	gpcPic
 &&ÖcPic->
gëPOC
()!=
this
->gëPOC(Ë&& 
pcPic
->
gëSli˚
–0 )->
isRe„ªn˚d
())

264 
I¡
 
picPoc
 = 
pcPic
->
gëPOC
();

265 i‡(!
	gpocHasMsb
)

267 
	gpicPoc
 = 
picPoc
 & (
pocCy˛e
 - 1);

270 i‡(
	gpoc
 =
picPoc
)

272 if(
pcPic
->
gëIsL⁄gTîm
())

274  
pcPic
;

278 
	gpcStPic
 = 
pcPic
;

284 
	gôîPic
++;

287  
	gpcStPic
;

290 
Void
 
	gTComSli˚
::
	$£tRefPOCLi°
 ()

292 
I¡
 
iDú
 = 0; iDú < 
NUM_REF_PIC_LIST_01
; iDir++)

294 
I¡
 
iNumRefIdx
 = 0; iNumRefIdx < 
m_aiNumRefIdx
[
iDú
]; iNumRefIdx++)

296 
m_aiRefPOCLi°
[
iDú
][
iNumRefIdx
] = 
m_≠cRefPicLi°
[iDú][iNumRefIdx]->
	`gëPOC
();

300 
	}
}

302 
Void
 
	gTComSli˚
::
	$£tLi°1IdxToLi°0Idx
()

304 
I¡
 
idxL0
, 
idxL1
;

305  
idxL1
 = 0; idxL1 < 
	`gëNumRefIdx
–
REF_PIC_LIST_1
 ); idxL1++ )

307 
m_li°1IdxToLi°0Idx
[
idxL1
] = -1;

308  
idxL0
 = 0; idxL0 < 
	`gëNumRefIdx
–
REF_PIC_LIST_0
 ); idxL0++ )

310 i‡–
m_≠cRefPicLi°
[
REF_PIC_LIST_0
][
idxL0
]->
	`gëPOC
(Ë=m_≠cRefPicLi°[
REF_PIC_LIST_1
][
idxL1
]->getPOC() )

312 
m_li°1IdxToLi°0Idx
[
idxL1
] = 
idxL0
;

317 
	}
}

319 
Void
 
	gTComSli˚
::
£tRefPicLi°
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, 
Boﬁ
 
checkNumPocTŸÆCuº
 )

321 i‡–
	gm_eSli˚Ty≥
 =
I_SLICE
)

323 ::
mem£t
–
m_≠cRefPicLi°
, 0,  (m_apcRefPicList));

324 ::
mem£t
–
m_aiNumRefIdx
, 0,  ( m_aiNumRefIdx ));

326 i‡(!
	gcheckNumPocTŸÆCuº
)

332 
TComPic
* 
	gpcRefPic

NULL
;

333 c⁄° 
UI¡
 
	gMAX_NUM_NEGATIVE_PICTURES
=16;

334 
TComPic
* 
	gRefPicSëStCuº0
[
MAX_NUM_NEGATIVE_PICTURES
];

335 
TComPic
* 
	gRefPicSëStCuº1
[
MAX_NUM_NEGATIVE_PICTURES
];

336 
TComPic
* 
	gRefPicSëLtCuº
[
MAX_NUM_NEGATIVE_PICTURES
];

337 
UI¡
 
	gNumPicStCuº0
 = 0;

338 
UI¡
 
	gNumPicStCuº1
 = 0;

339 
UI¡
 
	gNumPicLtCuº
 = 0;

340 
I¡
 
	gi
;

342 
	gi
=0; i < 
	gm_pRPS
->
gëNumbîOfNeg©ivePi˘uªs
(); i++)

344 if(
	gm_pRPS
->
gëU£d
(
i
))

346 
	gpcRefPic
 = 
xGëRefPic
(
rcLi°Pic
, 
gëPOC
()+
m_pRPS
->
gëDñèPOC
(
i
));

347 
	gpcRefPic
->
£tIsL⁄gTîm
(0);

348 
	gpcRefPic
->
gëPicYuvRec
()->
exãndPicB‹dî
();

349 
	gRefPicSëStCuº0
[
NumPicStCuº0
] = 
pcRefPic
;

350 
	gNumPicStCuº0
++;

351 
	gpcRefPic
->
£tCheckLTMSBPª£¡
(
Ál£
);

355 ; 
	gi
 < 
	gm_pRPS
->
gëNumbîOfNeg©ivePi˘uªs
()+m_pRPS->
gëNumbîOfPosôivePi˘uªs
(); i++)

357 if(
	gm_pRPS
->
gëU£d
(
i
))

359 
	gpcRefPic
 = 
xGëRefPic
(
rcLi°Pic
, 
gëPOC
()+
m_pRPS
->
gëDñèPOC
(
i
));

360 
	gpcRefPic
->
£tIsL⁄gTîm
(0);

361 
	gpcRefPic
->
gëPicYuvRec
()->
exãndPicB‹dî
();

362 
	gRefPicSëStCuº1
[
NumPicStCuº1
] = 
pcRefPic
;

363 
	gNumPicStCuº1
++;

364 
	gpcRefPic
->
£tCheckLTMSBPª£¡
(
Ál£
);

368 
	gi
 = 
m_pRPS
->
gëNumbîOfNeg©ivePi˘uªs
()+m_pRPS->
gëNumbîOfPosôivePi˘uªs
()+m_pRPS->
gëNumbîOfL⁄gãrmPi˘uªs
()-1; i > 
	gm_pRPS
->getNumberOfNegativePictures()+m_pRPS->getNumberOfPositivePictures()-1 ; i--)

370 if(
	gm_pRPS
->
gëU£d
(
i
))

372 
	gpcRefPic
 = 
xGëL⁄gTîmRefPic
(
rcLi°Pic
, 
m_pRPS
->
gëPOC
(
i
), m_pRPS->
gëCheckLTMSBPª£¡
(i));

373 
	gpcRefPic
->
£tIsL⁄gTîm
(1);

374 
	gpcRefPic
->
gëPicYuvRec
()->
exãndPicB‹dî
();

375 
	gRefPicSëLtCuº
[
NumPicLtCuº
] = 
pcRefPic
;

376 
	gNumPicLtCuº
++;

378 if(
	gpcRefPic
==
NULL
)

380 
pcRefPic
 = 
xGëL⁄gTîmRefPic
(
rcLi°Pic
, 
m_pRPS
->
gëPOC
(
i
), m_pRPS->
gëCheckLTMSBPª£¡
(i));

382 
	gpcRefPic
->
£tCheckLTMSBPª£¡
(
m_pRPS
->
gëCheckLTMSBPª£¡
(
i
));

386 
TComPic
* 
	gΩsCuºLi°0
[
MAX_NUM_REF
+1];

387 
TComPic
* 
	gΩsCuºLi°1
[
MAX_NUM_REF
+1];

388 
I¡
 
	gnumPicTŸÆCuº
 = 
NumPicStCuº0
 + 
NumPicStCuº1
 + 
NumPicLtCuº
;

390 i‡(
	gcheckNumPocTŸÆCuº
)

395 i‡(
gëR≠PicFœg
())

397 
as£π
(
numPicTŸÆCuº
 == 0);

400 i‡(
	gm_eSli˚Ty≥
 =
I_SLICE
)

405 
as£π
(
numPicTŸÆCuº
 > 0);

407 
as£π
(
numPicTŸÆCuº
 <= 8);

410 
I¡
 
	gcIdx
 = 0;

411  
	gi
=0; i<
	gNumPicStCuº0
; i++, 
	gcIdx
++)

413 
	gΩsCuºLi°0
[
cIdx
] = 
RefPicSëStCuº0
[
i
];

415  
	gi
=0; i<
	gNumPicStCuº1
; i++, 
	gcIdx
++)

417 
	gΩsCuºLi°0
[
cIdx
] = 
RefPicSëStCuº1
[
i
];

419  
	gi
=0; i<
	gNumPicLtCuº
; i++, 
	gcIdx
++)

421 
	gΩsCuºLi°0
[
cIdx
] = 
RefPicSëLtCuº
[
i
];

423 
as£π
(
cIdx
 =
numPicTŸÆCuº
);

425 i‡(
	gm_eSli˚Ty≥
==
B_SLICE
)

427 
cIdx
 = 0;

428  
	gi
=0; i<
	gNumPicStCuº1
; i++, 
	gcIdx
++)

430 
	gΩsCuºLi°1
[
cIdx
] = 
RefPicSëStCuº1
[
i
];

432  
	gi
=0; i<
	gNumPicStCuº0
; i++, 
	gcIdx
++)

434 
	gΩsCuºLi°1
[
cIdx
] = 
RefPicSëStCuº0
[
i
];

436  
	gi
=0; i<
	gNumPicLtCuº
; i++, 
	gcIdx
++)

438 
	gΩsCuºLi°1
[
cIdx
] = 
RefPicSëLtCuº
[
i
];

440 
as£π
(
cIdx
 =
numPicTŸÆCuº
);

443 ::
mem£t
(
m_bIsU£dAsL⁄gTîm
, 0, (m_bIsUsedAsLongTerm));

445 
I¡
 
	grIdx
 = 0;ÑIdx < 
	gm_aiNumRefIdx
[
REF_PIC_LIST_0
];ÑIdx ++)

447 
	gcIdx
 = 
m_RefPicLi°Modifiˇti⁄
.
gëRefPicLi°Modifiˇti⁄FœgL0
(Ë? m_RefPicLi°Modifiˇti⁄.
gëRefPicSëIdxL0
(
rIdx
Ë:ÑIdx % 
numPicTŸÆCuº
;

448 
as£π
(
cIdx
 >0 && cIdx < 
numPicTŸÆCuº
);

449 
	gm_≠cRefPicLi°
[
REF_PIC_LIST_0
][
rIdx
] = 
ΩsCuºLi°0
[ 
cIdx
 ];

450 
	gm_bIsU£dAsL⁄gTîm
[
REF_PIC_LIST_0
][
rIdx
] = ( 
cIdx
 >
NumPicStCuº0
 + 
NumPicStCuº1
 );

452 i‡–
	gm_eSli˚Ty≥
 !
B_SLICE
 )

454 
m_aiNumRefIdx
[
REF_PIC_LIST_1
] = 0;

455 ::
mem£t
–
m_≠cRefPicLi°
[
REF_PIC_LIST_1
], 0, (m_apcRefPicList[REF_PIC_LIST_1]));

459 
I¡
 
	grIdx
 = 0;ÑIdx < 
	gm_aiNumRefIdx
[
REF_PIC_LIST_1
];ÑIdx ++)

461 
	gcIdx
 = 
m_RefPicLi°Modifiˇti⁄
.
gëRefPicLi°Modifiˇti⁄FœgL1
(Ë? m_RefPicLi°Modifiˇti⁄.
gëRefPicSëIdxL1
(
rIdx
Ë:ÑIdx % 
numPicTŸÆCuº
;

462 
as£π
(
cIdx
 >0 && cIdx < 
numPicTŸÆCuº
);

463 
	gm_≠cRefPicLi°
[
REF_PIC_LIST_1
][
rIdx
] = 
ΩsCuºLi°1
[ 
cIdx
 ];

464 
	gm_bIsU£dAsL⁄gTîm
[
REF_PIC_LIST_1
][
rIdx
] = ( 
cIdx
 >
NumPicStCuº0
 + 
NumPicStCuº1
 );

469 
I¡
 
	gTComSli˚
::
	$gëNumRpsCuºTempLi°
() const

471 
I¡
 
numRpsCuºTempLi°
 = 0;

473 i‡(
m_eSli˚Ty≥
 =
I_SLICE
)

477 
UI¡
 
i
=0; i < 
m_pRPS
->
	`gëNumbîOfNeg©ivePi˘uªs
()+ m_pRPS->
	`gëNumbîOfPosôivePi˘uªs
(Ë+ m_pRPS->
	`gëNumbîOfL⁄gãrmPi˘uªs
(); i++)

479 if(
m_pRPS
->
	`gëU£d
(
i
))

481 
numRpsCuºTempLi°
++;

484  
numRpsCuºTempLi°
;

485 
	}
}

487 
Void
 
	gTComSli˚
::
	$öôEquÆRef
()

489 
I¡
 
iDú
 = 0; iDú < 
NUM_REF_PIC_LIST_01
; iDir++)

491 
I¡
 
iRefIdx1
 = 0; iRefIdx1 < 
MAX_NUM_REF
; iRefIdx1++)

493 
I¡
 
iRefIdx2
 = 
iRefIdx1
; iRefIdx2 < 
MAX_NUM_REF
; iRefIdx2++)

495 
m_abEquÆRef
[
iDú
][
iRefIdx1
][
iRefIdx2
] = m_abEquÆRef[iDú][iRefIdx2][iRefIdx1] = (iRefIdx1 =iRefIdx2? 
åue
 : 
Ál£
);

499 
	}
}

501 
Void
 
	gTComSli˚
::
	$checkCﬁRefIdx
(
UI¡
 
curSli˚Idx
, 
TComPic
* 
pic
)

503 
I¡
 
i
;

504 
TComSli˚
* 
curSli˚
 = 
pic
->
	`gëSli˚
(
curSli˚Idx
);

505 
I¡
 
cuºCﬁRefPOC
 = 
curSli˚
->
	`gëRefPOC
–
	`RefPicLi°
(1 - curSli˚->
	`gëCﬁFromL0Fœg
()), curSli˚->
	`gëCﬁRefIdx
());

506 
TComSli˚
* 
¥eSli˚
;

507 
I¡
 
¥eCﬁRefPOC
;

508 
i
=
curSli˚Idx
-1; i>=0; i--)

510 
¥eSli˚
 = 
pic
->
	`gëSli˚
(
i
);

511 if(
¥eSli˚
->
	`gëSli˚Ty≥
(Ë!
I_SLICE
)

513 
¥eCﬁRefPOC
 = 
¥eSli˚
->
	`gëRefPOC
–
	`RefPicLi°
(1 -ÖªSli˚->
	`gëCﬁFromL0Fœg
()),ÖªSli˚->
	`gëCﬁRefIdx
());

514 if(
cuºCﬁRefPOC
 !
¥eCﬁRefPOC
)

516 
	`¥ötf
("Collocated_ref_idx shallálways beÅhe same foráll slices ofá codedÖicture!\n");

517 
	`exô
(
EXIT_FAILURE
);

525 
	}
}

527 
Void
 
	gTComSli˚
::
checkCRA
(c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pRe„ªn˚Pi˘uªSë
, 
I¡
& 
pocCRA
, 
NÆUnôTy≥
& 
assocüãdIRAPTy≥
, 
TComLi°
<
TComPic
 *>& 
rcLi°Pic
)

529 
I¡
 
	gi
 = 0; i < 
	gpRe„ªn˚Pi˘uªSë
->
gëNumbîOfNeg©ivePi˘uªs
()+pRe„ªn˚Pi˘uªSë->
gëNumbîOfPosôivePi˘uªs
(); i++)

531 if(
	gpocCRA
 < 
	gMAX_UINT
 && 
gëPOC
() >ÖocCRA)

533 
as£π
(
gëPOC
()+
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
Ë>
pocCRA
);

536 
I¡
 
	gi
 = 
pRe„ªn˚Pi˘uªSë
->
gëNumbîOfNeg©ivePi˘uªs
()+pRe„ªn˚Pi˘uªSë->
gëNumbîOfPosôivePi˘uªs
(); i < 
	gpRe„ªn˚Pi˘uªSë
->
gëNumbîOfPi˘uªs
(); i++)

538 if(
	gpocCRA
 < 
	gMAX_UINT
 && 
gëPOC
() >ÖocCRA)

540 i‡(!
	gpRe„ªn˚Pi˘uªSë
->
gëCheckLTMSBPª£¡
(
i
))

542 
as£π
(
xGëL⁄gTîmRefPic
(
rcLi°Pic
, 
pRe„ªn˚Pi˘uªSë
->
gëPOC
(
i
), 
Ál£
)->gëPOC(Ë>
pocCRA
);

546 
as£π
(
pRe„ªn˚Pi˘uªSë
->
gëPOC
(
i
Ë>
pocCRA
);

550 i‡–
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 || gëNÆUnôTy≥(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP
 )

552 
pocCRA
 = 
gëPOC
();

553 
	gassocüãdIRAPTy≥
 = 
gëNÆUnôTy≥
();

555 i‡–
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
 )

557 
pocCRA
 = 
gëPOC
();

558 
	gassocüãdIRAPTy≥
 = 
gëNÆUnôTy≥
();

560 i‡–
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


561 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


562 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP
 )

564 
pocCRA
 = 
gëPOC
();

565 
	gassocüãdIRAPTy≥
 = 
gëNÆUnôTy≥
();

587 
Void
 
	gTComSli˚
::
decodögRe‰eshM¨kög
(
I¡
& 
pocCRA
, 
Boﬁ
& 
bRe‰eshPídög
, 
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
boﬁ
 
bEfficõ¡FõldIRAPE«bÀd
)

589 
TComPic
* 
	gΩcPic
;

590 
I¡
 
	gpocCuº
 = 
gëPOC
();

592 i‡–
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


593 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


594 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP


595 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL


596 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP
 )

599 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

600 
	gôîPic
 !
rcLi°Pic
.
íd
())

602 
ΩcPic
 = *(
ôîPic
);

603 
	gΩcPic
->
£tCuºSli˚Idx
(0);

604 i‡(
	gΩcPic
->
gëPOC
(Ë!
pocCuº
)

606 
ΩcPic
->
gëSli˚
(0)->
£tRe„ªn˚d
(
Ál£
);

608 
	gôîPic
++;

610 i‡–
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


611 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


612 || 
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP
 )

614 
pocCRA
 = 
pocCuº
;

616 i‡(
	gbEfficõ¡FõldIRAPE«bÀd
)

618 
	gbRe‰eshPídög
 = 
åue
;

623 if(
	gbEfficõ¡FõldIRAPE«bÀd
 && (
gëAssocüãdIRAPTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP
 || gëAssocüãdIRAPTy≥(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL
))

625 i‡(
bRe‰eshPídög
==
åue
 && 
pocCuº
 > 
m_iLa°IDR
)

627 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

628 
	gôîPic
 !
rcLi°Pic
.
íd
())

630 
ΩcPic
 = *(
ôîPic
);

631 i‡(
	gΩcPic
->
gëPOC
(Ë!
pocCuº
 && 
ΩcPic
->gëPOC(Ë!
m_iLa°IDR
)

633 
ΩcPic
->
gëSli˚
(0)->
£tRe„ªn˚d
(
Ál£
);

635 
	gôîPic
++;

637 
	gbRe‰eshPídög
 = 
Ál£
;

642 i‡(
	gbRe‰eshPídög
==
åue
 && 
pocCuº
 > 
pocCRA
)

644 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

645 
	gôîPic
 !
rcLi°Pic
.
íd
())

647 
ΩcPic
 = *(
ôîPic
);

648 i‡(
	gΩcPic
->
gëPOC
(Ë!
pocCuº
 && 
ΩcPic
->gëPOC(Ë!
pocCRA
)

650 
ΩcPic
->
gëSli˚
(0)->
£tRe„ªn˚d
(
Ál£
);

652 
	gôîPic
++;

654 
	gbRe‰eshPídög
 = 
Ál£
;

657 i‡–
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
 )

659 
bRe‰eshPídög
 = 
åue
;

660 
	gpocCRA
 = 
pocCuº
;

665 
Void
 
	gTComSli˚
::
	$c›ySli˚Info
(
TComSli˚
 *
pSrc
)

667 
	`as£π
–
pSrc
 !
NULL
 );

669 
I¡
 
i
, 
j
, 
k
;

671 
m_iPOC
 = 
pSrc
->m_iPOC;

672 
m_eNÆUnôTy≥
 = 
pSrc
->m_eNalUnitType;

673 
m_eSli˚Ty≥
 = 
pSrc
->m_eSliceType;

674 
m_iSli˚Qp
 = 
pSrc
->m_iSliceQp;

675 #i‡
ADAPTIVE_QP_SELECTION


676 
m_iSli˚QpBa£
 = 
pSrc
->m_iSliceQpBase;

678 
m_ChromaQpAdjE«bÀd
 = 
pSrc
->m_ChromaQpAdjEnabled;

679 
m_deblockögFûãrDißbÀ
 = 
pSrc
->m_deblockingFilterDisable;

680 
m_deblockögFûãrOvîrideFœg
 = 
pSrc
->m_deblockingFilterOverrideFlag;

681 
m_deblockögFûãrBëaOff£tDiv2
 = 
pSrc
->m_deblockingFilterBetaOffsetDiv2;

682 
m_deblockögFûãrTcOff£tDiv2
 = 
pSrc
->m_deblockingFilterTcOffsetDiv2;

684 
i
 = 0; i < 
NUM_REF_PIC_LIST_01
; i++)

686 
m_aiNumRefIdx
[
i
] = 
pSrc
->m_aiNumRefIdx[i];

689 
i
 = 0; i < 
MAX_NUM_REF
; i++)

691 
m_li°1IdxToLi°0Idx
[
i
] = 
pSrc
->m_list1IdxToList0Idx[i];

694 
m_bCheckLDC
 = 
pSrc
->m_bCheckLDC;

695 
m_iSli˚QpDñè
 = 
pSrc
->m_iSliceQpDelta;

696 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< 
MAX_NUM_COMPONENT
; component++)

698 
m_iSli˚ChromaQpDñè
[
comp⁄ít
] = 
pSrc
->m_iSliceChromaQpDelta[component];

700 
i
 = 0; i < 
NUM_REF_PIC_LIST_01
; i++)

702 
j
 = 0; j < 
MAX_NUM_REF
; j++)

704 
m_≠cRefPicLi°
[
i
][
j
] = 
pSrc
->m_apcRefPicList[i][j];

705 
m_aiRefPOCLi°
[
i
][
j
] = 
pSrc
->m_aiRefPOCList[i][j];

706 
m_bIsU£dAsL⁄gTîm
[
i
][
j
] = 
pSrc
->m_bIsUsedAsLongTerm[i][j];

708 
m_bIsU£dAsL⁄gTîm
[
i
][
MAX_NUM_REF
] = 
pSrc
->m_bIsUsedAsLongTerm[i][MAX_NUM_REF];

710 
m_iDïth
 = 
pSrc
->m_iDepth;

713 
m_bRe„n˚d
 = 
pSrc
->m_bRefenced;

716 
m_pRPS
 = 
pSrc
->m_pRPS;

717 
m_iLa°IDR
 = 
pSrc
->m_iLastIDR;

719 
m_pcPic
 = 
pSrc
->m_pcPic;

721 
m_cﬁFromL0Fœg
 = 
pSrc
->m_colFromL0Flag;

722 
m_cﬁRefIdx
 = 
pSrc
->m_colRefIdx;

724 
	`£tLambdas
(
pSrc
->
	`gëLambdas
());

726 
i
 = 0; i < 
NUM_REF_PIC_LIST_01
; i++)

728 
j
 = 0; j < 
MAX_NUM_REF
; j++)

730 
k
 =0; k < 
MAX_NUM_REF
; k++)

732 
m_abEquÆRef
[
i
][
j
][
k
] = 
pSrc
->m_abEqualRef[i][j][k];

737 
m_uiTLayî
 = 
pSrc
->m_uiTLayer;

738 
m_bTLayîSwôchögFœg
 = 
pSrc
->m_bTLayerSwitchingFlag;

740 
m_¶i˚Mode
 = 
pSrc
->m_sliceMode;

741 
m_¶i˚Argumít
 = 
pSrc
->m_sliceArgument;

742 
m_¶i˚CurSèπCtuTsAddr
 = 
pSrc
->m_sliceCurStartCtuTsAddr;

743 
m_¶i˚CurEndCtuTsAddr
 = 
pSrc
->m_sliceCurEndCtuTsAddr;

744 
m_¶i˚Idx
 = 
pSrc
->m_sliceIdx;

745 
m_¶i˚SegmítMode
 = 
pSrc
->m_sliceSegmentMode;

746 
m_¶i˚SegmítArgumít
 = 
pSrc
->m_sliceSegmentArgument;

747 
m_¶i˚SegmítCurSèπCtuTsAddr
 = 
pSrc
->m_sliceSegmentCurStartCtuTsAddr;

748 
m_¶i˚SegmítCurEndCtuTsAddr
 = 
pSrc
->m_sliceSegmentCurEndCtuTsAddr;

749 
m_√xtSli˚
 = 
pSrc
->m_nextSlice;

750 
m_√xtSli˚Segmít
 = 
pSrc
->m_nextSliceSegment;

752  
UI¡
 
e
=0 ;É<
NUM_REF_PIC_LIST_01
 ;É++ )

754  
UI¡
 
n
=0 ;Ç<
MAX_NUM_REF
 ;Ç++ )

756 
	`mem˝y
(
m_weightPªdTabÀ
[
e
][
n
], 
pSrc
->m_weightPªdTabÀ[e][n], (
WPSˇlögP¨am
)*
MAX_NUM_COMPONENT
 );

760  
UI¡
 
ch
 = 0 ; ch < 
MAX_NUM_CHANNEL_TYPE
; ch++)

762 
m_ßoE«bÀdFœg
[
ch
] = 
pSrc
->m_saoEnabledFlag[ch];

765 
m_ˇbacInôFœg
 = 
pSrc
->m_cabacInitFlag;

767 
m_bLMvdL1Zîo
 = 
pSrc
->m_bLMvdL1Zero;

768 
m_LFCrossSli˚Bound¨yFœg
 = 
pSrc
->m_LFCrossSliceBoundaryFlag;

769 
m_íabÀTMVPFœg
 = 
pSrc
->m_enableTMVPFlag;

770 
m_maxNumMîgeC™d
 = 
pSrc
->m_maxNumMergeCand;

771 
m_ícCABACTabÀIdx
 = 
pSrc
->m_encCABACTableIdx;

772 
	}
}

781 
Void
 
	gTComSli˚
::
	$£tTLayîInfo
–
UI¡
 
uiTLayî
 )

783 
m_uiTLayî
 = 
uiTLayî
;

784 
	}
}

788 
Boﬁ
 
	gTComSli˚
::
isTemp‹ÆLayîSwôchögPoöt
(
TComLi°
<
TComPic
*>& 
rcLi°Pic
)

790 
TComPic
* 
ΩcPic
;

792 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

793  
	gôîPic
 !
rcLi°Pic
.
íd
())

795 
ΩcPic
 = *(
ôîPic
++);

796 if(
	gΩcPic
->
gëSli˚
(0)->
isRe„ªn˚d
(Ë&&ÑpcPic->
gëPOC
() != getPOC())

798 if(
ΩcPic
->
gëTLayî
() >= getTLayer())

800  
Ál£
;

804  
	gåue
;

809 
Boﬁ
 
	gTComSli˚
::
isSãpwi£Temp‹ÆLayîSwôchögPoötC™did©e
(
TComLi°
<
TComPic
*>& 
rcLi°Pic
)

811 
TComPic
* 
ΩcPic
;

813 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

814  
	gôîPic
 !
rcLi°Pic
.
íd
())

816 
ΩcPic
 = *(
ôîPic
++);

817 if(
	gΩcPic
->
gëSli˚
(0)->
isRe„ªn˚d
(Ë&& (ΩcPic->
gëU£dByCuº
()==
åue
Ë&& 
ΩcPic
->
gëPOC
() != getPOC())

819 if(
ΩcPic
->
gëTLayî
() >= getTLayer())

821  
Ál£
;

825  
	gåue
;

829 
Void
 
	gTComSli˚
::
checkLódögPi˘uªRe°ri˘i⁄s
(
TComLi°
<
TComPic
*>& 
rcLi°Pic
)

831 
TComPic
* 
ΩcPic
;

833 
I¡
 
	g«lUnôTy≥
 = 
this
->
gëNÆUnôTy≥
();

836 if(
	gthis
->
gëAssocüãdIRAPPOC
(Ë>Åhis->
gëPOC
())

839 if(
	g«lUnôTy≥
 < 
	gNAL_UNIT_CODED_SLICE_BLA_W_LP
 ||

840 
	g«lUnôTy≥
 > 
	gNAL_UNIT_RESERVED_IRAP_VCL23
)

842 
as£π
(
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_N
 ||

843 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_R
 ||

844 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_N
 ||

845 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_R
);

850 if(
	gthis
->
gëAssocüãdIRAPPOC
(Ë<Åhis->
gëPOC
())

852 
as£π
(
«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_RASL_N
 &&

853 
«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_RASL_R
 &&

854 
«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_RADL_N
 &&

855 
«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_RADL_R
);

860 if(
	g«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_N
 ||

861 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_R
)

863 
as£π
(
this
->
gëAssocüãdIRAPTy≥
(Ë!
NAL_UNIT_CODED_SLICE_BLA_W_RADL
 &&

864 
this
->
gëAssocüãdIRAPTy≥
(Ë!
NAL_UNIT_CODED_SLICE_BLA_N_LP
);

869 if(
	g«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_N
 ||

870 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_R
)

872 
as£π
(
this
->
gëAssocüãdIRAPTy≥
(Ë!
NAL_UNIT_CODED_SLICE_IDR_N_LP
 &&

873 
this
->
gëAssocüãdIRAPTy≥
(Ë!
NAL_UNIT_CODED_SLICE_IDR_W_RADL
);

879 if(
	g«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_N
 ||

880 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_R
)

882 
as£π
(
this
->
gëAssocüãdIRAPTy≥
(Ë!
NAL_UNIT_CODED_SLICE_BLA_N_LP
 &&

883 
this
->
gëAssocüãdIRAPTy≥
(Ë!
NAL_UNIT_CODED_SLICE_IDR_N_LP
);

887 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

888  
	gôîPic
 !
rcLi°Pic
.
íd
())

890 
ΩcPic
 = *(
ôîPic
++);

891 if(!
	gΩcPic
->
gëRec⁄M¨k
())

895 i‡(
	gΩcPic
->
gëPOC
(Ë=
this
->getPOC())

903 if(
	gΩcPic
->
gëSli˚
(0)->
gëPicOuçutFœg
(Ë=1 && !
this
->
gëNoOuçutPri‹PicsFœg
())

905 if(
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_BLA_N_LP
 ||

906 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_BLA_W_LP
 ||

907 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_BLA_W_RADL
 ||

908 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_CRA
 ||

909 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_IDR_N_LP
 ||

910 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_IDR_W_RADL
)

912 
as£π
(
ΩcPic
->
gëPOC
(Ë< 
this
->getPOC());

919 if(
	gΩcPic
->
gëSli˚
(0)->
gëPicOuçutFœg
() == 1)

921 if((
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_N
 ||

922 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_R
))

925 if(
this
->
gëAssocüãdIRAPPOC
(Ë> 
ΩcPic
->
gëSli˚
(0)->getAssociatedIRAPPOC())

928 if(
this
->
gëAssocüãdIRAPPOC
(Ë!
ΩcPic
->
gëPOC
())

930 
as£π
(
ΩcPic
->
gëPOC
(Ë< 
this
->getPOC());

938 if(
	g«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_N
 ||

939 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_R
 ||

940 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_N
 ||

941 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RADL_R
)

943 if(
ΩcPic
->
gëSli˚
(0)->
gëAssocüãdIRAPPOC
(Ë=
this
->getAssociatedIRAPPOC())

947 
as£π
(
ΩcPic
->
gëPOC
(Ë<
this
->
gëAssocüãdIRAPPOC
());

953 if(
	g«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_N
 ||

954 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_R
)

956 if((
this
->
gëAssocüãdIRAPTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP
 ||

957 
this
->
gëAssocüãdIRAPTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP
 ||

958 
this
->
gëAssocüãdIRAPTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL
 ||

959 
this
->
gëAssocüãdIRAPTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
) &&

960 
this
->
gëAssocüãdIRAPPOC
(Ë=
ΩcPic
->
gëSli˚
(0)->getAssociatedIRAPPOC())

962 if(
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RADL_N
 ||

963 
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RADL_R
)

965 
as£π
(
ΩcPic
->
gëPOC
(Ë> 
this
->getPOC());

972 if(
	g«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_N
 ||

973 
«lUnôTy≥
 =
NAL_UNIT_CODED_SLICE_RASL_R
)

975 if(
this
->
gëAssocüãdIRAPTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
)

977 if(
ΩcPic
->
gëSli˚
(0)->
gëPOC
(Ë< 
this
->
gëAssocüãdIRAPPOC
() &&

978 (
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP
 ||

979 
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP
 ||

980 
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL
 ||

981 
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP
 ||

982 
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 ||

983 
ΩcPic
->
gëSli˚
(0)->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
))

985 
as£π
(
this
->
gëPOC
(Ë> 
ΩcPic
->
gëSli˚
(0)->getPOC());

996 
Void
 
	gTComSli˚
::
≠∂yRe„ªn˚Pi˘uªSë
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pRe„ªn˚Pi˘uªSë
)

998 
TComPic
* 
	gΩcPic
;

999 
I¡
 
	gi
, 
	gisRe„ªn˚
;

1001 
checkLódögPi˘uªRe°ri˘i⁄s
(
rcLi°Pic
);

1004 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

1005  
	gôîPic
 !
rcLi°Pic
.
íd
())

1007 
ΩcPic
 = *(
ôîPic
++);

1009 if(!
	gΩcPic
->
gëSli˚
–0 )->
isRe„ªn˚d
())

1014 
	gisRe„ªn˚
 = 0;

1017 
	gi
=0;i<
	gpRe„ªn˚Pi˘uªSë
->
gëNumbîOfPosôivePi˘uªs
()+pRe„ªn˚Pi˘uªSë->
gëNumbîOfNeg©ivePi˘uªs
();i++)

1019 if(!
	gΩcPic
->
gëIsL⁄gTîm
(Ë&&ÑpcPic->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë=
this
->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
))

1021 
isRe„ªn˚
 = 1;

1022 
	gΩcPic
->
£tU£dByCuº
(
pRe„ªn˚Pi˘uªSë
->
gëU£d
(
i
));

1023 
	gΩcPic
->
£tIsL⁄gTîm
(0);

1026 ;
	gi
<
	gpRe„ªn˚Pi˘uªSë
->
gëNumbîOfPi˘uªs
();i++)

1028 if(
	gpRe„ªn˚Pi˘uªSë
->
gëCheckLTMSBPª£¡
(
i
)==
åue
)

1030 if(
ΩcPic
->
gëIsL⁄gTîm
(Ë&& (ΩcPic->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
()Ë=
pRe„ªn˚Pi˘uªSë
->gëPOC(
i
))

1032 
isRe„ªn˚
 = 1;

1033 
	gΩcPic
->
£tU£dByCuº
(
pRe„ªn˚Pi˘uªSë
->
gëU£d
(
i
));

1038 
I¡
 
	gpocCy˛e
 = 1<<
ΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëSPS
()->
gëBôsF‹POC
();

1039 
I¡
 
	gcurPoc
 = 
ΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë& (
pocCy˛e
-1);

1040 
I¡
 
	gªfPoc
 = 
pRe„ªn˚Pi˘uªSë
->
gëPOC
(
i
Ë& (
pocCy˛e
-1);

1041 if(
	gΩcPic
->
gëIsL⁄gTîm
(Ë&& 
	gcurPoc
 =
ªfPoc
)

1043 
isRe„ªn˚
 = 1;

1044 
	gΩcPic
->
£tU£dByCuº
(
pRe„ªn˚Pi˘uªSë
->
gëU£d
(
i
));

1051 if(
	gΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë!
this
->gëPOC(Ë&& 
isRe„ªn˚
 == 0)

1053 
ΩcPic
->
gëSli˚
–0 )->
£tRe„ªn˚d
–
Ál£
 );

1054 
	gΩcPic
->
£tU£dByCuº
(0);

1055 
	gΩcPic
->
£tIsL⁄gTîm
(0);

1058 
as£π
(
ΩcPic
->
gëSli˚
–0 )->
isRe„ªn˚d
()==0||ΩcPic->
gëU£dByCuº
()==0||ΩcPic->
gëTLayî
()<=
this
->getTLayer());

1060 if(
	gthis
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_TSA_R
 || 
this
->gëNÆUnôTy≥(Ë=
NAL_UNIT_CODED_SLICE_TSA_N
)

1062 
as£π
(
ΩcPic
->
gëSli˚
–0 )->
isRe„ªn˚d
()==0||ΩcPic->
gëTLayî
()<
this
->getTLayer());

1065 if(
	gΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë!
this
->gëPOC(Ë&& 
ΩcPic
->
gëTLayî
()==this->getTLayer())

1067 
as£π
(
ΩcPic
->
gëSli˚
–0 )->
isRe„ªn˚d
()==0||ΩcPic->
gëU£dByCuº
()==0||ΩcPic->gëSli˚–0 )->
gëTemp‹ÆLayîN⁄Re„ªn˚Fœg
()==
Ál£
);

1074 
I¡
 
	gTComSli˚
::
checkTh©AŒRefPicsAªAvaûabÀ
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pRe„ªn˚Pi˘uªSë
, 
Boﬁ
 
¥ötEº‹s
, I¡ 
pocR™domAc˚ss
, Boﬁ 
bU£RecovîyPoöt
)

1076 
I¡
 
	g©Ló°O√U«bÀdByRecovîyPoöt
 = 0;

1077 
I¡
 
	g©Ló°O√FlushedByPªviousIDR
 = 0;

1078 
TComPic
* 
	gΩcPic
;

1079 
I¡
 
	gi
, 
	gisAvaûabÀ
;

1080 
I¡
 
	g©Ló°O√Lo°
 = 0;

1081 
I¡
 
	g©Ló°O√Removed
 = 0;

1082 
I¡
 
	giPocLo°
 = 0;

1086 
	gi
=
pRe„ªn˚Pi˘uªSë
->
gëNumbîOfNeg©ivePi˘uªs
()+pRe„ªn˚Pi˘uªSë->
gëNumbîOfPosôivePi˘uªs
();i<
	gpRe„ªn˚Pi˘uªSë
->
gëNumbîOfPi˘uªs
();i++)

1088 
	gisAvaûabÀ
 = 0;

1090 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

1091  
	gôîPic
 !
rcLi°Pic
.
íd
())

1093 
ΩcPic
 = *(
ôîPic
++);

1094 if(
	gpRe„ªn˚Pi˘uªSë
->
gëCheckLTMSBPª£¡
(
i
)==
åue
)

1096 if(
ΩcPic
->
gëIsL⁄gTîm
(Ë&& (ΩcPic->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
()Ë=
pRe„ªn˚Pi˘uªSë
->gëPOC(
i
Ë&&ÑpcPic->gëSli˚(0)->
isRe„ªn˚d
())

1098 if(
bU£RecovîyPoöt
 && 
this
->
gëPOC
(Ë> 
pocR™domAc˚ss
 &&Åhis->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
) <ÖocRandomAccess)

1100 
isAvaûabÀ
 = 0;

1104 
	gisAvaûabÀ
 = 1;

1110 
I¡
 
	gpocCy˛e
 = 1<<
ΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëSPS
()->
gëBôsF‹POC
();

1111 
I¡
 
	gcurPoc
 = 
ΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë& (
pocCy˛e
-1);

1112 
I¡
 
	gªfPoc
 = 
pRe„ªn˚Pi˘uªSë
->
gëPOC
(
i
Ë& (
pocCy˛e
-1);

1113 if(
	gΩcPic
->
gëIsL⁄gTîm
(Ë&& 
	gcurPoc
 =
ªfPoc
 && 
ΩcPic
->
gëSli˚
(0)->
isRe„ªn˚d
())

1115 if(
bU£RecovîyPoöt
 && 
this
->
gëPOC
(Ë> 
pocR™domAc˚ss
 &&Åhis->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
) <ÖocRandomAccess)

1117 
isAvaûabÀ
 = 0;

1121 
	gisAvaûabÀ
 = 1;

1127 if(!
	gisAvaûabÀ
)

1129 
	gôîPic
 = 
rcLi°Pic
.
begö
();

1130  
	gôîPic
 !
rcLi°Pic
.
íd
())

1132 
ΩcPic
 = *(
ôîPic
++);

1134 
I¡
 
	gpocCy˛e
 = 1 << 
ΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëSPS
()->
gëBôsF‹POC
();

1135 
I¡
 
	gcurPoc
 = 
ΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
();

1136 
I¡
 
	gªfPoc
 = 
pRe„ªn˚Pi˘uªSë
->
gëPOC
(
i
);

1137 i‡(!
	gpRe„ªn˚Pi˘uªSë
->
gëCheckLTMSBPª£¡
(
i
))

1139 
	gcurPoc
 = 
curPoc
 & (
pocCy˛e
 - 1);

1140 
	gªfPoc
 = 
ªfPoc
 & (
pocCy˛e
 - 1);

1143 i‡(
	gΩcPic
->
gëSli˚
(0)->
isRe„ªn˚d
(Ë&& 
	gcurPoc
 =
ªfPoc
)

1145 if(
bU£RecovîyPoöt
 && 
this
->
gëPOC
(Ë> 
pocR™domAc˚ss
 &&Åhis->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
) <ÖocRandomAccess)

1147 
isAvaûabÀ
 = 0;

1151 
	gisAvaûabÀ
 = 1;

1152 
	gΩcPic
->
£tIsL⁄gTîm
(1);

1160 if(
	gisAvaûabÀ
 == 0)

1162 i‡(
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
Ë>
pocR™domAc˚ss
)

1164 if(!
pRe„ªn˚Pi˘uªSë
->
gëU£d
(
i
) )

1166 if(
¥ötEº‹s
)

1168 
¥ötf
("\nL⁄g-ãrmÑe„ªn˚Öi˘uª wôh POC = %3d sìm†tÿhavêbì¿ªmoved o∏nŸ c‹ª˘ly decoded.", 
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
));

1170 
	g©Ló°O√Removed
 = 1;

1174 if(
	g¥ötEº‹s
)

1176 
¥ötf
("\nL⁄g-ãrmÑe„ªn˚Öi˘uª wôh POC = %3d i†lo° o∏nŸ c‹ª˘ly decoded!", 
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
));

1178 
	g©Ló°O√Lo°
 = 1;

1179 
	giPocLo°
=
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
);

1182 if(
	gbU£RecovîyPoöt
 && 
	gthis
->
gëPOC
(Ë> 
	gpocR™domAc˚ss
)

1184 
	g©Ló°O√U«bÀdByRecovîyPoöt
 = 1;

1186 if(
	gbU£RecovîyPoöt
 && (
	gthis
->
gëAssocüãdIRAPTy≥
()==
NAL_UNIT_CODED_SLICE_IDR_N_LP
 || 
this
->gëAssocüãdIRAPTy≥()==
NAL_UNIT_CODED_SLICE_IDR_W_RADL
))

1188 
©Ló°O√FlushedByPªviousIDR
 = 1;

1194 
	gi
=0;i<
	gpRe„ªn˚Pi˘uªSë
->
gëNumbîOfNeg©ivePi˘uªs
()+pRe„ªn˚Pi˘uªSë->
gëNumbîOfPosôivePi˘uªs
();i++)

1196 
	gisAvaûabÀ
 = 0;

1198 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

1199  
	gôîPic
 !
rcLi°Pic
.
íd
())

1201 
ΩcPic
 = *(
ôîPic
++);

1203 if(!
	gΩcPic
->
gëIsL⁄gTîm
(Ë&&ÑpcPic->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë=
this
->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
Ë&& 
ΩcPic
->gëSli˚(0)->
isRe„ªn˚d
())

1205 if(
bU£RecovîyPoöt
 && 
this
->
gëPOC
(Ë> 
pocR™domAc˚ss
 &&Åhis->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
) <ÖocRandomAccess)

1207 
isAvaûabÀ
 = 0;

1211 
	gisAvaûabÀ
 = 1;

1217 if(
	gisAvaûabÀ
 == 0)

1219 i‡(
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
Ë>
pocR™domAc˚ss
)

1221 if(!
pRe„ªn˚Pi˘uªSë
->
gëU£d
(
i
) )

1223 if(
¥ötEº‹s
)

1225 
¥ötf
("\nSh‹t-ãrmÑe„ªn˚Öi˘uª wôh POC = %3d sìm†tÿhavêbì¿ªmoved o∏nŸ c‹ª˘ly decoded.", 
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
));

1227 
	g©Ló°O√Removed
 = 1;

1231 if(
	g¥ötEº‹s
)

1233 
¥ötf
("\nSh‹t-ãrmÑe„ªn˚Öi˘uª wôh POC = %3d i†lo° o∏nŸ c‹ª˘ly decoded!", 
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
));

1235 
	g©Ló°O√Lo°
 = 1;

1236 
	giPocLo°
=
this
->
gëPOC
(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
);

1239 if(
	gbU£RecovîyPoöt
 && 
	gthis
->
gëPOC
(Ë> 
	gpocR™domAc˚ss
)

1241 
	g©Ló°O√U«bÀdByRecovîyPoöt
 = 1;

1243 if(
	gbU£RecovîyPoöt
 && (
	gthis
->
gëAssocüãdIRAPTy≥
()==
NAL_UNIT_CODED_SLICE_IDR_N_LP
 || 
this
->gëAssocüãdIRAPTy≥()==
NAL_UNIT_CODED_SLICE_IDR_W_RADL
))

1245 
©Ló°O√FlushedByPªviousIDR
 = 1;

1250 if(
	g©Ló°O√U«bÀdByRecovîyPoöt
 || 
	g©Ló°O√FlushedByPªviousIDR
)

1254 if(
	g©Ló°O√Lo°
)

1256  
	giPocLo°
+1;

1258 if(
	g©Ló°O√Removed
)

1270 
Void
 
	gTComSli˚
::
¸óãEx∂icôRe„ªn˚Pi˘uªSëFromRe„ªn˚
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pRe„ªn˚Pi˘uªSë
, 
Boﬁ
 
isRAP
, 
I¡
 
pocR™domAc˚ss
, Boﬁ 
bU£RecovîyPoöt
, c⁄° Boﬁ 
bEfficõ¡FõldIRAPE«bÀd
)

1272 
TComPic
* 
	gΩcPic
;

1273 
I¡
 
	gi
, 
	gj
;

1274 
I¡
 
	gk
 = 0;

1275 
I¡
 
	gƒOfNeg©ivePi˘uªs
 = 0;

1276 
I¡
 
	gƒOfPosôivePi˘uªs
 = 0;

1277 
TComRe„ªn˚Pi˘uªSë
* 
	gpLoˇlRPS
 = 
this
->
gëLoˇlRPS
();

1278 (*
	gpLoˇlRPS
)=
TComRe„ªn˚Pi˘uªSë
();

1280 
Boﬁ
 
	gú≠IsInRPS
 = 
Ál£
;

1283 
	gi
=0;i<
	gpRe„ªn˚Pi˘uªSë
->
gëNumbîOfPi˘uªs
();i++)

1285 
	gj
 = 0;

1287 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

1288  
	gôîPic
 !
rcLi°Pic
.
íd
())

1290 
j
++;

1291 
	gΩcPic
 = *(
ôîPic
++);

1293 if(
	gΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë=
this
->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
Ë&& 
ΩcPic
->gëSli˚(0)->
isRe„ªn˚d
())

1297 
pLoˇlRPS
->
£tDñèPOC
(
k
, 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
));

1298 
	gpLoˇlRPS
->
£tU£d
(
k
, 
pRe„ªn˚Pi˘uªSë
->
gëU£d
(
i
Ë&& (!
isRAP
));

1299 i‡(
	gbEfficõ¡FõldIRAPE«bÀd
)

1301 
	gpLoˇlRPS
->
£tU£d
(
k
, 
pLoˇlRPS
->
gëU£d
(kË&& !(
bU£RecovîyPoöt
 && 
this
->
gëPOC
(Ë> 
pocR™domAc˚ss
 &&Åhis->gëPOC(Ë+ 
pRe„ªn˚Pi˘uªSë
->
gëDñèPOC
(
i
) <ÖocRandomAccess) );

1304 if(
	gpLoˇlRPS
->
gëDñèPOC
(
k
) < 0)

1306 
	gƒOfNeg©ivePi˘uªs
++;

1310 if(
	gbEfficõ¡FõldIRAPE«bÀd
 && 
	gΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë=
this
->
gëAssocüãdIRAPPOC
() &&Åhis->getAssociatedIRAPPOC() ==Åhis->getPOC()+1)

1312 
ú≠IsInRPS
 = 
åue
;

1314 
	gƒOfPosôivePi˘uªs
++;

1316 
	gk
++;

1321 
Boﬁ
 
	gu£NewRPS
 = 
Ál£
;

1323 if(
	gbEfficõ¡FõldIRAPE«bÀd
 && 
	gm_pcPic
->
isFõld
(Ë&& !
	gú≠IsInRPS
)

1325 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

1326  
	gôîPic
 !
rcLi°Pic
.
íd
())

1328 
ΩcPic
 = *(
ôîPic
++);

1329 if(
	gΩcPic
->
gëPicSym
()->
gëSli˚
(0)->
gëPOC
(Ë=
this
->
gëAssocüãdIRAPPOC
() &&Åhis->getAssociatedIRAPPOC() ==Åhis->getPOC()+1)

1331 
pLoˇlRPS
->
£tDñèPOC
(
k
, 1);

1332 
	gpLoˇlRPS
->
£tU£d
(
k
, 
åue
);

1333 
	gƒOfPosôivePi˘uªs
++;

1334 
	gk
 ++;

1335 
	gu£NewRPS
 = 
åue
;

1339 
	gpLoˇlRPS
->
£tNumbîOfNeg©ivePi˘uªs
(
ƒOfNeg©ivePi˘uªs
);

1340 
	gpLoˇlRPS
->
£tNumbîOfPosôivePi˘uªs
(
ƒOfPosôivePi˘uªs
);

1341 
	gpLoˇlRPS
->
£tNumbîOfPi˘uªs
(
ƒOfNeg©ivePi˘uªs
+
ƒOfPosôivePi˘uªs
);

1345 i‡(!
	gpRe„ªn˚Pi˘uªSë
->
gëI¡îRPSPªdi˘i⁄
(Ë|| 
	gu£NewRPS
 )

1347 
	gpLoˇlRPS
->
£tI¡îRPSPªdi˘i⁄
(
Ál£
);

1348 
	gpLoˇlRPS
->
£tNumRefIdc
(0);

1352 
I¡
 
	grIdx
 = 
this
->
gëRPSidx
(Ë- 
pRe„ªn˚Pi˘uªSë
->
gëDñèRIdxMöus1
() - 1;

1353 
I¡
 
	gdñèRPS
 = 
pRe„ªn˚Pi˘uªSë
->
gëDñèRPS
();

1354 c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
	gpcRefRPS
 = 
this
->
gëSPS
()->
gëRPSLi°
()->
gëRe„ªn˚Pi˘uªSë
(
rIdx
);

1355 
I¡
 
	giRefPics
 = 
pcRefRPS
->
gëNumbîOfPi˘uªs
();

1356 
I¡
 
	giNewIdc
=0;

1357 
	gi
=0; i<
iRefPics
; i++)

1359 
I¡
 
	gdñèPOC
 = ((
i
 !
iRefPics
)? 
pcRefRPS
->
gëDñèPOC
(i) : 0);

1360 
I¡
 
	giRefIdc
 = 0;

1361 
	gj
=0; j < 
	gpLoˇlRPS
->
gëNumbîOfPi˘uªs
(); j++)

1363 i‡–(
	gdñèPOC
 + 
	gdñèRPS
Ë=
pLoˇlRPS
->
gëDñèPOC
(
j
))

1365 i‡(
pLoˇlRPS
->
gëU£d
(
j
))

1367 
iRefIdc
 = 1;

1371 
	giRefIdc
 = 2;

1375 
	gpLoˇlRPS
->
£tRefIdc
(
i
, 
iRefIdc
);

1376 
	giNewIdc
++;

1378 
	gpLoˇlRPS
->
£tI¡îRPSPªdi˘i⁄
(
åue
);

1379 
	gpLoˇlRPS
->
£tNumRefIdc
(
iNewIdc
);

1380 
	gpLoˇlRPS
->
£tDñèRPS
(
dñèRPS
);

1381 
	gpLoˇlRPS
->
£tDñèRIdxMöus1
(
pRe„ªn˚Pi˘uªSë
->
gëDñèRIdxMöus1
(Ë+ 
this
->
gëSPS
()->
gëRPSLi°
()->
gëNumbîOfRe„ªn˚Pi˘uªSës
(Ë-Åhis->
gëRPSidx
());

1384 
	gthis
->
£tRPS
(
pLoˇlRPS
);

1385 
	gthis
->
£tRPSidx
(-1);

1389 
Void
 
	gTComSli˚
::
	$gëWpAcDcP¨am
(
WPACDCP¨am
 *&
wp
)

1391 
wp
 = 
m_weightACDCP¨am
;

1392 
	}
}

1395 
Void
 
	gTComSli˚
::
	$öôWpAcDcP¨am
()

1397 
I¡
 
iComp
 = 0; iCom∞< 
MAX_NUM_COMPONENT
; iComp++ )

1399 
m_weightACDCP¨am
[
iComp
].
iAC
 = 0;

1400 
m_weightACDCP¨am
[
iComp
].
iDC
 = 0;

1402 
	}
}

1405 
Void
 
	gTComSli˚
::
	$gëWpSˇlög
–
RefPicLi°
 
e
, 
I¡
 
iRefIdx
, 
WPSˇlögP¨am
 *&
wp
 )

1407 
	`as£π
 (
e
<
NUM_REF_PIC_LIST_01
);

1408 
wp
 = 
m_weightPªdTabÀ
[
e
][
iRefIdx
];

1409 
	}
}

1412 
Void
 
	gTComSli˚
::
	$ª£tWpSˇlög
()

1414  
I¡
 
e
=0 ;É<
NUM_REF_PIC_LIST_01
 ;É++ )

1416  
I¡
 
i
=0 ; i<
MAX_NUM_REF
 ; i++ )

1418  
I¡
 
yuv
=0 ; yuv<
MAX_NUM_COMPONENT
 ; yuv++ )

1420 
WPSˇlögP¨am
 *
pwp
 = &(
m_weightPªdTabÀ
[
e
][
i
][
yuv
]);

1421 
pwp
->
bPª£¡Fœg
 = 
Ál£
;

1422 
pwp
->
uiLog2WeightDíom
 = 0;

1423 
pwp
->
uiLog2WeightDíom
 = 0;

1424 
pwp
->
iWeight
 = 1;

1425 
pwp
->
iOff£t
 = 0;

1429 
	}
}

1432 
Void
 
	gTComSli˚
::
	$öôWpSˇlög
(c⁄° 
TComSPS
 *
•s
)

1434 c⁄° 
Boﬁ
 
bU£HighPªcisi⁄Pªdi˘i⁄Weightög
 = 
•s
->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
();

1435  
I¡
 
e
=0 ;É<
NUM_REF_PIC_LIST_01
 ;É++ )

1437  
I¡
 
i
=0 ; i<
MAX_NUM_REF
 ; i++ )

1439  
I¡
 
yuv
=0 ; yuv<
MAX_NUM_COMPONENT
 ; yuv++ )

1441 
WPSˇlögP¨am
 *
pwp
 = &(
m_weightPªdTabÀ
[
e
][
i
][
yuv
]);

1442 i‡–!
pwp
->
bPª£¡Fœg
 )

1445 
pwp
->
iWeight
 = (1 <<Öwp->
uiLog2WeightDíom
);

1446 
pwp
->
iOff£t
 = 0;

1449 c⁄° 
I¡
 
off£tSˇlögFa˘‹
 = 
bU£HighPªcisi⁄Pªdi˘i⁄Weightög
 ? 1 : (1 << (
•s
->
	`gëBôDïth
(
	`toCh™√lTy≥
(
	`Comp⁄ítID
(
yuv
)))-8));

1451 
pwp
->
w
 =Öwp->
iWeight
;

1452 
pwp
->
o
 =Öwp->
iOff£t
 * 
off£tSˇlögFa˘‹
;

1453 
pwp
->
shi·
 =Öwp->
uiLog2WeightDíom
;

1454 
pwp
->
round
 = (pwp->
uiLog2WeightDíom
>=1) ? (1 << (pwp->uiLog2WeightDenom-1)) : (0);

1458 
	}
}

1463 
	gTComVPS
::
	$TComVPS
()

1464 : 
	`m_VPSId
 ( 0)

1465 , 
	`m_uiMaxTLayîs
 ( 1)

1466 , 
	`m_uiMaxLayîs
 ( 1)

1467 , 
	`m_bTemp‹ÆIdNe°ögFœg
 (
Ál£
)

1468 , 
	`m_numHrdP¨amëîs
 ( 0)

1469 , 
	`m_maxNuhRe£rvedZîoLayîId
 ( 0)

1470 , 
	`m_hrdP¨amëîs
 ()

1471 , 
	`m_hrdOpSëIdx
 ()

1472 , 
	$m_˝rmsPª£¡Fœg
 ()

1475  
I¡
 
i
 = 0; i < 
MAX_TLAYER
; i++)

1477 
m_numRe‹dîPics
[
i
] = 0;

1478 
m_uiMaxDecPicBuf„rög
[
i
] = 1;

1479 
m_uiMaxL©ícyIn¸ó£
[
i
] = 0;

1481 
	}
}

1483 
	gTComVPS
::~
	$TComVPS
()

1485 
	}
}

1491 
TComSPSRExt
::
	$TComSPSRExt
()

1492 : 
	`m_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
 (
Ál£
)

1493 , 
	`m_å™sf‹mSkùC⁄ãxtE«bÀdFœg
 (
Ál£
)

1495 , 
	`m_exãndedPªcisi⁄Pro˚ssögFœg
 (
Ál£
)

1496 , 
	`m_öåaSmoŸhögDißbÀdFœg
 (
Ál£
)

1497 , 
	`m_highPªcisi⁄Off£tsE«bÀdFœg
 (
Ál£
)

1498 , 
	`m_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
(
Ál£
)

1499 , 
	$m_ˇbacBy∑ssAlignmítE«bÀdFœg
 (
Ál£
)

1501 
UI¡
 
sig«ŒögModeIndex
 = 0; sig«ŒögModeIndex < 
NUMBER_OF_RDPCM_SIGNALLING_MODES
; signallingModeIndex++)

1503 
m_rdpcmE«bÀdFœg
[
sig«ŒögModeIndex
] = 
Ál£
;

1505 
	}
}

1507 
	gTComSPS
::
	$TComSPS
()

1508 : 
	`m_SPSId
 ( 0)

1509 , 
	`m_VPSId
 ( 0)

1510 , 
	`m_chromaF‹m©Idc
 (
CHROMA_420
)

1511 , 
	`m_uiMaxTLayîs
 ( 1)

1513 , 
	`m_picWidthInLumaSam∂es
 (352)

1514 , 
	`m_picHeightInLumaSam∂es
 (288)

1515 , 
	`m_log2MöCodögBlockSize
 ( 0)

1516 , 
	`m_log2DiffMaxMöCodögBlockSize
(0)

1517 , 
	`m_uiMaxCUWidth
 ( 32)

1518 , 
	`m_uiMaxCUHeight
 ( 32)

1519 , 
	`m_uiMaxTŸÆCUDïth
 ( 3)

1520 , 
	`m_bL⁄gTîmRefsPª£¡
 (
Ál£
)

1521 , 
	`m_uiQuadåìTULog2MaxSize
 ( 0)

1522 , 
	`m_uiQuadåìTULog2MöSize
 ( 0)

1523 , 
	`m_uiQuadåìTUMaxDïthI¡î
 ( 0)

1524 , 
	`m_uiQuadåìTUMaxDïthI¡ø
 ( 0)

1526 , 
	`m_u£PCM
 (
Ál£
)

1527 , 
	`m_pcmLog2MaxSize
 ( 5)

1528 , 
	`m_uiPCMLog2MöSize
 ( 7)

1529 , 
	`m_bPCMFûãrDißbÀFœg
 (
Ál£
)

1530 , 
	`m_uiBôsF‹POC
 ( 8)

1531 , 
	`m_numL⁄gTîmRefPicSPS
 ( 0)

1532 , 
	`m_uiMaxTrSize
 ( 32)

1533 , 
	`m_bU£SAO
 (
Ál£
)

1534 , 
	`m_bTemp‹ÆIdNe°ögFœg
 (
Ál£
)

1535 , 
	`m_sˇlögLi°E«bÀdFœg
 (
Ál£
)

1536 , 
	`m_u£Så⁄gI¡øSmoŸhög
 (
Ál£
)

1537 , 
	`m_vuiP¨amëîsPª£¡Fœg
 (
Ál£
)

1538 , 
	$m_vuiP¨amëîs
 ()

1540 
I¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

1542 
m_bôDïths
.
ªc⁄
[
ch
] = 8;

1543 #i‡
O0043_BEST_EFFORT_DECODING


1544 
m_bôDïths
.
°ªam
[
ch
] = 8;

1546 
m_pcmBôDïths
[
ch
] = 8;

1547 
m_qpBDOff£t
 [
ch
] = 0;

1550  
I¡
 
i
 = 0; i < 
MAX_TLAYER
; i++ )

1552 
m_uiMaxL©ícyIn¸ó£Plus1
[
i
] = 0;

1553 
m_uiMaxDecPicBuf„rög
[
i
] = 1;

1554 
m_numRe‹dîPics
[
i
] = 0;

1557 ::
	`mem£t
(
m_…RefPicPocLsbSps
, 0, (m_ltRefPicPocLsbSps));

1558 ::
	`mem£t
(
m_u£dByCuºPicLtSPSFœg
, 0, (m_usedByCurrPicLtSPSFlag));

1559 
	}
}

1561 
	gTComSPS
::~
	$TComSPS
()

1563 
m_RPSLi°
.
	`de°roy
();

1564 
	}
}

1566 
Void
 
	gTComSPS
::
	$¸óãRPSLi°
–
I¡
 
numRPS
 )

1568 
m_RPSLi°
.
	`de°roy
();

1569 
m_RPSLi°
.
	`¸óã
(
numRPS
);

1570 
	}
}

1573 c⁄° 
I¡
 
	gTComSPS
::
m_wöUnôX
[]={1,2,2,1};

1574 c⁄° 
I¡
 
	gTComSPS
::
m_wöUnôY
[]={1,2,1,1};

1576 
	gTComPPSRExt
::
	$TComPPSRExt
()

1577 : 
	`m_log2MaxTønsf‹mSkùBlockSize
 (2)

1578 , 
	`m_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
(
Ál£
)

1579 , 
	`m_diffCuChromaQpOff£tDïth
 (0)

1580 , 
	$m_chromaQpOff£tLi°Lí
 (0)

1584 
m_ChromaQpAdjTabÀIn˛udögNuŒE¡ry
[0].
u
.
comp
.
CbOff£t
 = 0;

1585 
m_ChromaQpAdjTabÀIn˛udögNuŒE¡ry
[0].
u
.
comp
.
CrOff£t
 = 0;

1586 
I¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

1588 
m_log2SaoOff£tSˇÀ
[
ch
] = 0;

1590 
	}
}

1592 
	gTComPPS
::
	$TComPPS
()

1593 : 
	`m_PPSId
 (0)

1594 , 
	`m_SPSId
 (0)

1595 , 
	`m_picInôQPMöus26
 (0)

1596 , 
	`m_u£DQP
 (
Ál£
)

1597 , 
	`m_bC⁄°øöedI¡øPªd
 (
Ál£
)

1598 , 
	`m_bSli˚ChromaQpFœg
 (
Ál£
)

1599 , 
	`m_uiMaxCuDQPDïth
 (0)

1600 , 
	`m_chromaCbQpOff£t
 (0)

1601 , 
	`m_chromaCrQpOff£t
 (0)

1602 , 
	`m_numRefIdxL0DeÁu…A˘ive
 (1)

1603 , 
	`m_numRefIdxL1DeÁu…A˘ive
 (1)

1604 , 
	`m_Tønsqu™tBy∑ssE«bÀdFœg
 (
Ál£
)

1605 , 
	`m_u£Tønsf‹mSkù
 (
Ál£
)

1606 , 
	`m_dïídítSli˚SegmítsE«bÀdFœg
(
Ál£
)

1607 , 
	`m_tûesE«bÀdFœg
 (
Ál£
)

1608 , 
	`m_íå›yCodögSyncE«bÀdFœg
 (
Ál£
)

1609 , 
	`m_lo›FûãrA¸ossTûesE«bÀdFœg
 (
åue
)

1610 , 
	`m_unif‹mS∑cögFœg
 (
Ál£
)

1611 , 
	`m_numTûeCﬁumnsMöus1
 (0)

1612 , 
	`m_numTûeRowsMöus1
 (0)

1613 , 
	`m_signD©aHidögE«bÀdFœg
 (
Ál£
)

1614 , 
	`m_ˇbacInôPª£¡Fœg
 (
Ál£
)

1615 , 
	`m_¶i˚HódîExãnsi⁄Pª£¡Fœg
 (
Ál£
)

1616 , 
	`m_lo›FûãrA¸ossSli˚sE«bÀdFœg
(
Ál£
)

1617 , 
	`m_li°sModifiˇti⁄Pª£¡Fœg
 (0)

1618 , 
	$m_numExåaSli˚HódîBôs
 (0)

1620 
	}
}

1622 
	gTComPPS
::~
	$TComPPS
()

1624 
	}
}

1626 
TComRe„ªn˚Pi˘uªSë
::
	$TComRe„ªn˚Pi˘uªSë
()

1627 : 
	`m_numbîOfPi˘uªs
 (0)

1628 , 
	`m_numbîOfNeg©ivePi˘uªs
 (0)

1629 , 
	`m_numbîOfPosôivePi˘uªs
 (0)

1630 , 
	`m_numbîOfL⁄gãrmPi˘uªs
 (0)

1631 , 
	`m_öãrRPSPªdi˘i⁄
 (0)

1632 , 
	`m_dñèRIdxMöus1
 (0)

1633 , 
	`m_dñèRPS
 (0)

1634 , 
	$m_numRefIdc
 (0)

1636 ::
	`mem£t
–
m_dñèPOC
, 0, (m_deltaPOC) );

1637 ::
	`mem£t
–
m_POC
, 0, (m_POC) );

1638 ::
	`mem£t
–
m_u£d
, 0, (m_used) );

1639 ::
	`mem£t
–
m_ªfIdc
, 0, (m_refIdc) );

1640 ::
	`mem£t
–
m_bCheckLTMSB
, 0, (m_bCheckLTMSB) );

1641 ::
	`mem£t
–
m_pocLSBLT
, 0, (m_pocLSBLT) );

1642 ::
	`mem£t
–
m_dñèPOCMSBCy˛eLT
, 0, (m_deltaPOCMSBCycleLT) );

1643 ::
	`mem£t
–
m_dñèPocMSBPª£¡Fœg
, 0, (m_deltaPocMSBPresentFlag) );

1644 
	}
}

1646 
	gTComRe„ªn˚Pi˘uªSë
::~
	$TComRe„ªn˚Pi˘uªSë
()

1648 
	}
}

1650 
Void
 
TComRe„ªn˚Pi˘uªSë
::
	$£tU£d
(
I¡
 
buf„rNum
, 
Boﬁ
 
u£d
)

1652 
m_u£d
[
buf„rNum
] = 
u£d
;

1653 
	}
}

1655 
Void
 
	gTComRe„ªn˚Pi˘uªSë
::
	$£tDñèPOC
(
I¡
 
buf„rNum
, I¡ 
dñèPOC
)

1657 
m_dñèPOC
[
buf„rNum
] = 
dñèPOC
;

1658 
	}
}

1660 
Void
 
	gTComRe„ªn˚Pi˘uªSë
::
	$£tNumbîOfPi˘uªs
(
I¡
 
numbîOfPi˘uªs
)

1662 
m_numbîOfPi˘uªs
 = 
numbîOfPi˘uªs
;

1663 
	}
}

1665 
I¡
 
	gTComRe„ªn˚Pi˘uªSë
::
	$gëU£d
(
I¡
 
buf„rNum
) const

1667  
m_u£d
[
buf„rNum
];

1668 
	}
}

1670 
I¡
 
	gTComRe„ªn˚Pi˘uªSë
::
	$gëDñèPOC
(
I¡
 
buf„rNum
) const

1672  
m_dñèPOC
[
buf„rNum
];

1673 
	}
}

1675 
I¡
 
	gTComRe„ªn˚Pi˘uªSë
::
	$gëNumbîOfPi˘uªs
() const

1677  
m_numbîOfPi˘uªs
;

1678 
	}
}

1680 
I¡
 
	gTComRe„ªn˚Pi˘uªSë
::
	$gëPOC
(
I¡
 
buf„rNum
) const

1682  
m_POC
[
buf„rNum
];

1683 
	}
}

1685 
Void
 
	gTComRe„ªn˚Pi˘uªSë
::
	$£tPOC
(
I¡
 
buf„rNum
, I¡ 
POC
)

1687 
m_POC
[
buf„rNum
] = 
POC
;

1688 
	}
}

1690 
Boﬁ
 
	gTComRe„ªn˚Pi˘uªSë
::
	$gëCheckLTMSBPª£¡
(
I¡
 
buf„rNum
) const

1692  
m_bCheckLTMSB
[
buf„rNum
];

1693 
	}
}

1695 
Void
 
	gTComRe„ªn˚Pi˘uªSë
::
	$£tCheckLTMSBPª£¡
(
I¡
 
buf„rNum
, 
Boﬁ
 
b
)

1697 
m_bCheckLTMSB
[
buf„rNum
] = 
b
;

1698 
	}
}

1701 
Void
 
	gTComRe„ªn˚Pi˘uªSë
::
	$£tRefIdc
(
I¡
 
buf„rNum
, I¡ 
ªfIdc
)

1703 
m_ªfIdc
[
buf„rNum
] = 
ªfIdc
;

1704 
	}
}

1707 
I¡
 
	gTComRe„ªn˚Pi˘uªSë
::
	$gëRefIdc
(
I¡
 
buf„rNum
) const

1709  
m_ªfIdc
[
buf„rNum
];

1710 
	}
}

1717 
Void
 
	gTComRe„ªn˚Pi˘uªSë
::
	$s‹tDñèPOC
()

1720 
I¡
 
j
=1; j < 
	`gëNumbîOfPi˘uªs
(); j++)

1722 
I¡
 
dñèPOC
 = 
	`gëDñèPOC
(
j
);

1723 
Boﬁ
 
u£d
 = 
	`gëU£d
(
j
);

1724 
I¡
 
k
=
j
-1; k >= 0; k--)

1726 
I¡
 
ãmp
 = 
	`gëDñèPOC
(
k
);

1727 i‡(
dñèPOC
 < 
ãmp
)

1729 
	`£tDñèPOC
(
k
+1, 
ãmp
);

1730 
	`£tU£d
(
k
+1, 
	`gëU£d
(k));

1731 
	`£tDñèPOC
(
k
, 
dñèPOC
);

1732 
	`£tU£d
(
k
, 
u£d
);

1737 
I¡
 
numNegPics
 = 
	`gëNumbîOfNeg©ivePi˘uªs
();

1738 
I¡
 
j
=0, 
k
=
numNegPics
-1; j <ÇumNegPics>>1; j++, k--)

1740 
I¡
 
dñèPOC
 = 
	`gëDñèPOC
(
j
);

1741 
Boﬁ
 
u£d
 = 
	`gëU£d
(
j
);

1742 
	`£tDñèPOC
(
j
, 
	`gëDñèPOC
(
k
));

1743 
	`£tU£d
(
j
, 
	`gëU£d
(
k
));

1744 
	`£tDñèPOC
(
k
, 
dñèPOC
);

1745 
	`£tU£d
(
k
, 
u£d
);

1747 
	}
}

1753 
Void
 
	gTComRe„ªn˚Pi˘uªSë
::
	$¥ötDñèPOC
() const

1755 
	`¥ötf
("DeltaPOC = { ");

1756 
I¡
 
j
=0; j < 
	`gëNumbîOfPi˘uªs
(); j++)

1758 
	`¥ötf
("%d%†", 
	`gëDñèPOC
(
j
), (
	`gëU£d
(j)==1)?"*":"");

1760 i‡(
	`gëI¡îRPSPªdi˘i⁄
())

1762 
	`¥ötf
("}, RefIdc = { ");

1763 
I¡
 
j
=0; j < 
	`gëNumRefIdc
(); j++)

1765 
	`¥ötf
("%d ", 
	`gëRefIdc
(
j
));

1768 
	`¥ötf
("}\n");

1769 
	}
}

1771 
	gTComRefPicLi°Modifiˇti⁄
::
	$TComRefPicLi°Modifiˇti⁄
()

1772 : 
	`m_ªfPicLi°Modifiˇti⁄FœgL0
 (
Ál£
)

1773 , 
	$m_ªfPicLi°Modifiˇti⁄FœgL1
 (
Ál£
)

1775 ::
	`mem£t
–
m_RefPicSëIdxL0
, 0, (m_RefPicSetIdxL0) );

1776 ::
	`mem£t
–
m_RefPicSëIdxL1
, 0, (m_RefPicSetIdxL1) );

1777 
	}
}

1779 
	gTComRefPicLi°Modifiˇti⁄
::~
	$TComRefPicLi°Modifiˇti⁄
()

1781 
	}
}

1783 
TComSˇlögLi°
::
	$TComSˇlögLi°
()

1785 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

1787 
UI¡
 
li°Id
 = 0;Üi°Id < 
SCALING_LIST_NUM
;ÜistId++)

1789 
m_sˇlögLi°C€f
[
sizeId
][
li°Id
].
	`ªsize
(
mö
<
I¡
>(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[sizeId]));

1792 
	}
}

1796 
Void
 
	gTComSˇlögLi°
::
	$£tDeÁu…SˇlögLi°
()

1798 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

1800 
UI¡
 
li°Id
=0;li°Id<
SCALING_LIST_NUM
;listId++)

1802 
	`¥o˚ssDeÁu…M©rix
(
sizeId
, 
li°Id
);

1805 
	}
}

1809 
Boﬁ
 
	gTComSˇlögLi°
::
	$checkDeÁu…SˇlögLi°
()

1811 
UI¡
 
deÁu…Cou¡î
=0;

1813 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

1815 
UI¡
 
li°Id
=0;li°Id<
SCALING_LIST_NUM
;listId++)

1817 if–!
	`memcmp
(
	`gëSˇlögLi°Addªss
(
sizeId
,
li°Id
), 
	`gëSˇlögLi°DeÁu…Addªss
(sizeId,Üi°Id),(
I¡
)*
	`mö
(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[sizeId]))

1818 && ((
sizeId
 < 
SCALING_LIST_16x16
Ë|| (
	`gëSˇlögLi°DC
(sizeId,
li°Id
) == 16)))

1820 
deÁu…Cou¡î
++;

1825  (
deÁu…Cou¡î
 =(
SCALING_LIST_NUM
 * 
SCALING_LIST_SIZE_NUM
 )Ë? 
Ál£
 : 
åue
;

1826 
	}
}

1833 
Void
 
	gTComSˇlögLi°
::
	$¥o˚ssRefM©rix
–
UI¡
 
sizeId
, UI¡ 
li°Id
 , UI¡ 
ªfLi°Id
 )

1835 ::
	`mem˝y
(
	`gëSˇlögLi°Addªss
(
sizeId
, 
li°Id
),(÷i°Id =
ªfLi°Id
)? 
	`gëSˇlögLi°DeÁu…Addªss
(sizeId,ÑefLi°Id): gëSˇlögLi°Addªss(sizeId,ÑefLi°Id)),(
I¡
)*
	`mö
(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[sizeId]));

1836 
	}
}

1838 
Void
 
	gTComSˇlögLi°
::
	$checkPªdMode
(
UI¡
 
sizeId
, UI¡ 
li°Id
)

1840 
I¡
 
¥edLi°Sãp
 = (
sizeId
 =
SCALING_LIST_32x32
? (
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
) : 1);

1842 
I¡
 
¥edLi°Idx
 = (I¡)
li°Id
 ;ÖªdLi°Idx >0;ÖªdLi°Idx-=
¥edLi°Sãp
)

1844 if–!
	`memcmp
(
	`gëSˇlögLi°Addªss
(
sizeId
,
li°Id
),(÷i°Id =
¥edLi°Idx
) ?

1845 
	`gëSˇlögLi°DeÁu…Addªss
(
sizeId
, 
¥edLi°Idx
): 
	`gëSˇlögLi°Addªss
(sizeId,ÖªdLi°Idx)),(
I¡
)*
	`mö
(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[sizeId]))

1846 && ((
sizeId
 < 
SCALING_LIST_16x16
Ë|| (
	`gëSˇlögLi°DC
(sizeId,
li°Id
Ë=gëSˇlögLi°DC(sizeId,
¥edLi°Idx
))))

1848 
	`£tRefM©rixId
(
sizeId
, 
li°Id
, 
¥edLi°Idx
);

1849 
	`£tSˇlögLi°PªdModeFœg
(
sizeId
, 
li°Id
, 
Ál£
);

1853 
	`£tSˇlögLi°PªdModeFœg
(
sizeId
, 
li°Id
, 
åue
);

1854 
	}
}

1856 
Void
 
	$ouçutSˇlögLi°Hñp
(
°d
::
o°ªam
 &
os
)

1858 
os
 << "The scalingÜist file specifiesáll matricesándÅheir DC values;Çone can be missing,\n"

1873 
os
 << "TheÖermitted matrixÇamesáre:\n";

1874 
UI¡
 
sizeIdc
 = 0; sizeId¯< 
SCALING_LIST_SIZE_NUM
; sizeIdc++)

1876 
UI¡
 
li°Idc
 = 0;Üi°Id¯< 
SCALING_LIST_NUM
;ÜistIdc++)

1878 i‡((
sizeIdc
!=
SCALING_LIST_32x32
Ë|| (
li°Idc
%(
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
) == 0))

1880 
os
 << " " << 
M©rixTy≥
[
sizeIdc
][
li°Idc
] << '\n';

1884 
	}
}

1886 
Void
 
	gTComSˇlögLi°
::
	$ouçutSˇlögLi°s
(
°d
::
o°ªam
 &
os
) const

1888 
UI¡
 
sizeIdc
 = 0; sizeId¯< 
SCALING_LIST_SIZE_NUM
; sizeIdc++)

1890 c⁄° 
UI¡
 
size
 = 
	`mö
(8,4<<(
sizeIdc
));

1891 
UI¡
 
li°Idc
 = 0;Üi°Id¯< 
SCALING_LIST_NUM
;ÜistIdc++)

1893 i‡((
sizeIdc
!=
SCALING_LIST_32x32
Ë|| (
li°Idc
%(
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
) == 0))

1895 c⁄° 
I¡
 *
§c
 = 
	`gëSˇlögLi°Addªss
(
sizeIdc
, 
li°Idc
);

1896 
os
 << (
M©rixTy≥
[
sizeIdc
][
li°Idc
]) << " =\n ";

1897 
UI¡
 
y
=0; y<
size
; y++)

1899 
UI¡
 
x
=0; x<
size
; x++, 
§c
++)

1901 
os
 << 
°d
::
	`£tw
(3Ë<< (*
§c
) << ", ";

1903 
os
 << (
y
+1<
size
?"\n ":"\n");

1905 if(
sizeIdc
 > 
SCALING_LIST_8x8
)

1907 
os
 << 
M©rixTy≥_DC
[
sizeIdc
][
li°Idc
] << " = \¿ " << 
°d
::
	`£tw
(3Ë<< 
	`gëSˇlögLi°DC
(sizeIdc,ÜistIdc) << "\n";

1909 
os
 << "\n";

1913 
	}
}

1915 
Boﬁ
 
	gTComSˇlögLi°
::
	$xP¨£SˇlögLi°
(c⁄° 
°d
::
°rög
 &
fûeName
)

1917 c⁄° 
I¡
 
LINE_SIZE
=1024;

1918 
FILE
 *
Â
 = 
NULL
;

1919 
TCh¨
 
löe
[
LINE_SIZE
];

1921 i‡(
fûeName
.
	`em±y
())

1923 
	`Ârötf
(
°dîr
, "Error:Ço scalingÜist file specified. Help on scalingÜists being output\n");

1924 
	`ouçutSˇlögLi°Hñp
(
°d
::
cout
);

1925 
°d
::
cout
 << "\n\nExample scalingÜist file using default values:\n\n";

1926 
	`ouçutSˇlögLi°s
(
°d
::
cout
);

1927 
	`exô
 (1);

1928  
åue
;

1930 i‡((
Â
 = 
	`f›í
(
fûeName
.
	`c_°r
(),"r")Ë=(
FILE
*)
NULL
)

1932 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ o≥¿sˇlögÜi° fûê%†f‹Ñódög\n", 
fûeName
.
	`c_°r
());

1933  
åue
;

1936 
UI¡
 
sizeIdc
 = 0; sizeId¯< 
SCALING_LIST_SIZE_NUM
; sizeIdc++)

1938 c⁄° 
UI¡
 
size
 = 
	`mö
(
MAX_MATRIX_COEF_NUM
,(
I¡
)
g_sˇlögLi°Size
[
sizeIdc
]);

1940 
UI¡
 
li°Idc
 = 0;Üi°Id¯< 
SCALING_LIST_NUM
;ÜistIdc++)

1942 
I¡
 * c⁄° 
§c
 = 
	`gëSˇlögLi°Addªss
(
sizeIdc
, 
li°Idc
);

1944 i‡((
sizeIdc
==
SCALING_LIST_32x32
Ë&& (
li°Idc
%(
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
) != 0))

1946 c⁄° 
I¡
 *
§cNextSmÆÀrSize
 = 
	`gëSˇlögLi°Addªss
(
sizeIdc
-1, 
li°Idc
);

1947 
UI¡
 
i
=0; i<
size
; i++)

1949 
§c
[
i
] = 
§cNextSmÆÀrSize
[i];

1951 
	`£tSˇlögLi°DC
(
sizeIdc
,
li°Idc
,(sizeId¯> 
SCALING_LIST_8x8
Ë? 
	`gëSˇlögLi°DC
(sizeIdc-1,Üi°IdcË: 
§c
[0]);

1956 
	`f£ek
(
Â
, 0, 
SEEK_SET
);

1957 
Boﬁ
 
bFound
=
Ál£
;

1958 (!
	`„of
(
Â
)Ë&& (!
bFound
))

1960 
TCh¨
 *
ªt
 = 
	`fgës
(
löe
, 
LINE_SIZE
, 
Â
);

1961 
TCh¨
 *
födNamePosôi⁄

ªt
==
NULL
 ? NULL : 
	`°r°r
(
löe
, 
M©rixTy≥
[
sizeIdc
][
li°Idc
]);

1963 i‡(
födNamePosôi⁄
!
NULL
 && (
M©rixTy≥_DC
[
sizeIdc
][
li°Idc
]==NULL || 
	`°r°r
(
löe
, MatrixType_DC[sizeIdc][listIdc])==NULL))

1965 
bFound
=
åue
;

1968 i‡(!
bFound
)

1970 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ föd M©rix %†‰om sˇlögÜi° fûê%s\n", 
M©rixTy≥
[
sizeIdc
][
li°Idc
], 
fûeName
.
	`c_°r
());

1971  
åue
;

1974 
UI¡
 
i
=0; i<
size
; i++)

1976 
I¡
 
d©a
;

1977 i‡(
	`fsˇnf
(
Â
, "%d,", &
d©a
)!=1)

1979 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸÑód vÆuê#%d f‹ M©rix %†‰om sˇlögÜi° fûê%†© fûêposôi⁄ %ld\n", 
i
, 
M©rixTy≥
[
sizeIdc
][
li°Idc
], 
fûeName
.
	`c_°r
(), 
	`·ñl
(
Â
));

1980  
åue
;

1982 i‡(
d©a
<0 || data>255)

1984 
	`Ârötf
(
°dîr
, "Eº‹: QM©rixÉ¡ry #%d o‡vÆuê%d f‹ M©rix %†‰om sˇlögÜi° fûê%†© fûêposôi⁄ %ld i†ouào‡øngê(0Åÿ255)\n", 
i
, 
d©a
, 
M©rixTy≥
[
sizeIdc
][
li°Idc
], 
fûeName
.
	`c_°r
(), 
	`·ñl
(
Â
));

1985  
åue
;

1987 
§c
[
i
] = 
d©a
;

1991 
	`£tSˇlögLi°DC
(
sizeIdc
,
li°Idc
,
§c
[0]);

1993 if(
sizeIdc
 > 
SCALING_LIST_8x8
)

1996 
	`f£ek
(
Â
, 0, 
SEEK_SET
);

1997 
Boﬁ
 
bFound
=
Ál£
;

1998 (!
	`„of
(
Â
)Ë&& (!
bFound
))

2000 
TCh¨
 *
ªt
 = 
	`fgës
(
löe
, 
LINE_SIZE
, 
Â
);

2001 
TCh¨
 *
födNamePosôi⁄

ªt
==
NULL
 ? NULL : 
	`°r°r
(
löe
, 
M©rixTy≥_DC
[
sizeIdc
][
li°Idc
]);

2002 i‡(
födNamePosôi⁄
!
NULL
)

2005 
bFound
=
åue
;

2008 i‡(!
bFound
)

2010 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸ föd DC M©rix %†‰om sˇlögÜi° fûê%s\n", 
M©rixTy≥_DC
[
sizeIdc
][
li°Idc
], 
fûeName
.
	`c_°r
());

2011  
åue
;

2014 
I¡
 
d©a
;

2015 i‡(
	`fsˇnf
(
Â
, "%d,", &
d©a
)!=1)

2017 
	`Ârötf
(
°dîr
, "Eº‹: c™nŸÑód DC %†‰om sˇlögÜi° fûê%†© fûêposôi⁄ %ld\n", 
M©rixTy≥_DC
[
sizeIdc
][
li°Idc
], 
fûeName
.
	`c_°r
(), 
	`·ñl
(
Â
));

2018  
åue
;

2020 i‡(
d©a
<0 || data>255)

2022 
	`Ârötf
(
°dîr
, "Eº‹: DC vÆuê%d f‹ M©rix %†‰om sˇlögÜi° fûê%†© fûêposôi⁄ %ld i†ouào‡øngê(0Åÿ255)\n", 
d©a
, 
M©rixTy≥
[
sizeIdc
][
li°Idc
], 
fûeName
.
	`c_°r
(), 
	`·ñl
(
Â
));

2023  
åue
;

2026 
	`£tSˇlögLi°DC
(
sizeIdc
,
li°Idc
,
d©a
);

2034 
	`f˛o£
(
Â
);

2035  
Ál£
;

2036 
	}
}

2044 c⁄° 
I¡
* 
	gTComSˇlögLi°
::
	$gëSˇlögLi°DeÁu…Addªss
(
UI¡
 
sizeId
, UI¡ 
li°Id
)

2046 c⁄° 
I¡
 *
§c
 = 0;

2047 
sizeId
)

2049 
SCALING_LIST_4x4
:

2050 
§c
 = 
g_qu™tTSDeÁu…4x4
;

2052 
SCALING_LIST_8x8
:

2053 
SCALING_LIST_16x16
:

2054 
SCALING_LIST_32x32
:

2055 
§c
 = (
li°Id
 < (
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
ËË? 
g_qu™tI¡øDeÁu…8x8
 : 
g_qu™tI¡îDeÁu…8x8
;

2058 
	`as£π
(0);

2059 
§c
 = 
NULL
;

2062  
§c
;

2063 
	}
}

2069 
Void
 
	gTComSˇlögLi°
::
	$¥o˚ssDeÁu…M©rix
(
UI¡
 
sizeId
, UI¡ 
li°Id
)

2071 ::
	`mem˝y
(
	`gëSˇlögLi°Addªss
(
sizeId
, 
li°Id
),
	`gëSˇlögLi°DeÁu…Addªss
(sizeId,li°Id),(
I¡
)*
	`mö
(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[sizeId]));

2072 
	`£tSˇlögLi°DC
(
sizeId
,
li°Id
,
SCALING_LIST_DC
);

2073 
	}
}

2077 
Void
 
	gTComSˇlögLi°
::
	$checkDcOfM©rix
()

2079 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

2081 
UI¡
 
li°Id
 = 0;Üi°Id < 
SCALING_LIST_NUM
;ÜistId++)

2084 if(
	`gëSˇlögLi°DC
(
sizeId
,
li°Id
) == 0)

2086 
	`¥o˚ssDeÁu…M©rix
(
sizeId
, 
li°Id
);

2090 
	}
}

2092 
	gP¨amëîSëM™agî
::
	$P¨amëîSëM™agî
()

2093 : 
	`m_vpsM≠
(
MAX_NUM_VPS
)

2094 , 
	`m_•sM≠
(
MAX_NUM_SPS
)

2095 , 
	`m_µsM≠
(
MAX_NUM_PPS
)

2096 , 
	`m_a˘iveVPSId
(-1)

2097 , 
	`m_a˘iveSPSId
(-1)

2099 
	}
}

2102 
	gP¨amëîSëM™agî
::~
	$P¨amëîSëM™agî
()

2104 
	}
}

2135 
Boﬁ
 
P¨amëîSëM™agî
::
	$a˘iv©ePPS
(
I¡
 
µsId
, 
Boﬁ
 
isIRAP
)

2137 
TComPPS
 *
µs
 = 
m_µsM≠
.
	`gëPS
(
µsId
);

2138 i‡(
µs
)

2140 
I¡
 
•sId
 = 
µs
->
	`gëSPSId
();

2141 i‡(!
isIRAP
 && (
•sId
 !
m_a˘iveSPSId
 ))

2143 
	`¥ötf
("Warning:ÅriedÅoáctivate PPSÑeferringÅoá inactive SPSátÇon-IDR.");

2147 
TComSPS
 *
•s
 = 
m_•sM≠
.
	`gëPS
(
•sId
);

2148 i‡(
•s
)

2150 
I¡
 
vpsId
 = 
•s
->
	`gëVPSId
();

2151 i‡(!
isIRAP
 && (
vpsId
 !
m_a˘iveVPSId
 ))

2153 
	`¥ötf
("Warning:ÅriedÅoáctivate PPSÑeferringÅoá inactive VPSátÇon-IDR.");

2157 
TComVPS
 *
vps
 =
m_vpsM≠
.
	`gëPS
(
vpsId
);

2158 i‡(
vps
)

2160 
m_a˘iveVPSId
 = 
vpsId
;

2161 
m_a˘iveSPSId
 = 
•sId
;

2162  
åue
;

2166 
	`¥ötf
("Warning:ÅriedÅoáctivate PPSÅhatÑefersÅoáÇon-existing VPS.");

2172 
	`¥ötf
("Warning:ÅriedÅoáctivateá PPSÅhatÑefersÅoáÇon-existing SPS.");

2178 
	`¥ötf
("Warning:ÅriedÅoáctivateÇon-existing PPS.");

2182 
m_a˘iveSPSId
=-1;

2183 
m_a˘iveVPSId
=-1;

2184  
Ál£
;

2185 
	}
}

2187 
	gãm∂©e
 <>

2188 
Void
 
	gP¨amëîSëM≠
<
	gTComPPS
>::
	$£tID
(
TComPPS
* 
∑ømëîSë
, c⁄° 
I¡
 
psId
)

2190 
∑ømëîSë
->
	`£tPPSId
(
psId
);

2191 
	}
}

2193 
	gãm∂©e
 <>

2194 
Void
 
	gP¨amëîSëM≠
<
	gTComSPS
>::
	$£tID
(
TComSPS
* 
∑ømëîSë
, c⁄° 
I¡
 
psId
)

2196 
∑ømëîSë
->
	`£tSPSId
(
psId
);

2197 
	}
}

2199 
	gProfûeTõrLevñ
::
	$ProfûeTõrLevñ
()

2200 : 
	`m_¥ofûeS∑˚
 (0)

2201 , 
	`m_tõrFœg
 (
Levñ
::
MAIN
)

2202 , 
	`m_¥ofûeIdc
 (
Profûe
::
NONE
)

2203 , 
	`m_ÀvñIdc
 (
Levñ
::
NONE
)

2204 , 
	`m_¥ogªssiveSour˚Fœg
 (
Ál£
)

2205 , 
	`m_öãæa˚dSour˚Fœg
 (
Ál£
)

2206 , 
	`m_n⁄PackedC⁄°øötFœg
(
Ál£
)

2207 , 
	$m_‰ameO∆yC⁄°øötFœg
(
Ál£
)

2209 ::
	`mem£t
(
m_¥ofûeCom∑tibûôyFœg
, 0, (m_profileCompatibilityFlag));

2210 
	}
}

2212 
	gTComPTL
::
	$TComPTL
()

2214 ::
	`mem£t
(
m_subLayîProfûePª£¡Fœg
, 0, (m_subLayerProfilePresentFlag));

2215 ::
	`mem£t
(
m_subLayîLevñPª£¡Fœg
, 0, (m_subLayerLevelPresentFlag ));

2216 
	}
}

2218 
Void
 
ˇlcuœãP¨amëîSëCh™gedFœg
(
Boﬁ
 &
bCh™ged
, c⁄° 
°d
::
ve˘‹
<
UCh¨
> *
pOldD©a
, c⁄° std::ve˘‹<UCh¨> *
pNewD©a
)

2220 i‡(!
bCh™ged
)

2222 i‡((
pOldD©a
==0 && 
pNewD©a
!=0) || (pOldData!=0 &&ÖNewData==0))

2224 
bCh™ged
=
åue
;

2226 i‡(
	gpOldD©a
!=0 && 
pNewD©a
!=0)

2229 i‡(
pOldD©a
->
size
(Ë!
pNewD©a
->size())

2231 
bCh™ged
=
åue
;

2235 c⁄° 
UCh¨
 *
	gpNewD©aAºay
=&(*
pNewD©a
)[0];

2236 c⁄° 
UCh¨
 *
	gpOldD©aAºay
=&(*
pOldD©a
)[0];

2237 i‡(
memcmp
(
pOldD©aAºay
, 
pNewD©aAºay
, 
pOldD©a
->
size
()))

2239 
	gbCh™ged
=
åue
;

	@TLibCommon/TComSlice.h

38 #i‚de‡
__TCOMSLICE__


39 
	#__TCOMSLICE__


	)

41 
	~<c°rög
>

42 
	~<m≠
>

43 
	~<ve˘‹
>

44 
	~"Comm⁄Def.h
"

45 
	~"TComRom.h
"

46 
	~"TComLi°.h
"

47 
	~"TComChromaF‹m©.h
"

52 
˛ass
 
	gTComPic
;

53 
˛ass
 
	gTComTrQu™t
;

58 c⁄° 
UI¡
 
	gREF_PIC_LIST_NUM_IDX
=32;

65 ˛as†
	cTComRe„ªn˚Pi˘uªSë


67 
	m¥iv©e
:

68 
I¡
 
m_numbîOfPi˘uªs
;

69 
I¡
 
	mm_numbîOfNeg©ivePi˘uªs
;

70 
I¡
 
	mm_numbîOfPosôivePi˘uªs
;

71 
I¡
 
	mm_numbîOfL⁄gãrmPi˘uªs
;

72 
I¡
 
	mm_dñèPOC
[
MAX_NUM_REF_PICS
];

73 
I¡
 
	mm_POC
[
MAX_NUM_REF_PICS
];

74 
Boﬁ
 
	mm_u£d
[
MAX_NUM_REF_PICS
];

75 
Boﬁ
 
	mm_öãrRPSPªdi˘i⁄
;

76 
I¡
 
	mm_dñèRIdxMöus1
;

77 
I¡
 
	mm_dñèRPS
;

78 
I¡
 
	mm_numRefIdc
;

79 
I¡
 
	mm_ªfIdc
[
MAX_NUM_REF_PICS
+1];

80 
Boﬁ
 
	mm_bCheckLTMSB
[
MAX_NUM_REF_PICS
];

81 
I¡
 
	mm_pocLSBLT
[
MAX_NUM_REF_PICS
];

82 
I¡
 
	mm_dñèPOCMSBCy˛eLT
[
MAX_NUM_REF_PICS
];

83 
Boﬁ
 
	mm_dñèPocMSBPª£¡Fœg
[
MAX_NUM_REF_PICS
];

85 
	mpublic
:

86 
TComRe„ªn˚Pi˘uªSë
();

87 
	mvútuÆ
 ~
TComRe„ªn˚Pi˘uªSë
();

88 
I¡
 
	$gëPocLSBLT
(
I¡
 
i
Ëc⁄° {  
m_pocLSBLT
[i]; }

89 
Void
 
	$£tPocLSBLT
(
I¡
 
i
, I¡ 
x
Ë{ 
m_pocLSBLT
[i] = x; 
	}
}

90 
I¡
 
	$gëDñèPocMSBCy˛eLT
(
I¡
 
i
Ëc⁄° {  
m_dñèPOCMSBCy˛eLT
[i]; 
	}
}

91 
Void
 
	$£tDñèPocMSBCy˛eLT
(
I¡
 
i
, I¡ 
x
Ë{ 
m_dñèPOCMSBCy˛eLT
[i] = x; 
	}
}

92 
Boﬁ
 
	$gëDñèPocMSBPª£¡Fœg
(
I¡
 
i
Ëc⁄° {  
m_dñèPocMSBPª£¡Fœg
[i]; 
	}
}

93 
Void
 
	$£tDñèPocMSBPª£¡Fœg
(
I¡
 
i
, 
Boﬁ
 
x
Ë{ 
m_dñèPocMSBPª£¡Fœg
[i] = x; 
	}
}

94 
Void
 
£tU£d
(
I¡
 
buf„rNum
, 
Boﬁ
 
u£d
);

95 
Void
 
£tDñèPOC
(
I¡
 
buf„rNum
, I¡ 
dñèPOC
);

96 
Void
 
£tPOC
(
I¡
 
buf„rNum
, I¡ 
dñèPOC
);

97 
Void
 
£tNumbîOfPi˘uªs
(
I¡
 
numbîOfPi˘uªs
);

98 
Void
 
£tCheckLTMSBPª£¡
(
I¡
 
buf„rNum
, 
Boﬁ
 
b
 );

99 
Boﬁ
 
	$gëCheckLTMSBPª£¡
(
I¡
 
buf„rNum
) const;

101 
I¡
 
	$gëU£d
(
I¡
 
buf„rNum
) const;

102 
I¡
 
	$gëDñèPOC
(
I¡
 
buf„rNum
) const;

103 
I¡
 
	$gëPOC
(
I¡
 
buf„rNum
) const;

104 
I¡
 
	$gëNumbîOfPi˘uªs
() const;

106 
Void
 
	$£tNumbîOfNeg©ivePi˘uªs
(
I¡
 
numbî
Ë{ 
m_numbîOfNeg©ivePi˘uªs
 =Çumbî; 
	}
}

107 
I¡
 
	$gëNumbîOfNeg©ivePi˘uªs
(Ëc⁄° {  
m_numbîOfNeg©ivePi˘uªs
; 
	}
}

108 
Void
 
	$£tNumbîOfPosôivePi˘uªs
(
I¡
 
numbî
Ë{ 
m_numbîOfPosôivePi˘uªs
 =Çumbî; 
	}
}

109 
I¡
 
	$gëNumbîOfPosôivePi˘uªs
(Ëc⁄° {  
m_numbîOfPosôivePi˘uªs
; 
	}
}

110 
Void
 
	$£tNumbîOfL⁄gãrmPi˘uªs
(
I¡
 
numbî
Ë{ 
m_numbîOfL⁄gãrmPi˘uªs
 =Çumbî; 
	}
}

111 
I¡
 
	$gëNumbîOfL⁄gãrmPi˘uªs
(Ëc⁄° {  
m_numbîOfL⁄gãrmPi˘uªs
; 
	}
}

113 
Void
 
	$£tI¡îRPSPªdi˘i⁄
(
Boﬁ
 
Êag
Ë{ 
m_öãrRPSPªdi˘i⁄
 = fœg; 
	}
}

114 
Boﬁ
 
	$gëI¡îRPSPªdi˘i⁄
(Ëc⁄° {  
m_öãrRPSPªdi˘i⁄
; 
	}
}

115 
Void
 
	$£tDñèRIdxMöus1
(
I¡
 
x
Ë{ 
m_dñèRIdxMöus1
 = x; 
	}
}

116 
I¡
 
	$gëDñèRIdxMöus1
(Ëc⁄° {  
m_dñèRIdxMöus1
; 
	}
}

117 
Void
 
	$£tDñèRPS
(
I¡
 
x
Ë{ 
m_dñèRPS
 = x; 
	}
}

118 
I¡
 
	$gëDñèRPS
(Ëc⁄° {  
m_dñèRPS
; 
	}
}

119 
Void
 
	$£tNumRefIdc
(
I¡
 
x
Ë{ 
m_numRefIdc
 = x; 
	}
}

120 
I¡
 
	$gëNumRefIdc
(Ëc⁄° {  
m_numRefIdc
; 
	}
}

122 
Void
 
£tRefIdc
(
I¡
 
buf„rNum
, I¡ 
ªfIdc
);

123 
I¡
 
	$gëRefIdc
(
I¡
 
buf„rNum
) const ;

125 
Void
 
	`s‹tDñèPOC
();

126 
Void
 
	$¥ötDñèPOC
() const;

127 
	}
};

130 ˛as†
	cTComRPSLi°


132 
	m¥iv©e
:

133 
°d
::
ve˘‹
<
TComRe„ªn˚Pi˘uªSë
> 
m_ª„ªn˚Pi˘uªSës
;

135 
	mpublic
:

136 
	$TComRPSLi°
() { }

137 
vútuÆ
 ~
	$TComRPSLi°
(Ë{ 
	}
}

139 
Void
 
	$¸óã
 (
I¡
 
numbîOfE¡rõs
Ë{ 
m_ª„ªn˚Pi˘uªSës
.
	`ªsize
“umbîOfE¡rõs); 
	}
}

140 
Void
 
	$de°roy
 (Ë{ 
	}
}

143 
TComRe„ªn˚Pi˘uªSë
* 
	$gëRe„ªn˚Pi˘uªSë
(
I¡
 
ª„ªn˚Pi˘uªSëNum
Ë{  &
m_ª„ªn˚Pi˘uªSës
[ª„ªn˚Pi˘uªSëNum]; 
	}
}

144 c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
	$gëRe„ªn˚Pi˘uªSë
(
I¡
 
ª„ªn˚Pi˘uªSëNum
Ëc⁄° {  &
m_ª„ªn˚Pi˘uªSës
[ª„ªn˚Pi˘uªSëNum]; 
	}
}

146 
I¡
 
	$gëNumbîOfRe„ªn˚Pi˘uªSës
(Ëc⁄° {  
	`I¡
(
m_ª„ªn˚Pi˘uªSës
.
	`size
()); 
	}
}

150 ˛as†
	cTComSˇlögLi°


152 
	mpublic
:

153 
TComSˇlögLi°
();

154 
	mvútuÆ
 ~
	$TComSˇlögLi°
() { }

155 
I¡
* 
	$gëSˇlögLi°Addªss
(
UI¡
 
sizeId
, UI¡ 
li°Id
Ë{  &(
m_sˇlögLi°C€f
[sizeId][li°Id][0]); 
	}
}

156 c⁄° 
I¡
* 
	$gëSˇlögLi°Addªss
(
UI¡
 
sizeId
, UI¡ 
li°Id
Ëc⁄° {  &(
m_sˇlögLi°C€f
[sizeId][li°Id][0]); 
	}
}

157 
Void
 
checkPªdMode
(
UI¡
 
sizeId
, UI¡ 
li°Id
);

159 
Void
 
	$£tRefM©rixId
(
UI¡
 
sizeId
, UI¡ 
li°Id
, UI¡ 
u
Ë{ 
m_ªfM©rixId
[sizeId][li°Id] = u; 
	}
}

160 
UI¡
 
	$gëRefM©rixId
(
UI¡
 
sizeId
, UI¡ 
li°Id
Ëc⁄° {  
m_ªfM©rixId
[sizeId][li°Id]; 
	}
}

162 c⁄° 
I¡
* 
gëSˇlögLi°DeÁu…Addªss
(
UI¡
 
sizeId
, UI¡ 
li°Id
);

163 
Void
 
¥o˚ssDeÁu…M©rix
(
UI¡
 
sizeId
, UI¡ 
li°Id
);

165 
Void
 
	$£tSˇlögLi°DC
(
UI¡
 
sizeId
, UI¡ 
li°Id
, UI¡ 
u
Ë{ 
m_sˇlögLi°DC
[sizeId][li°Id] = u; 
	}
}

166 
I¡
 
	$gëSˇlögLi°DC
(
UI¡
 
sizeId
, UI¡ 
li°Id
Ëc⁄° {  
m_sˇlögLi°DC
[sizeId][li°Id]; 
	}
}

168 
Void
 
	$£tSˇlögLi°PªdModeFœg
(
UI¡
 
sizeId
, UI¡ 
li°Id
, 
Boﬁ
 
bIsDPCM
Ë{ 
m_sˇlögLi°PªdModeFœgIsDPCM
[sizeId][li°Id] = bIsDPCM; 
	}
}

169 
Boﬁ
 
	$gëSˇlögLi°PªdModeFœg
(
UI¡
 
sizeId
, UI¡ 
li°Id
Ëc⁄° {  
m_sˇlögLi°PªdModeFœgIsDPCM
[sizeId][li°Id]; 
	}
}

171 
Void
 
checkDcOfM©rix
();

172 
Void
 
¥o˚ssRefM©rix
(
UI¡
 
sizeId
, UI¡ 
li°Id
 , UI¡ 
ªfLi°Id
 );

173 
Boﬁ
 
xP¨£SˇlögLi°
(c⁄° 
°d
::
°rög
 &
fûeName
);

174 
Void
 
£tDeÁu…SˇlögLi°
();

175 
Boﬁ
 
checkDeÁu…SˇlögLi°
();

177 
	g¥iv©e
:

178 
Void
 
	$ouçutSˇlögLi°s
(
°d
::
o°ªam
 &
os
) const;

179 
Boﬁ
 
m_sˇlögLi°PªdModeFœgIsDPCM
 [
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
];

180 
I¡
 
m_sˇlögLi°DC
 [
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
];

181 
UI¡
 
m_ªfM©rixId
 [
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
];

182 
°d
::
ve˘‹
<
I¡
> 
m_sˇlögLi°C€f
 [
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
];

183 
	}
};

185 ˛as†
	cProfûeTõrLevñ


187 
I¡
 
	mm_¥ofûeS∑˚
;

188 
	mLevñ
::
Tõr
 
m_tõrFœg
;

189 
	mProfûe
::
Name
 
m_¥ofûeIdc
;

190 
Boﬁ
 
	mm_¥ofûeCom∑tibûôyFœg
[32];

191 
	mLevñ
::
Name
 
m_ÀvñIdc
;

193 
Boﬁ
 
	mm_¥ogªssiveSour˚Fœg
;

194 
Boﬁ
 
	mm_öãæa˚dSour˚Fœg
;

195 
Boﬁ
 
	mm_n⁄PackedC⁄°øötFœg
;

196 
Boﬁ
 
	mm_‰ameO∆yC⁄°øötFœg
;

197 
UI¡
 
	mm_bôDïthC⁄°øötVÆue
;

198 
ChromaF‹m©
 
	mm_chromaF‹m©C⁄°øötVÆue
;

199 
Boﬁ
 
	mm_öåaC⁄°øötFœg
;

200 
Boﬁ
 
	mm_⁄ePi˘uªO∆yC⁄°øötFœg
;

201 
Boﬁ
 
	mm_lowîBôR©eC⁄°øötFœg
;

203 
	mpublic
:

204 
ProfûeTõrLevñ
();

206 
I¡
 
	$gëProfûeS∑˚
(Ëc⁄° {  
m_¥ofûeS∑˚
; }

207 
Void
 
	$£tProfûeS∑˚
(
I¡
 
x
Ë{ 
m_¥ofûeS∑˚
 = x; 
	}
}

209 
	gLevñ
::
Tõr
 
	$gëTõrFœg
(Ëc⁄° {  
m_tõrFœg
; 
	}
}

210 
Void
 
	$£tTõrFœg
(
Levñ
::
Tõr
 
x
Ë{ 
m_tõrFœg
 = x; 
	}
}

212 
	gProfûe
::
Name
 
	$gëProfûeIdc
(Ëc⁄° {  
m_¥ofûeIdc
; 
	}
}

213 
Void
 
	$£tProfûeIdc
(
Profûe
::
Name
 
x
Ë{ 
m_¥ofûeIdc
 = x; 
	}
}

215 
Boﬁ
 
	$gëProfûeCom∑tibûôyFœg
(
I¡
 
i
Ëc⁄° {  
m_¥ofûeCom∑tibûôyFœg
[i]; 
	}
}

216 
Void
 
	$£tProfûeCom∑tibûôyFœg
(
I¡
 
i
, 
Boﬁ
 
x
Ë{ 
m_¥ofûeCom∑tibûôyFœg
[i] = x; 
	}
}

218 
	gLevñ
::
Name
 
	$gëLevñIdc
(Ëc⁄° {  
m_ÀvñIdc
; 
	}
}

219 
Void
 
	$£tLevñIdc
(
Levñ
::
Name
 
x
Ë{ 
m_ÀvñIdc
 = x; 
	}
}

221 
Boﬁ
 
	$gëProgªssiveSour˚Fœg
(Ëc⁄° {  
m_¥ogªssiveSour˚Fœg
; 
	}
}

222 
Void
 
	$£tProgªssiveSour˚Fœg
(
Boﬁ
 
b
Ë{ 
m_¥ogªssiveSour˚Fœg
 = b; 
	}
}

224 
Boﬁ
 
	$gëI¡îœ˚dSour˚Fœg
(Ëc⁄° {  
m_öãæa˚dSour˚Fœg
; 
	}
}

225 
Void
 
	$£tI¡îœ˚dSour˚Fœg
(
Boﬁ
 
b
Ë{ 
m_öãæa˚dSour˚Fœg
 = b; 
	}
}

227 
Boﬁ
 
	$gëN⁄PackedC⁄°øötFœg
(Ëc⁄° {  
m_n⁄PackedC⁄°øötFœg
; 
	}
}

228 
Void
 
	$£tN⁄PackedC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_n⁄PackedC⁄°øötFœg
 = b; 
	}
}

230 
Boﬁ
 
	$gëFømeO∆yC⁄°øötFœg
(Ëc⁄° {  
m_‰ameO∆yC⁄°øötFœg
; 
	}
}

231 
Void
 
	$£tFømeO∆yC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_‰ameO∆yC⁄°øötFœg
 = b; 
	}
}

233 
UI¡
 
	$gëBôDïthC⁄°øöt
(Ëc⁄° {  
m_bôDïthC⁄°øötVÆue
; 
	}
}

234 
Void
 
	$£tBôDïthC⁄°øöt
(
UI¡
 
bôDïth
Ë{ 
m_bôDïthC⁄°øötVÆue
=bôDïth; 
	}
}

236 
ChromaF‹m©
 
	$gëChromaF‹m©C⁄°øöt
(Ëc⁄° {  
m_chromaF‹m©C⁄°øötVÆue
; 
	}
}

237 
Void
 
	$£tChromaF‹m©C⁄°øöt
(
ChromaF‹m©
 
fmt
Ë{ 
m_chromaF‹m©C⁄°øötVÆue
=fmt; 
	}
}

239 
Boﬁ
 
	$gëI¡øC⁄°øötFœg
(Ëc⁄° {  
m_öåaC⁄°øötFœg
; 
	}
}

240 
Void
 
	$£tI¡øC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_öåaC⁄°øötFœg
 = b; 
	}
}

242 
Boﬁ
 
	$gëO√Pi˘uªO∆yC⁄°øötFœg
(Ëc⁄° {  
m_⁄ePi˘uªO∆yC⁄°øötFœg
;
	}
}

243 
Void
 
	$£tO√Pi˘uªO∆yC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_⁄ePi˘uªO∆yC⁄°øötFœg
 = b; 
	}
}

245 
Boﬁ
 
	$gëLowîBôR©eC⁄°øötFœg
(Ëc⁄° {  
m_lowîBôR©eC⁄°øötFœg
; 
	}
}

246 
Void
 
	$£tLowîBôR©eC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_lowîBôR©eC⁄°øötFœg
 = b; 
	}
}

250 ˛as†
	cTComPTL


252 
ProfûeTõrLevñ
 
	mm_gíîÆPTL
;

253 
ProfûeTõrLevñ
 
	mm_subLayîPTL
 [
MAX_TLAYER
-1];

254 
Boﬁ
 
	mm_subLayîProfûePª£¡Fœg
 [
MAX_TLAYER
-1];

255 
Boﬁ
 
	mm_subLayîLevñPª£¡Fœg
 [
MAX_TLAYER
-1];

257 
	mpublic
:

258 
TComPTL
();

259 
Boﬁ
 
	$gëSubLayîProfûePª£¡Fœg
(
I¡
 
i
Ëc⁄° {  
m_subLayîProfûePª£¡Fœg
[i]; }

260 
Void
 
	$£tSubLayîProfûePª£¡Fœg
(
I¡
 
i
, 
Boﬁ
 
x
Ë{ 
m_subLayîProfûePª£¡Fœg
[i] = x; 
	}
}

262 
Boﬁ
 
	$gëSubLayîLevñPª£¡Fœg
(
I¡
 
i
Ëc⁄° {  
m_subLayîLevñPª£¡Fœg
[i]; 
	}
}

263 
Void
 
	$£tSubLayîLevñPª£¡Fœg
(
I¡
 
i
, 
Boﬁ
 
x
Ë{ 
m_subLayîLevñPª£¡Fœg
[i] = x; 
	}
}

265 
ProfûeTõrLevñ
* 
	$gëGíîÆPTL
(Ë{  &
m_gíîÆPTL
; 
	}
}

266 c⁄° 
ProfûeTõrLevñ
* 
	$gëGíîÆPTL
(Ëc⁄° {  &
m_gíîÆPTL
; 
	}
}

267 
ProfûeTõrLevñ
* 
	$gëSubLayîPTL
(
I¡
 
i
Ë{  &
m_subLayîPTL
[i]; 
	}
}

268 c⁄° 
ProfûeTõrLevñ
* 
	$gëSubLayîPTL
(
I¡
 
i
Ëc⁄° {  &
m_subLayîPTL
[i]; 
	}
}

273 
	sHrdSubLayîInfo


275 
Boﬁ
 
	mfixedPicR©eFœg
;

276 
Boﬁ
 
	mfixedPicR©eWôhöCvsFœg
;

277 
UI¡
 
	mpicDuøti⁄InTcMöus1
;

278 
Boﬁ
 
	mlowDñayHrdFœg
;

279 
UI¡
 
	m˝bC¡Möus1
;

280 
UI¡
 
	mbôR©eVÆueMöus1
[
MAX_CPB_CNT
][2];

281 
UI¡
 
	m˝bSizeVÆue
 [
MAX_CPB_CNT
][2];

282 
UI¡
 
	mdu˝bSizeVÆue
 [
MAX_CPB_CNT
][2];

283 
Boﬁ
 
	mcbrFœg
 [
MAX_CPB_CNT
][2];

284 
UI¡
 
	mduBôR©eVÆue
 [
MAX_CPB_CNT
][2];

287 ˛as†
	cTComHRD


289 
	m¥iv©e
:

290 
Boﬁ
 
m_«lHrdP¨amëîsPª£¡Fœg
;

291 
Boﬁ
 
	mm_v˛HrdP¨amëîsPª£¡Fœg
;

292 
Boﬁ
 
	mm_subPicCpbP¨amsPª£¡Fœg
;

293 
UI¡
 
	mm_tickDivis‹Möus2
;

294 
UI¡
 
	mm_duCpbRemovÆDñayLígthMöus1
;

295 
Boﬁ
 
	mm_subPicCpbP¨amsInPicTimögSEIFœg
;

296 
UI¡
 
	mm_dpbOuçutDñayDuLígthMöus1
;

297 
UI¡
 
	mm_bôR©eSˇÀ
;

298 
UI¡
 
	mm_˝bSizeSˇÀ
;

299 
UI¡
 
	mm_du˝bSizeSˇÀ
;

300 
UI¡
 
	mm_öôülCpbRemovÆDñayLígthMöus1
;

301 
UI¡
 
	mm_˝bRemovÆDñayLígthMöus1
;

302 
UI¡
 
	mm_dpbOuçutDñayLígthMöus1
;

303 
HrdSubLayîInfo
 
	mm_HRD
[
MAX_TLAYER
];

305 
	mpublic
:

306 
	$TComHRD
()

307 :
	`m_«lHrdP¨amëîsPª£¡Fœg
 (0)

308 ,
	`m_v˛HrdP¨amëîsPª£¡Fœg
 (0)

309 ,
	`m_subPicCpbP¨amsPª£¡Fœg
 (
Ál£
)

310 ,
	`m_tickDivis‹Möus2
 (0)

311 ,
	`m_duCpbRemovÆDñayLígthMöus1
 (0)

312 ,
	`m_subPicCpbP¨amsInPicTimögSEIFœg
 (
Ál£
)

313 ,
	`m_dpbOuçutDñayDuLígthMöus1
 (0)

314 ,
	`m_bôR©eSˇÀ
 (0)

315 ,
	`m_˝bSizeSˇÀ
 (0)

316 ,
	`m_öôülCpbRemovÆDñayLígthMöus1
(23)

317 ,
	`m_˝bRemovÆDñayLígthMöus1
 (23)

318 ,
	$m_dpbOuçutDñayLígthMöus1
 (23)

321 
vútuÆ
 ~
	$TComHRD
(Ë{
	}
}

323 
Void
 
	$£tNÆHrdP¨amëîsPª£¡Fœg
–
Boﬁ
 
Êag
 ) { 
m_«lHrdP¨amëîsPª£¡Fœg
 = fœg; 
	}
}

324 
Boﬁ
 
	$gëNÆHrdP¨amëîsPª£¡Fœg
–Ëc⁄° {  
m_«lHrdP¨amëîsPª£¡Fœg
; 
	}
}

326 
Void
 
	$£tV˛HrdP¨amëîsPª£¡Fœg
–
Boﬁ
 
Êag
 ) { 
m_v˛HrdP¨amëîsPª£¡Fœg
 = fœg; 
	}
}

327 
Boﬁ
 
	$gëV˛HrdP¨amëîsPª£¡Fœg
–Ëc⁄° {  
m_v˛HrdP¨amëîsPª£¡Fœg
; 
	}
}

329 
Void
 
	$£tSubPicCpbP¨amsPª£¡Fœg
–
Boﬁ
 
Êag
 ) { 
m_subPicCpbP¨amsPª£¡Fœg
 = fœg; 
	}
}

330 
Boﬁ
 
	$gëSubPicCpbP¨amsPª£¡Fœg
–Ëc⁄° {  
m_subPicCpbP¨amsPª£¡Fœg
; 
	}
}

332 
Void
 
	$£tTickDivis‹Möus2
–
UI¡
 
vÆue
 ) { 
m_tickDivis‹Möus2
 = vÆue; 
	}
}

333 
UI¡
 
	$gëTickDivis‹Möus2
–Ëc⁄° {  
m_tickDivis‹Möus2
; 
	}
}

335 
Void
 
	$£tDuCpbRemovÆDñayLígthMöus1
–
UI¡
 
vÆue
 ) { 
m_duCpbRemovÆDñayLígthMöus1
 = vÆue; 
	}
}

336 
UI¡
 
	$gëDuCpbRemovÆDñayLígthMöus1
–Ëc⁄° {  
m_duCpbRemovÆDñayLígthMöus1
; 
	}
}

338 
Void
 
	$£tSubPicCpbP¨amsInPicTimögSEIFœg
–
Boﬁ
 
Êag
Ë{ 
m_subPicCpbP¨amsInPicTimögSEIFœg
 = fœg; 
	}
}

339 
Boﬁ
 
	$gëSubPicCpbP¨amsInPicTimögSEIFœg
–Ëc⁄° {  
m_subPicCpbP¨amsInPicTimögSEIFœg
; 
	}
}

341 
Void
 
	$£tDpbOuçutDñayDuLígthMöus1
(
UI¡
 
vÆue
 ) { 
m_dpbOuçutDñayDuLígthMöus1
 = vÆue; 
	}
}

342 
UI¡
 
	$gëDpbOuçutDñayDuLígthMöus1
–Ëc⁄° {  
m_dpbOuçutDñayDuLígthMöus1
; 
	}
}

344 
Void
 
	$£tBôR©eSˇÀ
–
UI¡
 
vÆue
 ) { 
m_bôR©eSˇÀ
 = vÆue; 
	}
}

345 
UI¡
 
	$gëBôR©eSˇÀ
–Ëc⁄° {  
m_bôR©eSˇÀ
; 
	}
}

347 
Void
 
	$£tCpbSizeSˇÀ
–
UI¡
 
vÆue
 ) { 
m_˝bSizeSˇÀ
 = vÆue; 
	}
}

348 
UI¡
 
	$gëCpbSizeSˇÀ
–Ëc⁄° {  
m_˝bSizeSˇÀ
; 
	}
}

349 
Void
 
	$£tDuCpbSizeSˇÀ
–
UI¡
 
vÆue
 ) { 
m_du˝bSizeSˇÀ
 = vÆue; 
	}
}

350 
UI¡
 
	$gëDuCpbSizeSˇÀ
–Ëc⁄° {  
m_du˝bSizeSˇÀ
; 
	}
}

352 
Void
 
	$£tInôülCpbRemovÆDñayLígthMöus1
–
UI¡
 
vÆue
 ) { 
m_öôülCpbRemovÆDñayLígthMöus1
 = vÆue; 
	}
}

353 
UI¡
 
	$gëInôülCpbRemovÆDñayLígthMöus1
–Ëc⁄° {  
m_öôülCpbRemovÆDñayLígthMöus1
; 
	}
}

355 
Void
 
	$£tCpbRemovÆDñayLígthMöus1
–
UI¡
 
vÆue
 ) { 
m_˝bRemovÆDñayLígthMöus1
 = vÆue; 
	}
}

356 
UI¡
 
	$gëCpbRemovÆDñayLígthMöus1
–Ëc⁄° {  
m_˝bRemovÆDñayLígthMöus1
; 
	}
}

358 
Void
 
	$£tDpbOuçutDñayLígthMöus1
–
UI¡
 
vÆue
 ) { 
m_dpbOuçutDñayLígthMöus1
 = vÆue; 
	}
}

359 
UI¡
 
	$gëDpbOuçutDñayLígthMöus1
–Ëc⁄° {  
m_dpbOuçutDñayLígthMöus1
; 
	}
}

361 
Void
 
	$£tFixedPicR©eFœg
–
I¡
 
œyî
, 
Boﬁ
 
Êag
 ) { 
m_HRD
[œyî].
fixedPicR©eFœg
 = fœg; 
	}
}

362 
Boﬁ
 
	$gëFixedPicR©eFœg
–
I¡
 
œyî
 ) c⁄° {  
m_HRD
[œyî].
fixedPicR©eFœg
; 
	}
}

364 
Void
 
	$£tFixedPicR©eWôhöCvsFœg
–
I¡
 
œyî
, 
Boﬁ
 
Êag
 ) { 
m_HRD
[œyî].
fixedPicR©eWôhöCvsFœg
 = fœg; 
	}
}

365 
Boﬁ
 
	$gëFixedPicR©eWôhöCvsFœg
–
I¡
 
œyî
 ) c⁄° {  
m_HRD
[œyî].
fixedPicR©eWôhöCvsFœg
; 
	}
}

367 
Void
 
	$£tPicDuøti⁄InTcMöus1
–
I¡
 
œyî
, 
UI¡
 
vÆue
 ) { 
m_HRD
[œyî].
picDuøti⁄InTcMöus1
 = vÆue; 
	}
}

368 
UI¡
 
	$gëPicDuøti⁄InTcMöus1
–
I¡
 
œyî
 ) c⁄° {  
m_HRD
[œyî].
picDuøti⁄InTcMöus1
; 
	}
}

370 
Void
 
	$£tLowDñayHrdFœg
–
I¡
 
œyî
, 
Boﬁ
 
Êag
 ) { 
m_HRD
[œyî].
lowDñayHrdFœg
 = fœg; 
	}
}

371 
Boﬁ
 
	$gëLowDñayHrdFœg
–
I¡
 
œyî
 ) c⁄° {  
m_HRD
[œyî].
lowDñayHrdFœg
; 
	}
}

373 
Void
 
	$£tCpbC¡Möus1
–
I¡
 
œyî
, 
UI¡
 
vÆue
 ) { 
m_HRD
[œyî].
˝bC¡Möus1
 = vÆue; 
	}
}

374 
UI¡
 
	$gëCpbC¡Möus1
–
I¡
 
œyî
 ) c⁄° {  
m_HRD
[œyî].
˝bC¡Möus1
; 
	}
}

376 
Void
 
	$£tBôR©eVÆueMöus1
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
, 
UI¡
 
vÆue
 ) { 
m_HRD
[œyî].
bôR©eVÆueMöus1
[˝b˙t][«lOrV˛] = vÆue; 
	}
}

377 
UI¡
 
	$gëBôR©eVÆueMöus1
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
 ) c⁄° {  
m_HRD
[œyî].
bôR©eVÆueMöus1
[˝b˙t][«lOrV˛]; 
	}
}

379 
Void
 
	$£tCpbSizeVÆueMöus1
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
, 
UI¡
 
vÆue
 ) { 
m_HRD
[œyî].
˝bSizeVÆue
[˝b˙t][«lOrV˛] = vÆue; 
	}
}

380 
UI¡
 
	$gëCpbSizeVÆueMöus1
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
 ) c⁄° {  
m_HRD
[œyî].
˝bSizeVÆue
[˝b˙t][«lOrV˛]; 
	}
}

381 
Void
 
	$£tDuCpbSizeVÆueMöus1
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
, 
UI¡
 
vÆue
 ) { 
m_HRD
[œyî].
du˝bSizeVÆue
[˝b˙t][«lOrV˛] = vÆue; 
	}
}

382 
UI¡
 
	$gëDuCpbSizeVÆueMöus1
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
 ) c⁄° {  
m_HRD
[œyî].
du˝bSizeVÆue
[˝b˙t][«lOrV˛]; 
	}
}

383 
Void
 
	$£tDuBôR©eVÆueMöus1
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
, 
UI¡
 
vÆue
 ) { 
m_HRD
[œyî].
duBôR©eVÆue
[˝b˙t][«lOrV˛] = vÆue; 
	}
}

384 
UI¡
 
	$gëDuBôR©eVÆueMöus1
(
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
 ) c⁄° {  
m_HRD
[œyî].
duBôR©eVÆue
[˝b˙t][«lOrV˛]; 
	}
}

385 
Void
 
	$£tCbrFœg
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
, 
Boﬁ
 
vÆue
 ) { 
m_HRD
[œyî].
cbrFœg
[˝b˙t][«lOrV˛] = vÆue; 
	}
}

386 
Boﬁ
 
	$gëCbrFœg
–
I¡
 
œyî
, I¡ 
˝b˙t
, I¡ 
«lOrV˛
 ) c⁄° {  
m_HRD
[œyî].
cbrFœg
[˝b˙t][«lOrV˛]; 
	}
}

388 
Boﬁ
 
	$gëCpbDpbDñaysPª£¡Fœg
–Ëc⁄° {  
	`gëNÆHrdP¨amëîsPª£¡Fœg
(Ë|| 
	`gëV˛HrdP¨amëîsPª£¡Fœg
(); 
	}
}

391 ˛as†
	cTimögInfo


393 
Boﬁ
 
	mm_timögInfoPª£¡Fœg
;

394 
UI¡
 
	mm_numUnôsInTick
;

395 
UI¡
 
	mm_timeSˇÀ
;

396 
Boﬁ
 
	mm_pocPr›‹ti⁄ÆToTimögFœg
;

397 
I¡
 
	mm_numTicksPocDiffO√Möus1
;

398 
	mpublic
:

399 
	$TimögInfo
()

400 : 
	`m_timögInfoPª£¡Fœg
 (
Ál£
)

401 , 
	`m_numUnôsInTick
 (1001)

402 , 
	`m_timeSˇÀ
 (60000)

403 , 
	`m_pocPr›‹ti⁄ÆToTimögFœg
(
Ál£
)

404 , 
	$m_numTicksPocDiffO√Möus1
 (0)

407 
Void
 
	$£tTimögInfoPª£¡Fœg
–
Boﬁ
 
Êag
 ) { 
m_timögInfoPª£¡Fœg
 = fœg; 
	}
}

408 
Boﬁ
 
	$gëTimögInfoPª£¡Fœg
–Ëc⁄° {  
m_timögInfoPª£¡Fœg
; 
	}
}

410 
Void
 
	$£tNumUnôsInTick
–
UI¡
 
vÆue
 ) { 
m_numUnôsInTick
 = vÆue; 
	}
}

411 
UI¡
 
	$gëNumUnôsInTick
–Ëc⁄° {  
m_numUnôsInTick
; 
	}
}

413 
Void
 
	$£tTimeSˇÀ
–
UI¡
 
vÆue
 ) { 
m_timeSˇÀ
 = vÆue; 
	}
}

414 
UI¡
 
	$gëTimeSˇÀ
–Ëc⁄° {  
m_timeSˇÀ
; 
	}
}

416 
Void
 
	$£tPocPr›‹ti⁄ÆToTimögFœg
(
Boﬁ
 
x
Ë{ 
m_pocPr›‹ti⁄ÆToTimögFœg
 = x; 
	}
}

417 
Boﬁ
 
	$gëPocPr›‹ti⁄ÆToTimögFœg
–Ëc⁄° {  
m_pocPr›‹ti⁄ÆToTimögFœg
; 
	}
}

419 
Void
 
	$£tNumTicksPocDiffO√Möus1
(
I¡
 
x
Ë{ 
m_numTicksPocDiffO√Möus1
 = x; 
	}
}

420 
I¡
 
	$gëNumTicksPocDiffO√Möus1
–Ëc⁄° {  
m_numTicksPocDiffO√Möus1
; 
	}
}

423 
	sChromaQpAdj


428 
I¡
 
	mCbOff£t
;

429 
I¡
 
	mCrOff£t
;

430 } 
	mcomp
;

431 
I¡
 
	moff£t
[2];

432 } 
	mu
;

435 ˛as†
	cTComVPS


437 
	m¥iv©e
:

438 
I¡
 
m_VPSId
;

439 
UI¡
 
	mm_uiMaxTLayîs
;

440 
UI¡
 
	mm_uiMaxLayîs
;

441 
Boﬁ
 
	mm_bTemp‹ÆIdNe°ögFœg
;

443 
UI¡
 
	mm_numRe‹dîPics
[
MAX_TLAYER
];

444 
UI¡
 
	mm_uiMaxDecPicBuf„rög
[
MAX_TLAYER
];

445 
UI¡
 
	mm_uiMaxL©ícyIn¸ó£
[
MAX_TLAYER
];

447 
UI¡
 
	mm_numHrdP¨amëîs
;

448 
UI¡
 
	mm_maxNuhRe£rvedZîoLayîId
;

449 
	m°d
::
ve˘‹
<
TComHRD
> 
m_hrdP¨amëîs
;

450 
	m°d
::
ve˘‹
<
UI¡
> 
m_hrdOpSëIdx
;

451 
	m°d
::
ve˘‹
<
Boﬁ
> 
m_˝rmsPª£¡Fœg
;

452 
UI¡
 
	mm_numOpSës
;

453 
Boﬁ
 
	mm_œyîIdIn˛udedFœg
[
MAX_VPS_OP_SETS_PLUS1
][
MAX_VPS_NUH_RESERVED_ZERO_LAYER_ID_PLUS1
];

455 
TComPTL
 
	mm_pcPTL
;

456 
TimögInfo
 
	mm_timögInfo
;

458 
	mpublic
:

459 
TComVPS
();

461 
	mvútuÆ
 ~
TComVPS
();

463 
Void
 
	$¸óãHrdP¨amBuf„r
()

465 
m_hrdP¨amëîs
.
	`ªsize
(
	`gëNumHrdP¨amëîs
());

466 
m_hrdOpSëIdx
.
	`ªsize
(
	`gëNumHrdP¨amëîs
());

467 
m_˝rmsPª£¡Fœg
.
	`ªsize
(
	`gëNumHrdP¨amëîs
());

470 
TComHRD
* 
	$gëHrdP¨amëîs
–
UI¡
 
i
 ) {  &
m_hrdP¨amëîs
[ i ]; 
	}
}

471 c⁄° 
TComHRD
* 
	$gëHrdP¨amëîs
–
UI¡
 
i
 ) c⁄° {  &
m_hrdP¨amëîs
[ i ]; 
	}
}

472 
UI¡
 
	$gëHrdOpSëIdx
–
UI¡
 
i
 ) c⁄° {  
m_hrdOpSëIdx
[ i ]; 
	}
}

473 
Void
 
	$£tHrdOpSëIdx
–
UI¡
 
vÆ
, UI¡ 
i
 ) { 
m_hrdOpSëIdx
[ i ] = vÆ; 
	}
}

474 
Boﬁ
 
	$gëC¥msPª£¡Fœg
–
UI¡
 
i
 ) c⁄° {  
m_˝rmsPª£¡Fœg
[ i ]; 
	}
}

475 
Void
 
	$£tC¥msPª£¡Fœg
–
Boﬁ
 
vÆ
, 
UI¡
 
i
 ) { 
m_˝rmsPª£¡Fœg
[ i ] = vÆ; 
	}
}

477 
I¡
 
	$gëVPSId
(Ëc⁄° {  
m_VPSId
; 
	}
}

478 
Void
 
	$£tVPSId
(
I¡
 
i
Ë{ 
m_VPSId
 = i; 
	}
}

480 
UI¡
 
	$gëMaxTLayîs
(Ëc⁄° {  
m_uiMaxTLayîs
; 
	}
}

481 
Void
 
	$£tMaxTLayîs
(
UI¡
 
t
Ë{ 
m_uiMaxTLayîs
 =Å; 
	}
}

483 
UI¡
 
	$gëMaxLayîs
(Ëc⁄° {  
m_uiMaxLayîs
; 
	}
}

484 
Void
 
	$£tMaxLayîs
(
UI¡
 
l
Ë{ 
m_uiMaxLayîs
 =Ü; 
	}
}

486 
Boﬁ
 
	$gëTemp‹ÆNe°ögFœg
(Ëc⁄° {  
m_bTemp‹ÆIdNe°ögFœg
; 
	}
}

487 
Void
 
	$£tTemp‹ÆNe°ögFœg
(
Boﬁ
 
t
Ë{ 
m_bTemp‹ÆIdNe°ögFœg
 =Å; 
	}
}

489 
Void
 
	$£tNumRe‹dîPics
(
UI¡
 
v
, UI¡ 
tLayî
Ë{ 
m_numRe‹dîPics
[tLayî] = v; 
	}
}

490 
UI¡
 
	$gëNumRe‹dîPics
(
UI¡
 
tLayî
Ëc⁄° {  
m_numRe‹dîPics
[tLayî]; 
	}
}

492 
Void
 
	$£tMaxDecPicBuf„rög
(
UI¡
 
v
, UI¡ 
tLayî
Ë{ 
	`as£π
—Layî < 
MAX_TLAYER
); 
m_uiMaxDecPicBuf„rög
[tLayî] = v; 
	}
}

493 
UI¡
 
	$gëMaxDecPicBuf„rög
(
UI¡
 
tLayî
Ëc⁄° {  
m_uiMaxDecPicBuf„rög
[tLayî]; 
	}
}

495 
Void
 
	$£tMaxL©ícyIn¸ó£
(
UI¡
 
v
, UI¡ 
tLayî
Ë{ 
m_uiMaxL©ícyIn¸ó£
[tLayî] = v; 
	}
}

496 
UI¡
 
	$gëMaxL©ícyIn¸ó£
(
UI¡
 
tLayî
Ëc⁄° {  
m_uiMaxL©ícyIn¸ó£
[tLayî]; 
	}
}

498 
UI¡
 
	$gëNumHrdP¨amëîs
(Ëc⁄° {  
m_numHrdP¨amëîs
; 
	}
}

499 
Void
 
	$£tNumHrdP¨amëîs
(
UI¡
 
v
Ë{ 
m_numHrdP¨amëîs
 = v; 
	}
}

501 
UI¡
 
	$gëMaxNuhRe£rvedZîoLayîId
(Ëc⁄° {  
m_maxNuhRe£rvedZîoLayîId
; 
	}
}

502 
Void
 
	$£tMaxNuhRe£rvedZîoLayîId
(
UI¡
 
v
Ë{ 
m_maxNuhRe£rvedZîoLayîId
 = v; 
	}
}

504 
UI¡
 
	$gëMaxOpSës
(Ëc⁄° {  
m_numOpSës
; 
	}
}

505 
Void
 
	$£tMaxOpSës
(
UI¡
 
v
Ë{ 
m_numOpSës
 = v; 
	}
}

506 
Boﬁ
 
	$gëLayîIdIn˛udedFœg
(
UI¡
 
›sIdx
, UI¡ 
id
Ëc⁄° {  
m_œyîIdIn˛udedFœg
[›sIdx][id]; 
	}
}

507 
Void
 
	$£tLayîIdIn˛udedFœg
(
Boﬁ
 
v
, 
UI¡
 
›sIdx
, UI¡ 
id
Ë{ 
m_œyîIdIn˛udedFœg
[›sIdx][id] = v; 
	}
}

509 
TComPTL
* 
	$gëPTL
(Ë{  &
m_pcPTL
; 
	}
}

510 c⁄° 
TComPTL
* 
	$gëPTL
(Ëc⁄° {  &
m_pcPTL
; 
	}
}

511 
TimögInfo
* 
	$gëTimögInfo
(Ë{  &
m_timögInfo
; 
	}
}

512 c⁄° 
TimögInfo
* 
	$gëTimögInfo
(Ëc⁄° {  &
m_timögInfo
; 
	}
}

515 ˛as†
	cTComVUI


517 
	m¥iv©e
:

518 
Boﬁ
 
m_a•e˘R©ioInfoPª£¡Fœg
;

519 
I¡
 
	mm_a•e˘R©ioIdc
;

520 
I¡
 
	mm_ßrWidth
;

521 
I¡
 
	mm_ßrHeight
;

522 
Boﬁ
 
	mm_ovîsˇnInfoPª£¡Fœg
;

523 
Boﬁ
 
	mm_ovîsˇnAµr›rüãFœg
;

524 
Boﬁ
 
	mm_videoSig«lTy≥Pª£¡Fœg
;

525 
I¡
 
	mm_videoF‹m©
;

526 
Boﬁ
 
	mm_videoFuŒR™geFœg
;

527 
Boﬁ
 
	mm_cﬁourDes¸ùti⁄Pª£¡Fœg
;

528 
I¡
 
	mm_cﬁourPrim¨õs
;

529 
I¡
 
	mm_å™s„rCh¨a˘îi°ics
;

530 
I¡
 
	mm_m©rixC€fficõ¡s
;

531 
Boﬁ
 
	mm_chromaLocInfoPª£¡Fœg
;

532 
I¡
 
	mm_chromaSam∂eLocTy≥T›Fõld
;

533 
I¡
 
	mm_chromaSam∂eLocTy≥BŸtomFõld
;

534 
Boﬁ
 
	mm_√uåÆChromaIndiˇti⁄Fœg
;

535 
Boﬁ
 
	mm_fõldSeqFœg
;

536 
Wödow
 
	mm_deÁu…Di•œyWödow
;

537 
Boﬁ
 
	mm_‰ameFõldInfoPª£¡Fœg
;

538 
Boﬁ
 
	mm_hrdP¨amëîsPª£¡Fœg
;

539 
Boﬁ
 
	mm_bô°ªamRe°ri˘i⁄Fœg
;

540 
Boﬁ
 
	mm_tûesFixedSåu˘uªFœg
;

541 
Boﬁ
 
	mm_mŸi⁄Ve˘‹sOvîPicBound¨õsFœg
;

542 
Boﬁ
 
	mm_ª°ri˘edRefPicLi°sFœg
;

543 
I¡
 
	mm_möS∑tülSegmíèti⁄Idc
;

544 
I¡
 
	mm_maxByãsPîPicDíom
;

545 
I¡
 
	mm_maxBôsPîMöCuDíom
;

546 
I¡
 
	mm_log2MaxMvLígthH‹iz⁄èl
;

547 
I¡
 
	mm_log2MaxMvLígthVîtiˇl
;

548 
TComHRD
 
	mm_hrdP¨amëîs
;

549 
TimögInfo
 
	mm_timögInfo
;

551 
	mpublic
:

552 
	$TComVUI
()

553 : 
	`m_a•e˘R©ioInfoPª£¡Fœg
 (
Ál£
)

554 , 
	`m_a•e˘R©ioIdc
 (0)

555 , 
	`m_ßrWidth
 (0)

556 , 
	`m_ßrHeight
 (0)

557 , 
	`m_ovîsˇnInfoPª£¡Fœg
 (
Ál£
)

558 , 
	`m_ovîsˇnAµr›rüãFœg
 (
Ál£
)

559 , 
	`m_videoSig«lTy≥Pª£¡Fœg
 (
Ál£
)

560 , 
	`m_videoF‹m©
 (5)

561 , 
	`m_videoFuŒR™geFœg
 (
Ál£
)

562 , 
	`m_cﬁourDes¸ùti⁄Pª£¡Fœg
 (
Ál£
)

563 , 
	`m_cﬁourPrim¨õs
 (2)

564 , 
	`m_å™s„rCh¨a˘îi°ics
 (2)

565 , 
	`m_m©rixC€fficõ¡s
 (2)

566 , 
	`m_chromaLocInfoPª£¡Fœg
 (
Ál£
)

567 , 
	`m_chromaSam∂eLocTy≥T›Fõld
 (0)

568 , 
	`m_chromaSam∂eLocTy≥BŸtomFõld
 (0)

569 , 
	`m_√uåÆChromaIndiˇti⁄Fœg
 (
Ál£
)

570 , 
	`m_fõldSeqFœg
 (
Ál£
)

571 , 
	`m_‰ameFõldInfoPª£¡Fœg
 (
Ál£
)

572 , 
	`m_hrdP¨amëîsPª£¡Fœg
 (
Ál£
)

573 , 
	`m_bô°ªamRe°ri˘i⁄Fœg
 (
Ál£
)

574 , 
	`m_tûesFixedSåu˘uªFœg
 (
Ál£
)

575 , 
	`m_mŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(
åue
)

576 , 
	`m_ª°ri˘edRefPicLi°sFœg
 (1)

577 , 
	`m_möS∑tülSegmíèti⁄Idc
 (0)

578 , 
	`m_maxByãsPîPicDíom
 (2)

579 , 
	`m_maxBôsPîMöCuDíom
 (1)

580 , 
	`m_log2MaxMvLígthH‹iz⁄èl
 (15)

581 , 
	$m_log2MaxMvLígthVîtiˇl
 (15)

584 
vútuÆ
 ~
	$TComVUI
(Ë{
	}
}

586 
Boﬁ
 
	$gëA•e˘R©ioInfoPª£¡Fœg
(Ëc⁄° {  
m_a•e˘R©ioInfoPª£¡Fœg
; 
	}
}

587 
Void
 
	$£tA•e˘R©ioInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_a•e˘R©ioInfoPª£¡Fœg
 = i; 
	}
}

589 
I¡
 
	$gëA•e˘R©ioIdc
(Ëc⁄° {  
m_a•e˘R©ioIdc
; 
	}
}

590 
Void
 
	$£tA•e˘R©ioIdc
(
I¡
 
i
Ë{ 
m_a•e˘R©ioIdc
 = i; 
	}
}

592 
I¡
 
	$gëS¨Width
(Ëc⁄° {  
m_ßrWidth
; 
	}
}

593 
Void
 
	$£tS¨Width
(
I¡
 
i
Ë{ 
m_ßrWidth
 = i; 
	}
}

595 
I¡
 
	$gëS¨Height
(Ëc⁄° {  
m_ßrHeight
; 
	}
}

596 
Void
 
	$£tS¨Height
(
I¡
 
i
Ë{ 
m_ßrHeight
 = i; 
	}
}

598 
Boﬁ
 
	$gëOvîsˇnInfoPª£¡Fœg
(Ëc⁄° {  
m_ovîsˇnInfoPª£¡Fœg
; 
	}
}

599 
Void
 
	$£tOvîsˇnInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_ovîsˇnInfoPª£¡Fœg
 = i; 
	}
}

601 
Boﬁ
 
	$gëOvîsˇnAµr›rüãFœg
(Ëc⁄° {  
m_ovîsˇnAµr›rüãFœg
; 
	}
}

602 
Void
 
	$£tOvîsˇnAµr›rüãFœg
(
Boﬁ
 
i
Ë{ 
m_ovîsˇnAµr›rüãFœg
 = i; 
	}
}

604 
Boﬁ
 
	$gëVideoSig«lTy≥Pª£¡Fœg
(Ëc⁄° {  
m_videoSig«lTy≥Pª£¡Fœg
; 
	}
}

605 
Void
 
	$£tVideoSig«lTy≥Pª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_videoSig«lTy≥Pª£¡Fœg
 = i; 
	}
}

607 
I¡
 
	$gëVideoF‹m©
(Ëc⁄° {  
m_videoF‹m©
; 
	}
}

608 
Void
 
	$£tVideoF‹m©
(
I¡
 
i
Ë{ 
m_videoF‹m©
 = i; 
	}
}

610 
Boﬁ
 
	$gëVideoFuŒR™geFœg
(Ëc⁄° {  
m_videoFuŒR™geFœg
; 
	}
}

611 
Void
 
	$£tVideoFuŒR™geFœg
(
Boﬁ
 
i
Ë{ 
m_videoFuŒR™geFœg
 = i; 
	}
}

613 
Boﬁ
 
	$gëCﬁourDes¸ùti⁄Pª£¡Fœg
(Ëc⁄° {  
m_cﬁourDes¸ùti⁄Pª£¡Fœg
; 
	}
}

614 
Void
 
	$£tCﬁourDes¸ùti⁄Pª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_cﬁourDes¸ùti⁄Pª£¡Fœg
 = i; 
	}
}

616 
I¡
 
	$gëCﬁourPrim¨õs
(Ëc⁄° {  
m_cﬁourPrim¨õs
; 
	}
}

617 
Void
 
	$£tCﬁourPrim¨õs
(
I¡
 
i
Ë{ 
m_cﬁourPrim¨õs
 = i; 
	}
}

619 
I¡
 
	$gëTøns„rCh¨a˘îi°ics
(Ëc⁄° {  
m_å™s„rCh¨a˘îi°ics
; 
	}
}

620 
Void
 
	$£tTøns„rCh¨a˘îi°ics
(
I¡
 
i
Ë{ 
m_å™s„rCh¨a˘îi°ics
 = i; 
	}
}

622 
I¡
 
	$gëM©rixC€fficõ¡s
(Ëc⁄° {  
m_m©rixC€fficõ¡s
; 
	}
}

623 
Void
 
	$£tM©rixC€fficõ¡s
(
I¡
 
i
Ë{ 
m_m©rixC€fficõ¡s
 = i; 
	}
}

625 
Boﬁ
 
	$gëChromaLocInfoPª£¡Fœg
(Ëc⁄° {  
m_chromaLocInfoPª£¡Fœg
; 
	}
}

626 
Void
 
	$£tChromaLocInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_chromaLocInfoPª£¡Fœg
 = i; 
	}
}

628 
I¡
 
	$gëChromaSam∂eLocTy≥T›Fõld
(Ëc⁄° {  
m_chromaSam∂eLocTy≥T›Fõld
; 
	}
}

629 
Void
 
	$£tChromaSam∂eLocTy≥T›Fõld
(
I¡
 
i
Ë{ 
m_chromaSam∂eLocTy≥T›Fõld
 = i; 
	}
}

631 
I¡
 
	$gëChromaSam∂eLocTy≥BŸtomFõld
(Ëc⁄° {  
m_chromaSam∂eLocTy≥BŸtomFõld
; 
	}
}

632 
Void
 
	$£tChromaSam∂eLocTy≥BŸtomFõld
(
I¡
 
i
Ë{ 
m_chromaSam∂eLocTy≥BŸtomFõld
 = i; 
	}
}

634 
Boﬁ
 
	$gëNeuåÆChromaIndiˇti⁄Fœg
(Ëc⁄° {  
m_√uåÆChromaIndiˇti⁄Fœg
; 
	}
}

635 
Void
 
	$£tNeuåÆChromaIndiˇti⁄Fœg
(
Boﬁ
 
i
Ë{ 
m_√uåÆChromaIndiˇti⁄Fœg
 = i; 
	}
}

637 
Boﬁ
 
	$gëFõldSeqFœg
(Ëc⁄° {  
m_fõldSeqFœg
; 
	}
}

638 
Void
 
	$£tFõldSeqFœg
(
Boﬁ
 
i
Ë{ 
m_fõldSeqFœg
 = i; 
	}
}

640 
Boﬁ
 
	$gëFømeFõldInfoPª£¡Fœg
(Ëc⁄° {  
m_‰ameFõldInfoPª£¡Fœg
; 
	}
}

641 
Void
 
	$£tFømeFõldInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_‰ameFõldInfoPª£¡Fœg
 = i; 
	}
}

643 
	gWödow
& 
	$gëDeÁu…Di•œyWödow
(Ë{  
m_deÁu…Di•œyWödow
; 
	}
}

644 c⁄° 
	gWödow
& 
	$gëDeÁu…Di•œyWödow
(Ëc⁄° {  
m_deÁu…Di•œyWödow
; 
	}
}

645 
Void
 
	$£tDeÁu…Di•œyWödow
(
Wödow
& 
deÁu…Di•œyWödow
 ) { 
m_deÁu…Di•œyWödow
 = deÁu…Di•œyWödow; 
	}
}

647 
Boﬁ
 
	$gëHrdP¨amëîsPª£¡Fœg
(Ëc⁄° {  
m_hrdP¨amëîsPª£¡Fœg
; 
	}
}

648 
Void
 
	$£tHrdP¨amëîsPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_hrdP¨amëîsPª£¡Fœg
 = i; 
	}
}

650 
Boﬁ
 
	$gëBô°ªamRe°ri˘i⁄Fœg
(Ëc⁄° {  
m_bô°ªamRe°ri˘i⁄Fœg
; 
	}
}

651 
Void
 
	$£tBô°ªamRe°ri˘i⁄Fœg
(
Boﬁ
 
i
Ë{ 
m_bô°ªamRe°ri˘i⁄Fœg
 = i; 
	}
}

653 
Boﬁ
 
	$gëTûesFixedSåu˘uªFœg
(Ëc⁄° {  
m_tûesFixedSåu˘uªFœg
; 
	}
}

654 
Void
 
	$£tTûesFixedSåu˘uªFœg
(
Boﬁ
 
i
Ë{ 
m_tûesFixedSåu˘uªFœg
 = i; 
	}
}

656 
Boﬁ
 
	$gëMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(Ëc⁄° {  
m_mŸi⁄Ve˘‹sOvîPicBound¨õsFœg
; 
	}
}

657 
Void
 
	$£tMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(
Boﬁ
 
i
Ë{ 
m_mŸi⁄Ve˘‹sOvîPicBound¨õsFœg
 = i; 
	}
}

659 
Boﬁ
 
	$gëRe°ri˘edRefPicLi°sFœg
(Ëc⁄° {  
m_ª°ri˘edRefPicLi°sFœg
; 
	}
}

660 
Void
 
	$£tRe°ri˘edRefPicLi°sFœg
(
Boﬁ
 
b
Ë{ 
m_ª°ri˘edRefPicLi°sFœg
 = b; 
	}
}

662 
I¡
 
	$gëMöS∑tülSegmíèti⁄Idc
(Ëc⁄° {  
m_möS∑tülSegmíèti⁄Idc
; 
	}
}

663 
Void
 
	$£tMöS∑tülSegmíèti⁄Idc
(
I¡
 
i
Ë{ 
m_möS∑tülSegmíèti⁄Idc
 = i; 
	}
}

665 
I¡
 
	$gëMaxByãsPîPicDíom
(Ëc⁄° {  
m_maxByãsPîPicDíom
; 
	}
}

666 
Void
 
	$£tMaxByãsPîPicDíom
(
I¡
 
i
Ë{ 
m_maxByãsPîPicDíom
 = i; 
	}
}

668 
I¡
 
	$gëMaxBôsPîMöCuDíom
(Ëc⁄° {  
m_maxBôsPîMöCuDíom
; 
	}
}

669 
Void
 
	$£tMaxBôsPîMöCuDíom
(
I¡
 
i
Ë{ 
m_maxBôsPîMöCuDíom
 = i; 
	}
}

671 
I¡
 
	$gëLog2MaxMvLígthH‹iz⁄èl
(Ëc⁄° {  
m_log2MaxMvLígthH‹iz⁄èl
; 
	}
}

672 
Void
 
	$£tLog2MaxMvLígthH‹iz⁄èl
(
I¡
 
i
Ë{ 
m_log2MaxMvLígthH‹iz⁄èl
 = i; 
	}
}

674 
I¡
 
	$gëLog2MaxMvLígthVîtiˇl
(Ëc⁄° {  
m_log2MaxMvLígthVîtiˇl
; 
	}
}

675 
Void
 
	$£tLog2MaxMvLígthVîtiˇl
(
I¡
 
i
Ë{ 
m_log2MaxMvLígthVîtiˇl
 = i; 
	}
}

677 
TComHRD
* 
	$gëHrdP¨amëîs
(Ë{  &
m_hrdP¨amëîs
; 
	}
}

678 c⁄° 
TComHRD
* 
	$gëHrdP¨amëîs
(Ëc⁄° {  &
m_hrdP¨amëîs
; 
	}
}

680 
TimögInfo
* 
	$gëTimögInfo
(Ë{  &
m_timögInfo
; 
	}
}

681 c⁄° 
TimögInfo
* 
	$gëTimögInfo
(Ëc⁄° {  &
m_timögInfo
; 
	}
}

685 ˛as†
	cTComSPSRExt


687 
	m¥iv©e
:

688 
Boﬁ
 
m_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
;

689 
Boﬁ
 
	mm_å™sf‹mSkùC⁄ãxtE«bÀdFœg
;

690 
Boﬁ
 
	mm_rdpcmE«bÀdFœg
[
NUMBER_OF_RDPCM_SIGNALLING_MODES
];

691 
Boﬁ
 
	mm_exãndedPªcisi⁄Pro˚ssögFœg
;

692 
Boﬁ
 
	mm_öåaSmoŸhögDißbÀdFœg
;

693 
Boﬁ
 
	mm_highPªcisi⁄Off£tsE«bÀdFœg
;

694 
Boﬁ
 
	mm_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
;

695 
Boﬁ
 
	mm_ˇbacBy∑ssAlignmítE«bÀdFœg
;

697 
	mpublic
:

698 
TComSPSRExt
();

700 
Boﬁ
 
	$£âögsDif„rFromDeÁu…s
() const

702  
	`gëTønsf‹mSkùRŸ©i⁄E«bÀdFœg
()

703 || 
	`gëTønsf‹mSkùC⁄ãxtE«bÀdFœg
()

704 || 
	`gëRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_IMPLICIT
)

705 || 
	`gëRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_EXPLICIT
)

706 || 
	`gëExãndedPªcisi⁄Pro˚ssögFœg
()

707 || 
	`gëI¡øSmoŸhögDißbÀdFœg
()

708 || 
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
()

709 || 
	`gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
()

710 || 
	`gëCabacBy∑ssAlignmítE«bÀdFœg
();

714 
Boﬁ
 
	$gëTønsf‹mSkùRŸ©i⁄E«bÀdFœg
(Ëc⁄° {  
m_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
; 
	}
}

715 
Void
 
	$£tTønsf‹mSkùRŸ©i⁄E«bÀdFœg
(c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
 = vÆue; 
	}
}

717 
Boﬁ
 
	$gëTønsf‹mSkùC⁄ãxtE«bÀdFœg
(Ëc⁄° {  
m_å™sf‹mSkùC⁄ãxtE«bÀdFœg
; 
	}
}

718 
Void
 
	$£tTønsf‹mSkùC⁄ãxtE«bÀdFœg
(c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_å™sf‹mSkùC⁄ãxtE«bÀdFœg
 = vÆue; 
	}
}

720 
Boﬁ
 
	$gëRdpcmE«bÀdFœg
(c⁄° 
RDPCMSig«ŒögMode
 
sig«ŒögMode
Ëc⁄° {  
m_rdpcmE«bÀdFœg
[sig«ŒögMode]; 
	}
}

721 
Void
 
	$£tRdpcmE«bÀdFœg
(c⁄° 
RDPCMSig«ŒögMode
 
sig«ŒögMode
, c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_rdpcmE«bÀdFœg
[sig«ŒögMode] = vÆue; 
	}
}

723 
Boﬁ
 
	$gëExãndedPªcisi⁄Pro˚ssögFœg
(Ëc⁄° {  
m_exãndedPªcisi⁄Pro˚ssögFœg
; 
	}
}

724 
Void
 
	$£tExãndedPªcisi⁄Pro˚ssögFœg
(
Boﬁ
 
vÆue
Ë{ 
m_exãndedPªcisi⁄Pro˚ssögFœg
 = vÆue; 
	}
}

726 
Boﬁ
 
	$gëI¡øSmoŸhögDißbÀdFœg
(Ëc⁄° {  
m_öåaSmoŸhögDißbÀdFœg
; 
	}
}

727 
Void
 
	$£tI¡øSmoŸhögDißbÀdFœg
(
Boﬁ
 
bVÆue
Ë{ 
m_öåaSmoŸhögDißbÀdFœg
=bVÆue; 
	}
}

729 
Boﬁ
 
	$gëHighPªcisi⁄Off£tsE«bÀdFœg
(Ëc⁄° {  
m_highPªcisi⁄Off£tsE«bÀdFœg
; 
	}
}

730 
Void
 
	$£tHighPªcisi⁄Off£tsE«bÀdFœg
(
Boﬁ
 
vÆue
Ë{ 
m_highPªcisi⁄Off£tsE«bÀdFœg
 = vÆue; 
	}
}

732 
Boﬁ
 
	$gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
(Ëc⁄° {  
m_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
; 
	}
}

733 
Void
 
	$£tPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
(c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
 = vÆue; 
	}
}

735 
Boﬁ
 
	$gëCabacBy∑ssAlignmítE«bÀdFœg
(Ëc⁄° {  
m_ˇbacBy∑ssAlignmítE«bÀdFœg
; 
	}
}

736 
Void
 
	$£tCabacBy∑ssAlignmítE«bÀdFœg
(c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_ˇbacBy∑ssAlignmítE«bÀdFœg
 = vÆue; 
	}
}

740 ˛as†
	cTComSPS


742 
	m¥iv©e
:

743 
I¡
 
m_SPSId
;

744 
I¡
 
	mm_VPSId
;

745 
ChromaF‹m©
 
	mm_chromaF‹m©Idc
;

747 
UI¡
 
	mm_uiMaxTLayîs
;

750 
UI¡
 
	mm_picWidthInLumaSam∂es
;

751 
UI¡
 
	mm_picHeightInLumaSam∂es
;

753 
I¡
 
	mm_log2MöCodögBlockSize
;

754 
I¡
 
	mm_log2DiffMaxMöCodögBlockSize
;

755 
UI¡
 
	mm_uiMaxCUWidth
;

756 
UI¡
 
	mm_uiMaxCUHeight
;

757 
UI¡
 
	mm_uiMaxTŸÆCUDïth
;

759 
Wödow
 
	mm_c⁄f‹m™˚Wödow
;

761 
TComRPSLi°
 
	mm_RPSLi°
;

762 
Boﬁ
 
	mm_bL⁄gTîmRefsPª£¡
;

763 
Boﬁ
 
	mm_SPSTemp‹ÆMVPE«bÀdFœg
;

764 
I¡
 
	mm_numRe‹dîPics
[
MAX_TLAYER
];

767 
UI¡
 
	mm_uiQuadåìTULog2MaxSize
;

768 
UI¡
 
	mm_uiQuadåìTULog2MöSize
;

769 
UI¡
 
	mm_uiQuadåìTUMaxDïthI¡î
;

770 
UI¡
 
	mm_uiQuadåìTUMaxDïthI¡ø
;

771 
Boﬁ
 
	mm_u£PCM
;

772 
UI¡
 
	mm_pcmLog2MaxSize
;

773 
UI¡
 
	mm_uiPCMLog2MöSize
;

774 
Boﬁ
 
	mm_u£AMP
;

777 
BôDïths
 
	mm_bôDïths
;

778 
I¡
 
	mm_qpBDOff£t
[
MAX_NUM_CHANNEL_TYPE
];

779 
I¡
 
	mm_pcmBôDïths
[
MAX_NUM_CHANNEL_TYPE
];

780 
Boﬁ
 
	mm_bPCMFûãrDißbÀFœg
;

782 
UI¡
 
	mm_uiBôsF‹POC
;

783 
UI¡
 
	mm_numL⁄gTîmRefPicSPS
;

784 
UI¡
 
	mm_…RefPicPocLsbSps
[
MAX_NUM_LONG_TERM_REF_PICS
];

785 
Boﬁ
 
	mm_u£dByCuºPicLtSPSFœg
[
MAX_NUM_LONG_TERM_REF_PICS
];

787 
UI¡
 
	mm_uiMaxTrSize
;

789 
Boﬁ
 
	mm_bU£SAO
;

791 
Boﬁ
 
	mm_bTemp‹ÆIdNe°ögFœg
;

793 
Boﬁ
 
	mm_sˇlögLi°E«bÀdFœg
;

794 
Boﬁ
 
	mm_sˇlögLi°Pª£¡Fœg
;

795 
TComSˇlögLi°
 
	mm_sˇlögLi°
;

796 
UI¡
 
	mm_uiMaxDecPicBuf„rög
[
MAX_TLAYER
];

797 
UI¡
 
	mm_uiMaxL©ícyIn¸ó£Plus1
[
MAX_TLAYER
];

799 
Boﬁ
 
	mm_u£Så⁄gI¡øSmoŸhög
;

801 
Boﬁ
 
	mm_vuiP¨amëîsPª£¡Fœg
;

802 
TComVUI
 
	mm_vuiP¨amëîs
;

804 
TComSPSRExt
 
	mm_•sR™geExãnsi⁄
;

806 c⁄° 
I¡
 
	mm_wöUnôX
[
NUM_CHROMA_FORMAT
];

807 c⁄° 
I¡
 
	mm_wöUnôY
[
NUM_CHROMA_FORMAT
];

808 
TComPTL
 
	mm_pcPTL
;

810 #i‡
O0043_BEST_EFFORT_DECODING


811 
UI¡
 
	mm_f‹˚DecodeBôDïth
;

814 
	mpublic
:

815 
TComSPS
();

816 
	mvútuÆ
 ~
TComSPS
();

817 #i‡
O0043_BEST_EFFORT_DECODING


818 
Void
 
	$£tF‹˚DecodeBôDïth
(
UI¡
 
bôDïth
Ë{ 
m_f‹˚DecodeBôDïth
 = bitDepth; }

819 
UI¡
 
	$gëF‹˚DecodeBôDïth
(Ëc⁄° {  
m_f‹˚DecodeBôDïth
; 
	}
}

822 
I¡
 
	$gëVPSId
(Ëc⁄° {  
m_VPSId
; 
	}
}

823 
Void
 
	$£tVPSId
(
I¡
 
i
Ë{ 
m_VPSId
 = i; 
	}
}

824 
I¡
 
	$gëSPSId
(Ëc⁄° {  
m_SPSId
; 
	}
}

825 
Void
 
	$£tSPSId
(
I¡
 
i
Ë{ 
m_SPSId
 = i; 
	}
}

826 
ChromaF‹m©
 
	$gëChromaF‹m©Idc
 (Ëc⁄° {  
m_chromaF‹m©Idc
; 
	}
}

827 
Void
 
	$£tChromaF‹m©Idc
 (
ChromaF‹m©
 
i
Ë{ 
m_chromaF‹m©Idc
 = i; 
	}
}

829 
I¡
 
	$gëWöUnôX
 (
I¡
 
chromaF‹m©Idc
Ë{ 
	`as£π
 (chromaF‹m©Id¯>0 && chromaF‹m©Id¯< 
NUM_CHROMA_FORMAT
);  
m_wöUnôX
[chromaF‹m©Idc]; 
	}
}

830 
I¡
 
	$gëWöUnôY
 (
I¡
 
chromaF‹m©Idc
Ë{ 
	`as£π
 (chromaF‹m©Id¯>0 && chromaF‹m©Id¯< 
NUM_CHROMA_FORMAT
);  
m_wöUnôY
[chromaF‹m©Idc]; 
	}
}

833 
Void
 
	$£tPicWidthInLumaSam∂es
–
UI¡
 
u
 ) { 
m_picWidthInLumaSam∂es
 = u; 
	}
}

834 
UI¡
 
	$gëPicWidthInLumaSam∂es
(Ëc⁄° {  
m_picWidthInLumaSam∂es
; 
	}
}

835 
Void
 
	$£tPicHeightInLumaSam∂es
–
UI¡
 
u
 ) { 
m_picHeightInLumaSam∂es
 = u; 
	}
}

836 
UI¡
 
	$gëPicHeightInLumaSam∂es
(Ëc⁄° {  
m_picHeightInLumaSam∂es
; 
	}
}

838 
	gWödow
& 
	$gëC⁄f‹m™˚Wödow
(Ë{  
m_c⁄f‹m™˚Wödow
; 
	}
}

839 c⁄° 
	gWödow
& 
	$gëC⁄f‹m™˚Wödow
(Ëc⁄° {  
m_c⁄f‹m™˚Wödow
; 
	}
}

840 
Void
 
	$£tC⁄f‹m™˚Wödow
(
Wödow
& 
c⁄f‹m™˚Wödow
 ) { 
m_c⁄f‹m™˚Wödow
 = c⁄f‹m™˚Wödow; 
	}
}

842 
UI¡
 
	$gëNumL⁄gTîmRefPicSPS
(Ëc⁄° {  
m_numL⁄gTîmRefPicSPS
; 
	}
}

843 
Void
 
	$£tNumL⁄gTîmRefPicSPS
(
UI¡
 
vÆ
Ë{ 
m_numL⁄gTîmRefPicSPS
 = vÆ; 
	}
}

845 
UI¡
 
	$gëLtRefPicPocLsbSps
(
UI¡
 
ödex
Ëc⁄° { 
	`as£π
–ödex < 
MAX_NUM_LONG_TERM_REF_PICS
 );  
m_…RefPicPocLsbSps
[ödex]; 
	}
}

846 
Void
 
	$£tLtRefPicPocLsbSps
(
UI¡
 
ödex
, UI¡ 
vÆ
Ë{ 
	`as£π
–ödex < 
MAX_NUM_LONG_TERM_REF_PICS
 ); 
m_…RefPicPocLsbSps
[ödex] = vÆ; 
	}
}

848 
Boﬁ
 
	$gëU£dByCuºPicLtSPSFœg
(
I¡
 
i
Ëc⁄° { 
	`as£π
–ò< 
MAX_NUM_LONG_TERM_REF_PICS
 );  
m_u£dByCuºPicLtSPSFœg
[i]; 
	}
}

849 
Void
 
	$£tU£dByCuºPicLtSPSFœg
(
I¡
 
i
, 
Boﬁ
 
x
Ë{ 
	`as£π
–ò< 
MAX_NUM_LONG_TERM_REF_PICS
 ); 
m_u£dByCuºPicLtSPSFœg
[i] = x; 
	}
}

851 
I¡
 
	$gëLog2MöCodögBlockSize
(Ëc⁄° {  
m_log2MöCodögBlockSize
; 
	}
}

852 
Void
 
	$£tLog2MöCodögBlockSize
(
I¡
 
vÆ
Ë{ 
m_log2MöCodögBlockSize
 = vÆ; 
	}
}

853 
I¡
 
	$gëLog2DiffMaxMöCodögBlockSize
(Ëc⁄° {  
m_log2DiffMaxMöCodögBlockSize
; 
	}
}

854 
Void
 
	$£tLog2DiffMaxMöCodögBlockSize
(
I¡
 
vÆ
Ë{ 
m_log2DiffMaxMöCodögBlockSize
 = vÆ; 
	}
}

856 
Void
 
	$£tMaxCUWidth
–
UI¡
 
u
 ) { 
m_uiMaxCUWidth
 = u; 
	}
}

857 
UI¡
 
	$gëMaxCUWidth
(Ëc⁄° {  
m_uiMaxCUWidth
; 
	}
}

858 
Void
 
	$£tMaxCUHeight
–
UI¡
 
u
 ) { 
m_uiMaxCUHeight
 = u; 
	}
}

859 
UI¡
 
	$gëMaxCUHeight
(Ëc⁄° {  
m_uiMaxCUHeight
; 
	}
}

860 
Void
 
	$£tMaxTŸÆCUDïth
–
UI¡
 
u
 ) { 
m_uiMaxTŸÆCUDïth
 = u; 
	}
}

861 
UI¡
 
	$gëMaxTŸÆCUDïth
(Ëc⁄° {  
m_uiMaxTŸÆCUDïth
; 
	}
}

862 
Void
 
	$£tU£PCM
–
Boﬁ
 
b
 ) { 
m_u£PCM
 = b; 
	}
}

863 
Boﬁ
 
	$gëU£PCM
(Ëc⁄° {  
m_u£PCM
; 
	}
}

864 
Void
 
	$£tPCMLog2MaxSize
–
UI¡
 
u
 ) { 
m_pcmLog2MaxSize
 = u; 
	}
}

865 
UI¡
 
	$gëPCMLog2MaxSize
(Ëc⁄° {  
m_pcmLog2MaxSize
; 
	}
}

866 
Void
 
	$£tPCMLog2MöSize
–
UI¡
 
u
 ) { 
m_uiPCMLog2MöSize
 = u; 
	}
}

867 
UI¡
 
	$gëPCMLog2MöSize
(Ëc⁄° {  
m_uiPCMLog2MöSize
; 
	}
}

868 
Void
 
	$£tBôsF‹POC
–
UI¡
 
u
 ) { 
m_uiBôsF‹POC
 = u; 
	}
}

869 
UI¡
 
	$gëBôsF‹POC
(Ëc⁄° {  
m_uiBôsF‹POC
; 
	}
}

870 
Boﬁ
 
	$gëU£AMP
(Ëc⁄° {  
m_u£AMP
; 
	}
}

871 
Void
 
	$£tU£AMP
–
Boﬁ
 
b
 ) { 
m_u£AMP
 = b; 
	}
}

872 
Void
 
	$£tQuadåìTULog2MaxSize
–
UI¡
 
u
 ) { 
m_uiQuadåìTULog2MaxSize
 = u; 
	}
}

873 
UI¡
 
	$gëQuadåìTULog2MaxSize
(Ëc⁄° {  
m_uiQuadåìTULog2MaxSize
; 
	}
}

874 
Void
 
	$£tQuadåìTULog2MöSize
–
UI¡
 
u
 ) { 
m_uiQuadåìTULog2MöSize
 = u; 
	}
}

875 
UI¡
 
	$gëQuadåìTULog2MöSize
(Ëc⁄° {  
m_uiQuadåìTULog2MöSize
; 
	}
}

876 
Void
 
	$£tQuadåìTUMaxDïthI¡î
–
UI¡
 
u
 ) { 
m_uiQuadåìTUMaxDïthI¡î
 = u; 
	}
}

877 
Void
 
	$£tQuadåìTUMaxDïthI¡ø
–
UI¡
 
u
 ) { 
m_uiQuadåìTUMaxDïthI¡ø
 = u; 
	}
}

878 
UI¡
 
	$gëQuadåìTUMaxDïthI¡î
(Ëc⁄° {  
m_uiQuadåìTUMaxDïthI¡î
; 
	}
}

879 
UI¡
 
	$gëQuadåìTUMaxDïthI¡ø
(Ëc⁄° {  
m_uiQuadåìTUMaxDïthI¡ø
; 
	}
}

880 
Void
 
	$£tNumRe‹dîPics
(
I¡
 
i
, 
UI¡
 
éayî
Ë{ 
m_numRe‹dîPics
[éayî] = i; 
	}
}

881 
I¡
 
	$gëNumRe‹dîPics
(
UI¡
 
éayî
Ëc⁄° {  
m_numRe‹dîPics
[éayî]; 
	}
}

882 
Void
 
¸óãRPSLi°
–
I¡
 
numRPS
 );

883 c⁄° 
TComRPSLi°
* 
	$gëRPSLi°
(Ëc⁄° {  &
m_RPSLi°
; 
	}
}

884 
TComRPSLi°
* 
	$gëRPSLi°
(Ë{  &
m_RPSLi°
; 
	}
}

885 
Boﬁ
 
	$gëL⁄gTîmRefsPª£¡
(Ëc⁄° {  
m_bL⁄gTîmRefsPª£¡
; 
	}
}

886 
Void
 
	$£tL⁄gTîmRefsPª£¡
(
Boﬁ
 
b
Ë{ 
m_bL⁄gTîmRefsPª£¡
=b; 
	}
}

887 
Boﬁ
 
	$gëSPSTemp‹ÆMVPE«bÀdFœg
(Ëc⁄° {  
m_SPSTemp‹ÆMVPE«bÀdFœg
; 
	}
}

888 
Void
 
	$£tSPSTemp‹ÆMVPE«bÀdFœg
(
Boﬁ
 
b
Ë{ 
m_SPSTemp‹ÆMVPE«bÀdFœg
=b; 
	}
}

890 
Void
 
	$£tMaxTrSize
–
UI¡
 
u
 ) { 
m_uiMaxTrSize
 = u; 
	}
}

891 
UI¡
 
	$gëMaxTrSize
(Ëc⁄° {  
m_uiMaxTrSize
; 
	}
}

894 
I¡
 
	$gëBôDïth
(
Ch™√lTy≥
 
ty≥
Ëc⁄° {  
m_bôDïths
.
ªc⁄
[ty≥]; 
	}
}

895 
Void
 
	$£tBôDïth
(
Ch™√lTy≥
 
ty≥
, 
I¡
 
u
 ) { 
m_bôDïths
.
ªc⁄
[ty≥] = u; 
	}
}

896 #i‡
O0043_BEST_EFFORT_DECODING


897 
I¡
 
	$gëSåómBôDïth
(
Ch™√lTy≥
 
ty≥
Ëc⁄° {  
m_bôDïths
.
°ªam
[ty≥]; 
	}
}

898 
Void
 
	$£tSåómBôDïth
(
Ch™√lTy≥
 
ty≥
, 
I¡
 
u
 ) { 
m_bôDïths
.
°ªam
[ty≥] = u; 
	}
}

900 c⁄° 
	gBôDïths
& 
	$gëBôDïths
(Ëc⁄° {  
m_bôDïths
; 
	}
}

901 
I¡
 
	$gëMaxLog2TrDy«micR™ge
(
Ch™√lTy≥
 
ch™√lTy≥
Ëc⁄° {  
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
(Ë? 
°d
::
max
<
I¡
>(15, 
	`I¡
(
m_bôDïths
.
ªc⁄
[ch™√lTy≥] + 6)Ë: 15; 
	}
}

903 
I¡
 
	$gëDif„ª¡ülLumaChromaBôDïth
(Ëc⁄° {  
	`I¡
(
m_bôDïths
.
ªc⁄
[
CHANNEL_TYPE_LUMA
]Ë- I¡(m_bôDïths.ªc⁄[
CHANNEL_TYPE_CHROMA
]); 
	}
}

904 
I¡
 
	$gëQpBDOff£t
(
Ch™√lTy≥
 
ty≥
Ëc⁄° {  
m_qpBDOff£t
[ty≥]; 
	}
}

905 
Void
 
	$£tQpBDOff£t
(
Ch™√lTy≥
 
ty≥
, 
I¡
 
i
Ë{ 
m_qpBDOff£t
[ty≥] = i; 
	}
}

907 
Void
 
	$£tU£SAO
(
Boﬁ
 
bVÆ
Ë{ 
m_bU£SAO
 = bVÆ; 
	}
}

908 
Boﬁ
 
	$gëU£SAO
(Ëc⁄° {  
m_bU£SAO
; 
	}
}

910 
UI¡
 
	$gëMaxTLayîs
(Ëc⁄° {  
m_uiMaxTLayîs
; 
	}
}

911 
Void
 
	$£tMaxTLayîs
–
UI¡
 
uiMaxTLayîs
 ) { 
	`as£π
–uiMaxTLayî†<
MAX_TLAYER
 ); 
m_uiMaxTLayîs
 = uiMaxTLayîs; 
	}
}

913 
Boﬁ
 
	$gëTemp‹ÆIdNe°ögFœg
(Ëc⁄° {  
m_bTemp‹ÆIdNe°ögFœg
; 
	}
}

914 
Void
 
	$£tTemp‹ÆIdNe°ögFœg
–
Boﬁ
 
bVÆue
 ) { 
m_bTemp‹ÆIdNe°ögFœg
 = bVÆue; 
	}
}

915 
UI¡
 
	$gëPCMBôDïth
(
Ch™√lTy≥
 
ty≥
Ëc⁄° {  
m_pcmBôDïths
[ty≥]; 
	}
}

916 
Void
 
	$£tPCMBôDïth
(
Ch™√lTy≥
 
ty≥
, 
UI¡
 
u
Ë{ 
m_pcmBôDïths
[ty≥] = u; 
	}
}

917 
Void
 
	$£tPCMFûãrDißbÀFœg
–
Boﬁ
 
bVÆue
 ) { 
m_bPCMFûãrDißbÀFœg
 = bVÆue; 
	}
}

918 
Boﬁ
 
	$gëPCMFûãrDißbÀFœg
(Ëc⁄° {  
m_bPCMFûãrDißbÀFœg
; 
	}
}

920 
Boﬁ
 
	$gëSˇlögLi°Fœg
(Ëc⁄° {  
m_sˇlögLi°E«bÀdFœg
; 
	}
}

921 
Void
 
	$£tSˇlögLi°Fœg
–
Boﬁ
 
b
 ) { 
m_sˇlögLi°E«bÀdFœg
 = b; 
	}
}

922 
Boﬁ
 
	$gëSˇlögLi°Pª£¡Fœg
(Ëc⁄° {  
m_sˇlögLi°Pª£¡Fœg
; 
	}
}

923 
Void
 
	$£tSˇlögLi°Pª£¡Fœg
–
Boﬁ
 
b
 ) { 
m_sˇlögLi°Pª£¡Fœg
 = b; 
	}
}

924 
	gTComSˇlögLi°
& 
	$gëSˇlögLi°
(Ë{  
m_sˇlögLi°
; 
	}
}

925 c⁄° 
	gTComSˇlögLi°
& 
	$gëSˇlögLi°
(Ëc⁄° {  
m_sˇlögLi°
; 
	}
}

926 
UI¡
 
	$gëMaxDecPicBuf„rög
(
UI¡
 
éayî
Ëc⁄° {  
m_uiMaxDecPicBuf„rög
[éayî]; 
	}
}

927 
Void
 
	$£tMaxDecPicBuf„rög
–
UI¡
 
ui
, UI¡ 
éayî
 ) { 
	`as£π
—œyî < 
MAX_TLAYER
); 
m_uiMaxDecPicBuf„rög
[éayî] = ui; 
	}
}

928 
UI¡
 
	$gëMaxL©ícyIn¸ó£Plus1
(
UI¡
 
éayî
Ëc⁄° {  
m_uiMaxL©ícyIn¸ó£Plus1
[éayî]; 
	}
}

929 
Void
 
	$£tMaxL©ícyIn¸ó£Plus1
–
UI¡
 
ui
 , UI¡ 
éayî
Ë{ 
m_uiMaxL©ícyIn¸ó£Plus1
[éayî] = ui; 
	}
}

931 
Void
 
	$£tU£Så⁄gI¡øSmoŸhög
(
Boﬁ
 
bVÆ
Ë{ 
m_u£Så⁄gI¡øSmoŸhög
 = bVÆ; 
	}
}

932 
Boﬁ
 
	$gëU£Så⁄gI¡øSmoŸhög
(Ëc⁄° {  
m_u£Så⁄gI¡øSmoŸhög
; 
	}
}

934 
Boﬁ
 
	$gëVuiP¨amëîsPª£¡Fœg
(Ëc⁄° {  
m_vuiP¨amëîsPª£¡Fœg
; 
	}
}

935 
Void
 
	$£tVuiP¨amëîsPª£¡Fœg
(
Boﬁ
 
b
Ë{ 
m_vuiP¨amëîsPª£¡Fœg
 = b; 
	}
}

936 
TComVUI
* 
	$gëVuiP¨amëîs
(Ë{  &
m_vuiP¨amëîs
; 
	}
}

937 c⁄° 
TComVUI
* 
	$gëVuiP¨amëîs
(Ëc⁄° {  &
m_vuiP¨amëîs
; 
	}
}

938 c⁄° 
TComPTL
* 
	$gëPTL
(Ëc⁄° {  &
m_pcPTL
; 
	}
}

939 
TComPTL
* 
	$gëPTL
(Ë{  &
m_pcPTL
; 
	}
}

941 c⁄° 
	gTComSPSRExt
& 
	$gëSpsR™geExãnsi⁄
(Ëc⁄° {  
m_•sR™geExãnsi⁄
; 
	}
}

942 
	gTComSPSRExt
& 
	$gëSpsR™geExãnsi⁄
(Ë{  
m_•sR™geExãnsi⁄
; 
	}
}

948 ˛as†
	cTComRefPicLi°Modifiˇti⁄


950 
	m¥iv©e
:

951 
Boﬁ
 
m_ªfPicLi°Modifiˇti⁄FœgL0
;

952 
Boﬁ
 
	mm_ªfPicLi°Modifiˇti⁄FœgL1
;

953 
UI¡
 
	mm_RefPicSëIdxL0
[
REF_PIC_LIST_NUM_IDX
];

954 
UI¡
 
	mm_RefPicSëIdxL1
[
REF_PIC_LIST_NUM_IDX
];

956 
	mpublic
:

957 
TComRefPicLi°Modifiˇti⁄
();

958 
	mvútuÆ
 ~
TComRefPicLi°Modifiˇti⁄
();

960 
Boﬁ
 
	$gëRefPicLi°Modifiˇti⁄FœgL0
(Ëc⁄° {  
m_ªfPicLi°Modifiˇti⁄FœgL0
; }

961 
Void
 
	$£tRefPicLi°Modifiˇti⁄FœgL0
(
Boﬁ
 
Êag
Ë{ 
m_ªfPicLi°Modifiˇti⁄FœgL0
 = fœg; 
	}
}

962 
Boﬁ
 
	$gëRefPicLi°Modifiˇti⁄FœgL1
(Ëc⁄° {  
m_ªfPicLi°Modifiˇti⁄FœgL1
; 
	}
}

963 
Void
 
	$£tRefPicLi°Modifiˇti⁄FœgL1
(
Boﬁ
 
Êag
Ë{ 
m_ªfPicLi°Modifiˇti⁄FœgL1
 = fœg; 
	}
}

964 
UI¡
 
	$gëRefPicSëIdxL0
(
UI¡
 
idx
Ëc⁄° { 
	`as£π
(idx<
REF_PIC_LIST_NUM_IDX
);  
m_RefPicSëIdxL0
[idx]; 
	}
}

965 
Void
 
	$£tRefPicSëIdxL0
(
UI¡
 
idx
, UI¡ 
ªfPicSëIdx
Ë{ 
	`as£π
(idx<
REF_PIC_LIST_NUM_IDX
); 
m_RefPicSëIdxL0
[idx] =ÑefPicSëIdx; 
	}
}

966 
UI¡
 
	$gëRefPicSëIdxL1
(
UI¡
 
idx
Ëc⁄° { 
	`as£π
(idx<
REF_PIC_LIST_NUM_IDX
);  
m_RefPicSëIdxL1
[idx]; 
	}
}

967 
Void
 
	$£tRefPicSëIdxL1
(
UI¡
 
idx
, UI¡ 
ªfPicSëIdx
Ë{ 
	`as£π
(idx<
REF_PIC_LIST_NUM_IDX
); 
m_RefPicSëIdxL1
[idx] =ÑefPicSëIdx; 
	}
}

973 ˛as†
	cTComPPSRExt


975 
	m¥iv©e
:

976 
I¡
 
m_log2MaxTønsf‹mSkùBlockSize
;

977 
Boﬁ
 
	mm_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
;

980 
I¡
 
	mm_diffCuChromaQpOff£tDïth
;

981 
I¡
 
	mm_chromaQpOff£tLi°Lí
;

982 
ChromaQpAdj
 
	mm_ChromaQpAdjTabÀIn˛udögNuŒE¡ry
[1+
MAX_QP_OFFSET_LIST_SIZE
];

984 
UI¡
 
	mm_log2SaoOff£tSˇÀ
[
MAX_NUM_CHANNEL_TYPE
];

986 
	mpublic
:

987 
TComPPSRExt
();

989 
Boﬁ
 
	$£âögsDif„rFromDeÁu…s
(c⁄° 
boﬁ
 
bTønsf‹mSkùE«bÀdFœg
) const

991  (
bTønsf‹mSkùE«bÀdFœg
 && (
	`gëLog2MaxTønsf‹mSkùBlockSize
() !=2))

992 || (
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
() )

993 || (
	`gëChromaQpOff£tLi°E«bÀdFœg
() )

994 || (
	`gëLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_LUMA
) !=0 )

995 || (
	`gëLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_CHROMA
) !=0 );

998 
UI¡
 
	$gëLog2MaxTønsf‹mSkùBlockSize
(Ëc⁄° {  
m_log2MaxTønsf‹mSkùBlockSize
; 
	}
}

999 
Void
 
	$£tLog2MaxTønsf‹mSkùBlockSize
–
UI¡
 
u
 ) { 
m_log2MaxTønsf‹mSkùBlockSize
 = u; 
	}
}

1001 
Boﬁ
 
	$gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
(Ëc⁄° {  
m_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
; 
	}
}

1002 
Void
 
	$£tCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
(
Boﬁ
 
vÆue
Ë{ 
m_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
 = vÆue; 
	}
}

1004 
Void
 
	$˛órChromaQpOff£tLi°
(Ë{ 
m_chromaQpOff£tLi°Lí
 = 0; 
	}
}

1006 
UI¡
 
	$gëDiffCuChromaQpOff£tDïth
 (Ëc⁄° {  
m_diffCuChromaQpOff£tDïth
; 
	}
}

1007 
Void
 
	$£tDiffCuChromaQpOff£tDïth
 ( 
UI¡
 
u
 ) { 
m_diffCuChromaQpOff£tDïth
 = u; 
	}
}

1009 
Boﬁ
 
	$gëChromaQpOff£tLi°E«bÀdFœg
(Ëc⁄° {  
	`gëChromaQpOff£tLi°Lí
()>0; 
	}
}

1010 
I¡
 
	$gëChromaQpOff£tLi°Lí
(Ëc⁄° {  
m_chromaQpOff£tLi°Lí
; 
	}
}

1012 c⁄° 
	gChromaQpAdj
& 
	$gëChromaQpOff£tLi°E¡ry
–
I¡
 
cuChromaQpOff£tIdxPlus1
 ) const

1014 
	`as£π
(
cuChromaQpOff£tIdxPlus1
 < 
m_chromaQpOff£tLi°Lí
+1);

1015  
m_ChromaQpAdjTabÀIn˛udögNuŒE¡ry
[
cuChromaQpOff£tIdxPlus1
];

1016 
	}
}

1018 
Void
 
	$£tChromaQpOff£tLi°E¡ry
–
I¡
 
cuChromaQpOff£tIdxPlus1
, I¡ 
cbOff£t
, I¡ 
¸Off£t
 )

1020 
	`as£π
 (
cuChromaQpOff£tIdxPlus1
 !0 && cuChromaQpOff£tIdxPlus1 <
MAX_QP_OFFSET_LIST_SIZE
);

1021 
m_ChromaQpAdjTabÀIn˛udögNuŒE¡ry
[
cuChromaQpOff£tIdxPlus1
].
u
.
comp
.
CbOff£t
 = 
cbOff£t
;

1022 
m_ChromaQpAdjTabÀIn˛udögNuŒE¡ry
[
cuChromaQpOff£tIdxPlus1
].
u
.
comp
.
CrOff£t
 = 
¸Off£t
;

1023 
m_chromaQpOff£tLi°Lí
 = 
	`max
(m_chromaQpOff£tLi°Lí, 
cuChromaQpOff£tIdxPlus1
);

1024 
	}
}

1027 
UI¡
 
	$gëLog2SaoOff£tSˇÀ
(
Ch™√lTy≥
 
ty≥
Ëc⁄° {  
m_log2SaoOff£tSˇÀ
[ty≥]; 
	}
}

1028 
Void
 
	$£tLog2SaoOff£tSˇÀ
(
Ch™√lTy≥
 
ty≥
, 
UI¡
 
uiBôShi·
Ë{ 
m_log2SaoOff£tSˇÀ
[ty≥] = uiBôShi·; 
	}
}

1034 ˛as†
	cTComPPS


1036 
	m¥iv©e
:

1037 
I¡
 
m_PPSId
;

1038 
I¡
 
	mm_SPSId
;

1039 
I¡
 
	mm_picInôQPMöus26
;

1040 
Boﬁ
 
	mm_u£DQP
;

1041 
Boﬁ
 
	mm_bC⁄°øöedI¡øPªd
;

1042 
Boﬁ
 
	mm_bSli˚ChromaQpFœg
;

1045 
UI¡
 
	mm_uiMaxCuDQPDïth
;

1047 
I¡
 
	mm_chromaCbQpOff£t
;

1048 
I¡
 
	mm_chromaCrQpOff£t
;

1050 
UI¡
 
	mm_numRefIdxL0DeÁu…A˘ive
;

1051 
UI¡
 
	mm_numRefIdxL1DeÁu…A˘ive
;

1053 
Boﬁ
 
	mm_bU£WeightPªd
;

1054 
Boﬁ
 
	mm_u£WeighãdBiPªd
;

1055 
Boﬁ
 
	mm_OuçutFœgPª£¡Fœg
;

1056 
Boﬁ
 
	mm_Tønsqu™tBy∑ssE«bÀdFœg
;

1057 
Boﬁ
 
	mm_u£Tønsf‹mSkù
;

1058 
Boﬁ
 
	mm_dïídítSli˚SegmítsE«bÀdFœg
;

1059 
Boﬁ
 
	mm_tûesE«bÀdFœg
;

1060 
Boﬁ
 
	mm_íå›yCodögSyncE«bÀdFœg
;

1062 
Boﬁ
 
	mm_lo›FûãrA¸ossTûesE«bÀdFœg
;

1063 
Boﬁ
 
	mm_unif‹mS∑cögFœg
;

1064 
I¡
 
	mm_numTûeCﬁumnsMöus1
;

1065 
I¡
 
	mm_numTûeRowsMöus1
;

1066 
	m°d
::
ve˘‹
<
I¡
> 
m_tûeCﬁumnWidth
;

1067 
	m°d
::
ve˘‹
<
I¡
> 
m_tûeRowHeight
;

1069 
Boﬁ
 
	mm_signD©aHidögE«bÀdFœg
;

1071 
Boﬁ
 
	mm_ˇbacInôPª£¡Fœg
;

1073 
Boﬁ
 
	mm_¶i˚HódîExãnsi⁄Pª£¡Fœg
;

1074 
Boﬁ
 
	mm_lo›FûãrA¸ossSli˚sE«bÀdFœg
;

1075 
Boﬁ
 
	mm_deblockögFûãrC⁄åﬁPª£¡Fœg
;

1076 
Boﬁ
 
	mm_deblockögFûãrOvîrideE«bÀdFœg
;

1077 
Boﬁ
 
	mm_µsDeblockögFûãrDißbÀdFœg
;

1078 
I¡
 
	mm_deblockögFûãrBëaOff£tDiv2
;

1079 
I¡
 
	mm_deblockögFûãrTcOff£tDiv2
;

1080 
Boﬁ
 
	mm_sˇlögLi°Pª£¡Fœg
;

1081 
TComSˇlögLi°
 
	mm_sˇlögLi°
;

1082 
Boﬁ
 
	mm_li°sModifiˇti⁄Pª£¡Fœg
;

1083 
UI¡
 
	mm_log2P¨ÆÀlMîgeLevñMöus2
;

1084 
I¡
 
	mm_numExåaSli˚HódîBôs
;

1086 
TComPPSRExt
 
	mm_µsR™geExãnsi⁄
;

1088 
	mpublic
:

1089 
TComPPS
();

1090 
	mvútuÆ
 ~
TComPPS
();

1092 
I¡
 
	$gëPPSId
(Ëc⁄° {  
m_PPSId
; }

1093 
Void
 
	$£tPPSId
(
I¡
 
i
Ë{ 
m_PPSId
 = i; 
	}
}

1094 
I¡
 
	$gëSPSId
(Ëc⁄° {  
m_SPSId
; 
	}
}

1095 
Void
 
	$£tSPSId
(
I¡
 
i
Ë{ 
m_SPSId
 = i; 
	}
}

1097 
I¡
 
	$gëPicInôQPMöus26
(Ëc⁄° {  
m_picInôQPMöus26
; 
	}
}

1098 
Void
 
	$£tPicInôQPMöus26
–
I¡
 
i
 ) { 
m_picInôQPMöus26
 = i; 
	}
}

1099 
Boﬁ
 
	$gëU£DQP
(Ëc⁄° {  
m_u£DQP
; 
	}
}

1100 
Void
 
	$£tU£DQP
–
Boﬁ
 
b
 ) { 
m_u£DQP
 = b; 
	}
}

1101 
Boﬁ
 
	$gëC⁄°øöedI¡øPªd
(Ëc⁄° {  
m_bC⁄°øöedI¡øPªd
; 
	}
}

1102 
Void
 
	$£tC⁄°øöedI¡øPªd
–
Boﬁ
 
b
 ) { 
m_bC⁄°øöedI¡øPªd
 = b; 
	}
}

1103 
Boﬁ
 
	$gëSli˚ChromaQpFœg
(Ëc⁄° {  
m_bSli˚ChromaQpFœg
; 
	}
}

1104 
Void
 
	$£tSli˚ChromaQpFœg
–
Boﬁ
 
b
 ) { 
m_bSli˚ChromaQpFœg
 = b; 
	}
}

1106 
Void
 
	$£tMaxCuDQPDïth
–
UI¡
 
u
 ) { 
m_uiMaxCuDQPDïth
 = u; 
	}
}

1107 
UI¡
 
	$gëMaxCuDQPDïth
(Ëc⁄° {  
m_uiMaxCuDQPDïth
; 
	}
}

1109 
Void
 
	$£tQpOff£t
(
Comp⁄ítID
 
compID
, 
I¡
 
i
 )

1111 i‡(
compID
==
COMPONENT_Cb
)

1113 
m_chromaCbQpOff£t
 = 
i
;

1115 i‡(
compID
==
COMPONENT_Cr
)

1117 
m_chromaCrQpOff£t
 = 
i
;

1121 
	`as£π
(0);

1123 
	}
}

1124 
I¡
 
	$gëQpOff£t
(
Comp⁄ítID
 
compID
) const

1126  (
compID
==
COMPONENT_Y
Ë? 0 : (compID==
COMPONENT_Cb
 ? 
m_chromaCbQpOff£t
 : 
m_chromaCrQpOff£t
 );

1127 
	}
}

1129 
Void
 
	$£tNumRefIdxL0DeÁu…A˘ive
(
UI¡
 
ui
Ë{ 
m_numRefIdxL0DeÁu…A˘ive
=ui; 
	}
}

1130 
UI¡
 
	$gëNumRefIdxL0DeÁu…A˘ive
(Ëc⁄° {  
m_numRefIdxL0DeÁu…A˘ive
; 
	}
}

1131 
Void
 
	$£tNumRefIdxL1DeÁu…A˘ive
(
UI¡
 
ui
Ë{ 
m_numRefIdxL1DeÁu…A˘ive
=ui; 
	}
}

1132 
UI¡
 
	$gëNumRefIdxL1DeÁu…A˘ive
(Ëc⁄° {  
m_numRefIdxL1DeÁu…A˘ive
; 
	}
}

1134 
Boﬁ
 
	$gëU£WP
(Ëc⁄° {  
m_bU£WeightPªd
; 
	}
}

1135 
Boﬁ
 
	$gëWPBiPªd
(Ëc⁄° {  
m_u£WeighãdBiPªd
; 
	}
}

1136 
Void
 
	$£tU£WP
–
Boﬁ
 
b
 ) { 
m_bU£WeightPªd
 = b; 
	}
}

1137 
Void
 
	$£tWPBiPªd
–
Boﬁ
 
b
 ) { 
m_u£WeighãdBiPªd
 = b; 
	}
}

1139 
Void
 
	$£tOuçutFœgPª£¡Fœg
–
Boﬁ
 
b
 ) { 
m_OuçutFœgPª£¡Fœg
 = b; 
	}
}

1140 
Boﬁ
 
	$gëOuçutFœgPª£¡Fœg
(Ëc⁄° {  
m_OuçutFœgPª£¡Fœg
; 
	}
}

1141 
Void
 
	$£tTønsqu™tBy∑ssE«bÀdFœg
–
Boﬁ
 
b
 ) { 
m_Tønsqu™tBy∑ssE«bÀdFœg
 = b; 
	}
}

1142 
Boﬁ
 
	$gëTønsqu™tBy∑ssE«bÀdFœg
(Ëc⁄° {  
m_Tønsqu™tBy∑ssE«bÀdFœg
; 
	}
}

1144 
Boﬁ
 
	$gëU£Tønsf‹mSkù
(Ëc⁄° {  
m_u£Tønsf‹mSkù
; 
	}
}

1145 
Void
 
	$£tU£Tønsf‹mSkù
–
Boﬁ
 
b
 ) { 
m_u£Tønsf‹mSkù
 = b; 
	}
}

1147 
Void
 
	$£tLo›FûãrA¸ossTûesE«bÀdFœg
(
Boﬁ
 
b
Ë{ 
m_lo›FûãrA¸ossTûesE«bÀdFœg
 = b; 
	}
}

1148 
Boﬁ
 
	$gëLo›FûãrA¸ossTûesE«bÀdFœg
(Ëc⁄° {  
m_lo›FûãrA¸ossTûesE«bÀdFœg
; 
	}
}

1149 
Boﬁ
 
	$gëDïídítSli˚SegmítsE«bÀdFœg
(Ëc⁄° {  
m_dïídítSli˚SegmítsE«bÀdFœg
; 
	}
}

1150 
Void
 
	$£tDïídítSli˚SegmítsE«bÀdFœg
(
Boﬁ
 
vÆ
Ë{ 
m_dïídítSli˚SegmítsE«bÀdFœg
 = vÆ; 
	}
}

1151 
Boﬁ
 
	$gëE¡r›yCodögSyncE«bÀdFœg
(Ëc⁄° {  
m_íå›yCodögSyncE«bÀdFœg
; 
	}
}

1152 
Void
 
	$£tE¡r›yCodögSyncE«bÀdFœg
(
Boﬁ
 
vÆ
Ë{ 
m_íå›yCodögSyncE«bÀdFœg
 = vÆ; 
	}
}

1154 
Void
 
	$£tTûesE«bÀdFœg
(
Boﬁ
 
vÆ
Ë{ 
m_tûesE«bÀdFœg
 = vÆ; 
	}
}

1155 
Boﬁ
 
	$gëTûesE«bÀdFœg
(Ëc⁄° {  
m_tûesE«bÀdFœg
; 
	}
}

1156 
Void
 
	$£tTûeUnif‹mS∑cögFœg
(
Boﬁ
 
b
Ë{ 
m_unif‹mS∑cögFœg
 = b; 
	}
}

1157 
Boﬁ
 
	$gëTûeUnif‹mS∑cögFœg
(Ëc⁄° {  
m_unif‹mS∑cögFœg
; 
	}
}

1158 
Void
 
	$£tNumTûeCﬁumnsMöus1
(
I¡
 
i
Ë{ 
m_numTûeCﬁumnsMöus1
 = i; 
	}
}

1159 
I¡
 
	$gëNumTûeCﬁumnsMöus1
(Ëc⁄° {  
m_numTûeCﬁumnsMöus1
; 
	}
}

1160 
Void
 
£tTûeCﬁumnWidth
(c⁄° 
°d
::
ve˘‹
<
I¡
>& 
cﬁumnWidth
 ) { 
m_tûeCﬁumnWidth
 = columnWidth; }

1161 
UI¡
 
	$gëTûeCﬁumnWidth
(
UI¡
 
cﬁumnIdx
Ëc⁄° {  
m_tûeCﬁumnWidth
[cﬁumnIdx]; 
	}
}

1162 
Void
 
	$£tNumTûeRowsMöus1
(
I¡
 
i
Ë{ 
m_numTûeRowsMöus1
 = i; 
	}
}

1163 
I¡
 
	$gëNumTûeRowsMöus1
(Ëc⁄° {  
m_numTûeRowsMöus1
; 
	}
}

1164 
Void
 
£tTûeRowHeight
(c⁄° 
°d
::
ve˘‹
<
I¡
>& 
rowHeight
Ë{ 
m_tûeRowHeight
 =ÑowHeight; }

1165 
UI¡
 
	$gëTûeRowHeight
(
UI¡
 
rowIdx
Ëc⁄° {  
m_tûeRowHeight
[rowIdx]; 
	}
}

1167 
Void
 
	$£tSignD©aHidögE«bÀdFœg
–
Boﬁ
 
b
 ) { 
m_signD©aHidögE«bÀdFœg
 = b; 
	}
}

1168 
Boﬁ
 
	$gëSignD©aHidögE«bÀdFœg
(Ëc⁄° {  
m_signD©aHidögE«bÀdFœg
; 
	}
}

1170 
Void
 
	$£tCabacInôPª£¡Fœg
–
Boﬁ
 
Êag
 ) { 
m_ˇbacInôPª£¡Fœg
 = fœg; 
	}
}

1171 
Boﬁ
 
	$gëCabacInôPª£¡Fœg
(Ëc⁄° {  
m_ˇbacInôPª£¡Fœg
; 
	}
}

1172 
Void
 
	$£tDeblockögFûãrC⁄åﬁPª£¡Fœg
–
Boﬁ
 
vÆ
 ) { 
m_deblockögFûãrC⁄åﬁPª£¡Fœg
 = vÆ; 
	}
}

1173 
Boﬁ
 
	$gëDeblockögFûãrC⁄åﬁPª£¡Fœg
(Ëc⁄° {  
m_deblockögFûãrC⁄åﬁPª£¡Fœg
; 
	}
}

1174 
Void
 
	$£tDeblockögFûãrOvîrideE«bÀdFœg
–
Boﬁ
 
vÆ
 ) { 
m_deblockögFûãrOvîrideE«bÀdFœg
 = vÆ; 
	}
}

1175 
Boﬁ
 
	$gëDeblockögFûãrOvîrideE«bÀdFœg
(Ëc⁄° {  
m_deblockögFûãrOvîrideE«bÀdFœg
; 
	}
}

1176 
Void
 
	$£tPPSDeblockögFûãrDißbÀdFœg
(
Boﬁ
 
vÆ
Ë{ 
m_µsDeblockögFûãrDißbÀdFœg
 = vÆ; 
	}
}

1177 
Boﬁ
 
	$gëPPSDeblockögFûãrDißbÀdFœg
(Ëc⁄° {  
m_µsDeblockögFûãrDißbÀdFœg
; 
	}
}

1178 
Void
 
	$£tDeblockögFûãrBëaOff£tDiv2
(
I¡
 
vÆ
Ë{ 
m_deblockögFûãrBëaOff£tDiv2
 = vÆ; 
	}
}

1179 
I¡
 
	$gëDeblockögFûãrBëaOff£tDiv2
(Ëc⁄° {  
m_deblockögFûãrBëaOff£tDiv2
; 
	}
}

1180 
Void
 
	$£tDeblockögFûãrTcOff£tDiv2
(
I¡
 
vÆ
Ë{ 
m_deblockögFûãrTcOff£tDiv2
 = vÆ; 
	}
}

1181 
I¡
 
	$gëDeblockögFûãrTcOff£tDiv2
(Ëc⁄° {  
m_deblockögFûãrTcOff£tDiv2
; 
	}
}

1182 
Boﬁ
 
	$gëSˇlögLi°Pª£¡Fœg
(Ëc⁄° {  
m_sˇlögLi°Pª£¡Fœg
; 
	}
}

1183 
Void
 
	$£tSˇlögLi°Pª£¡Fœg
–
Boﬁ
 
b
 ) { 
m_sˇlögLi°Pª£¡Fœg
 = b; 
	}
}

1184 
	gTComSˇlögLi°
& 
	$gëSˇlögLi°
(Ë{  
m_sˇlögLi°
; 
	}
}

1185 c⁄° 
	gTComSˇlögLi°
& 
	$gëSˇlögLi°
(Ëc⁄° {  
m_sˇlögLi°
; 
	}
}

1186 
Boﬁ
 
	$gëLi°sModifiˇti⁄Pª£¡Fœg
(Ëc⁄° {  
m_li°sModifiˇti⁄Pª£¡Fœg
; 
	}
}

1187 
Void
 
	$£tLi°sModifiˇti⁄Pª£¡Fœg
–
Boﬁ
 
b
 ) { 
m_li°sModifiˇti⁄Pª£¡Fœg
 = b; 
	}
}

1188 
UI¡
 
	$gëLog2P¨ÆÀlMîgeLevñMöus2
(Ëc⁄° {  
m_log2P¨ÆÀlMîgeLevñMöus2
; 
	}
}

1189 
Void
 
	$£tLog2P¨ÆÀlMîgeLevñMöus2
(
UI¡
 
mrgLevñ
Ë{ 
m_log2P¨ÆÀlMîgeLevñMöus2
 = mrgLevñ; 
	}
}

1190 
I¡
 
	$gëNumExåaSli˚HódîBôs
(Ëc⁄° {  
m_numExåaSli˚HódîBôs
; 
	}
}

1191 
Void
 
	$£tNumExåaSli˚HódîBôs
(
I¡
 
i
Ë{ 
m_numExåaSli˚HódîBôs
 = i; 
	}
}

1192 
Void
 
	$£tLo›FûãrA¸ossSli˚sE«bÀdFœg
–
Boﬁ
 
bVÆue
 ) { 
m_lo›FûãrA¸ossSli˚sE«bÀdFœg
 = bVÆue; 
	}
}

1193 
Boﬁ
 
	$gëLo›FûãrA¸ossSli˚sE«bÀdFœg
(Ëc⁄° {  
m_lo›FûãrA¸ossSli˚sE«bÀdFœg
; 
	}
}

1194 
Boﬁ
 
	$gëSli˚HódîExãnsi⁄Pª£¡Fœg
(Ëc⁄° {  
m_¶i˚HódîExãnsi⁄Pª£¡Fœg
; 
	}
}

1195 
Void
 
	$£tSli˚HódîExãnsi⁄Pª£¡Fœg
(
Boﬁ
 
vÆ
Ë{ 
m_¶i˚HódîExãnsi⁄Pª£¡Fœg
 = vÆ; 
	}
}

1197 c⁄° 
	gTComPPSRExt
& 
	$gëPpsR™geExãnsi⁄
(Ëc⁄° {  
m_µsR™geExãnsi⁄
; 
	}
}

1198 
	gTComPPSRExt
& 
	$gëPpsR™geExãnsi⁄
(Ë{  
m_µsR™geExãnsi⁄
; 
	}
}

1201 
	sWPSˇlögP¨am


1205 
Boﬁ
 
	mbPª£¡Fœg
;

1206 
UI¡
 
	muiLog2WeightDíom
;

1207 
I¡
 
	miWeight
;

1208 
I¡
 
	miOff£t
;

1211 
I¡
 
	mw
;

1212 
I¡
 
	mo
;

1213 
I¡
 
	moff£t
;

1214 
I¡
 
	mshi·
;

1215 
I¡
 
	mround
;

1218 
	sWPACDCP¨am


1220 
I¡64
 
	miAC
;

1221 
I¡64
 
	miDC
;

1225 ˛as†
	cTComSli˚


1228 
	m¥iv©e
:

1230 
Boﬁ
 
m_ßoE«bÀdFœg
[
MAX_NUM_CHANNEL_TYPE
];

1231 
I¡
 
	mm_iPPSId
;

1232 
Boﬁ
 
	mm_PicOuçutFœg
;

1233 
I¡
 
	mm_iPOC
;

1234 
I¡
 
	mm_iLa°IDR
;

1235 
I¡
 
	mm_iAssocüãdIRAP
;

1236 
NÆUnôTy≥
 
	mm_iAssocüãdIRAPTy≥
;

1237 c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
	mm_pRPS
;

1238 
TComRe„ªn˚Pi˘uªSë
 
	mm_loˇlRPS
;

1239 
I¡
 
	mm_ΩsIdx
;

1240 
TComRefPicLi°Modifiˇti⁄
 
	mm_RefPicLi°Modifiˇti⁄
;

1241 
NÆUnôTy≥
 
	mm_eNÆUnôTy≥
;

1242 
Sli˚Ty≥
 
	mm_eSli˚Ty≥
;

1243 
I¡
 
	mm_iSli˚Qp
;

1244 
Boﬁ
 
	mm_dïídítSli˚SegmítFœg
;

1245 #i‡
ADAPTIVE_QP_SELECTION


1246 
I¡
 
	mm_iSli˚QpBa£
;

1248 
Boﬁ
 
	mm_ChromaQpAdjE«bÀd
;

1249 
Boﬁ
 
	mm_deblockögFûãrDißbÀ
;

1250 
Boﬁ
 
	mm_deblockögFûãrOvîrideFœg
;

1251 
I¡
 
	mm_deblockögFûãrBëaOff£tDiv2
;

1252 
I¡
 
	mm_deblockögFûãrTcOff£tDiv2
;

1253 
I¡
 
	mm_li°1IdxToLi°0Idx
[
MAX_NUM_REF
];

1254 
I¡
 
	mm_aiNumRefIdx
 [
NUM_REF_PIC_LIST_01
];

1256 
Boﬁ
 
	mm_bCheckLDC
;

1259 
I¡
 
	mm_iSli˚QpDñè
;

1260 
I¡
 
	mm_iSli˚ChromaQpDñè
[
MAX_NUM_COMPONENT
];

1261 
TComPic
* 
	mm_≠cRefPicLi°
 [
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
+1];

1262 
I¡
 
	mm_aiRefPOCLi°
 [
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
+1];

1263 
Boﬁ
 
	mm_bIsU£dAsL⁄gTîm
[
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
+1];

1264 
I¡
 
	mm_iDïth
;

1267 
Boﬁ
 
	mm_bRe„n˚d
;

1270 c⁄° 
TComVPS
* 
	mm_pcVPS
;

1271 c⁄° 
TComSPS
* 
	mm_pcSPS
;

1272 c⁄° 
TComPPS
* 
	mm_pcPPS
;

1273 
TComPic
* 
	mm_pcPic
;

1274 
Boﬁ
 
	mm_cﬁFromL0Fœg
;

1276 
Boﬁ
 
	mm_noOuçutPri‹PicsFœg
;

1277 
Boﬁ
 
	mm_noRa¶OuçutFœg
;

1278 
Boﬁ
 
	mm_h™dÀCøAsBœFœg
;

1280 
UI¡
 
	mm_cﬁRefIdx
;

1281 
UI¡
 
	mm_maxNumMîgeC™d
;

1283 
DoubÀ
 
	mm_œmbdas
[
MAX_NUM_COMPONENT
];

1285 
Boﬁ
 
	mm_abEquÆRef
 [
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
][MAX_NUM_REF];

1286 
UI¡
 
	mm_uiTLayî
;

1287 
Boﬁ
 
	mm_bTLayîSwôchögFœg
;

1289 
Sli˚C⁄°øöt
 
	mm_¶i˚Mode
;

1290 
UI¡
 
	mm_¶i˚Argumít
;

1291 
UI¡
 
	mm_¶i˚CurSèπCtuTsAddr
;

1292 
UI¡
 
	mm_¶i˚CurEndCtuTsAddr
;

1293 
UI¡
 
	mm_¶i˚Idx
;

1294 
Sli˚C⁄°øöt
 
	mm_¶i˚SegmítMode
;

1295 
UI¡
 
	mm_¶i˚SegmítArgumít
;

1296 
UI¡
 
	mm_¶i˚SegmítCurSèπCtuTsAddr
;

1297 
UI¡
 
	mm_¶i˚SegmítCurEndCtuTsAddr
;

1298 
Boﬁ
 
	mm_√xtSli˚
;

1299 
Boﬁ
 
	mm_√xtSli˚Segmít
;

1300 
UI¡
 
	mm_¶i˚Bôs
;

1301 
UI¡
 
	mm_¶i˚SegmítBôs
;

1302 
Boﬁ
 
	mm_bFöÆized
;

1304 
Boﬁ
 
	mm_bTe°WeightPªd
;

1305 
Boﬁ
 
	mm_bTe°WeightBiPªd
;

1306 
WPSˇlögP¨am
 
	mm_weightPªdTabÀ
[
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
][
MAX_NUM_COMPONENT
];

1307 
WPACDCP¨am
 
	mm_weightACDCP¨am
[
MAX_NUM_COMPONENT
];

1309 
	m°d
::
ve˘‹
<
UI¡
> 
m_sub°ªamSizes
;

1311 
Boﬁ
 
	mm_ˇbacInôFœg
;

1313 
Boﬁ
 
	mm_bLMvdL1Zîo
;

1314 
Boﬁ
 
	mm_ãmp‹ÆLayîN⁄Re„ªn˚Fœg
;

1315 
Boﬁ
 
	mm_LFCrossSli˚Bound¨yFœg
;

1317 
Boﬁ
 
	mm_íabÀTMVPFœg
;

1319 
Sli˚Ty≥
 
	mm_ícCABACTabÀIdx
;

1321 
	mpublic
:

1322 
TComSli˚
();

1323 
	mvútuÆ
 ~
TComSli˚
();

1324 
Void
 
öôSli˚
();

1326 
Void
 
	$£tVPS
–
TComVPS
* 
pcVPS
 ) { 
m_pcVPS
 =ÖcVPS; }

1327 c⁄° 
TComVPS
* 
	$gëVPS
(Ëc⁄° {  
m_pcVPS
; 
	}
}

1328 
Void
 
	$£tSPS
–c⁄° 
TComSPS
* 
pcSPS
 ) { 
m_pcSPS
 =ÖcSPS; 
	}
}

1329 c⁄° 
TComSPS
* 
	$gëSPS
(Ëc⁄° {  
m_pcSPS
; 
	}
}

1331 
Void
 
	$£tPPS
–c⁄° 
TComPPS
* 
pcPPS
 ) { 
m_pcPPS
 =ÖcPPS; 
m_iPPSId
 = (pcPPSË?ÖcPPS->
	`gëPPSId
(Ë: -1; 
	}
}

1332 c⁄° 
TComPPS
* 
	$gëPPS
(Ëc⁄° {  
m_pcPPS
; 
	}
}

1334 
Void
 
	$£tPPSId
–
I¡
 
PPSId
 ) { 
m_iPPSId
 = PPSId; 
	}
}

1335 
I¡
 
	$gëPPSId
(Ëc⁄° {  
m_iPPSId
; 
	}
}

1336 
Void
 
	$£tPicOuçutFœg
–
Boﬁ
 
b
 ) { 
m_PicOuçutFœg
 = b; 
	}
}

1337 
Boﬁ
 
	$gëPicOuçutFœg
(Ëc⁄° {  
m_PicOuçutFœg
; 
	}
}

1338 
Void
 
	$£tSaoE«bÀdFœg
(
Ch™√lTy≥
 
chTy≥
, 
Boﬁ
 
s
Ë{
m_ßoE«bÀdFœg
[chTy≥] =s; 
	}
}

1339 
Boﬁ
 
	$gëSaoE«bÀdFœg
(
Ch™√lTy≥
 
chTy≥
Ëc⁄° {  
m_ßoE«bÀdFœg
[chTy≥]; 
	}
}

1340 
Void
 
	$£tRPS
–c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pcRPS
 ) { 
m_pRPS
 =ÖcRPS; 
	}
}

1341 c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
	$gëRPS
(Ë{  
m_pRPS
; 
	}
}

1342 
TComRe„ªn˚Pi˘uªSë
* 
	$gëLoˇlRPS
(Ë{  &
m_loˇlRPS
; 
	}
}

1344 
Void
 
	$£tRPSidx
–
I¡
 
ΩsIdx
 ) { 
m_ΩsIdx
 =ÑpsIdx; 
	}
}

1345 
I¡
 
	$gëRPSidx
(Ëc⁄° {  
m_ΩsIdx
; 
	}
}

1346 
TComRefPicLi°Modifiˇti⁄
* 
	$gëRefPicLi°Modifiˇti⁄
(Ë{  &
m_RefPicLi°Modifiˇti⁄
; 
	}
}

1347 
Void
 
	$£tLa°IDR
(
I¡
 
iIDRPOC
Ë{ 
m_iLa°IDR
 = iIDRPOC; 
	}
}

1348 
I¡
 
	$gëLa°IDR
(Ëc⁄° {  
m_iLa°IDR
; 
	}
}

1349 
Void
 
	$£tAssocüãdIRAPPOC
(
I¡
 
iAssocüãdIRAPPOC
Ë{ 
m_iAssocüãdIRAP
 = iAssocüãdIRAPPOC; 
	}
}

1350 
I¡
 
	$gëAssocüãdIRAPPOC
(Ëc⁄° {  
m_iAssocüãdIRAP
; 
	}
}

1351 
Void
 
	$£tAssocüãdIRAPTy≥
(
NÆUnôTy≥
 
assocüãdIRAPTy≥
Ë{ 
m_iAssocüãdIRAPTy≥
 =ássocüãdIRAPTy≥; 
	}
}

1352 
NÆUnôTy≥
 
	$gëAssocüãdIRAPTy≥
(Ëc⁄° {  
m_iAssocüãdIRAPTy≥
; 
	}
}

1353 
Sli˚Ty≥
 
	$gëSli˚Ty≥
(Ëc⁄° {  
m_eSli˚Ty≥
; 
	}
}

1354 
I¡
 
	$gëPOC
(Ëc⁄° {  
m_iPOC
; 
	}
}

1355 
I¡
 
	$gëSli˚Qp
(Ëc⁄° {  
m_iSli˚Qp
; 
	}
}

1356 
Boﬁ
 
	$gëU£WeighãdPªdi˘i⁄
(Ëc⁄° { –(
m_eSli˚Ty≥
==
P_SLICE
 && 
	`ã°WeightPªd
()Ë|| (m_eSli˚Ty≥==
B_SLICE
 && 
	`ã°WeightBiPªd
()Ë); 
	}
}

1357 
Boﬁ
 
	$gëDïídítSli˚SegmítFœg
(Ëc⁄° {  
m_dïídítSli˚SegmítFœg
; 
	}
}

1358 
Void
 
	$£tDïídítSli˚SegmítFœg
(
Boﬁ
 
vÆ
Ë{ 
m_dïídítSli˚SegmítFœg
 = vÆ; 
	}
}

1359 #i‡
ADAPTIVE_QP_SELECTION


1360 
I¡
 
	$gëSli˚QpBa£
(Ëc⁄° {  
m_iSli˚QpBa£
; 
	}
}

1362 
I¡
 
	$gëSli˚QpDñè
(Ëc⁄° {  
m_iSli˚QpDñè
; 
	}
}

1363 
I¡
 
	$gëSli˚ChromaQpDñè
(
Comp⁄ítID
 
compID
Ëc⁄° {  
	`isLuma
(compIDË? 0 : 
m_iSli˚ChromaQpDñè
[compID]; 
	}
}

1364 
Boﬁ
 
	$gëU£ChromaQpAdj
(Ëc⁄° {  
m_ChromaQpAdjE«bÀd
; 
	}
}

1365 
Boﬁ
 
	$gëDeblockögFûãrDißbÀ
(Ëc⁄° {  
m_deblockögFûãrDißbÀ
; 
	}
}

1366 
Boﬁ
 
	$gëDeblockögFûãrOvîrideFœg
(Ëc⁄° {  
m_deblockögFûãrOvîrideFœg
; 
	}
}

1367 
I¡
 
	$gëDeblockögFûãrBëaOff£tDiv2
()c⁄° {  
m_deblockögFûãrBëaOff£tDiv2
; 
	}
}

1368 
I¡
 
	$gëDeblockögFûãrTcOff£tDiv2
(Ëc⁄° {  
m_deblockögFûãrTcOff£tDiv2
; 
	}
}

1370 
I¡
 
	$gëNumRefIdx
–
RefPicLi°
 
e
 ) c⁄° {  
m_aiNumRefIdx
[e]; 
	}
}

1371 
TComPic
* 
	$gëPic
(Ë{  
m_pcPic
; 
	}
}

1372 c⁄° 
TComPic
* 
	$gëPic
(Ëc⁄° {  
m_pcPic
; 
	}
}

1373 
TComPic
* 
	$gëRefPic
–
RefPicLi°
 
e
, 
I¡
 
iRefIdx
Ë{  
m_≠cRefPicLi°
[e][iRefIdx]; 
	}
}

1374 c⁄° 
TComPic
* 
	$gëRefPic
–
RefPicLi°
 
e
, 
I¡
 
iRefIdx
Ëc⁄° {  
m_≠cRefPicLi°
[e][iRefIdx]; 
	}
}

1375 
I¡
 
	$gëRefPOC
–
RefPicLi°
 
e
, 
I¡
 
iRefIdx
Ëc⁄° {  
m_aiRefPOCLi°
[e][iRefIdx]; 
	}
}

1376 
I¡
 
	$gëDïth
(Ëc⁄° {  
m_iDïth
; 
	}
}

1377 
Boﬁ
 
	$gëCﬁFromL0Fœg
(Ëc⁄° {  
m_cﬁFromL0Fœg
; 
	}
}

1378 
UI¡
 
	$gëCﬁRefIdx
(Ëc⁄° {  
m_cﬁRefIdx
; 
	}
}

1379 
Void
 
checkCﬁRefIdx
(
UI¡
 
curSli˚Idx
, 
TComPic
* 
pic
);

1380 
Boﬁ
 
	$gëIsU£dAsL⁄gTîm
(
I¡
 
i
, I¡ 
j
Ëc⁄° {  
m_bIsU£dAsL⁄gTîm
[i][j]; 
	}
}

1381 
Void
 
	$£tIsU£dAsL⁄gTîm
(
I¡
 
i
, I¡ 
j
, 
Boﬁ
 
vÆue
Ë{ 
m_bIsU£dAsL⁄gTîm
[i][j] = vÆue; 
	}
}

1382 
Boﬁ
 
	$gëCheckLDC
(Ëc⁄° {  
m_bCheckLDC
; 
	}
}

1383 
Boﬁ
 
	$gëMvdL1ZîoFœg
(Ëc⁄° {  
m_bLMvdL1Zîo
; 
	}
}

1384 
I¡
 
	$gëNumRpsCuºTempLi°
() const;

1385 
I¡
 
	$gëLi°1IdxToLi°0Idx
–
I¡
 
li°1Idx
 ) c⁄° {  
m_li°1IdxToLi°0Idx
[li°1Idx]; 
	}
}

1386 
Void
 
	$£tRe„ªn˚d
(
Boﬁ
 
b
Ë{ 
m_bRe„n˚d
 = b; 
	}
}

1387 
Boﬁ
 
	$isRe„ªn˚d
(Ëc⁄° {  
m_bRe„n˚d
; 
	}
}

1388 
Boﬁ
 
	$isRe„ªn˚NÆu
(Ëc⁄° {  ((
	`gëNÆUnôTy≥
(Ë<
NAL_UNIT_RESERVED_VCL_R15
Ë&& (gëNÆUnôTy≥()%2 !0)Ë|| ((gëNÆUnôTy≥(Ë>
NAL_UNIT_CODED_SLICE_BLA_W_LP
Ë&& (gëNÆUnôTy≥(Ë<
NAL_UNIT_RESERVED_IRAP_VCL23
Ë); 
	}
}

1389 
Void
 
	$£tPOC
–
I¡
 
i
 ) { 
m_iPOC
 = i; 
	}
}

1390 
Void
 
	$£tNÆUnôTy≥
–
NÆUnôTy≥
 
e
 ) { 
m_eNÆUnôTy≥
 =É; 
	}
}

1391 
NÆUnôTy≥
 
	$gëNÆUnôTy≥
(Ëc⁄° {  
m_eNÆUnôTy≥
; 
	}
}

1392 
Boﬁ
 
	$gëR≠PicFœg
() const;

1393 
Boﬁ
 
	$gëIdrPicFœg
(Ëc⁄° {  
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 || gëNÆUnôTy≥(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP
; 
	}
}

1394 
Boﬁ
 
	$isIRAP
(Ëc⁄° {  (
	`gëNÆUnôTy≥
(Ë>16Ë&& (gëNÆUnôTy≥(Ë<23); 
	}
}

1395 
Void
 
checkCRA
(c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pRe„ªn˚Pi˘uªSë
, 
I¡
& 
pocCRA
, 
NÆUnôTy≥
& 
assocüãdIRAPTy≥
, 
TComLi°
<
TComPic
 *>& 
rcLi°Pic
);

1396 
Void
 
decodögRe‰eshM¨kög
(
I¡
& 
pocCRA
, 
Boﬁ
& 
bRe‰eshPídög
, 
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
boﬁ
 
bEfficõ¡FõldIRAPE«bÀd
);

1397 
Void
 
	$£tSli˚Ty≥
–
Sli˚Ty≥
 
e
 ) { 
m_eSli˚Ty≥
 =É; 
	}
}

1398 
Void
 
	$£tSli˚Qp
–
I¡
 
i
 ) { 
m_iSli˚Qp
 = i; 
	}
}

1399 #i‡
ADAPTIVE_QP_SELECTION


1400 
Void
 
	$£tSli˚QpBa£
–
I¡
 
i
 ) { 
m_iSli˚QpBa£
 = i; 
	}
}

1402 
Void
 
	$£tSli˚QpDñè
–
I¡
 
i
 ) { 
m_iSli˚QpDñè
 = i; 
	}
}

1403 
Void
 
	$£tSli˚ChromaQpDñè
–
Comp⁄ítID
 
compID
, 
I¡
 
i
 ) { 
m_iSli˚ChromaQpDñè
[compID] = 
	`isLuma
(compIDË? 0 : i; 
	}
}

1404 
Void
 
	$£tU£ChromaQpAdj
–
Boﬁ
 
b
 ) { 
m_ChromaQpAdjE«bÀd
 = b; 
	}
}

1405 
Void
 
	$£tDeblockögFûãrDißbÀ
–
Boﬁ
 
b
 ) { 
m_deblockögFûãrDißbÀ
b; 
	}
}

1406 
Void
 
	$£tDeblockögFûãrOvîrideFœg
–
Boﬁ
 
b
 ) { 
m_deblockögFûãrOvîrideFœg
 = b; 
	}
}

1407 
Void
 
	$£tDeblockögFûãrBëaOff£tDiv2
–
I¡
 
i
 ) { 
m_deblockögFûãrBëaOff£tDiv2
 = i; 
	}
}

1408 
Void
 
	$£tDeblockögFûãrTcOff£tDiv2
–
I¡
 
i
 ) { 
m_deblockögFûãrTcOff£tDiv2
 = i; 
	}
}

1410 
Void
 
	$£tRefPic
–
TComPic
* 
p
, 
RefPicLi°
 
e
, 
I¡
 
iRefIdx
 ) { 
m_≠cRefPicLi°
[e][iRefIdx] =Ö; 
	}
}

1411 
Void
 
	$£tRefPOC
–
I¡
 
i
, 
RefPicLi°
 
e
, I¡ 
iRefIdx
 ) { 
m_aiRefPOCLi°
[e][iRefIdx] = i; 
	}
}

1412 
Void
 
	$£tNumRefIdx
–
RefPicLi°
 
e
, 
I¡
 
i
 ) { 
m_aiNumRefIdx
[e] = i; 
	}
}

1413 
Void
 
	$£tPic
–
TComPic
* 
p
 ) { 
m_pcPic
 =Ö; 
	}
}

1414 
Void
 
	$£tDïth
–
I¡
 
iDïth
 ) { 
m_iDïth
 = iDïth; 
	}
}

1416 
Void
 
£tRefPicLi°
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, 
Boﬁ
 
checkNumPocTŸÆCuº
 = 
Ál£
 );

1417 
Void
 
£tRefPOCLi°
();

1418 
Void
 
	$£tCﬁFromL0Fœg
–
Boﬁ
 
cﬁFromL0
 ) { 
m_cﬁFromL0Fœg
 = cﬁFromL0; 
	}
}

1419 
Void
 
	$£tCﬁRefIdx
–
UI¡
 
ªfIdx
Ë{ 
m_cﬁRefIdx
 =ÑefIdx; 
	}
}

1420 
Void
 
	$£tCheckLDC
–
Boﬁ
 
b
 ) { 
m_bCheckLDC
 = b; 
	}
}

1421 
Void
 
	$£tMvdL1ZîoFœg
–
Boﬁ
 
b
Ë{ 
m_bLMvdL1Zîo
 = b; 
	}
}

1423 
Boﬁ
 
	$isI¡ø
(Ëc⁄° {  
m_eSli˚Ty≥
 =
I_SLICE
; 
	}
}

1424 
Boﬁ
 
	$isI¡îB
(Ëc⁄° {  
m_eSli˚Ty≥
 =
B_SLICE
; 
	}
}

1425 
Boﬁ
 
	$isI¡îP
(Ëc⁄° {  
m_eSli˚Ty≥
 =
P_SLICE
; 
	}
}

1427 
Void
 
	$£tLambdas
–c⁄° 
DoubÀ
 
œmbdas
[
MAX_NUM_COMPONENT
] ) { 
I¡
 
comp⁄ít
 = 0; comp⁄íà< MAX_NUM_COMPONENT; comp⁄ít++Ë
m_œmbdas
[comp⁄ít] =Üambdas[comp⁄ít]; 
	}
}

1428 c⁄° 
DoubÀ
* 
	$gëLambdas
(Ëc⁄° {  
m_œmbdas
; 
	}
}

1430 
Void
 
öôEquÆRef
();

1431 
Boﬁ
 
	$isEquÆRef
–
RefPicLi°
 
e
, 
I¡
 
iRefIdx1
, I¡ 
iRefIdx2
 )

1433 
	`as£π
(
e
<
NUM_REF_PIC_LIST_01
);

1434 i‡(
iRefIdx1
 < 0 || 
iRefIdx2
 < 0)

1436  
Ál£
;

1440  
m_abEquÆRef
[
e
][
iRefIdx1
][
iRefIdx2
];

1442 
	}
}

1444 
Void
 
	$£tEquÆRef
–
RefPicLi°
 
e
, 
I¡
 
iRefIdx1
, I¡ 
iRefIdx2
, 
Boﬁ
 
b
)

1446 
	`as£π
(
e
<
NUM_REF_PIC_LIST_01
);

1447 
m_abEquÆRef
[
e
][
iRefIdx1
][
iRefIdx2
] = m_abEquÆRef[e][iRefIdx2][iRefIdx1] = 
b
;

1448 
	}
}

1450 
Void
 
s‹tPicLi°
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
 );

1451 
Void
 
£tLi°1IdxToLi°0Idx
();

1453 
UI¡
 
	$gëTLayî
(Ëc⁄° {  
m_uiTLayî
; 
	}
}

1454 
Void
 
	$£tTLayî
–
UI¡
 
uiTLayî
 ) { 
m_uiTLayî
 = uiTLayî; 
	}
}

1456 
Void
 
£tTLayîInfo
–
UI¡
 
uiTLayî
 );

1457 
Void
 
decodögM¨kög
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, 
I¡
 
iGOPSIze
, I¡& 
iMaxRefPicNum
 );

1458 
Void
 
checkLódögPi˘uªRe°ri˘i⁄s
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
 );

1459 
Void
 
≠∂yRe„ªn˚Pi˘uªSë
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
RPSLi°
);

1460 
Boﬁ
 
isTemp‹ÆLayîSwôchögPoöt
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
 );

1461 
Boﬁ
 
isSãpwi£Temp‹ÆLayîSwôchögPoötC™did©e
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
 );

1462 
I¡
 
checkTh©AŒRefPicsAªAvaûabÀ
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pRe„ªn˚Pi˘uªSë
, 
Boﬁ
 
¥ötEº‹s
, I¡ 
pocR™domAc˚ss
 = 0, Boﬁ 
bU£RecovîyPoöt
 = 
Ál£
);

1463 
Void
 
¸óãEx∂icôRe„ªn˚Pi˘uªSëFromRe„ªn˚
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
, c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
pRe„ªn˚Pi˘uªSë
, 
Boﬁ
 
isRAP
, 
I¡
 
pocR™domAc˚ss
, Boﬁ 
bU£RecovîyPoöt
, c⁄° Boﬁ 
bEfficõ¡FõldIRAPE«bÀd
);

1464 
Void
 
	$£tMaxNumMîgeC™d
(
UI¡
 
vÆ
 ) { 
m_maxNumMîgeC™d
 = vÆ; 
	}
}

1465 
UI¡
 
	$gëMaxNumMîgeC™d
(Ëc⁄° {  
m_maxNumMîgeC™d
; 
	}
}

1467 
Void
 
	$£tNoOuçutPri‹PicsFœg
–
Boﬁ
 
vÆ
 ) { 
m_noOuçutPri‹PicsFœg
 = vÆ; 
	}
}

1468 
Boﬁ
 
	$gëNoOuçutPri‹PicsFœg
(Ëc⁄° {  
m_noOuçutPri‹PicsFœg
; 
	}
}

1470 
Void
 
	$£tNoRa¶OuçutFœg
–
Boﬁ
 
vÆ
 ) { 
m_noRa¶OuçutFœg
 = vÆ; 
	}
}

1471 
Boﬁ
 
	$gëNoRa¶OuçutFœg
(Ëc⁄° {  
m_noRa¶OuçutFœg
; 
	}
}

1473 
Void
 
	$£tH™dÀCøAsBœFœg
–
Boﬁ
 
vÆ
 ) { 
m_h™dÀCøAsBœFœg
 = vÆ; 
	}
}

1474 
Boﬁ
 
	$gëH™dÀCøAsBœFœg
(Ëc⁄° {  
m_h™dÀCøAsBœFœg
; 
	}
}

1476 
Void
 
	$£tSli˚Mode
–
Sli˚C⁄°øöt
 
mode
 ) { 
m_¶i˚Mode
 = mode; 
	}
}

1477 
Sli˚C⁄°øöt
 
	$gëSli˚Mode
(Ëc⁄° {  
m_¶i˚Mode
; 
	}
}

1478 
Void
 
	$£tSli˚Argumít
–
UI¡
 
uiArgumít
 ) { 
m_¶i˚Argumít
 = uiArgumít; 
	}
}

1479 
UI¡
 
	$gëSli˚Argumít
(Ëc⁄° {  
m_¶i˚Argumít
; 
	}
}

1480 
Void
 
	$£tSli˚CurSèπCtuTsAddr
–
UI¡
 
˘uTsAddr
 ) { 
m_¶i˚CurSèπCtuTsAddr
 = ctuTsAddr; 
	}
}

1481 
UI¡
 
	$gëSli˚CurSèπCtuTsAddr
(Ëc⁄° {  
m_¶i˚CurSèπCtuTsAddr
; 
	}
}

1482 
Void
 
	$£tSli˚CurEndCtuTsAddr
–
UI¡
 
˘uTsAddr
 ) { 
m_¶i˚CurEndCtuTsAddr
 = ctuTsAddr; 
	}
}

1483 
UI¡
 
	$gëSli˚CurEndCtuTsAddr
(Ëc⁄° {  
m_¶i˚CurEndCtuTsAddr
; 
	}
}

1484 
Void
 
	$£tSli˚Idx
–
UI¡
 
i
Ë{ 
m_¶i˚Idx
 = i; 
	}
}

1485 
UI¡
 
	$gëSli˚Idx
(Ëc⁄° {  
m_¶i˚Idx
; 
	}
}

1486 
Void
 
c›ySli˚Info
(
TComSli˚
 *
pcSli˚Src
);

1487 
Void
 
	$£tSli˚SegmítMode
–
Sli˚C⁄°øöt
 
mode
 ) { 
m_¶i˚SegmítMode
 = mode; 
	}
}

1488 
Sli˚C⁄°øöt
 
	$gëSli˚SegmítMode
(Ëc⁄° {  
m_¶i˚SegmítMode
; 
	}
}

1489 
Void
 
	$£tSli˚SegmítArgumít
–
UI¡
 
uiArgumít
 ) { 
m_¶i˚SegmítArgumít
 = uiArgumít; 
	}
}

1490 
UI¡
 
	$gëSli˚SegmítArgumít
(Ëc⁄° {  
m_¶i˚SegmítArgumít
; 
	}
}

1491 
Void
 
	$£tSli˚SegmítCurSèπCtuTsAddr
–
UI¡
 
˘uTsAddr
 ) { 
m_¶i˚SegmítCurSèπCtuTsAddr
 = ctuTsAddr; 
	}
}

1492 
UI¡
 
	$gëSli˚SegmítCurSèπCtuTsAddr
(Ëc⁄° {  
m_¶i˚SegmítCurSèπCtuTsAddr
; 
	}
}

1493 
Void
 
	$£tSli˚SegmítCurEndCtuTsAddr
–
UI¡
 
˘uTsAddr
 ) { 
m_¶i˚SegmítCurEndCtuTsAddr
 = ctuTsAddr; 
	}
}

1494 
UI¡
 
	$gëSli˚SegmítCurEndCtuTsAddr
(Ëc⁄° {  
m_¶i˚SegmítCurEndCtuTsAddr
; 
	}
}

1495 
Void
 
	$£tSli˚Bôs
–
UI¡
 
uiVÆ
 ) { 
m_¶i˚Bôs
 = uiVÆ; 
	}
}

1496 
UI¡
 
	$gëSli˚Bôs
(Ëc⁄° {  
m_¶i˚Bôs
; 
	}
}

1497 
Void
 
	$£tSli˚SegmítBôs
–
UI¡
 
uiVÆ
 ) { 
m_¶i˚SegmítBôs
 = uiVÆ; 
	}
}

1498 
UI¡
 
	$gëSli˚SegmítBôs
(Ëc⁄° {  
m_¶i˚SegmítBôs
; 
	}
}

1499 
Void
 
	$£tFöÆized
–
Boﬁ
 
uiVÆ
 ) { 
m_bFöÆized
 = uiVÆ; 
	}
}

1500 
Boﬁ
 
	$gëFöÆized
(Ëc⁄° {  
m_bFöÆized
; 
	}
}

1501 
Boﬁ
 
	$ã°WeightPªd
–Ëc⁄° {  
m_bTe°WeightPªd
; 
	}
}

1502 
Void
 
	$£tTe°WeightPªd
–
Boﬁ
 
bVÆue
 ) { 
m_bTe°WeightPªd
 = bVÆue; 
	}
}

1503 
Boﬁ
 
	$ã°WeightBiPªd
–Ëc⁄° {  
m_bTe°WeightBiPªd
; 
	}
}

1504 
Void
 
	$£tTe°WeightBiPªd
–
Boﬁ
 
bVÆue
 ) { 
m_bTe°WeightBiPªd
 = bVÆue; 
	}
}

1505 
Void
 
	$£tWpSˇlög
–
WPSˇlögP¨am
 
wp
[
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
][
MAX_NUM_COMPONENT
] )

1507 
	`mem˝y
(
m_weightPªdTabÀ
, 
wp
, (
WPSˇlögP¨am
)*
NUM_REF_PIC_LIST_01
*
MAX_NUM_REF
*
MAX_NUM_COMPONENT
);

1508 
	}
}

1510 
Void
 
gëWpSˇlög
–
RefPicLi°
 
e
, 
I¡
 
iRefIdx
, 
WPSˇlögP¨am
 *&
wp
);

1512 
Void
 
ª£tWpSˇlög
();

1513 
Void
 
öôWpSˇlög
(c⁄° 
TComSPS
 *
•s
);

1515 
Void
 
	$£tWpAcDcP¨am
–
WPACDCP¨am
 
wp
[
MAX_NUM_COMPONENT
] )

1517 
	`mem˝y
(
m_weightACDCP¨am
, 
wp
, (
WPACDCP¨am
)*
MAX_NUM_COMPONENT
);

1518 
	}
}

1520 
Void
 
gëWpAcDcP¨am
–
WPACDCP¨am
 *&
wp
 );

1521 
Void
 
öôWpAcDcP¨am
();

1523 
Void
 
	$˛órSub°ªamSizes
–Ë{  
m_sub°ªamSizes
.
	`˛ór
(); 
	}
}

1524 
UI¡
 
	$gëNumbîOfSub°ªamSizes
–Ë{  (
UI¡
Ë
m_sub°ªamSizes
.
	`size
(); 
	}
}

1525 
Void
 
	$addSub°ªamSize
–
UI¡
 
size
 ) { 
m_sub°ªamSizes
.
	`push_back
(size); 
	}
}

1526 
UI¡
 
	$gëSub°ªamSize
–
I¡
 
idx
 ) { 
	`as£π
(idx<
	`gëNumbîOfSub°ªamSizes
());  
m_sub°ªamSizes
[idx]; 
	}
}

1528 
Void
 
	$£tCabacInôFœg
–
Boﬁ
 
vÆ
 ) { 
m_ˇbacInôFœg
 = vÆ; 
	}
}

1529 
Boﬁ
 
	$gëCabacInôFœg
(Ë{  
m_ˇbacInôFœg
; 
	}
}

1530 
Boﬁ
 
	$gëTemp‹ÆLayîN⁄Re„ªn˚Fœg
(Ë{  
m_ãmp‹ÆLayîN⁄Re„ªn˚Fœg
; 
	}
}

1531 
Void
 
	$£tTemp‹ÆLayîN⁄Re„ªn˚Fœg
(
Boﬁ
 
x
Ë{ 
m_ãmp‹ÆLayîN⁄Re„ªn˚Fœg
 = x; 
	}
}

1532 
Void
 
	$£tLFCrossSli˚Bound¨yFœg
–
Boﬁ
 
vÆ
 ) { 
m_LFCrossSli˚Bound¨yFœg
 = vÆ; 
	}
}

1533 
Boﬁ
 
	$gëLFCrossSli˚Bound¨yFœg
(Ë{  
m_LFCrossSli˚Bound¨yFœg
; 
	}
}

1535 
Void
 
	$£tE«bÀTMVPFœg
–
Boﬁ
 
b
 ) { 
m_íabÀTMVPFœg
 = b; 
	}
}

1536 
Boﬁ
 
	$gëE«bÀTMVPFœg
(Ëc⁄° {  
m_íabÀTMVPFœg
; 
	}
}

1538 
Void
 
	$£tEncCABACTabÀIdx
–
Sli˚Ty≥
 
idx
 ) { 
m_ícCABACTabÀIdx
 = idx; 
	}
}

1539 
Sli˚Ty≥
 
	$gëEncCABACTabÀIdx
(Ëc⁄° {  
m_ícCABACTabÀIdx
; 
	}
}

1541 
	g¥Ÿe˘ed
:

1542 
TComPic
* 
xGëRefPic
 (
TComLi°
<TComPic*>& 
rcLi°Pic
, 
I¡
 
poc
);

1543 
TComPic
* 
xGëL⁄gTîmRefPic
(
TComLi°
<TComPic*>& 
rcLi°Pic
, 
I¡
 
poc
, 
Boﬁ
 
pocHasMsb
);

1547 
Void
 
ˇlcuœãP¨amëîSëCh™gedFœg
(
Boﬁ
 &
bCh™ged
, c⁄° 
°d
::
ve˘‹
<
UCh¨
> *
pOldD©a
, c⁄° std::ve˘‹<UCh¨> *
pNewD©a
);

1549 
	gãm∂©e
 <
˛ass
 
	gT
> cœs†
	cP¨amëîSëM≠


1551 
	mpublic
:

1552 
ãm∂©e
 <
˛ass
 
Tm
>

1553 
	sM≠D©a


1555 
Boﬁ
 
bCh™ged
;

1556 
	m°d
::
ve˘‹
<
UCh¨
> *
pNÆuD©a
;

1557 
Tm
* 
	m∑ømëîSë
;

1560 
	$P¨amëîSëM≠
(
I¡
 
maxId
)

1561 :
	$m_maxId
 (
maxId
)

1562 {
	}
}

1564 ~
	$P¨amëîSëM≠
()

1566 
ty≥«me
 
°d
::
m≠
<
I¡
,
M≠D©a
<
T
> >::
ôî©‹
 
i
 = 
m_∑øm£tM≠
.
	`begö
(); i!m_∑øm£tM≠.
	`íd
(); i++)

1568 
	`dñëe
 (*
i
).
£c⁄d
.
pNÆuD©a
;

1569 
	`dñëe
 (*
i
).
£c⁄d
.
∑ømëîSë
;

1571 
	}
}

1573 
T
 *
	$ÆloˇãPS
(c⁄° 
I¡
 
psId
)

1575 
	`as£π
 ( 
psId
 < 
m_maxId
 );

1576 i‡–
m_∑øm£tM≠
.
	`föd
(
psId
Ë=m_∑øm£tM≠.
	`íd
() )

1578 
m_∑øm£tM≠
[
psId
].
bCh™ged
 = 
åue
;

1579 
m_∑øm£tM≠
[
psId
].
pNÆuD©a
=0;

1580 
m_∑øm£tM≠
[
psId
].
∑ømëîSë
 = 
√w
 
T
;

1581 
	`£tID
(
m_∑øm£tM≠
[
psId
].
∑ømëîSë
,ÖsId);

1583  
m_∑øm£tM≠
[
psId
].
∑ømëîSë
;

1584 
	}
}

1586 
Void
 
°‹ePS
(
I¡
 
psId
, 
T
 *
ps
, c⁄° 
°d
::
ve˘‹
<
UCh¨
> *
pNÆuD©a
)

1588 
as£π
 ( 
psId
 < 
m_maxId
 );

1589 i‡–
	gm_∑øm£tM≠
.
föd
(
psId
Ë!
m_∑øm£tM≠
.
íd
() )

1591 
M≠D©a
<
T
> &
m≠D©a
=
m_∑øm£tM≠
[
psId
];

1594 
ˇlcuœãP¨amëîSëCh™gedFœg
(
m≠D©a
.
bCh™ged
, m≠D©a.
pNÆuD©a
,ÖNaluData);

1595 
dñëe
 
	gm_∑øm£tM≠
[
psId
].
	gpNÆuD©a
;

1596 
dñëe
 
	gm_∑øm£tM≠
[
psId
].
	g∑ømëîSë
;

1598 
	gm_∑øm£tM≠
[
psId
].
	g∑ømëîSë
 = 
ps
;

1602 
	gm_∑øm£tM≠
[
psId
].
	g∑ømëîSë
 = 
ps
;

1603 
	gm_∑øm£tM≠
[
psId
].
	gbCh™ged
 = 
Ál£
;

1605 i‡(
	gpNÆuD©a
 != 0)

1607 
m_∑øm£tM≠
[
psId
].
pNÆuD©a
=
√w
 
°d
::
ve˘‹
<
UCh¨
>;

1608 *(
	gm_∑øm£tM≠
[
psId
].
	gpNÆuD©a
Ë*
pNÆuD©a
;

1612 
	gm_∑øm£tM≠
[
psId
].
	gpNÆuD©a
=0;

1616 
Void
 
	$£tCh™gedFœg
(
I¡
 
psId
, 
Boﬁ
 
bCh™ged
=
åue
)

1618 i‡–
m_∑øm£tM≠
.
	`föd
(
psId
Ë!m_∑øm£tM≠.
	`íd
() )

1620 
m_∑øm£tM≠
[
psId
].
bCh™ged
=bChanged;

1622 
	}
}

1624 
Void
 
	$˛órCh™gedFœg
(
I¡
 
psId
)

1626 i‡–
m_∑øm£tM≠
.
	`föd
(
psId
Ë!m_∑øm£tM≠.
	`íd
() )

1628 
m_∑øm£tM≠
[
psId
].
bCh™ged
=
Ál£
;

1630 
	}
}

1632 
Boﬁ
 
	$gëCh™gedFœg
(
I¡
 
psId
) const

1634 c⁄° 
ty≥«me
 
°d
::
m≠
<
I¡
,
M≠D©a
<
T
> >::
c⁄°_ôî©‹
 
c⁄°ô
=
m_∑øm£tM≠
.
	`föd
(
psId
);

1635 i‡–
c⁄°ô
 !
m_∑øm£tM≠
.
	`íd
() )

1637  
c⁄°ô
->
£c⁄d
.
bCh™ged
;

1639  
Ál£
;

1640 
	}
}

1642 
T
* 
	$gëPS
(
I¡
 
psId
)

1644 
ty≥«me
 
°d
::
m≠
<
I¡
,
M≠D©a
<
T
> >::
ôî©‹
 
ô
=
m_∑øm£tM≠
.
	`föd
(
psId
);

1645  ( 
ô
 =
m_∑øm£tM≠
.
	`íd
(ËË? 
NULL
 : (ô)->
£c⁄d
.
∑ømëîSë
;

1646 
	}
}

1648 c⁄° 
T
* 
	$gëPS
(
I¡
 
psId
) const

1650 
ty≥«me
 
°d
::
m≠
<
I¡
,
M≠D©a
<
T
> >::
c⁄°_ôî©‹
 
ô
=
m_∑øm£tM≠
.
	`föd
(
psId
);

1651  ( 
ô
 =
m_∑øm£tM≠
.
	`íd
(ËË? 
NULL
 : (ô)->
£c⁄d
.
∑ømëîSë
;

1652 
	}
}

1654 
T
* 
	$gëFú°PS
()

1656  (
m_∑øm£tM≠
.
	`begö
(Ë=m_∑øm£tM≠.
	`íd
(ËË? 
NULL
 : m_∑øm£tM≠.begö()->
£c⁄d
.
∑ømëîSë
;

1657 
	}
}

1659 
	g¥iv©e
:

1660 
°d
::
m≠
<
I¡
,
	gM≠D©a
<
	gT
> > 
	gm_∑øm£tM≠
;

1661 
I¡
 
	gm_maxId
;

1663 
Void
 
£tID
(
T
* 
∑ømëîSë
, c⁄° 
I¡
 
psId
);

1667 ˛as†
	cP¨amëîSëM™agî


1669 
	mpublic
:

1670 
P¨amëîSëM™agî
();

1671 
	mvútuÆ
 ~
P¨amëîSëM™agî
();

1674 
Void
 
°‹eVPS
(
TComVPS
 *
vps
, c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
Ë{ 
m_vpsM≠
.
°‹ePS
–vps->
gëVPSId
(), vps, &naluData); };

1676 
TComVPS
* 
	$gëVPS
(
I¡
 
vpsId
Ë{  
m_vpsM≠
.
	`gëPS
(vpsId); 
	}
};

1677 
Boﬁ
 
	$gëVPSCh™gedFœg
(
I¡
 
vpsId
Ëc⁄° {  
m_vpsM≠
.
	`gëCh™gedFœg
(vpsId); 
	}
}

1678 
Void
 
	$˛órVPSCh™gedFœg
(
I¡
 
vpsId
Ë{ 
m_vpsM≠
.
	`˛órCh™gedFœg
(vpsId); 
	}
}

1679 
TComVPS
* 
	$gëFú°VPS
(Ë{  
m_vpsM≠
.
	`gëFú°PS
(); 
	}
};

1682 
Void
 
°‹eSPS
(
TComSPS
 *
•s
, c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
Ë{ 
m_•sM≠
.
°‹ePS
–•s->
gëSPSId
(), sps, &naluData); };

1684 
TComSPS
* 
	$gëSPS
(
I¡
 
•sId
Ë{  
m_•sM≠
.
	`gëPS
(•sId); 
	}
};

1685 
Boﬁ
 
	$gëSPSCh™gedFœg
(
I¡
 
•sId
Ëc⁄° {  
m_•sM≠
.
	`gëCh™gedFœg
(•sId); 
	}
}

1686 
Void
 
	$˛órSPSCh™gedFœg
(
I¡
 
•sId
Ë{ 
m_•sM≠
.
	`˛órCh™gedFœg
(•sId); 
	}
}

1687 
TComSPS
* 
	$gëFú°SPS
(Ë{  
m_•sM≠
.
	`gëFú°PS
(); 
	}
};

1690 
Void
 
°‹ePPS
(
TComPPS
 *
µs
, c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
Ë{ 
m_µsM≠
.
°‹ePS
–µs->
gëPPSId
(),Öps, &naluData); };

1692 
TComPPS
* 
	$gëPPS
(
I¡
 
µsId
Ë{  
m_µsM≠
.
	`gëPS
’psId); 
	}
};

1693 
Boﬁ
 
	$gëPPSCh™gedFœg
(
I¡
 
µsId
Ëc⁄° {  
m_µsM≠
.
	`gëCh™gedFœg
’psId); 
	}
}

1694 
Void
 
	$˛órPPSCh™gedFœg
(
I¡
 
µsId
Ë{ 
m_µsM≠
.
	`˛órCh™gedFœg
’psId); 
	}
}

1695 
TComPPS
* 
	$gëFú°PPS
(Ë{  
m_µsM≠
.
	`gëFú°PS
(); 
	}
};

1703 
Boﬁ
 
a˘iv©ePPS
(
I¡
 
µsId
, Boﬁ 
isIRAP
);

1705 c⁄° 
TComVPS
* 
	$gëA˘iveVPS
()c⁄° {  
m_vpsM≠
.
	`gëPS
(
m_a˘iveVPSId
); 
	}
};

1706 c⁄° 
TComSPS
* 
	$gëA˘iveSPS
()c⁄° {  
m_•sM≠
.
	`gëPS
(
m_a˘iveSPSId
); 
	}
};

1708 
	g¥Ÿe˘ed
:

1709 
P¨amëîSëM≠
<
TComVPS
> 
m_vpsM≠
;

1710 
	gP¨amëîSëM≠
<
	gTComSPS
> 
	gm_•sM≠
;

1711 
	gP¨amëîSëM≠
<
	gTComPPS
> 
	gm_µsM≠
;

1713 
I¡
 
	gm_a˘iveVPSId
;

1714 
I¡
 
	gm_a˘iveSPSId
;

	@TLibCommon/TComTU.cpp

35 
	~"TComTU.h
"

36 
	~"TComRom.h
"

37 
	~"TComD©aCU.h
"

38 
	~"TComPic.h
"

42  c⁄° 
UI¡
 
	gTComTU
::
NUMBER_OF_SECTIONS
[
TComTU
::
NUMBER_OF_SPLIT_MODES
] = { 1, 2, 4 };

44 c⁄° 
UI¡
 
	g∑πIdxSãpShi·
 [
TComTU
::
NUMBER_OF_SPLIT_MODES
] = { 0, 1, 2 };

48 
	gTComTU
::
	$TComTU
(
TComD©aCU
 *
pcCU
, c⁄° 
UI¡
 
absP¨tIdxCU
, c⁄° UI¡ 
cuDïth
, c⁄° UI¡ 
öôTrDïthRñCU
)

49 : 
	`mChromaF‹m©
(
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëChromaF‹m©Idc
()),

50 
	`mbPro˚ssLa°OfLevñ
(
åue
),

51 
	`mCuDïth
(
cuDïth
),

52 
	`mSe˘i⁄
(0),

53 
	`mS∂ôMode
(
DONT_SPLIT
),

54 
	`mAbsP¨tIdxCU
(
absP¨tIdxCU
),

55 
	`mAbsP¨tIdxTURñCU
(0),

56 
	`mAbsP¨tIdxSãp
(
pcCU
->
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (pcCU->
	`gëDïth
(
absP¨tIdxCU
)<<1)),

57 
	`mpcCU
(
pcCU
),

58 
	`mLog2TrLumaSize
(0),

59 
	$mpP¨ít
(
NULL
)

61 c⁄° 
TComSPS
 *
pSPS
=
pcCU
->
	`gëSli˚
()->
	`gëSPS
();

62 
mLog2TrLumaSize
 = 
g_aucC⁄vîtToBô
[
pSPS
->
	`gëMaxCUWidth
(Ë>> (
mCuDïth
+
öôTrDïthRñCU
)]+2;

64 c⁄° 
UI¡
 
ba£Off£t444
=
pcCU
->
	`gëPic
()->
	`gëMöCUWidth
()*pcCU->gëPic()->
	`gëMöCUHeight
()*
absP¨tIdxCU
;

66 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

68 
mTrDïthRñCU
[
i
] = 
öôTrDïthRñCU
;

69 c⁄° 
UI¡
 
csx
=
	`gëComp⁄ítSˇÀX
(
	`Comp⁄ítID
(
i
), 
mChromaF‹m©
);

70 c⁄° 
UI¡
 
csy
=
	`gëComp⁄ítSˇÀY
(
	`Comp⁄ítID
(
i
), 
mChromaF‹m©
);

71 
mOrigWidth
[
i
]=
mRe˘
[i].
width
 = (ò< 
	`gëNumbîVÆidComp⁄íts
(
mChromaF‹m©
)Ë? (
pcCU
->
	`gëWidth
–
absP¨tIdxCU
Ë>> 
csx
) : 0;

72 
mRe˘
[
i
].
height
 = (ò< 
	`gëNumbîVÆidComp⁄íts
(
mChromaF‹m©
)Ë? (
pcCU
->
	`gëHeight
(
absP¨tIdxCU
Ë>> 
csy
) : 0;

73 
mRe˘
[
i
].
x0
=0;

74 
mRe˘
[
i
].
y0
=0;

75 
mCodeAŒ
[
i
]=
åue
;

76 
mOff£ts
[
i
]=
ba£Off£t444
>>(
csx
+
csy
);

78 
	}
}

82 
	gTComTURecur£
::
	$TComTURecur£
–
TComD©aCU
 *
pcCU
,

83 c⁄° 
UI¡
 
absP¨tIdxCU
)

84 : 
	`TComTU
(
pcCU
, 
absP¨tIdxCU
,ÖcCU->
	`gëDïth
(absPartIdxCU), 0)

85 { 
	}
}

89 
	gTComTU
::
	$TComTU
(
TComTU
 &
∑ª¡
, c⁄° 
Boﬁ
 
bPro˚ssLa°OfLevñ
, c⁄° 
TU_SPLIT_MODE
 
•lôMode
, c⁄° Boﬁ 
•lôAtCuºítDïth
, c⁄° 
Comp⁄ítID
 
absP¨tIdxSour˚Comp⁄ít
)

90 : 
	`mChromaF‹m©
(
∑ª¡
.
mChromaF‹m©
),

91 
	`mbPro˚ssLa°OfLevñ
(
bPro˚ssLa°OfLevñ
),

92 
	`mCuDïth
(
∑ª¡
.
mCuDïth
),

93 
	`mSe˘i⁄
(0),

94 
	`mS∂ôMode
(
•lôMode
),

95 
	`mAbsP¨tIdxCU
(
∑ª¡
.
mAbsP¨tIdxCU
),

96 
	`mAbsP¨tIdxTURñCU
(
∑ª¡
.
	`GëRñP¨tIdxTU
(
absP¨tIdxSour˚Comp⁄ít
)),

97 
	`mAbsP¨tIdxSãp
(
°d
::
max
<
UI¡
>(1, (
∑ª¡
.
	`GëAbsP¨tIdxNumP¨ts
(
absP¨tIdxSour˚Comp⁄ít
Ë>> 
∑πIdxSãpShi·
[
•lôMode
]))),

98 
	`mpcCU
(
∑ª¡
.
mpcCU
),

99 
	`mLog2TrLumaSize
(
∑ª¡
.
mLog2TrLumaSize
 - ((
•lôMode
 !
QUAD_SPLIT
) ? 0 : 1)),

100 
	$mpP¨ít
(&
∑ª¡
)

102 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

104 
mTrDïthRñCU
[
i
] = 
∑ª¡
.mTrDïthRñCU[i] + ((
•lôAtCuºítDïth
 || (
•lôMode
 =
DONT_SPLIT
)) ? 0 : 1);

107 i‡(
mS∂ôMode
==
DONT_SPLIT
)

109 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

111 
mRe˘
[
i
] = (
∑ª¡
.mRect[i]);

112 
mOff£ts
[
i
]=
∑ª¡
.mOffsets[i];

113 
mCodeAŒ
[
i
]=
åue
;

114 
mOrigWidth
[
i
]=
mRe˘
[i].
width
;

118 i‡(
mS∂ôMode
==
VERTICAL_SPLIT
)

120 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

122 
mRe˘
[
i
].
x0
 = (
∑ª¡
.mRect[i].x0);

123 
mRe˘
[
i
].
y0
 = (
∑ª¡
.mRect[i].y0);

124 
mRe˘
[
i
].
width
 = (
∑ª¡
.mRect[i].width);

125 
mRe˘
[
i
].
height
 = (
∑ª¡
.mRect[i].height)>>1;

126 
mOff£ts
[
i
]=
∑ª¡
.mOffsets[i];

127 
mCodeAŒ
[
i
]=
åue
;

128 
mOrigWidth
[
i
]=
mRe˘
[i].
width
;

133 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

135 
mRe˘
[
i
].
width
 = (
∑ª¡
.mRect[i].width >> 1);

136 
mRe˘
[
i
].
height
(
∑ª¡
.mRect[i].height>> 1);

137 
mRe˘
[
i
].
x0
=
∑ª¡
.mRect[i].x0;

138 
mRe˘
[
i
].
y0
=
∑ª¡
.mRect[i].y0;

139 
mOff£ts
[
i
]=
∑ª¡
.mOffsets[i];

141 i‡((
mRe˘
[
i
].
width
 < 
MIN_TU_SIZE
 || mRe˘[i].
height
 < MIN_TU_SIZE) && mRect[i].width!=0)

143 c⁄° 
UI¡
 
numPñs
=
mRe˘
[
i
].
width
 * mRe˘[i].
height
;

144 i‡(
numPñs
 < (
MIN_TU_SIZE
*MIN_TU_SIZE))

147 
mRe˘
[
i
].
width
 = 
∑ª¡
.mRect[i].width;

148 
mRe˘
[
i
].
height

∑ª¡
.mRect[i].height;

149 
mCodeAŒ
[
i
]=
Ál£
;

150 
mTrDïthRñCU
[
i
]--;

152 i‡(
mRe˘
[
i
].
width
 < mRe˘[i].
height
)

154 
mRe˘
[
i
].
width
=
MIN_TU_SIZE
;

155 
mRe˘
[
i
].
height
=
numPñs
/
MIN_TU_SIZE
;

156 
mCodeAŒ
[
i
]=
åue
;

160 
mRe˘
[
i
].
height
=
MIN_TU_SIZE
;

161 
mRe˘
[
i
].
width
=
numPñs
/
MIN_TU_SIZE
;

162 
mCodeAŒ
[
i
]=
åue
;

167 
mCodeAŒ
[
i
]=
åue
;

170 
mOrigWidth
[
i
]=
mRe˘
[i].
width
;

171 i‡(!
mCodeAŒ
[
i
] && 
mbPro˚ssLa°OfLevñ
)

173 
mRe˘
[
i
].
width
=0;

176 
	}
}

178 
Boﬁ
 
	gTComTURecur£
::
	$√xtSe˘i⁄
(c⁄° 
TComTU
 &
∑ª¡
)

180 i‡(
mS∂ôMode
==
DONT_SPLIT
)

182 
mSe˘i⁄
++;

183  
Ál£
;

187 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

189 
mOff£ts
[
i
]+=
mRe˘
[i].
width
*mRe˘[i].
height
;

190 i‡(
mbPro˚ssLa°OfLevñ
)

192 
mRe˘
[
i
].
width
=
mOrigWidth
[i];

194 
mRe˘
[
i
].
x0
+=mRe˘[i].
width
;

195 c⁄° 
TComRe˘™gÀ
 &
∑ª¡Re˘
=
∑ª¡
.
	`gëRe˘
(
	`Comp⁄ítID
(
i
));

196 i‡(
mRe˘
[
i
].
x0
 >
∑ª¡Re˘
.x0+∑ª¡Re˘.
width
)

198 
mRe˘
[
i
].
x0
=
∑ª¡Re˘
.x0;

199 
mRe˘
[
i
].
y0
+=mRe˘[i].
height
;

201 i‡(!
mCodeAŒ
[
i
])

203 i‡(!
mbPro˚ssLa°OfLevñ
 || 
mSe˘i⁄
!=2)

205 
mRe˘
[
i
].
width
=0;

209 
	`as£π
(
mRe˘
[
COMPONENT_Cb
].
x0
==mRe˘[
COMPONENT_Cr
].x0);

210 
	`as£π
(
mRe˘
[
COMPONENT_Cb
].
y0
==mRe˘[
COMPONENT_Cr
].y0);

211 
	`as£π
(
mRe˘
[
COMPONENT_Cb
].
width
==mRe˘[
COMPONENT_Cr
].width);

212 
	`as£π
(
mRe˘
[
COMPONENT_Cb
].
height
==mRe˘[
COMPONENT_Cr
].height);

214 
mAbsP¨tIdxTURñCU
+=
mAbsP¨tIdxSãp
;

215 
mSe˘i⁄
++;

216  
mSe˘i⁄
< (1<<
mS∂ôMode
);

218 
	}
}

221 
UI¡
 
	gTComTU
::
	$GëEquivÆítLog2TrSize
(c⁄° 
Comp⁄ítID
 
compID
) const

223  
g_aucC⁄vîtToBô
[ 
	`gëRe˘
(
compID
).
height
 ] + 2;

224 
	}
}

227 
Boﬁ
 
	gTComTU
::
	$u£DST
(c⁄° 
Comp⁄ítID
 
compID
)

229 
TComD©aCU
 *c⁄° 
pcCU
 = 
	`gëCU
();

230 c⁄° 
UI¡
 
absP¨tIdx
 = 
	`GëAbsP¨tIdxTU
(
compID
);

232  
	`isLuma
(
compID
Ë&& 
pcCU
->
	`isI¡ø
(
absP¨tIdx
);

233 
	}
}

236 
Boﬁ
 
	gTComTU
::
	$isN⁄Tønsf‹medResiduÆRŸ©ed
(c⁄° 
Comp⁄ítID
 
compID
)

239  
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëTønsf‹mSkùRŸ©i⁄E«bÀdFœg
()

240 && 
mRe˘
[
compID
].
width
 == 4

241 && 
	`gëCU
()->
	`isI¡ø
(
	`GëAbsP¨tIdxTU
());

242 
	}
}

245 
UI¡
 
	gTComTU
::
	$gëGﬁombRi˚Sèti°icsIndex
(c⁄° 
Comp⁄ítID
 
compID
)

247 
TComD©aCU
 *c⁄° 
pcCU
 = 
	`gëCU
();

248 c⁄° 
UI¡
 
absP¨tIdx
 = 
	`GëAbsP¨tIdxTU
(
compID
);

249 c⁄° 
Boﬁ
 
å™sf‹mSkù
 = 
pcCU
->
	`gëTønsf‹mSkù
(
absP¨tIdx
, 
compID
);

250 c⁄° 
Boﬁ
 
å™squ™tBy∑ss
 = 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
absP¨tIdx
);

254 c⁄° 
UI¡
 
ch™√lTy≥Off£t
 = 
	`isChroma
(
compID
) ? 2 : 0;

255 c⁄° 
UI¡
 
n⁄Tønsf‹medOff£t
 = (
å™sf‹mSkù
 || 
å™squ™tBy∑ss
) ? 1 : 0;

259 c⁄° 
UI¡
 
£À˘edIndex
 = 
ch™√lTy≥Off£t
 + 
n⁄Tønsf‹medOff£t
;

260 
	`as£π
(
£À˘edIndex
 < 
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
);

262  
£À˘edIndex
;

263 
	}
}

	@TLibCommon/TComTU.h

34 #i‚de‡
__TCOMTU__


35 
	#__TCOMTU__


	)

37 
˛ass
 
	gTComTU
;

39 
	~"Comm⁄Def.h
"

40 
	~"TComRe˘™gÀ.h
"

41 
	~"TComChromaF‹m©.h
"

43 
˛ass
 
	gTComD©aCU
;

48 ˛as†
	cTComTU


50 
	mpublic
:

51 
	eTU_SPLIT_MODE
 { 
DONT_SPLIT
=0, 
	mVERTICAL_SPLIT
=1, 
	mQUAD_SPLIT
=2, 
	mNUMBER_OF_SPLIT_MODES
=3 } 
	tSPLIT_MODE
;

53 c⁄° 
UI¡
 
	gNUMBER_OF_SECTIONS
[
NUMBER_OF_SPLIT_MODES
];

55 
	g¥Ÿe˘ed
:

56 
ChromaF‹m©
 
mChromaF‹m©
;

57 
Boﬁ
 
	gmbPro˚ssLa°OfLevñ
;

58 
UI¡
 
	gmCuDïth
;

59 
UI¡
 
	gmTrDïthRñCU
[
MAX_NUM_COMPONENT
];

60 
UI¡
 
	gmSe˘i⁄
;

61 
TU_SPLIT_MODE
 
	gmS∂ôMode
;

62 
TComRe˘™gÀ
 
	gmRe˘
[
MAX_NUM_COMPONENT
];

63 
Boﬁ
 
	gmCodeAŒ
[
MAX_NUM_COMPONENT
];

64 
UI¡
 
	gmOrigWidth
[
MAX_NUM_COMPONENT
];

65 
UI¡
 
	gmOff£ts
[
MAX_NUM_COMPONENT
];

66 
UI¡
 
	gmAbsP¨tIdxCU
;

67 
UI¡
 
	gmAbsP¨tIdxTURñCU
;

68 
UI¡
 
	gmAbsP¨tIdxSãp
;

69 
TComD©aCU
 *
	gmpcCU
;

70 
UI¡
 
	gmLog2TrLumaSize
;

71 
TComTU
 *
	gmpP¨ít
;

73 
TComTU
(const TComTU &);

74 
	gTComTU
&
	g›î©‹
=(c⁄° 
TComTU
 &);

76 
	gpublic
:

77 
TComTU
–
TComD©aCU
 *
pcCU
,

78 c⁄° 
UI¡
 
absP¨tIdxCU
,

79 c⁄° 
UI¡
 
cuDïth
,

80 c⁄° 
UI¡
 
öôTrDïthRñCU
);

82 
	g¥Ÿe˘ed
:

83 
TComTU
–TComTU &
∑ª¡Levñ
,

84 c⁄° 
Boﬁ
 
bPro˚ssLa°OfLevñ
,

85 c⁄° 
TU_SPLIT_MODE
 
•lôMode
 = 
QUAD_SPLIT
,

86 c⁄° 
Boﬁ
 
•lôAtCuºítDïth
 = 
Ál£
,

87 c⁄° 
Comp⁄ítID
 
absP¨tIdxSour˚Comp⁄ít
 = 
COMPONENT_Y


90 
	gpublic
:

91 
TComTU
 *
	$P¨ít
(Ë{  
mpP¨ít
; 
	}
}

92 c⁄° 
TComTU
 *
	$P¨ít
(Ëc⁄° {  
mpP¨ít
; 
	}
}

94 
UI¡
 
	$gëC€fficõ¡Off£t
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
mOff£ts
[compID]; 
	}
}

96 c⁄° 
	gTComRe˘™gÀ
 &
	$gëRe˘
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
mRe˘
[compID]; 
	}
}

98 
Boﬁ
 
	$Pro˚ssögAŒQuadø¡s
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
mCodeAŒ
[compID]; 
	}
}

99 
Boﬁ
 
	$Pro˚ssComp⁄ítSe˘i⁄
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
mRe˘
[compID].
width
 !0; 
	}
}

100 
Boﬁ
 
	$Pro˚ssCh™√lSe˘i⁄
(c⁄° 
Ch™√lTy≥
 
chTy≥
Ëc⁄° {  
mRe˘
[chTy≥].
width
 !0; 
	}
}

101 
UI¡
 
	$GëSe˘i⁄Numbî
(Ëc⁄° {  
mSe˘i⁄
; 
	}
}

103 
UI¡
 
	$gëCUDïth
(Ëc⁄° {  
mCuDïth
; 
	}
}

105 
UI¡
 
	$GëTønsf‹mDïthTŸÆ
(Ëc⁄° {  
mCuDïth
+
	`GëTønsf‹mDïthRñ
(); 
	}
}

106 
UI¡
 
	$GëTønsf‹mDïthTŸÆAdj
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
mCuDïth
+
	`GëTønsf‹mDïthRñAdj
(compID); 
	}
}

108 
UI¡
 
	$GëTønsf‹mDïthRñ
(Ëc⁄° {  
mTrDïthRñCU
[
COMPONENT_Y
]; 
	}
}

109 
UI¡
 
	$GëTønsf‹mDïthRñAdj
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
mTrDïthRñCU
[compID]; 
	}
}

110 
UI¡
 
	$GëTønsf‹mDïthRñAdj
(c⁄° 
Ch™√lTy≥
 
chTy≥
) const

112 
	`as£π
(
	`isLuma
(
chTy≥
Ë|| (
mTrDïthRñCU
[
COMPONENT_Cb
] =mTrDïthRñCU[
COMPONENT_Cr
]));

113  
mTrDïthRñCU
[
	`isLuma
(
chTy≥
Ë? 
COMPONENT_Y
 : 
COMPONENT_Cb
];

114 
	}
}

116 
UI¡
 
	$GëAbsP¨tIdxCU
(Ëc⁄° {  
mAbsP¨tIdxCU
; 
	}
}

117 
UI¡
 
	$GëRñP¨tIdxTU
(Ëc⁄° {  
mAbsP¨tIdxTURñCU
; 
	}
}

118 
UI¡
 
	$GëRñP¨tIdxTU
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
	`Pro˚ssögAŒQuadø¡s
(compIDË? 
mAbsP¨tIdxTURñCU
 : (mAbsP¨tIdxTURñCU & (~0x3)); 
	}
}

119 
UI¡
 
	$GëAbsP¨tIdxTU
(Ëc⁄° {  
	`GëAbsP¨tIdxCU
(Ë+ 
	`GëRñP¨tIdxTU
(); 
	}
}

120 
UI¡
 
	$GëAbsP¨tIdxTU
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
	`GëAbsP¨tIdxCU
(Ë+ 
	`GëRñP¨tIdxTU
(compID); 
	}
}

121 
UI¡
 
	$GëAbsP¨tIdxNumP¨ts
(Ëc⁄° {  
mAbsP¨tIdxSãp
; 
	}
}

122 
UI¡
 
	$GëAbsP¨tIdxNumP¨ts
(c⁄° 
Comp⁄ítID
 
compID
Ëc⁄° {  
	`Pro˚ssögAŒQuadø¡s
(compIDË? 
mAbsP¨tIdxSãp
 : (mAbsP¨tIdxSã∞* 
NUMBER_OF_SECTIONS
[
mS∂ôMode
]); 
	}
}

124 
ChromaF‹m©
 
	$GëChromaF‹m©
(Ëc⁄° {  
mChromaF‹m©
; 
	}
}

126 
TComD©aCU
 *
	$gëCU
(Ë{  
mpcCU
; 
	}
}

127 c⁄° 
TComD©aCU
 *
	$gëCU
(Ëc⁄° {  
mpcCU
; 
	}
}

128 
Boﬁ
 
	$IsLa°Se˘i⁄
(Ëc⁄° {  
mSe˘i⁄
+1>=((1<<
mS∂ôMode
)); 
	}
}

130 
UI¡
 
	$GëLog2LumaTrSize
(Ëc⁄° {  
mLog2TrLumaSize
; 
	}
}

131 
UI¡
 
	$GëEquivÆítLog2TrSize
(c⁄° 
Comp⁄ítID
 
compID
) const;

132 
TU_SPLIT_MODE
 
	$GëS∂ôMode
(Ëc⁄° {  
mS∂ôMode
; 
	}
}

134 
Boﬁ
 
u£DST
(c⁄° 
Comp⁄ítID
 
compID
);

135 
Boﬁ
 
isN⁄Tønsf‹medResiduÆRŸ©ed
(c⁄° 
Comp⁄ítID
 
compID
);

137 
UI¡
 
gëGﬁombRi˚Sèti°icsIndex
(c⁄° 
Comp⁄ítID
 
compID
);

142 ˛as†
	cTComTURecur£
 : 
public
 
TComTU


144 
public
:

146 
	$TComTURecur£
–
TComD©aCU
 *
pcCU
,

147 c⁄° 
UI¡
 
absP¨tIdxCU
,

148 c⁄° 
UI¡
 
f‹˚dDïthOfCU
)

149 : 
	$TComTU
(
pcCU
, 
absP¨tIdxCU
, 
f‹˚dDïthOfCU
, 0) { }

151 
	`TComTURecur£
–
TComD©aCU
 *
pcCU
,

152 c⁄° 
UI¡
 
absP¨tIdxCU
);

154 
	$TComTURecur£
–
TComTU
 &
∑ª¡Levñ
,

155 c⁄° 
Boﬁ
 
bPro˚ssLa°OfLevñ
,

156 c⁄° 
TU_SPLIT_MODE
 
•lôMode
 = 
QUAD_SPLIT
,

157 c⁄° 
Boﬁ
 
•lôAtCuºítDïth
 = 
Ál£
,

158 c⁄° 
Comp⁄ítID
 
absP¨tIdxSour˚Comp⁄ít
 = 
COMPONENT_Y


160 : 
	$TComTU
(
∑ª¡Levñ
, 
bPro˚ssLa°OfLevñ
, 
•lôMode
, 
•lôAtCuºítDïth
, 
absP¨tIdxSour˚Comp⁄ít
Ë{ 
	}
}

162 
Boﬁ
 
√xtSe˘i⁄
(c⁄° 
TComTU
 &
∑ª¡
);

	@TLibCommon/TComTrQuant.cpp

38 
	~<°dlib.h
>

39 
	~<m©h.h
>

40 
	~<limôs
>

41 
	~<mem‹y.h
>

42 
	~"TComTrQu™t.h
"

43 
	~"TComPic.h
"

44 
	~"C⁄ãxtTabÀs.h
"

45 
	~"TComTU.h
"

46 
	~"Debug.h
"

50 
I¡
 
	miNNZbef‹ePos0
;

51 
DoubÀ
 
	md64CodedLevñ™dDi°
;

52 
DoubÀ
 
	md64UncodedDi°
;

53 
DoubÀ
 
	md64SigCo°
;

54 
DoubÀ
 
	md64SigCo°_0
;

55 } 
	tc€ffGroupRDSèts
;

64 
	#RDOQ_CHROMA
 1

65 

	)

71 
	gQpP¨am
::
	$QpP¨am
(c⁄° 
I¡
 
qpy
,

72 c⁄° 
Ch™√lTy≥
 
chTy≥
,

73 c⁄° 
I¡
 
qpBdOff£t
,

74 c⁄° 
I¡
 
chromaQPOff£t
,

75 c⁄° 
ChromaF‹m©
 
chFmt
 )

77 
I¡
 
ba£Qp
;

79 if(
	`isLuma
(
chTy≥
))

81 
ba£Qp
 = 
qpy
 + 
qpBdOff£t
;

85 
ba£Qp
 = 
	`Clù3
–-
qpBdOff£t
, (
chromaQPM≠pögTabÀSize
 - 1), 
qpy
 + 
chromaQPOff£t
 );

87 if(
ba£Qp
 < 0)

89 
ba£Qp
 = ba£Q∞+ 
qpBdOff£t
;

93 
ba£Qp
 = 
	`gëSˇÀdChromaQP
(ba£Qp, 
chFmt
Ë+ 
qpBdOff£t
;

97 
Qp
 =
ba£Qp
;

98 
≥r
=
ba£Qp
/6;

99 
ªm
=
ba£Qp
%6;

100 
	}
}

102 
	gQpP¨am
::
	$QpP¨am
(c⁄° 
TComD©aCU
 &
cu
, c⁄° 
Comp⁄ítID
 
compID
)

104 
I¡
 
chromaQpOff£t
 = 0;

106 i‡(
	`isChroma
(
compID
))

108 
chromaQpOff£t
 +
cu
.
	`gëSli˚
()->
	`gëPPS
()->
	`gëQpOff£t
(
compID
);

109 
chromaQpOff£t
 +
cu
.
	`gëSli˚
()->
	`gëSli˚ChromaQpDñè
(
compID
);

111 
chromaQpOff£t
 +
cu
.
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°E¡ry
(cu.
	`gëChromaQpAdj
(0)).
u
.
off£t
[
	`I¡
(
compID
)-1];

114 *
this
 = 
	`QpP¨am
(
cu
.
	`gëQP
( 0 ),

115 
	`toCh™√lTy≥
(
compID
),

116 
cu
.
	`gëSli˚
()->
	`gëSPS
()->
	`gëQpBDOff£t
(
	`toCh™√lTy≥
(
compID
)),

117 
chromaQpOff£t
,

118 
cu
.
	`gëPic
()->
	`gëChromaF‹m©
());

119 
	}
}

126 
	gTComTrQu™t
::
	$TComTrQu™t
()

129 
m_∂TempC€ff
 = 
√w
 
TC€ff
[ 
MAX_CU_SIZE
*MAX_CU_SIZE ];

132 
m_pcE°BôsSbac
 = 
√w
 
e°BôsSbacSåu˘
;

133 
	`öôSˇlögLi°
();

134 
	}
}

136 
	gTComTrQu™t
::~
	$TComTrQu™t
()

139 i‡–
m_∂TempC€ff
 )

141 
dñëe
 [] 
m_∂TempC€ff
;

142 
m_∂TempC€ff
 = 
NULL
;

146 i‡–
m_pcE°BôsSbac
 )

148 
dñëe
 
m_pcE°BôsSbac
;

150 
	`de°roySˇlögLi°
();

151 
	}
}

153 #i‡
ADAPTIVE_QP_SELECTION


154 
Void
 
	gTComTrQu™t
::
	$°‹eSli˚QpNext
(
TComSli˚
* 
pcSli˚
)

158 
I¡
 
qpBa£
 = 
pcSli˚
->
	`gëSli˚QpBa£
();

159 
I¡
 
¶i˚Qpu£d
 = 
pcSli˚
->
	`gëSli˚Qp
();

160 
I¡
 
¶i˚Q≤ext
;

161 
DoubÀ
 
Æpha
 = 
qpBa£
 < 17 ? 0.5 : 1;

163 
I¡
 
˙t
=0;

164 
I¡
 
u
=1; u<=
LEVEL_RANGE
; u++)

166 
˙t
 +
m_¶i˚Nßm∂es
[
u
] ;

169 if–!
m_u£RDOQ
 )

171 
¶i˚Qpu£d
 = 
qpBa£
;

172 
Æpha
 = 0.5;

175 if–
˙t
 > 120 )

177 
DoubÀ
 
sum
 = 0;

178 
I¡
 
k
 = 0;

179 
I¡
 
u
=1; u<
LEVEL_RANGE
; u++)

181 
sum
 +
u
*
m_¶i˚SumC
[u];

182 
k
 +
u
*u*
m_¶i˚Nßm∂es
[u];

185 
I¡
 
v
;

186 
DoubÀ
 
q
[
MAX_QP
+1] ;

187 
v
=0; v<=
MAX_QP
; v++)

189 
q
[
v
] = (
DoubÀ
)(
g_övQu™tSˇÀs
[v%6] * (1<<(v/6)))/64 ;

192 
DoubÀ
 
q√xt
 = 
sum
/
k
 * 
q
[
¶i˚Qpu£d
] / (1<<
ARL_C_PRECISION
);

194 
v
=0; v<
MAX_QP
; v++)

196 if(
q√xt
 < 
Æpha
 * 
q
[
v
] + (1 -álpha) * q[v+1] )

201 
¶i˚Q≤ext
 = 
	`Clù3
(
¶i˚Qpu£d
 - 3, sli˚Qpu£d + 3, 
v
);

205 
¶i˚Q≤ext
 = 
¶i˚Qpu£d
;

208 
m_qpDñè
[
qpBa£
] = 
¶i˚Q≤ext
 - qpBase;

209 
	}
}

211 
Void
 
	gTComTrQu™t
::
	$öôSli˚QpDñè
()

213 
I¡
 
qp
=0; qp<=
MAX_QP
; qp++)

215 
m_qpDñè
[
qp
] = qp < 17 ? 0 : 1;

217 
	}
}

219 
Void
 
	gTComTrQu™t
::
	$˛órSli˚ARLC¡
()

221 
	`mem£t
(
m_¶i˚SumC
, 0, (
DoubÀ
)*(
LEVEL_RANGE
+1));

222 
	`mem£t
(
m_¶i˚Nßm∂es
, 0, (
I¡
)*(
LEVEL_RANGE
+1));

223 
	}
}

228 #i‡
MATRIX_MULT


236 
Void
 
	$xTr
(
I¡
 
bôDïth
, 
Pñ
 *
block
, 
TC€ff
 *
c€ff
, 
UI¡
 
uiSåide
, UI¡ 
uiTrSize
, 
Boﬁ
 
u£DST
, c⁄° I¡ 
maxLog2TrDy«micR™ge
)

238 
UI¡
 
i
,
j
,
k
;

239 
TC€ff
 
iSum
;

240 
TC€ff
 
tmp
[
MAX_TU_SIZE
 * MAX_TU_SIZE];

241 c⁄° 
TM©rixC€ff
 *
iT
;

242 
UI¡
 
uiLog2TrSize
 = 
g_aucC⁄vîtToBô
[ 
uiTrSize
 ] + 2;

244 i‡(
uiTrSize
==4)

246 
iT
 = (
u£DST
 ? 
g_as_DST_MAT_4
[
TRANSFORM_FORWARD
][0] : 
g_aiT4
[TRANSFORM_FORWARD][0]);

248 i‡(
uiTrSize
==8)

250 
iT
 = 
g_aiT8
[
TRANSFORM_FORWARD
][0];

252 i‡(
uiTrSize
==16)

254 
iT
 = 
g_aiT16
[
TRANSFORM_FORWARD
][0];

256 i‡(
uiTrSize
==32)

258 
iT
 = 
g_aiT32
[
TRANSFORM_FORWARD
][0];

262 
	`as£π
(0);

265 c⁄° 
I¡
 
TRANSFORM_MATRIX_SHIFT
 = 
g_å™sf‹mM©rixShi·
[
TRANSFORM_FORWARD
];

267 c⁄° 
I¡
 
shi·_1°
 = (
uiLog2TrSize
 + 
bôDïth
 + 
TRANSFORM_MATRIX_SHIFT
Ë- 
maxLog2TrDy«micR™ge
;

268 c⁄° 
I¡
 
shi·_2nd
 = 
uiLog2TrSize
 + 
TRANSFORM_MATRIX_SHIFT
;

269 c⁄° 
I¡
 
add_1°
 = (
shi·_1°
>0) ? (1<<(shift_1st-1)) : 0;

270 c⁄° 
I¡
 
add_2nd
 = 1<<(
shi·_2nd
-1);

274 
i
=0; i<
uiTrSize
; i++)

276 
j
=0; j<
uiTrSize
; j++)

278 
iSum
 = 0;

279 
k
=0; k<
uiTrSize
; k++)

281 
iSum
 +
iT
[
i
*
uiTrSize
+
k
]*
block
[
j
*
uiSåide
+k];

283 
tmp
[
i
*
uiTrSize
+
j
] = (
iSum
 + 
add_1°
)>>
shi·_1°
;

288 
i
=0; i<
uiTrSize
; i++)

290 
j
=0; j<
uiTrSize
; j++)

292 
iSum
 = 0;

293 
k
=0; k<
uiTrSize
; k++)

295 
iSum
 +
iT
[
i
*
uiTrSize
+
k
]*
tmp
[
j
*uiTrSize+k];

297 
c€ff
[
i
*
uiTrSize
+
j
] = (
iSum
 + 
add_2nd
)>>
shi·_2nd
;

300 
	}
}

309 
Void
 
	$xITr
(
I¡
 
bôDïth
, 
TC€ff
 *
c€ff
, 
Pñ
 *
block
, 
UI¡
 
uiSåide
, UI¡ 
uiTrSize
, 
Boﬁ
 
u£DST
, c⁄° I¡ 
maxLog2TrDy«micR™ge
)

311 
UI¡
 
i
,
j
,
k
;

312 
TC€ff
 
iSum
;

313 
TC€ff
 
tmp
[
MAX_TU_SIZE
 * MAX_TU_SIZE];

314 c⁄° 
TM©rixC€ff
 *
iT
;

316 i‡(
uiTrSize
==4)

318 
iT
 = (
u£DST
 ? 
g_as_DST_MAT_4
[
TRANSFORM_INVERSE
][0] : 
g_aiT4
[TRANSFORM_INVERSE][0]);

320 i‡(
uiTrSize
==8)

322 
iT
 = 
g_aiT8
[
TRANSFORM_INVERSE
][0];

324 i‡(
uiTrSize
==16)

326 
iT
 = 
g_aiT16
[
TRANSFORM_INVERSE
][0];

328 i‡(
uiTrSize
==32)

330 
iT
 = 
g_aiT32
[
TRANSFORM_INVERSE
][0];

334 
	`as£π
(0);

337 c⁄° 
I¡
 
TRANSFORM_MATRIX_SHIFT
 = 
g_å™sf‹mM©rixShi·
[
TRANSFORM_INVERSE
];

339 c⁄° 
I¡
 
shi·_1°
 = 
TRANSFORM_MATRIX_SHIFT
 + 1;

340 c⁄° 
I¡
 
shi·_2nd
 = (
TRANSFORM_MATRIX_SHIFT
 + 
maxLog2TrDy«micR™ge
 - 1Ë- 
bôDïth
;

341 c⁄° 
TC€ff
 
˛ùMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

342 c⁄° 
TC€ff
 
˛ùMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

343 
	`as£π
(
shi·_2nd
>=0);

344 c⁄° 
I¡
 
add_1°
 = 1<<(
shi·_1°
-1);

345 c⁄° 
I¡
 
add_2nd
 = (
shi·_2nd
>0) ? (1<<(shift_2nd-1)) : 0;

348 
i
=0; i<
uiTrSize
; i++)

350 
j
=0; j<
uiTrSize
; j++)

352 
iSum
 = 0;

353 
k
=0; k<
uiTrSize
; k++)

355 
iSum
 +
iT
[
k
*
uiTrSize
+
i
]*
c€ff
[k*uiTrSize+
j
];

359 
tmp
[
i
*
uiTrSize
+
j
] = 
Clù3
<
TC€ff
>(
˛ùMöimum
, 
˛ùMaximum
, (
iSum
 + 
add_1°
)>>
shi·_1°
);

364 
i
=0; i<
uiTrSize
; i++)

366 
j
=0; j<
uiTrSize
; j++)

368 
iSum
 = 0;

369 
k
=0; k<
uiTrSize
; k++)

371 
iSum
 +
iT
[
k
*
uiTrSize
+
j
]*
tmp
[
i
*uiTrSize+k];

374 
block
[
i
*
uiSåide
+
j
] = 
Clù3
<
TC€ff
>(
°d
::
numîic_limôs
<
Pñ
>::
	`mö
(), std::numîic_limôs<Pñ>::
	`max
(), (
iSum
 + 
add_2nd
)>>
shi·_2nd
);

377 
	}
}

388 
Void
 
	$∑πülBuâîÊy4
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
)

390 
I¡
 
j
;

391 
TC€ff
 
E
[2],
O
[2];

392 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

394 
j
=0; j<
löe
; j++)

397 
E
[0] = 
§c
[0] + src[3];

398 
O
[0] = 
§c
[0] - src[3];

399 
E
[1] = 
§c
[1] + src[2];

400 
O
[1] = 
§c
[1] - src[2];

402 
d°
[0] = (
g_aiT4
[
TRANSFORM_FORWARD
][0][0]*
E
[0] + g_aiT4[TRANSFORM_FORWARD][0][1]*E[1] + 
add
)>>
shi·
;

403 
d°
[2*
löe
] = (
g_aiT4
[
TRANSFORM_FORWARD
][2][0]*
E
[0] + g_aiT4[TRANSFORM_FORWARD][2][1]*E[1] + 
add
)>>
shi·
;

404 
d°
[
löe
] = (
g_aiT4
[
TRANSFORM_FORWARD
][1][0]*
O
[0] + g_aiT4[TRANSFORM_FORWARD][1][1]*O[1] + 
add
)>>
shi·
;

405 
d°
[3*
löe
] = (
g_aiT4
[
TRANSFORM_FORWARD
][3][0]*
O
[0] + g_aiT4[TRANSFORM_FORWARD][3][1]*O[1] + 
add
)>>
shi·
;

407 
§c
 += 4;

408 
d°
 ++;

410 
	}
}

414 
Void
 
	$Á°F‹w¨dD°
(
TC€ff
 *
block
, TC€f‡*
c€ff
, 
I¡
 
shi·
)

416 
I¡
 
i
;

417 
TC€ff
 
c
[4];

418 
TC€ff
 
∫d_Á˘‹
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

419 
i
=0; i<4; i++)

422 
c
[0] = 
block
[4*
i
+0];

423 
c
[1] = 
block
[4*
i
+1];

424 
c
[2] = 
block
[4*
i
+2];

425 
c
[3] = 
block
[4*
i
+3];

427 
I¡
 
row
 = 0;Ñow < 4;Ñow++)

429 
TC€ff
 
ªsu…
 = 0;

430 
I¡
 
cﬁumn
 = 0; column < 4; column++)

432 
ªsu…
 +
c
[
cﬁumn
] * 
g_as_DST_MAT_4
[
TRANSFORM_FORWARD
][
row
][column];

435 
c€ff
[(
row
 * 4Ë+ 
i
] = 
	`rightShi·
((
ªsu…
 + 
∫d_Á˘‹
), 
shi·
);

438 
	}
}

440 
Void
 
	$Á°Invî£D°
(
TC€ff
 *
tmp
, TC€f‡*
block
, 
I¡
 
shi·
, c⁄° TC€f‡
ouçutMöimum
, c⁄° TC€f‡
ouçutMaximum
)

442 
I¡
 
i
;

443 
TC€ff
 
c
[4];

444 
TC€ff
 
∫d_Á˘‹
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

445 
i
=0; i<4; i++)

448 
c
[0] = 
tmp
[ 
i
];

449 
c
[1] = 
tmp
[4 +
i
];

450 
c
[2] = 
tmp
[8 +
i
];

451 
c
[3] = 
tmp
[12+
i
];

453 
I¡
 
cﬁumn
 = 0; column < 4; column++)

455 
TC€ff
 &
ªsu…
 = 
block
[(
i
 * 4Ë+ 
cﬁumn
];

457 
ªsu…
 = 0;

458 
I¡
 
row
 = 0;Ñow < 4;Ñow++)

460 
ªsu…
 +
c
[
row
] * 
g_as_DST_MAT_4
[
TRANSFORM_INVERSE
][row][
cﬁumn
];

463 
ªsu…
 = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, 
	`rightShi·
(‘esu… + 
∫d_Á˘‹
), 
shi·
));

466 
	}
}

476 
Void
 
	$∑πülBuâîÊyInvî£4
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
, c⁄° TC€f‡
ouçutMöimum
, c⁄° TC€f‡
ouçutMaximum
)

478 
I¡
 
j
;

479 
TC€ff
 
E
[2],
O
[2];

480 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

482 
j
=0; j<
löe
; j++)

485 
O
[0] = 
g_aiT4
[
TRANSFORM_INVERSE
][1][0]*
§c
[
löe
] + g_aiT4[TRANSFORM_INVERSE][3][0]*src[3*line];

486 
O
[1] = 
g_aiT4
[
TRANSFORM_INVERSE
][1][1]*
§c
[
löe
] + g_aiT4[TRANSFORM_INVERSE][3][1]*src[3*line];

487 
E
[0] = 
g_aiT4
[
TRANSFORM_INVERSE
][0][0]*
§c
[0] + g_aiT4[TRANSFORM_INVERSE][2][0]*§c[2*
löe
];

488 
E
[1] = 
g_aiT4
[
TRANSFORM_INVERSE
][0][1]*
§c
[0] + g_aiT4[TRANSFORM_INVERSE][2][1]*§c[2*
löe
];

491 
d°
[0] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[0] + 
O
[0] + 
add
)>>
shi·
 );

492 
d°
[1] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[1] + 
O
[1] + 
add
)>>
shi·
 );

493 
d°
[2] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[1] - 
O
[1] + 
add
)>>
shi·
 );

494 
d°
[3] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[0] - 
O
[0] + 
add
)>>
shi·
 );

496 
§c
 ++;

497 
d°
 += 4;

499 
	}
}

507 
Void
 
	$∑πülBuâîÊy8
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
)

509 
I¡
 
j
,
k
;

510 
TC€ff
 
E
[4],
O
[4];

511 
TC€ff
 
EE
[2],
EO
[2];

512 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

514 
j
=0; j<
löe
; j++)

517 
k
=0;k<4;k++)

519 
E
[
k
] = 
§c
[k] + src[7-k];

520 
O
[
k
] = 
§c
[k] - src[7-k];

523 
EE
[0] = 
E
[0] + E[3];

524 
EO
[0] = 
E
[0] - E[3];

525 
EE
[1] = 
E
[1] + E[2];

526 
EO
[1] = 
E
[1] - E[2];

528 
d°
[0] = (
g_aiT8
[
TRANSFORM_FORWARD
][0][0]*
EE
[0] + g_aiT8[TRANSFORM_FORWARD][0][1]*EE[1] + 
add
)>>
shi·
;

529 
d°
[4*
löe
] = (
g_aiT8
[
TRANSFORM_FORWARD
][4][0]*
EE
[0] + g_aiT8[TRANSFORM_FORWARD][4][1]*EE[1] + 
add
)>>
shi·
;

530 
d°
[2*
löe
] = (
g_aiT8
[
TRANSFORM_FORWARD
][2][0]*
EO
[0] + g_aiT8[TRANSFORM_FORWARD][2][1]*EO[1] + 
add
)>>
shi·
;

531 
d°
[6*
löe
] = (
g_aiT8
[
TRANSFORM_FORWARD
][6][0]*
EO
[0] + g_aiT8[TRANSFORM_FORWARD][6][1]*EO[1] + 
add
)>>
shi·
;

533 
d°
[
löe
] = (
g_aiT8
[
TRANSFORM_FORWARD
][1][0]*
O
[0] + g_aiT8[TRANSFORM_FORWARD][1][1]*O[1] + g_aiT8[TRANSFORM_FORWARD][1][2]*O[2] + g_aiT8[TRANSFORM_FORWARD][1][3]*O[3] + 
add
)>>
shi·
;

534 
d°
[3*
löe
] = (
g_aiT8
[
TRANSFORM_FORWARD
][3][0]*
O
[0] + g_aiT8[TRANSFORM_FORWARD][3][1]*O[1] + g_aiT8[TRANSFORM_FORWARD][3][2]*O[2] + g_aiT8[TRANSFORM_FORWARD][3][3]*O[3] + 
add
)>>
shi·
;

535 
d°
[5*
löe
] = (
g_aiT8
[
TRANSFORM_FORWARD
][5][0]*
O
[0] + g_aiT8[TRANSFORM_FORWARD][5][1]*O[1] + g_aiT8[TRANSFORM_FORWARD][5][2]*O[2] + g_aiT8[TRANSFORM_FORWARD][5][3]*O[3] + 
add
)>>
shi·
;

536 
d°
[7*
löe
] = (
g_aiT8
[
TRANSFORM_FORWARD
][7][0]*
O
[0] + g_aiT8[TRANSFORM_FORWARD][7][1]*O[1] + g_aiT8[TRANSFORM_FORWARD][7][2]*O[2] + g_aiT8[TRANSFORM_FORWARD][7][3]*O[3] + 
add
)>>
shi·
;

538 
§c
 += 8;

539 
d°
 ++;

541 
	}
}

551 
Void
 
	$∑πülBuâîÊyInvî£8
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
, c⁄° TC€f‡
ouçutMöimum
, c⁄° TC€f‡
ouçutMaximum
)

553 
I¡
 
j
,
k
;

554 
TC€ff
 
E
[4],
O
[4];

555 
TC€ff
 
EE
[2],
EO
[2];

556 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

558 
j
=0; j<
löe
; j++)

561 
k
=0;k<4;k++)

563 
O
[
k
] = 
g_aiT8
[
TRANSFORM_INVERSE
][ 1][k]*
§c
[
löe
] + g_aiT8[TRANSFORM_INVERSE][ 3][k]*src[3*line] +

564 
g_aiT8
[
TRANSFORM_INVERSE
][ 5][
k
]*
§c
[5*
löe
] + g_aiT8[TRANSFORM_INVERSE][ 7][k]*src[7*line];

567 
EO
[0] = 
g_aiT8
[
TRANSFORM_INVERSE
][2][0]*
§c
[ 2*
löe
 ] + g_aiT8[TRANSFORM_INVERSE][6][0]*src[ 6*line ];

568 
EO
[1] = 
g_aiT8
[
TRANSFORM_INVERSE
][2][1]*
§c
[ 2*
löe
 ] + g_aiT8[TRANSFORM_INVERSE][6][1]*src[ 6*line ];

569 
EE
[0] = 
g_aiT8
[
TRANSFORM_INVERSE
][0][0]*
§c
[ 0 ] + g_aiT8[TRANSFORM_INVERSE][4][0]*§c[ 4*
löe
 ];

570 
EE
[1] = 
g_aiT8
[
TRANSFORM_INVERSE
][0][1]*
§c
[ 0 ] + g_aiT8[TRANSFORM_INVERSE][4][1]*§c[ 4*
löe
 ];

573 
E
[0] = 
EE
[0] + 
EO
[0];

574 
E
[3] = 
EE
[0] - 
EO
[0];

575 
E
[1] = 
EE
[1] + 
EO
[1];

576 
E
[2] = 
EE
[1] - 
EO
[1];

577 
k
=0;k<4;k++)

579 
d°
[ 
k
 ] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[k] + 
O
[k] + 
add
)>>
shi·
 );

580 
d°
[ 
k
+4 ] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[3-k] - 
O
[3-k] + 
add
)>>
shi·
 );

582 
§c
 ++;

583 
d°
 += 8;

585 
	}
}

593 
Void
 
	$∑πülBuâîÊy16
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
)

595 
I¡
 
j
,
k
;

596 
TC€ff
 
E
[8],
O
[8];

597 
TC€ff
 
EE
[4],
EO
[4];

598 
TC€ff
 
EEE
[2],
EEO
[2];

599 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

601 
j
=0; j<
löe
; j++)

604 
k
=0;k<8;k++)

606 
E
[
k
] = 
§c
[k] + src[15-k];

607 
O
[
k
] = 
§c
[k] - src[15-k];

610 
k
=0;k<4;k++)

612 
EE
[
k
] = 
E
[k] + E[7-k];

613 
EO
[
k
] = 
E
[k] - E[7-k];

616 
EEE
[0] = 
EE
[0] + EE[3];

617 
EEO
[0] = 
EE
[0] - EE[3];

618 
EEE
[1] = 
EE
[1] + EE[2];

619 
EEO
[1] = 
EE
[1] - EE[2];

621 
d°
[ 0 ] = (
g_aiT16
[
TRANSFORM_FORWARD
][ 0][0]*
EEE
[0] + g_aiT16[TRANSFORM_FORWARD][ 0][1]*EEE[1] + 
add
)>>
shi·
;

622 
d°
[ 8*
löe
 ] = (
g_aiT16
[
TRANSFORM_FORWARD
][ 8][0]*
EEE
[0] + g_aiT16[TRANSFORM_FORWARD][ 8][1]*EEE[1] + 
add
)>>
shi·
;

623 
d°
[ 4*
löe
 ] = (
g_aiT16
[
TRANSFORM_FORWARD
][ 4][0]*
EEO
[0] + g_aiT16[TRANSFORM_FORWARD][ 4][1]*EEO[1] + 
add
)>>
shi·
;

624 
d°
[ 12*
löe
] = (
g_aiT16
[
TRANSFORM_FORWARD
][12][0]*
EEO
[0] + g_aiT16[TRANSFORM_FORWARD][12][1]*EEO[1] + 
add
)>>
shi·
;

626 
k
=2;k<16;k+=4)

628 
d°
[ 
k
*
löe
 ] = (
g_aiT16
[
TRANSFORM_FORWARD
][k][0]*
EO
[0] + g_aiT16[TRANSFORM_FORWARD][k][1]*EO[1] +

629 
g_aiT16
[
TRANSFORM_FORWARD
][
k
][2]*
EO
[2] + g_aiT16[TRANSFORM_FORWARD][k][3]*EO[3] + 
add
)>>
shi·
;

632 
k
=1;k<16;k+=2)

634 
d°
[ 
k
*
löe
 ] = (
g_aiT16
[
TRANSFORM_FORWARD
][k][0]*
O
[0] + g_aiT16[TRANSFORM_FORWARD][k][1]*O[1] +

635 
g_aiT16
[
TRANSFORM_FORWARD
][
k
][2]*
O
[2] + g_aiT16[TRANSFORM_FORWARD][k][3]*O[3] +

636 
g_aiT16
[
TRANSFORM_FORWARD
][
k
][4]*
O
[4] + g_aiT16[TRANSFORM_FORWARD][k][5]*O[5] +

637 
g_aiT16
[
TRANSFORM_FORWARD
][
k
][6]*
O
[6] + g_aiT16[TRANSFORM_FORWARD][k][7]*O[7] + 
add
)>>
shi·
;

640 
§c
 += 16;

641 
d°
 ++;

644 
	}
}

654 
Void
 
	$∑πülBuâîÊyInvî£16
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
, c⁄° TC€f‡
ouçutMöimum
, c⁄° TC€f‡
ouçutMaximum
)

656 
I¡
 
j
,
k
;

657 
TC€ff
 
E
[8],
O
[8];

658 
TC€ff
 
EE
[4],
EO
[4];

659 
TC€ff
 
EEE
[2],
EEO
[2];

660 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

662 
j
=0; j<
löe
; j++)

665 
k
=0;k<8;k++)

667 
O
[
k
] = 
g_aiT16
[
TRANSFORM_INVERSE
][ 1][k]*
§c
[ 
löe
] + g_aiT16[TRANSFORM_INVERSE][ 3][k]*src[ 3*line] +

668 
g_aiT16
[
TRANSFORM_INVERSE
][ 5][
k
]*
§c
[ 5*
löe
] + g_aiT16[TRANSFORM_INVERSE][ 7][k]*src[ 7*line] +

669 
g_aiT16
[
TRANSFORM_INVERSE
][ 9][
k
]*
§c
[ 9*
löe
] + g_aiT16[TRANSFORM_INVERSE][11][k]*src[11*line] +

670 
g_aiT16
[
TRANSFORM_INVERSE
][13][
k
]*
§c
[13*
löe
] + g_aiT16[TRANSFORM_INVERSE][15][k]*src[15*line];

672 
k
=0;k<4;k++)

674 
EO
[
k
] = 
g_aiT16
[
TRANSFORM_INVERSE
][ 2][k]*
§c
[ 2*
löe
] + g_aiT16[TRANSFORM_INVERSE][ 6][k]*src[ 6*line] +

675 
g_aiT16
[
TRANSFORM_INVERSE
][10][
k
]*
§c
[10*
löe
] + g_aiT16[TRANSFORM_INVERSE][14][k]*src[14*line];

677 
EEO
[0] = 
g_aiT16
[
TRANSFORM_INVERSE
][4][0]*
§c
[ 4*
löe
 ] + g_aiT16[TRANSFORM_INVERSE][12][0]*src[ 12*line ];

678 
EEE
[0] = 
g_aiT16
[
TRANSFORM_INVERSE
][0][0]*
§c
[ 0 ] + g_aiT16[TRANSFORM_INVERSE][ 8][0]*§c[ 8*
löe
 ];

679 
EEO
[1] = 
g_aiT16
[
TRANSFORM_INVERSE
][4][1]*
§c
[ 4*
löe
 ] + g_aiT16[TRANSFORM_INVERSE][12][1]*src[ 12*line ];

680 
EEE
[1] = 
g_aiT16
[
TRANSFORM_INVERSE
][0][1]*
§c
[ 0 ] + g_aiT16[TRANSFORM_INVERSE][ 8][1]*§c[ 8*
löe
 ];

683 
k
=0;k<2;k++)

685 
EE
[
k
] = 
EEE
[k] + 
EEO
[k];

686 
EE
[
k
+2] = 
EEE
[1-k] - 
EEO
[1-k];

688 
k
=0;k<4;k++)

690 
E
[
k
] = 
EE
[k] + 
EO
[k];

691 
E
[
k
+4] = 
EE
[3-k] - 
EO
[3-k];

693 
k
=0;k<8;k++)

695 
d°
[
k
] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[k] + 
O
[k] + 
add
)>>
shi·
 );

696 
d°
[
k
+8] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[7-k] - 
O
[7-k] + 
add
)>>
shi·
 );

698 
§c
 ++;

699 
d°
 += 16;

701 
	}
}

709 
Void
 
	$∑πülBuâîÊy32
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
)

711 
I¡
 
j
,
k
;

712 
TC€ff
 
E
[16],
O
[16];

713 
TC€ff
 
EE
[8],
EO
[8];

714 
TC€ff
 
EEE
[4],
EEO
[4];

715 
TC€ff
 
EEEE
[2],
EEEO
[2];

716 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

718 
j
=0; j<
löe
; j++)

721 
k
=0;k<16;k++)

723 
E
[
k
] = 
§c
[k] + src[31-k];

724 
O
[
k
] = 
§c
[k] - src[31-k];

727 
k
=0;k<8;k++)

729 
EE
[
k
] = 
E
[k] + E[15-k];

730 
EO
[
k
] = 
E
[k] - E[15-k];

733 
k
=0;k<4;k++)

735 
EEE
[
k
] = 
EE
[k] + EE[7-k];

736 
EEO
[
k
] = 
EE
[k] - EE[7-k];

739 
EEEE
[0] = 
EEE
[0] + EEE[3];

740 
EEEO
[0] = 
EEE
[0] - EEE[3];

741 
EEEE
[1] = 
EEE
[1] + EEE[2];

742 
EEEO
[1] = 
EEE
[1] - EEE[2];

744 
d°
[ 0 ] = (
g_aiT32
[
TRANSFORM_FORWARD
][ 0][0]*
EEEE
[0] + g_aiT32[TRANSFORM_FORWARD][ 0][1]*EEEE[1] + 
add
)>>
shi·
;

745 
d°
[ 16*
löe
 ] = (
g_aiT32
[
TRANSFORM_FORWARD
][16][0]*
EEEE
[0] + g_aiT32[TRANSFORM_FORWARD][16][1]*EEEE[1] + 
add
)>>
shi·
;

746 
d°
[ 8*
löe
 ] = (
g_aiT32
[
TRANSFORM_FORWARD
][ 8][0]*
EEEO
[0] + g_aiT32[TRANSFORM_FORWARD][ 8][1]*EEEO[1] + 
add
)>>
shi·
;

747 
d°
[ 24*
löe
 ] = (
g_aiT32
[
TRANSFORM_FORWARD
][24][0]*
EEEO
[0] + g_aiT32[TRANSFORM_FORWARD][24][1]*EEEO[1] + 
add
)>>
shi·
;

748 
k
=4;k<32;k+=8)

750 
d°
[ 
k
*
löe
 ] = (
g_aiT32
[
TRANSFORM_FORWARD
][k][0]*
EEO
[0] + g_aiT32[TRANSFORM_FORWARD][k][1]*EEO[1] +

751 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][2]*
EEO
[2] + g_aiT32[TRANSFORM_FORWARD][k][3]*EEO[3] + 
add
)>>
shi·
;

753 
k
=2;k<32;k+=4)

755 
d°
[ 
k
*
löe
 ] = (
g_aiT32
[
TRANSFORM_FORWARD
][k][0]*
EO
[0] + g_aiT32[TRANSFORM_FORWARD][k][1]*EO[1] +

756 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][2]*
EO
[2] + g_aiT32[TRANSFORM_FORWARD][k][3]*EO[3] +

757 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][4]*
EO
[4] + g_aiT32[TRANSFORM_FORWARD][k][5]*EO[5] +

758 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][6]*
EO
[6] + g_aiT32[TRANSFORM_FORWARD][k][7]*EO[7] + 
add
)>>
shi·
;

760 
k
=1;k<32;k+=2)

762 
d°
[ 
k
*
löe
 ] = (
g_aiT32
[
TRANSFORM_FORWARD
][k][ 0]*
O
[ 0] + g_aiT32[TRANSFORM_FORWARD][k][ 1]*O[ 1] +

763 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][ 2]*
O
[ 2] + g_aiT32[TRANSFORM_FORWARD][k][ 3]*O[ 3] +

764 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][ 4]*
O
[ 4] + g_aiT32[TRANSFORM_FORWARD][k][ 5]*O[ 5] +

765 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][ 6]*
O
[ 6] + g_aiT32[TRANSFORM_FORWARD][k][ 7]*O[ 7] +

766 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][ 8]*
O
[ 8] + g_aiT32[TRANSFORM_FORWARD][k][ 9]*O[ 9] +

767 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][10]*
O
[10] + g_aiT32[TRANSFORM_FORWARD][k][11]*O[11] +

768 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][12]*
O
[12] + g_aiT32[TRANSFORM_FORWARD][k][13]*O[13] +

769 
g_aiT32
[
TRANSFORM_FORWARD
][
k
][14]*
O
[14] + g_aiT32[TRANSFORM_FORWARD][k][15]*O[15] + 
add
)>>
shi·
;

772 
§c
 += 32;

773 
d°
 ++;

775 
	}
}

785 
Void
 
	$∑πülBuâîÊyInvî£32
(
TC€ff
 *
§c
, TC€f‡*
d°
, 
I¡
 
shi·
, I¡ 
löe
, c⁄° TC€f‡
ouçutMöimum
, c⁄° TC€f‡
ouçutMaximum
)

787 
I¡
 
j
,
k
;

788 
TC€ff
 
E
[16],
O
[16];

789 
TC€ff
 
EE
[8],
EO
[8];

790 
TC€ff
 
EEE
[4],
EEO
[4];

791 
TC€ff
 
EEEE
[2],
EEEO
[2];

792 
TC€ff
 
add
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

794 
j
=0; j<
löe
; j++)

797 
k
=0;k<16;k++)

799 
O
[
k
] = 
g_aiT32
[
TRANSFORM_INVERSE
][ 1][k]*
§c
[ 
löe
 ] + g_aiT32[TRANSFORM_INVERSE][ 3][k]*src[ 3*line ] +

800 
g_aiT32
[
TRANSFORM_INVERSE
][ 5][
k
]*
§c
[ 5*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][ 7][k]*src[ 7*line ] +

801 
g_aiT32
[
TRANSFORM_INVERSE
][ 9][
k
]*
§c
[ 9*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][11][k]*src[ 11*line ] +

802 
g_aiT32
[
TRANSFORM_INVERSE
][13][
k
]*
§c
[ 13*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][15][k]*src[ 15*line ] +

803 
g_aiT32
[
TRANSFORM_INVERSE
][17][
k
]*
§c
[ 17*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][19][k]*src[ 19*line ] +

804 
g_aiT32
[
TRANSFORM_INVERSE
][21][
k
]*
§c
[ 21*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][23][k]*src[ 23*line ] +

805 
g_aiT32
[
TRANSFORM_INVERSE
][25][
k
]*
§c
[ 25*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][27][k]*src[ 27*line ] +

806 
g_aiT32
[
TRANSFORM_INVERSE
][29][
k
]*
§c
[ 29*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][31][k]*src[ 31*line ];

808 
k
=0;k<8;k++)

810 
EO
[
k
] = 
g_aiT32
[
TRANSFORM_INVERSE
][ 2][k]*
§c
[ 2*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][ 6][k]*src[ 6*line ] +

811 
g_aiT32
[
TRANSFORM_INVERSE
][10][
k
]*
§c
[ 10*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][14][k]*src[ 14*line ] +

812 
g_aiT32
[
TRANSFORM_INVERSE
][18][
k
]*
§c
[ 18*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][22][k]*src[ 22*line ] +

813 
g_aiT32
[
TRANSFORM_INVERSE
][26][
k
]*
§c
[ 26*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][30][k]*src[ 30*line ];

815 
k
=0;k<4;k++)

817 
EEO
[
k
] = 
g_aiT32
[
TRANSFORM_INVERSE
][ 4][k]*
§c
[ 4*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][12][k]*src[ 12*line ] +

818 
g_aiT32
[
TRANSFORM_INVERSE
][20][
k
]*
§c
[ 20*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][28][k]*src[ 28*line ];

820 
EEEO
[0] = 
g_aiT32
[
TRANSFORM_INVERSE
][8][0]*
§c
[ 8*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][24][0]*src[ 24*line ];

821 
EEEO
[1] = 
g_aiT32
[
TRANSFORM_INVERSE
][8][1]*
§c
[ 8*
löe
 ] + g_aiT32[TRANSFORM_INVERSE][24][1]*src[ 24*line ];

822 
EEEE
[0] = 
g_aiT32
[
TRANSFORM_INVERSE
][0][0]*
§c
[ 0 ] + g_aiT32[TRANSFORM_INVERSE][16][0]*§c[ 16*
löe
 ];

823 
EEEE
[1] = 
g_aiT32
[
TRANSFORM_INVERSE
][0][1]*
§c
[ 0 ] + g_aiT32[TRANSFORM_INVERSE][16][1]*§c[ 16*
löe
 ];

826 
EEE
[0] = 
EEEE
[0] + 
EEEO
[0];

827 
EEE
[3] = 
EEEE
[0] - 
EEEO
[0];

828 
EEE
[1] = 
EEEE
[1] + 
EEEO
[1];

829 
EEE
[2] = 
EEEE
[1] - 
EEEO
[1];

830 
k
=0;k<4;k++)

832 
EE
[
k
] = 
EEE
[k] + 
EEO
[k];

833 
EE
[
k
+4] = 
EEE
[3-k] - 
EEO
[3-k];

835 
k
=0;k<8;k++)

837 
E
[
k
] = 
EE
[k] + 
EO
[k];

838 
E
[
k
+8] = 
EE
[7-k] - 
EO
[7-k];

840 
k
=0;k<16;k++)

842 
d°
[
k
] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[k] + 
O
[k] + 
add
)>>
shi·
 );

843 
d°
[
k
+16] = 
	`Clù3
–
ouçutMöimum
, 
ouçutMaximum
, (
E
[15-k] - 
O
[15-k] + 
add
)>>
shi·
 );

845 
§c
 ++;

846 
d°
 += 32;

848 
	}
}

860 
Void
 
	$xTrMxN
(
I¡
 
bôDïth
, 
TC€ff
 *
block
, TC€f‡*
c€ff
, I¡ 
iWidth
, I¡ 
iHeight
, 
Boﬁ
 
u£DST
, c⁄° I¡ 
maxLog2TrDy«micR™ge
)

862 c⁄° 
I¡
 
TRANSFORM_MATRIX_SHIFT
 = 
g_å™sf‹mM©rixShi·
[
TRANSFORM_FORWARD
];

864 c⁄° 
I¡
 
shi·_1°
 = ((
g_aucC⁄vîtToBô
[
iWidth
] + 2Ë+ 
bôDïth
 + 
TRANSFORM_MATRIX_SHIFT
Ë- 
maxLog2TrDy«micR™ge
;

865 c⁄° 
I¡
 
shi·_2nd
 = (
g_aucC⁄vîtToBô
[
iHeight
] + 2Ë+ 
TRANSFORM_MATRIX_SHIFT
;

867 
	`as£π
(
shi·_1°
 >= 0);

868 
	`as£π
(
shi·_2nd
 >= 0);

870 
TC€ff
 
tmp
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

872 
iWidth
)

876 i‡((
iHeight
 =4Ë&& 
u£DST
)

878 
	`Á°F‹w¨dD°
–
block
, 
tmp
, 
shi·_1°
 );

882 
	`∑πülBuâîÊy4
 ( 
block
, 
tmp
, 
shi·_1°
, 
iHeight
 );

887 8: 
	`∑πülBuâîÊy8
 ( 
block
, 
tmp
, 
shi·_1°
, 
iHeight
 ); ;

888 16: 
	`∑πülBuâîÊy16
–
block
, 
tmp
, 
shi·_1°
, 
iHeight
 ); ;

889 32: 
	`∑πülBuâîÊy32
–
block
, 
tmp
, 
shi·_1°
, 
iHeight
 ); ;

891 
	`as£π
(0); 
	`exô
 (1); ;

894 
iHeight
)

898 i‡((
iWidth
 =4Ë&& 
u£DST
)

900 
	`Á°F‹w¨dD°
–
tmp
, 
c€ff
, 
shi·_2nd
 );

904 
	`∑πülBuâîÊy4
 ( 
tmp
, 
c€ff
, 
shi·_2nd
, 
iWidth
 );

909 8: 
	`∑πülBuâîÊy8
 ( 
tmp
, 
c€ff
, 
shi·_2nd
, 
iWidth
 ); ;

910 16: 
	`∑πülBuâîÊy16
–
tmp
, 
c€ff
, 
shi·_2nd
, 
iWidth
 ); ;

911 32: 
	`∑πülBuâîÊy32
–
tmp
, 
c€ff
, 
shi·_2nd
, 
iWidth
 ); ;

913 
	`as£π
(0); 
	`exô
 (1); ;

915 
	}
}

927 
Void
 
	$xITrMxN
(
I¡
 
bôDïth
, 
TC€ff
 *
c€ff
, TC€f‡*
block
, I¡ 
iWidth
, I¡ 
iHeight
, 
Boﬁ
 
u£DST
, c⁄° I¡ 
maxLog2TrDy«micR™ge
)

929 c⁄° 
I¡
 
TRANSFORM_MATRIX_SHIFT
 = 
g_å™sf‹mM©rixShi·
[
TRANSFORM_INVERSE
];

931 
I¡
 
shi·_1°
 = 
TRANSFORM_MATRIX_SHIFT
 + 1;

932 
I¡
 
shi·_2nd
 = (
TRANSFORM_MATRIX_SHIFT
 + 
maxLog2TrDy«micR™ge
 - 1Ë- 
bôDïth
;

933 c⁄° 
TC€ff
 
˛ùMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

934 c⁄° 
TC€ff
 
˛ùMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

936 
	`as£π
(
shi·_1°
 >= 0);

937 
	`as£π
(
shi·_2nd
 >= 0);

939 
TC€ff
 
tmp
[
MAX_TU_SIZE
 * MAX_TU_SIZE];

941 
iHeight
)

945 i‡((
iWidth
 =4Ë&& 
u£DST
)

947 
	`Á°Invî£D°
–
c€ff
, 
tmp
, 
shi·_1°
, 
˛ùMöimum
, 
˛ùMaximum
);

951 
	`∑πülBuâîÊyInvî£4
 ( 
c€ff
, 
tmp
, 
shi·_1°
, 
iWidth
, 
˛ùMöimum
, 
˛ùMaximum
);

956 8: 
	`∑πülBuâîÊyInvî£8
 ( 
c€ff
, 
tmp
, 
shi·_1°
, 
iWidth
, 
˛ùMöimum
, 
˛ùMaximum
); ;

957 16: 
	`∑πülBuâîÊyInvî£16
–
c€ff
, 
tmp
, 
shi·_1°
, 
iWidth
, 
˛ùMöimum
, 
˛ùMaximum
); ;

958 32: 
	`∑πülBuâîÊyInvî£32
–
c€ff
, 
tmp
, 
shi·_1°
, 
iWidth
, 
˛ùMöimum
, 
˛ùMaximum
); ;

961 
	`as£π
(0); 
	`exô
 (1); ;

964 
iWidth
)

969 i‡((
iHeight
 =4Ë&& 
u£DST
)

971 
	`Á°Invî£D°
–
tmp
, 
block
, 
shi·_2nd
, 
°d
::
numîic_limôs
<
Pñ
>::
	`mö
(), std::numîic_limôs<Pñ>::
	`max
() );

975 
	`∑πülBuâîÊyInvî£4
 ( 
tmp
, 
block
, 
shi·_2nd
, 
iHeight
, 
°d
::
numîic_limôs
<
Pñ
>::
	`mö
(), std::numîic_limôs<Pñ>::
	`max
());

980 8: 
	`∑πülBuâîÊyInvî£8
 ( 
tmp
, 
block
, 
shi·_2nd
, 
iHeight
, 
°d
::
numîic_limôs
<
Pñ
>::
	`mö
(), std::numîic_limôs<Pñ>::
	`max
()); ;

981 16: 
	`∑πülBuâîÊyInvî£16
–
tmp
, 
block
, 
shi·_2nd
, 
iHeight
, 
°d
::
numîic_limôs
<
Pñ
>::
	`mö
(), std::numîic_limôs<Pñ>::
	`max
()); ;

982 32: 
	`∑πülBuâîÊyInvî£32
–
tmp
, 
block
, 
shi·_2nd
, 
iHeight
, 
°d
::
numîic_limôs
<
Pñ
>::
	`mö
(), std::numîic_limôs<Pñ>::
	`max
()); ;

985 
	`as£π
(0); 
	`exô
 (1); ;

987 
	}
}

991 
Void
 
	gTComTrQu™t
::
	$signBôHidögHDQ
–
TC€ff
* 
pQC€f
, TC€ff* 
pC€f
, TC€ff* 
dñèU
, c⁄° 
TUE¡r›yCodögP¨amëîs
 &
codögP¨amëîs
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 )

993 c⁄° 
UI¡
 
width
 = 
codögP¨amëîs
.
widthInGroups
 << 
MLS_CG_LOG2_WIDTH
;

994 c⁄° 
UI¡
 
height
 = 
codögP¨amëîs
.
heightInGroups
 << 
MLS_CG_LOG2_HEIGHT
;

995 c⁄° 
UI¡
 
groupSize
 = 1 << 
MLS_CG_SIZE
;

997 c⁄° 
TC€ff
 
íå›yCodögMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

998 c⁄° 
TC€ff
 
íå›yCodögMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

1000 
I¡
 
œ°CG
 = -1;

1001 
I¡
 
absSum
 = 0 ;

1002 
I¡
 
n
 ;

1004  
I¡
 
subSë
 = (
width
*
height
-1Ë>> 
MLS_CG_SIZE
; subSet >= 0; subSet-- )

1006 
I¡
 
subPos
 = 
subSë
 << 
MLS_CG_SIZE
;

1007 
I¡
 
fú°NZPosInCG
=
groupSize
 , 
œ°NZPosInCG
=-1 ;

1008 
absSum
 = 0 ;

1010 
n
 = 
groupSize
-1;Ç >= 0; --n )

1012 if–
pQC€f
[ 
codögP¨amëîs
.
sˇn
[ 
n
 + 
subPos
 ]] )

1014 
œ°NZPosInCG
 = 
n
;

1019 
n
 = 0;Ç <
groupSize
;Ç++ )

1021 if–
pQC€f
[ 
codögP¨amëîs
.
sˇn
[ 
n
 + 
subPos
 ]] )

1023 
fú°NZPosInCG
 = 
n
;

1028 
n
 = 
fú°NZPosInCG
;Ç <=
œ°NZPosInCG
;Ç++ )

1030 
absSum
 +
	`I¡
(
pQC€f
[ 
codögP¨amëîs
.
sˇn
[ 
n
 + 
subPos
 ]]);

1033 if(
œ°NZPosInCG
>=0 && 
œ°CG
==-1)

1035 
œ°CG
 = 1 ;

1038 if–
œ°NZPosInCG
-
fú°NZPosInCG
>=
SBH_THRESHOLD
 )

1040 
UI¡
 
signbô
 = (
pQC€f
[
codögP¨amëîs
.
sˇn
[
subPos
+
fú°NZPosInCG
]]>0?0:1) ;

1041 if–
signbô
!=(
absSum
&0x1) )

1043 
TC€ff
 
curCo°
 = 
°d
::
numîic_limôs
<TC€ff>::
	`max
();

1044 
TC€ff
 
möCo°Inc
 = 
°d
::
numîic_limôs
<TC€ff>::
	`max
();

1045 
I¡
 
möPos
 =-1, 
föÆCh™ge
=0, 
curCh™ge
=0;

1047  
n
 = (
œ°CG
==1?
œ°NZPosInCG
:
groupSize
-1) ;Ç >= 0; --n )

1049 
UI¡
 
blkPos
 = 
codögP¨amëîs
.
sˇn
[ 
n
+
subPos
 ];

1050 if(
pQC€f
[ 
blkPos
 ] != 0 )

1052 if(
dñèU
[
blkPos
]>0)

1054 
curCo°
 = - 
dñèU
[
blkPos
];

1055 
curCh™ge
=1 ;

1060 if(
n
==
fú°NZPosInCG
 && 
	`abs
(
pQC€f
[
blkPos
])==1)

1062 
curCo°
 = 
°d
::
numîic_limôs
<
TC€ff
>::
	`max
();

1066 
curCo°
 = 
dñèU
[
blkPos
];

1067 
curCh™ge
 =-1;

1073 if(
n
<
fú°NZPosInCG
)

1075 
UI¡
 
thisSignBô
 = (
pC€f
[
blkPos
]>=0?0:1);

1076 if(
thisSignBô
 !
signbô
 )

1078 
curCo°
 = 
°d
::
numîic_limôs
<
TC€ff
>::
	`max
();

1082 
curCo°
 = - (
dñèU
[
blkPos
]) ;

1083 
curCh™ge
 = 1 ;

1088 
curCo°
 = - (
dñèU
[
blkPos
]) ;

1089 
curCh™ge
 = 1 ;

1093 if–
curCo°
<
möCo°Inc
)

1095 
möCo°Inc
 = 
curCo°
 ;

1096 
föÆCh™ge
 = 
curCh™ge
 ;

1097 
möPos
 = 
blkPos
 ;

1101 if(
pQC€f
[
möPos
] =
íå›yCodögMaximum
 ||ÖQC€f[möPos] =
íå›yCodögMöimum
)

1103 
föÆCh™ge
 = -1;

1106 if(
pC€f
[
möPos
]>=0)

1108 
pQC€f
[
möPos
] +
föÆCh™ge
 ;

1112 
pQC€f
[
möPos
] -
föÆCh™ge
 ;

1116 if(
œ°CG
==1)

1118 
œ°CG
=0 ;

1123 
	}
}

1126 
Void
 
	gTComTrQu™t
::
xQu™t
–
TComTU
 &
rTu
,

1127 
TC€ff
 * 
pSrc
,

1128 
TC€ff
 * 
pDes
,

1129 #i‡
ADAPTIVE_QP_SELECTION


1130 
TC€ff
 *
pAæDes
,

1132 
TC€ff
 &
uiAbsSum
,

1133 c⁄° 
Comp⁄ítID
 
compID
,

1134 c⁄° 
QpP¨am
 &
cQP
 )

1136 c⁄° 
	gTComRe˘™gÀ
 &
	gª˘
 = 
rTu
.
gëRe˘
(
compID
);

1137 c⁄° 
UI¡
 
	guiWidth
 = 
ª˘
.
width
;

1138 c⁄° 
UI¡
 
	guiHeight
 = 
ª˘
.
height
;

1139 
TComD©aCU
* 
	gpcCU
 = 
rTu
.
gëCU
();

1140 c⁄° 
UI¡
 
	guiAbsP¨tIdx
 = 
rTu
.
GëAbsP¨tIdxTU
();

1141 c⁄° 
I¡
 
	gch™√lBôDïth
 = 
pcCU
->
gëSli˚
()->
gëSPS
()->
gëBôDïth
(
toCh™√lTy≥
(
compID
));

1143 
TC€ff
* 
	gpiC€f
 = 
pSrc
;

1144 
TC€ff
* 
	gpiQC€f
 = 
pDes
;

1145 #i‡
ADAPTIVE_QP_SELECTION


1146 
TC€ff
* 
	gpiAæCC€f
 = 
pAæDes
;

1149 c⁄° 
Boﬁ
 
	gu£Tønsf‹mSkù
 = 
pcCU
->
gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
);

1150 c⁄° 
I¡
 
	gmaxLog2TrDy«micR™ge
 = 
pcCU
->
gëSli˚
()->
gëSPS
()->
gëMaxLog2TrDy«micR™ge
(
toCh™√lTy≥
(
compID
));

1152 
Boﬁ
 
	gu£RDOQ
 = 
u£Tønsf‹mSkù
 ? 
m_u£RDOQTS
 : 
m_u£RDOQ
;

1153 i‡–
	gu£RDOQ
 && (
isLuma
(
compID
Ë|| 
	gRDOQ_CHROMA
) )

1155 i‡–!
	gm_u£Sñe˘iveRDOQ
 || 
xNìdRDOQ
–
rTu
, 
piC€f
, 
compID
, 
cQP
 ) )

1157 #i‡
ADAPTIVE_QP_SELECTION


1158 
xR©eDi°O±Qu™t
–
rTu
, 
piC€f
, 
pDes
, 
pAæDes
, 
uiAbsSum
, 
compID
, 
cQP
 );

1160 
xR©eDi°O±Qu™t
–
rTu
, 
piC€f
, 
pDes
, 
uiAbsSum
, 
compID
, 
cQP
 );

1165 
mem£t
–
pDes
, 0, –
TC€ff
 ) * 
uiWidth
 *
uiHeight
 );

1166 
	guiAbsSum
 = 0;

1171 
TUE¡r›yCodögP¨amëîs
 
	gcodögP¨amëîs
;

1172 
gëTUE¡r›yCodögP¨amëîs
(
codögP¨amëîs
, 
rTu
, 
compID
);

1174 c⁄° 
TC€ff
 
	gíå›yCodögMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

1175 c⁄° 
TC€ff
 
	gíå›yCodögMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

1177 
TC€ff
 
	gdñèU
[
MAX_TU_SIZE
 * MAX_TU_SIZE];

1179 c⁄° 
UI¡
 
	guiLog2TrSize
 = 
rTu
.
GëEquivÆítLog2TrSize
(
compID
);

1181 
I¡
 
	gsˇlögLi°Ty≥
 = 
gëSˇlögLi°Ty≥
(
pcCU
->
gëPªdi˘i⁄Mode
(
uiAbsP¨tIdx
), 
compID
);

1182 
as£π
(
sˇlögLi°Ty≥
 < 
SCALING_LIST_NUM
);

1183 
I¡
 *
	gpiQu™tC€ff
 = 
gëQu™tC€ff
(
sˇlögLi°Ty≥
, 
cQP
.
ªm
, 
uiLog2TrSize
-2);

1185 c⁄° 
Boﬁ
 
	gíabÀSˇlögLi°s
 = 
gëU£SˇlögLi°
(
uiWidth
, 
uiHeight
, (
pcCU
->
gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
) != 0));

1186 c⁄° 
I¡
 
	gdeÁu…Qu™tißti⁄C€fficõ¡
 = 
g_qu™tSˇÀs
[
cQP
.
ªm
];

1195 
I¡
 
	giTønsf‹mShi·
 = 
gëTønsf‹mShi·
(
ch™√lBôDïth
, 
uiLog2TrSize
, 
maxLog2TrDy«micR™ge
);

1196 i‡(
	gu£Tønsf‹mSkù
 && 
	gpcCU
->
gëSli˚
()->
gëSPS
()->
gëSpsR™geExãnsi⁄
().
gëExãndedPªcisi⁄Pro˚ssögFœg
())

1198 
	giTønsf‹mShi·
 = 
°d
::
max
<
I¡
>(0, iTransformShift);

1201 c⁄° 
I¡
 
	giQBôs
 = 
QUANT_SHIFT
 + 
cQP
.
≥r
 + 
iTønsf‹mShi·
;

1204 #i‡
ADAPTIVE_QP_SELECTION


1205 
I¡
 
	giQBôsC
 = 
MAX_INT
;

1206 
I¡
 
	giAddC
 = 
MAX_INT
;

1208 i‡(
	gm_bU£Ad≠tQpSñe˘
)

1210 
	giQBôsC
 = 
iQBôs
 - 
ARL_C_PRECISION
;

1211 
	giAddC
 = 1 << (
iQBôsC
-1);

1215 c⁄° 
I¡
 
	giAdd
 = (
pcCU
->
gëSli˚
()->
gëSli˚Ty≥
()==
I_SLICE
 ? 171 : 85Ë<< (
iQBôs
-9);

1216 c⁄° 
I¡
 
	gqBôs8
 = 
iQBôs
 - 8;

1218  
I¡
 
	guiBlockPos
 = 0; uiBlockPo†< 
uiWidth
*
	guiHeight
; uiBlockPos++ )

1220 c⁄° 
TC€ff
 
	giLevñ
 = 
piC€f
[
uiBlockPos
];

1221 c⁄° 
TC€ff
 
	giSign
 = (
iLevñ
 < 0 ? -1: 1);

1223 c⁄° 
I¡64
 
	gtmpLevñ
 = (I¡64)
abs
(
iLevñ
Ë* (
íabÀSˇlögLi°s
 ? 
piQu™tC€ff
[
uiBlockPos
] : 
deÁu…Qu™tißti⁄C€fficõ¡
);

1225 #i‡
ADAPTIVE_QP_SELECTION


1226 if–
	gm_bU£Ad≠tQpSñe˘
 )

1228 
	gpiAæCC€f
[
uiBlockPos
] = (
TC€ff
)((
tmpLevñ
 + 
iAddC
 ) >> 
iQBôsC
);

1232 c⁄° 
TC€ff
 
	gqu™ti£dMagnôude
 = TC€ff((
tmpLevñ
 + 
iAdd
 ) >> 
iQBôs
);

1233 
	gdñèU
[
uiBlockPos
] = (
TC€ff
)((
tmpLevñ
 - (
qu™ti£dMagnôude
<<
iQBôs
Ë)>> 
qBôs8
);

1235 
	guiAbsSum
 +
qu™ti£dMagnôude
;

1236 c⁄° 
TC€ff
 
	gqu™ti£dC€fficõ¡
 = 
qu™ti£dMagnôude
 * 
iSign
;

1238 
	gpiQC€f
[
uiBlockPos
] = 
Clù3
<
TC€ff
>–
íå›yCodögMöimum
, 
	gíå›yCodögMaximum
, 
	gqu™ti£dC€fficõ¡
 );

1241 if–
	gpcCU
->
gëSli˚
()->
gëPPS
()->
gëSignD©aHidögE«bÀdFœg
() )

1243 if(
	guiAbsSum
 >= 2)

1245 
signBôHidögHDQ
–
piQC€f
, 
piC€f
, 
dñèU
, 
codögP¨amëîs
, 
maxLog2TrDy«micR™ge
 ) ;

1252 
Boﬁ
 
	gTComTrQu™t
::
	$xNìdRDOQ
–
TComTU
 &
rTu
, 
TC€ff
 * 
pSrc
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
QpP¨am
 &
cQP
 )

1254 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
compID
);

1255 c⁄° 
UI¡
 
uiWidth
 = 
ª˘
.
width
;

1256 c⁄° 
UI¡
 
uiHeight
 = 
ª˘
.
height
;

1257 
TComD©aCU
* 
pcCU
 = 
rTu
.
	`gëCU
();

1258 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1259 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

1261 
TC€ff
* 
piC€f
 = 
pSrc
;

1263 c⁄° 
Boﬁ
 
u£Tønsf‹mSkù
 = 
pcCU
->
	`gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
);

1264 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
	`toCh™√lTy≥
(
compID
));

1266 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëEquivÆítLog2TrSize
(
compID
);

1268 
I¡
 
sˇlögLi°Ty≥
 = 
	`gëSˇlögLi°Ty≥
(
pcCU
->
	`gëPªdi˘i⁄Mode
(
uiAbsP¨tIdx
), 
compID
);

1269 
	`as£π
(
sˇlögLi°Ty≥
 < 
SCALING_LIST_NUM
);

1270 
I¡
 *
piQu™tC€ff
 = 
	`gëQu™tC€ff
(
sˇlögLi°Ty≥
, 
cQP
.
ªm
, 
uiLog2TrSize
-2);

1272 c⁄° 
Boﬁ
 
íabÀSˇlögLi°s
 = 
	`gëU£SˇlögLi°
(
uiWidth
, 
uiHeight
, (
pcCU
->
	`gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
) != 0));

1273 c⁄° 
I¡
 
deÁu…Qu™tißti⁄C€fficõ¡
 = 
g_qu™tSˇÀs
[
cQP
.
ªm
];

1282 
I¡
 
iTønsf‹mShi·
 = 
	`gëTønsf‹mShi·
(
ch™√lBôDïth
, 
uiLog2TrSize
, 
maxLog2TrDy«micR™ge
);

1283 i‡(
u£Tønsf‹mSkù
 && 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
())

1285 
iTønsf‹mShi·
 = 
°d
::
max
<
I¡
>(0, iTransformShift);

1288 c⁄° 
I¡
 
iQBôs
 = 
QUANT_SHIFT
 + 
cQP
.
≥r
 + 
iTønsf‹mShi·
;

1292 c⁄° 
I¡
 
iAdd
 = (
compID
 =
COMPONENT_Y
 ? 171 : 256Ë<< (
iQBôs
-9);

1294  
I¡
 
uiBlockPos
 = 0; uiBlockPo†< 
uiWidth
*
uiHeight
; uiBlockPos++ )

1296 c⁄° 
TC€ff
 
iLevñ
 = 
piC€f
[
uiBlockPos
];

1297 c⁄° 
I¡64
 
tmpLevñ
 = (I¡64)
	`abs
(
iLevñ
Ë* (
íabÀSˇlögLi°s
 ? 
piQu™tC€ff
[
uiBlockPos
] : 
deÁu…Qu™tißti⁄C€fficõ¡
);

1298 c⁄° 
TC€ff
 
qu™ti£dMagnôude
 = 
	`TC€ff
((
tmpLevñ
 + 
iAdd
 ) >> 
iQBôs
);

1300 i‡–
qu™ti£dMagnôude
 != 0 )

1302  
åue
;

1305  
Ál£
;

1306 
	}
}

1308 
Void
 
	gTComTrQu™t
::
	$xDeQu™t
–
TComTU
 &
rTu
,

1309 c⁄° 
TC€ff
 * 
pSrc
,

1310 
TC€ff
 * 
pDes
,

1311 c⁄° 
Comp⁄ítID
 
compID
,

1312 c⁄° 
QpP¨am
 &
cQP
 )

1314 
	`as£π
(
compID
<
MAX_NUM_COMPONENT
);

1316 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

1317 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1318 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
compID
);

1319 c⁄° 
UI¡
 
uiWidth
 = 
ª˘
.
width
;

1320 c⁄° 
UI¡
 
uiHeight
 = 
ª˘
.
height
;

1321 c⁄° 
TC€ff
 *c⁄° 
piQC€f
 = 
pSrc
;

1322 
TC€ff
 *c⁄° 
piC€f
 = 
pDes
;

1323 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëEquivÆítLog2TrSize
(
compID
);

1324 c⁄° 
UI¡
 
numSam∂esInBlock
 = 
uiWidth
*
uiHeight
;

1325 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
	`toCh™√lTy≥
(
compID
));

1326 c⁄° 
TC€ff
 
å™sf‹mMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

1327 c⁄° 
TC€ff
 
å™sf‹mMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

1328 c⁄° 
Boﬁ
 
íabÀSˇlögLi°s
 = 
	`gëU£SˇlögLi°
(
uiWidth
, 
uiHeight
, (
pcCU
->
	`gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
) != 0));

1329 c⁄° 
I¡
 
sˇlögLi°Ty≥
 = 
	`gëSˇlögLi°Ty≥
(
pcCU
->
	`gëPªdi˘i⁄Mode
(
uiAbsP¨tIdx
), 
compID
);

1330 #i‡
O0043_BEST_EFFORT_DECODING


1331 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSåómBôDïth
(
	`toCh™√lTy≥
(
compID
));

1333 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

1336 
	`as£π
 (
sˇlögLi°Ty≥
 < 
SCALING_LIST_NUM
);

1337 
	`as£π
 ( 
uiWidth
 <
m_uiMaxTrSize
 );

1340 c⁄° 
Boﬁ
 
bClùTønsf‹mShi·To0
 = (
pcCU
->
	`gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
Ë!0Ë&&ÖcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
();

1341 c⁄° 
I¡
 
‹igöÆTønsf‹mShi·
 = 
	`gëTønsf‹mShi·
(
ch™√lBôDïth
, 
uiLog2TrSize
, 
maxLog2TrDy«micR™ge
);

1342 c⁄° 
I¡
 
iTønsf‹mShi·
 = 
bClùTønsf‹mShi·To0
 ? 
°d
::
max
<I¡>(0, 
‹igöÆTønsf‹mShi·
) : originalTransformShift;

1344 c⁄° 
I¡
 
QP_≥r
 = 
cQP
.
≥r
;

1345 c⁄° 
I¡
 
QP_ªm
 = 
cQP
.
ªm
;

1347 c⁄° 
I¡
 
rightShi·
 = (
IQUANT_SHIFT
 - (
iTønsf‹mShi·
 + 
QP_≥r
)Ë+ (
íabÀSˇlögLi°s
 ? 
LOG2_SCALING_LIST_NEUTRAL_VALUE
 : 0);

1349 if(
íabÀSˇlögLi°s
)

1354 c⁄° 
UI¡
 
dequ™tC€fBôs
 = 1 + 
IQUANT_SHIFT
 + 
SCALING_LIST_BITS
;

1355 c⁄° 
UI¡
 
èrgëI≈utBôDïth
 = 
°d
::
mö
<UI¡>((
maxLog2TrDy«micR™ge
 + 1), ((((
I¡îmedüã_I¡
Ë* 8Ë+ 
rightShi·
Ë- 
dequ™tC€fBôs
));

1357 c⁄° 
I¡îmedüã_I¡
 
öputMöimum
 = -(1 << (
èrgëI≈utBôDïth
 - 1));

1358 c⁄° 
I¡îmedüã_I¡
 
öputMaximum
 = (1 << (
èrgëI≈utBôDïth
 - 1)) - 1;

1360 
I¡
 *
piDequ™tC€f
 = 
	`gëDequ™tC€ff
(
sˇlögLi°Ty≥
,
QP_ªm
,
uiLog2TrSize
-2);

1362 if(
rightShi·
 > 0)

1364 c⁄° 
I¡îmedüã_I¡
 
iAdd
 = 1 << (
rightShi·
 - 1);

1366  
I¡
 
n
 = 0;Ç < 
numSam∂esInBlock
;Ç++ )

1368 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
piQC€f
[
n
]));

1369 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = ((
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
piDequ™tC€f
[
n
]Ë+ 
iAdd
 ) >> 
rightShi·
;

1371 
piC€f
[
n
] = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

1376 c⁄° 
I¡
 
À·Shi·
 = -
rightShi·
;

1378  
I¡
 
n
 = 0;Ç < 
numSam∂esInBlock
;Ç++ )

1380 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
piQC€f
[
n
]));

1381 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = (
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
piDequ™tC€f
[
n
]Ë<< 
À·Shi·
;

1383 
piC€f
[
n
] = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

1389 c⁄° 
I¡
 
sˇÀ
 = 
g_övQu™tSˇÀs
[
QP_ªm
];

1390 c⁄° 
I¡
 
sˇÀBôs
 = (
IQUANT_SHIFT
 + 1) ;

1395 c⁄° 
UI¡
 
èrgëI≈utBôDïth
 = 
°d
::
mö
<UI¡>((
maxLog2TrDy«micR™ge
 + 1), ((((
I¡îmedüã_I¡
Ë* 8Ë+ 
rightShi·
Ë- 
sˇÀBôs
));

1396 c⁄° 
I¡îmedüã_I¡
 
öputMöimum
 = -(1 << (
èrgëI≈utBôDïth
 - 1));

1397 c⁄° 
I¡îmedüã_I¡
 
öputMaximum
 = (1 << (
èrgëI≈utBôDïth
 - 1)) - 1;

1399 i‡(
rightShi·
 > 0)

1401 c⁄° 
I¡îmedüã_I¡
 
iAdd
 = 1 << (
rightShi·
 - 1);

1403  
I¡
 
n
 = 0;Ç < 
numSam∂esInBlock
;Ç++ )

1405 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
piQC€f
[
n
]));

1406 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = (
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
sˇÀ
 + 
iAdd
Ë>> 
rightShi·
;

1408 
piC€f
[
n
] = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

1413 c⁄° 
I¡
 
À·Shi·
 = -
rightShi·
;

1415  
I¡
 
n
 = 0;Ç < 
numSam∂esInBlock
;Ç++ )

1417 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
piQC€f
[
n
]));

1418 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = (
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
sˇÀ
Ë<< 
À·Shi·
;

1420 
piC€f
[
n
] = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

1424 
	}
}

1427 
Void
 
	gTComTrQu™t
::
öô
–
UI¡
 
uiMaxTrSize
,

1428 
Boﬁ
 
bU£RDOQ
,

1429 
Boﬁ
 
bU£RDOQTS
,

1430 
Boﬁ
 
u£Sñe˘iveRDOQ
,

1431 
Boﬁ
 
bEnc
,

1432 
Boﬁ
 
u£Tønsf‹mSkùFa°


1433 #i‡
ADAPTIVE_QP_SELECTION


1434 , 
Boﬁ
 
bU£Ad≠tQpSñe˘


1438 
	gm_uiMaxTrSize
 = 
uiMaxTrSize
;

1439 
	gm_bEnc
 = 
bEnc
;

1440 
	gm_u£RDOQ
 = 
bU£RDOQ
;

1441 
	gm_u£RDOQTS
 = 
bU£RDOQTS
;

1442 
	gm_u£Sñe˘iveRDOQ
 = 
u£Sñe˘iveRDOQ
;

1443 #i‡
ADAPTIVE_QP_SELECTION


1444 
	gm_bU£Ad≠tQpSñe˘
 = 
bU£Ad≠tQpSñe˘
;

1446 
	gm_u£Tønsf‹mSkùFa°
 = 
u£Tønsf‹mSkùFa°
;

1450 
Void
 
	gTComTrQu™t
::
å™sf‹mNxN
–
TComTU
 & 
rTu
,

1451 c⁄° 
Comp⁄ítID
 
compID
,

1452 
Pñ
 * 
pcResiduÆ
,

1453 c⁄° 
UI¡
 
uiSåide
,

1454 
TC€ff
 * 
ΩcC€ff
,

1455 #i‡
ADAPTIVE_QP_SELECTION


1456 
TC€ff
 * 
pcAæC€ff
,

1458 
TC€ff
 & 
uiAbsSum
,

1459 c⁄° 
QpP¨am
 & 
cQP


1462 c⁄° 
	gTComRe˘™gÀ
 &
	gª˘
 = 
rTu
.
gëRe˘
(
compID
);

1463 c⁄° 
UI¡
 
	guiWidth
 = 
ª˘
.
width
;

1464 c⁄° 
UI¡
 
	guiHeight
 = 
ª˘
.
height
;

1465 
TComD©aCU
* 
	gpcCU
 = 
rTu
.
gëCU
();

1466 c⁄° 
UI¡
 
	guiAbsP¨tIdx
 = 
rTu
.
GëAbsP¨tIdxTU
();

1467 c⁄° 
UI¡
 
	guiOrgTrDïth
 = 
rTu
.
GëTønsf‹mDïthRñ
();

1469 
	guiAbsSum
=0;

1471 
RDPCMMode
 
	grdpcmMode
 = 
RDPCM_OFF
;

1472 
rdpcmNxN
–
rTu
, 
compID
, 
pcResiduÆ
, 
uiSåide
, 
cQP
, 
ΩcC€ff
, 
uiAbsSum
, 
rdpcmMode
 );

1474 i‡(
	grdpcmMode
 =
RDPCM_OFF
)

1476 
uiAbsSum
 = 0;

1478 if(
	gpcCU
->
gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
))

1480 c⁄° 
Boﬁ
 
	grŸ©eResiduÆ
 = 
rTu
.
isN⁄Tønsf‹medResiduÆRŸ©ed
(
compID
);

1481 c⁄° 
UI¡
 
	guiSizeMöus1
 = (
uiWidth
 * 
uiHeight
) - 1;

1483 
UI¡
 
	gy
 = 0, 
	gc€fficõ¡Index
 = 0; y<
	guiHeight
; y++)

1485 
UI¡
 
	gx
 = 0; x<
	guiWidth
; x++, 
	gc€fficõ¡Index
++)

1487 c⁄° 
Pñ
 
	gcuºítSam∂e
 = 
pcResiduÆ
[(
y
 * 
uiSåide
Ë+ 
x
];

1489 
	gΩcC€ff
[
rŸ©eResiduÆ
 ? (
uiSizeMöus1
 - 
c€fficõ¡Index
Ë: c€fficõ¡Index] = 
cuºítSam∂e
;

1490 
	guiAbsSum
 +
TC€ff
(
abs
(
cuºítSam∂e
));

1496 #i‡
DEBUG_TRANSFORM_AND_QUANTISE


1497 
	g°d
::
cout
 << 
g_debugCou¡î
 << ": " << 
uiWidth
 << "x" << 
uiHeight
 << " ch™√»" << 
compID
 << " TUát inputÅoÅransform\n";

1498 
¥ötBlock
(
pcResiduÆ
, 
uiWidth
, 
uiHeight
, 
uiSåide
);

1501 
as£π
–(
pcCU
->
gëSli˚
()->
gëSPS
()->
gëMaxTrSize
(Ë>
uiWidth
) );

1503 if(
	gpcCU
->
gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
) != 0)

1505 
xTønsf‹mSkù
–
pcResiduÆ
, 
uiSåide
, 
m_∂TempC€ff
, 
rTu
, 
compID
 );

1509 c⁄° 
I¡
 
	gch™√lBôDïth
=
pcCU
->
gëSli˚
()->
gëSPS
()->
gëBôDïth
(
toCh™√lTy≥
(
compID
));

1510 
xT
–
ch™√lBôDïth
, 
rTu
.
u£DST
(
compID
), 
pcResiduÆ
, 
uiSåide
, 
m_∂TempC€ff
, 
uiWidth
, 
uiHeight
, 
pcCU
->
gëSli˚
()->
gëSPS
()->
gëMaxLog2TrDy«micR™ge
(
toCh™√lTy≥
(compID)) );

1513 #i‡
DEBUG_TRANSFORM_AND_QUANTISE


1514 
	g°d
::
cout
 << 
g_debugCou¡î
 << ": " << 
uiWidth
 << "x" << 
uiHeight
 << " ch™√»" << 
compID
 << " TU betweenÅransformánd quantiser\n";

1515 
¥ötBlock
(
m_∂TempC€ff
, 
uiWidth
, 
uiHeight
, uiWidth);

1518 
xQu™t
–
rTu
, 
m_∂TempC€ff
, 
ΩcC€ff
,

1520 #i‡
ADAPTIVE_QP_SELECTION


1521 
pcAæC€ff
,

1523 
uiAbsSum
, 
compID
, 
cQP
 );

1525 #i‡
DEBUG_TRANSFORM_AND_QUANTISE


1526 
	g°d
::
cout
 << 
g_debugCou¡î
 << ": " << 
uiWidth
 << "x" << 
uiHeight
 << " ch™√»" << 
compID
 << " TUát output of quantiser\n";

1527 
¥ötBlock
(
ΩcC€ff
, 
uiWidth
, 
uiHeight
, uiWidth);

1533 
	gpcCU
->
£tCbfP¨tR™ge
((((
uiAbsSum
 > 0Ë? 1 : 0Ë<< 
uiOrgTrDïth
), 
compID
, 
uiAbsP¨tIdx
, 
rTu
.
GëAbsP¨tIdxNumP¨ts
(compID));

1537 
Void
 
	gTComTrQu™t
::
övTønsf‹mNxN
–
TComTU
 &
rTu
,

1538 c⁄° 
Comp⁄ítID
 
compID
,

1539 
Pñ
 *
pcResiduÆ
,

1540 c⁄° 
UI¡
 
uiSåide
,

1541 
TC€ff
 * 
pcC€ff
,

1542 c⁄° 
QpP¨am
 &
cQP


1543 
	$DEBUG_STRING_FN_DECLAREP
(
psDebug
))

1545 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

1546 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1547 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
compID
);

1548 c⁄° 
UI¡
 
uiWidth
 = 
ª˘
.
width
;

1549 c⁄° 
UI¡
 
uiHeight
 = 
ª˘
.
height
;

1551 i‡(
uiWidth
 !
uiHeight
)

1557 
TComTURecur£
 
	`subTURecur£
(
rTu
, 
Ál£
, 
TComTU
::
VERTICAL_SPLIT
, 
åue
, 
compID
);

1563 c⁄° 
UI¡
 
löeOff£t
 = 
subTURecur£
.
	`GëSe˘i⁄Numbî
(Ë* subTURecur£.
	`gëRe˘
(
compID
).
height
;

1565 
Pñ
 *
subTUResiduÆ
 = 
pcResiduÆ
 + (
löeOff£t
 * 
uiSåide
);

1566 
TC€ff
 *
subTUC€fficõ¡s
 = 
pcC€ff
 + (
löeOff£t
 * 
subTURecur£
.
	`gëRe˘
(
compID
).
width
);

1568 
	`övTønsf‹mNxN
(
subTURecur£
, 
compID
, 
subTUResiduÆ
, 
uiSåide
, 
subTUC€fficõ¡s
, 
cQP
 
	`DEBUG_STRING_PASS_INTO
(
psDebug
));

1572 } 
subTURecur£
.
	`√xtSe˘i⁄
(
rTu
));

1579 #i‡
DEBUG_STRING


1580 i‡(
psDebug
)

1582 
°d
::
°rög°ªam
 
	`ss
(°rög°ªam::
out
);

1583 
	`¥ötBlockToSåóm
(
ss
, (
compID
==0)?"###InvTø¿ù Ch0: " : ((compID==1)?"###InvTø¿ù Ch1: ":"###InvTø¿ù Ch2: "), 
pcC€ff
, 
uiWidth
, 
uiHeight
, uiWidth);

1584 
	`DEBUG_STRING_APPEND
((*
psDebug
), 
ss
.
	`°r
())

1588 if(
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
))

1590 c⁄° 
Boﬁ
 
rŸ©eResiduÆ
 = 
rTu
.
	`isN⁄Tønsf‹medResiduÆRŸ©ed
(
compID
);

1591 c⁄° 
UI¡
 
uiSizeMöus1
 = (
uiWidth
 * 
uiHeight
) - 1;

1593 
UI¡
 
y
 = 0, 
c€fficõ¡Index
 = 0; y<
uiHeight
; y++)

1595 
UI¡
 
x
 = 0; x<
uiWidth
; x++, 
c€fficõ¡Index
++)

1597 
pcResiduÆ
[(
y
 * 
uiSåide
Ë+ 
x
] = 
	`Pñ
(
pcC€ff
[
rŸ©eResiduÆ
 ? (
uiSizeMöus1
 - 
c€fficõ¡Index
) : coefficientIndex]);

1603 #i‡
DEBUG_TRANSFORM_AND_QUANTISE


1604 
°d
::
cout
 << 
g_debugCou¡î
 << ": " << 
uiWidth
 << "x" << 
uiHeight
 << " ch™√»" << 
compID
 << " TUát inputÅo dequantiser\n";

1605 
	`¥ötBlock
(
pcC€ff
, 
uiWidth
, 
uiHeight
, uiWidth);

1608 
	`xDeQu™t
(
rTu
, 
pcC€ff
, 
m_∂TempC€ff
, 
compID
, 
cQP
);

1610 #i‡
DEBUG_TRANSFORM_AND_QUANTISE


1611 
°d
::
cout
 << 
g_debugCou¡î
 << ": " << 
uiWidth
 << "x" << 
uiHeight
 << " ch™√»" << 
compID
 << " TU between dequantiseránd inverse-transform\n";

1612 
	`¥ötBlock
(
m_∂TempC€ff
, 
uiWidth
, 
uiHeight
, uiWidth);

1615 #i‡
DEBUG_STRING


1616 i‡(
psDebug
)

1618 
°d
::
°rög°ªam
 
	`ss
(°rög°ªam::
out
);

1619 
	`¥ötBlockToSåóm
(
ss
, "###InvTø¿deq: ", 
m_∂TempC€ff
, 
uiWidth
, 
uiHeight
, uiWidth);

1620 (*
psDebug
)+=
ss
.
	`°r
();

1624 if(
pcCU
->
	`gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
))

1626 
	`xITønsf‹mSkù
–
m_∂TempC€ff
, 
pcResiduÆ
, 
uiSåide
, 
rTu
, 
compID
 );

1628 #i‡
DEBUG_STRING


1629 i‡(
psDebug
)

1631 
°d
::
°rög°ªam
 
	`ss
(°rög°ªam::
out
);

1632 
	`¥ötBlockToSåóm
(
ss
, "###InvTø¿ªsi: ", 
pcResiduÆ
, 
uiWidth
, 
uiHeight
, 
uiSåide
);

1633 (*
psDebug
)+=
ss
.
	`°r
();

1634 (*
psDebug
)+="(<- wasá Transform-skipped block)\n";

1640 #i‡
O0043_BEST_EFFORT_DECODING


1641 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSåómBôDïth
(
	`toCh™√lTy≥
(
compID
));

1643 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

1645 
	`xIT
–
ch™√lBôDïth
, 
rTu
.
	`u£DST
(
compID
), 
m_∂TempC€ff
, 
pcResiduÆ
, 
uiSåide
, 
uiWidth
, 
uiHeight
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
	`toCh™√lTy≥
(compID)) );

1647 #i‡
DEBUG_STRING


1648 i‡(
psDebug
)

1650 
°d
::
°rög°ªam
 
	`ss
(°rög°ªam::
out
);

1651 
	`¥ötBlockToSåóm
(
ss
, "###InvTø¿ªsi: ", 
pcResiduÆ
, 
uiWidth
, 
uiHeight
, 
uiSåide
);

1652 (*
psDebug
)+=
ss
.
	`°r
();

1653 (*
psDebug
)+="(<- wasá Transformed block)\n";

1658 #i‡
DEBUG_TRANSFORM_AND_QUANTISE


1659 
°d
::
cout
 << 
g_debugCou¡î
 << ": " << 
uiWidth
 << "x" << 
uiHeight
 << " ch™√»" << 
compID
 << " TUát output of inverse-transform\n";

1660 
	`¥ötBlock
(
pcResiduÆ
, 
uiWidth
, 
uiHeight
, 
uiSåide
);

1661 
g_debugCou¡î
++;

1665 
	`övRdpcmNxN
–
rTu
, 
compID
, 
pcResiduÆ
, 
uiSåide
 );

1666 
	}
}

1668 
Void
 
	gTComTrQu™t
::
	$övRecurTønsf‹mNxN
–c⁄° 
Comp⁄ítID
 
compID
,

1669 
TComYuv
 *
pResiduÆ
,

1670 
TComTU
 &
rTu
)

1672 i‡(!
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

1677 
TComD©aCU
* 
pcCU
 = 
rTu
.
	`gëCU
();

1678 
UI¡
 
absP¨tIdxTU
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1679 
UI¡
 
uiTrMode
=
rTu
.
	`GëTønsf‹mDïthRñ
();

1680 if–(
pcCU
->
	`gëCbf
(
absP¨tIdxTU
, 
compID
, 
uiTrMode
Ë=0Ë&& (
	`isLuma
(compIDË|| !pcCU->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
()) )

1685 if–
uiTrMode
 =
pcCU
->
	`gëTønsf‹mIdx
–
absP¨tIdxTU
 ) )

1687 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
 = 
rTu
.
	`gëRe˘
(
compID
);

1688 c⁄° 
I¡
 
uiSåide
 = 
pResiduÆ
->
	`gëSåide
–
compID
 );

1689 
Pñ
 *
ΩcResiduÆ
 = 
pResiduÆ
->
	`gëAddr
–
compID
 );

1690 
UI¡
 
uiAddr
 = (
tuRe˘
.
x0
 + 
uiSåide
*tuRe˘.
y0
);

1691 
Pñ
 *
pResi
 = 
ΩcResiduÆ
 + 
uiAddr
;

1692 
TC€ff
 *
pcC€ff
 = 
pcCU
->
	`gëC€ff
(
compID
Ë+ 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

1694 c⁄° 
QpP¨am
 
	`cQP
(*
pcCU
, 
compID
);

1696 if(
pcCU
->
	`gëCbf
(
absP¨tIdxTU
, 
compID
, 
uiTrMode
) != 0)

1698 
	`DEBUG_STRING_NEW
(
sTemp
)

1699 #i‡
DEBUG_STRING


1700 
°d
::
°rög
 *
psDebug
=((
DebugO±i⁄Li°
::
DebugSåög_InvTøn
.
	`gëI¡
()&(
pcCU
->
	`isI¡ø
(
absP¨tIdxTU
)?1:’cCU->
	`isI¡î
◊bsP¨tIdxTU)?2:4)))!=0Ë? &
sTemp
 : 0;

1703 
	`övTønsf‹mNxN
–
rTu
, 
compID
, 
pResi
, 
uiSåide
, 
pcC€ff
, 
cQP
 
	`DEBUG_STRING_PASS_INTO
(
psDebug
) );

1705 #i‡
DEBUG_STRING


1706 i‡(
psDebug
 != 0)

1708 
°d
::
cout
 << (*
psDebug
);

1713 i‡(
	`isChroma
(
compID
Ë&& (
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
absP¨tIdxTU
, compID) != 0))

1715 c⁄° 
Pñ
 *
piResiLuma
 = 
pResiduÆ
->
	`gëAddr
–
COMPONENT_Y
 );

1716 c⁄° 
I¡
 
°rideLuma
 = 
pResiduÆ
->
	`gëSåide
–
COMPONENT_Y
 );

1717 c⁄° 
I¡
 
tuWidth
 = 
rTu
.
	`gëRe˘
–
compID
 ).
width
;

1718 c⁄° 
I¡
 
tuHeight
 = 
rTu
.
	`gëRe˘
–
compID
 ).
height
;

1720 if(
pcCU
->
	`gëCbf
(
absP¨tIdxTU
, 
COMPONENT_Y
, 
uiTrMode
) != 0)

1722 
pResi
 = 
ΩcResiduÆ
 + 
uiAddr
;

1723 c⁄° 
Pñ
 *
pResiLuma
 = 
piResiLuma
 + 
uiAddr
;

1725 
	`¸ossComp⁄ítPªdi˘i⁄
–
rTu
, 
compID
, 
pResiLuma
, 
pResi
,ÖResi, 
tuWidth
, 
tuHeight
, 
°rideLuma
, 
uiSåide
, uiSåide, 
åue
 );

1731 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

1734 
	`övRecurTønsf‹mNxN
–
compID
, 
pResiduÆ
, 
tuRecur£Chûd
 );

1735 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
));

1737 
	}
}

1739 
Void
 
	gTComTrQu™t
::
	$≠∂yF‹w¨dRDPCM
–
TComTU
& 
rTu
, c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
* 
pcResiduÆ
, c⁄° 
UI¡
 
uiSåide
, c⁄° 
QpP¨am
& 
cQP
, 
TC€ff
* 
pcC€ff
, TC€f‡&
uiAbsSum
, c⁄° 
RDPCMMode
 
mode
 )

1741 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

1742 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

1744 c⁄° 
Boﬁ
 
bLos¶ess
 = 
pcCU
->
	`gëCUTønsqu™tBy∑ss
–
uiAbsP¨tIdx
 );

1745 c⁄° 
UI¡
 
uiWidth
 = 
rTu
.
	`gëRe˘
(
compID
).
width
;

1746 c⁄° 
UI¡
 
uiHeight
 = 
rTu
.
	`gëRe˘
(
compID
).
height
;

1747 c⁄° 
Boﬁ
 
rŸ©eResiduÆ
 = 
rTu
.
	`isN⁄Tønsf‹medResiduÆRŸ©ed
(
compID
);

1748 c⁄° 
UI¡
 
uiSizeMöus1
 = (
uiWidth
 * 
uiHeight
) - 1;

1750 
UI¡
 
uiX
 = 0;

1751 
UI¡
 
uiY
 = 0;

1753 
UI¡
 &
maj‹Axis
 = (
mode
 =
RDPCM_VER
Ë? 
uiX
 : 
uiY
;

1754 
UI¡
 &
mö‹Axis
 = (
mode
 =
RDPCM_VER
Ë? 
uiY
 : 
uiX
;

1755 c⁄° 
UI¡
 
maj‹AxisLimô
 = (
mode
 =
RDPCM_VER
Ë? 
uiWidth
 : 
uiHeight
;

1756 c⁄° 
UI¡
 
mö‹AxisLimô
 = (
mode
 =
RDPCM_VER
Ë? 
uiHeight
 : 
uiWidth
;

1758 c⁄° 
Boﬁ
 
bU£HÆfRoundögPoöt
 = (
mode
 !
RDPCM_OFF
);

1760 
uiAbsSum
 = 0;

1762  
maj‹Axis
 = 0; maj‹Axi†< 
maj‹AxisLimô
; majorAxis++ )

1764 
TC€ff
 
accumuœt‹VÆue
 = 0;

1765  
mö‹Axis
 = 0; mö‹Axi†< 
mö‹AxisLimô
; minorAxis++ )

1767 c⁄° 
UI¡
 
ßm∂eIndex
 = (
uiY
 * 
uiWidth
Ë+ 
uiX
;

1768 c⁄° 
UI¡
 
c€fficõ¡Index
 = (
rŸ©eResiduÆ
 ? (
uiSizeMöus1
-
ßm∂eIndex
) : sampleIndex);

1769 c⁄° 
Pñ
 
cuºítSam∂e
 = 
pcResiduÆ
[(
uiY
 * 
uiSåide
Ë+ 
uiX
];

1770 c⁄° 
TC€ff
 
ícodîSideDñè
 = 
	`TC€ff
(
cuºítSam∂e
Ë- 
accumuœt‹VÆue
;

1772 
Pñ
 
ªc⁄°ru˘edDñè
;

1773 i‡–
bLos¶ess
 )

1775 
pcC€ff
[
c€fficõ¡Index
] = 
ícodîSideDñè
;

1776 
ªc⁄°ru˘edDñè
 = (
Pñ
Ë
ícodîSideDñè
;

1780 
	`å™sf‹mSkùQu™tO√Sam∂e
(
rTu
, 
compID
, 
ícodîSideDñè
, 
pcC€ff
, 
c€fficõ¡Index
, 
cQP
, 
bU£HÆfRoundögPoöt
);

1781 
	`övTrSkùDeQu™tO√Sam∂e
 (
rTu
, 
compID
, 
pcC€ff
[
c€fficõ¡Index
], 
ªc⁄°ru˘edDñè
, 
cQP
, coefficientIndex);

1784 
uiAbsSum
 +
	`abs
(
pcC€ff
[
c€fficõ¡Index
]);

1786 i‡(
mode
 !
RDPCM_OFF
)

1788 
accumuœt‹VÆue
 +
ªc⁄°ru˘edDñè
;

1792 
	}
}

1794 
Void
 
	gTComTrQu™t
::
	$rdpcmNxN
 ( 
TComTU
& 
rTu
, c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
* 
pcResiduÆ
, c⁄° 
UI¡
 
uiSåide
, c⁄° 
QpP¨am
& 
cQP
, 
TC€ff
* 
pcC€ff
, TC€f‡&
uiAbsSum
, 
RDPCMMode
& 
rdpcmMode
 )

1796 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

1797 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

1799 i‡(!
pcCU
->
	`isRDPCME«bÀd
(
uiAbsP¨tIdx
Ë|| (’cCU->
	`gëTønsf‹mSkù
(uiAbsP¨tIdx, 
compID
Ë=0Ë&& !pcCU->
	`gëCUTønsqu™tBy∑ss
(uiAbsPartIdx)))

1801 
rdpcmMode
 = 
RDPCM_OFF
;

1803 i‡–
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) )

1805 c⁄° 
ChromaF‹m©
 
chFmt
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvOrg
()->
	`gëChromaF‹m©
();

1806 c⁄° 
Ch™√lTy≥
 
chTy≥
 = 
	`toCh™√lTy≥
(
compID
);

1807 c⁄° 
UI¡
 
uiChPªdMode
 = 
pcCU
->
	`gëI¡øDú
–
chTy≥
, 
uiAbsP¨tIdx
 );

1808 c⁄° 
TComSPS
 *
•s
=
pcCU
->
	`gëSli˚
()->
	`gëSPS
();

1809 c⁄° 
UI¡
 
∑πsPîMöCU
 = 1<<(2*(
•s
->
	`gëMaxTŸÆCUDïth
(Ë- sps->
	`gëLog2DiffMaxMöCodögBlockSize
()));

1810 c⁄° 
UI¡
 
uiChCodedMode
 = (
uiChPªdMode
==
DM_CHROMA_IDX
 && 
	`isChroma
(
compID
)Ë? 
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
	`gëChromasC‹ª•⁄dögPULumaIdx
(
uiAbsP¨tIdx
, 
chFmt
, 
∑πsPîMöCU
)) : uiChPredMode;

1811 c⁄° 
UI¡
 
uiChFöÆMode
 = ((
chFmt
 =
CHROMA_422
Ë&& 
	`isChroma
(
compID
)Ë? 
g_chroma422I¡øAngÀM≠pögTabÀ
[
uiChCodedMode
] : uiChCodedMode;

1813 i‡(
uiChFöÆMode
 =
VER_IDX
 || uiChFöÆModê=
HOR_IDX
)

1815 
rdpcmMode
 = (
uiChFöÆMode
 =
VER_IDX
Ë? 
RDPCM_VER
 : 
RDPCM_HOR
;

1816 
	`≠∂yF‹w¨dRDPCM
–
rTu
, 
compID
, 
pcResiduÆ
, 
uiSåide
, 
cQP
, 
pcC€ff
, 
uiAbsSum
, 
rdpcmMode
 );

1820 
rdpcmMode
 = 
RDPCM_OFF
;

1825 c⁄° 
UI¡
 
uiWidth
 = 
rTu
.
	`gëRe˘
(
compID
).
width
;

1826 c⁄° 
UI¡
 
uiHeight
 = 
rTu
.
	`gëRe˘
(
compID
).
height
;

1828 
RDPCMMode
 
be°Mode
 = 
NUMBER_OF_RDPCM_MODES
;

1829 
TC€ff
 
be°AbsSum
 = 
°d
::
numîic_limôs
<TC€ff>::
	`max
();

1830 
TC€ff
 
be°C€fficõ¡s
[
MAX_TU_SIZE
 * MAX_TU_SIZE];

1832 
UI¡
 
modeIndex
 = 0; modeIndex < 
NUMBER_OF_RDPCM_MODES
; modeIndex++)

1834 c⁄° 
RDPCMMode
 
mode
 = 
	`RDPCMMode
(
modeIndex
);

1836 
TC€ff
 
cuºAbsSum
 = 0;

1838 
	`≠∂yF‹w¨dRDPCM
–
rTu
, 
compID
, 
pcResiduÆ
, 
uiSåide
, 
cQP
, 
pcC€ff
, 
cuºAbsSum
, 
mode
 );

1840 i‡(
cuºAbsSum
 < 
be°AbsSum
)

1842 
be°Mode
 = 
mode
;

1843 
be°AbsSum
 = 
cuºAbsSum
;

1844 i‡(
mode
 !
RDPCM_OFF
)

1846 
	`mem˝y
(
be°C€fficõ¡s
, 
pcC€ff
, (
uiWidth
 * 
uiHeight
 * (
TC€ff
)));

1851 
rdpcmMode
 = 
be°Mode
;

1852 
uiAbsSum
 = 
be°AbsSum
;

1854 i‡(
rdpcmMode
 !
RDPCM_OFF
)

1856 
	`mem˝y
(
pcC€ff
, 
be°C€fficõ¡s
, (
uiWidth
 * 
uiHeight
 * (
TC€ff
)));

1860 
pcCU
->
	`£tEx∂icôRdpcmModeP¨tR™ge
(
rdpcmMode
, 
compID
, 
uiAbsP¨tIdx
, 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(compID));

1861 
	}
}

1863 
Void
 
	gTComTrQu™t
::
	$övRdpcmNxN
–
TComTU
& 
rTu
, c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
* 
pcResiduÆ
, c⁄° 
UI¡
 
uiSåide
 )

1865 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

1866 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

1868 i‡(
pcCU
->
	`isRDPCME«bÀd
–
uiAbsP¨tIdx
 ) && (’cCU->
	`gëTønsf‹mSkù
(uiAbsP¨tIdx, 
compID
 ) !0Ë||ÖcCU->
	`gëCUTønsqu™tBy∑ss
(uiAbsPartIdx)))

1870 c⁄° 
UI¡
 
uiWidth
 = 
rTu
.
	`gëRe˘
(
compID
).
width
;

1871 c⁄° 
UI¡
 
uiHeight
 = 
rTu
.
	`gëRe˘
(
compID
).
height
;

1873 
RDPCMMode
 
rdpcmMode
 = 
RDPCM_OFF
;

1875 i‡–
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) )

1877 c⁄° 
ChromaF‹m©
 
chFmt
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëChromaF‹m©
();

1878 c⁄° 
Ch™√lTy≥
 
chTy≥
 = 
	`toCh™√lTy≥
(
compID
);

1879 c⁄° 
UI¡
 
uiChPªdMode
 = 
pcCU
->
	`gëI¡øDú
–
chTy≥
, 
uiAbsP¨tIdx
 );

1880 c⁄° 
TComSPS
 *
•s
=
pcCU
->
	`gëSli˚
()->
	`gëSPS
();

1881 c⁄° 
UI¡
 
∑πsPîMöCU
 = 1<<(2*(
•s
->
	`gëMaxTŸÆCUDïth
(Ë- sps->
	`gëLog2DiffMaxMöCodögBlockSize
()));

1882 c⁄° 
UI¡
 
uiChCodedMode
 = (
uiChPªdMode
==
DM_CHROMA_IDX
 && 
	`isChroma
(
compID
)Ë? 
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
	`gëChromasC‹ª•⁄dögPULumaIdx
(
uiAbsP¨tIdx
, 
chFmt
, 
∑πsPîMöCU
)) : uiChPredMode;

1883 c⁄° 
UI¡
 
uiChFöÆMode
 = ((
chFmt
 =
CHROMA_422
Ë&& 
	`isChroma
(
compID
)Ë? 
g_chroma422I¡øAngÀM≠pögTabÀ
[
uiChCodedMode
] : uiChCodedMode;

1885 i‡(
uiChFöÆMode
 =
VER_IDX
 || uiChFöÆModê=
HOR_IDX
)

1887 
rdpcmMode
 = (
uiChFöÆMode
 =
VER_IDX
Ë? 
RDPCM_VER
 : 
RDPCM_HOR
;

1892 
rdpcmMode
 = 
	`RDPCMMode
(
pcCU
->
	`gëEx∂icôRdpcmMode
–
compID
, 
uiAbsP¨tIdx
 ));

1895 c⁄° 
TC€ff
 
≥lMö
=(TC€ffË
°d
::
numîic_limôs
<
Pñ
>::
	`mö
();

1896 c⁄° 
TC€ff
 
≥lMax
=(TC€ffË
°d
::
numîic_limôs
<
Pñ
>::
	`max
();

1897 i‡(
rdpcmMode
 =
RDPCM_VER
)

1899  
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

1901 
Pñ
 *
pcCurResiduÆ
 = 
pcResiduÆ
+
uiX
;

1902 
TC€ff
 
accumuœt‹
 = *
pcCurResiduÆ
;

1903 
pcCurResiduÆ
+=
uiSåide
;

1904  
UI¡
 
uiY
 = 1; uiY < 
uiHeight
; uiY++, 
pcCurResiduÆ
+=
uiSåide
 )

1906 
accumuœt‹
 +*(
pcCurResiduÆ
);

1907 *
pcCurResiduÆ
 = (
Pñ
)
Clù3
<
TC€ff
>(
≥lMö
, 
≥lMax
, 
accumuœt‹
);

1911 i‡(
rdpcmMode
 =
RDPCM_HOR
)

1913  
UI¡
 
uiY
 = 0; uiY < 
uiHeight
; uiY++ )

1915 
Pñ
 *
pcCurResiduÆ
 = 
pcResiduÆ
+
uiY
*
uiSåide
;

1916 
TC€ff
 
accumuœt‹
 = *
pcCurResiduÆ
;

1917 
pcCurResiduÆ
++;

1918  
UI¡
 
uiX
 = 1; uiX < 
uiWidth
; uiX++, 
pcCurResiduÆ
++ )

1920 
accumuœt‹
 +*(
pcCurResiduÆ
);

1921 *
pcCurResiduÆ
 = (
Pñ
)
Clù3
<
TC€ff
>(
≥lMö
, 
≥lMax
, 
accumuœt‹
);

1926 
	}
}

1942 
Void
 
	gTComTrQu™t
::
	$xT
–c⁄° 
I¡
 
ch™√lBôDïth
, 
Boﬁ
 
u£DST
, 
Pñ
* 
piBlkResi
, 
UI¡
 
uiSåide
, 
TC€ff
* 
psC€ff
, I¡ 
iWidth
, I¡ 
iHeight
, c⁄° I¡ 
maxLog2TrDy«micR™ge
 )

1944 #i‡
MATRIX_MULT


1945 if–
iWidth
 =
iHeight
)

1947 
	`xTr
(
ch™√lBôDïth
, 
piBlkResi
, 
psC€ff
, 
uiSåide
, (
UI¡
)
iWidth
, 
u£DST
, 
maxLog2TrDy«micR™ge
);

1952 
TC€ff
 
block
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

1953 
TC€ff
 
c€ff
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

1955 
I¡
 
y
 = 0; y < 
iHeight
; y++)

1957 
I¡
 
x
 = 0; x < 
iWidth
; x++)

1959 
block
[(
y
 * 
iWidth
Ë+ 
x
] = 
piBlkResi
[(y * 
uiSåide
) + x];

1963 
	`xTrMxN
–
ch™√lBôDïth
, 
block
, 
c€ff
, 
iWidth
, 
iHeight
, 
u£DST
, 
maxLog2TrDy«micR™ge
 );

1965 
	`mem˝y
(
psC€ff
, 
c€ff
, (
iWidth
 * 
iHeight
 * (
TC€ff
)));

1966 
	}
}

1978 
Void
 
	gTComTrQu™t
::
	$xIT
–c⁄° 
I¡
 
ch™√lBôDïth
, 
Boﬁ
 
u£DST
, 
TC€ff
* 
∂C€f
, 
Pñ
* 
pResiduÆ
, 
UI¡
 
uiSåide
, I¡ 
iWidth
, I¡ 
iHeight
, c⁄° I¡ 
maxLog2TrDy«micR™ge
 )

1980 #i‡
MATRIX_MULT


1981 if–
iWidth
 =
iHeight
 )

1983 
	`xITr
(
ch™√lBôDïth
, 
∂C€f
, 
pResiduÆ
, 
uiSåide
, (
UI¡
)
iWidth
, 
u£DST
, 
maxLog2TrDy«micR™ge
);

1988 
TC€ff
 
block
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

1989 
TC€ff
 
c€ff
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

1991 
	`mem˝y
(
c€ff
, 
∂C€f
, (
iWidth
 * 
iHeight
 * (
TC€ff
)));

1993 
	`xITrMxN
–
ch™√lBôDïth
, 
c€ff
, 
block
, 
iWidth
, 
iHeight
, 
u£DST
, 
maxLog2TrDy«micR™ge
 );

1995 
I¡
 
y
 = 0; y < 
iHeight
; y++)

1997 
I¡
 
x
 = 0; x < 
iWidth
; x++)

1999 
pResiduÆ
[(
y
 * 
uiSåide
Ë+ 
x
] = 
	`Pñ
(
block
[(y * 
iWidth
) + x]);

2002 
	}
}

2011 
Void
 
	gTComTrQu™t
::
	$xTønsf‹mSkù
–
Pñ
* 
piBlkResi
, 
UI¡
 
uiSåide
, 
TC€ff
* 
psC€ff
, 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
comp⁄ít
 )

2013 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
comp⁄ít
);

2014 c⁄° 
I¡
 
width
 = 
ª˘
.width;

2015 c⁄° 
I¡
 
height
 = 
ª˘
.height;

2016 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
	`toCh™√lTy≥
(
comp⁄ít
));

2017 c⁄° 
I¡
 
ch™√lBôDïth
 = 
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
comp⁄ít
));

2019 
I¡
 
iTønsf‹mShi·
 = 
	`gëTønsf‹mShi·
(
ch™√lBôDïth
, 
rTu
.
	`GëEquivÆítLog2TrSize
(
comp⁄ít
), 
maxLog2TrDy«micR™ge
);

2020 i‡(
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
())

2022 
iTønsf‹mShi·
 = 
°d
::
max
<
I¡
>(0, iTransformShift);

2025 c⁄° 
Boﬁ
 
rŸ©eResiduÆ
 = 
rTu
.
	`isN⁄Tønsf‹medResiduÆRŸ©ed
(
comp⁄ít
);

2026 c⁄° 
UI¡
 
uiSizeMöus1
 = (
width
 * 
height
) - 1;

2028 i‡(
iTønsf‹mShi·
 >= 0)

2030 
UI¡
 
y
 = 0, 
c€fficõ¡Index
 = 0; y < 
height
; y++)

2032 
UI¡
 
x
 = 0; x < 
width
; x++, 
c€fficõ¡Index
++)

2034 
psC€ff
[
rŸ©eResiduÆ
 ? (
uiSizeMöus1
 - 
c€fficõ¡Index
Ë: c€fficõ¡Index] = 
	`TC€ff
(
piBlkResi
[(
y
 * 
uiSåide
Ë+ 
x
]Ë<< 
iTønsf‹mShi·
;

2040 
iTønsf‹mShi·
 = -iTransformShift;

2041 c⁄° 
TC€ff
 
off£t
 = 1 << (
iTønsf‹mShi·
 - 1);

2043 
UI¡
 
y
 = 0, 
c€fficõ¡Index
 = 0; y < 
height
; y++)

2045 
UI¡
 
x
 = 0; x < 
width
; x++, 
c€fficõ¡Index
++)

2047 
psC€ff
[
rŸ©eResiduÆ
 ? (
uiSizeMöus1
 - 
c€fficõ¡Index
Ë: c€fficõ¡Index] = (
	`TC€ff
(
piBlkResi
[(
y
 * 
uiSåide
Ë+ 
x
]Ë+ 
off£t
Ë>> 
iTønsf‹mShi·
;

2051 
	}
}

2060 
Void
 
	gTComTrQu™t
::
	$xITønsf‹mSkù
–
TC€ff
* 
∂C€f
, 
Pñ
* 
pResiduÆ
, 
UI¡
 
uiSåide
, 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
comp⁄ít
 )

2062 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
comp⁄ít
);

2063 c⁄° 
I¡
 
width
 = 
ª˘
.width;

2064 c⁄° 
I¡
 
height
 = 
ª˘
.height;

2065 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
	`toCh™√lTy≥
(
comp⁄ít
));

2066 #i‡
O0043_BEST_EFFORT_DECODING


2067 c⁄° 
I¡
 
ch™√lBôDïth
 = 
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSåómBôDïth
(
	`toCh™√lTy≥
(
comp⁄ít
));

2069 c⁄° 
I¡
 
ch™√lBôDïth
 = 
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
comp⁄ít
));

2072 
I¡
 
iTønsf‹mShi·
 = 
	`gëTønsf‹mShi·
(
ch™√lBôDïth
, 
rTu
.
	`GëEquivÆítLog2TrSize
(
comp⁄ít
), 
maxLog2TrDy«micR™ge
);

2073 i‡(
rTu
.
	`gëCU
()->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
())

2075 
iTønsf‹mShi·
 = 
°d
::
max
<
I¡
>(0, iTransformShift);

2078 c⁄° 
Boﬁ
 
rŸ©eResiduÆ
 = 
rTu
.
	`isN⁄Tønsf‹medResiduÆRŸ©ed
(
comp⁄ít
);

2079 c⁄° 
UI¡
 
uiSizeMöus1
 = (
width
 * 
height
) - 1;

2081 i‡(
iTønsf‹mShi·
 >= 0)

2083 c⁄° 
TC€ff
 
off£t
 = 
iTønsf‹mShi·
==0 ? 0 : (1 << (iTransformShift - 1));

2085 
UI¡
 
y
 = 0, 
c€fficõ¡Index
 = 0; y < 
height
; y++)

2087 
UI¡
 
x
 = 0; x < 
width
; x++, 
c€fficõ¡Index
++)

2089 
pResiduÆ
[(
y
 * 
uiSåide
Ë+ 
x
] = 
	`Pñ
((
∂C€f
[
rŸ©eResiduÆ
 ? (
uiSizeMöus1
 - 
c€fficõ¡Index
Ë: c€fficõ¡Index] + 
off£t
Ë>> 
iTønsf‹mShi·
);

2095 
iTønsf‹mShi·
 = -iTransformShift;

2097 
UI¡
 
y
 = 0, 
c€fficõ¡Index
 = 0; y < 
height
; y++)

2099 
UI¡
 
x
 = 0; x < 
width
; x++, 
c€fficõ¡Index
++)

2101 
pResiduÆ
[(
y
 * 
uiSåide
Ë+ 
x
] = 
	`Pñ
(
∂C€f
[
rŸ©eResiduÆ
 ? (
uiSizeMöus1
 - 
c€fficõ¡Index
Ë: c€fficõ¡Index] << 
iTønsf‹mShi·
);

2105 
	}
}

2119 
Void
 
	gTComTrQu™t
::
xR©eDi°O±Qu™t
 ( 
TComTU
 &
rTu
,

2120 
TC€ff
 * 
∂SrcC€ff
,

2121 
TC€ff
 * 
piD°C€ff
,

2122 #i‡
ADAPTIVE_QP_SELECTION


2123 
TC€ff
 * 
piAæD°C€ff
,

2125 
TC€ff
 &
uiAbsSum
,

2126 c⁄° 
Comp⁄ítID
 
compID
,

2127 c⁄° 
QpP¨am
 &
cQP
 )

2129 c⁄° 
	gTComRe˘™gÀ
 & 
	gª˘
 = 
rTu
.
gëRe˘
(
compID
);

2130 c⁄° 
UI¡
 
	guiWidth
 = 
ª˘
.
width
;

2131 c⁄° 
UI¡
 
	guiHeight
 = 
ª˘
.
height
;

2132 
TComD©aCU
 * 
	gpcCU
 = 
rTu
.
gëCU
();

2133 c⁄° 
UI¡
 
	guiAbsP¨tIdx
 = 
rTu
.
GëAbsP¨tIdxTU
();

2134 c⁄° 
Ch™√lTy≥
 
	gch™√lTy≥
 = 
toCh™√lTy≥
(
compID
);

2135 c⁄° 
UI¡
 
	guiLog2TrSize
 = 
rTu
.
GëEquivÆítLog2TrSize
(
compID
);

2137 c⁄° 
Boﬁ
 
	gexãndedPªcisi⁄
 = 
pcCU
->
gëSli˚
()->
gëSPS
()->
gëSpsR™geExãnsi⁄
().
gëExãndedPªcisi⁄Pro˚ssögFœg
();

2138 c⁄° 
I¡
 
	gmaxLog2TrDy«micR™ge
 = 
pcCU
->
gëSli˚
()->
gëSPS
()->
gëMaxLog2TrDy«micR™ge
(
toCh™√lTy≥
(
compID
));

2139 c⁄° 
I¡
 
	gch™√lBôDïth
 = 
rTu
.
gëCU
()->
gëSli˚
()->
gëSPS
()->
gëBôDïth
(
ch™√lTy≥
);

2148 
I¡
 
	giTønsf‹mShi·
 = 
gëTønsf‹mShi·
(
ch™√lBôDïth
, 
uiLog2TrSize
, 
maxLog2TrDy«micR™ge
);

2149 i‡((
	gpcCU
->
gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
Ë!0Ë&& 
exãndedPªcisi⁄
)

2151 
iTønsf‹mShi·
 = 
°d
::
max
<
I¡
>(0, 
	giTønsf‹mShi·
);

2154 c⁄° 
Boﬁ
 
	gbU£GﬁombRi˚P¨amëîAd≠èti⁄
 = 
pcCU
->
gëSli˚
()->
gëSPS
()->
gëSpsR™geExãnsi⁄
().
gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
();

2155 c⁄° 
UI¡
 
	göôülGﬁombRi˚P¨amëî
 = 
m_pcE°BôsSbac
->
gﬁombRi˚Ad≠èti⁄Sèti°ics
[
rTu
.
gëGﬁombRi˚Sèti°icsIndex
(
compID
)] / 
RExt__GOLOMB_RICE_INCREMENT_DIVISOR
;

2156 
UI¡
 
	guiGoRi˚P¨am
 = 
öôülGﬁombRi˚P¨amëî
;

2157 
DoubÀ
 
	gd64BlockUncodedCo°
 = 0;

2158 c⁄° 
UI¡
 
	guiLog2BlockWidth
 = 
g_aucC⁄vîtToBô
[ 
uiWidth
 ] + 2;

2159 c⁄° 
UI¡
 
	guiLog2BlockHeight
 = 
g_aucC⁄vîtToBô
[ 
uiHeight
 ] + 2;

2160 c⁄° 
UI¡
 
	guiMaxNumC€ff
 = 
uiWidth
 * 
uiHeight
;

2161 
as£π
(
compID
<
MAX_NUM_COMPONENT
);

2163 
I¡
 
	gsˇlögLi°Ty≥
 = 
gëSˇlögLi°Ty≥
(
pcCU
->
gëPªdi˘i⁄Mode
(
uiAbsP¨tIdx
), 
compID
);

2164 
as£π
(
sˇlögLi°Ty≥
 < 
SCALING_LIST_NUM
);

2166 #i‡
ADAPTIVE_QP_SELECTION


2167 
mem£t
(
piAæD°C€ff
, 0, (
TC€ff
Ë* 
uiMaxNumC€ff
);

2170 
DoubÀ
 
	gpdCo°C€ff
 [ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

2171 
DoubÀ
 
	gpdCo°Sig
 [ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

2172 
DoubÀ
 
	gpdCo°C€ff0
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

2173 
mem£t
–
pdCo°C€ff
, 0, (
DoubÀ
Ë* 
uiMaxNumC€ff
 );

2174 
mem£t
–
pdCo°Sig
, 0, (
DoubÀ
Ë* 
uiMaxNumC€ff
 );

2175 
I¡
 
	gøãIncUp
 [ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

2176 
I¡
 
	gøãIncDown
 [ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

2177 
I¡
 
	gsigR©eDñè
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

2178 
TC€ff
 
	gdñèU
 [ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

2179 
mem£t
–
øãIncUp
, 0, (
I¡
 ) * 
uiMaxNumC€ff
 );

2180 
mem£t
–
øãIncDown
, 0, (
I¡
 ) * 
uiMaxNumC€ff
 );

2181 
mem£t
–
sigR©eDñè
, 0, (
I¡
 ) * 
uiMaxNumC€ff
 );

2182 
mem£t
–
dñèU
, 0, (
TC€ff
Ë* 
uiMaxNumC€ff
 );

2184 c⁄° 
I¡
 
	giQBôs
 = 
QUANT_SHIFT
 + 
cQP
.
≥r
 + 
iTønsf‹mShi·
;

2185 c⁄° 
DoubÀ
 *c⁄° 
	gpdEºSˇÀ
 = 
gëEºSˇÀC€ff
(
sˇlögLi°Ty≥
, (
uiLog2TrSize
-2), 
cQP
.
ªm
);

2186 c⁄° 
I¡
 *c⁄° 
	gpiQC€f
 = 
gëQu™tC€ff
(
sˇlögLi°Ty≥
, 
cQP
.
ªm
, (
uiLog2TrSize
-2));

2188 c⁄° 
Boﬁ
 
	gíabÀSˇlögLi°s
 = 
gëU£SˇlögLi°
(
uiWidth
, 
uiHeight
, (
pcCU
->
gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
) != 0));

2189 c⁄° 
I¡
 
	gdeÁu…Qu™tißti⁄C€fficõ¡
 = 
g_qu™tSˇÀs
[
cQP
.
ªm
];

2190 c⁄° 
DoubÀ
 
	gdeÁu…Eº‹SˇÀ
 = 
gëEºSˇÀC€ffNoSˇlögLi°
(
sˇlögLi°Ty≥
, (
uiLog2TrSize
-2), 
cQP
.
ªm
);

2192 c⁄° 
TC€ff
 
	gíå›yCodögMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

2193 c⁄° 
TC€ff
 
	gíå›yCodögMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

2195 #i‡
ADAPTIVE_QP_SELECTION


2196 
I¡
 
	giQBôsC
 = 
iQBôs
 - 
ARL_C_PRECISION
;

2197 
I¡
 
	giAddC
 = 1 << (
iQBôsC
-1);

2200 
TUE¡r›yCodögP¨amëîs
 
	gcodögP¨amëîs
;

2201 
gëTUE¡r›yCodögP¨amëîs
(
codögP¨amëîs
, 
rTu
, 
compID
);

2202 c⁄° 
UI¡
 
	guiCGSize
 = (1 << 
MLS_CG_SIZE
);

2204 
DoubÀ
 
	gpdCo°C€ffGroupSig
[ 
MLS_GRP_NUM
 ];

2205 
UI¡
 
	guiSigC€ffGroupFœg
[ 
MLS_GRP_NUM
 ];

2206 
I¡
 
	giCGLa°SˇnPos
 = -1;

2208 
UI¡
 
	guiCtxSë
 = 0;

2209 
I¡
 
	gc1
 = 1;

2210 
I¡
 
	gc2
 = 0;

2211 
DoubÀ
 
	gd64Ba£Co°
 = 0;

2212 
I¡
 
	giLa°SˇnPos
 = -1;

2214 
UI¡
 
	gc1Idx
 = 0;

2215 
UI¡
 
	gc2Idx
 = 0;

2216 
I¡
 
	gba£Levñ
;

2218 
mem£t
–
pdCo°C€ffGroupSig
, 0, (
DoubÀ
Ë* 
MLS_GRP_NUM
 );

2219 
mem£t
–
uiSigC€ffGroupFœg
, 0, (
UI¡
Ë* 
MLS_GRP_NUM
 );

2221 
UI¡
 
	guiCGNum
 = 
uiWidth
 * 
uiHeight
 >> 
MLS_CG_SIZE
;

2222 
I¡
 
	giSˇnPos
;

2223 
c€ffGroupRDSèts
 
	grdSèts
;

2225 c⁄° 
UI¡
 
	gsignifiˇn˚M≠C⁄ãxtOff£t
 = 
gëSignifiˇn˚M≠C⁄ãxtOff£t
(
compID
);

2227 
I¡
 
	giCGSˇnPos
 = 
uiCGNum
-1; iCGScanPos >= 0; iCGScanPos--)

2229 
UI¡
 
	guiCGBlkPos
 = 
codögP¨amëîs
.
sˇnCG
[ 
iCGSˇnPos
 ];

2230 
UI¡
 
	guiCGPosY
 = 
uiCGBlkPos
 / 
codögP¨amëîs
.
widthInGroups
;

2231 
UI¡
 
	guiCGPosX
 = 
uiCGBlkPos
 - (
uiCGPosY
 * 
codögP¨amëîs
.
widthInGroups
);

2233 
mem£t
–&
rdSèts
, 0,  (
c€ffGroupRDSèts
));

2235 c⁄° 
I¡
 
	g∑âînSigCtx
 = 
TComTrQu™t
::
ˇlcP©ã∫SigCtx
(
uiSigC€ffGroupFœg
, 
uiCGPosX
, 
uiCGPosY
, 
codögP¨amëîs
.
widthInGroups
, codögP¨amëîs.
heightInGroups
);

2237 
I¡
 
	giSˇnPosöCG
 = 
uiCGSize
-1; iScanPosinCG >= 0; iScanPosinCG--)

2239 
	giSˇnPos
 = 
iCGSˇnPos
*
uiCGSize
 + 
iSˇnPosöCG
;

2241 
UI¡
 
	guiBlkPos
 = 
codögP¨amëîs
.
sˇn
[
iSˇnPos
];

2244 c⁄° 
I¡
 
	gqu™tißti⁄C€fficõ¡
 = (
íabÀSˇlögLi°s
Ë? 
piQC€f
 [
uiBlkPos
] : 
deÁu…Qu™tißti⁄C€fficõ¡
;

2245 c⁄° 
DoubÀ
 
	gîr‹SˇÀ
 = (
íabÀSˇlögLi°s
Ë? 
pdEºSˇÀ
[
uiBlkPos
] : 
deÁu…Eº‹SˇÀ
;

2247 c⁄° 
I¡64
 
	gtmpLevñ
 = I¡64(
abs
(
∂SrcC€ff
[ 
uiBlkPos
 ])Ë* 
qu™tißti⁄C€fficõ¡
;

2249 c⁄° 
I¡îmedüã_I¡
 
	glLevñDoubÀ
 = (I¡îmedüã_I¡)
mö
<
I¡64
>(
tmpLevñ
, 
	g°d
::
numîic_limôs
<I¡îmedüã_I¡>::
max
(Ë- (I¡îmedüã_I¡(1Ë<< (
iQBôs
 - 1)));

2251 #i‡
ADAPTIVE_QP_SELECTION


2252 if–
	gm_bU£Ad≠tQpSñe˘
 )

2254 
	gpiAæD°C€ff
[
uiBlkPos
] = (
TC€ff
)(–
lLevñDoubÀ
 + 
iAddC
Ë>> 
iQBôsC
 );

2257 c⁄° 
UI¡
 
	guiMaxAbsLevñ
 = 
°d
::
mö
<UI¡>(UI¡(
íå›yCodögMaximum
), UI¡((
lLevñDoubÀ
 + (
I¡îmedüã_I¡
(1Ë<< (
iQBôs
 - 1))) >> iQBits));

2259 c⁄° 
DoubÀ
 
	gdEº
 = DoubÀ–
lLevñDoubÀ
 );

2260 
	gpdCo°C€ff0
[ 
iSˇnPos
 ] = 
dEº
 * dEº * 
îr‹SˇÀ
;

2261 
	gd64BlockUncodedCo°
 +
pdCo°C€ff0
[ 
iSˇnPos
 ];

2262 
	gpiD°C€ff
[ 
uiBlkPos
 ] = 
uiMaxAbsLevñ
;

2264 i‡–
	guiMaxAbsLevñ
 > 0 && 
	giLa°SˇnPos
 < 0 )

2266 
	giLa°SˇnPos
 = 
iSˇnPos
;

2267 
	guiCtxSë
 = 
gëC⁄ãxtSëIndex
(
compID
, (
iSˇnPos
 >> 
MLS_CG_SIZE
), 0);

2268 
	giCGLa°SˇnPos
 = 
iCGSˇnPos
;

2271 i‡–
	giLa°SˇnPos
 >= 0 )

2274 
UI¡
 
uiLevñ
;

2275 
UI¡
 
	guiO√Ctx
 = (
NUM_ONE_FLAG_CTX_PER_SET
 * 
uiCtxSë
Ë+ 
c1
;

2276 
UI¡
 
	guiAbsCtx
 = (
NUM_ABS_FLAG_CTX_PER_SET
 * 
uiCtxSë
Ë+ 
c2
;

2278 if–
	giSˇnPos
 =
iLa°SˇnPos
 )

2280 
uiLevñ
 = 
xGëCodedLevñ
–
pdCo°C€ff
[ 
iSˇnPos
 ], 
pdCo°C€ff0
[ iSˇnPo†], 
pdCo°Sig
[ iScanPos ],

2281 
lLevñDoubÀ
, 
uiMaxAbsLevñ
, 
signifiˇn˚M≠C⁄ãxtOff£t
, 
uiO√Ctx
, 
uiAbsCtx
, 
uiGoRi˚P¨am
,

2282 
c1Idx
, 
c2Idx
, 
iQBôs
, 
îr‹SˇÀ
, 1, 
exãndedPªcisi⁄
, 
maxLog2TrDy«micR™ge


2287 
USh‹t
 
	guiCtxSig
 = 
signifiˇn˚M≠C⁄ãxtOff£t
 + 
gëSigCtxInc
–
∑âînSigCtx
, 
codögP¨amëîs
, 
iSˇnPos
, 
uiLog2BlockWidth
, 
uiLog2BlockHeight
, 
ch™√lTy≥
 );

2289 
	guiLevñ
 = 
xGëCodedLevñ
–
pdCo°C€ff
[ 
iSˇnPos
 ], 
pdCo°C€ff0
[ iSˇnPo†], 
pdCo°Sig
[ iScanPos ],

2290 
lLevñDoubÀ
, 
uiMaxAbsLevñ
, 
uiCtxSig
, 
uiO√Ctx
, 
uiAbsCtx
, 
uiGoRi˚P¨am
,

2291 
c1Idx
, 
c2Idx
, 
iQBôs
, 
îr‹SˇÀ
, 0, 
exãndedPªcisi⁄
, 
maxLog2TrDy«micR™ge


2294 
	gsigR©eDñè
[ 
uiBlkPos
 ] = 
m_pcE°BôsSbac
->
signifiˇ¡Bôs
[ 
uiCtxSig
 ][ 1 ] - m_pcEstBitsSbac->significantBits[ uiCtxSig ][ 0 ];

2297 
	gdñèU
[ 
uiBlkPos
 ] = 
TC€ff
((
lLevñDoubÀ
 - (
I¡îmedüã_I¡
(
uiLevñ
Ë<< 
iQBôs
)) >> (iQBits-8));

2299 if–
	guiLevñ
 > 0 )

2301 
I¡
 
	gøãNow
 = 
xGëICR©e
–
uiLevñ
, 
uiO√Ctx
, 
uiAbsCtx
, 
uiGoRi˚P¨am
, 
c1Idx
, 
c2Idx
, 
exãndedPªcisi⁄
, 
maxLog2TrDy«micR™ge
 );

2302 
	gøãIncUp
 [ 
uiBlkPos
 ] = 
xGëICR©e
–
uiLevñ
+1, 
uiO√Ctx
, 
uiAbsCtx
, 
uiGoRi˚P¨am
, 
c1Idx
, 
c2Idx
, 
exãndedPªcisi⁄
, 
maxLog2TrDy«micR™ge
 ) - 
	gøãNow
;

2303 
	gøãIncDown
 [ 
uiBlkPos
 ] = 
xGëICR©e
–
uiLevñ
-1, 
uiO√Ctx
, 
uiAbsCtx
, 
uiGoRi˚P¨am
, 
c1Idx
, 
c2Idx
, 
exãndedPªcisi⁄
, 
maxLog2TrDy«micR™ge
 ) - 
	gøãNow
;

2307 
	gøãIncUp
 [ 
uiBlkPos
 ] = 
m_pcE°BôsSbac
->
m_gª©îO√Bôs
[ 
uiO√Ctx
 ][ 0 ];

2309 
	gpiD°C€ff
[ 
uiBlkPos
 ] = 
uiLevñ
;

2310 
	gd64Ba£Co°
 +
pdCo°C€ff
 [ 
iSˇnPos
 ];

2312 
	gba£Levñ
 = (
c1Idx
 < 
C1FLAG_NUMBER
Ë? (2 + (
c2Idx
 < 
C2FLAG_NUMBER
)) : 1;

2313 if–
	guiLevñ
 >
ba£Levñ
 )

2315 i‡(
uiLevñ
 > 3*(1<<
uiGoRi˚P¨am
))

2317 
uiGoRi˚P¨am
 = 
bU£GﬁombRi˚P¨amëîAd≠èti⁄
 ? (uiGoRi˚P¨am + 1Ë: (
°d
::
mö
<
UI¡
>((uiGoRiceParam + 1), 4));

2320 i‡–
	guiLevñ
 >= 1)

2322 
c1Idx
 ++;

2326 if–
	guiLevñ
 > 1 )

2328 
	gc1
 = 0;

2329 
	gc2
 +(
c2
 < 2);

2330 
	gc2Idx
 ++;

2332 if–(
	gc1
 < 3Ë&& (c1 > 0Ë&& 
	guiLevñ
)

2334 
	gc1
++;

2338 if––
	giSˇnPos
 % 
	guiCGSize
 =0 ) && ( 
iSˇnPos
 > 0 ) )

2340 
uiCtxSë
 = 
gëC⁄ãxtSëIndex
(
compID
, ((
iSˇnPos
 - 1Ë>> 
MLS_CG_SIZE
), (
c1
 == 0));

2341 
	gc1
 = 1;

2342 
	gc2
 = 0;

2343 
	gc1Idx
 = 0;

2344 
	gc2Idx
 = 0;

2345 
	guiGoRi˚P¨am
 = 
öôülGﬁombRi˚P¨amëî
;

2350 
	gd64Ba£Co°
 +
pdCo°C€ff0
[ 
iSˇnPos
 ];

2352 
	grdSèts
.
	gd64SigCo°
 +
pdCo°Sig
[ 
iSˇnPos
 ];

2353 i‡(
	giSˇnPosöCG
 == 0 )

2355 
rdSèts
.
d64SigCo°_0
 = 
pdCo°Sig
[ 
iSˇnPos
 ];

2357 i‡(
	gpiD°C€ff
[ 
uiBlkPos
 ] )

2359 
	guiSigC€ffGroupFœg
[ 
uiCGBlkPos
 ] = 1;

2360 
	grdSèts
.
	gd64CodedLevñ™dDi°
 +
pdCo°C€ff
[ 
iSˇnPos
 ] - 
pdCo°Sig
[ iScanPos ];

2361 
	grdSèts
.
	gd64UncodedDi°
 +
pdCo°C€ff0
[ 
iSˇnPos
 ];

2362 i‡–
	giSˇnPosöCG
 != 0 )

2364 
rdSèts
.
iNNZbef‹ePos0
++;

2369 i‡(
	giCGLa°SˇnPos
 >= 0)

2371 if–
iCGSˇnPos
 )

2373 i‡(
uiSigC€ffGroupFœg
[ 
uiCGBlkPos
 ] == 0)

2375 
UI¡
 
uiCtxSig
 = 
gëSigC€ffGroupCtxInc
–
uiSigC€ffGroupFœg
, 
uiCGPosX
, 
uiCGPosY
, 
codögP¨amëîs
.
widthInGroups
, codögP¨amëîs.
heightInGroups
 );

2376 
	gd64Ba£Co°
 +
xGëR©eSigC€ffGroup
(0, 
uiCtxSig
Ë- 
	grdSèts
.
	gd64SigCo°
;;

2377 
	gpdCo°C€ffGroupSig
[ 
iCGSˇnPos
 ] = 
xGëR©eSigC€ffGroup
(0, 
uiCtxSig
);

2381 i‡(
	giCGSˇnPos
 < 
	giCGLa°SˇnPos
)

2383 i‡–
	grdSèts
.
	giNNZbef‹ePos0
 == 0 )

2385 
d64Ba£Co°
 -
rdSèts
.
d64SigCo°_0
;

2386 
	grdSèts
.
	gd64SigCo°
 -
rdSèts
.
d64SigCo°_0
;

2389 
DoubÀ
 
	gd64Co°ZîoCG
 = 
d64Ba£Co°
;

2392 
UI¡
 
	guiCtxSig
 = 
gëSigC€ffGroupCtxInc
–
uiSigC€ffGroupFœg
, 
uiCGPosX
, 
uiCGPosY
, 
codögP¨amëîs
.
widthInGroups
, codögP¨amëîs.
heightInGroups
 );

2394 i‡(
	giCGSˇnPos
 < 
	giCGLa°SˇnPos
)

2396 
	gd64Ba£Co°
 +
xGëR©eSigC€ffGroup
(1, 
uiCtxSig
);

2397 
	gd64Co°ZîoCG
 +
xGëR©eSigC€ffGroup
(0, 
uiCtxSig
);

2398 
	gpdCo°C€ffGroupSig
[ 
iCGSˇnPos
 ] = 
xGëR©eSigC€ffGroup
(1, 
uiCtxSig
);

2402 
	gd64Co°ZîoCG
 +
rdSèts
.
d64UncodedDi°
;

2403 
	gd64Co°ZîoCG
 -
rdSèts
.
d64CodedLevñ™dDi°
;

2404 
	gd64Co°ZîoCG
 -
rdSèts
.
d64SigCo°
;

2407 i‡–
	gd64Co°ZîoCG
 < 
	gd64Ba£Co°
 )

2409 
	guiSigC€ffGroupFœg
[ 
uiCGBlkPos
 ] = 0;

2410 
	gd64Ba£Co°
 = 
d64Co°ZîoCG
;

2411 i‡(
	giCGSˇnPos
 < 
	giCGLa°SˇnPos
)

2413 
	gpdCo°C€ffGroupSig
[ 
iCGSˇnPos
 ] = 
xGëR©eSigC€ffGroup
(0, 
uiCtxSig
);

2416 
I¡
 
	giSˇnPosöCG
 = 
uiCGSize
-1; iScanPosinCG >= 0; iScanPosinCG--)

2418 
	giSˇnPos
 = 
iCGSˇnPos
*
uiCGSize
 + 
iSˇnPosöCG
;

2419 
UI¡
 
	guiBlkPos
 = 
codögP¨amëîs
.
sˇn
[ 
iSˇnPos
 ];

2421 i‡(
	gpiD°C€ff
[ 
uiBlkPos
 ])

2423 
	gpiD°C€ff
 [ 
uiBlkPos
 ] = 0;

2424 
	gpdCo°C€ff
[ 
iSˇnPos
 ] = 
pdCo°C€ff0
[ iScanPos ];

2425 
	gpdCo°Sig
 [ 
iSˇnPos
 ] = 0;

2434 
	guiSigC€ffGroupFœg
[ 
uiCGBlkPos
 ] = 1;

2440 i‡–
	giLa°SˇnPos
 < 0 )

2445 
DoubÀ
 
	gd64Be°Co°
 = 0;

2446 
I¡
 
	gui16CtxCbf
 = 0;

2447 
I¡
 
	giBe°La°IdxP1
 = 0;

2448 if–!
	gpcCU
->
isI¡ø
–
uiAbsP¨tIdx
 ) && 
isLuma
(
compID
Ë&&ÖcCU->
gëTønsf‹mIdx
( uiAbsPartIdx ) == 0 )

2450 
ui16CtxCbf
 = 0;

2451 
	gd64Be°Co°
 = 
d64BlockUncodedCo°
 + 
xGëICo°
–
m_pcE°BôsSbac
->
blockRoŸCbpBôs
[ 
ui16CtxCbf
 ][ 0 ] );

2452 
	gd64Ba£Co°
 +
xGëICo°
–
m_pcE°BôsSbac
->
blockRoŸCbpBôs
[ 
ui16CtxCbf
 ][ 1 ] );

2456 
	gui16CtxCbf
 = 
pcCU
->
gëCtxQtCbf
–
rTu
, 
ch™√lTy≥
 );

2457 
	gui16CtxCbf
 +
gëCBFC⁄ãxtOff£t
(
compID
);

2458 
	gd64Be°Co°
 = 
d64BlockUncodedCo°
 + 
xGëICo°
–
m_pcE°BôsSbac
->
blockCbpBôs
[ 
ui16CtxCbf
 ][ 0 ] );

2459 
	gd64Ba£Co°
 +
xGëICo°
–
m_pcE°BôsSbac
->
blockCbpBôs
[ 
ui16CtxCbf
 ][ 1 ] );

2463 
Boﬁ
 
	gbFoundLa°
 = 
Ál£
;

2464 
I¡
 
	giCGSˇnPos
 = 
iCGLa°SˇnPos
; iCGScanPos >= 0; iCGScanPos--)

2466 
UI¡
 
	guiCGBlkPos
 = 
codögP¨amëîs
.
sˇnCG
[ 
iCGSˇnPos
 ];

2468 
	gd64Ba£Co°
 -
pdCo°C€ffGroupSig
 [ 
iCGSˇnPos
 ];

2469 i‡(
	guiSigC€ffGroupFœg
[ 
uiCGBlkPos
 ])

2471 
I¡
 
	giSˇnPosöCG
 = 
uiCGSize
-1; iScanPosinCG >= 0; iScanPosinCG--)

2473 
	giSˇnPos
 = 
iCGSˇnPos
*
uiCGSize
 + 
iSˇnPosöCG
;

2475 i‡(
	giSˇnPos
 > 
	giLa°SˇnPos
)

2479 
UI¡
 
	guiBlkPos
 = 
codögP¨amëîs
.
sˇn
[
iSˇnPos
];

2481 if–
	gpiD°C€ff
[ 
uiBlkPos
 ] )

2483 
UI¡
 
	guiPosY
 = 
uiBlkPos
 >> 
uiLog2BlockWidth
;

2484 
UI¡
 
	guiPosX
 = 
uiBlkPos
 - ( 
uiPosY
 << 
uiLog2BlockWidth
 );

2486 
DoubÀ
 
	gd64Co°La°

codögP¨amëîs
.
sˇnTy≥
 =
SCAN_VER
 ? 
xGëR©eLa°
–
uiPosY
, 
uiPosX
, 
compID
 ) : xGetRateLast( uiPosX, uiPosY, compID );

2487 
DoubÀ
 
	gtŸÆCo°
 = 
d64Ba£Co°
 + 
d64Co°La°
 - 
pdCo°Sig
[ 
iSˇnPos
 ];

2489 if–
	gtŸÆCo°
 < 
	gd64Be°Co°
 )

2491 
	giBe°La°IdxP1
 = 
iSˇnPos
 + 1;

2492 
	gd64Be°Co°
 = 
tŸÆCo°
;

2494 if–
	gpiD°C€ff
[ 
uiBlkPos
 ] > 1 )

2496 
	gbFoundLa°
 = 
åue
;

2499 
	gd64Ba£Co°
 -
pdCo°C€ff
[ 
iSˇnPos
 ];

2500 
	gd64Ba£Co°
 +
pdCo°C€ff0
[ 
iSˇnPos
 ];

2504 
	gd64Ba£Co°
 -
pdCo°Sig
[ 
iSˇnPos
 ];

2507 i‡(
	gbFoundLa°
)

2515  
I¡
 
	gsˇnPos
 = 0; sˇnPo†< 
	giBe°La°IdxP1
; scanPos++ )

2517 
I¡
 
	gblkPos
 = 
codögP¨amëîs
.
sˇn
[ 
sˇnPos
 ];

2518 
TC€ff
 
	gÀvñ
 = 
piD°C€ff
[ 
blkPos
 ];

2519 
	guiAbsSum
 +
Àvñ
;

2520 
	gpiD°C€ff
[ 
blkPos
 ] = ( 
∂SrcC€ff
[ blkPo†] < 0 ) ? -
Àvñ
 :Üevel;

2524  
I¡
 
	gsˇnPos
 = 
iBe°La°IdxP1
; sˇnPo†<
iLa°SˇnPos
; scanPos++ )

2526 
	gpiD°C€ff
[ 
codögP¨amëîs
.
sˇn
[ 
sˇnPos
 ] ] = 0;

2530 if–
	gpcCU
->
gëSli˚
()->
gëPPS
()->
gëSignD©aHidögE«bÀdFœg
(Ë&& 
	guiAbsSum
>=2)

2532 c⁄° 
DoubÀ
 
övî£Qu™tSˇÀ
 = DoubÀ(
g_övQu™tSˇÀs
[
cQP
.
ªm
]);

2533 
I¡64
 
	grdFa˘‹
 = (I¡64)(
övî£Qu™tSˇÀ
 * invî£Qu™tSˇÀ * (1 << (2 * 
cQP
.
≥r
))

2534 / 
m_dLambda
 / 16 / (1 << (2 * 
DISTORTION_PRECISION_ADJUSTMENT
(
ch™√lBôDïth
 - 8)))

2537 
I¡
 
	gœ°CG
 = -1;

2538 
I¡
 
	gabsSum
 = 0 ;

2539 
I¡
 
	gn
 ;

2541  
I¡
 
	gsubSë
 = (
uiWidth
*
uiHeight
-1Ë>> 
MLS_CG_SIZE
; subSet >= 0; subSet-- )

2543 
I¡
 
	gsubPos
 = 
subSë
 << 
MLS_CG_SIZE
;

2544 
I¡
 
	gfú°NZPosInCG
=
uiCGSize
 , 
	gœ°NZPosInCG
=-1 ;

2545 
	gabsSum
 = 0 ;

2547 
	gn
 = 
uiCGSize
-1;Ç >= 0; --n )

2549 if–
	gpiD°C€ff
[ 
codögP¨amëîs
.
sˇn
[ 
n
 + 
subPos
 ]] )

2551 
	gœ°NZPosInCG
 = 
n
;

2556 
	gn
 = 0;Ç <
	guiCGSize
;Ç++ )

2558 if–
	gpiD°C€ff
[ 
codögP¨amëîs
.
sˇn
[ 
n
 + 
subPos
 ]] )

2560 
	gfú°NZPosInCG
 = 
n
;

2565 
	gn
 = 
fú°NZPosInCG
;Ç <=
œ°NZPosInCG
;Ç++ )

2567 
	gabsSum
 +
I¡
(
piD°C€ff
[ 
codögP¨amëîs
.
sˇn
[ 
n
 + 
subPos
 ]]);

2570 if(
	gœ°NZPosInCG
>=0 && 
œ°CG
==-1)

2572 
œ°CG
 = 1;

2575 if–
	gœ°NZPosInCG
-
	gfú°NZPosInCG
>=
SBH_THRESHOLD
 )

2577 
UI¡
 
signbô
 = (
piD°C€ff
[
codögP¨amëîs
.
sˇn
[
subPos
+
fú°NZPosInCG
]]>0?0:1);

2578 if–
	gsignbô
!=(
absSum
&0x1) )

2581 
I¡64
 
möCo°Inc
 = 
°d
::
numîic_limôs
<I¡64>::
max
(), 
	gcurCo°
 = std::numeric_limits<Int64>::max();

2582 
I¡
 
	gmöPos
 = -1, 
	gföÆCh™ge
 = 0, 
	gcurCh™ge
 = 0;

2584  
	gn
 = (
œ°CG
==1?
œ°NZPosInCG
:
uiCGSize
-1) ;Ç >= 0; --n )

2586 
UI¡
 
	guiBlkPos
 = 
codögP¨amëîs
.
sˇn
[ 
n
 + 
subPos
 ];

2587 if(
	gpiD°C€ff
[ 
uiBlkPos
 ] != 0 )

2589 
I¡64
 
co°Up
 = 
rdFa˘‹
 * ( - 
dñèU
[
uiBlkPos
] ) + 
øãIncUp
[uiBlkPos];

2590 
I¡64
 
	gco°Down
 = 
rdFa˘‹
 * ( 
dñèU
[
uiBlkPos
] ) + 
øãIncDown
[uiBlkPos]

2591 - ((
abs
(
piD°C€ff
[
uiBlkPos
]Ë=1Ë? 
sigR©eDñè
[uiBlkPos] : 0);

2593 if(
	gœ°CG
==1 && 
œ°NZPosInCG
==
n
 && 
abs
(
piD°C€ff
[
uiBlkPos
])==1)

2595 
co°Down
 -= (4<<15);

2598 if(
	gco°Up
<
	gco°Down
)

2600 
	gcurCo°
 = 
co°Up
;

2601 
	gcurCh™ge
 = 1;

2605 
	gcurCh™ge
 = -1;

2606 if(
	gn
==
fú°NZPosInCG
 && 
abs
(
piD°C€ff
[
uiBlkPos
])==1)

2608 
curCo°
 = 
°d
::
numîic_limôs
<
I¡64
>::
max
();

2612 
	gcurCo°
 = 
co°Down
;

2618 
	gcurCo°
 = 
rdFa˘‹
 * ( - (
abs
(
dñèU
[
uiBlkPos
])ËË+ (1<<15Ë+ 
øãIncUp
[uiBlkPos] + 
sigR©eDñè
[uiBlkPos] ;

2619 
	gcurCh™ge
 = 1 ;

2621 if(
	gn
<
	gfú°NZPosInCG
)

2623 
UI¡
 
	gthissignbô
 = (
∂SrcC€ff
[
uiBlkPos
]>=0?0:1);

2624 if(
	gthissignbô
 !
signbô
 )

2626 
curCo°
 = 
°d
::
numîic_limôs
<
I¡64
>::
max
();

2631 if–
	gcurCo°
<
	gmöCo°Inc
)

2633 
	gmöCo°Inc
 = 
curCo°
;

2634 
	gföÆCh™ge
 = 
curCh™ge
;

2635 
	gmöPos
 = 
uiBlkPos
;

2639 if(
	gpiD°C€ff
[
möPos
] =
íå›yCodögMaximum
 || 
piD°C€ff
[möPos] =
íå›yCodögMöimum
)

2641 
föÆCh™ge
 = -1;

2644 if(
	g∂SrcC€ff
[
möPos
]>=0)

2646 
piD°C€ff
[
möPos
] +
föÆCh™ge
 ;

2650 
	gpiD°C€ff
[
möPos
] -
föÆCh™ge
 ;

2655 if(
	gœ°CG
==1)

2657 
œ°CG
=0 ;

2672 
I¡
 
	gTComTrQu™t
::
	$ˇlcP©ã∫SigCtx
–c⁄° 
UI¡
* 
sigC€ffGroupFœg
, UI¡ 
uiCGPosX
, UI¡ 
uiCGPosY
, UI¡ 
widthInGroups
, UI¡ 
heightInGroups
 )

2674 i‡((
widthInGroups
 <1Ë&& (
heightInGroups
 <= 1))

2679 c⁄° 
Boﬁ
 
rightAvaûabÀ
 = 
uiCGPosX
 < (
widthInGroups
 - 1);

2680 c⁄° 
Boﬁ
 
bñowAvaûabÀ
 = 
uiCGPosY
 < (
heightInGroups
 - 1);

2682 
UI¡
 
sigRight
 = 0;

2683 
UI¡
 
sigLowî
 = 0;

2685 i‡(
rightAvaûabÀ
)

2687 
sigRight
 = ((
sigC€ffGroupFœg
[ (
uiCGPosY
 * 
widthInGroups
Ë+ 
uiCGPosX
 + 1 ] != 0) ? 1 : 0);

2689 i‡(
bñowAvaûabÀ
)

2691 
sigLowî
 = ((
sigC€ffGroupFœg
[ (
uiCGPosY
 + 1Ë* 
widthInGroups
 + 
uiCGPosX
 ] != 0) ? 1 : 0);

2694  
sigRight
 + (
sigLowî
 << 1);

2695 
	}
}

2707 
I¡
 
	gTComTrQu™t
::
	$gëSigCtxInc
 ( 
I¡
 
∑âînSigCtx
,

2708 c⁄° 
TUE¡r›yCodögP¨amëîs
 &
codögP¨amëîs
,

2709 c⁄° 
I¡
 
sˇnPosôi⁄
,

2710 c⁄° 
I¡
 
log2BlockWidth
,

2711 c⁄° 
I¡
 
log2BlockHeight
,

2712 c⁄° 
Ch™√lTy≥
 
ch™Ty≥
)

2714 i‡(
codögP¨amëîs
.
fú°Signifiˇn˚M≠C⁄ãxt
 =
signifiˇn˚M≠C⁄ãxtSëSèπ
[
ch™Ty≥
][
CONTEXT_TYPE_SINGLE
])

2717  
signifiˇn˚M≠C⁄ãxtSëSèπ
[
ch™Ty≥
][
CONTEXT_TYPE_SINGLE
];

2720 c⁄° 
UI¡
 
ø°îPosôi⁄
 = 
codögP¨amëîs
.
sˇn
[
sˇnPosôi⁄
];

2721 c⁄° 
UI¡
 
posY
 = 
ø°îPosôi⁄
 >> 
log2BlockWidth
;

2722 c⁄° 
UI¡
 
posX
 = 
ø°îPosôi⁄
 - (
posY
 << 
log2BlockWidth
);

2724 i‡((
posX
 + 
posY
) == 0)

2729 
I¡
 
off£t
 = 
MAX_INT
;

2731 i‡((
log2BlockWidth
 =2Ë&& (
log2BlockHeight
 == 2))

2733 
off£t
 = 
˘xIndM≠4x4
[ (4 * 
posY
Ë+ 
posX
 ];

2737 
I¡
 
˙t
 = 0;

2739 
∑âînSigCtx
)

2745 c⁄° 
I¡
 
posXöSub£t
 = 
posX
 & ((1 << 
MLS_CG_LOG2_WIDTH
) - 1);

2746 c⁄° 
I¡
 
posYöSub£t
 = 
posY
 & ((1 << 
MLS_CG_LOG2_HEIGHT
) - 1);

2747 c⁄° 
I¡
 
posTŸÆInSub£t
 = 
posXöSub£t
 + 
posYöSub£t
;

2750 c⁄° 
UI¡
 
c⁄ãxt1Thªshﬁd
 = 
NEIGHBOURHOOD_00_CONTEXT_1_THRESHOLD_4x4
;

2751 c⁄° 
UI¡
 
c⁄ãxt2Thªshﬁd
 = 
NEIGHBOURHOOD_00_CONTEXT_2_THRESHOLD_4x4
;

2753 
˙t
 = (
posTŸÆInSub£t
 >
c⁄ãxt1Thªshﬁd
Ë? 0 : (’osTŸÆInSub£à>
c⁄ãxt2Thªshﬁd
) ? 1 : 2);

2761 c⁄° 
I¡
 
posYöSub£t
 = 
posY
 & ((1 << 
MLS_CG_LOG2_HEIGHT
) - 1);

2762 c⁄° 
I¡
 
groupHeight
 = 1 << 
MLS_CG_LOG2_HEIGHT
;

2764 
˙t
 = (
posYöSub£t
 >(
groupHeight
 >> 1)) ? 0 : ((posYinSubset >= (groupHeight >> 2)) ? 1 : 2);

2772 c⁄° 
I¡
 
posXöSub£t
 = 
posX
 & ((1 << 
MLS_CG_LOG2_WIDTH
) - 1);

2773 c⁄° 
I¡
 
groupWidth
 = 1 << 
MLS_CG_LOG2_WIDTH
;

2775 
˙t
 = (
posXöSub£t
 >(
groupWidth
 >> 1)) ? 0 : ((posXinSubset >= (groupWidth >> 2)) ? 1 : 2);

2783 
˙t
 = 2;

2790 
°d
::
˚º
 << "ERROR: InvÆidÖ©ã∫SigCtx \"" << 
	`I¡
(
∑âînSigCtx
Ë<< "\" i¿gëSigCtxInc" << std::
ídl
;

2791 
	`exô
(1);

2797 c⁄° 
Boﬁ
 
nŸFú°Group
 = ((
posX
 >> 
MLS_CG_LOG2_WIDTH
Ë+ (
posY
 >> 
MLS_CG_LOG2_HEIGHT
)) > 0;

2799 
off£t
 = (
nŸFú°Group
 ? 
nŸFú°GroupNeighbourhoodC⁄ãxtOff£t
[
ch™Ty≥
] : 0Ë+ 
˙t
;

2802  
codögP¨amëîs
.
fú°Signifiˇn˚M≠C⁄ãxt
 + 
off£t
;

2803 
	}
}

2812 
__ölöe
 
UI¡
 
	gTComTrQu™t
::
	$xGëCodedLevñ
 ( 
DoubÀ
& 
rd64CodedCo°
,

2813 
DoubÀ
& 
rd64CodedCo°0
,

2814 
DoubÀ
& 
rd64CodedCo°Sig
,

2815 
I¡îmedüã_I¡
 
lLevñDoubÀ
,

2816 
UI¡
 
uiMaxAbsLevñ
,

2817 
USh‹t
 
ui16CtxNumSig
,

2818 
USh‹t
 
ui16CtxNumO√
,

2819 
USh‹t
 
ui16CtxNumAbs
,

2820 
USh‹t
 
ui16AbsGoRi˚
,

2821 
UI¡
 
c1Idx
,

2822 
UI¡
 
c2Idx
,

2823 
I¡
 
iQBôs
,

2824 
DoubÀ
 
îr‹SˇÀ
,

2825 
Boﬁ
 
bLa°
,

2826 
Boﬁ
 
u£LimôedPªfixLígth
,

2827 c⁄° 
I¡
 
maxLog2TrDy«micR™ge


2830 
DoubÀ
 
dCuºCo°Sig
 = 0;

2831 
UI¡
 
uiBe°AbsLevñ
 = 0;

2833 if–!
bLa°
 && 
uiMaxAbsLevñ
 < 3 )

2835 
rd64CodedCo°Sig
 = 
	`xGëR©eSigC€f
–0, 
ui16CtxNumSig
 );

2836 
rd64CodedCo°
 = 
rd64CodedCo°0
 + 
rd64CodedCo°Sig
;

2837 if–
uiMaxAbsLevñ
 == 0 )

2839  
uiBe°AbsLevñ
;

2844 
rd64CodedCo°
 = 
MAX_DOUBLE
;

2847 if–!
bLa°
 )

2849 
dCuºCo°Sig
 = 
	`xGëR©eSigC€f
–1, 
ui16CtxNumSig
 );

2852 
UI¡
 
uiMöAbsLevñ
 = ( 
uiMaxAbsLevñ
 > 1 ? uiMaxAbsLevel - 1 : 1 );

2853  
I¡
 
uiAbsLevñ
 = 
uiMaxAbsLevñ
; uiAbsLevñ >
uiMöAbsLevñ
 ; uiAbsLevel-- )

2855 
DoubÀ
 
dEº
 = 
	`DoubÀ
–
lLevñDoubÀ
 - ( 
	`I¡îmedüã_I¡
(
uiAbsLevñ
Ë<< 
iQBôs
 ) );

2856 
DoubÀ
 
dCuºCo°
 = 
dEº
 * dEº * 
îr‹SˇÀ
 + 
	`xGëICo°
–
	`xGëICR©e
–
uiAbsLevñ
, 
ui16CtxNumO√
, 
ui16CtxNumAbs
, 
ui16AbsGoRi˚
, 
c1Idx
, 
c2Idx
, 
u£LimôedPªfixLígth
, 
maxLog2TrDy«micR™ge
 ) );

2857 
dCuºCo°
 +
dCuºCo°Sig
;

2859 if–
dCuºCo°
 < 
rd64CodedCo°
 )

2861 
uiBe°AbsLevñ
 = 
uiAbsLevñ
;

2862 
rd64CodedCo°
 = 
dCuºCo°
;

2863 
rd64CodedCo°Sig
 = 
dCuºCo°Sig
;

2867  
uiBe°AbsLevñ
;

2868 
	}
}

2881 
__ölöe
 
I¡
 
	gTComTrQu™t
::
	$xGëICR©e
 ( c⁄° 
UI¡
 
uiAbsLevñ
,

2882 c⁄° 
USh‹t
 
ui16CtxNumO√
,

2883 c⁄° 
USh‹t
 
ui16CtxNumAbs
,

2884 c⁄° 
USh‹t
 
ui16AbsGoRi˚
,

2885 c⁄° 
UI¡
 
c1Idx
,

2886 c⁄° 
UI¡
 
c2Idx
,

2887 c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
,

2888 c⁄° 
I¡
 
maxLog2TrDy«micR™ge


2891 
I¡
 
iR©e
 = 
	`I¡
(
	`xGëIEPR©e
());

2892 
UI¡
 
ba£Levñ
 = (
c1Idx
 < 
C1FLAG_NUMBER
Ë? (2 + (
c2Idx
 < 
C2FLAG_NUMBER
)) : 1;

2894 i‡–
uiAbsLevñ
 >
ba£Levñ
 )

2896 
UI¡
 
symbﬁ
 = 
uiAbsLevñ
 - 
ba£Levñ
;

2897 
UI¡
 
Àngth
;

2898 i‡(
symbﬁ
 < (
COEF_REMAIN_BIN_REDUCTION
 << 
ui16AbsGoRi˚
))

2900 
Àngth
 = 
symbﬁ
>>
ui16AbsGoRi˚
;

2901 
iR©e
 +(
Àngth
+1+
ui16AbsGoRi˚
)<< 15;

2903 i‡(
u£LimôedPªfixLígth
)

2905 c⁄° 
UI¡
 
maximumPªfixLígth
 = (32 - (
COEF_REMAIN_BIN_REDUCTION
 + 
maxLog2TrDy«micR™ge
));

2907 
UI¡
 
¥efixLígth
 = 0;

2908 
UI¡
 
suffix
 = (
symbﬁ
 >> 
ui16AbsGoRi˚
Ë- 
COEF_REMAIN_BIN_REDUCTION
;

2910 (
¥efixLígth
 < 
maximumPªfixLígth
Ë&& (
suffix
 > ((2 <<ÖrefixLength) - 2)))

2912 
¥efixLígth
++;

2915 c⁄° 
UI¡
 
suffixLígth
 = (
¥efixLígth
 =
maximumPªfixLígth
Ë? (
maxLog2TrDy«micR™ge
 - 
ui16AbsGoRi˚
) : (prefixLength + 1 );

2917 
iR©e
 +(
COEF_REMAIN_BIN_REDUCTION
 + 
¥efixLígth
 + 
suffixLígth
 + 
ui16AbsGoRi˚
) << 15;

2921 
Àngth
 = 
ui16AbsGoRi˚
;

2922 
symbﬁ
 = symbﬁ - ( 
COEF_REMAIN_BIN_REDUCTION
 << 
ui16AbsGoRi˚
);

2923 
symbﬁ
 >(1<<
Àngth
))

2925 
symbﬁ
 -(1<<(
Àngth
++));

2927 
iR©e
 +(
COEF_REMAIN_BIN_REDUCTION
+
Àngth
+1-
ui16AbsGoRi˚
+length)<< 15;

2930 i‡(
c1Idx
 < 
C1FLAG_NUMBER
)

2932 
iR©e
 +
m_pcE°BôsSbac
->
m_gª©îO√Bôs
[ 
ui16CtxNumO√
 ][ 1 ];

2934 i‡(
c2Idx
 < 
C2FLAG_NUMBER
)

2936 
iR©e
 +
m_pcE°BôsSbac
->
m_ÀvñAbsBôs
[ 
ui16CtxNumAbs
 ][ 1 ];

2940 if–
uiAbsLevñ
 == 1 )

2942 
iR©e
 +
m_pcE°BôsSbac
->
m_gª©îO√Bôs
[ 
ui16CtxNumO√
 ][ 0 ];

2944 if–
uiAbsLevñ
 == 2 )

2946 
iR©e
 +
m_pcE°BôsSbac
->
m_gª©îO√Bôs
[ 
ui16CtxNumO√
 ][ 1 ];

2947 
iR©e
 +
m_pcE°BôsSbac
->
m_ÀvñAbsBôs
[ 
ui16CtxNumAbs
 ][ 0 ];

2951 
iR©e
 = 0;

2954  
iR©e
;

2955 
	}
}

2957 
__ölöe
 
DoubÀ
 
	gTComTrQu™t
::
	$xGëR©eSigC€ffGroup
 ( 
USh‹t
 
uiSignifiˇn˚C€ffGroup
,

2958 
USh‹t
 
ui16CtxNumSig
 ) const

2960  
	`xGëICo°
–
m_pcE°BôsSbac
->
signifiˇ¡C€ffGroupBôs
[ 
ui16CtxNumSig
 ][ 
uiSignifiˇn˚C€ffGroup
 ] );

2961 
	}
}

2972 
__ölöe
 
DoubÀ
 
	gTComTrQu™t
::
	$xGëR©eLa°
 ( c⁄° 
UI¡
 
uiPosX
,

2973 c⁄° 
UI¡
 
uiPosY
,

2974 c⁄° 
Comp⁄ítID
 
comp⁄ít
 ) const

2976 
UI¡
 
uiCtxX
 = 
g_uiGroupIdx
[
uiPosX
];

2977 
UI¡
 
uiCtxY
 = 
g_uiGroupIdx
[
uiPosY
];

2979 
DoubÀ
 
uiCo°
 = 
m_pcE°BôsSbac
->
œ°XBôs
[
	`toCh™√lTy≥
(
comp⁄ít
)][ 
uiCtxX
 ] + m_pcE°BôsSbac->
œ°YBôs
[toCh™√lTy≥(comp⁄ít)][ 
uiCtxY
 ];

2981 if–
uiCtxX
 > 3 )

2983 
uiCo°
 +
	`xGëIEPR©e
(Ë* ((
uiCtxX
-2)>>1);

2985 if–
uiCtxY
 > 3 )

2987 
uiCo°
 +
	`xGëIEPR©e
(Ë* ((
uiCtxY
-2)>>1);

2989  
	`xGëICo°
–
uiCo°
 );

2990 
	}
}

2992 
__ölöe
 
DoubÀ
 
	gTComTrQu™t
::
	$xGëR©eSigC€f
 ( 
USh‹t
 
uiSignifiˇn˚
,

2993 
USh‹t
 
ui16CtxNumSig
 ) const

2995  
	`xGëICo°
–
m_pcE°BôsSbac
->
signifiˇ¡Bôs
[ 
ui16CtxNumSig
 ][ 
uiSignifiˇn˚
 ] );

2996 
	}
}

3002 
__ölöe
 
DoubÀ
 
	gTComTrQu™t
::
	$xGëICo°
 ( 
DoubÀ
 
dR©e
 ) const

3004  
m_dLambda
 * 
dR©e
;

3005 
	}
}

3010 
__ölöe
 
DoubÀ
 
	gTComTrQu™t
::
	$xGëIEPR©e
 ( ) const

3013 
	}
}

3023 
UI¡
 
	gTComTrQu™t
::
	$gëSigC€ffGroupCtxInc
 (c⁄° 
UI¡
* 
uiSigC€ffGroupFœg
,

3024 c⁄° 
UI¡
 
uiCGPosX
,

3025 c⁄° 
UI¡
 
uiCGPosY
,

3026 c⁄° 
UI¡
 
widthInGroups
,

3027 c⁄° 
UI¡
 
heightInGroups
)

3029 
UI¡
 
sigRight
 = 0;

3030 
UI¡
 
sigLowî
 = 0;

3032 i‡(
uiCGPosX
 < (
widthInGroups
 - 1))

3034 
sigRight
 = ((
uiSigC€ffGroupFœg
[ (
uiCGPosY
 * 
widthInGroups
Ë+ 
uiCGPosX
 + 1 ] != 0) ? 1 : 0);

3036 i‡(
uiCGPosY
 < (
heightInGroups
 - 1))

3038 
sigLowî
 = ((
uiSigC€ffGroupFœg
[ (
uiCGPosY
 + 1Ë* 
widthInGroups
 + 
uiCGPosX
 ] != 0) ? 1 : 0);

3041  ((
sigRight
 + 
sigLowî
) != 0) ? 1 : 0;

3042 
	}
}

3051 
Void
 
	gTComTrQu™t
::
	$£tSˇlögLi°
(
TComSˇlögLi°
 *
sˇlögLi°
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
], c⁄° 
BôDïths
 &
bôDïths
)

3053 c⁄° 
I¡
 
möimumQp
 = 0;

3054 c⁄° 
I¡
 
maximumQp
 = 
SCALING_LIST_REM_NUM
;

3056 
UI¡
 
size
 = 0; sizê< 
SCALING_LIST_SIZE_NUM
; size++)

3058 
UI¡
 
li°
 = 0;Üi° < 
SCALING_LIST_NUM
;Üist++)

3060 
I¡
 
qp
 = 
möimumQp
; q∞< 
maximumQp
; qp++)

3062 
	`xSëSˇlögLi°Enc
(
sˇlögLi°
,
li°
,
size
,
qp
);

3063 
	`xSëSˇlögLi°Dec
(*
sˇlögLi°
,
li°
,
size
,
qp
);

3064 
	`£tEºSˇÀC€ff
(
li°
,
size
,
qp
,
maxLog2TrDy«micR™ge
, 
bôDïths
);

3068 
	}
}

3073 
Void
 
	gTComTrQu™t
::
	$£tSˇlögLi°Dec
(c⁄° 
TComSˇlögLi°
 &
sˇlögLi°
)

3075 c⁄° 
I¡
 
möimumQp
 = 0;

3076 c⁄° 
I¡
 
maximumQp
 = 
SCALING_LIST_REM_NUM
;

3078 
UI¡
 
size
 = 0; sizê< 
SCALING_LIST_SIZE_NUM
; size++)

3080 
UI¡
 
li°
 = 0;Üi° < 
SCALING_LIST_NUM
;Üist++)

3082 
I¡
 
qp
 = 
möimumQp
; q∞< 
maximumQp
; qp++)

3084 
	`xSëSˇlögLi°Dec
(
sˇlögLi°
,
li°
,
size
,
qp
);

3088 
	}
}

3096 
Void
 
	gTComTrQu™t
::
	$£tEºSˇÀC€ff
(
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
, c⁄° I¡ 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
], c⁄° 
BôDïths
 &
bôDïths
)

3098 c⁄° 
UI¡
 
uiLog2TrSize
 = 
g_aucC⁄vîtToBô
[ 
g_sˇlögLi°SizeX
[
size
] ] + 2;

3099 c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
 = ((
li°
 =0Ë|| (li° =
MAX_NUM_COMPONENT
)Ë? 
CHANNEL_TYPE_LUMA
 : 
CHANNEL_TYPE_CHROMA
;

3101 c⁄° 
I¡
 
ch™√lBôDïth
 = 
bôDïths
.
ªc⁄
[
ch™√lTy≥
];

3102 c⁄° 
I¡
 
iTønsf‹mShi·
 = 
	`gëTønsf‹mShi·
(
ch™√lBôDïth
, 
uiLog2TrSize
, 
maxLog2TrDy«micR™ge
[
ch™√lTy≥
]);

3104 
UI¡
 
i
,
uiMaxNumC€ff
 = 
g_sˇlögLi°Size
[
size
];

3105 
I¡
 *
piQu™tc€ff
;

3106 
DoubÀ
 *
pdEºSˇÀ
;

3107 
piQu™tc€ff
 = 
	`gëQu™tC€ff
(
li°
, 
qp
,
size
);

3108 
pdEºSˇÀ
 = 
	`gëEºSˇÀC€ff
(
li°
, 
size
, 
qp
);

3110 
DoubÀ
 
dEºSˇÀ
 = (DoubÀ)(1<<
SCALE_BITS
);

3111 
dEºSˇÀ
 = dEºSˇÀ*
	`pow
(2.0,(-2.0*
iTønsf‹mShi·
));

3113 
i
=0;i<
uiMaxNumC€ff
;i++)

3115 
pdEºSˇÀ
[
i
] = 
dEºSˇÀ
 / 
piQu™tc€ff
[i] /ÖiQu™tc€ff[i] / (1 << 
	`DISTORTION_PRECISION_ADJUSTMENT
(2 * (
bôDïths
.
ªc⁄
[
ch™√lTy≥
] - 8)));

3118 
	`gëEºSˇÀC€ffNoSˇlögLi°
(
li°
, 
size
, 
qp
Ë
dEºSˇÀ
 / 
g_qu™tSˇÀs
[qp] / g_qu™tSˇÀs[qp] / (1 << 
	`DISTORTION_PRECISION_ADJUSTMENT
(2 * (
bôDïths
.
ªc⁄
[
ch™√lTy≥
] - 8)));

3119 
	}
}

3128 
Void
 
	gTComTrQu™t
::
	$xSëSˇlögLi°Enc
(
TComSˇlögLi°
 *
sˇlögLi°
, 
UI¡
 
li°Id
, UI¡ 
sizeId
, 
I¡
 
qp
)

3130 
UI¡
 
width
 = 
g_sˇlögLi°SizeX
[
sizeId
];

3131 
UI¡
 
height
 = 
g_sˇlögLi°SizeX
[
sizeId
];

3132 
UI¡
 
øtio
 = 
g_sˇlögLi°SizeX
[
sizeId
]/
	`mö
(
MAX_MATRIX_SIZE_NUM
,(
I¡
)g_scalingListSizeX[sizeId]);

3133 
I¡
 *
qu™tc€ff
;

3134 
I¡
 *
c€ff
 = 
sˇlögLi°
->
	`gëSˇlögLi°Addªss
(
sizeId
,
li°Id
);

3135 
qu™tc€ff
 = 
	`gëQu™tC€ff
(
li°Id
, 
qp
, 
sizeId
);

3137 
I¡
 
qu™tSˇÀs
 = 
g_qu™tSˇÀs
[
qp
];

3139 
	`¥o˚ssSˇlögLi°Enc
(
c€ff
,

3140 
qu™tc€ff
,

3141 (
qu™tSˇÀs
 << 
LOG2_SCALING_LIST_NEUTRAL_VALUE
),

3142 
height
, 
width
, 
øtio
,

3143 
	`mö
(
MAX_MATRIX_SIZE_NUM
, (
I¡
)
g_sˇlögLi°SizeX
[
sizeId
]),

3144 
sˇlögLi°
->
	`gëSˇlögLi°DC
(
sizeId
,
li°Id
));

3145 
	}
}

3154 
Void
 
	gTComTrQu™t
::
	$xSëSˇlögLi°Dec
(c⁄° 
TComSˇlögLi°
 &
sˇlögLi°
, 
UI¡
 
li°Id
, UI¡ 
sizeId
, 
I¡
 
qp
)

3156 
UI¡
 
width
 = 
g_sˇlögLi°SizeX
[
sizeId
];

3157 
UI¡
 
height
 = 
g_sˇlögLi°SizeX
[
sizeId
];

3158 
UI¡
 
øtio
 = 
g_sˇlögLi°SizeX
[
sizeId
]/
	`mö
(
MAX_MATRIX_SIZE_NUM
,(
I¡
)g_scalingListSizeX[sizeId]);

3159 
I¡
 *
dequ™tc€ff
;

3160 c⁄° 
I¡
 *
c€ff
 = 
sˇlögLi°
.
	`gëSˇlögLi°Addªss
(
sizeId
,
li°Id
);

3162 
dequ™tc€ff
 = 
	`gëDequ™tC€ff
(
li°Id
, 
qp
, 
sizeId
);

3164 
I¡
 
övQu™tSˇÀ
 = 
g_övQu™tSˇÀs
[
qp
];

3166 
	`¥o˚ssSˇlögLi°Dec
(
c€ff
,

3167 
dequ™tc€ff
,

3168 
övQu™tSˇÀ
,

3169 
height
, 
width
, 
øtio
,

3170 
	`mö
(
MAX_MATRIX_SIZE_NUM
, (
I¡
)
g_sˇlögLi°SizeX
[
sizeId
]),

3171 
sˇlögLi°
.
	`gëSˇlögLi°DC
(
sizeId
,
li°Id
));

3172 
	}
}

3176 
Void
 
	gTComTrQu™t
::
	$£tFœtSˇlögLi°
(c⁄° 
I¡
 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
], c⁄° 
BôDïths
 &
bôDïths
)

3178 c⁄° 
I¡
 
möimumQp
 = 0;

3179 c⁄° 
I¡
 
maximumQp
 = 
SCALING_LIST_REM_NUM
;

3181 
UI¡
 
size
 = 0; sizê< 
SCALING_LIST_SIZE_NUM
; size++)

3183 
UI¡
 
li°
 = 0;Üi° < 
SCALING_LIST_NUM
;Üist++)

3185 
I¡
 
qp
 = 
möimumQp
; q∞< 
maximumQp
; qp++)

3187 
	`x£tFœtSˇlögLi°
(
li°
,
size
,
qp
);

3188 
	`£tEºSˇÀC€ff
(
li°
,
size
,
qp
,
maxLog2TrDy«micR™ge
, 
bôDïths
);

3192 
	}
}

3200 
Void
 
	gTComTrQu™t
::
	$x£tFœtSˇlögLi°
(
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
)

3202 
UI¡
 
i
,
num
 = 
g_sˇlögLi°Size
[
size
];

3203 
I¡
 *
qu™tc€ff
;

3204 
I¡
 *
dequ™tc€ff
;

3206 
I¡
 
qu™tSˇÀs
 = 
g_qu™tSˇÀs
 [
qp
];

3207 
I¡
 
övQu™tSˇÀs
 = 
g_övQu™tSˇÀs
[
qp
] << 4;

3209 
qu™tc€ff
 = 
	`gëQu™tC€ff
(
li°
, 
qp
, 
size
);

3210 
dequ™tc€ff
 = 
	`gëDequ™tC€ff
(
li°
, 
qp
, 
size
);

3212 
i
=0;i<
num
;i++)

3214 *
qu™tc€ff
++ = 
qu™tSˇÀs
;

3215 *
dequ™tc€ff
++ = 
övQu™tSˇÀs
;

3217 
	}
}

3229 
Void
 
	gTComTrQu™t
::
	$¥o˚ssSˇlögLi°Enc
–
I¡
 *
c€ff
, I¡ *
qu™tc€ff
, I¡ 
qu™tSˇÀs
, 
UI¡
 
height
, UI¡ 
width
, UI¡ 
øtio
, I¡ 
sizuNum
, UI¡ 
dc
)

3231 
UI¡
 
j
=0;j<
height
;j++)

3233 
UI¡
 
i
=0;i<
width
;i++)

3235 
qu™tc€ff
[
j
*
width
 + 
i
] = 
qu™tSˇÀs
 / 
c€ff
[
sizuNum
 * (j / 
øtio
) + i /Ñatio];

3239 if(
øtio
 > 1)

3241 
qu™tc€ff
[0] = 
qu™tSˇÀs
 / 
dc
;

3243 
	}
}

3255 
Void
 
	gTComTrQu™t
::
	$¥o˚ssSˇlögLi°Dec
–c⁄° 
I¡
 *
c€ff
, I¡ *
dequ™tc€ff
, I¡ 
övQu™tSˇÀs
, 
UI¡
 
height
, UI¡ 
width
, UI¡ 
øtio
, I¡ 
sizuNum
, UI¡ 
dc
)

3257 
UI¡
 
j
=0;j<
height
;j++)

3259 
UI¡
 
i
=0;i<
width
;i++)

3261 
dequ™tc€ff
[
j
*
width
 + 
i
] = 
övQu™tSˇÀs
 * 
c€ff
[
sizuNum
 * (j / 
øtio
) + i /Ñatio];

3265 if(
øtio
 > 1)

3267 
dequ™tc€ff
[0] = 
övQu™tSˇÀs
 * 
dc
;

3269 
	}
}

3273 
Void
 
	gTComTrQu™t
::
	$öôSˇlögLi°
()

3275 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

3277 
UI¡
 
qp
 = 0; q∞< 
SCALING_LIST_REM_NUM
; qp++)

3279 
UI¡
 
li°Id
 = 0;Üi°Id < 
SCALING_LIST_NUM
;ÜistId++)

3281 
m_qu™tC€f
 [
sizeId
][
li°Id
][
qp
] = 
√w
 
I¡
 [
g_sˇlögLi°Size
[sizeId]];

3282 
m_dequ™tC€f
 [
sizeId
][
li°Id
][
qp
] = 
√w
 
I¡
 [
g_sˇlögLi°Size
[sizeId]];

3283 
m_îrSˇÀ
 [
sizeId
][
li°Id
][
qp
] = 
√w
 
DoubÀ
 [
g_sˇlögLi°Size
[sizeId]];

3287 
	}
}

3291 
Void
 
	gTComTrQu™t
::
	$de°roySˇlögLi°
()

3293 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

3295 
UI¡
 
li°Id
 = 0;Üi°Id < 
SCALING_LIST_NUM
;ÜistId++)

3297 
UI¡
 
qp
 = 0; q∞< 
SCALING_LIST_REM_NUM
; qp++)

3299 if(
m_qu™tC€f
[
sizeId
][
li°Id
][
qp
])

3301 
dñëe
 [] 
m_qu™tC€f
[
sizeId
][
li°Id
][
qp
];

3303 if(
m_dequ™tC€f
[
sizeId
][
li°Id
][
qp
])

3305 
dñëe
 [] 
m_dequ™tC€f
[
sizeId
][
li°Id
][
qp
];

3307 if(
m_îrSˇÀ
[
sizeId
][
li°Id
][
qp
])

3309 
dñëe
 [] 
m_îrSˇÀ
[
sizeId
][
li°Id
][
qp
];

3314 
	}
}

3316 
Void
 
	gTComTrQu™t
::
	$å™sf‹mSkùQu™tO√Sam∂e
(
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
TC€ff
 
ªsiDiff
, TC€ff* 
pcC€ff
, c⁄° 
UI¡
 
uiPos
, c⁄° 
QpP¨am
 &
cQP
, c⁄° 
Boﬁ
 
bU£HÆfRoundögPoöt
)

3318 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

3319 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

3320 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
compID
);

3321 c⁄° 
UI¡
 
uiWidth
 = 
ª˘
.
width
;

3322 c⁄° 
UI¡
 
uiHeight
 = 
ª˘
.
height
;

3323 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
	`toCh™√lTy≥
(
compID
));

3324 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

3325 c⁄° 
I¡
 
iTønsf‹mShi·
 = 
	`gëTønsf‹mShi·
(
ch™√lBôDïth
, 
rTu
.
	`GëEquivÆítLog2TrSize
(
compID
), 
maxLog2TrDy«micR™ge
);

3326 c⁄° 
I¡
 
sˇlögLi°Ty≥
 = 
	`gëSˇlögLi°Ty≥
(
pcCU
->
	`gëPªdi˘i⁄Mode
(
uiAbsP¨tIdx
), 
compID
);

3327 c⁄° 
Boﬁ
 
íabÀSˇlögLi°s
 = 
	`gëU£SˇlögLi°
(
uiWidth
, 
uiHeight
, 
åue
);

3328 c⁄° 
I¡
 
deÁu…Qu™tißti⁄C€fficõ¡
 = 
g_qu™tSˇÀs
[
cQP
.
ªm
];

3330 
	`as£π
–
sˇlögLi°Ty≥
 < 
SCALING_LIST_NUM
 );

3331 c⁄° 
I¡
 *c⁄° 
piQu™tC€ff
 = 
	`gëQu™tC€ff
–
sˇlögLi°Ty≥
, 
cQP
.
ªm
, (
rTu
.
	`GëEquivÆítLog2TrSize
(
compID
)-2) );

3340 c⁄° 
I¡
 
iQBôs
 = 
QUANT_SHIFT
 + 
cQP
.
≥r
 + 
iTønsf‹mShi·
;

3343 c⁄° 
I¡
 
iAdd
 = ( 
bU£HÆfRoundögPoöt
 ? 256 : (
pcCU
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë=
I_SLICE
 ? 171 : 85ËË<< (
iQBôs
 - 9);

3345 
TC€ff
 
å™sf‹medC€fficõ¡
;

3348 i‡(
iTønsf‹mShi·
 >= 0)

3350 
å™sf‹medC€fficõ¡
 = 
ªsiDiff
 << 
iTønsf‹mShi·
;

3354 c⁄° 
I¡
 
iTrShi·Neg
 = -
iTønsf‹mShi·
;

3355 c⁄° 
I¡
 
off£t
 = 1 << (
iTrShi·Neg
 - 1);

3356 
å™sf‹medC€fficõ¡
 = ( 
ªsiDiff
 + 
off£t
 ) >> 
iTrShi·Neg
;

3360 c⁄° 
TC€ff
 
iSign
 = (
å™sf‹medC€fficõ¡
 < 0 ? -1: 1);

3362 c⁄° 
I¡
 
qu™tißti⁄C€fficõ¡
 = 
íabÀSˇlögLi°s
 ? 
piQu™tC€ff
[
uiPos
] : 
deÁu…Qu™tißti⁄C€fficõ¡
;

3364 c⁄° 
I¡64
 
tmpLevñ
 = (I¡64)
	`abs
(
å™sf‹medC€fficõ¡
Ë* 
qu™tißti⁄C€fficõ¡
;

3366 c⁄° 
TC€ff
 
qu™ti£dC€fficõ¡
 = (
	`TC€ff
((
tmpLevñ
 + 
iAdd
 ) >> 
iQBôs
)Ë* 
iSign
;

3368 c⁄° 
TC€ff
 
íå›yCodögMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

3369 c⁄° 
TC€ff
 
íå›yCodögMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

3370 
pcC€ff
[ 
uiPos
 ] = 
Clù3
<
TC€ff
>–
íå›yCodögMöimum
, 
íå›yCodögMaximum
, 
qu™ti£dC€fficõ¡
 );

3371 
	}
}

3374 
Void
 
	gTComTrQu™t
::
	$övTrSkùDeQu™tO√Sam∂e
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
, 
TC€ff
 
öSam∂e
, 
Pñ
 &
ªc⁄Sam∂e
, c⁄° 
QpP¨am
 &
cQP
, 
UI¡
 
uiPos
 )

3376 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

3377 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

3378 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
compID
);

3379 c⁄° 
UI¡
 
uiWidth
 = 
ª˘
.
width
;

3380 c⁄° 
UI¡
 
uiHeight
 = 
ª˘
.
height
;

3381 c⁄° 
I¡
 
QP_≥r
 = 
cQP
.
≥r
;

3382 c⁄° 
I¡
 
QP_ªm
 = 
cQP
.
ªm
;

3383 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
	`toCh™√lTy≥
(
compID
));

3384 #i‡
O0043_BEST_EFFORT_DECODING


3385 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSåómBôDïth
(
	`toCh™√lTy≥
(
compID
));

3387 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

3389 c⁄° 
I¡
 
iTønsf‹mShi·
 = 
	`gëTønsf‹mShi·
(
ch™√lBôDïth
, 
rTu
.
	`GëEquivÆítLog2TrSize
(
compID
), 
maxLog2TrDy«micR™ge
);

3390 c⁄° 
I¡
 
sˇlögLi°Ty≥
 = 
	`gëSˇlögLi°Ty≥
(
pcCU
->
	`gëPªdi˘i⁄Mode
(
uiAbsP¨tIdx
), 
compID
);

3391 c⁄° 
Boﬁ
 
íabÀSˇlögLi°s
 = 
	`gëU£SˇlögLi°
(
uiWidth
, 
uiHeight
, 
åue
);

3392 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëEquivÆítLog2TrSize
(
compID
);

3394 
	`as£π
–
sˇlögLi°Ty≥
 < 
SCALING_LIST_NUM
 );

3396 c⁄° 
I¡
 
rightShi·
 = (
IQUANT_SHIFT
 - (
iTønsf‹mShi·
 + 
QP_≥r
)Ë+ (
íabÀSˇlögLi°s
 ? 
LOG2_SCALING_LIST_NEUTRAL_VALUE
 : 0);

3398 c⁄° 
TC€ff
 
å™sf‹mMöimum
 = -(1 << 
maxLog2TrDy«micR™ge
);

3399 c⁄° 
TC€ff
 
å™sf‹mMaximum
 = (1 << 
maxLog2TrDy«micR™ge
) - 1;

3403 
TC€ff
 
dequ™ti£dSam∂e
;

3405 if(
íabÀSˇlögLi°s
)

3407 c⁄° 
UI¡
 
dequ™tC€fBôs
 = 1 + 
IQUANT_SHIFT
 + 
SCALING_LIST_BITS
;

3408 c⁄° 
UI¡
 
èrgëI≈utBôDïth
 = 
°d
::
mö
<UI¡>((
maxLog2TrDy«micR™ge
 + 1), ((((
I¡îmedüã_I¡
Ë* 8Ë+ 
rightShi·
Ë- 
dequ™tC€fBôs
));

3410 c⁄° 
I¡îmedüã_I¡
 
öputMöimum
 = -(1 << (
èrgëI≈utBôDïth
 - 1));

3411 c⁄° 
I¡îmedüã_I¡
 
öputMaximum
 = (1 << (
èrgëI≈utBôDïth
 - 1)) - 1;

3413 
I¡
 *
piDequ™tC€f
 = 
	`gëDequ™tC€ff
(
sˇlögLi°Ty≥
,
QP_ªm
,
uiLog2TrSize
-2);

3415 if(
rightShi·
 > 0)

3417 c⁄° 
I¡îmedüã_I¡
 
iAdd
 = 1 << (
rightShi·
 - 1);

3418 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
öSam∂e
));

3419 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = ((
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
piDequ™tC€f
[
uiPos
]Ë+ 
iAdd
 ) >> 
rightShi·
;

3421 
dequ™ti£dSam∂e
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

3425 c⁄° 
I¡
 
À·Shi·
 = -
rightShi·
;

3426 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
öSam∂e
));

3427 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = (
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
piDequ™tC€f
[
uiPos
]Ë<< 
À·Shi·
;

3429 
dequ™ti£dSam∂e
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

3434 c⁄° 
I¡
 
sˇÀ
 = 
g_övQu™tSˇÀs
[
QP_ªm
];

3435 c⁄° 
I¡
 
sˇÀBôs
 = (
IQUANT_SHIFT
 + 1) ;

3437 c⁄° 
UI¡
 
èrgëI≈utBôDïth
 = 
°d
::
mö
<UI¡>((
maxLog2TrDy«micR™ge
 + 1), ((((
I¡îmedüã_I¡
Ë* 8Ë+ 
rightShi·
Ë- 
sˇÀBôs
));

3438 c⁄° 
I¡îmedüã_I¡
 
öputMöimum
 = -(1 << (
èrgëI≈utBôDïth
 - 1));

3439 c⁄° 
I¡îmedüã_I¡
 
öputMaximum
 = (1 << (
èrgëI≈utBôDïth
 - 1)) - 1;

3441 i‡(
rightShi·
 > 0)

3443 c⁄° 
I¡îmedüã_I¡
 
iAdd
 = 1 << (
rightShi·
 - 1);

3444 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
öSam∂e
));

3445 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = (
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
sˇÀ
 + 
iAdd
Ë>> 
rightShi·
;

3447 
dequ™ti£dSam∂e
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

3451 c⁄° 
I¡
 
À·Shi·
 = -
rightShi·
;

3452 c⁄° 
TC€ff
 
˛ùQC€f
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
öputMöimum
, 
öputMaximum
, 
öSam∂e
));

3453 c⁄° 
I¡îmedüã_I¡
 
iC€ffQ
 = (
	`I¡îmedüã_I¡
(
˛ùQC€f
Ë* 
sˇÀ
Ë<< 
À·Shi·
;

3455 
dequ™ti£dSam∂e
 = 
	`TC€ff
(
Clù3
<
I¡îmedüã_I¡
>(
å™sf‹mMöimum
,
å™sf‹mMaximum
,
iC€ffQ
));

3461 i‡(
iTønsf‹mShi·
 >= 0)

3463 c⁄° 
TC€ff
 
off£t
 = 
iTønsf‹mShi·
==0 ? 0 : (1 << (iTransformShift - 1));

3464 
ªc⁄Sam∂e
 = 
	`Pñ
(–
dequ™ti£dSam∂e
 + 
off£t
 ) >> 
iTønsf‹mShi·
);

3468 c⁄° 
I¡
 
iTrShi·Neg
 = -
iTønsf‹mShi·
;

3469 
ªc⁄Sam∂e
 = 
	`Pñ
(
dequ™ti£dSam∂e
 << 
iTrShi·Neg
);

3471 
	}
}

3474 
Void
 
	gTComTrQu™t
::
	$¸ossComp⁄ítPªdi˘i⁄
–
TComTU
 & 
rTu
,

3475 c⁄° 
Comp⁄ítID
 
compID
,

3476 c⁄° 
Pñ
 * 
piResiL
,

3477 c⁄° 
Pñ
 * 
piResiC
,

3478 
Pñ
 * 
piResiT
,

3479 c⁄° 
I¡
 
width
,

3480 c⁄° 
I¡
 
height
,

3481 c⁄° 
I¡
 
°rideL
,

3482 c⁄° 
I¡
 
°rideC
,

3483 c⁄° 
I¡
 
°rideT
,

3484 c⁄° 
Boﬁ
 
ªvî£
 )

3486 c⁄° 
Pñ
 *
pResiL
 = 
piResiL
;

3487 c⁄° 
Pñ
 *
pResiC
 = 
piResiC
;

3488 
Pñ
 *
pResiT
 = 
piResiT
;

3490 
TComD©aCU
 *
pCU
 = 
rTu
.
	`gëCU
();

3491 c⁄° 
I¡
 
Æpha
 = 
pCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
–
rTu
.
	`GëAbsP¨tIdxTU
–
compID
 ), compID );

3492 c⁄° 
I¡
 
diffBôDïth
 = 
pCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëDif„ª¡ülLumaChromaBôDïth
();

3494  
I¡
 
y
 = 0; y < 
height
; y++ )

3496 i‡(
ªvî£
)

3503 #i‡
RExt__HIGH_BIT_DEPTH_SUPPORT


3504  
I¡
 
x
 = 0; x < 
width
; x++ )

3506 
pResiT
[
x
] = 
pResiC
[x] + (–
Æpha
 * 
	`rightShi·
–
pResiL
[x], 
diffBôDïth
) ) >> 3);

3509 c⁄° 
I¡
 
möPñ
=
°d
::
numîic_limôs
<
Pñ
>::
	`mö
();

3510 c⁄° 
I¡
 
maxPñ
=
°d
::
numîic_limôs
<
Pñ
>::
	`max
();

3511  
I¡
 
x
 = 0; x < 
width
; x++ )

3513 
pResiT
[
x
] = 
Clù3
<
I¡
>(
möPñ
, 
maxPñ
, 
pResiC
[x] + (–
Æpha
 * 
rightShi·
<I¡>(
	`I¡
(
pResiL
[x]), 
diffBôDïth
) ) >> 3));

3520  
I¡
 
x
 = 0; x < 
width
; x++ )

3522 
pResiT
[
x
] = 
pResiC
[x] - (–
Æpha
 * 
rightShi·
<
I¡
>(
	`I¡
(
pResiL
[x]), 
diffBôDïth
) ) >> 3);

3526 
pResiL
 +
°rideL
;

3527 
pResiC
 +
°rideC
;

3528 
pResiT
 +
°rideT
;

3530 
	}
}

	@TLibCommon/TComTrQuant.h

38 #i‚de‡
__TCOMTRQUANT__


39 
	#__TCOMTRQUANT__


	)

41 
	~"Comm⁄Def.h
"

42 
	~"TComYuv.h
"

43 
	~"TComD©aCU.h
"

44 
	~"TComChromaF‹m©.h
"

45 
	~"C⁄ãxtTabÀs.h
"

54 
	#QP_BITS
 15

	)

62 
I¡
 
	msignifiˇ¡C€ffGroupBôs
[
NUM_SIG_CG_FLAG_CTX
][2 ];

63 
I¡
 
	msignifiˇ¡Bôs
[
NUM_SIG_FLAG_CTX
][2 ];

64 
I¡
 
	mœ°XBôs
[
MAX_NUM_CHANNEL_TYPE
][
LAST_SIGNIFICANT_GROUPS
];

65 
I¡
 
	mœ°YBôs
[
MAX_NUM_CHANNEL_TYPE
][
LAST_SIGNIFICANT_GROUPS
];

66 
I¡
 
	mm_gª©îO√Bôs
[
NUM_ONE_FLAG_CTX
][2 ];

67 
I¡
 
	mm_ÀvñAbsBôs
[
NUM_ABS_FLAG_CTX
][2 ];

69 
I¡
 
	mblockCbpBôs
[
NUM_QT_CBF_CTX_SETS
 * 
NUM_QT_CBF_CTX_PER_SET
][2 ];

70 
I¡
 
	mblockRoŸCbpBôs
[4][2 ];

72 
I¡
 
	mgﬁombRi˚Ad≠èti⁄Sèti°ics
[
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
];

73 } 
	te°BôsSbacSåu˘
;

80 
	sQpP¨am


82 
I¡
 
	mQp
;

83 
I¡
 
	m≥r
;

84 
I¡
 
	mªm
;

86 
QpP¨am
(c⁄° 
I¡
 
qpy
,

87 c⁄° 
Ch™√lTy≥
 
chTy≥
,

88 c⁄° 
I¡
 
qpBdOff£t
,

89 c⁄° 
I¡
 
chromaQPOff£t
,

90 c⁄° 
ChromaF‹m©
 
chFmt
 );

92 
QpP¨am
(c⁄° 
TComD©aCU
 &
cu
, c⁄° 
Comp⁄ítID
 
compID
);

98 ˛as†
	cTComTrQu™t


100 
	mpublic
:

101 
TComTrQu™t
();

102 ~
TComTrQu™t
();

105 
Void
 
öô
 ( 
UI¡
 
uiMaxTrSize
,

106 
Boﬁ
 
u£RDOQ
 = 
Ál£
,

107 
Boﬁ
 
u£RDOQTS
 = 
Ál£
,

108 
Boﬁ
 
u£Sñe˘iveRDOQ
 = 
Ál£
,

109 
Boﬁ
 
bEnc
 = 
Ál£
,

110 
Boﬁ
 
u£Tønsf‹mSkùFa°
 = 
Ál£


111 #i‡
ADAPTIVE_QP_SELECTION


112 , 
Boﬁ
 
bU£Ad≠tQpSñe˘
 = 
Ál£


117 
Void
 
å™sf‹mNxN
–
TComTU
 & 
rTu
,

118 c⁄° 
Comp⁄ítID
 
compID
,

119 
Pñ
 * 
pcResiduÆ
,

120 c⁄° 
UI¡
 
uiSåide
,

121 
TC€ff
 * 
ΩcC€ff
,

122 #i‡
ADAPTIVE_QP_SELECTION


123 
TC€ff
 * 
ΩcAæC€ff
,

125 
TC€ff
 & 
uiAbsSum
,

126 c⁄° 
QpP¨am
 & 
cQP


130 
Void
 
övTønsf‹mNxN
–
TComTU
 & 
rTu
,

131 c⁄° 
Comp⁄ítID
 
compID
,

132 
Pñ
 *
pcResiduÆ
,

133 c⁄° 
UI¡
 
uiSåide
,

134 
TC€ff
 * 
pcC€ff
,

135 c⁄° 
QpP¨am
 & 
cQP


136 
DEBUG_STRING_FN_DECLAREP
(
psDebug
));

138 
Void
 
övRecurTønsf‹mNxN
 ( c⁄° 
Comp⁄ítID
 
compID
, 
TComYuv
 *
pResiduÆ
, 
TComTU
 &
rTu
 );

140 
Void
 
rdpcmNxN
 ( 
TComTU
& 
rTu
, c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
* 
pcResiduÆ
, c⁄° 
UI¡
 
uiSåide
, c⁄° 
QpP¨am
& 
cQP
, 
TC€ff
* 
pcC€ff
, TC€f‡&
uiAbsSum
, 
RDPCMMode
& 
rdpcmMode
 );

141 
Void
 
övRdpcmNxN
–
TComTU
& 
rTu
, c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
* 
pcResiduÆ
, c⁄° 
UI¡
 
uiSåide
 );

143 
Void
 
≠∂yF‹w¨dRDPCM
–
TComTU
& 
rTu
, c⁄° 
Comp⁄ítID
 
compID
, 
Pñ
* 
pcResiduÆ
, c⁄° 
UI¡
 
uiSåide
, c⁄° 
QpP¨am
& 
cQP
, 
TC€ff
* 
pcC€ff
, TC€f‡&
uiAbsSum
, c⁄° 
RDPCMMode
 
mode
 );

147 #i‡
RDOQ_CHROMA_LAMBDA


148 
Void
 
	$£tLambdas
(c⁄° 
DoubÀ
 
œmbdas
[
MAX_NUM_COMPONENT
]Ë{ 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< MAX_NUM_COMPONENT; comp⁄ít++Ë
m_œmbdas
[component] =Üambdas[component]; }

149 
Void
 
	$£À˘Lambda
(c⁄° 
Comp⁄ítID
 
compIdx
Ë{ 
m_dLambda
 = 
m_œmbdas
[compIdx]; 
	}
}

151 
Void
 
	$£tLambda
(
DoubÀ
 
dLambda
Ë{ 
m_dLambda
 = dLambda;
	}
}

153 
Void
 
	$£tRDOQOff£t
–
UI¡
 
uiRDOQOff£t
 ) { 
m_uiRDOQOff£t
 = uiRDOQOff£t; 
	}
}

155 
e°BôsSbacSåu˘
* 
	gm_pcE°BôsSbac
;

157 
I¡
 
ˇlcP©ã∫SigCtx
–c⁄° 
UI¡
* 
sigC€ffGroupFœg
, UI¡ 
uiCGPosX
, UI¡ 
uiCGPosY
, UI¡ 
widthInGroups
, UI¡ 
heightInGroups
 );

159 
I¡
 
gëSigCtxInc
 ( I¡ 
∑âînSigCtx
,

160 c⁄° 
TUE¡r›yCodögP¨amëîs
 &
codögP¨amëîs
,

161 c⁄° 
I¡
 
sˇnPosôi⁄
,

162 c⁄° 
I¡
 
log2BlockWidth
,

163 c⁄° 
I¡
 
log2BlockHeight
,

164 c⁄° 
Ch™√lTy≥
 
ch™Ty≥


167 
UI¡
 
gëSigC€ffGroupCtxInc
 (c⁄° UI¡* 
uiSigC€ffGroupFœg
,

168 c⁄° 
UI¡
 
uiCGPosX
,

169 c⁄° 
UI¡
 
uiCGPosY
,

170 c⁄° 
UI¡
 
widthInGroups
,

171 c⁄° 
UI¡
 
heightInGroups
);

173 
Void
 
öôSˇlögLi°
 ();

174 
Void
 
de°roySˇlögLi°
 ();

175 
Void
 
£tEºSˇÀC€ff
 ( 
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
, c⁄° I¡ 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
], c⁄° 
BôDïths
 &
bôDïths
 );

176 
DoubÀ
* 
	$gëEºSˇÀC€ff
 ( 
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
 ) {  
m_îrSˇÀ
 [size][li°][qp]; 
	}
};

177 
	gDoubÀ
& 
	$gëEºSˇÀC€ffNoSˇlögLi°
 ( 
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
 ) {  
m_îrSˇÀNoSˇlögLi°
[size][li°][qp]; 
	}
};

178 
I¡
* 
	$gëQu™tC€ff
 ( 
UI¡
 
li°
, 
I¡
 
qp
, UI¡ 
size
 ) {  
m_qu™tC€f
 [size][li°][qp]; 
	}
};

179 
I¡
* 
	$gëDequ™tC€ff
 ( 
UI¡
 
li°
, 
I¡
 
qp
, UI¡ 
size
 ) {  
m_dequ™tC€f
 [size][li°][qp]; 
	}
};

180 
Void
 
	$£tU£SˇlögLi°
 ( 
Boﬁ
 
bU£SˇlögLi°
){ 
m_sˇlögLi°E«bÀdFœg
 = bU£SˇlögLi°; 
	}
};

181 
Boﬁ
 
	$gëU£SˇlögLi°
 (c⁄° 
UI¡
 
width
, c⁄° UI¡ 
height
, c⁄° 
Boﬁ
 
isTønsf‹mSkù
){  
m_sˇlögLi°E«bÀdFœg
 && (!isTønsf‹mSkù || ((width =4Ë&& (heighà=4))); 
	}
};

182 
Void
 
£tFœtSˇlögLi°
 (c⁄° 
I¡
 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
], c⁄° 
BôDïths
 &
bôDïths
);

183 
Void
 
x£tFœtSˇlögLi°
 ( 
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
);

184 
Void
 
xSëSˇlögLi°Enc
 ( 
TComSˇlögLi°
 *
sˇlögLi°
, 
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
);

185 
Void
 
xSëSˇlögLi°Dec
 ( c⁄° 
TComSˇlögLi°
 &
sˇlögLi°
, 
UI¡
 
li°
, UI¡ 
size
, 
I¡
 
qp
);

186 
Void
 
£tSˇlögLi°
 ( 
TComSˇlögLi°
 *
sˇlögLi°
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
], c⁄° 
BôDïths
 &
bôDïths
);

187 
Void
 
£tSˇlögLi°Dec
 ( c⁄° 
TComSˇlögLi°
 &
sˇlögLi°
);

188 
Void
 
¥o˚ssSˇlögLi°Enc
–
I¡
 *
c€ff
, I¡ *
qu™tc€ff
, I¡ 
qu™tSˇÀs
, 
UI¡
 
height
, UI¡ 
width
, UI¡ 
øtio
, I¡ 
sizuNum
, UI¡ 
dc
);

189 
Void
 
¥o˚ssSˇlögLi°Dec
–c⁄° 
I¡
 *
c€ff
, I¡ *
dequ™tc€ff
, I¡ 
övQu™tSˇÀs
, 
UI¡
 
height
, UI¡ 
width
, UI¡ 
øtio
, I¡ 
sizuNum
, UI¡ 
dc
);

190 #i‡
ADAPTIVE_QP_SELECTION


191 
Void
 
öôSli˚QpDñè
() ;

192 
Void
 
°‹eSli˚QpNext
(
TComSli˚
* 
pcSli˚
);

193 
Void
 
˛órSli˚ARLC¡
();

194 
I¡
 
	$gëQpDñè
(
I¡
 
qp
Ë{  
m_qpDñè
[qp]; 
	}
}

195 
I¡
* 
	$gëSli˚NSam∂es
(){  
m_¶i˚Nßm∂es
 ;
	}
}

196 
DoubÀ
* 
	$gëSli˚SumC
(Ë{  
m_¶i˚SumC
; 
	}
}

198 
Void
 
å™sf‹mSkùQu™tO√Sam∂e
(
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
TC€ff
 
ªsiDiff
, TC€ff* 
pcC€ff
, c⁄° 
UI¡
 
uiPos
, c⁄° 
QpP¨am
 &
cQP
, c⁄° 
Boﬁ
 
bU£HÆfRoundögPoöt
);

199 
Void
 
övTrSkùDeQu™tO√Sam∂e
(
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
, 
TC€ff
 
pcC€ff
, 
Pñ
 &
ªc⁄Sam∂e
, c⁄° 
QpP¨am
 &
cQP
, 
UI¡
 
uiPos
 );

201 
	g¥Ÿe˘ed
:

202 #i‡
ADAPTIVE_QP_SELECTION


203 
I¡
 
m_qpDñè
[
MAX_QP
+1];

204 
I¡
 
	gm_¶i˚Nßm∂es
[
LEVEL_RANGE
+1];

205 
DoubÀ
 
	gm_¶i˚SumC
[
LEVEL_RANGE
+1] ;

207 
TC€ff
* 
	gm_∂TempC€ff
;

210 #i‡
RDOQ_CHROMA_LAMBDA


211 
DoubÀ
 
	gm_œmbdas
[
MAX_NUM_COMPONENT
];

213 
DoubÀ
 
	gm_dLambda
;

214 
UI¡
 
	gm_uiRDOQOff£t
;

215 
UI¡
 
	gm_uiMaxTrSize
;

216 
Boﬁ
 
	gm_bEnc
;

217 
Boﬁ
 
	gm_u£RDOQ
;

218 
Boﬁ
 
	gm_u£RDOQTS
;

219 
Boﬁ
 
	gm_u£Sñe˘iveRDOQ
;

220 #i‡
ADAPTIVE_QP_SELECTION


221 
Boﬁ
 
	gm_bU£Ad≠tQpSñe˘
;

223 
Boﬁ
 
	gm_u£Tønsf‹mSkùFa°
;

225 
Boﬁ
 
	gm_sˇlögLi°E«bÀdFœg
;

227 
I¡
 *
	gm_qu™tC€f
 [
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
][
SCALING_LIST_REM_NUM
];

228 
I¡
 *
	gm_dequ™tC€f
 [
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
][
SCALING_LIST_REM_NUM
];

229 
DoubÀ
 *
	gm_îrSˇÀ
 [
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
][
SCALING_LIST_REM_NUM
];

230 
DoubÀ
 
	gm_îrSˇÀNoSˇlögLi°
[
SCALING_LIST_SIZE_NUM
][
SCALING_LIST_NUM
][
SCALING_LIST_REM_NUM
];

232 
	g¥iv©e
:

234 
Void
 
xT
 ( c⁄° 
I¡
 
ch™√lBôDïth
, 
Boﬁ
 
u£DST
, 
Pñ
* 
piBlkResi
, 
UI¡
 
uiSåide
, 
TC€ff
* 
psC€ff
, I¡ 
iWidth
, I¡ 
iHeight
, c⁄° I¡ 
maxLog2TrDy«micR™ge
 );

237 
Void
 
xTønsf‹mSkù
 ( 
Pñ
* 
piBlkResi
, 
UI¡
 
uiSåide
, 
TC€ff
* 
psC€ff
, 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
comp⁄ít
 );

239 
Void
 
signBôHidögHDQ
–
TC€ff
* 
pQC€f
, TC€ff* 
pC€f
, TC€ff* 
dñèU
, c⁄° 
TUE¡r›yCodögP¨amëîs
 &
codögP¨amëîs
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 );

242 
Void
 
xQu™t
–
TComTU
 &
rTu
,

243 
TC€ff
 * 
pSrc
,

244 
TC€ff
 * 
pDes
,

245 #i‡
ADAPTIVE_QP_SELECTION


246 
TC€ff
 *
pAæDes
,

248 
TC€ff
 &
uiAbsSum
,

249 c⁄° 
Comp⁄ítID
 
compID
,

250 c⁄° 
QpP¨am
 &
cQP
 );

252 
Boﬁ
 
xNìdRDOQ
–
TComTU
 &
rTu
,

253 
TC€ff
 * 
pSrc
,

254 c⁄° 
Comp⁄ítID
 
compID
,

255 c⁄° 
QpP¨am
 &
cQP
 );

259 
Void
 
xR©eDi°O±Qu™t
 ( 
TComTU
 &
rTu
,

260 
TC€ff
 * 
∂SrcC€ff
,

261 
TC€ff
 * 
piD°C€ff
,

262 #i‡
ADAPTIVE_QP_SELECTION


263 
TC€ff
 *
piAæD°C€ff
,

265 
TC€ff
 &
uiAbsSum
,

266 c⁄° 
Comp⁄ítID
 
compID
,

267 c⁄° 
QpP¨am
 &
cQP
 );

269 
__ölöe
 
UI¡
 
	$xGëCodedLevñ
 ( 
DoubÀ
& 
rd64CodedCo°
,

270 
DoubÀ
& 
rd64CodedCo°0
,

271 
DoubÀ
& 
rd64CodedCo°Sig
,

272 
I¡îmedüã_I¡
 
lLevñDoubÀ
,

273 
UI¡
 
uiMaxAbsLevñ
,

274 
USh‹t
 
ui16CtxNumSig
,

275 
USh‹t
 
ui16CtxNumO√
,

276 
USh‹t
 
ui16CtxNumAbs
,

277 
USh‹t
 
ui16AbsGoRi˚
,

278 
UI¡
 
c1Idx
,

279 
UI¡
 
c2Idx
,

280 
I¡
 
iQBôs
,

281 
DoubÀ
 
îr‹SˇÀ
,

282 
Boﬁ
 
bLa°
,

283 
Boﬁ
 
u£LimôedPªfixLígth
,

284 c⁄° 
I¡
 
maxLog2TrDy«micR™ge


288 
__ölöe
 
I¡
 
	$xGëICR©e
 ( c⁄° 
UI¡
 
uiAbsLevñ
,

289 c⁄° 
USh‹t
 
ui16CtxNumO√
,

290 c⁄° 
USh‹t
 
ui16CtxNumAbs
,

291 c⁄° 
USh‹t
 
ui16AbsGoRi˚
,

292 c⁄° 
UI¡
 
c1Idx
,

293 c⁄° 
UI¡
 
c2Idx
,

294 c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
,

295 c⁄° 
I¡
 
maxLog2TrDy«micR™ge


298 
__ölöe
 
DoubÀ
 
	$xGëR©eLa°
 ( c⁄° 
UI¡
 
uiPosX
, c⁄° UI¡ 
uiPosY
, c⁄° 
Comp⁄ítID
 
comp⁄ít
 ) const;

299 
__ölöe
 
DoubÀ
 
	$xGëR©eSigC€ffGroup
–
USh‹t
 
uiSignifiˇn˚C€ffGroup
, USh‹à
ui16CtxNumSig
 ) const;

300 
__ölöe
 
DoubÀ
 
	$xGëR©eSigC€f
 ( 
USh‹t
 
uiSignifiˇn˚
, USh‹à
ui16CtxNumSig
 ) const;

301 
__ölöe
 
DoubÀ
 
	$xGëICo°
 ( 
DoubÀ
 
dR©e
 ) const;

302 
__ölöe
 
DoubÀ
 
	$xGëIEPR©e
 ( ) const;

306 
Void
 
	`xDeQu™t
–
TComTU
 &
rTu
,

307 c⁄° 
TC€ff
 * 
pSrc
,

308 
TC€ff
 * 
pDes
,

309 c⁄° 
Comp⁄ítID
 
compID
,

310 c⁄° 
QpP¨am
 &
cQP
 );

313 
Void
 
	`xIT
 ( c⁄° 
I¡
 
ch™√lBôDïth
, 
Boﬁ
 
u£DST
, 
TC€ff
* 
∂C€f
, 
Pñ
* 
pResiduÆ
, 
UI¡
 
uiSåide
, I¡ 
iWidth
, I¡ 
iHeight
, c⁄° I¡ 
maxLog2TrDy«micR™ge
 );

316 
Void
 
	`xITønsf‹mSkù
 ( 
TC€ff
* 
∂C€f
, 
Pñ
* 
pResiduÆ
, 
UI¡
 
uiSåide
, 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
comp⁄ít
 );

318 
public
:

319 
Void
 
	`¸ossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
,

320 c⁄° 
Comp⁄ítID
 
compID
,

321 c⁄° 
Pñ
 *
piResiL
,

322 c⁄° 
Pñ
 *
piResiC
,

323 
Pñ
 *
piResiT
,

324 c⁄° 
I¡
 
width
,

325 c⁄° 
I¡
 
height
,

326 c⁄° 
I¡
 
°rideL
,

327 c⁄° 
I¡
 
°rideC
,

328 c⁄° 
I¡
 
°rideT
,

329 c⁄° 
Boﬁ
 
ªvî£
);

331 
	}
};

	@TLibCommon/TComWeightPrediction.cpp

39 
	~"Comm⁄Def.h
"

40 
	~"TComYuv.h
"

41 
	~"TComPic.h
"

42 
	~"TComI¡îpﬁ©i⁄Fûãr.h
"

43 
	~"TComWeightPªdi˘i⁄.h
"

46 
ölöe
 
Pñ
 
	$weightBidú
–
I¡
 
w0
, 
Pñ
 
P0
, I¡ 
w1
, Pñ 
P1
, I¡ 
round
, I¡ 
shi·
, I¡ 
off£t
, I¡ 
˛ùBD
)

48  
	`ClùBD
––(
w0
*(
P0
 + 
IF_INTERNAL_OFFS
Ë+ 
w1
*(
P1
 + IF_INTERNAL_OFFSË+ 
round
 + (
off£t
 << (
shi·
-1))Ë>> shi· ), 
˛ùBD
 );

49 
	}
}

52 
ölöe
 
Pñ
 
	$weightUnidú
–
I¡
 
w0
, 
Pñ
 
P0
, I¡ 
round
, I¡ 
shi·
, I¡ 
off£t
, I¡ 
˛ùBD
)

54  
	`ClùBD
––(
w0
*(
P0
 + 
IF_INTERNAL_OFFS
Ë+ 
round
Ë>> 
shi·
 ) + 
off£t
, 
˛ùBD
 );

55 
	}
}

57 
ölöe
 
Pñ
 
	$noWeightUnidú
–
Pñ
 
P0
, 
I¡
 
round
, I¡ 
shi·
, I¡ 
off£t
, I¡ 
˛ùBD
)

59  
	`ClùBD
––((
P0
 + 
IF_INTERNAL_OFFS
Ë+ 
round
Ë>> 
shi·
 ) + 
off£t
, 
˛ùBD
 );

60 
	}
}

62 
ölöe
 
Pñ
 
	$noWeightOff£tUnidú
–
Pñ
 
P0
, 
I¡
 
round
, I¡ 
shi·
, I¡ 
˛ùBD
)

64  
	`ClùBD
––((
P0
 + 
IF_INTERNAL_OFFS
Ë+ 
round
Ë>> 
shi·
 ), 
˛ùBD
 );

65 
	}
}

72 
	gTComWeightPªdi˘i⁄
::
	$TComWeightPªdi˘i⁄
()

74 
	}
}

78 
Void
 
TComWeightPªdi˘i⁄
::
	$addWeightBi
–c⁄° 
TComYuv
 *
pcYuvSrc0
,

79 c⁄° 
TComYuv
 *
pcYuvSrc1
,

80 c⁄° 
BôDïths
 &
bôDïths
,

81 c⁄° 
UI¡
 
iP¨tUnôIdx
,

82 c⁄° 
UI¡
 
uiWidth
,

83 c⁄° 
UI¡
 
uiHeight
,

84 c⁄° 
WPSˇlögP¨am
 *c⁄° 
wp0
,

85 c⁄° 
WPSˇlögP¨am
 *c⁄° 
wp1
,

86 
TComYuv
 *c⁄° 
ΩcYuvD°
,

87 c⁄° 
Boﬁ
 
bRoundLuma
)

90 c⁄° 
Boﬁ
 
íabÀRoundög
[
MAX_NUM_COMPONENT
]={ 
bRoundLuma
, 
åue
,Årue };

92 c⁄° 
UI¡
 
numVÆidComp⁄ít
 = 
pcYuvSrc0
->
	`gëNumbîVÆidComp⁄íts
();

94 
I¡
 
comp⁄ítIndex
=0; comp⁄ítIndex<
numVÆidComp⁄ít
; componentIndex++)

96 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp⁄ítIndex
);

98 c⁄° 
Pñ
* 
pSrc0
 = 
pcYuvSrc0
->
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

99 c⁄° 
Pñ
* 
pSrc1
 = 
pcYuvSrc1
->
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

100 
Pñ
* 
pD°
 = 
ΩcYuvD°
->
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

103 c⁄° 
I¡
 
w0
 = 
wp0
[
compID
].
w
;

104 c⁄° 
I¡
 
off£t
 = 
wp0
[
compID
].offset;

105 c⁄° 
I¡
 
˛ùBD
 = 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)];

106 c⁄° 
I¡
 
shi·Num
 = 
°d
::
max
<I¡>(2, (
IF_INTERNAL_PREC
 - 
˛ùBD
));

107 c⁄° 
I¡
 
shi·
 = 
wp0
[
compID
].shi· + 
shi·Num
;

108 c⁄° 
I¡
 
round
 = (
íabÀRoundög
[
compID
] && (
shi·
 > 0)) ? (1<<(shift-1)) : 0;

109 c⁄° 
I¡
 
w1
 = 
wp1
[
compID
].
w
;

110 c⁄° 
UI¡
 
csx
 = 
pcYuvSrc0
->
	`gëComp⁄ítSˇÀX
(
compID
);

111 c⁄° 
UI¡
 
csy
 = 
pcYuvSrc0
->
	`gëComp⁄ítSˇÀY
(
compID
);

112 c⁄° 
I¡
 
iHeight
 = 
uiHeight
>>
csy
;

113 c⁄° 
I¡
 
iWidth
 = 
uiWidth
>>
csx
;

115 c⁄° 
UI¡
 
iSrc0Såide
 = 
pcYuvSrc0
->
	`gëSåide
(
compID
);

116 c⁄° 
UI¡
 
iSrc1Såide
 = 
pcYuvSrc1
->
	`gëSåide
(
compID
);

117 c⁄° 
UI¡
 
iD°Såide
 = 
ΩcYuvD°
->
	`gëSåide
(
compID
);

119  
I¡
 
y
 = 
iHeight
-1; y >= 0; y-- )

122 
I¡
 
x
 = 
iWidth
-1;

123  ; 
x
 >= 3; )

125 
pD°
[
x
] = 
	`weightBidú
(
w0
,
pSrc0
[x], 
w1
,
pSrc1
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

126 
pD°
[
x
] = 
	`weightBidú
(
w0
,
pSrc0
[x], 
w1
,
pSrc1
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

127 
pD°
[
x
] = 
	`weightBidú
(
w0
,
pSrc0
[x], 
w1
,
pSrc1
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

128 
pD°
[
x
] = 
	`weightBidú
(
w0
,
pSrc0
[x], 
w1
,
pSrc1
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

130  ; 
x
 >= 0; x-- )

132 
pD°
[
x
] = 
	`weightBidú
(
w0
,
pSrc0
[x], 
w1
,
pSrc1
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
);

135 
pSrc0
 +
iSrc0Såide
;

136 
pSrc1
 +
iSrc1Såide
;

137 
pD°
 +
iD°Såide
;

140 
	}
}

144 
Void
 
	gTComWeightPªdi˘i⁄
::
	$addWeightUni
–c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc0
,

145 c⁄° 
BôDïths
 &
bôDïths
,

146 c⁄° 
UI¡
 
iP¨tUnôIdx
,

147 c⁄° 
UI¡
 
uiWidth
,

148 c⁄° 
UI¡
 
uiHeight
,

149 c⁄° 
WPSˇlögP¨am
 *c⁄° 
wp0
,

150 
TComYuv
 *c⁄° 
pcYuvD°
 )

152 c⁄° 
UI¡
 
numVÆidComp⁄ít
 = 
pcYuvSrc0
->
	`gëNumbîVÆidComp⁄íts
();

154 
I¡
 
comp⁄ítIndex
=0; comp⁄ítIndex<
numVÆidComp⁄ít
; componentIndex++)

156 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp⁄ítIndex
);

158 c⁄° 
Pñ
* 
pSrc0
 = 
pcYuvSrc0
->
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

159 
Pñ
* 
pD°
 = 
pcYuvD°
->
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

162 c⁄° 
I¡
 
w0
 = 
wp0
[
compID
].
w
;

163 c⁄° 
I¡
 
off£t
 = 
wp0
[
compID
].offset;

164 c⁄° 
I¡
 
˛ùBD
 = 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)];

165 c⁄° 
I¡
 
shi·Num
 = 
°d
::
max
<I¡>(2, (
IF_INTERNAL_PREC
 - 
˛ùBD
));

166 c⁄° 
I¡
 
shi·
 = 
wp0
[
compID
].shi· + 
shi·Num
;

167 c⁄° 
UI¡
 
iSrc0Såide
 = 
pcYuvSrc0
->
	`gëSåide
(
compID
);

168 c⁄° 
UI¡
 
iD°Såide
 = 
pcYuvD°
->
	`gëSåide
(
compID
);

169 c⁄° 
UI¡
 
csx
 = 
pcYuvSrc0
->
	`gëComp⁄ítSˇÀX
(
compID
);

170 c⁄° 
UI¡
 
csy
 = 
pcYuvSrc0
->
	`gëComp⁄ítSˇÀY
(
compID
);

171 c⁄° 
I¡
 
iHeight
 = 
uiHeight
>>
csy
;

172 c⁄° 
I¡
 
iWidth
 = 
uiWidth
>>
csx
;

174 i‡(
w0
 !1 << 
wp0
[
compID
].
shi·
)

176 c⁄° 
I¡
 
round
 = (
shi·
 > 0) ? (1<<(shift-1)) : 0;

177 
I¡
 
y
 = 
iHeight
-1; y >= 0; y-- )

179 
I¡
 
x
 = 
iWidth
-1;

180  ; 
x
 >= 3; )

182 
pD°
[
x
] = 
	`weightUnidú
(
w0
, 
pSrc0
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

183 
pD°
[
x
] = 
	`weightUnidú
(
w0
, 
pSrc0
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

184 
pD°
[
x
] = 
	`weightUnidú
(
w0
, 
pSrc0
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

185 
pD°
[
x
] = 
	`weightUnidú
(
w0
, 
pSrc0
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
); x--;

187  ; 
x
 >= 0; x--)

189 
pD°
[
x
] = 
	`weightUnidú
(
w0
, 
pSrc0
[x], 
round
, 
shi·
, 
off£t
, 
˛ùBD
);

191 
pSrc0
 +
iSrc0Såide
;

192 
pD°
 +
iD°Såide
;

197 c⁄° 
I¡
 
round
 = (
shi·Num
 > 0) ? (1<<(shiftNum-1)) : 0;

198 i‡(
off£t
 == 0)

200 
I¡
 
y
 = 
iHeight
-1; y >= 0; y-- )

202 
I¡
 
x
 = 
iWidth
-1;

203  ; 
x
 >= 3; )

205 
pD°
[
x
] = 
	`noWeightOff£tUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
˛ùBD
); x--;

206 
pD°
[
x
] = 
	`noWeightOff£tUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
˛ùBD
); x--;

207 
pD°
[
x
] = 
	`noWeightOff£tUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
˛ùBD
); x--;

208 
pD°
[
x
] = 
	`noWeightOff£tUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
˛ùBD
); x--;

210  ; 
x
 >= 0; x--)

212 
pD°
[
x
] = 
	`noWeightOff£tUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
˛ùBD
);

214 
pSrc0
 +
iSrc0Såide
;

215 
pD°
 +
iD°Såide
;

220 
I¡
 
y
 = 
iHeight
-1; y >= 0; y-- )

222 
I¡
 
x
 = 
iWidth
-1;

223  ; 
x
 >= 3; )

225 
pD°
[
x
] = 
	`noWeightUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
off£t
, 
˛ùBD
); x--;

226 
pD°
[
x
] = 
	`noWeightUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
off£t
, 
˛ùBD
); x--;

227 
pD°
[
x
] = 
	`noWeightUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
off£t
, 
˛ùBD
); x--;

228 
pD°
[
x
] = 
	`noWeightUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
off£t
, 
˛ùBD
); x--;

230  ; 
x
 >= 0; x--)

232 
pD°
[
x
] = 
	`noWeightUnidú
(
pSrc0
[x], 
round
, 
shi·Num
, 
off£t
, 
˛ùBD
);

234 
pSrc0
 +
iSrc0Såide
;

235 
pD°
 +
iD°Såide
;

240 
	}
}

247 
Void
 
	gTComWeightPªdi˘i⁄
::
	$gëWpSˇlög
–
TComD©aCU
 *c⁄° 
pcCU
,

248 c⁄° 
I¡
 
iRefIdx0
,

249 c⁄° 
I¡
 
iRefIdx1
,

250 
WPSˇlögP¨am
 *&
wp0
,

251 
WPSˇlögP¨am
 *&
wp1
)

253 
	`as£π
(
iRefIdx0
 >0 || 
iRefIdx1
 >= 0);

255 
TComSli˚
 *c⁄° 
pcSli˚
 = 
pcCU
->
	`gëSli˚
();

256 c⁄° 
Boﬁ
 
wpBiPªd
 = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëWPBiPªd
();

257 c⁄° 
Boﬁ
 
bBiPªd
 = (
iRefIdx0
>=0 && 
iRefIdx1
>=0);

258 c⁄° 
Boﬁ
 
bUniPªd
 = !
bBiPªd
;

260 i‡–
bUniPªd
 || 
wpBiPªd
 )

262 i‡–
iRefIdx0
 >= 0 )

264 
pcSli˚
->
	`gëWpSˇlög
(
REF_PIC_LIST_0
, 
iRefIdx0
, 
wp0
);

266 i‡–
iRefIdx1
 >= 0 )

268 
pcSli˚
->
	`gëWpSˇlög
(
REF_PIC_LIST_1
, 
iRefIdx1
, 
wp1
);

273 
	`as£π
(0);

276 i‡–
iRefIdx0
 < 0 )

278 
wp0
 = 
NULL
;

280 i‡–
iRefIdx1
 < 0 )

282 
wp1
 = 
NULL
;

285 c⁄° 
UI¡
 
numVÆidComp⁄ít
 = 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

286 c⁄° 
Boﬁ
 
bU£HighPªcisi⁄Pªdi˘i⁄Weightög
 = 
pcSli˚
->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
();

288 i‡–
bBiPªd
 )

290  
I¡
 
yuv
=0 ; yuv<
numVÆidComp⁄ít
 ; yuv++ )

292 c⁄° 
I¡
 
bôDïth
 = 
pcSli˚
->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
	`Comp⁄ítID
(
yuv
)));

293 c⁄° 
I¡
 
off£tSˇlögFa˘‹
 = 
bU£HighPªcisi⁄Pªdi˘i⁄Weightög
 ? 1 : (1 << (
bôDïth
-8));

295 
wp0
[
yuv
].
w
 = wp0[yuv].
iWeight
;

296 
wp1
[
yuv
].
w
 = wp1[yuv].
iWeight
;

297 
wp0
[
yuv
].
o
 = wp0[yuv].
iOff£t
 * 
off£tSˇlögFa˘‹
;

298 
wp1
[
yuv
].
o
 = wp1[yuv].
iOff£t
 * 
off£tSˇlögFa˘‹
;

299 
wp0
[
yuv
].
off£t
 = wp0[yuv].
o
 + 
wp1
[yuv].o;

300 
wp0
[
yuv
].
shi·
 = wp0[yuv].
uiLog2WeightDíom
 + 1;

301 
wp0
[
yuv
].
round
 = (1 << wp0[yuv].
uiLog2WeightDíom
);

302 
wp1
[
yuv
].
off£t
 = 
wp0
[yuv].offset;

303 
wp1
[
yuv
].
shi·
 = 
wp0
[yuv].shift;

304 
wp1
[
yuv
].
round
 = 
wp0
[yuv].round;

309 
WPSˇlögP¨am
 *c⁄° 
pwp
 = (
iRefIdx0
>=0Ë? 
wp0
 : 
wp1
 ;

311  
I¡
 
yuv
=0 ; yuv<
numVÆidComp⁄ít
 ; yuv++ )

313 c⁄° 
I¡
 
bôDïth
 = 
pcSli˚
->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
	`Comp⁄ítID
(
yuv
)));

314 c⁄° 
I¡
 
off£tSˇlögFa˘‹
 = 
bU£HighPªcisi⁄Pªdi˘i⁄Weightög
 ? 1 : (1 << (
bôDïth
-8));

316 
pwp
[
yuv
].
w
 =Öwp[yuv].
iWeight
;

317 
pwp
[
yuv
].
off£t
 =Öwp[yuv].
iOff£t
 * 
off£tSˇlögFa˘‹
;

318 
pwp
[
yuv
].
shi·
 =Öwp[yuv].
uiLog2WeightDíom
;

319 
pwp
[
yuv
].
round
 = (pwp[yuv].
uiLog2WeightDíom
>=1) ? (1 << (pwp[yuv].uiLog2WeightDenom-1)) : (0);

322 
	}
}

326 
Void
 
	gTComWeightPªdi˘i⁄
::
	$xWeighãdPªdi˘i⁄Bi
–
TComD©aCU
 *c⁄° 
pcCU
,

327 c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc0
,

328 c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc1
,

329 c⁄° 
I¡
 
iRefIdx0
,

330 c⁄° 
I¡
 
iRefIdx1
,

331 c⁄° 
UI¡
 
uiP¨tIdx
,

332 c⁄° 
I¡
 
iWidth
,

333 c⁄° 
I¡
 
iHeight
,

334 
TComYuv
 *
ΩcYuvD°
 )

336 
WPSˇlögP¨am
 *
pwp0
;

337 
WPSˇlögP¨am
 *
pwp1
;

339 
	`as£π
(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëWPBiPªd
());

341 
	`gëWpSˇlög
(
pcCU
, 
iRefIdx0
, 
iRefIdx1
, 
pwp0
, 
pwp1
);

343 if–
iRefIdx0
 >0 && 
iRefIdx1
 >= 0 )

345 
	`addWeightBi
(
pcYuvSrc0
, 
pcYuvSrc1
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïths
(), 
uiP¨tIdx
, 
iWidth
, 
iHeight
, 
pwp0
, 
pwp1
, 
ΩcYuvD°
 );

347 i‡–
iRefIdx0
 >0 && 
iRefIdx1
 < 0 )

349 
	`addWeightUni
–
pcYuvSrc0
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïths
(), 
uiP¨tIdx
, 
iWidth
, 
iHeight
, 
pwp0
, 
ΩcYuvD°
 );

351 i‡–
iRefIdx0
 < 0 && 
iRefIdx1
 >= 0 )

353 
	`addWeightUni
–
pcYuvSrc1
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïths
(), 
uiP¨tIdx
, 
iWidth
, 
iHeight
, 
pwp1
, 
ΩcYuvD°
 );

357 
	`as£π
 (0);

359 
	}
}

363 
Void
 
	gTComWeightPªdi˘i⁄
::
	$xWeighãdPªdi˘i⁄Uni
–
TComD©aCU
 *c⁄° 
pcCU
,

364 c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc
,

365 c⁄° 
UI¡
 
uiP¨tAddr
,

366 c⁄° 
I¡
 
iWidth
,

367 c⁄° 
I¡
 
iHeight
,

368 c⁄° 
RefPicLi°
 
eRefPicLi°
,

369 
TComYuv
 *
pcYuvPªd
,

370 c⁄° 
I¡
 
iRefIdx_öput
)

372 
WPSˇlögP¨am
 *
pwp
, *
pwpTmp
;

374 
I¡
 
iRefIdx
=
iRefIdx_öput
;

375 i‡–
iRefIdx
 < 0 )

377 
iRefIdx
 = 
pcCU
->
	`gëCUMvFõld
–
eRefPicLi°
 )->
	`gëRefIdx
–
uiP¨tAddr
 );

379 
	`as£π
 (
iRefIdx
 >= 0);

381 i‡–
eRefPicLi°
 =
REF_PIC_LIST_0
 )

383 
	`gëWpSˇlög
(
pcCU
, 
iRefIdx
, -1, 
pwp
, 
pwpTmp
);

387 
	`gëWpSˇlög
(
pcCU
, -1, 
iRefIdx
, 
pwpTmp
, 
pwp
);

389 
	`addWeightUni
–
pcYuvSrc
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïths
(), 
uiP¨tAddr
, 
iWidth
, 
iHeight
, 
pwp
, 
pcYuvPªd
 );

390 
	}
}

	@TLibCommon/TComWeightPrediction.h

38 #i‚de‡
__TCOMWEIGHTPREDICTION__


39 
	#__TCOMWEIGHTPREDICTION__


	)

41 
	~"Comm⁄Def.h
"

44 
˛ass
 
	gTComD©aCU
;

45 
˛ass
 
	gTComYuv
;

46 
	gWPSˇlögP¨am
;

52 ˛as†
	cTComWeightPªdi˘i⁄


54 
	mpublic
:

55 
TComWeightPªdi˘i⁄
();

57 
Void
 
gëWpSˇlög
–
TComD©aCU
 *c⁄° 
pcCU
,

58 c⁄° 
I¡
 
iRefIdx0
,

59 c⁄° 
I¡
 
iRefIdx1
,

60 
WPSˇlögP¨am
 *&
wp0
,

61 
WPSˇlögP¨am
 *&
wp1
);

63 
Void
 
addWeightBi
–c⁄° 
TComYuv
 *
pcYuvSrc0
,

64 c⁄° 
TComYuv
 *
pcYuvSrc1
,

65 c⁄° 
BôDïths
 &
bôDïths
,

66 c⁄° 
UI¡
 
iP¨tUnôIdx
,

67 c⁄° 
UI¡
 
uiWidth
,

68 c⁄° 
UI¡
 
uiHeight
,

69 c⁄° 
WPSˇlögP¨am
 *c⁄° 
wp0
,

70 c⁄° 
WPSˇlögP¨am
 *c⁄° 
wp1
,

71 
TComYuv
 *c⁄° 
ΩcYuvD°
,

72 c⁄° 
Boﬁ
 
bRoundLuma
=
åue
 );

74 
Void
 
addWeightUni
–c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc0
,

75 c⁄° 
BôDïths
 &
bôDïths
,

76 c⁄° 
UI¡
 
iP¨tUnôIdx
,

77 c⁄° 
UI¡
 
uiWidth
,

78 c⁄° 
UI¡
 
uiHeight
,

79 c⁄° 
WPSˇlögP¨am
 *c⁄° 
wp0
,

80 
TComYuv
 *c⁄° 
ΩcYuvD°
 );

82 
Void
 
xWeighãdPªdi˘i⁄Uni
–
TComD©aCU
 *c⁄° 
pcCU
,

83 c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc
,

84 c⁄° 
UI¡
 
uiP¨tAddr
,

85 c⁄° 
I¡
 
iWidth
,

86 c⁄° 
I¡
 
iHeight
,

87 c⁄° 
RefPicLi°
 
eRefPicLi°
,

88 
TComYuv
 *
pcYuvPªd
,

89 c⁄° 
I¡
 
iRefIdx
=-1 );

91 
Void
 
xWeighãdPªdi˘i⁄Bi
–
TComD©aCU
 *c⁄° 
pcCU
,

92 c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc0
,

93 c⁄° 
TComYuv
 *c⁄° 
pcYuvSrc1
,

94 c⁄° 
I¡
 
iRefIdx0
,

95 c⁄° 
I¡
 
iRefIdx1
,

96 c⁄° 
UI¡
 
uiP¨tIdx
,

97 c⁄° 
I¡
 
iWidth
,

98 c⁄° 
I¡
 
iHeight
,

99 
TComYuv
 *
pcYuvD°
 );

	@TLibCommon/TComYuv.cpp

39 
	~<°dlib.h
>

40 
	~<mem‹y.h
>

41 
	~<as£π.h
>

42 
	~<m©h.h
>

44 
	~"Comm⁄Def.h
"

45 
	~"TComYuv.h
"

46 
	~"TComI¡îpﬁ©i⁄Fûãr.h
"

51 
	gTComYuv
::
	$TComYuv
()

53 
I¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

55 
m_≠iBuf
[
comp
] = 
NULL
;

57 
	}
}

59 
	gTComYuv
::~
	$TComYuv
()

61 
	`de°roy
();

62 
	}
}

64 
Void
 
	gTComYuv
::
	$¸óã
–
UI¡
 
iWidth
, UI¡ 
iHeight
, 
ChromaF‹m©
 
chromaF‹m©IDC
 )

66 
	`de°roy
();

68 
m_iWidth
 = 
iWidth
;

69 
m_iHeight
 = 
iHeight
;

70 
m_chromaF‹m©IDC
 = 
chromaF‹m©IDC
;

72 
I¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

75 
m_≠iBuf
[
comp
] = (
Pñ
*)
	`xMÆloc
–Pñ, 
	`gëWidth
(
	`Comp⁄ítID
(comp))*
	`gëHeight
(ComponentID(comp)) );

77 
	}
}

79 
Void
 
	gTComYuv
::
	$de°roy
()

82 
I¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

84 i‡(
m_≠iBuf
[
comp
]!=
NULL
)

86 
	`xFªe
–
m_≠iBuf
[
comp
] );

87 
m_≠iBuf
[
comp
] = 
NULL
;

90 
	}
}

92 
Void
 
	gTComYuv
::
	$˛ór
()

94 
I¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

96 i‡(
m_≠iBuf
[
comp
]!=
NULL
)

98 ::
	`mem£t
–
m_≠iBuf
[
comp
], 0, ( 
	`gëWidth
(
	`Comp⁄ítID
(comp)Ë* 
	`gëHeight
(Comp⁄ítID(comp)Ë)*(
Pñ
) );

101 
	}
}

106 
Void
 
	gTComYuv
::
	$c›yToPicYuv
 ( 
TComPicYuv
* 
pcPicYuvD°
, c⁄° 
UI¡
 
˘uRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiP¨tDïth
, c⁄° UI¡ 
uiP¨tIdx
 ) const

108 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

110 
	`c›yToPicComp⁄ít
 ( 
	`Comp⁄ítID
(
comp
), 
pcPicYuvD°
, 
˘uRsAddr
, 
uiAbsZ‹dîIdx
, 
uiP¨tDïth
, 
uiP¨tIdx
 );

112 
	}
}

114 
Void
 
	gTComYuv
::
	$c›yToPicComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
compID
, 
TComPicYuv
* 
pcPicYuvD°
, c⁄° 
UI¡
 
˘uRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiP¨tDïth
, c⁄° UI¡ 
uiP¨tIdx
 ) const

116 c⁄° 
I¡
 
iWidth
 = 
	`gëWidth
(
compID
Ë>>
uiP¨tDïth
;

117 c⁄° 
I¡
 
iHeight
 = 
	`gëHeight
(
compID
)>>
uiP¨tDïth
;

119 c⁄° 
Pñ
* 
pSrc
 = 
	`gëAddr
(
compID
, 
uiP¨tIdx
, 
iWidth
);

120 
Pñ
* 
pD°
 = 
pcPicYuvD°
->
	`gëAddr
 ( 
compID
, 
˘uRsAddr
, 
uiAbsZ‹dîIdx
 );

122 c⁄° 
UI¡
 
iSrcSåide
 = 
	`gëSåide
(
compID
);

123 c⁄° 
UI¡
 
iD°Såide
 = 
pcPicYuvD°
->
	`gëSåide
(
compID
);

125  
I¡
 
y
 = 
iHeight
; y != 0; y-- )

127 ::
	`mem˝y
–
pD°
, 
pSrc
, (
Pñ
)*
iWidth
);

128 
pD°
 +
iD°Såide
;

129 
pSrc
 +
iSrcSåide
;

131 
	}
}

136 
Void
 
	gTComYuv
::
	$c›yFromPicYuv
 ( c⁄° 
TComPicYuv
* 
pcPicYuvSrc
, c⁄° 
UI¡
 
˘uRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
 )

138 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

140 
	`c›yFromPicComp⁄ít
 ( 
	`Comp⁄ítID
(
comp
), 
pcPicYuvSrc
, 
˘uRsAddr
, 
uiAbsZ‹dîIdx
 );

142 
	}
}

144 
Void
 
	gTComYuv
::
	$c›yFromPicComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
TComPicYuv
* 
pcPicYuvSrc
, c⁄° 
UI¡
 
˘uRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
 )

146 
Pñ
* 
pD°
 = 
	`gëAddr
(
compID
);

147 c⁄° 
Pñ
* 
pSrc
 = 
pcPicYuvSrc
->
	`gëAddr
 ( 
compID
, 
˘uRsAddr
, 
uiAbsZ‹dîIdx
 );

149 c⁄° 
UI¡
 
iD°Såide
 = 
	`gëSåide
(
compID
);

150 c⁄° 
UI¡
 
iSrcSåide
 = 
pcPicYuvSrc
->
	`gëSåide
(
compID
);

151 c⁄° 
I¡
 
iWidth
=
	`gëWidth
(
compID
);

152 c⁄° 
I¡
 
iHeight
=
	`gëHeight
(
compID
);

154 
I¡
 
y
 = 
iHeight
; y != 0; y-- )

156 ::
	`mem˝y
–
pD°
, 
pSrc
, (
Pñ
)*
iWidth
);

157 
pD°
 +
iD°Såide
;

158 
pSrc
 +
iSrcSåide
;

160 
	}
}

165 
Void
 
	gTComYuv
::
	$c›yToP¨tYuv
–
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiD°P¨tIdx
 ) const

167 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

169 
	`c›yToP¨tComp⁄ít
 ( 
	`Comp⁄ítID
(
comp
), 
pcYuvD°
, 
uiD°P¨tIdx
 );

171 
	}
}

173 
Void
 
	gTComYuv
::
	$c›yToP¨tComp⁄ít
–c⁄° 
Comp⁄ítID
 
compID
, 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiD°P¨tIdx
 ) const

175 c⁄° 
Pñ
* 
pSrc
 = 
	`gëAddr
(
compID
);

176 
Pñ
* 
pD°
 = 
pcYuvD°
->
	`gëAddr
–
compID
, 
uiD°P¨tIdx
 );

178 c⁄° 
UI¡
 
iSrcSåide
 = 
	`gëSåide
(
compID
);

179 c⁄° 
UI¡
 
iD°Såide
 = 
pcYuvD°
->
	`gëSåide
(
compID
);

180 c⁄° 
I¡
 
iWidth
=
	`gëWidth
(
compID
);

181 c⁄° 
I¡
 
iHeight
=
	`gëHeight
(
compID
);

183 
I¡
 
y
 = 
iHeight
; y != 0; y-- )

185 ::
	`mem˝y
–
pD°
, 
pSrc
, (
Pñ
)*
iWidth
);

186 
pD°
 +
iD°Såide
;

187 
pSrc
 +
iSrcSåide
;

189 
	}
}

194 
Void
 
	gTComYuv
::
	$c›yP¨tToYuv
–
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiSrcP¨tIdx
 ) const

196 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

198 
	`c›yP¨tToComp⁄ít
 ( 
	`Comp⁄ítID
(
comp
), 
pcYuvD°
, 
uiSrcP¨tIdx
 );

200 
	}
}

202 
Void
 
	gTComYuv
::
	$c›yP¨tToComp⁄ít
–c⁄° 
Comp⁄ítID
 
compID
, 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiSrcP¨tIdx
 ) const

204 c⁄° 
Pñ
* 
pSrc
 = 
	`gëAddr
(
compID
, 
uiSrcP¨tIdx
);

205 
Pñ
* 
pD°
 = 
pcYuvD°
->
	`gëAddr
(
compID
, 0 );

207 c⁄° 
UI¡
 
iSrcSåide
 = 
	`gëSåide
(
compID
);

208 c⁄° 
UI¡
 
iD°Såide
 = 
pcYuvD°
->
	`gëSåide
(
compID
);

210 c⁄° 
UI¡
 
uiHeight
 = 
pcYuvD°
->
	`gëHeight
(
compID
);

211 c⁄° 
UI¡
 
uiWidth
 = 
pcYuvD°
->
	`gëWidth
(
compID
);

213  
UI¡
 
y
 = 
uiHeight
; y != 0; y-- )

215 ::
	`mem˝y
–
pD°
, 
pSrc
, (
Pñ
)*
uiWidth
);

216 
pD°
 +
iD°Såide
;

217 
pSrc
 +
iSrcSåide
;

219 
	}
}

224 
Void
 
	gTComYuv
::
	$c›yP¨tToP¨tYuv
 ( 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° UI¡ 
iWidth
, c⁄° UI¡ 
iHeight
 ) const

226 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

228 
	`c›yP¨tToP¨tComp⁄ít
 (
	`Comp⁄ítID
(
comp
), 
pcYuvD°
, 
uiP¨tIdx
, 
iWidth
>>
	`gëComp⁄ítSˇÀX
(Comp⁄ítID(comp)), 
iHeight
>>
	`gëComp⁄ítSˇÀY
(ComponentID(comp)) );

230 
	}
}

232 
Void
 
	gTComYuv
::
	$c›yP¨tToP¨tComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
compID
, 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° UI¡ 
iWidthComp⁄ít
, c⁄° UI¡ 
iHeightComp⁄ít
 ) const

234 c⁄° 
Pñ
* 
pSrc
 = 
	`gëAddr
(
compID
, 
uiP¨tIdx
);

235 
Pñ
* 
pD°
 = 
pcYuvD°
->
	`gëAddr
(
compID
, 
uiP¨tIdx
);

236 if–
pSrc
 =
pD°
 )

243 c⁄° 
UI¡
 
iSrcSåide
 = 
	`gëSåide
(
compID
);

244 c⁄° 
UI¡
 
iD°Såide
 = 
pcYuvD°
->
	`gëSåide
(
compID
);

245  
UI¡
 
y
 = 
iHeightComp⁄ít
; y != 0; y-- )

247 ::
	`mem˝y
–
pD°
, 
pSrc
, 
iWidthComp⁄ít
 * (
Pñ
) );

248 
pSrc
 +
iSrcSåide
;

249 
pD°
 +
iD°Såide
;

251 
	}
}

256 
Void
 
	gTComYuv
::
	$c›yP¨tToP¨tComp⁄ítMxN
 ( c⁄° 
Comp⁄ítID
 
compID
, 
TComYuv
* 
pcYuvD°
, c⁄° 
TComRe˘™gÀ
 &
ª˘
) const

258 c⁄° 
Pñ
* 
pSrc
 = 
	`gëAddrPix
–
compID
, 
ª˘
.
x0
,Ñe˘.
y0
 );

259 
Pñ
* 
pD°
 = 
pcYuvD°
->
	`gëAddrPix
–
compID
, 
ª˘
.
x0
,Ñe˘.
y0
 );

260 if–
pSrc
 =
pD°
 )

267 c⁄° 
UI¡
 
iSrcSåide
 = 
	`gëSåide
(
compID
);

268 c⁄° 
UI¡
 
iD°Såide
 = 
pcYuvD°
->
	`gëSåide
(
compID
);

269 c⁄° 
UI¡
 
uiHeightComp⁄ít
=
ª˘
.
height
;

270 c⁄° 
UI¡
 
uiWidthComp⁄ít
=
ª˘
.
width
;

271  
UI¡
 
y
 = 
uiHeightComp⁄ít
; y != 0; y-- )

273 ::
	`mem˝y
–
pD°
, 
pSrc
, 
uiWidthComp⁄ít
 * –
Pñ
 ) );

274 
pSrc
 +
iSrcSåide
;

275 
pD°
 +
iD°Såide
;

277 
	}
}

282 
Void
 
	gTComYuv
::
	$addClù
–c⁄° 
TComYuv
* 
pcYuvSrc0
, c⁄° TComYuv* 
pcYuvSrc1
, c⁄° 
UI¡
 
uiTrUnôIdx
, c⁄° UI¡ 
uiP¨tSize
, c⁄° 
BôDïths
 &
˛ùBôDïths
 )

284 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

286 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

287 c⁄° 
I¡
 
uiP¨tWidth
 =
uiP¨tSize
>>
	`gëComp⁄ítSˇÀX
(
compID
);

288 c⁄° 
I¡
 
uiP¨tHeight
=
uiP¨tSize
>>
	`gëComp⁄ítSˇÀY
(
compID
);

290 c⁄° 
Pñ
* 
pSrc0
 = 
pcYuvSrc0
->
	`gëAddr
(
compID
, 
uiTrUnôIdx
, 
uiP¨tWidth
 );

291 c⁄° 
Pñ
* 
pSrc1
 = 
pcYuvSrc1
->
	`gëAddr
(
compID
, 
uiTrUnôIdx
, 
uiP¨tWidth
 );

292 
Pñ
* 
pD°
 = 
	`gëAddr
(
compID
, 
uiTrUnôIdx
, 
uiP¨tWidth
 );

294 c⁄° 
UI¡
 
iSrc0Såide
 = 
pcYuvSrc0
->
	`gëSåide
(
compID
);

295 c⁄° 
UI¡
 
iSrc1Såide
 = 
pcYuvSrc1
->
	`gëSåide
(
compID
);

296 c⁄° 
UI¡
 
iD°Såide
 = 
	`gëSåide
(
compID
);

297 c⁄° 
I¡
 
˛ùbd
 = 
˛ùBôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)];

298 #i‡
O0043_BEST_EFFORT_DECODING


299 c⁄° 
I¡
 
bôDïthDñè
 = 
˛ùBôDïths
.
°ªam
[
	`toCh™√lTy≥
(
compID
)] - 
˛ùbd
;

302  
I¡
 
y
 = 
uiP¨tHeight
-1; y >= 0; y-- )

304  
I¡
 
x
 = 
uiP¨tWidth
-1; x >= 0; x-- )

306 #i‡
O0043_BEST_EFFORT_DECODING


307 
pD°
[
x
] = 
	`Pñ
(
ClùBD
<
I¡
>–
	`I¡
(
pSrc0
[x]Ë+ 
rightShi·EvíRoundög
<
Pñ
>(
pSrc1
[x], 
bôDïthDñè
), 
˛ùbd
));

309 
pD°
[
x
] = 
	`Pñ
(
ClùBD
<
I¡
>–
	`I¡
(
pSrc0
[x]Ë+ I¡(
pSrc1
[x]), 
˛ùbd
));

312 
pSrc0
 +
iSrc0Såide
;

313 
pSrc1
 +
iSrc1Såide
;

314 
pD°
 +
iD°Såide
;

317 
	}
}

322 
Void
 
	gTComYuv
::
	$subåa˘
–c⁄° 
TComYuv
* 
pcYuvSrc0
, c⁄° TComYuv* 
pcYuvSrc1
, c⁄° 
UI¡
 
uiTrUnôIdx
, c⁄° UI¡ 
uiP¨tSize
 )

324 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

326 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

327 c⁄° 
I¡
 
uiP¨tWidth
 =
uiP¨tSize
>>
	`gëComp⁄ítSˇÀX
(
compID
);

328 c⁄° 
I¡
 
uiP¨tHeight
=
uiP¨tSize
>>
	`gëComp⁄ítSˇÀY
(
compID
);

330 c⁄° 
Pñ
* 
pSrc0
 = 
pcYuvSrc0
->
	`gëAddr
–
compID
, 
uiTrUnôIdx
, 
uiP¨tWidth
 );

331 c⁄° 
Pñ
* 
pSrc1
 = 
pcYuvSrc1
->
	`gëAddr
–
compID
, 
uiTrUnôIdx
, 
uiP¨tWidth
 );

332 
Pñ
* 
pD°
 = 
	`gëAddr
–
compID
, 
uiTrUnôIdx
, 
uiP¨tWidth
 );

334 c⁄° 
I¡
 
iSrc0Såide
 = 
pcYuvSrc0
->
	`gëSåide
(
compID
);

335 c⁄° 
I¡
 
iSrc1Såide
 = 
pcYuvSrc1
->
	`gëSåide
(
compID
);

336 c⁄° 
I¡
 
iD°Såide
 = 
	`gëSåide
(
compID
);

338 
I¡
 
y
 = 
uiP¨tHeight
-1; y >= 0; y-- )

340 
I¡
 
x
 = 
uiP¨tWidth
-1; x >= 0; x-- )

342 
pD°
[
x
] = 
pSrc0
[x] - 
pSrc1
[x];

344 
pSrc0
 +
iSrc0Såide
;

345 
pSrc1
 +
iSrc1Såide
;

346 
pD°
 +
iD°Såide
;

349 
	}
}

354 
Void
 
	gTComYuv
::
	$addAvg
–c⁄° 
TComYuv
* 
pcYuvSrc0
, c⁄° TComYuv* 
pcYuvSrc1
, c⁄° 
UI¡
 
iP¨tUnôIdx
, c⁄° UI¡ 
uiWidth
, c⁄° UI¡ 
uiHeight
, c⁄° 
BôDïths
 &
˛ùBôDïths
 )

356 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

358 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

359 c⁄° 
Pñ
* 
pSrc0
 = 
pcYuvSrc0
->
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

360 c⁄° 
Pñ
* 
pSrc1
 = 
pcYuvSrc1
->
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

361 
Pñ
* 
pD°
 = 
	`gëAddr
–
compID
, 
iP¨tUnôIdx
 );

363 c⁄° 
UI¡
 
iSrc0Såide
 = 
pcYuvSrc0
->
	`gëSåide
(
compID
);

364 c⁄° 
UI¡
 
iSrc1Såide
 = 
pcYuvSrc1
->
	`gëSåide
(
compID
);

365 c⁄° 
UI¡
 
iD°Såide
 = 
	`gëSåide
(
compID
);

366 c⁄° 
I¡
 
˛ùbd
 = 
˛ùBôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)];

367 c⁄° 
I¡
 
shi·Num
 = 
°d
::
max
<I¡>(2, (
IF_INTERNAL_PREC
 - 
˛ùbd
)) + 1;

368 c⁄° 
I¡
 
off£t
 = ( 1 << ( 
shi·Num
 - 1 ) ) + 2 * 
IF_INTERNAL_OFFS
;

370 c⁄° 
I¡
 
iWidth
 = 
uiWidth
 >> 
	`gëComp⁄ítSˇÀX
(
compID
);

371 c⁄° 
I¡
 
iHeight
 = 
uiHeight
 >> 
	`gëComp⁄ítSˇÀY
(
compID
);

373 i‡(
iWidth
&1)

375 
	`as£π
(0);

376 
	`exô
(-1);

378 i‡(
iWidth
&2)

380  
I¡
 
y
 = 0; y < 
iHeight
; y++ )

382 
I¡
 
x
=0 ; x < 
iWidth
; x+=2 )

384 
pD°
[ 
x
 + 0 ] = 
	`ClùBD
–
	`rightShi·
(–
pSrc0
[ x + 0 ] + 
pSrc1
[ x + 0 ] + 
off£t
 ), 
shi·Num
), 
˛ùbd
 );

385 
pD°
[ 
x
 + 1 ] = 
	`ClùBD
–
	`rightShi·
(–
pSrc0
[ x + 1 ] + 
pSrc1
[ x + 1 ] + 
off£t
 ), 
shi·Num
), 
˛ùbd
 );

387 
pSrc0
 +
iSrc0Såide
;

388 
pSrc1
 +
iSrc1Såide
;

389 
pD°
 +
iD°Såide
;

394  
I¡
 
y
 = 0; y < 
iHeight
; y++ )

396 
I¡
 
x
=0 ; x < 
iWidth
; x+=4 )

398 
pD°
[ 
x
 + 0 ] = 
	`ClùBD
–
	`rightShi·
(–
pSrc0
[ x + 0 ] + 
pSrc1
[ x + 0 ] + 
off£t
 ), 
shi·Num
), 
˛ùbd
 );

399 
pD°
[ 
x
 + 1 ] = 
	`ClùBD
–
	`rightShi·
(–
pSrc0
[ x + 1 ] + 
pSrc1
[ x + 1 ] + 
off£t
 ), 
shi·Num
), 
˛ùbd
 );

400 
pD°
[ 
x
 + 2 ] = 
	`ClùBD
–
	`rightShi·
(–
pSrc0
[ x + 2 ] + 
pSrc1
[ x + 2 ] + 
off£t
 ), 
shi·Num
), 
˛ùbd
 );

401 
pD°
[ 
x
 + 3 ] = 
	`ClùBD
–
	`rightShi·
(–
pSrc0
[ x + 3 ] + 
pSrc1
[ x + 3 ] + 
off£t
 ), 
shi·Num
), 
˛ùbd
 );

403 
pSrc0
 +
iSrc0Såide
;

404 
pSrc1
 +
iSrc1Såide
;

405 
pD°
 +
iD°Såide
;

409 
	}
}

411 
Void
 
	gTComYuv
::
	$ªmoveHighFªq
–c⁄° 
TComYuv
* 
pcYuvSrc
,

412 c⁄° 
UI¡
 
uiP¨tIdx
,

413 c⁄° 
UI¡
 
uiWidth
,

414 c⁄° 
UI¡
 
uiHeight
,

415 c⁄° 
I¡
 
bôDïths
[
MAX_NUM_CHANNEL_TYPE
],

416 c⁄° 
Boﬁ
 
bClùToBôDïths


419 
I¡
 
comp
=0; comp<
	`gëNumbîVÆidComp⁄íts
(); comp++)

421 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

422 c⁄° 
Pñ
* 
pSrc
 = 
pcYuvSrc
->
	`gëAddr
(
compID
, 
uiP¨tIdx
);

423 
Pñ
* 
pD°
 = 
	`gëAddr
(
compID
, 
uiP¨tIdx
);

425 c⁄° 
I¡
 
iSrcSåide
 = 
pcYuvSrc
->
	`gëSåide
(
compID
);

426 c⁄° 
I¡
 
iD°Såide
 = 
	`gëSåide
(
compID
);

427 c⁄° 
I¡
 
iWidth
 = 
uiWidth
 >>
	`gëComp⁄ítSˇÀX
(
compID
);

428 c⁄° 
I¡
 
iHeight
 = 
uiHeight
>>
	`gëComp⁄ítSˇÀY
(
compID
);

429 i‡(
bClùToBôDïths
)

431 c⁄° 
I¡
 
˛ùBd
=
bôDïths
[
	`toCh™√lTy≥
(
compID
)];

432  
I¡
 
y
 = 
iHeight
-1; y >= 0; y-- )

434  
I¡
 
x
 = 
iWidth
-1; x >= 0; x-- )

436 
pD°
[
x
 ] = 
	`ClùBD
((2 *ÖD°[x]Ë- 
pSrc
[x], 
˛ùBd
);

438 
pSrc
 +
iSrcSåide
;

439 
pD°
 +
iD°Såide
;

444  
I¡
 
y
 = 
iHeight
-1; y >= 0; y-- )

446  
I¡
 
x
 = 
iWidth
-1; x >= 0; x-- )

448 
pD°
[
x
 ] = (2 *ÖD°[x]Ë- 
pSrc
[x];

450 
pSrc
 +
iSrcSåide
;

451 
pD°
 +
iD°Såide
;

455 
	}
}

	@TLibCommon/TComYuv.h

40 #i‚de‡
__TCOMYUV__


41 
	#__TCOMYUV__


	)

42 
	~"Comm⁄Def.h
"

43 
	~"TComPicYuv.h
"

44 
	~"TComRe˘™gÀ.h
"

54 ˛as†
	cTComYuv


56 
	m¥iv©e
:

62 
Pñ
* 
m_≠iBuf
[
MAX_NUM_COMPONENT
];

68 
UI¡
 
	mm_iWidth
;

69 
UI¡
 
	mm_iHeight
;

70 
ChromaF‹m©
 
	mm_chromaF‹m©IDC
;

88 
	mpublic
:

90 
TComYuv
 ();

91 
	mvútuÆ
 ~
TComYuv
 ();

97 
Void
 
¸óã
 ( c⁄° 
UI¡
 
iWidth
, c⁄° UI¡ 
iHeight
, c⁄° 
ChromaF‹m©
 
chromaF‹m©IDC
 );

98 
Void
 
de°roy
 ();

99 
Void
 
˛ór
 ();

106 
Void
 
	$c›yToPicYuv
 ( 
TComPicYuv
* 
pcPicYuvD°
, c⁄° 
UI¡
 
˘uRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiP¨tDïth
 = 0, c⁄° UI¡ 
uiP¨tIdx
 = 0 ) const ;

107 
Void
 
	$c›yToPicComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
id
, 
TComPicYuv
* 
pcPicYuvD°
, c⁄° 
UI¡
 
iCtuRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
, c⁄° UI¡ 
uiP¨tDïth
 = 0, c⁄° UI¡ 
uiP¨tIdx
 = 0 ) const ;

110 
Void
 
	`c›yFromPicYuv
 ( c⁄° 
TComPicYuv
* 
pcPicYuvSrc
, c⁄° 
UI¡
 
˘uRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
 );

111 
Void
 
	`c›yFromPicComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
id
, c⁄° 
TComPicYuv
* 
pcPicYuvSrc
, c⁄° 
UI¡
 
iCtuRsAddr
, c⁄° UI¡ 
uiAbsZ‹dîIdx
 );

114 
Void
 
	$c›yToP¨tYuv
 ( 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiD°P¨tIdx
 ) const ;

115 
Void
 
	$c›yToP¨tComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
id
, 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiD°P¨tIdx
 ) const ;

118 
Void
 
	$c›yP¨tToYuv
 ( 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiSrcP¨tIdx
 ) const;

119 
Void
 
	$c›yP¨tToComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
id
, 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiSrcP¨tIdx
 ) const;

122 
Void
 
	$c›yP¨tToP¨tYuv
 ( 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° UI¡ 
uiWidth
, c⁄° UI¡ 
uiHeight
 ) const;

123 
Void
 
	$c›yP¨tToP¨tComp⁄ít
 ( c⁄° 
Comp⁄ítID
 
id
, 
TComYuv
* 
pcYuvD°
, c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° UI¡ 
uiWidthComp⁄ít
, c⁄° UI¡ 
uiHeightComp⁄ít
 ) const;

126 
Void
 
	$c›yP¨tToP¨tComp⁄ítMxN
 ( c⁄° 
Comp⁄ítID
 
id
, 
TComYuv
* 
pcYuvD°
, c⁄° 
TComRe˘™gÀ
 &
ª˘
 ) const;

133 
Void
 
	`addClù
 ( c⁄° 
TComYuv
* 
pcYuvSrc0
, c⁄° TComYuv* 
pcYuvSrc1
, c⁄° 
UI¡
 
uiTrUnôIdx
, c⁄° UI¡ 
uiP¨tSize
, c⁄° 
BôDïths
 &
˛ùBôDïths
 );

136 
Void
 
	`subåa˘
 ( c⁄° 
TComYuv
* 
pcYuvSrc0
, c⁄° TComYuv* 
pcYuvSrc1
, c⁄° 
UI¡
 
uiTrUnôIdx
, c⁄° UI¡ 
uiP¨tSize
 );

139 
Void
 
	`addAvg
 ( c⁄° 
TComYuv
* 
pcYuvSrc0
, c⁄° TComYuv* 
pcYuvSrc1
, c⁄° 
UI¡
 
iP¨tUnôIdx
, c⁄° UI¡ 
iWidth
, c⁄° UI¡ 
iHeight
, c⁄° 
BôDïths
 &
˛ùBôDïths
 );

141 
Void
 
	`ªmoveHighFªq
 ( c⁄° 
TComYuv
* 
pcYuvSrc
, c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° UI¡ 
uiWidth
, c⁄° UI¡ 
uiHeight


142 , c⁄° 
I¡
 
bôDïths
[
MAX_NUM_CHANNEL_TYPE
], c⁄° 
Boﬁ
 
bClùToBôDïths


150 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
id
Ë{  
m_≠iBuf
[id]; }

151 c⁄° 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_≠iBuf
[id]; 
	}
}

154 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
UI¡
 
uiP¨tUnôIdx
)

156 
I¡
 
blkX
 = 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[ 
uiP¨tUnôIdx
 ] ] >> 
	`gëComp⁄ítSˇÀX
(
id
);

157 
I¡
 
blkY
 = 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[ 
uiP¨tUnôIdx
 ] ] >> 
	`gëComp⁄ítSˇÀY
(
id
);

158 
	`as£π
((
blkX
<
	`gëWidth
(
id
Ë&& 
blkY
<
	`gëHeight
(id)));

159  
m_≠iBuf
[
id
] + 
blkX
 + 
blkY
 * 
	`gëSåide
(id);

160 
	}
}

161 c⁄° 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
UI¡
 
uiP¨tUnôIdx
) const

163 
I¡
 
blkX
 = 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[ 
uiP¨tUnôIdx
 ] ] >> 
	`gëComp⁄ítSˇÀX
(
id
);

164 
I¡
 
blkY
 = 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[ 
uiP¨tUnôIdx
 ] ] >> 
	`gëComp⁄ítSˇÀY
(
id
);

165 
	`as£π
((
blkX
<
	`gëWidth
(
id
Ë&& 
blkY
<
	`gëHeight
(id)));

166  
m_≠iBuf
[
id
] + 
blkX
 + 
blkY
 * 
	`gëSåide
(id);

167 
	}
}

170 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
UI¡
 
iTønsUnôIdx
, c⁄° UI¡ 
iBlkSizeF‹Comp⁄ít
)

172 
UI¡
 
width
=
	`gëWidth
(
id
);

173 
I¡
 
blkX
 = ( 
iTønsUnôIdx
 * 
iBlkSizeF‹Comp⁄ít
 ) & ( 
width
 - 1 );

174 
I¡
 
blkY
 = ( 
iTønsUnôIdx
 * 
iBlkSizeF‹Comp⁄ít
 ) &~ ( 
width
 - 1 );

175 i‡(
m_chromaF‹m©IDC
==
CHROMA_422
 && 
id
!=
COMPONENT_Y
)

177 
blkY
<<=1;

179  
m_≠iBuf
[
id
] + 
blkX
 + 
blkY
 * 
iBlkSizeF‹Comp⁄ít
;

180 
	}
}

182 c⁄° 
Pñ
* 
	$gëAddr
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
UI¡
 
iTønsUnôIdx
, c⁄° UI¡ 
iBlkSizeF‹Comp⁄ít
) const

184 
UI¡
 
width
=
	`gëWidth
(
id
);

185 
I¡
 
blkX
 = ( 
iTønsUnôIdx
 * 
iBlkSizeF‹Comp⁄ít
 ) & ( 
width
 - 1 );

186 
I¡
 
blkY
 = ( 
iTønsUnôIdx
 * 
iBlkSizeF‹Comp⁄ít
 ) &~ ( 
width
 - 1 );

187 i‡(
m_chromaF‹m©IDC
==
CHROMA_422
 && 
id
!=
COMPONENT_Y
)

189 
blkY
<<=1;

191  
m_≠iBuf
[
id
] + 
blkX
 + 
blkY
 * 
iBlkSizeF‹Comp⁄ít
;

192 
	}
}

195 
Pñ
* 
	$gëAddrPix
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
UI¡
 
iPixX
, c⁄° UI¡ 
iPixY
 ) {  
m_≠iBuf
[id] + iPixY * 
	`gëSåide
(idË+ iPixX; 
	}
}

196 c⁄° 
Pñ
* 
	$gëAddrPix
 (c⁄° 
Comp⁄ítID
 
id
, c⁄° 
UI¡
 
iPixX
, c⁄° UI¡ 
iPixY
 ) c⁄° {  
m_≠iBuf
[id] + iPixY * 
	`gëSåide
(idË+ iPixX; 
	}
}

199 
UI¡
 
	$gëSåide
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_iWidth
 >> 
	`gëComp⁄ítSˇÀX
(id); 
	}
}

200 
UI¡
 
	$gëHeight
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_iHeight
 >> 
	`gëComp⁄ítSˇÀY
(id); 
	}
}

201 
UI¡
 
	$gëWidth
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_iWidth
 >> 
	`gëComp⁄ítSˇÀX
(id); 
	}
}

202 
ChromaF‹m©
 
	$gëChromaF‹m©
 (Ëc⁄° {  
m_chromaF‹m©IDC
; 
	}
}

203 
UI¡
 
	$gëNumbîVÆidComp⁄íts
 (Ëc⁄° {  ::
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
); 
	}
}

204 
UI¡
 
	$gëComp⁄ítSˇÀX
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  ::
	`gëComp⁄ítSˇÀX
(id, 
m_chromaF‹m©IDC
); 
	}
}

205 
UI¡
 
	$gëComp⁄ítSˇÀY
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  ::
	`gëComp⁄ítSˇÀY
(id, 
m_chromaF‹m©IDC
); 
	}
}

	@TLibCommon/TypeDef.h

38 #i‚de‡
__TYPEDEF__


39 
	#__TYPEDEF__


	)

41 #i‚de‡
__COMMONDEF__


42 #îr‹ 
In˛ude
 
Comm⁄Def
.
h
 
nŸ
 
Ty≥Def
.h

45 
	~<ve˘‹
>

46 
	~<utûôy
>

47 
	~<io°ªam
>

56 
	#DEBUG_STRING
 0

57 
	#DEBUG_ENCODER_SEARCH_BINS
 0

58 
	#DEBUG_CABAC_BINS
 0

59 
	#DEBUG_INTRA_SEARCH_COSTS
 0

60 
	#DEBUG_TRANSFORM_AND_QUANTISE
 0

61 

	)

62 
	#ENVIRONMENT_VARIABLE_DEBUG_AND_TEST
 0

63 
	#PRINT_MACRO_VALUES
 1

64 

	)

67 #i‚de‡
RExt__DECODER_DEBUG_BIT_STATISTICS


68 
	#RExt__DECODER_DEBUG_BIT_STATISTICS
 0

70 

	)

72 #i‚de‡
ENC_DEC_TRACE


73 
	#ENC_DEC_TRACE
 0

	)

75 
	#DEC_NUH_TRACE
 0

76 

	)

77 
	#PRINT_RPS_INFO
 0

78 

	)

79 
	#MCTS_EXTRACTION
 1

80 

	)

85 
	#JVET_K0390_RATE_CTRL
 1

	)

86 #i‡
JVET_K0390_RATE_CTRL


87 
	#JVET_M0600_RATE_CTRL
 1

	)

89 
	#DECODER_CHECK_SUBSTREAM_AND_SLICE_TRAILING_BYTES
 1

90 
	#MCTS_ENC_CHECK
 1

91 
	#SHUTTER_INTERVAL_SEI_MESSAGE
 1

92 
	#SEI_ENCODER_CONTROL
 1

93 
	#DPB_ENCODER_USAGE_CHECK
 1

94 
	#FGS_RDD5_ENABLE
 1

95 

	)

102 #i‚de‡
EXTENSION_360_VIDEO


103 
	#EXTENSION_360_VIDEO
 0

105 

	)

106 
	#REDUCED_ENCODER_MEMORY
 1

107 

	)

108 
	#ADAPTIVE_QP_SELECTION
 1

109 

	)

110 
	#AMP_ENC_SPEEDUP
 1

111 #i‡
AMP_ENC_SPEEDUP


	)

112 
	#AMP_MRG
 1

114 

	)

115 
	#FAST_BIT_EST
 1

116 

	)

117 
	#HHI_RQT_INTRA_SPEEDUP
 1

118 
	#HHI_RQT_INTRA_SPEEDUP_MOD
 0

119 

	)

120 #i‡
HHI_RQT_INTRA_SPEEDUP_MOD
 && !
HHI_RQT_INTRA_SPEEDUP


124 
	#MATRIX_MULT
 0

125 

	)

126 
	#O0043_BEST_EFFORT_DECODING
 0

127 

	)

128 
	#ME_ENABLE_ROUNDING_OF_MVS
 1

129 

	)

130 
	#RDOQ_CHROMA_LAMBDA
 1

131 

	)

133 #i‚de‡
RExt__HIGH_BIT_DEPTH_SUPPORT


134 
	#RExt__HIGH_BIT_DEPTH_SUPPORT
 0

136 

	)

137 #i‡
deföed
 
__SSE2__
 || deföed 
__AVX2__
 || deföed 
__AVX__
 || deföed 
_M_AMD64
 || deföed 
_M_X64


138 
	#VECTOR_CODING__INTERPOLATION_FILTER
 1

139 
	#VECTOR_CODING__DISTORTION_CALCULATIONS
 1

140 #ñ£

	)

141 
	#VECTOR_CODING__INTERPOLATION_FILTER
 0

142 
	#VECTOR_CODING__DISTORTION_CALCULATIONS
 0

144 

	)

149 #i‡
RExt__HIGH_BIT_DEPTH_SUPPORT


150 
	#FULL_NBIT
 1

151 
	#RExt__HIGH_PRECISION_FORWARD_TRANSFORM
 1

152 #ñ£

	)

153 
	#FULL_NBIT
 1

154 
	#RExt__HIGH_PRECISION_FORWARD_TRANSFORM
 0

156 

	)

157 #i‡
FULL_NBIT


158 
	#DISTORTION_PRECISION_ADJUSTMENT
(
x
Ë0

	)

160 
	#DISTORTION_PRECISION_ADJUSTMENT
(
x
Ë(x)

	)

163 #i‡
DEBUG_STRING


164 
	#DEBUG_STRING_PASS_INTO
(
«me
Ë, 
	)
name

165 
	#DEBUG_STRING_PASS_INTO_OPTIONAL
(
«me
, 
exp
Ë, (exp==0)?0:
	)
name

166 
	#DEBUG_STRING_FN_DECLARE
(
«me
Ë, 
°d
::
°rög
 &
	)
name

167 
	#DEBUG_STRING_FN_DECLAREP
(
«me
Ë, 
°d
::
°rög
 *
	)
name

168 
	#DEBUG_STRING_NEW
(
«me
Ë
°d
::
°rög
Çame;

	)

169 
	#DEBUG_STRING_OUTPUT
(
os
, 
«me
Ëo†<<Çame;

	)

170 
	#DEBUG_STRING_APPEND
(
°r1
, 
°r2
Ë°r1+=°r2;

	)

171 
	#DEBUG_STRING_SWAP
(
°r1
, 
°r2
Ë°r1.
	`sw≠
(°r2);

	)

172 
	#DEBUG_STRING_CHANNEL_CONDITION
(
compID
Ë(
åue
)

	)

173 
	~<s°ªam
>

174 
	~<iom™ù
>

176 
	#DEBUG_STRING_PASS_INTO
(
«me
)

	)

177 
	#DEBUG_STRING_PASS_INTO_OPTIONAL
(
«me
, 
exp
)

	)

178 
	#DEBUG_STRING_FN_DECLARE
(
«me
)

	)

179 
	#DEBUG_STRING_FN_DECLAREP
(
«me
)

	)

180 
	#DEBUG_STRING_NEW
(
«me
)

	)

181 
	#DEBUG_STRING_OUTPUT
(
os
, 
«me
)

	)

182 
	#DEBUG_STRING_APPEND
(
°r1
, 
°r2
)

	)

183 
	#DEBUG_STRING_SWAP
(
§t1
, 
°r2
)

	)

184 
	#DEBUG_STRING_CHANNEL_CONDITION
(
compID
)

	)

191 #i‡((
RExt__HIGH_PRECISION_FORWARD_TRANSFORM
 !0Ë&& (
RExt__HIGH_BIT_DEPTH_SUPPORT
 == 0))

192 #îr‹ 
ERROR
: 
ˇ¬Ÿ
 
íabÀ
 
RExt__HIGH_PRECISION_FORWARD_TRANSFORM
 
wôhout
 
RExt__HIGH_BIT_DEPTH_SUPPORT


199 
	tVoid
;

200 
boﬁ
 
	tBoﬁ
;

202 
	tTCh¨
;

203 sig√d 
	tSCh¨
;

204 
	tUCh¨
;

205 
	tSh‹t
;

206 
	tUSh‹t
;

207 
	tI¡
;

208 
	tUI¡
;

209 
	tDoubÀ
;

210 
	tFlﬂt
;

217 #ifde‡
_MSC_VER


218 
__öt64
 
	tI¡64
;

220 #i‡
_MSC_VER
 <= 1200

221 
__öt64
 
	tUI¡64
;

223 
	t__öt64
 
	tUI¡64
;

228 
	tI¡64
;

229 
	tUI¡64
;

237 #i‡
RExt__HIGH_BIT_DEPTH_SUPPORT


238 
I¡
 
	tPñ
;

239 
I¡64
 
	tTC€ff
;

240 
I¡
 
	tTM©rixC€ff
;

241 
Sh‹t
 
	tTFûãrC€ff
;

242 
I¡64
 
	tI¡îmedüã_I¡
;

243 
UI¡64
 
	tI¡îmedüã_UI¡
;

245 
Sh‹t
 
	tPñ
;

246 
I¡
 
	tTC€ff
;

247 
Sh‹t
 
	tTM©rixC€ff
;

248 
Sh‹t
 
	tTFûãrC€ff
;

249 
I¡
 
	tI¡îmedüã_I¡
;

250 
UI¡
 
	tI¡îmedüã_UI¡
;

253 #i‡
FULL_NBIT


254 
UI¡64
 
	tDi°‹ti⁄
;

256 
UI¡
 
	tDi°‹ti⁄
;

263 
	eRDPCMMode


265 
	mRDPCM_OFF
 = 0,

266 
	mRDPCM_HOR
 = 1,

267 
	mRDPCM_VER
 = 2,

268 
	mNUMBER_OF_RDPCM_MODES
 = 3

271 
	eRDPCMSig«ŒögMode


273 
	mRDPCM_SIGNAL_IMPLICIT
 = 0,

274 
	mRDPCM_SIGNAL_EXPLICIT
 = 1,

275 
	mNUMBER_OF_RDPCM_SIGNALLING_MODES
 = 2

279 
	eSli˚Ty≥


281 
	mB_SLICE
 = 0,

282 
	mP_SLICE
 = 1,

283 
	mI_SLICE
 = 2,

284 
	mNUMBER_OF_SLICE_TYPES
 = 3

288 
	eChromaF‹m©


290 
	mCHROMA_400
 = 0,

291 
	mCHROMA_420
 = 1,

292 
	mCHROMA_422
 = 2,

293 
	mCHROMA_444
 = 3,

294 
	mNUM_CHROMA_FORMAT
 = 4

297 
	eCh™√lTy≥


299 
	mCHANNEL_TYPE_LUMA
 = 0,

300 
	mCHANNEL_TYPE_CHROMA
 = 1,

301 
	mMAX_NUM_CHANNEL_TYPE
 = 2

304 
	eComp⁄ítID


306 
	mCOMPONENT_Y
 = 0,

307 
	mCOMPONENT_Cb
 = 1,

308 
	mCOMPONENT_Cr
 = 2,

309 
	mMAX_NUM_COMPONENT
 = 3

312 
	eI≈utCﬁourS∑˚C⁄vîsi⁄


314 
	mIPCOLOURSPACE_UNCHANGED
 = 0,

315 
	mIPCOLOURSPACE_YCbCπoYCrCb
 = 1,

316 
	mIPCOLOURSPACE_YCbCπoYYY
 = 2,

317 
	mIPCOLOURSPACE_RGBtoGBR
 = 3,

318 
	mNUMBER_INPUT_COLOUR_SPACE_CONVERSIONS
 = 4

321 
	eMATRIX_COEFFICIENTS


323 
	mMATRIX_COEFFICIENTS_RGB
 = 0,

324 
	mMATRIX_COEFFICIENTS_BT709
 = 1,

325 
	mMATRIX_COEFFICIENTS_UNSPECIFIED
 = 2,

326 
	mMATRIX_COEFFICIENTS_RESERVED_BY_ITUISOIEC
 = 3,

327 
	mMATRIX_COEFFICIENTS_USFCCT47
 = 4,

328 
	mMATRIX_COEFFICIENTS_BT601_625
 = 5,

329 
	mMATRIX_COEFFICIENTS_BT601_525
 = 6,

330 
	mMATRIX_COEFFICIENTS_SMPTE240
 = 7,

331 
	mMATRIX_COEFFICIENTS_YCGCO
 = 8,

332 
	mMATRIX_COEFFICIENTS_BT2020_NON_CONSTANT_LUMINANCE
 = 9,

333 
	mMATRIX_COEFFICIENTS_BT2020_CONSTANT_LUMINANCE
 = 10,

336 
	eDeblockEdgeDú


338 
	mEDGE_VER
 = 0,

339 
	mEDGE_HOR
 = 1,

340 
	mNUM_EDGE_DIR
 = 2

344 
	eP¨tSize


346 
	mSIZE_2Nx2N
 = 0,

347 
	mSIZE_2NxN
 = 1,

348 
	mSIZE_Nx2N
 = 2,

349 
	mSIZE_NxN
 = 3,

350 
	mSIZE_2NxnU
 = 4,

351 
	mSIZE_2NxnD
 = 5,

352 
	mSIZE_nLx2N
 = 6,

353 
	mSIZE_nRx2N
 = 7,

354 
	mNUMBER_OF_PART_SIZES
 = 8

358 
	ePªdMode


360 
	mMODE_INTER
 = 0,

361 
	mMODE_INTRA
 = 1,

362 
	mNUMBER_OF_PREDICTION_MODES
 = 2,

366 
	eRefPicLi°


368 
	mREF_PIC_LIST_0
 = 0,

369 
	mREF_PIC_LIST_1
 = 1,

370 
	mNUM_REF_PIC_LIST_01
 = 2,

371 
	mREF_PIC_LIST_X
 = 100

375 
	eDFunc


377 
	mDF_DEFAULT
 = 0,

378 
	mDF_SSE
 = 1,

379 
	mDF_SSE4
 = 2,

380 
	mDF_SSE8
 = 3,

381 
	mDF_SSE16
 = 4,

382 
	mDF_SSE32
 = 5,

383 
	mDF_SSE64
 = 6,

384 
	mDF_SSE16N
 = 7,

386 
	mDF_SAD
 = 8,

387 
	mDF_SAD4
 = 9,

388 
	mDF_SAD8
 = 10,

389 
	mDF_SAD16
 = 11,

390 
	mDF_SAD32
 = 12,

391 
	mDF_SAD64
 = 13,

392 
	mDF_SAD16N
 = 14,

394 
	mDF_SADS
 = 15,

395 
	mDF_SADS4
 = 16,

396 
	mDF_SADS8
 = 17,

397 
	mDF_SADS16
 = 18,

398 
	mDF_SADS32
 = 19,

399 
	mDF_SADS64
 = 20,

400 
	mDF_SADS16N
 = 21,

402 
	mDF_HADS
 = 22,

403 
	mDF_HADS4
 = 23,

404 
	mDF_HADS8
 = 24,

405 
	mDF_HADS16
 = 25,

406 
	mDF_HADS32
 = 26,

407 
	mDF_HADS64
 = 27,

408 
	mDF_HADS16N
 = 28,

410 
	mDF_SAD12
 = 43,

411 
	mDF_SAD24
 = 44,

412 
	mDF_SAD48
 = 45,

414 
	mDF_SADS12
 = 46,

415 
	mDF_SADS24
 = 47,

416 
	mDF_SADS48
 = 48,

418 
	mDF_SSE_FRAME
 = 50,

419 
	mDF_TOTAL_FUNCTIONS
 = 64

423 
	eCI_IDX


425 
	mCI_CURR_BEST
 = 0,

426 
	mCI_NEXT_BEST
,

427 
	mCI_TEMP_BEST
,

428 
	mCI_CHROMA_INTRA
,

429 
	mCI_QT_TRAFO_TEST
,

430 
	mCI_QT_TRAFO_ROOT
,

431 
	mCI_NUM
,

435 
	eMVP_DIR


437 
	mMD_LEFT
 = 0,

438 
	mMD_ABOVE
,

439 
	mMD_ABOVE_RIGHT
,

440 
	mMD_BELOW_LEFT
,

441 
	mMD_ABOVE_LEFT


444 
	eSt‹edResiduÆTy≥


446 
	mRESIDUAL_RECONSTRUCTED
 = 0,

447 
	mRESIDUAL_ENCODER_SIDE
 = 1,

448 
	mNUMBER_OF_STORED_RESIDUAL_TYPES
 = 2

451 
	eTønsf‹mDúe˘i⁄


453 
	mTRANSFORM_FORWARD
 = 0,

454 
	mTRANSFORM_INVERSE
 = 1,

455 
	mTRANSFORM_NUMBER_OF_DIRECTIONS
 = 2

459 
	eMESórchMëhod


461 
	mMESEARCH_FULL
 = 0,

462 
	mMESEARCH_DIAMOND
 = 1,

463 
	mMESEARCH_SELECTIVE
 = 2,

464 
	mMESEARCH_DIAMOND_ENHANCED
 = 3,

465 
	mMESEARCH_NUMBER_OF_METHODS
 = 4

469 
	eCOEFF_SCAN_TYPE


471 
	mSCAN_DIAG
 = 0,

472 
	mSCAN_HOR
 = 1,

473 
	mSCAN_VER
 = 2,

474 
	mSCAN_NUMBER_OF_TYPES
 = 3

477 
	eCOEFF_SCAN_GROUP_TYPE


479 
	mSCAN_UNGROUPED
 = 0,

480 
	mSCAN_GROUPED_4x4
 = 1,

481 
	mSCAN_NUMBER_OF_GROUP_TYPES
 = 2

484 
	eSignifiˇn˚M≠C⁄ãxtTy≥


486 
	mCONTEXT_TYPE_4x4
 = 0,

487 
	mCONTEXT_TYPE_8x8
 = 1,

488 
	mCONTEXT_TYPE_NxN
 = 2,

489 
	mCONTEXT_TYPE_SINGLE
 = 3,

490 
	mCONTEXT_NUMBER_OF_TYPES
 = 4

493 
	eSˇlögLi°Mode


495 
	mSCALING_LIST_OFF
,

496 
	mSCALING_LIST_DEFAULT
,

497 
	mSCALING_LIST_FILE_READ


500 
	eSˇlögLi°Size


502 
	mSCALING_LIST_4x4
 = 0,

503 
	mSCALING_LIST_8x8
,

504 
	mSCALING_LIST_16x16
,

505 
	mSCALING_LIST_32x32
,

506 
	mSCALING_LIST_SIZE_NUM


510 
	eSli˚C⁄°øöt


512 
	mNO_SLICES
 = 0,

513 
	mFIXED_NUMBER_OF_CTU
 = 1,

514 
	mFIXED_NUMBER_OF_BYTES
 = 2,

515 
	mFIXED_NUMBER_OF_TILES
 = 3,

516 
	mNUMBER_OF_SLICE_CONSTRAINT_MODES
 = 4

520 
	eHashTy≥


522 
	mHASHTYPE_MD5
 = 0,

523 
	mHASHTYPE_CRC
 = 1,

524 
	mHASHTYPE_CHECKSUM
 = 2,

525 
	mHASHTYPE_NONE
 = 3,

526 
	mNUMBER_OF_HASHTYPES
 = 4

529 
	eSAOMode


531 
	mSAO_MODE_OFF
 = 0,

532 
	mSAO_MODE_NEW
,

533 
	mSAO_MODE_MERGE
,

534 
	mNUM_SAO_MODES


537 
	eSAOModeMîgeTy≥s


539 
	mSAO_MERGE_LEFT
 =0,

540 
	mSAO_MERGE_ABOVE
,

541 
	mNUM_SAO_MERGE_TYPES


545 
	eSAOModeNewTy≥s


547 
	mSAO_TYPE_START_EO
 =0,

548 
	mSAO_TYPE_EO_0
 = 
SAO_TYPE_START_EO
,

549 
	mSAO_TYPE_EO_90
,

550 
	mSAO_TYPE_EO_135
,

551 
	mSAO_TYPE_EO_45
,

553 
	mSAO_TYPE_START_BO
,

554 
	mSAO_TYPE_BO
 = 
SAO_TYPE_START_BO
,

556 
	mNUM_SAO_NEW_TYPES


558 
	#NUM_SAO_EO_TYPES_LOG2
 2

	)

560 
	eSAOEOCœs£s


562 
	mSAO_CLASS_EO_FULL_VALLEY
 = 0,

563 
	mSAO_CLASS_EO_HALF_VALLEY
 = 1,

564 
	mSAO_CLASS_EO_PLAIN
 = 2,

565 
	mSAO_CLASS_EO_HALF_PEAK
 = 3,

566 
	mSAO_CLASS_EO_FULL_PEAK
 = 4,

567 
	mNUM_SAO_EO_CLASSES
,

570 
	#NUM_SAO_BO_CLASSES_LOG2
 5

	)

571 
	#NUM_SAO_BO_CLASSES
 (1<<
NUM_SAO_BO_CLASSES_LOG2
)

	)

573 
«me•a˚
 
	gProfûe


575 
	eName


577 
	gNONE
 = 0,

578 
	gMAIN
 = 1,

579 
	gMAIN10
 = 2,

580 
	gMAINSTILLPICTURE
 = 3,

581 
	gMAINREXT
 = 4,

582 
	gHIGHTHROUGHPUTREXT
 = 5

586 
«me•a˚
 
	gLevñ


588 
	eTõr


590 
	gMAIN
 = 0,

591 
	gHIGH
 = 1,

592 
	gNUMBER_OF_TIERS
 = 2

595 
	eName


598 
	gNONE
 = 0,

599 
	gLEVEL1
 = 30,

600 
	gLEVEL2
 = 60,

601 
	gLEVEL2_1
 = 63,

602 
	gLEVEL3
 = 90,

603 
	gLEVEL3_1
 = 93,

604 
	gLEVEL4
 = 120,

605 
	gLEVEL4_1
 = 123,

606 
	gLEVEL5
 = 150,

607 
	gLEVEL5_1
 = 153,

608 
	gLEVEL5_2
 = 156,

609 
	gLEVEL6
 = 180,

610 
	gLEVEL6_1
 = 183,

611 
	gLEVEL6_2
 = 186,

612 
	gLEVEL8_5
 = 255,

616 
	eCo°Mode


618 
	mCOST_STANDARD_LOSSY
 = 0,

619 
	mCOST_SEQUENCE_LEVEL_LOSSLESS
 = 1,

620 
	mCOST_LOSSLESS_CODING
 = 2,

621 
	mCOST_MIXED_LOSSLESS_LOSSY_CODING
 = 3

624 
	eWeighãdPªdi˘i⁄Mëhod


626 
	mWP_PER_PICTURE_WITH_SIMPLE_DC_COMBINED_COMPONENT
 =0,

627 
	mWP_PER_PICTURE_WITH_SIMPLE_DC_PER_COMPONENT
 =1,

628 
	mWP_PER_PICTURE_WITH_HISTOGRAM_AND_PER_COMPONENT
 =2,

629 
	mWP_PER_PICTURE_WITH_HISTOGRAM_AND_PER_COMPONENT_AND_CLIPPING
 =3,

630 
	mWP_PER_PICTURE_WITH_HISTOGRAM_AND_PER_COMPONENT_AND_CLIPPING_AND_EXTENSION
=4

633 
	eFa°I¡îSórchMode


635 
	mFASTINTERSEARCH_DISABLED
 = 0,

636 
	mFASTINTERSEARCH_MODE1
 = 1,

637 
	mFASTINTERSEARCH_MODE2
 = 2,

638 
	mFASTINTERSEARCH_MODE3
 = 3

641 
	eSPSExãnsi⁄FœgIndex


643 
	mSPS_EXT__REXT
 = 0,

646 
	mNUM_SPS_EXTENSION_FLAGS
 = 8

649 
	ePPSExãnsi⁄FœgIndex


651 
	mPPS_EXT__REXT
 = 0,

654 
	mNUM_PPS_EXTENSION_FLAGS
 = 8

660 
	eNÆUnôTy≥


662 
	mNAL_UNIT_CODED_SLICE_TRAIL_N
 = 0,

663 
	mNAL_UNIT_CODED_SLICE_TRAIL_R
,

665 
	mNAL_UNIT_CODED_SLICE_TSA_N
,

666 
	mNAL_UNIT_CODED_SLICE_TSA_R
,

668 
	mNAL_UNIT_CODED_SLICE_STSA_N
,

669 
	mNAL_UNIT_CODED_SLICE_STSA_R
,

671 
	mNAL_UNIT_CODED_SLICE_RADL_N
,

672 
	mNAL_UNIT_CODED_SLICE_RADL_R
,

674 
	mNAL_UNIT_CODED_SLICE_RASL_N
,

675 
	mNAL_UNIT_CODED_SLICE_RASL_R
,

677 
	mNAL_UNIT_RESERVED_VCL_N10
,

678 
	mNAL_UNIT_RESERVED_VCL_R11
,

679 
	mNAL_UNIT_RESERVED_VCL_N12
,

680 
	mNAL_UNIT_RESERVED_VCL_R13
,

681 
	mNAL_UNIT_RESERVED_VCL_N14
,

682 
	mNAL_UNIT_RESERVED_VCL_R15
,

684 
	mNAL_UNIT_CODED_SLICE_BLA_W_LP
,

685 
	mNAL_UNIT_CODED_SLICE_BLA_W_RADL
,

686 
	mNAL_UNIT_CODED_SLICE_BLA_N_LP
,

687 
	mNAL_UNIT_CODED_SLICE_IDR_W_RADL
,

688 
	mNAL_UNIT_CODED_SLICE_IDR_N_LP
,

689 
	mNAL_UNIT_CODED_SLICE_CRA
,

690 
	mNAL_UNIT_RESERVED_IRAP_VCL22
,

691 
	mNAL_UNIT_RESERVED_IRAP_VCL23
,

693 
	mNAL_UNIT_RESERVED_VCL24
,

694 
	mNAL_UNIT_RESERVED_VCL25
,

695 
	mNAL_UNIT_RESERVED_VCL26
,

696 
	mNAL_UNIT_RESERVED_VCL27
,

697 
	mNAL_UNIT_RESERVED_VCL28
,

698 
	mNAL_UNIT_RESERVED_VCL29
,

699 
	mNAL_UNIT_RESERVED_VCL30
,

700 
	mNAL_UNIT_RESERVED_VCL31
,

702 
	mNAL_UNIT_VPS
,

703 
	mNAL_UNIT_SPS
,

704 
	mNAL_UNIT_PPS
,

705 
	mNAL_UNIT_ACCESS_UNIT_DELIMITER
,

706 
	mNAL_UNIT_EOS
,

707 
	mNAL_UNIT_EOB
,

708 
	mNAL_UNIT_FILLER_DATA
,

709 
	mNAL_UNIT_PREFIX_SEI
,

710 
	mNAL_UNIT_SUFFIX_SEI
,

712 
	mNAL_UNIT_RESERVED_NVCL41
,

713 
	mNAL_UNIT_RESERVED_NVCL42
,

714 
	mNAL_UNIT_RESERVED_NVCL43
,

715 
	mNAL_UNIT_RESERVED_NVCL44
,

716 
	mNAL_UNIT_RESERVED_NVCL45
,

717 
	mNAL_UNIT_RESERVED_NVCL46
,

718 
	mNAL_UNIT_RESERVED_NVCL47
,

719 
	mNAL_UNIT_UNSPECIFIED_48
,

720 
	mNAL_UNIT_UNSPECIFIED_49
,

721 
	mNAL_UNIT_UNSPECIFIED_50
,

722 
	mNAL_UNIT_UNSPECIFIED_51
,

723 
	mNAL_UNIT_UNSPECIFIED_52
,

724 
	mNAL_UNIT_UNSPECIFIED_53
,

725 
	mNAL_UNIT_UNSPECIFIED_54
,

726 
	mNAL_UNIT_UNSPECIFIED_55
,

727 
	mNAL_UNIT_UNSPECIFIED_56
,

728 
	mNAL_UNIT_UNSPECIFIED_57
,

729 
	mNAL_UNIT_UNSPECIFIED_58
,

730 
	mNAL_UNIT_UNSPECIFIED_59
,

731 
	mNAL_UNIT_UNSPECIFIED_60
,

732 
	mNAL_UNIT_UNSPECIFIED_61
,

733 
	mNAL_UNIT_UNSPECIFIED_62
,

734 
	mNAL_UNIT_UNSPECIFIED_63
,

735 
	mNAL_UNIT_INVALID
,

738 
	eLumaLevñToDQPMode


740 
	mLUMALVL_TO_DQP_DISABLED
 = 0,

741 
	mLUMALVL_TO_DQP_AVG_METHOD
 = 1,

742 
	mLUMALVL_TO_DQP_MAX_METHOD
 = 2,

743 
	mLUMALVL_TO_DQP_NUM_MODES
 = 3

751 
˛ass
 
	gTComPicSym
;

753 
	#MAX_NUM_SAO_CLASSES
 32

754 

	)

755 
	sSAOOff£t


757 
SAOMode
 
	mmodeIdc
;

758 
I¡
 
	mty≥Idc
;

759 
I¡
 
	mty≥AuxInfo
;

760 
I¡
 
	moff£t
[
MAX_NUM_SAO_CLASSES
];

762 
SAOOff£t
();

763 ~
SAOOff£t
();

764 
Void
 
ª£t
();

766 c⁄° 
	mSAOOff£t
& 
	m›î©‹
(c⁄° 
SAOOff£t
& 
§c
);

769 
	sSAOBlkP¨am


772 
SAOBlkP¨am
();

773 ~
SAOBlkP¨am
();

774 
Void
 
ª£t
();

775 c⁄° 
	mSAOBlkP¨am
& 
	m›î©‹
(c⁄° 
SAOBlkP¨am
& 
§c
);

776 
	mSAOOff£t
& 
	m›î©‹
[](
I¡
 
	mcompIdx
){  
	moff£tP¨am
[
compIdx
];}

777 
	m¥iv©e
:

778 
SAOOff£t
 
off£tP¨am
[
MAX_NUM_COMPONENT
];

783 
	sBôDïths


785 #i‡
O0043_BEST_EFFORT_DECODING


786 
I¡
 
	mªc⁄
[
MAX_NUM_CHANNEL_TYPE
];

787 
I¡
 
	m°ªam
[
MAX_NUM_CHANNEL_TYPE
];

789 
I¡
 
	mªc⁄
[
MAX_NUM_CHANNEL_TYPE
];

794 
	s_LFCUP¨am


796 
Boﬁ
 
	mbI¡î«lEdge
;

797 
Boﬁ
 
	mbLe·Edge
;

798 
Boﬁ
 
	mbT›Edge
;

799 } 
	tLFCUP¨am
;

804 
	sTUE¡r›yCodögP¨amëîs


806 c⁄° 
UI¡
 *
	msˇn
;

807 c⁄° 
UI¡
 *
	msˇnCG
;

808 
COEFF_SCAN_TYPE
 
	msˇnTy≥
;

809 
UI¡
 
	mwidthInGroups
;

810 
UI¡
 
	mheightInGroups
;

811 
UI¡
 
	mfú°Signifiˇn˚M≠C⁄ãxt
;

815 
	sTComPi˘uªHash


817 
	m°d
::
ve˘‹
<
UCh¨
> 
hash
;

819 
Boﬁ
 
	m›î©‹
==(c⁄° 
TComPi˘uªHash
 &
Ÿhî
) const

821 i‡(
Ÿhî
.
hash
.
size
() != hash.size())

823  
Ál£
;

825 
UI¡
 
	mi
=0; i<UI¡(
hash
.
size
()); i++)

827 i‡(
	mŸhî
.
	mhash
[
i
] !
hash
[i])

829  
Ál£
;

832  
	måue
;

835 
Boﬁ
 
	m›î©‹
!=(c⁄° 
TComPi˘uªHash
 &
Ÿhî
) const

837  !(*
this
 =
Ÿhî
);

841 
	sTComSEITimeSë


843 
TComSEITimeSë
(Ë: 
˛ockTimeSèmpFœg
(
Ál£
),

844 
numUnôFõldBa£dFœg
(
Ál£
),

845 
cou¡ögTy≥
(0),

846 
fuŒTimeSèmpFœg
(
Ál£
),

847 
disc⁄töuôyFœg
(
Ál£
),

848 
˙tDr›≥dFœg
(
Ál£
),

849 
numbîOfFømes
(0),

850 
£c⁄dsVÆue
(0),

851 
möuãsVÆue
(0),

852 
hoursVÆue
(0),

853 
£c⁄dsFœg
(
Ál£
),

854 
möuãsFœg
(
Ál£
),

855 
hoursFœg
(
Ál£
),

856 
timeOff£tLígth
(0),

857 
timeOff£tVÆue
(0)

859 
Boﬁ
 
	m˛ockTimeSèmpFœg
;

860 
Boﬁ
 
	mnumUnôFõldBa£dFœg
;

861 
I¡
 
	mcou¡ögTy≥
;

862 
Boﬁ
 
	mfuŒTimeSèmpFœg
;

863 
Boﬁ
 
	mdisc⁄töuôyFœg
;

864 
Boﬁ
 
	m˙tDr›≥dFœg
;

865 
I¡
 
	mnumbîOfFømes
;

866 
I¡
 
	m£c⁄dsVÆue
;

867 
I¡
 
	mmöuãsVÆue
;

868 
I¡
 
	mhoursVÆue
;

869 
Boﬁ
 
	m£c⁄dsFœg
;

870 
Boﬁ
 
	mmöuãsFœg
;

871 
Boﬁ
 
	mhoursFœg
;

872 
I¡
 
	mtimeOff£tLígth
;

873 
I¡
 
	mtimeOff£tVÆue
;

876 
	sTComSEIMa°îögDi•œy


878 
Boﬁ
 
	mcﬁourVﬁumeSEIE«bÀd
;

879 
UI¡
 
	mmaxLumö™˚
;

880 
UI¡
 
	mmöLumö™˚
;

881 
USh‹t
 
	m¥im¨õs
[3][2];

882 
USh‹t
 
	mwhôePoöt
[2];

885 
	sLumaLevñToDñèQPM≠pög


887 
LumaLevñToDQPMode
 
	mmode
;

888 
DoubÀ
 
	mmaxMëhodWeight
;

889 
	m°d
::
ve˘‹
< 
°d
::
∑ú
<
I¡
, 
	mI¡
> > 
	mm≠pög
;

890 
Boﬁ
 
isE«bÀd
(Ëc⁄° {  
	mmode
!=
LUMALVL_TO_DQP_DISABLED
; }

893 
	sWCGChromaQPC⁄åﬁ


895 
Boﬁ
 
isE«bÀd
(Ëc⁄° {  
	míabÀd
; }

896 
Boﬁ
 
	míabÀd
;

897 
DoubÀ
 
	mchromaCbQpSˇÀ
;

898 
DoubÀ
 
	mchromaCrQpSˇÀ
;

899 
DoubÀ
 
	mchromaQpSˇÀ
;

900 
DoubÀ
 
	mchromaQpOff£t
;

903 
	sTComSEIFisheyeVideoInfo


905 
	sA˘iveAªaInfo


907 
UI¡
 
	mm_fisheyeCúcuœrRegi⁄CíåeX
;

908 
UI¡
 
	mm_fisheyeCúcuœrRegi⁄CíåeY
;

909 
UI¡
 
	mm_fisheyeRe˘Regi⁄T›
;

910 
UI¡
 
	mm_fisheyeRe˘Regi⁄Le·
;

911 
UI¡
 
	mm_fisheyeRe˘Regi⁄Width
;

912 
UI¡
 
	mm_fisheyeRe˘Regi⁄Height
;

913 
UI¡
 
	mm_fisheyeCúcuœrRegi⁄Radius
;

914 
UI¡
 
	mm_fisheyeS˚√Radius
;

916 
I¡
 
	mm_fisheyeCamîaCíåeAzimuth
;

917 
I¡
 
	mm_fisheyeCamîaCíåeEÀv©i⁄
;

918 
I¡
 
	mm_fisheyeCamîaCíåeTût
;

919 
UI¡
 
	mm_fisheyeCamîaCíåeOff£tX
;

920 
UI¡
 
	mm_fisheyeCamîaCíåeOff£tY
;

921 
UI¡
 
	mm_fisheyeCamîaCíåeOff£tZ
;

922 
UI¡
 
	mm_fisheyeFõldOfVõw
;

923 
	m°d
::
ve˘‹
<
I¡
> 
m_fisheyePﬁynomülC€ff
;

926 
Boﬁ
 
	mm_fisheyeC™˚lFœg
;

927 
Boﬁ
 
	mm_fisheyePîsi°í˚Fœg
;

928 
UI¡
 
	mm_fisheyeVõwDimísi⁄Idc
;

929 
	m°d
::
ve˘‹
<
A˘iveAªaInfo
> 
m_fisheyeA˘iveAªas
;

930 
TComSEIFisheyeVideoInfo
(Ë: 
m_fisheyeC™˚lFœg
(
Ál£
), 
m_fisheyePîsi°í˚Fœg
(Ál£), 
m_fisheyeVõwDimísi⁄Idc
(0), 
m_fisheyeA˘iveAªas
() { }

933 ˛as†
	cWödow


935 
	m¥iv©e
:

936 
Boﬁ
 
m_íabÀdFœg
;

937 
I¡
 
	mm_wöLe·Off£t
;

938 
I¡
 
	mm_wöRightOff£t
;

939 
I¡
 
	mm_wöT›Off£t
;

940 
I¡
 
	mm_wöBŸtomOff£t
;

941 
	mpublic
:

942 
	$Wödow
()

943 : 
	`m_íabÀdFœg
 (
Ál£
)

944 , 
	`m_wöLe·Off£t
 (0)

945 , 
	`m_wöRightOff£t
 (0)

946 , 
	`m_wöT›Off£t
 (0)

947 , 
	$m_wöBŸtomOff£t
(0)

950 
Boﬁ
 
	$gëWödowE«bÀdFœg
(Ëc⁄° {  
m_íabÀdFœg
; 
	}
}

951 
I¡
 
	$gëWödowLe·Off£t
(Ëc⁄° {  
m_íabÀdFœg
 ? 
m_wöLe·Off£t
 : 0; 
	}
}

952 
Void
 
	$£tWödowLe·Off£t
(
I¡
 
vÆ
Ë{ 
m_wöLe·Off£t
 = vÆ; 
m_íabÀdFœg
 = 
åue
; 
	}
}

953 
I¡
 
	$gëWödowRightOff£t
(Ëc⁄° {  
m_íabÀdFœg
 ? 
m_wöRightOff£t
 : 0; 
	}
}

954 
Void
 
	$£tWödowRightOff£t
(
I¡
 
vÆ
Ë{ 
m_wöRightOff£t
 = vÆ; 
m_íabÀdFœg
 = 
åue
; 
	}
}

955 
I¡
 
	$gëWödowT›Off£t
(Ëc⁄° {  
m_íabÀdFœg
 ? 
m_wöT›Off£t
 : 0; 
	}
}

956 
Void
 
	$£tWödowT›Off£t
(
I¡
 
vÆ
Ë{ 
m_wöT›Off£t
 = vÆ; 
m_íabÀdFœg
 = 
åue
; 
	}
}

957 
I¡
 
	$gëWödowBŸtomOff£t
(Ëc⁄° {  
m_íabÀdFœg
 ? 
m_wöBŸtomOff£t
: 0; 
	}
}

958 
Void
 
	$£tWödowBŸtomOff£t
(
I¡
 
vÆ
Ë{ 
m_wöBŸtomOff£t
 = vÆ; 
m_íabÀdFœg
 = 
åue
; 
	}
}

960 
Void
 
	$£tWödow
(
I¡
 
off£tLe·
, I¡ 
off£tLRight
, I¡ 
off£tLT›
, I¡ 
off£tLBŸtom
)

962 
m_íabÀdFœg
 = 
åue
;

963 
m_wöLe·Off£t
 = 
off£tLe·
;

964 
m_wöRightOff£t
 = 
off£tLRight
;

965 
m_wöT›Off£t
 = 
off£tLT›
;

966 
m_wöBŸtomOff£t
 = 
off£tLBŸtom
;

967 
	}
}

968 
Boﬁ
 
	g›î©‹
 =(c⁄° 
Wödow
 &
rhs
) const

970  ( 
m_íabÀdFœg
 && 
rhs
.m_enabledFlag &&

971 
m_wöLe·Off£t
 =
rhs
.m_winLeftOffset &&

972 
m_wöRightOff£t
 =
rhs
.m_winRightOffset &&

973 
m_wöT›Off£t
 =
rhs
.m_winTopOffset &&

974 
m_wöBŸtomOff£t
 =
rhs
.m_winBottomOffset

979 ˛as†
	cRNSEIWödow
 : 
public
 
Wödow


981 
¥iv©e
:

982 
UI¡
 
m_ªgi⁄Id
;

983 
	mpublic
:

984 
	$RNSEIWödow
(Ë: 
	`Wödow
(), 
	$m_ªgi⁄Id
(0) {}

985 
I¡
 
	$gëRegi⁄Id
(Ëc⁄° {  
	`gëWödowE«bÀdFœg
(Ë? 
m_ªgi⁄Id
 : 0; 
	}
}

986 
Void
 
	$£tRegi⁄Id
(
UI¡
 c⁄° 
vÆ
Ë{ 
m_ªgi⁄Id
 = vÆ; 
	}
}

988 
Boﬁ
 
	g›î©‹
 =(
RNSEIWödow
 c⁄° &
rhs
) const

990  ( (
m_ªgi⁄Id
 =
rhs
.m_regionId) &&

991 
Wödow
(*
this
Ë=Wödow(
rhs
) );

994 
Boﬁ
 
	$checkSameRegi⁄
(
RNSEIWödow
 c⁄° &
rhs
) const

996  ( 
	`Wödow
(*
this
Ë=Wödow(
rhs
) );

997 
	}
}

998 
Boﬁ
 
	$checkSameID
(
RNSEIWödow
 c⁄° &
rhs
) const

1000  ( 
m_ªgi⁄Id
 =
rhs
.m_regionId );

1001 
	}
}

1002 
‰õnd
 
	g°d
::
o°ªam
& 
›î©‹
<<(
°d
::o°ªam &
os
, 
RNSEIWödow
 c⁄° &
	gªgi⁄
);

1004 
	g°d
::
	tve˘‹
<
	tRNSEIWödow
> 
	tRNSEIWödowVec
;

	@TLibDecoder/AnnexBread.cpp

40 
	~<°döt.h
>

41 
	~<ˇs£π
>

42 
	~<ve˘‹
>

43 
	~"A¬exBªad.h
"

44 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


45 
	~"TLibComm⁄/TComCodögSèti°ics.h
"

48 
usög
 
«me•a˚
 
	g°d
;

61 
Void


62 
_byãSåómNALUnô
(

63 
I≈utByãSåóm
& 
bs
,

64 
ve˘‹
<
uöt8_t
>& 
«lUnô
,

65 
A¬exBSèts
& 
°©s
)

75 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


76 
	gTComCodögSèti°ics
::
SSèt
 &
°©Bôs
=
TComCodögSèti°ics
::
GëSèti°icEP
(
STATS__NAL_UNIT_PACKING
);

78 (
	gbs
.
eofBef‹eNByãs
(24/8Ë|| bs.
≥ekByãs
(24/8) != 0x000001)

79 && (
bs
.
eofBef‹eNByãs
(32/8Ë|| bs.
≥ekByãs
(32/8) != 0x00000001))

81 
uöt8_t
 
Àadög_zîo_8bôs
 = 
bs
.
ªadByã
();

82 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


83 
	g°©Bôs
.
	gbôs
+=8; sètBôs.
	gcou¡
++;

85 
as£π
(
Àadög_zîo_8bôs
 == 0);

86 
	g°©s
.
	gm_numLódögZîo8BôsByãs
++;

97 i‡(
	gbs
.
≥ekByãs
(24/8) != 0x000001)

99 
uöt8_t
 
zîo_byã
 = 
bs
.
ªadByã
();

100 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


101 
	g°©Bôs
.
	gbôs
+=8; sètBôs.
	gcou¡
++;

103 
as£π
(
zîo_byã
 == 0);

104 
	g°©s
.
	gm_numZîoByãByãs
++;

113 
uöt32_t
 
	g°¨t_code_¥efix_⁄e_3byãs
 = 
bs
.
ªadByãs
(24/8);

114 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


115 
	g°©Bôs
.
	gbôs
+=24; sètBôs.
	gcou¡
+=3;

117 
as£π
(
°¨t_code_¥efix_⁄e_3byãs
 == 0x000001);

118 
	g°©s
.
	gm_numSèπCodePªfixByãs
 += 3;

134 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


135 
	gTComCodögSèti°ics
::
SSèt
 &
bodySèts
=
TComCodögSèti°ics
::
GëSèti°icEP
(
STATS__NAL_UNIT_TOTAL_BODY
);

137 
	gbs
.
eofBef‹eNByãs
(24/8Ë|| bs.
≥ekByãs
(24/8) > 2)

139 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


140 
uöt8_t
 
	gthebyã
=
bs
.
ªadByã
();
	gbodySèts
.
	gbôs
+=8;bodySèts.
	gcou¡
++;

141 
	g«lUnô
.
push_back
(
thebyã
);

143 
	g«lUnô
.
push_back
(
bs
.
ªadByã
());

162 (
	gbs
.
eofBef‹eNByãs
(24/8Ë|| bs.
≥ekByãs
(24/8) != 0x000001)

163 && (
bs
.
eofBef‹eNByãs
(32/8Ë|| bs.
≥ekByãs
(32/8) != 0x00000001))

165 
uöt8_t
 
åaûög_zîo_8bôs
 = 
bs
.
ªadByã
();

166 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


167 
	g°©Bôs
.
	gbôs
+=8; sètBôs.
	gcou¡
++;

169 
as£π
(
åaûög_zîo_8bôs
 == 0);

170 
	g°©s
.
	gm_numTøûögZîo8BôsByãs
++;

181 
Boﬁ


182 
byãSåómNALUnô
(

183 
I≈utByãSåóm
& 
bs
,

184 
ve˘‹
<
uöt8_t
>& 
«lUnô
,

185 
A¬exBSèts
& 
°©s
)

187 
Boﬁ
 
	geof
 = 
Ál£
;

188 
	gåy


190 
_byãSåómNALUnô
(
bs
, 
«lUnô
, 
°©s
);

192 
ˇtch
 (...)

194 
	geof
 = 
åue
;

196 
	g°©s
.
	gm_numByãsInNALUnô
 = 
UI¡
(
«lUnô
.
size
());

197  
	geof
;

	@TLibDecoder/AnnexBread.h

39 #¥agm®
⁄˚


41 #i‚de‡
__ANNEXBREAD__


42 
	#__ANNEXBREAD__


	)

44 
	~<°döt.h
>

45 
	~<i°ªam
>

46 
	~<ve˘‹
>

48 
	~"TLibComm⁄/Comm⁄Def.h
"

53 ˛as†
	cI≈utByãSåóm


55 
	mpublic
:

65 
	$I≈utByãSåóm
(
°d
::
i°ªam
& istream)

66 : 
	`m_NumFutuªByãs
(0)

67 , 
	`m_FutuªByãs
(0)

68 , 
	$m_I≈ut
(
i°ªam
)

70 
i°ªam
.
	`ex˚±i⁄s
(
°d
::i°ªam::
eofbô
 | std::i°ªam::
badbô
);

77 
Void
 
	$ª£t
()

79 
m_NumFutuªByãs
 = 0;

80 
m_FutuªByãs
 = 0;

81 
	}
}

87 
Boﬁ
 
	$eofBef‹eNByãs
(
UI¡
 
n
)

89 
	`as£π
(
n
 <= 4);

90 i‡(
m_NumFutuªByãs
 >
n
)

92  
Ál£
;

95 
n
 -
m_NumFutuªByãs
;

96 
åy


98 
UI¡
 
i
 = 0; i < 
n
; i++)

100 
m_FutuªByãs
 = (m_FutuªByã†<< 8Ë| 
m_I≈ut
.
	`gë
();

101 
m_NumFutuªByãs
++;

104 
	`ˇtch
 (...)

106  
åue
;

108  
Ál£
;

109 
	}
}

123 
uöt32_t
 
	$≥ekByãs
(
UI¡
 
n
)

125 
	`eofBef‹eNByãs
(
n
);

126  
m_FutuªByãs
 >> 8*(
m_NumFutuªByãs
 - 
n
);

127 
	}
}

135 
uöt8_t
 
	$ªadByã
()

137 i‡(!
m_NumFutuªByãs
)

139 
uöt8_t
 
byã
 = 
m_I≈ut
.
	`gë
();

140  
byã
;

142 
m_NumFutuªByãs
--;

143 
uöt8_t
 
w™ãd_byã
 = 
m_FutuªByãs
 >> 8*
m_NumFutuªByãs
;

144 
m_FutuªByãs
 &~(0xf‡<< 8*
m_NumFutuªByãs
);

145  
w™ãd_byã
;

146 
	}
}

153 
uöt32_t
 
	$ªadByãs
(
UI¡
 
n
)

155 
uöt32_t
 
vÆ
 = 0;

156 
UI¡
 
i
 = 0; i < 
n
; i++)

158 
vÆ
 = (vÆ << 8Ë| 
	`ªadByã
();

160  
vÆ
;

161 
	}
}

163 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


164 
UI¡
 
	$GëNumBuf„ªdByãs
(Ëc⁄° {  
m_NumFutuªByãs
; 
	}
}

167 
	g¥iv©e
:

168 
UI¡
 
m_NumFutuªByãs
;

169 
uöt32_t
 
	gm_FutuªByãs
;

170 
	g°d
::
i°ªam
& 
m_I≈ut
;

176 
	sA¬exBSèts


178 
UI¡
 
	mm_numLódögZîo8BôsByãs
;

179 
UI¡
 
	mm_numZîoByãByãs
;

180 
UI¡
 
	mm_numSèπCodePªfixByãs
;

181 
UI¡
 
	mm_numByãsInNALUnô
;

182 
UI¡
 
	mm_numTøûögZîo8BôsByãs
;

184 
	mA¬exBSèts
& 
	m›î©‹
+=(c⁄° 
A¬exBSèts
& 
rhs
)

186 
this
->
m_numLódögZîo8BôsByãs
 +
rhs
.m_numLeadingZero8BitsBytes;

187 
	mthis
->
	mm_numZîoByãByãs
 +
rhs
.
m_numZîoByãByãs
;

188 
	mthis
->
	mm_numSèπCodePªfixByãs
 +
rhs
.
m_numSèπCodePªfixByãs
;

189 
	mthis
->
	mm_numByãsInNALUnô
 +
rhs
.
m_numByãsInNALUnô
;

190 
	mthis
->
	mm_numTøûögZîo8BôsByãs
 +
rhs
.
m_numTøûögZîo8BôsByãs
;

191  *
	mthis
;

195 
Boﬁ
 
byãSåómNALUnô
(
I≈utByãSåóm
& 
bs
, 
°d
::
ve˘‹
<
uöt8_t
>& 
«lUnô
, 
A¬exBSèts
& 
°©s
);

	@TLibDecoder/NALread.cpp

40 
	~<ve˘‹
>

41 
	~<Æg‹ôhm
>

42 
	~<o°ªam
>

44 
	~"NALªad.h
"

45 
	~"TLibComm⁄/NAL.h
"

46 
	~"TLibComm⁄/TComBôSåóm.h
"

47 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


48 
	~"TLibComm⁄/TComCodögSèti°ics.h
"

50 #i‡
ENC_DEC_TRACE
 && 
DEC_NUH_TRACE


51 
	~"TLibComm⁄/TComRom.h
"

54 
usög
 
«me•a˚
 
	g°d
;

58 
Void
 
c⁄vîtPaylﬂdToRBSP
(
ve˘‹
<
uöt8_t
>& 
«lUnôBuf
, 
TComI≈utBô°ªam
 *
bô°ªam
, 
Boﬁ
 
isV˛NÆUnô
)

60 
UI¡
 
	gzîoCou¡
 = 0;

61 
	gve˘‹
<
	guöt8_t
>::
ôî©‹
 
ô_ªad
, 
	gô_wrôe
;

63 
UI¡
 
	gpos
 = 0;

64 
	gbô°ªam
->
˛órEmuœti⁄Pªvíti⁄ByãLoˇti⁄
();

65 
	gô_ªad
 = 
ô_wrôe
 = 
«lUnôBuf
.
begö
(); it_ªad !«lUnôBuf.
íd
(); it_ªad++, 
	gô_wrôe
++, 
	gpos
++)

67 
as£π
(
zîoCou¡
 < 2 || *
ô_ªad
 >= 0x03);

68 i‡(
	gzîoCou¡
 =2 && *
ô_ªad
 == 0x03)

70 
bô°ªam
->
pushEmuœti⁄Pªvíti⁄ByãLoˇti⁄
–
pos
 );

71 
	gpos
++;

72 
	gô_ªad
++;

73 
	gzîoCou¡
 = 0;

74 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


75 
	gTComCodögSèti°ics
::
In¸emítSèti°icEP
(
STATS__EMULATION_PREVENTION_3_BYTES
, 8, 0);

77 i‡(
	gô_ªad
 =
«lUnôBuf
.
íd
())

81 
as£π
(*
ô_ªad
 <= 0x03);

83 
	gzîoCou¡
 = (*
ô_ªad
 =0x00Ë? 
zîoCou¡
+1 : 0;

84 *
	gô_wrôe
 = *
ô_ªad
;

86 
as£π
(
zîoCou¡
 == 0);

88 i‡(
	gisV˛NÆUnô
)

91 
I¡
 
	gn
 = 0;

93 
	gô_wrôe
[-1] == 0x00)

95 
ô_wrôe
--;

96 
	gn
++;

99 i‡(
	gn
 > 0)

101 
¥ötf
("\nDëe˘ed %d in°™˚†o‡ˇbac_zîo_w‹d\n", 
n
/2);

105 
	g«lUnôBuf
.
ªsize
(
ô_wrôe
 - 
«lUnôBuf
.
begö
());

108 #i‡
ENC_DEC_TRACE
 && 
DEC_NUH_TRACE


109 
	$xTø˚NÆUnôHódî
(
I≈utNALUnô
& 
«lu
)

111 
	`Ârötf
–
g_hTø˚
, "*********** NAL UNIT (%sË***********\n", 
	`«lUnôTy≥ToSåög
(
«lu
.
m_«lUnôTy≥
) );

113 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

114 
	`Ârötf
–
g_hTø˚
, "%-50s u(%d) : %u\n", "forbidden_zero_bit", 1, 0 );

116 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

117 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË : %u\n", "«l_unô_ty≥", 6, 
«lu
.
m_«lUnôTy≥
 );

119 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

120 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË : %u\n", "nuh_œyî_id", 6, 
«lu
.
m_nuhLayîId
 );

122 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

123 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË : %u\n", "nuh_ãmp‹Æ_id_∂us1", 3, 
«lu
.
m_ãmp‹ÆId
 + 1 );

125 
	`fÊush
 ( 
g_hTø˚
 );

126 
	}
}

129 
Void
 
	$ªadNÆUnôHódî
(
I≈utNALUnô
& 
«lu
)

131 
TComI≈utBô°ªam
& 
bs
 = 
«lu
.
	`gëBô°ªam
();

133 
Boﬁ
 
f‹biddí_zîo_bô
 = 
bs
.
	`ªad
(1);

134 
	`as£π
(
f‹biddí_zîo_bô
 == 0);

135 
«lu
.
m_«lUnôTy≥
 = (
NÆUnôTy≥
Ë
bs
.
	`ªad
(6);

136 
«lu
.
m_nuhLayîId
 = 
bs
.
	`ªad
(6);

137 
«lu
.
m_ãmp‹ÆId
 = 
bs
.
	`ªad
(3) - 1;

138 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


139 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
STATS__NAL_UNIT_HEADER_BITS
, 1+6+6+3, 0);

142 #i‡
ENC_DEC_TRACE
 && 
DEC_NUH_TRACE


143 
	`xTø˚NÆUnôHódî
(
«lu
);

147 i‡(
«lu
.
m_nuhLayîId
 == 0)

149 i‡–
«lu
.
m_ãmp‹ÆId
 )

151 
	`as£π
–
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_BLA_W_LP


152 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_BLA_W_RADL


153 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_BLA_N_LP


154 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_IDR_W_RADL


155 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_IDR_N_LP


156 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_CRA


157 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_VPS


158 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_SPS


159 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_EOS


160 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_EOB
 );

164 
	`as£π
–
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_TSA_R


165 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_TSA_N


166 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_STSA_R


167 && 
«lu
.
m_«lUnôTy≥
 !
NAL_UNIT_CODED_SLICE_STSA_N
 );

170 
	}
}

175 
Void
 
	$ªad
(
I≈utNALUnô
& 
«lu
)

177 
TComI≈utBô°ªam
 &
bô°ªam
 = 
«lu
.
	`gëBô°ªam
();

178 
ve˘‹
<
uöt8_t
>& 
«lUnôBuf
=
bô°ªam
.
	`gëFifo
();

180 
	`c⁄vîtPaylﬂdToRBSP
(
«lUnôBuf
, &
bô°ªam
, (nalUnitBuf[0] & 64) == 0);

181 
bô°ªam
.
	`ª£tToSèπ
();

182 
	`ªadNÆUnôHódî
(
«lu
);

183 
	}
}

	@TLibDecoder/NALread.h

39 #¥agm®
⁄˚


41 #i‚de‡
__NALREAD__


42 
	#__NALREAD__


	)

44 
	~"TLibComm⁄/Comm⁄Def.h
"

45 
	~"TLibComm⁄/TComBôSåóm.h
"

46 
	~"TLibComm⁄/NAL.h
"

55 ˛as†
	cI≈utNALUnô
 : 
public
 
NALUnô


57 
¥iv©e
:

58 
TComI≈utBô°ªam
 
m_Bô°ªam
;

60 
	mpublic
:

61 
	$I≈utNALUnô
(c⁄° 
I≈utNALUnô
 &
§c
Ë: 
	`NALUnô
(§c), 
	$m_Bô°ªam
(
§c
.
m_Bô°ªam
) {};

62 
	$I≈utNALUnô
(Ë: 
	$m_Bô°ªam
(Ë{
	}
};

63 
	gvútuÆ
 ~
	$I≈utNALUnô
(Ë{ 
	}
}

64 c⁄° 
	gTComI≈utBô°ªam
 &
	$gëBô°ªam
(Ëc⁄° {  
m_Bô°ªam
; 
	}
}

65 
	gTComI≈utBô°ªam
 &
	$gëBô°ªam
(Ë{  
m_Bô°ªam
; 
	}
}

68 
Void
 
ªad
(
I≈utNALUnô
& 
«lu
);

69 
Void
 
ªadNÆUnôHódî
(
I≈utNALUnô
& 
«lu
);

	@TLibDecoder/SEIread.cpp

39 
	~"TLibComm⁄/Comm⁄Def.h
"

40 
	~"TLibComm⁄/TComBôSåóm.h
"

41 
	~"TLibComm⁄/SEI.h
"

42 
	~"TLibComm⁄/TComSli˚.h
"

43 
	~"Sy¡axEÀmítP¨£r.h
"

44 
	~"SEIªad.h
"

45 
	~"TLibComm⁄/TComPicYuv.h
"

46 
	~<iom™ù
>

53 #i‡
ENC_DEC_TRACE


54 
Void
 
	$xTø˚SEIHódî
()

56 
	`Ârötf
–
g_hTø˚
, "=========== SEI message ===========\n");

57 
	}
}

59 
Void
 
	$xTø˚SEIMesßgeTy≥
(
SEI
::
PaylﬂdTy≥
 
∑ylﬂdTy≥
)

61 
	`Ârötf
–
g_hTø˚
, "==========%†SEI mesßgê===========\n", 
SEI
::
	`gëSEIMesßgeSåög
(
∑ylﬂdTy≥
));

62 
	}
}

65 
Void
 
	gSEIRódî
::
	$£i_ªad_scode
(
°d
::
o°ªam
 *
pOS
, 
UI¡
 
uiLígth
, 
I¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
)

67 
	`READ_SCODE
(
uiLígth
, 
ruiCode
, 
pSymbﬁName
);

68 i‡(
pOS
)

70 (*
pOS
Ë<< " " << 
°d
::
	`£tw
(55Ë<< 
pSymbﬁName
 << ": " << 
ruiCode
 << "\n";

72 
	}
}

74 
Void
 
	gSEIRódî
::
	$£i_ªad_code
(
°d
::
o°ªam
 *
pOS
, 
UI¡
 
uiLígth
, UI¡& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
)

76 
	`READ_CODE
(
uiLígth
, 
ruiCode
, 
pSymbﬁName
);

77 i‡(
pOS
)

79 (*
pOS
Ë<< " " << 
°d
::
	`£tw
(55Ë<< 
pSymbﬁName
 << ": " << 
ruiCode
 << "\n";

81 
	}
}

83 
Void
 
	gSEIRódî
::
	$£i_ªad_uvlc
(
°d
::
o°ªam
 *
pOS
, 
UI¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
)

85 
	`READ_UVLC
(
ruiCode
, 
pSymbﬁName
);

86 i‡(
pOS
)

88 (*
pOS
Ë<< " " << 
°d
::
	`£tw
(55Ë<< 
pSymbﬁName
 << ": " << 
ruiCode
 << "\n";

90 
	}
}

92 
Void
 
	gSEIRódî
::
	$£i_ªad_svlc
(
°d
::
o°ªam
 *
pOS
, 
I¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
)

94 
	`READ_SVLC
(
ruiCode
, 
pSymbﬁName
);

95 i‡(
pOS
)

97 (*
pOS
Ë<< " " << 
°d
::
	`£tw
(55Ë<< 
pSymbﬁName
 << ": " << 
ruiCode
 << "\n";

99 
	}
}

101 
Void
 
	gSEIRódî
::
	$£i_ªad_Êag
(
°d
::
o°ªam
 *
pOS
, 
UI¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
)

103 
	`READ_FLAG
(
ruiCode
, 
pSymbﬁName
);

104 i‡(
pOS
)

106 (*
pOS
Ë<< " " << 
°d
::
	`£tw
(55Ë<< 
pSymbﬁName
 << ": " << (
ruiCode
?1:0) << "\n";

108 
	}
}

110 
ölöe
 
Void
 
	$ouçut_£i_mesßge_hódî
(
SEI
 &
£i
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
, 
UI¡
 
∑ylﬂdSize
)

112 i‡(
pDecodedMesßgeOuçutSåóm
)

114 
°d
::
°rög
 
	`£iMesßgeHdr
(
SEI
::
	`gëSEIMesßgeSåög
(
£i
.
	`∑ylﬂdTy≥
())); 
£iMesßgeHdr
+=" SEI message";

115 (*
pDecodedMesßgeOuçutSåóm
Ë<< 
°d
::
	`£tfûl
('-'Ë<< std::
	`£tw
(
£iMesßgeHdr
.
	`size
()Ë<< "-" << std::£tfûl(' 'Ë<< "\n" << seiMesßgeHd∏<< " (" << 
∑ylﬂdSize
 << " bytes)"<< "\n";

117 
	}
}

119 #unde‡
READ_SCODE


120 #unde‡
READ_CODE


121 #unde‡
READ_SVLC


122 #unde‡
READ_UVLC


123 #unde‡
READ_FLAG


129 
Void
 
	gSEIRódî
::
	$∑r£SEImesßge
(
TComI≈utBô°ªam
* 
bs
, 
SEIMesßges
& 
£is
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

131 
	`£tBô°ªam
(
bs
);

133 
	`as£π
(!
m_pcBô°ªam
->
	`gëNumBôsU¡ûByãAlig√d
());

136 if(
«lUnôTy≥
 =
NAL_UNIT_PREFIX_SEI
)

138 
	`xRódSEImesßge
(
£is
, 
«lUnôTy≥
, 
•s
, 
pDecodedMesßgeOuçutSåóm
, 
SEI
::
¥efix_£i_mesßges
, 
°d
::
	`°rög
("prefix SEI"));

140 i‡(
«lUnôTy≥
 =
NAL_UNIT_SUFFIX_SEI
)

142 
	`xRódSEImesßge
(
£is
, 
«lUnôTy≥
, 
•s
, 
pDecodedMesßgeOuçutSåóm
, 
SEI
::
suffix_£i_mesßges
, 
°d
::
	`°rög
("suffix SEI"));

146 
°d
::
˚º
 << "Unsuµ‹ãd SEI NAL unôÅy≥ '" << 
«lUnôTy≥
 << "'" << std::
ídl
;

147 
	`exô
(
EXIT_FAILURE
);

152 
	`as£π
(!
m_pcBô°ªam
->
	`gëNumBôsU¡ûByãAlig√d
());

154 
m_pcBô°ªam
->
	`gëNumBôsLe·
() > 8);

156 
	`xRódRb•TøûögBôs
();

157 
	}
}

158 
Void
 
	gSEIRódî
::
	$xRódSEIPaylﬂdD©a
(
I¡
 c⁄° 
∑ylﬂdTy≥
, I¡ c⁄° 
∑ylﬂdSize
, 
SEI
 *&
£i
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, c⁄° 
TComSPS
 *
•s
,

159 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
, std::
°rög
 c⁄° &
ty≥Name
)

161 
∑ylﬂdTy≥
)

163 
SEI
::
BUFFERING_PERIOD
:

164 i‡(!
•s
)

166 
	`¥ötf
 ("Warning: Found BufferingÖeriod SEI message, butÇoáctive SPS isávailable. Ignoring.");

170 
£i
 = 
√w
 
SEIBuf„rögPîiod
;

171 
	`xP¨£SEIBuf„rögPîiod
((
SEIBuf„rögPîiod
&Ë*
£i
, 
∑ylﬂdSize
, 
•s
, 
pDecodedMesßgeOuçutSåóm
);

174 
SEI
::
PICTURE_TIMING
:

175 i‡(!
•s
)

177 
	`¥ötf
 ("Warning: Found PictureÅiming SEI message, butÇoáctive SPS isávailable. Ignoring.");

181 
£i
 = 
√w
 
SEIPi˘uªTimög
;

182 
	`xP¨£SEIPi˘uªTimög
((
SEIPi˘uªTimög
&)*
£i
, 
∑ylﬂdSize
, 
•s
, 
pDecodedMesßgeOuçutSåóm
);

185 
SEI
::
PAN_SCAN_RECT
:

186 
£i
 = 
√w
 
SEIP™SˇnRe˘
;

187 
	`xP¨£SEIP™SˇnRe˘
((
SEIP™SˇnRe˘
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

189 
SEI
::
FILLER_PAYLOAD
:

190 
£i
 = 
√w
 
SEIFûÀrPaylﬂd
;

191 
	`xP¨£SEIFûÀrPaylﬂd
((
SEIFûÀrPaylﬂd
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

193 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
:

194 
£i
 = 
√w
 
SEIU£rD©aRegi°îed
;

195 
	`xP¨£SEIU£rD©aRegi°îed
((
SEIU£rD©aRegi°îed
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

197 
SEI
::
USER_DATA_UNREGISTERED
:

198 
£i
 = 
√w
 
SEIU£rD©aUƒegi°îed
;

199 
	`xP¨£SEIU£rD©aUƒegi°îed
((
SEIU£rD©aUƒegi°îed
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

201 
SEI
::
RECOVERY_POINT
:

202 
£i
 = 
√w
 
SEIRecovîyPoöt
;

203 
	`xP¨£SEIRecovîyPoöt
((
SEIRecovîyPoöt
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

205 
SEI
::
SCENE_INFO
:

206 
£i
 = 
√w
 
SEIS˚√Info
;

207 
	`xP¨£SEIS˚√Info
((
SEIS˚√Info
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

209 
SEI
::
PICTURE_SNAPSHOT
:

210 
£i
 = 
√w
 
SEIPi˘uªS«pshŸ
;

211 
	`xP¨£SEIPi˘uªS«pshŸ
((
SEIPi˘uªS«pshŸ
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

213 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_START
:

214 
£i
 = 
√w
 
SEIProgªssiveReföemítSegmítSèπ
;

215 
	`xP¨£SEIProgªssiveReföemítSegmítSèπ
((
SEIProgªssiveReföemítSegmítSèπ
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

217 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_END
:

218 
£i
 = 
√w
 
SEIProgªssiveReföemítSegmítEnd
;

219 
	`xP¨£SEIProgªssiveReföemítSegmítEnd
((
SEIProgªssiveReföemítSegmítEnd
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

221 
SEI
::
FILM_GRAIN_CHARACTERISTICS
:

222 
£i
 = 
√w
 
SEIFûmGøöCh¨a˘îi°ics
;

223 
	`xP¨£SEIFûmGøöCh¨a˘îi°ics
((
SEIFûmGøöCh¨a˘îi°ics
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

225 
SEI
::
POST_FILTER_HINT
:

226 i‡(!
•s
)

228 
	`¥ötf
 ("Warning:Öost filter hint SEI message, butÇoáctive SPS isávailable. Ignoring.");

232 
£i
 = 
√w
 
SEIPo°FûãrHöt
;

233 
	`xP¨£SEIPo°FûãrHöt
((
SEIPo°FûãrHöt
&Ë*
£i
, 
∑ylﬂdSize
, 
•s
, 
pDecodedMesßgeOuçutSåóm
);

236 
SEI
::
TONE_MAPPING_INFO
:

237 
£i
 = 
√w
 
SEIT⁄eM≠pögInfo
;

238 
	`xP¨£SEIT⁄eM≠pögInfo
((
SEIT⁄eM≠pögInfo
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

240 
SEI
::
FRAME_PACKING
:

241 
£i
 = 
√w
 
SEIFømePackög
;

242 
	`xP¨£SEIFømePackög
((
SEIFømePackög
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

244 
SEI
::
DISPLAY_ORIENTATION
:

245 
£i
 = 
√w
 
SEIDi•œyOrõ¡©i⁄
;

246 
	`xP¨£SEIDi•œyOrõ¡©i⁄
((
SEIDi•œyOrõ¡©i⁄
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

248 
SEI
::
GREEN_METADATA
:

249 
£i
 = 
√w
 
SEIGªíMëad©aInfo
;

250 
	`xP¨£SEIGªíMëad©aInfo
((
SEIGªíMëad©aInfo
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

252 
SEI
::
SOP_DESCRIPTION
:

253 
£i
 = 
√w
 
SEISOPDes¸ùti⁄
;

254 
	`xP¨£SEISOPDes¸ùti⁄
((
SEISOPDes¸ùti⁄
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

256 
SEI
::
DECODED_PICTURE_HASH
:

257 
£i
 = 
√w
 
SEIDecodedPi˘uªHash
;

258 
	`xP¨£SEIDecodedPi˘uªHash
((
SEIDecodedPi˘uªHash
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

260 
SEI
::
ACTIVE_PARAMETER_SETS
:

261 
£i
 = 
√w
 
SEIA˘iveP¨amëîSës
;

262 
	`xP¨£SEIA˘iveP¨amëîSës
((
SEIA˘iveP¨amëîSës
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

264 
SEI
::
DECODING_UNIT_INFO
:

265 i‡(!
•s
)

267 
	`¥ötf
 ("Warning: Found Decoding unit SEI message, butÇoáctive SPS isávailable. Ignoring.");

271 
£i
 = 
√w
 
SEIDecodögUnôInfo
;

272 
	`xP¨£SEIDecodögUnôInfo
((
SEIDecodögUnôInfo
&Ë*
£i
, 
∑ylﬂdSize
, 
•s
, 
pDecodedMesßgeOuçutSåóm
);

275 
SEI
::
TEMPORAL_LEVEL0_INDEX
:

276 
£i
 = 
√w
 
SEITemp‹ÆLevñ0Index
;

277 
	`xP¨£SEITemp‹ÆLevñ0Index
((
SEITemp‹ÆLevñ0Index
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

279 
SEI
::
SCALABLE_NESTING
:

280 
£i
 = 
√w
 
SEISˇœbÀNe°ög
;

281 
	`xP¨£SEISˇœbÀNe°ög
((
SEISˇœbÀNe°ög
&Ë*
£i
, 
«lUnôTy≥
, 
∑ylﬂdSize
, 
•s
, 
pDecodedMesßgeOuçutSåóm
);

283 
SEI
::
REGION_REFRESH_INFO
:

284 
£i
 = 
√w
 
SEIRegi⁄Re‰eshInfo
;

285 
	`xP¨£SEIRegi⁄Re‰eshInfo
((
SEIRegi⁄Re‰eshInfo
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

287 
SEI
::
NO_DISPLAY
:

288 
£i
 = 
√w
 
SEINoDi•œy
;

289 
	`xP¨£SEINoDi•œy
((
SEINoDi•œy
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

291 
SEI
::
TIME_CODE
:

292 
£i
 = 
√w
 
SEITimeCode
;

293 
	`xP¨£SEITimeCode
((
SEITimeCode
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

295 
SEI
::
MASTERING_DISPLAY_COLOUR_VOLUME
:

296 
£i
 = 
√w
 
SEIMa°îögDi•œyCﬁourVﬁume
;

297 
	`xP¨£SEIMa°îögDi•œyCﬁourVﬁume
((
SEIMa°îögDi•œyCﬁourVﬁume
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

299 
SEI
::
SEGM_RECT_FRAME_PACKING
:

300 
£i
 = 
√w
 
SEISegmíãdRe˘FømePackög
;

301 
	`xP¨£SEISegmíãdRe˘FømePackög
((
SEISegmíãdRe˘FømePackög
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

303 
SEI
::
TEMP_MOTION_CONSTRAINED_TILE_SETS
:

304 
£i
 = 
√w
 
SEITempMŸi⁄C⁄°øöedTûeSës
;

305 
	`xP¨£SEITempMŸi⁄C⁄°øötsTûeSës
((
SEITempMŸi⁄C⁄°øöedTûeSës
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

307 #i‡
MCTS_EXTRACTION


308 
SEI
::
MCTS_EXTRACTION_INFO_SET
:

309 
£i
 = 
√w
 
SEIMCTSExåa˘i⁄InfoSë
;

310 
	`xP¨£SEIMCTSExåa˘i⁄InfoSë
((
SEIMCTSExåa˘i⁄InfoSë
&)*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

313 
SEI
::
CHROMA_RESAMPLING_FILTER_HINT
:

314 
£i
 = 
√w
 
SEIChromaReßm∂ögFûãrHöt
;

315 
	`xP¨£SEIChromaReßm∂ögFûãrHöt
((
SEIChromaReßm∂ögFûãrHöt
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

317 
SEI
::
KNEE_FUNCTION_INFO
:

318 
£i
 = 
√w
 
SEIK√eFun˘i⁄Info
;

319 
	`xP¨£SEIK√eFun˘i⁄Info
((
SEIK√eFun˘i⁄Info
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

321 
SEI
::
COLOUR_REMAPPING_INFO
:

322 
£i
 = 
√w
 
SEICﬁourRem≠pögInfo
;

323 
	`xP¨£SEICﬁourRem≠pögInfo
((
SEICﬁourRem≠pögInfo
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

325 
SEI
::
DEINTERLACE_FIELD_IDENTIFICATION
:

326 
£i
 = 
√w
 
SEIDeöãæa˚FõldIdítifiˇti⁄
;

327 
	`xP¨£SEIDeöãæa˚FõldIdítifiˇti⁄
((
SEIDeöãæa˚FõldIdítifiˇti⁄
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

329 
SEI
::
CONTENT_LIGHT_LEVEL_INFO
:

330 
£i
 = 
√w
 
SEIC⁄ã¡LightLevñInfo
;

331 
	`xP¨£SEIC⁄ã¡LightLevñInfo
((
SEIC⁄ã¡LightLevñInfo
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

333 
SEI
::
DEPENDENT_RAP_INDICATION
:

334 
£i
 = 
√w
 
SEIDïídítRAPIndiˇti⁄
;

335 
	`xP¨£SEIDïídítRAPIndiˇti⁄
((
SEIDïídítRAPIndiˇti⁄
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

337 
SEI
::
CODED_REGION_COMPLETION
:

338 
£i
 = 
√w
 
SEICodedRegi⁄Com∂ëi⁄
;

339 
	`xP¨£SEICodedRegi⁄Com∂ëi⁄
((
SEICodedRegi⁄Com∂ëi⁄
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

341 
SEI
::
ALTERNATIVE_TRANSFER_CHARACTERISTICS
:

342 
£i
 = 
√w
 
SEIA…î«tiveTøns„rCh¨a˘îi°ics
;

343 
	`xP¨£SEIA…î«tiveTøns„rCh¨a˘îi°ics
((
SEIA…î«tiveTøns„rCh¨a˘îi°ics
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

345 
SEI
::
AMBIENT_VIEWING_ENVIRONMENT
:

346 
£i
 = 
√w
 
SEIAmbõ¡VõwögEnvú⁄mít
;

347 
	`xP¨£SEIAmbõ¡VõwögEnvú⁄mít
((
SEIAmbõ¡VõwögEnvú⁄mít
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

349 
SEI
::
CONTENT_COLOUR_VOLUME
:

350 
£i
 = 
√w
 
SEIC⁄ã¡CﬁourVﬁume
;

351 
	`xP¨£SEIC⁄ã¡CﬁourVﬁume
((
SEIC⁄ã¡CﬁourVﬁume
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

353 
SEI
::
EQUIRECTANGULAR_PROJECTION
:

354 
£i
 = 
√w
 
SEIEquúe˘™guœrProje˘i⁄
;

355 
	`xP¨£SEIEquúe˘™guœrProje˘i⁄
((
SEIEquúe˘™guœrProje˘i⁄
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

357 
SEI
::
SPHERE_ROTATION
:

358 
£i
 = 
√w
 
SEISphîeRŸ©i⁄
;

359 
	`xP¨£SEISphîeRŸ©i⁄
((
SEISphîeRŸ©i⁄
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

361 
SEI
::
OMNI_VIEWPORT
:

362 
£i
 = 
√w
 
SEIOmniVõwp‹t
;

363 
	`xP¨£SEIOmniVõwp‹t
((
SEIOmniVõwp‹t
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

365 
SEI
::
CUBEMAP_PROJECTION
:

366 
£i
 = 
√w
 
SEICubem≠Proje˘i⁄
;

367 
	`xP¨£SEICubem≠Proje˘i⁄
((
SEICubem≠Proje˘i⁄
&)*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

369 
SEI
::
REGION_WISE_PACKING
:

370 
£i
 = 
√w
 
SEIRegi⁄Wi£Packög
;

371 
	`xP¨£SEIRegi⁄Wi£Packög
((
SEIRegi⁄Wi£Packög
&Ë*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

374 
SEI
::
ANNOTATED_REGIONS
:

375 
£i
 = 
√w
 
SEIA¬Ÿ©edRegi⁄s
;

376 
	`xP¨£SEIA¬Ÿ©edRegi⁄s
((
SEIA¬Ÿ©edRegi⁄s
&)*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

378 
SEI
::
FISHEYE_VIDEO_INFO
:

379 
£i
 = 
√w
 
SEIFisheyeVideoInfo
;

380 
	`xP¨£SEIFisheyeVideoInfo
((
SEIFisheyeVideoInfo
&)*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

382 
SEI
::
REGIONAL_NESTING
:

383 
£i
 = 
√w
 
SEIRegi⁄ÆNe°ög
;

384 
	`xP¨£SEIRegi⁄ÆNe°ög
((
SEIRegi⁄ÆNe°ög
&Ë*
£i
, 
∑ylﬂdSize
, 
•s
, 
pDecodedMesßgeOuçutSåóm
);

386 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


387 
SEI
::
SHUTTER_INTERVAL_INFO
:

388 
£i
 = 
√w
 
SEIShuâîI¡îvÆInfo
;

389 
	`xP¨£SEIShuâîI¡îvÆ
((
SEIShuâîI¡îvÆInfo
&)*
£i
, 
∑ylﬂdSize
, 
pDecodedMesßgeOuçutSåóm
);

393 
UI¡
 
i
 = 0; i < 
∑ylﬂdSize
; i++)

395 
UI¡
 
£iByã
;

396 
°d
::
°rög
 
msg
 = std::
	`°rög
("unknow¿")+
ty≥Name
+std::string("Öayload byte");

397 
	`£i_ªad_code
 (
NULL
, 8, 
£iByã
, 
msg
.
	`c_°r
());

399 
	`¥ötf
 ("Unknow¿¥efix SEI mesßgê’aylﬂdTy≥ = %dËwa†found!\n", 
∑ylﬂdTy≥
);

400 i‡(
pDecodedMesßgeOuçutSåóm
)

402 (*
pDecodedMesßgeOuçutSåóm
Ë<< "Unknow¿"<< 
ty≥Name
 << " mesßgê’aylﬂdTy≥ = " << 
∑ylﬂdTy≥
 << ") was found!\n";

406 
	}
}

408 
Void
 
	gSEIRódî
::
xRódSEImesßge
(
SEIMesßges
& 
£is
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
, c⁄° 
ve˘‹
<
SEI
::
PaylﬂdTy≥
>& 
ÆlowedSeiTy≥s
, std::
°rög
 c⁄° &
ty≥Name
)

410 #i‡
ENC_DEC_TRACE


411 
xTø˚SEIHódî
();

413 
I¡
 
	g∑ylﬂdTy≥
 = 0;

414 
UI¡
 
	gvÆ
 = 0;

418 
£i_ªad_code
(
NULL
, 8, 
vÆ
, "payload_type");

419 
	g∑ylﬂdTy≥
 +
vÆ
;

420 } 
	gvÆ
==0xFF);

422 
UI¡
 
	g∑ylﬂdSize
 = 0;

425 
£i_ªad_code
(
NULL
, 8, 
vÆ
, "payload_size");

426 
	g∑ylﬂdSize
 +
vÆ
;

427 } 
	gvÆ
==0xFF);

429 #i‡
ENC_DEC_TRACE


430 
xTø˚SEIMesßgeTy≥
((
SEI
::
PaylﬂdTy≥
)
∑ylﬂdTy≥
);

439 
TComI≈utBô°ªam
 *
	gbs
 = 
gëBô°ªam
();

440 
£tBô°ªam
(
bs
->
exåa˘Sub°ªam
(
∑ylﬂdSize
 * 8));

442 
SEI
 *
	g£i
 = 
NULL
;

444 i‡(
	g°d
::
föd
(
ÆlowedSeiTy≥s
.
begö
(),áŒowedSeiTy≥s.begö(), 
∑ylﬂdTy≥
Ë!ÆlowedSeiTy≥s.
íd
())

446 
xRódSEIPaylﬂdD©a
(
∑ylﬂdTy≥
, 
∑ylﬂdSize
, 
£i
, 
«lUnôTy≥
, 
•s
, 
pDecodedMesßgeOuçutSåóm
, 
ty≥Name
);

450 
UI¡
 
	gi
 = 0; i < 
	g∑ylﬂdSize
; i++)

452 
UI¡
 
	g£iByã
;

453 
£i_ªad_code
 (
NULL
, 8, 
£iByã
, "unknown SEIÖayload byte");

455 
¥ötf
 ("Unknow¿SEI mesßgê’aylﬂdTy≥ = %dËwa†found!\n", 
∑ylﬂdTy≥
);

456 i‡(
	gpDecodedMesßgeOuçutSåóm
)

458 (*
	gpDecodedMesßgeOuçutSåóm
Ë<< "Unknow¿SEI mesßgê’aylﬂdTy≥ = " << 
	g∑ylﬂdTy≥
 << ") was found!\n";

462 i‡(
	g£i
 !
NULL
)

464 
£is
.
push_back
(
£i
);

474 
I¡
 
	g∑ylﬂdBôsRemaöög
 = 
gëBô°ªam
()->
gëNumBôsLe·
();

475 i‡(
	g∑ylﬂdBôsRemaöög
)

477 ; 
	g∑ylﬂdBôsRemaöög
 > 9;ÖayloadBitsRemaining--)

479 
UI¡
 
	gª£rvedPaylﬂdExãnsi⁄D©a
;

480 
£i_ªad_code
 ( 
pDecodedMesßgeOuçutSåóm
, 1, 
ª£rvedPaylﬂdExãnsi⁄D©a
, "reserved_payload_extension_data");

484 
I¡
 
	gföÆBôs
 = 
gëBô°ªam
()->
≥ekBôs
(
∑ylﬂdBôsRemaöög
);

485 
I¡
 
	gföÆPaylﬂdBôs
 = 0;

486 
I¡
 
	gmask
 = 0xff; 
	gföÆBôs
 & (mask >> 
	gföÆPaylﬂdBôs
); finalPayloadBits++)

492 ; 
	g∑ylﬂdBôsRemaöög
 > 9 - 
	gföÆPaylﬂdBôs
;ÖayloadBitsRemaining--)

494 
UI¡
 
	gª£rvedPaylﬂdExãnsi⁄D©a
;

495 
£i_ªad_Êag
 ( 0, 
ª£rvedPaylﬂdExãnsi⁄D©a
, "reserved_payload_extension_data");

498 
UI¡
 
	gdummy
;

499 
£i_ªad_Êag
–0, 
dummy
, "∑ylﬂd_bô_equÆ_to_⁄e"); 
	g∑ylﬂdBôsRemaöög
--;

500 
	g∑ylﬂdBôsRemaöög
)

502 
£i_ªad_Êag
–0, 
dummy
, "∑ylﬂd_bô_equÆ_to_zîo"); 
	g∑ylﬂdBôsRemaöög
--;

507 
dñëe
 
gëBô°ªam
();

508 
£tBô°ªam
(
bs
);

512 
Void
 
	gSEIRódî
::
	$xP¨£SEIBuf„rögPîiod
(
SEIBuf„rögPîiod
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

514 
I¡
 
i
, 
«lOrV˛
;

515 
UI¡
 
code
;

517 c⁄° 
TComVUI
 *
pVUI
 = 
•s
->
	`gëVuiP¨amëîs
();

518 c⁄° 
TComHRD
 *
pHRD
 = 
pVUI
->
	`gëHrdP¨amëîs
();

520 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

522 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "bp_£q_∑ømëî_£t_id" ); 
£i
.
m_bpSeqP¨amëîSëId
 = code;

523 if–!
pHRD
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

525 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "ú≠_˝b_∑øms_¥e£¡_Êag" ); 
£i
.
m_øpCpbP¨amsPª£¡Fœg
 = code;

527 if–
£i
.
m_øpCpbP¨amsPª£¡Fœg
 )

529 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 
pHRD
->
	`gëCpbRemovÆDñayLígthMöus1
(Ë+ 1, 
code
, "˝b_dñay_off£t" ); 
£i
.
m_˝bDñayOff£t
 = code;

530 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 
pHRD
->
	`gëDpbOuçutDñayLígthMöus1
(Ë+ 1, 
code
, "dpb_dñay_off£t" ); 
£i
.
m_dpbDñayOff£t
 = code;

534 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "concatenation_flag");

535 
£i
.
m_c⁄ˇã«ti⁄Fœg
 = 
code
;

536 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
pHRD
->
	`gëCpbRemovÆDñayLígthMöus1
(Ë+ 1 ), 
code
, "au_cpb_removal_delay_delta_minus1" );

537 
£i
.
m_auCpbRemovÆDñayDñè
 = 
code
 + 1;

539  
«lOrV˛
 = 0;ÇalOrVcl < 2;ÇalOrVcl ++ )

541 if–––
«lOrV˛
 =0 ) && ( 
pHRD
->
	`gëNÆHrdP¨amëîsPª£¡Fœg
() ) ) ||

542 ––
«lOrV˛
 =1 ) && ( 
pHRD
->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() ) ) )

544  
i
 = 0; i < ( 
pHRD
->
	`gëCpbC¡Möus1
( 0 ) + 1 ); i ++ )

546 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
pHRD
->
	`gëInôülCpbRemovÆDñayLígthMöus1
(Ë+ 1 ) , 
code
, 
«lOrV˛
?"vcl_initial_cpb_removal_delay":"nal_initial_cpb_removal_delay" );

547 
£i
.
m_öôülCpbRemovÆDñay
[
i
][
«lOrV˛
] = 
code
;

548 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
pHRD
->
	`gëInôülCpbRemovÆDñayLígthMöus1
(Ë+ 1 ) , 
code
, 
«lOrV˛
?"vcl_initial_cpb_removal_offset":"nal_initial_cpb_removal_offset" );

549 
£i
.
m_öôülCpbRemovÆDñayOff£t
[
i
][
«lOrV˛
] = 
code
;

550 if–
pHRD
->
	`gëSubPicCpbP¨amsPª£¡Fœg
(Ë|| 
£i
.
m_øpCpbP¨amsPª£¡Fœg
 )

552 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
pHRD
->
	`gëInôülCpbRemovÆDñayLígthMöus1
(Ë+ 1 ) , 
code
, 
«lOrV˛
?"vcl_initial_alt_cpb_removal_delay":"nal_initial_alt_cpb_removal_delay" );

553 
£i
.
m_öôülA…CpbRemovÆDñay
[
i
][
«lOrV˛
] = 
code
;

554 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
pHRD
->
	`gëInôülCpbRemovÆDñayLígthMöus1
(Ë+ 1 ) , 
code
, 
«lOrV˛
?"vcl_initial_alt_cpb_removal_offset":"nal_initial_alt_cpb_removal_offset" );

555 
£i
.
m_öôülA…CpbRemovÆDñayOff£t
[
i
][
«lOrV˛
] = 
code
;

560 
	}
}

563 
Void
 
	gSEIRódî
::
	$xP¨£SEIPi˘uªTimög
(
SEIPi˘uªTimög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

565 
I¡
 
i
;

566 
UI¡
 
code
;

568 c⁄° 
TComVUI
 *
vui
 = 
•s
->
	`gëVuiP¨amëîs
();

569 c⁄° 
TComHRD
 *
hrd
 = 
vui
->
	`gëHrdP¨amëîs
();

570 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

572 if–
vui
->
	`gëFømeFõldInfoPª£¡Fœg
() )

574 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
code
, "pic_°ru˘" ); 
£i
.
m_picSåu˘
 = code;

575 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 2, 
code
, "sour˚_sˇn_ty≥" ); 
£i
.
m_sour˚SˇnTy≥
 = code;

576 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "du∂iˇã_Êag" ); 
£i
.
m_du∂iˇãFœg
 = (code == 1);

579 if–
hrd
->
	`gëCpbDpbDñaysPª£¡Fœg
())

581 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
hrd
->
	`gëCpbRemovÆDñayLígthMöus1
(Ë+ 1 ), 
code
, "au_cpb_removal_delay_minus1" );

582 
£i
.
m_auCpbRemovÆDñay
 = 
code
 + 1;

583 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
hrd
->
	`gëDpbOuçutDñayLígthMöus1
(Ë+ 1 ), 
code
, "pic_dpb_output_delay" );

584 
£i
.
m_picDpbOuçutDñay
 = 
code
;

586 if(
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
())

588 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 
hrd
->
	`gëDpbOuçutDñayDuLígthMöus1
()+1, 
code
, "pic_dpb_output_du_delay" );

589 
£i
.
m_picDpbOuçutDuDñay
 = 
code
;

592 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
(Ë&& hrd->
	`gëSubPicCpbP¨amsInPicTimögSEIFœg
() )

594 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "num_decoding_units_minus1");

595 
£i
.
m_numDecodögUnôsMöus1
 = 
code
;

596 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "du_common_cpb_removal_delay_flag" );

597 
£i
.
m_duComm⁄CpbRemovÆDñayFœg
 = 
code
;

598 if–
£i
.
m_duComm⁄CpbRemovÆDñayFœg
 )

600 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
hrd
->
	`gëDuCpbRemovÆDñayLígthMöus1
(Ë+ 1 ), 
code
, "du_common_cpb_removal_delay_increment_minus1" );

601 
£i
.
m_duComm⁄CpbRemovÆDñayMöus1
 = 
code
;

603 
£i
.
m_numNÆusInDuMöus1
.
	`ªsize
(£i.
m_numDecodögUnôsMöus1
 + 1 );

604 
£i
.
m_duCpbRemovÆDñayMöus1
.
	`ªsize
–£i.
m_numDecodögUnôsMöus1
 + 1 );

606  
i
 = 0; i <
£i
.
m_numDecodögUnôsMöus1
; i ++ )

608 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "num_nalus_in_du_minus1[i]");

609 
£i
.
m_numNÆusInDuMöus1
[ 
i
 ] = 
code
;

610 if––!
£i
.
m_duComm⁄CpbRemovÆDñayFœg
 ) && ( 
i
 < sei.
m_numDecodögUnôsMöus1
 ) )

612 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
hrd
->
	`gëDuCpbRemovÆDñayLígthMöus1
(Ë+ 1 ), 
code
, "du_cpb_removal_delay_minus1[i]" );

613 
£i
.
m_duCpbRemovÆDñayMöus1
[ 
i
 ] = 
code
;

618 
	}
}

621 
Void
 
	gSEIRódî
::
	$xP¨£SEIP™SˇnRe˘
(
SEIP™SˇnRe˘
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

623 
UI¡
 
code
;

624 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

625 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "∑n_sˇn_ª˘_id" ); 
£i
.
m_∑nSˇnRe˘Id
 = code;

626 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "∑n_sˇn_ª˘_ˇn˚l_Êag" ); 
£i
.
m_∑nSˇnRe˘C™˚lFœg
 = code!=0;

627 i‡(!
£i
.
m_∑nSˇnRe˘C™˚lFœg
)

629 
UI¡
 
numRegi⁄s
;

630 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
numRegi⁄s
, "pan_scan_cnt_minus1" );ÇumRegions++;

631 
£i
.
m_∑nSˇnRe˘Regi⁄s
.
	`ªsize
(
numRegi⁄s
);

632 
UI¡
 
ªgi⁄
=0;Ñegi⁄<
numRegi⁄s
;Ñegion++)

634 
SEIP™SˇnRe˘
::
P™SˇnRe˘
 &
ª˘
=
£i
.
m_∑nSˇnRe˘Regi⁄s
[
ªgi⁄
];

635 
I¡
 
i
;

636 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
i
, "∑n_sˇn_ª˘_À·_off£t[i]" ); 
ª˘
.
À·Off£t
 = i;

637 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
i
, "∑n_sˇn_ª˘_right_off£t[i]" ); 
ª˘
.
rightOff£t
 = i;

638 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
i
, "∑n_sˇn_ª˘_t›_off£t[i]" ); 
ª˘
.
t›Off£t
 = i;

639 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
i
, "∑n_sˇn_ª˘_bŸtom_off£t[i]" ); 
ª˘
.
bŸtomOff£t
 = i;

641 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "∑n_sˇn_ª˘_≥rsi°í˚_Êag" ); 
£i
.
m_∑nSˇnRe˘Pîsi°í˚Fœg
 = code!=0;

645 
£i
.
m_∑nSˇnRe˘Regi⁄s
.
	`˛ór
();

646 
£i
.
m_∑nSˇnRe˘Pîsi°í˚Fœg
=
Ál£
;

648 
	}
}

651 
Void
 
	gSEIRódî
::
	$xP¨£SEIFûÀrPaylﬂd
(
SEIFûÀrPaylﬂd
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

653 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

654 
£i
.
m_numFûÀrFFByãs
 = 
∑ylﬂdSize
;

655 
Boﬁ
 
ÆlByãsWîeFF
=
åue
;

656 
UI¡
 
k
=0; k<
∑ylﬂdSize
; k++)

658 
UI¡
 
code
;

659 
	`£i_ªad_code
–
NULL
, 8, 
code
, "ff_byte" );

660 i‡(
code
!=0xffË
ÆlByãsWîeFF
=
Ál£
;

662 i‡(
pDecodedMesßgeOuçutSåóm
 && !
ÆlByãsWîeFF
)

664 (*
pDecodedMesßgeOuçutSåóm
) << "Çotáll fillerÖayload bytes were 0xff\n";

666 
	}
}

669 
Void
 
	gSEIRódî
::
	$xP¨£SEIU£rD©aRegi°îed
(
SEIU£rD©aRegi°îed
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

671 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

673 
UI¡
 
code
;

674 
	`as£π
(
∑ylﬂdSize
>0);

675 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "ôu_t_t35_cou¡ry_code" ); 
∑ylﬂdSize
--;

676 i‡(
code
 == 255)

678 
	`as£π
(
∑ylﬂdSize
>0);

679 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "ôu_t_t35_cou¡ry_code_exãnsi⁄_byã" ); 
∑ylﬂdSize
--;

680 
code
+=255;

682 
£i
.
m_ôuCou¡ryCode
 = 
code
;

683 
£i
.
m_u£rD©a
.
	`ªsize
(
∑ylﬂdSize
);

684 
UI¡
 
i
 = 0; i < 
£i
.
m_u£rD©a
.
	`size
(); i++)

686 
	`£i_ªad_code
–
NULL
, 8, 
code
, "itu_t_t35_payload_byte" );

687 
£i
.
m_u£rD©a
[
i
] = 
code
;

689 i‡(
pDecodedMesßgeOuçutSåóm
)

691 (*
pDecodedMesßgeOuçutSåóm
Ë<< " itu_t_t35Öaylﬂd size: " << 
£i
.
m_u£rD©a
.
	`size
() << "\n";

693 
	}
}

696 
Void
 
	gSEIRódî
::
	$xP¨£SEIU£rD©aUƒegi°îed
(
SEIU£rD©aUƒegi°îed
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

698 
	`as£π
(
∑ylﬂdSize
 >
ISO_IEC_11578_LEN
);

699 
UI¡
 
vÆ
;

700 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

702 
UI¡
 
i
 = 0; i < 
ISO_IEC_11578_LEN
; i++)

704 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "uuid_iso_iec_11578");

705 
£i
.
m_uuid_iso_õc_11578
[
i
] = 
vÆ
;

708 
£i
.
m_u£rD©a
.
	`ªsize
(
∑ylﬂdSize
 - 
ISO_IEC_11578_LEN
);

709 
UI¡
 
i
 = 0; i < 
£i
.
m_u£rD©a
.
	`size
(); i++)

711 
	`£i_ªad_code
–
NULL
, 8, 
vÆ
, "user_data_payload_byte" );

712 
£i
.
m_u£rD©a
[
i
] = 
vÆ
;

714 i‡(
pDecodedMesßgeOuçutSåóm
)

716 (*
pDecodedMesßgeOuçutSåóm
Ë<< " U£∏d©®∑ylﬂd size: " << 
£i
.
m_u£rD©a
.
	`size
() << "\n";

718 
	}
}

721 
Void
 
	gSEIRódî
::
	$xP¨£SEIRecovîyPoöt
(
SEIRecovîyPoöt
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

723 
I¡
 
iCode
;

724 
UI¡
 
uiCode
;

725 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

727 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
iCode
, "ªcovîy_poc_˙t" ); 
£i
.
m_ªcovîyPocC¡
 = iCode;

728 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "exa˘_m©chög_Êag" ); 
£i
.
m_exa˘M©chögFœg
 = uiCode;

729 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "brokí_lök_Êag" ); 
£i
.
m_brokíLökFœg
 = uiCode;

730 
	}
}

733 
Void
 
	gSEIRódî
::
	$xP¨£SEIS˚√Info
(
SEIS˚√Info
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

735 
UI¡
 
code
;

736 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

738 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "s˚√_öfo_¥e£¡_Êag" ); 
£i
.
m_bS˚√InfoPª£¡Fœg
 = code!=0;

739 i‡(
£i
.
m_bS˚√InfoPª£¡Fœg
)

741 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "¥ev_s˚√_id_vÆid_Êag" ); 
£i
.
m_bPªvS˚√IdVÆidFœg
 = code!=0;

742 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "s˚√_id" ); 
£i
.
m_s˚√Id
 = code;

743 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "s˚√_å™sôi⁄_ty≥" ); 
£i
.
m_s˚√Tønsôi⁄Ty≥
 = code;

744 i‡(
£i
.
m_s˚√Tønsôi⁄Ty≥
 > 3)

746 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "£c⁄d_s˚√_id" ); 
£i
.
m_£c⁄dS˚√Id
 = code;

750 
£i
.
m_£c⁄dS˚√Id
 = 0;

753 
	}
}

756 
Void
 
	gSEIRódî
::
	$xP¨£SEIPi˘uªS«pshŸ
(
SEIPi˘uªS«pshŸ
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

758 
UI¡
 
code
;

759 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

761 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "¢≠shŸ_id" ); 
£i
.
m_¢≠shŸId
 = code;

762 
	}
}

765 
Void
 
	gSEIRódî
::
	$xP¨£SEIProgªssiveReföemítSegmítSèπ
(
SEIProgªssiveReföemítSegmítSèπ
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

767 
UI¡
 
code
;

768 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

770 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "¥ogªssive_ªföemít_id" ); 
£i
.
m_¥ogªssiveReföemítId
 = code;

771 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "pic_‹dî_˙t_dñè" ); 
£i
.
m_picOrdîC¡Dñè
 = code;

772 
	}
}

775 
Void
 
	gSEIRódî
::
	$xP¨£SEIProgªssiveReföemítSegmítEnd
(
SEIProgªssiveReföemítSegmítEnd
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

777 
UI¡
 
code
;

778 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

780 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "¥ogªssive_ªföemít_id" ); 
£i
.
m_¥ogªssiveReföemítId
 = code;

781 
	}
}

784 
Void
 
	gSEIRódî
::
	$xP¨£SEIFûmGøöCh¨a˘îi°ics
(
SEIFûmGøöCh¨a˘îi°ics
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

786 
UI¡
 
code
;

787 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

789 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "fûm_gøö_ch¨a˘îi°ics_ˇn˚l_Êag" ); 
£i
.
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
 = code!=0;

790 i‡(!
£i
.
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
)

792 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 2, 
code
, "fûm_gøö_modñ_id" ); 
£i
.
m_fûmGøöModñId
 = code;

793 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "£∑øã_cﬁour_des¸ùti⁄_¥e£¡_Êag" ); 
£i
.
m_£∑øãCﬁourDes¸ùti⁄Pª£¡Fœg
 = code!=0;

794 i‡(
£i
.
m_£∑øãCﬁourDes¸ùti⁄Pª£¡Fœg
)

796 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
code
, "fûm_gøö_bô_dïth_luma_möus8" ); 
£i
.
m_fûmGøöBôDïthLumaMöus8
 = code;

797 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
code
, "fûm_gøö_bô_dïth_chroma_möus8" ); 
£i
.
m_fûmGøöBôDïthChromaMöus8
 = code;

798 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "fûm_gøö_fuŒ_ønge_Êag" ); 
£i
.
m_fûmGøöFuŒR™geFœg
 = code!=0;

799 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "fûm_gøö_cﬁour_¥im¨õs" ); 
£i
.
m_fûmGøöCﬁourPrim¨õs
 = code;

800 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "fûm_gøö_å™s„r_ch¨a˘îi°ics" ); 
£i
.
m_fûmGøöTøns„rCh¨a˘îi°ics
 = code;

801 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "fûm_gøö_m©rix_c€ffs" ); 
£i
.
m_fûmGøöM©rixC€ffs
 = code;

803 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 2, 
code
, "bÀndög_mode_id" ); 
£i
.
m_bÀndögModeId
 = code;

804 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
code
, "log2_sˇÀ_Á˘‹" ); 
£i
.
m_log2SˇÀFa˘‹
 = code;

805 
I¡
 
c
=0; c<3; c++)

807 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "comp_modñ_¥e£¡_Êag[c]" ); 
£i
.
m_compModñ
[
c
].
bPª£¡Fœg
 = code!=0;

809 
I¡
 
c
=0; c<3; c++)

811 
SEIFûmGøöCh¨a˘îi°ics
::
CompModñ
 &
cm
=
£i
.
m_compModñ
[
c
];

812 i‡(
cm
.
bPª£¡Fœg
)

814 
UI¡
 
numI¡ísôyI¡îvÆs
;

815 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "num_öãnsôy_öãrvÆs_möus1[c]" ); 
numI¡ísôyI¡îvÆs
 = code+1;

816 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
code
, "num_modñ_vÆues_möus1[c]" ); 
cm
.
numModñVÆues
 = code+1;

817 
cm
.
öãnsôyVÆues
.
	`ªsize
(
numI¡ísôyI¡îvÆs
);

818 
UI¡
 
öãrvÆ
=0; i¡îvÆ<
numI¡ísôyI¡îvÆs
; interval++)

820 
SEIFûmGøöCh¨a˘îi°ics
::
CompModñI¡ísôyVÆues
 &
cmiv
=
cm
.
öãnsôyVÆues
[
öãrvÆ
];

821 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "öãnsôy_öãrvÆ_lowî_bound[c][i]" ); 
cmiv
.
öãnsôyI¡îvÆLowîBound
=code;

822 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "öãnsôy_öãrvÆ_uµî_bound[c][i]" ); 
cmiv
.
öãnsôyI¡îvÆUµîBound
=code;

823 
cmiv
.
compModñVÆue
.
	`ªsize
(
cm
.
numModñVÆues
);

824 
UI¡
 
j
=0; j<
cm
.
numModñVÆues
; j++)

826 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
cmiv
.
compModñVÆue
[
j
], "comp_model_value[c][i]" );

831 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "fûm_gøö_ch¨a˘îi°ics_≥rsi°í˚_Êag" ); 
£i
.
m_fûmGøöCh¨a˘îi°icsPîsi°í˚Fœg
 = code!=0;

833 
	}
}

836 
Void
 
	gSEIRódî
::
	$xP¨£SEIPo°FûãrHöt
(
SEIPo°FûãrHöt
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

838 
UI¡
 
code
;

839 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

841 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "fûãr_höt_size_y" ); 
£i
.
m_fûãrHötSizeY
 = code;

842 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "fûãr_höt_size_x" ); 
£i
.
m_fûãrHötSizeX
 = code;

843 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 2, 
code
, "fûãr_höt_ty≥" ); 
£i
.
m_fûãrHötTy≥
 = code;

845 
£i
.
m_bIsM⁄ochrome
 = (
•s
->
	`gëChromaF‹m©Idc
(Ë=
CHROMA_400
);

846 c⁄° 
UI¡
 
numChromaCh™√ls
 = 
£i
.
m_bIsM⁄ochrome
 ? 1:3;

848 
£i
.
m_fûãrHötVÆues
.
	`ªsize
(
numChromaCh™√ls
 * sei.
m_fûãrHötSizeX
 * sei.
m_fûãrHötSizeY
);

849 
°d
::
size_t
 
i
=0; i<
£i
.
m_fûãrHötVÆues
.
	`size
(); i++)

851 
I¡
 
v
;

852 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
v
, "fûãr_höt_vÆue[][][]" ); 
£i
.
m_fûãrHötVÆues
[
i
] = 
code
;

854 
	}
}

857 
Void
 
	gSEIRódî
::
	$xP¨£SEIT⁄eM≠pögInfo
(
SEIT⁄eM≠pögInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

859 
I¡
 
i
;

860 
UI¡
 
vÆ
;

861 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

862 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "t⁄e_m≠_id" ); 
£i
.
m_t⁄eM≠Id
 = val;

863 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "t⁄e_m≠_ˇn˚l_Êag" ); 
£i
.
m_t⁄eM≠C™˚lFœg
 = val;

865 i‡–!
£i
.
m_t⁄eM≠C™˚lFœg
 )

867 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "t⁄e_m≠_≥rsi°í˚_Êag" ); 
£i
.
m_t⁄eM≠Pîsi°í˚Fœg
 = val;

868 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "coded_d©a_bô_dïth" ); 
£i
.
m_codedD©aBôDïth
 = val;

869 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "èrgë_bô_dïth" ); 
£i
.
m_èrgëBôDïth
 = val;

870 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "t⁄e_m≠_modñ_id" ); 
£i
.
m_modñId
 = val;

871 
£i
.
m_modñId
)

875 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "mö_vÆue" ); 
£i
.
m_möVÆue
 = val;

876 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "max_vÆue" ); 
£i
.
m_maxVÆue
 = val;

881 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "sigmoid_midpoöt" ); 
£i
.
m_sigmoidMidpoöt
 = val;

882 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "sigmoid_width" ); 
£i
.
m_sigmoidWidth
 = val;

887 
UI¡
 
num
 = 1u << 
£i
.
m_èrgëBôDïth
;

888 
£i
.
m_°¨tOfCodedI¡îvÆ
.
	`ªsize
(
num
+1);

889 
i
 = 0; i < 
num
; i++)

891 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ((–
£i
.
m_codedD©aBôDïth
 + 7 ) >> 3 ) << 3), 
vÆ
, "start_of_coded_interval[i]" );

892 
£i
.
m_°¨tOfCodedI¡îvÆ
[
i
] = 
vÆ
;

894 
£i
.
m_°¨tOfCodedI¡îvÆ
[
num
] = 1u << sei.
m_codedD©aBôDïth
;

899 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "num_pivŸs" ); 
£i
.
m_numPivŸs
 = val;

900 
£i
.
m_codedPivŸVÆue
.
	`ªsize
(£i.
m_numPivŸs
);

901 
£i
.
m_èrgëPivŸVÆue
.
	`ªsize
(£i.
m_numPivŸs
);

902 
i
 = 0; i < 
£i
.
m_numPivŸs
; i++ )

904 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ((–
£i
.
m_codedD©aBôDïth
 + 7 ) >> 3 ) << 3), 
vÆ
, "coded_pivot_value[i]" );

905 
£i
.
m_codedPivŸVÆue
[
i
] = 
vÆ
;

906 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ((–
£i
.
m_èrgëBôDïth
 + 7 ) >> 3 ) << 3), 
vÆ
, "target_pivot_value[i]" );

907 
£i
.
m_èrgëPivŸVÆue
[
i
] = 
vÆ
;

913 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "ˇmîa_iso_•ìd_idc" ); 
£i
.
m_ˇmîaIsoS≥edIdc
 = val;

914 if–
£i
.
m_ˇmîaIsoS≥edIdc
 == 255)

916 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "ˇmîa_iso_•ìd_vÆue" ); 
£i
.
m_ˇmîaIsoS≥edVÆue
 = val;

918 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "exposuª_ödex_idc" ); 
£i
.
m_exposuªIndexIdc
 = val;

919 if–
£i
.
m_exposuªIndexIdc
 == 255)

921 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "exposuª_ödex_vÆue" ); 
£i
.
m_exposuªIndexVÆue
 = val;

923 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "exposuª_com≥nßti⁄_vÆue_sign_Êag" ); 
£i
.
m_exposuªCom≥nßti⁄VÆueSignFœg
 = val;

924 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "exposuª_com≥nßti⁄_vÆue_numî©‹" ); 
£i
.
m_exposuªCom≥nßti⁄VÆueNumî©‹
 = val;

925 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "exposuª_com≥nßti⁄_vÆue_díom_idc" ); 
£i
.
m_exposuªCom≥nßti⁄VÆueDíomIdc
 = val;

926 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "ªf_s¸ìn_lumö™˚_whôe" ); 
£i
.
m_ªfS¸ìnLumö™˚Whôe
 = val;

927 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "exãnded_ønge_whôe_Àvñ" ); 
£i
.
m_exãndedR™geWhôeLevñ
 = val;

928 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "nomöÆ_bœck_Àvñ_code_vÆue" ); 
£i
.
m_nomöÆBœckLevñLumaCodeVÆue
 = val;

929 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "nomöÆ_whôe_Àvñ_code_vÆue" ); 
£i
.
m_nomöÆWhôeLevñLumaCodeVÆue
= val;

930 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "exãnded_whôe_Àvñ_code_vÆue" ); 
£i
.
m_exãndedWhôeLevñLumaCodeVÆue
 = val;

935 
	`as£π
(!"Undefined SEIToneMapModelId");

940 
	}
}

943 
Void
 
	gSEIRódî
::
	$xP¨£SEIFømePackög
(
SEIFømePackög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

945 
UI¡
 
vÆ
;

946 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

948 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "‰ame_∑ckög_¨øngemít_id" ); 
£i
.
m_¨øngemítId
 = val;

949 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "‰ame_∑ckög_¨øngemít_ˇn˚l_Êag" ); 
£i
.
m_¨øngemítC™˚lFœg
 = val;

951 i‡–!
£i
.
m_¨øngemítC™˚lFœg
 )

953 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 7, 
vÆ
, "‰ame_∑ckög_¨øngemít_ty≥" ); 
£i
.
m_¨øngemítTy≥
 = val;

954 
	`as£π
((
£i
.
m_¨øngemítTy≥
 > 2) && (sei.m_arrangementType < 6) );

956 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "quöcunx_ßm∂ög_Êag" ); 
£i
.
m_quöcunxSam∂ögFœg
 = val;

958 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 6, 
vÆ
, "c⁄ã¡_öãΩªèti⁄_ty≥" ); 
£i
.
m_c⁄ã¡I¡î¥ë©i⁄Ty≥
 = val;

959 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "•©ül_Êùpög_Êag" ); 
£i
.
m_•©ülFlùpögFœg
 = val;

960 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "‰ame0_Êù≥d_Êag" ); 
£i
.
m_‰ame0Flù≥dFœg
 = val;

961 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "fõld_võws_Êag" ); 
£i
.
m_fõldVõwsFœg
 = val;

962 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "cuºít_‰ame_is_‰ame0_Êag" ); 
£i
.
m_cuºítFømeIsFøme0Fœg
 = val;

963 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "‰ame0_£lf_c⁄èöed_Êag" ); 
£i
.
m_‰ame0SñfC⁄èöedFœg
 = val;

964 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "‰ame1_£lf_c⁄èöed_Êag" ); 
£i
.
m_‰ame1SñfC⁄èöedFœg
 = val;

966 i‡–
£i
.
m_quöcunxSam∂ögFœg
 =0 && sei.
m_¨øngemítTy≥
 != 5)

968 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
vÆ
, "‰ame0_grid_posôi⁄_x" ); 
£i
.
m_‰ame0GridPosôi⁄X
 = val;

969 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
vÆ
, "‰ame0_grid_posôi⁄_y" ); 
£i
.
m_‰ame0GridPosôi⁄Y
 = val;

970 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
vÆ
, "‰ame1_grid_posôi⁄_x" ); 
£i
.
m_‰ame1GridPosôi⁄X
 = val;

971 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
vÆ
, "‰ame1_grid_posôi⁄_y" ); 
£i
.
m_‰ame1GridPosôi⁄Y
 = val;

974 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "‰ame_∑ckög_¨øngemít_ª£rved_byã" ); 
£i
.
m_¨øngemítRe£rvedByã
 = val;

975 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "‰ame_∑ckög_¨øngemít_≥rsi°í˚_Êag" ); 
£i
.
m_¨øngemítPîsi°í˚Fœg
 = (val != 0);

977 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "upßm∂ed_a•e˘_øtio_Êag" ); 
£i
.
m_upßm∂edA•e˘R©io
 = val;

978 
	}
}

981 
Void
 
	gSEIRódî
::
	$xP¨£SEIDi•œyOrõ¡©i⁄
(
SEIDi•œyOrõ¡©i⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

983 
UI¡
 
vÆ
;

984 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

985 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "di•œy_‹õ¡©i⁄_ˇn˚l_Êag" ); 
£i
.
ˇn˚lFœg
 = val;

986 if–!
£i
.
ˇn˚lFœg
 )

988 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "h‹_Êù" ); 
£i
.
h‹Flù
 = val;

989 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "vî_Êù" ); 
£i
.
vîFlù
 = val;

990 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "™ti˛ockwi£_rŸ©i⁄" ); 
£i
.
™ti˛ockwi£RŸ©i⁄
 = val;

991 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "di•œy_‹õ¡©i⁄_≥rsi°í˚_Êag" ); 
£i
.
≥rsi°í˚Fœg
 = val;

993 
	}
}

996 
Void
 
	gSEIRódî
::
	$xP¨£SEIGªíMëad©aInfo
(
SEIGªíMëad©aInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
o°ªam
* 
pDecodedMesßgeOuçutSåóm
)

998 
UI¡
 
code
;

999 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1001 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "green_metadata_type");

1002 
£i
.
m_gªíMëad©aTy≥
 = 
code
;

1004 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "xsd_metric_type");

1005 
£i
.
m_xsdMëricTy≥
 = 
code
;

1007 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "xsd_metric_value");

1008 
£i
.
m_xsdMëricVÆue
 = 
code
;

1009 
	}
}

1012 
Void
 
	gSEIRódî
::
	$xP¨£SEISOPDes¸ùti⁄
(
SEISOPDes¸ùti⁄
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1014 
I¡
 
iCode
;

1015 
UI¡
 
uiCode
;

1016 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1018 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "s›_£q_∑ømëî_£t_id" ); 
£i
.
m_s›SeqP¨amëîSëId
 = uiCode;

1019 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "num_pics_ö_s›_möus1" ); 
£i
.
m_numPicsInS›Möus1
 = uiCode;

1020 
UI¡
 
i
 = 0; i <
£i
.
m_numPicsInS›Möus1
; i++)

1022 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 6, 
uiCode
, "s›_v˛_nut[i]" ); 
£i
.
m_s›DescV˛NÆuTy≥
[
i
] = uiCode;

1023 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
£i
.
m_s›DescTemp‹ÆId
[
i
], "s›_ãmp‹Æ_id[i]" ); sei.m_s›DescTemp‹ÆId[i] = 
uiCode
;

1024 i‡(
£i
.
m_s›DescV˛NÆuTy≥
[
i
] !
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 && sei.m_s›DescV˛NÆuTy≥[i] !
NAL_UNIT_CODED_SLICE_IDR_N_LP
)

1026 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
£i
.
m_s›DescStRpsIdx
[
i
], "s›_sh‹t_ãrm_Ωs_idx[i]" ); sei.m_s›DescStRpsIdx[i] = 
uiCode
;

1028 i‡(
i
 > 0)

1030 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
iCode
, "s›_poc_dñè[i]" ); 
£i
.
m_s›DescPocDñè
[
i
] = iCode;

1033 
	}
}

1036 
Void
 
	gSEIRódî
::
	$xP¨£SEIA˘iveP¨amëîSës
(
SEIA˘iveP¨amëîSës
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1038 
UI¡
 
vÆ
;

1039 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1041 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
vÆ
, "a˘ive_video_∑ømëî_£t_id"); 
£i
.
a˘iveVPSId
 = val;

1042 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "£lf_c⁄èöed_cvs_Êag"); 
£i
.
m_£lfC⁄èöedCvsFœg
 = (val != 0);

1043 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "no_∑ømëî_£t_upd©e_Êag"); 
£i
.
m_noP¨amëîSëUpd©eFœg
 = (val != 0);

1044 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "num_•s_ids_möus1"); 
£i
.
numSpsIdsMöus1
 = val;

1046 
£i
.
a˘iveSeqP¨amëîSëId
.
	`ªsize
(£i.
numSpsIdsMöus1
 + 1);

1047 
I¡
 
i
=0; i < (
£i
.
numSpsIdsMöus1
 + 1); i++)

1049 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "a˘ive_£q_∑ømëî_£t_id[i]"); 
£i
.
a˘iveSeqP¨amëîSëId
[
i
] = val;

1051 
	}
}

1054 
Void
 
	gSEIRódî
::
	$xP¨£SEIDecodögUnôInfo
(
SEIDecodögUnôInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1056 
UI¡
 
vÆ
;

1057 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1058 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "decoding_unit_idx");

1059 
£i
.
m_decodögUnôIdx
 = 
vÆ
;

1061 c⁄° 
TComVUI
 *
vui
 = 
•s
->
	`gëVuiP¨amëîs
();

1062 if(
vui
->
	`gëHrdP¨amëîs
()->
	`gëSubPicCpbP¨amsInPicTimögSEIFœg
())

1064 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, ( 
vui
->
	`gëHrdP¨amëîs
()->
	`gëDuCpbRemovÆDñayLígthMöus1
(Ë+ 1 ), 
vÆ
, "du_spt_cpb_removal_delay_increment");

1065 
£i
.
m_duS±CpbRemovÆDñay
 = 
vÆ
;

1069 
£i
.
m_duS±CpbRemovÆDñay
 = 0;

1071 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "dpb_ouçut_du_dñay_¥e£¡_Êag"); 
£i
.
m_dpbOuçutDuDñayPª£¡Fœg
 = (val != 0);

1072 if(
£i
.
m_dpbOuçutDuDñayPª£¡Fœg
)

1074 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 
vui
->
	`gëHrdP¨amëîs
()->
	`gëDpbOuçutDñayDuLígthMöus1
(Ë+ 1, 
vÆ
, "pic_spt_dpb_output_du_delay");

1075 
£i
.
m_picS±DpbOuçutDuDñay
 = 
vÆ
;

1077 
	}
}

1080 
Void
 
	gSEIRódî
::
	$xP¨£SEITemp‹ÆLevñ0Index
(
SEITemp‹ÆLevñ0Index
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1082 
UI¡
 
vÆ
;

1083 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1084 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "ãmp‹Æ_sub_œyî_zîo_idx" ); 
£i
.
é0Idx
 = val;

1085 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "ú≠_pic_id" ); 
£i
.
øpIdx
 = val;

1086 
	}
}

1089 
Void
 
	gSEIRódî
::
	$xP¨£SEIDecodedPi˘uªHash
(
SEIDecodedPi˘uªHash
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1091 
UI¡
 
byãsRód
 = 0;

1092 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1094 
UI¡
 
vÆ
;

1095 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "hash_type");

1096 
£i
.
mëhod
 = 
°©ic_ˇ°
<
HashTy≥
>(
vÆ
); 
byãsRód
++;

1098 c⁄° 
TCh¨
 *
åa˚Såög
="\0";

1099 
£i
.
mëhod
)

1101 
HASHTYPE_MD5
: 
åa˚Såög
="picture_md5"; ;

1102 
HASHTYPE_CRC
: 
åa˚Såög
="picture_crc"; ;

1103 
HASHTYPE_CHECKSUM
: 
åa˚Såög
="picture_checksum"; ;

1104 : 
	`as£π
(
Ál£
); ;

1107 i‡(
pDecodedMesßgeOuçutSåóm
)

1109 (*
pDecodedMesßgeOuçutSåóm
Ë<< " " << 
°d
::
	`£tw
(55Ë<< 
åa˚Såög
 << ": " << std::
hex
 << std::
	`£tfûl
('0');

1112 
£i
.
m_pi˘uªHash
.
hash
.
	`˛ór
();

1113 ;
byãsRód
 < 
∑ylﬂdSize
; bytesRead++)

1115 
	`£i_ªad_code
–
NULL
, 8, 
vÆ
, 
åa˚Såög
);

1116 
£i
.
m_pi˘uªHash
.
hash
.
	`push_back
((
UCh¨
)
vÆ
);

1117 i‡(
pDecodedMesßgeOuçutSåóm
)

1119 (*
pDecodedMesßgeOuçutSåóm
Ë<< 
°d
::
	`£tw
(2Ë<< 
vÆ
;

1123 i‡(
pDecodedMesßgeOuçutSåóm
)

1125 (*
pDecodedMesßgeOuçutSåóm
Ë<< 
°d
::
dec
 << std::
	`£tfûl
(' ') << "\n";

1127 
	}
}

1130 
Void
 
	gSEIRódî
::
	$xP¨£SEISˇœbÀNe°ög
(
SEISˇœbÀNe°ög
& 
£i
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1132 
UI¡
 
uiCode
;

1133 
SEIMesßges
 
£is
;

1134 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1136 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "bô°ªam_sub£t_Êag" ); 
£i
.
m_bôSåómSub£tFœg
 = uiCode;

1137 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "√°ög_›_Êag" ); 
£i
.
m_√°ögOpFœg
 = uiCode;

1138 i‡(
£i
.
m_√°ögOpFœg
)

1140 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "deÁu…_›_Êag" ); 
£i
.
m_deÁu…OpFœg
 = uiCode;

1141 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "√°ög_num_›s_möus1" ); 
£i
.
m_√°ögNumOpsMöus1
 = uiCode;

1142 
UI¡
 
i
 = 
£i
.
m_deÁu…OpFœg
; i <£i.
m_√°ögNumOpsMöus1
; i++)

1144 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
uiCode
, "√°ög_max_ãmp‹Æ_id_∂us1[i]" ); 
£i
.
m_√°ögMaxTemp‹ÆIdPlus1
[
i
] = uiCode;

1145 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "√°ög_›_idx[i]" ); 
£i
.
m_√°ögOpIdx
[
i
] = uiCode;

1150 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "Æl_œyîs_Êag" ); 
£i
.
m_ÆlLayîsFœg
 = uiCode;

1151 i‡(!
£i
.
m_ÆlLayîsFœg
)

1153 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
uiCode
, "√°ög_no_›_max_ãmp‹Æ_id_∂us1" ); 
£i
.
m_√°ögNoOpMaxTemp‹ÆIdPlus1
 = uiCode;

1154 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "√°ög_num_œyîs_möus1" ); 
£i
.
m_√°ögNumLayîsMöus1
 = uiCode;

1155 
UI¡
 
i
 = 0; i <
£i
.
m_√°ögNumLayîsMöus1
; i++)

1157 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 6, 
uiCode
, "√°ög_œyî_id[i]" ); 
£i
.
m_√°ögLayîId
[
i
] = uiCode;

1163  
m_pcBô°ªam
->
	`gëNumBôsRód
() % 8 != 0 )

1165 
UI¡
 
code
;

1166 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "nesting_zero_bit" );

1172 if(
«lUnôTy≥
 =
NAL_UNIT_PREFIX_SEI
)

1174 
	`xRódSEImesßge
(
£i
.
m_√°edSEIs
, 
«lUnôTy≥
, 
•s
, 
pDecodedMesßgeOuçutSåóm
, 
SEI
::
¥efix_£i_mesßges
, 
°d
::
	`°rög
("scalableÇested SEI"));

1178 
	`xRódSEImesßge
(
£i
.
m_√°edSEIs
, 
«lUnôTy≥
, 
•s
, 
pDecodedMesßgeOuçutSåóm
, 
SEI
::
suffix_£i_mesßges
, 
°d
::
	`°rög
("scalableÇested SEI"));

1180 } 
m_pcBô°ªam
->
	`gëNumBôsLe·
() > 8);

1182 i‡(
pDecodedMesßgeOuçutSåóm
)

1184 (*
pDecodedMesßgeOuçutSåóm
) << "End of scalableÇesting SEI message\n";

1186 
	}
}

1189 
Void
 
	gSEIRódî
::
	$xP¨£SEIRegi⁄Re‰eshInfo
(
SEIRegi⁄Re‰eshInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1191 
UI¡
 
vÆ
;

1192 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1193 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "ª‰eshed_ªgi⁄_Êag" ); 
£i
.
m_gdrF‹egroundFœg
 = val ? 1 : 0;

1194 
	}
}

1197 
Void
 
	gSEIRódî
::
	$xP¨£SEINoDi•œy
(
SEINoDi•œy
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1199 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1200 
£i
.
m_noDi•œy
 = 
åue
;

1201 
	}
}

1204 
Void
 
	gSEIRódî
::
	$xP¨£SEITimeCode
(
SEITimeCode
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1206 
UI¡
 
code
;

1207 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1208 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 2, 
code
, "num_˛ock_ts"); 
£i
.
numClockTs
 = code;

1209 
I¡
 
i
 = 0; i < 
£i
.
numClockTs
; i++)

1211 
TComSEITimeSë
 
cuºítTimeSë
;

1212 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "˛ock_time_°amp_Êag[i]"); 
cuºítTimeSë
.
˛ockTimeSèmpFœg
 = code;

1213 if(
cuºítTimeSë
.
˛ockTimeSèmpFœg
)

1215 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "nuô_fõld_ba£d_Êag"); 
cuºítTimeSë
.
numUnôFõldBa£dFœg
 = code;

1216 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 5, 
code
, "cou¡ög_ty≥"); 
cuºítTimeSë
.
cou¡ögTy≥
 = code;

1217 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "fuŒ_time°amp_Êag"); 
cuºítTimeSë
.
fuŒTimeSèmpFœg
 = code;

1218 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "disc⁄töuôy_Êag"); 
cuºítTimeSë
.
disc⁄töuôyFœg
 = code;

1219 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "˙t_dr›≥d_Êag"); 
cuºítTimeSë
.
˙tDr›≥dFœg
 = code;

1220 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 9, 
code
, "n_‰ames"); 
cuºítTimeSë
.
numbîOfFømes
 = code;

1221 if(
cuºítTimeSë
.
fuŒTimeSèmpFœg
)

1223 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 6, 
code
, "£c⁄ds_vÆue"); 
cuºítTimeSë
.
£c⁄dsVÆue
 = code;

1224 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 6, 
code
, "möuãs_vÆue"); 
cuºítTimeSë
.
möuãsVÆue
 = code;

1225 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 5, 
code
, "hours_vÆue"); 
cuºítTimeSë
.
hoursVÆue
 = code;

1229 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "£c⁄ds_Êag"); 
cuºítTimeSë
.
£c⁄dsFœg
 = code;

1230 if(
cuºítTimeSë
.
£c⁄dsFœg
)

1232 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 6, 
code
, "£c⁄ds_vÆue"); 
cuºítTimeSë
.
£c⁄dsVÆue
 = code;

1233 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "möuãs_Êag"); 
cuºítTimeSë
.
möuãsFœg
 = code;

1234 if(
cuºítTimeSë
.
möuãsFœg
)

1236 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 6, 
code
, "möuãs_vÆue"); 
cuºítTimeSë
.
möuãsVÆue
 = code;

1237 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "hours_Êag"); 
cuºítTimeSë
.
hoursFœg
 = code;

1238 if(
cuºítTimeSë
.
hoursFœg
)

1240 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 5, 
code
, "hours_vÆue"); 
cuºítTimeSë
.
hoursVÆue
 = code;

1245 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 5, 
code
, "time_off£t_Àngth"); 
cuºítTimeSë
.
timeOff£tLígth
 = code;

1246 if(
cuºítTimeSë
.
timeOff£tLígth
 > 0)

1248 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 
cuºítTimeSë
.
timeOff£tLígth
, 
code
, "time_offset_value");

1249 if((
code
 & (1 << (
cuºítTimeSë
.
timeOff£tLígth
-1))) == 0)

1251 
cuºítTimeSë
.
timeOff£tVÆue
 = 
code
;

1255 
code
 &(1<< (
cuºítTimeSë
.
timeOff£tLígth
-1)) - 1;

1256 
cuºítTimeSë
.
timeOff£tVÆue
 = ~
code
 + 1;

1260 
£i
.
timeSëAºay
[
i
] = 
cuºítTimeSë
;

1262 
	}
}

1265 
Void
 
	gSEIRódî
::
	$xP¨£SEIMa°îögDi•œyCﬁourVﬁume
(
SEIMa°îögDi•œyCﬁourVﬁume
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1267 
UI¡
 
code
;

1268 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1270 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "di•œy_¥im¨õs_x[0]" ); 
£i
.
vÆues
.
¥im¨õs
[0][0] = code;

1271 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "di•œy_¥im¨õs_y[0]" ); 
£i
.
vÆues
.
¥im¨õs
[0][1] = code;

1273 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "di•œy_¥im¨õs_x[1]" ); 
£i
.
vÆues
.
¥im¨õs
[1][0] = code;

1274 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "di•œy_¥im¨õs_y[1]" ); 
£i
.
vÆues
.
¥im¨õs
[1][1] = code;

1276 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "di•œy_¥im¨õs_x[2]" ); 
£i
.
vÆues
.
¥im¨õs
[2][0] = code;

1277 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "di•œy_¥im¨õs_y[2]" ); 
£i
.
vÆues
.
¥im¨õs
[2][1] = code;

1280 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "whôe_poöt_x" ); 
£i
.
vÆues
.
whôePoöt
[0] = code;

1281 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "whôe_poöt_y" ); 
£i
.
vÆues
.
whôePoöt
[1] = code;

1283 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
code
, "max_di•œy_ma°îög_lumö™˚" ); 
£i
.
vÆues
.
maxLumö™˚
 = code;

1284 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
code
, "mö_di•œy_ma°îög_lumö™˚" ); 
£i
.
vÆues
.
möLumö™˚
 = code;

1285 
	}
}

1288 
Void
 
	gSEIRódî
::
	$xP¨£SEISegmíãdRe˘FømePackög
(
SEISegmíãdRe˘FømePackög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1290 
UI¡
 
vÆ
;

1291 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1292 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "£gmíãd_ª˘_‰ame_∑ckög_¨øngemít_ˇn˚l_Êag" ); 
£i
.
m_¨øngemítC™˚lFœg
 = val;

1293 if–!
£i
.
m_¨øngemítC™˚lFœg
 )

1295 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 2, 
vÆ
, "£gmíãd_ª˘_c⁄ã¡_öãΩªèti⁄_ty≥" ); 
£i
.
m_c⁄ã¡I¡î¥ë©i⁄Ty≥
 = val;

1296 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "£gmíãd_ª˘_‰ame_∑ckög_¨øngemít_≥rsi°í˚" ); 
£i
.
m_¨øngemítPîsi°í˚Fœg
 = val;

1298 
	}
}

1301 
Void
 
	gSEIRódî
::
	$xP¨£SEITempMŸi⁄C⁄°øötsTûeSës
(
SEITempMŸi⁄C⁄°øöedTûeSës
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1303 
UI¡
 
code
;

1304 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1305 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag"); 
£i
.
m_mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag
 = (code != 0);

1306 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "óch_tûe_⁄e_tûe_£t_Êag"); 
£i
.
m_óch_tûe_⁄e_tûe_£t_Êag
 = (code != 0);

1308 if(!
£i
.
m_óch_tûe_⁄e_tûe_£t_Êag
)

1310 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "limôed_tûe_£t_di•œy_Êag"); 
£i
.
m_limôed_tûe_£t_di•œy_Êag
 = (code != 0);

1311 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "num_£ts_ö_mesßge_möus1"); 
£i
.
	`£tNumbîOfTûeSës
(code + 1);

1313 if(
£i
.
	`gëNumbîOfTûeSës
() != 0)

1315 
I¡
 
i
 = 0; i < 
£i
.
	`gëNumbîOfTûeSës
(); i++)

1317 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "m˘s_id"); 
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_id
 = code;

1319 if(
£i
.
m_limôed_tûe_£t_di•œy_Êag
)

1321 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "di•œy_tûe_£t_Êag"); 
£i
.
	`tûeSëD©a
(
i
).
m_di•œy_tûe_£t_Êag
 = (code != 1);

1324 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "num_tûe_ª˘s_ö_£t_möus1"); 
£i
.
	`tûeSëD©a
(
i
).
	`£tNumbîOfTûeRe˘s
(code + 1);

1326 
I¡
 
j
=0; j<
£i
.
	`tûeSëD©a
(
i
).
	`gëNumbîOfTûeRe˘s
(); j++)

1328 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "t›_À·_tûe_ödex"); 
£i
.
	`tûeSëD©a
(
i
).
	`t›Le·TûeIndex
(
j
) = code;

1329 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
code
, "bŸtom_right_tûe_ödex"); 
£i
.
	`tûeSëD©a
(
i
).
	`bŸtomRightTûeIndex
(
j
) = code;

1332 if(!
£i
.
m_mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag
)

1334 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "exa˘_ßm∂e_vÆue_m©ch_Êag"); 
£i
.
	`tûeSëD©a
(
i
).
m_exa˘_ßm∂e_vÆue_m©ch_Êag
 = (code != 0);

1336 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "m˘s_tõr_Àvñ_idc_¥e£¡_Êag"); 
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_tõr_Àvñ_idc_¥e£¡_Êag
 = (code != 0);

1338 if(
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_tõr_Àvñ_idc_¥e£¡_Êag
)

1340 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "m˘s_tõr_Êag"); 
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_tõr_Êag
 = (code != 0);

1341 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "m˘s_Àvñ_idc"); 
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_Àvñ_idc
 = code;

1348 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "max_mcs_tõr_Àvñ_idc_¥e£¡_Êag"); 
£i
.
m_max_mcs_tõr_Àvñ_idc_¥e£¡_Êag
 = code;

1349 if(
£i
.
m_max_mcs_tõr_Àvñ_idc_¥e£¡_Êag
)

1351 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "max_m˘s_tõr_Êag"); 
£i
.
m_max_m˘s_tõr_Êag
 = code;

1352 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "max_m˘s_Àvñ_idc"); 
£i
.
m_max_m˘s_Àvñ_idc
 = code;

1355 
	}
}

1357 #i‡
MCTS_EXTRACTION


1358 
Void
 
	gSEIRódî
::
	$xP¨£SEIMCTSExåa˘i⁄InfoSë
(
SEIMCTSExåa˘i⁄InfoSë
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1360 
UI¡
 
code
;

1361 
UI¡
 
numInfoSësMöus1
;

1362 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1364 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "num_£ts_ö_mesßge_möus1"); 
numInfoSësMöus1
 = code;

1365 
I¡
 
i
 = 0; i <
numInfoSësMöus1
; i++)

1367 
SEIMCTSExåa˘i⁄InfoSë
::
MCTSExåa˘i⁄Info
 
EIS
;

1369 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "num_mcts_sets_minus1[ i ]");

1370 
EIS
.
m_idxOfM˘sInSë
.
	`ªsize
(
code
 + 1);

1371 
I¡
 
j
 = 0; j < 
EIS
.
m_idxOfM˘sInSë
.
	`size
(); j++)

1373 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "num_mcts_in_set_minus1[ i ][ j ]");

1374 
EIS
.
m_idxOfM˘sInSë
[
j
].
	`ªsize
(
code
 + 1);

1375 
I¡
 
k
 = 0; k < 
EIS
.
m_idxOfM˘sInSë
[
j
].
	`size
(); k++)

1377 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "idx_of_m˘s_ö_£t[ i ][ j ][ k ]"); 
EIS
.
m_idxOfM˘sInSë
[
j
][
k
] = code;

1380 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
code
, "¶i˚_ª‹dîög_íabÀd_Êag[ i ]"); 
EIS
.
m_¶i˚Re‹dîögE«bÀdFœg
 = (code != 0);

1381 i‡(
EIS
.
m_¶i˚Re‹dîögE«bÀdFœg
)

1383 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "num_slice_segments_minus1[ i ]");

1384 
EIS
.
m_ouçutSli˚SegmítAddªss
.
	`ªsize
(
code
 + 1);

1385 
I¡
 
j
 = 0; j < 
EIS
.
m_ouçutSli˚SegmítAddªss
.
	`size
(); j++)

1387 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "ouçut_¶i˚_£gmít_addªss[ i ][ j ]"); 
EIS
.
m_ouçutSli˚SegmítAddªss
[
j
] = code;

1391 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "num_vps_in_info_set_minus1[i]");

1392 
EIS
.
m_vpsRb•D©a
.
	`ªsize
(
code
 + 1);

1393 
EIS
.
m_vpsRb•D©aLígth
.
	`ªsize
(
code
 + 1);

1394 
I¡
 
j
 = 0; j < 
EIS
.
m_vpsRb•D©aLígth
.
	`size
(); j++)

1396 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "vps_rb•_d©a_Àngth[i][j]"); 
EIS
.
m_vpsRb•D©aLígth
[
j
] = code;

1398 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "num_sps_in_info_set_minus1[i]");

1399 
EIS
.
m_•sRb•D©a
.
	`ªsize
(
code
 + 1);

1400 
EIS
.
m_•sRb•D©aLígth
.
	`ªsize
(
code
 + 1);

1401 
I¡
 
j
 = 0; j < 
EIS
.
m_•sRb•D©aLígth
.
	`size
(); j++)

1403 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "•s_rb•_d©a_Àngth[i][j]"); 
EIS
.
m_•sRb•D©aLígth
[
j
] = code;

1405 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "num_pps_in_info_set_minus1[i]");

1406 
EIS
.
m_µsRb•D©a
.
	`ªsize
(
code
 + 1);

1407 
EIS
.
m_µsNuhTemp‹ÆIdPlus1
.
	`ªsize
(
code
 + 1);

1408 
EIS
.
m_µsRb•D©aLígth
.
	`ªsize
(
code
 + 1);

1409 
I¡
 
j
 = 0; j < 
EIS
.
m_µsRb•D©aLígth
.
	`size
(); j++)

1411 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "µs_nuh_ãmp‹Æ_id_∂us1[i][j]"); 
EIS
.
m_µsNuhTemp‹ÆIdPlus1
[
j
] = code;

1412 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "•s_rb•_d©a_Àngth[i][j]"); 
EIS
.
m_µsRb•D©aLígth
[
j
] = code;

1416 
m_pcBô°ªam
->
	`gëNumBôsRód
() % 8 != 0)

1418 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
code
, "mcts_alignment_bit_equal_to_zero");

1421 
I¡
 
j
 = 0; j < 
EIS
.
m_vpsRb•D©a
.
	`size
(); j++)

1423 
EIS
.
m_vpsRb•D©a
[
j
].
	`ªsize
(EIS.
m_vpsRb•D©aLígth
[j]);

1424 
I¡
 
k
 = 0; k < 
EIS
.
m_vpsRb•D©aLígth
[
j
]; k++)

1426 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "vps_rb•_d©a_byã[ i ][ j ][ k ]"); 
EIS
.
m_vpsRb•D©a
[
j
][
k
] = code;

1429 
I¡
 
j
 = 0; j < 
EIS
.
m_•sRb•D©a
.
	`size
(); j++)

1431 
EIS
.
m_•sRb•D©a
[
j
].
	`ªsize
(EIS.
m_•sRb•D©aLígth
[j]);

1432 
I¡
 
k
 = 0; k < 
EIS
.
m_•sRb•D©aLígth
[
j
]; k++)

1434 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "•s_rb•_d©a_byã[ i ][ j ][ k ]"); 
EIS
.
m_•sRb•D©a
[
j
][
k
] = code;

1437 
I¡
 
j
 = 0; j < 
EIS
.
m_µsRb•D©a
.
	`size
(); j++)

1439 
EIS
.
m_µsRb•D©a
[
j
].
	`ªsize
(EIS.
m_µsRb•D©aLígth
[j]);

1440 
I¡
 
k
 = 0; k < 
EIS
.
m_µsRb•D©aLígth
[
j
]; k++)

1442 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "µs_rb•_d©a_byã[ i ][ j ][ k ]"); 
EIS
.
m_µsRb•D©a
[
j
][
k
] = code;

1445 
£i
.
m_MCTSExåa˘i⁄InfoSës
.
	`push_back
(
EIS
);

1447 
	}
}

1451 
Void
 
	gSEIRódî
::
	$xP¨£SEIChromaReßm∂ögFûãrHöt
(
SEIChromaReßm∂ögFûãrHöt
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1453 
UI¡
 
uiCode
;

1454 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1456 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiCode
, "vî_chroma_fûãr_idc"); 
£i
.
m_vîChromaFûãrIdc
 = uiCode;

1457 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiCode
, "h‹_chroma_fûãr_idc"); 
£i
.
m_h‹ChromaFûãrIdc
 = uiCode;

1458 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "vî_fûãrög_fõld_¥o˚ssög_Êag"); 
£i
.
m_vîFûãrögFõldPro˚ssögFœg
 = uiCode;

1459 if(
£i
.
m_vîChromaFûãrIdc
 =1 || sei.
m_h‹ChromaFûãrIdc
 == 1)

1461 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
uiCode
, "èrgë_f‹m©_idc"); 
£i
.
m_èrgëF‹m©Idc
 = uiCode;

1462 if(
£i
.
m_vîChromaFûãrIdc
 == 1)

1464 
UI¡
 
numVîtiˇlFûãrs
;

1465 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
numVîtiˇlFûãrs
, "num_vîtiˇl_fûãrs"); 
£i
.
m_vîFûãrC€ff
.
	`ªsize
(numVerticalFilters);

1466 if(
numVîtiˇlFûãrs
 > 0)

1468 
I¡
 
i
 = 0; i < 
numVîtiˇlFûãrs
; i++)

1470 
UI¡
 
vîT≠LígthMöus1
;

1471 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vîT≠LígthMöus1
, "vî_èp_Àngth_möus_1"); 
£i
.
m_vîFûãrC€ff
[
i
].
	`ªsize
(verTapLengthMinus1+1);

1472 
I¡
 
j
 = 0; j < (
vîT≠LígthMöus1
 + 1); j++)

1474 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
£i
.
m_vîFûãrC€ff
[
i
][
j
], "ver_filter_coeff");

1479 if(
£i
.
m_h‹ChromaFûãrIdc
 == 1)

1481 
UI¡
 
numH‹iz⁄èlFûãrs
;

1482 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
numH‹iz⁄èlFûãrs
, "num_h‹iz⁄èl_fûãrs"); 
£i
.
m_h‹FûãrC€ff
.
	`ªsize
(numHorizontalFilters);

1483 if(
numH‹iz⁄èlFûãrs
 > 0)

1485 
I¡
 
i
 = 0; i < 
numH‹iz⁄èlFûãrs
; i++)

1487 
UI¡
 
h‹T≠LígthMöus1
;

1488 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
h‹T≠LígthMöus1
, "h‹_èp_Àngth_möus_1"); 
£i
.
m_h‹FûãrC€ff
[
i
].
	`ªsize
(horTapLengthMinus1+1);

1489 
I¡
 
j
 = 0; j < (
h‹T≠LígthMöus1
 + 1); j++)

1491 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
£i
.
m_h‹FûãrC€ff
[
i
][
j
], "hor_filter_coeff");

1497 
	}
}

1500 
Void
 
	gSEIRódî
::
	$xP¨£SEIK√eFun˘i⁄Info
(
SEIK√eFun˘i⁄Info
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1502 
I¡
 
i
;

1503 
UI¡
 
vÆ
;

1504 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1506 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "k√e_fun˘i⁄_id" ); 
£i
.
m_k√eId
 = val;

1507 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "k√e_fun˘i⁄_ˇn˚l_Êag" ); 
£i
.
m_k√eC™˚lFœg
 = val;

1508 i‡–!
£i
.
m_k√eC™˚lFœg
 )

1510 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "k√e_fun˘i⁄_≥rsi°í˚_Êag" ); 
£i
.
m_k√ePîsi°í˚Fœg
 = val;

1511 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "öput_d_ønge" ); 
£i
.
m_k√eI≈utDønge
 = val;

1512 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "öput_di•_lumö™˚" ); 
£i
.
m_k√eI≈utDi•Lumö™˚
 = val;

1513 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "ouçut_d_ønge" ); 
£i
.
m_k√eOuçutDønge
 = val;

1514 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "ouçut_di•_lumö™˚" ); 
£i
.
m_k√eOuçutDi•Lumö™˚
 = val;

1515 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "num_k√e_poöts_möus1" ); 
£i
.
m_k√eNumK√ePoötsMöus1
 = val;

1516 
	`as£π
–
£i
.
m_k√eNumK√ePoötsMöus1
 > 0 );

1517 
£i
.
m_k√eI≈utK√ePoöt
.
	`ªsize
(£i.
m_k√eNumK√ePoötsMöus1
+1);

1518 
£i
.
m_k√eOuçutK√ePoöt
.
	`ªsize
(£i.
m_k√eNumK√ePoötsMöus1
+1);

1519 
i
 = 0; i <
£i
.
m_k√eNumK√ePoötsMöus1
; i++ )

1521 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 10, 
vÆ
, "öput_k√e_poöt" ); 
£i
.
m_k√eI≈utK√ePoöt
[
i
] = val;

1522 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 10, 
vÆ
, "ouçut_k√e_poöt" ); 
£i
.
m_k√eOuçutK√ePoöt
[
i
] = val;

1525 
	}
}

1527 
Void
 
	gSEIRódî
::
	$xP¨£SEIC⁄ã¡CﬁourVﬁume
(
SEIC⁄ã¡CﬁourVﬁume
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1529 
I¡
 
i
;

1530 
UI¡
 
vÆ
;

1531 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1533 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "ccv_ˇn˚l_Êag" ); 
£i
.
m_ccvC™˚lFœg
 = val;

1534 i‡–!
£i
.
m_ccvC™˚lFœg
 )

1536 
I¡
 
iVÆ
;

1537 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "ccv_≥rsi°í˚_Êag" ); 
£i
.
m_ccvPîsi°í˚Fœg
 = val;

1538 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "ccv_¥im¨õs_¥e£¡_Êag" ); 
£i
.
m_ccvPrim¨õsPª£¡Fœg
 = val;

1539 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "ccv_mö_lumö™˚_vÆue_¥e£¡_Êag" ); 
£i
.
m_ccvMöLumö™˚VÆuePª£¡Fœg
 = val;

1540 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "ccv_max_lumö™˚_vÆue_¥e£¡_Êag" ); 
£i
.
m_ccvMaxLumö™˚VÆuePª£¡Fœg
 = val;

1541 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "ccv_avg_lumö™˚_vÆue_¥e£¡_Êag" ); 
£i
.
m_ccvAvgLumö™˚VÆuePª£¡Fœg
 = val;

1543 i‡(
£i
.
m_ccvPrim¨õsPª£¡Fœg
)

1545 
i
 = 0; i < 
MAX_NUM_COMPONENT
; i++)

1547 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
iVÆ
, "ccv_¥im¨õs_x[i]" ); 
£i
.
m_ccvPrim¨õsX
[
i
] = iVal;

1548 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
iVÆ
, "ccv_¥im¨õs_y[i]" ); 
£i
.
m_ccvPrim¨õsY
[
i
] = iVal;

1551 i‡(
£i
.
m_ccvMöLumö™˚VÆuePª£¡Fœg
)

1553 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "ccv_mö_lumö™˚_vÆue" ); 
£i
.
m_ccvMöLumö™˚VÆue
 = val;

1555 i‡(
£i
.
m_ccvMaxLumö™˚VÆuePª£¡Fœg
)

1557 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "ccv_max_lumö™˚_vÆue" ); 
£i
.
m_ccvMaxLumö™˚VÆue
 = val;

1559 i‡(
£i
.
m_ccvAvgLumö™˚VÆuePª£¡Fœg
)

1561 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "ccv_avg_lumö™˚_vÆue" ); 
£i
.
m_ccvAvgLumö™˚VÆue
 = val;

1564 
	}
}

1566 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


1567 
Void
 
	gSEIRódî
::
	$xP¨£SEIShuâîI¡îvÆ
(
SEIShuâîI¡îvÆInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1569 
I¡
 
i
;

1570 
UI¡
 
vÆ
;

1571 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1572 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "sii_time_sˇÀ"); 
£i
.
m_siiTimeSˇÀ
 = val;

1573 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "fixed_shuâî_öãrvÆ_wôhö_˛vs_Êag"); 
£i
.
m_siiFixedSIwôhöCLVS
 = val;

1574 i‡(
£i
.
m_siiFixedSIwôhöCLVS
)

1576 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "sii_num_unôs_ö_shuâî_öãrvÆ"); 
£i
.
m_siiNumUnôsInShuâîI¡îvÆ
 = val;

1580 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 3, 
vÆ
, "sii_max_sub_œyîs_möus1 "); 
£i
.
m_siiMaxSubLayîsMöus1
 = val;

1581 
£i
.
m_siiSubLayîNumUnôsInSI
.
	`ªsize
(£i.
m_siiMaxSubLayîsMöus1
 + 1);

1582 
i
 = 0; i <
£i
.
m_siiMaxSubLayîsMöus1
; i++)

1584 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "sub_layer_num_units_in_shutter_interval[ i ]");

1585 
£i
.
m_siiSubLayîNumUnôsInSI
[
i
] = 
vÆ
;

1588 
	}
}

1591 
Void
 
	gSEIRódî
::
	$xP¨£SEIEquúe˘™guœrProje˘i⁄
(
SEIEquúe˘™guœrProje˘i⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1593 
UI¡
 
vÆ
;

1594 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1596 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "îp_ˇn˚l_Êag" ); 
£i
.
m_îpC™˚lFœg
 = val;

1597 if–!
£i
.
m_îpC™˚lFœg
 )

1599 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "îp_≥rsi°í˚_Êag" ); 
£i
.
m_îpPîsi°í˚Fœg
 = val;

1600 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "îp_gu¨d_b™d_Êag" ); 
£i
.
m_îpGu¨dB™dFœg
 = val;

1601 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 2, 
vÆ
, "erp_reserved_zero_2bits" );

1602 i‡–
£i
.
m_îpGu¨dB™dFœg
 == 1)

1604 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
vÆ
, "îp_gu¨d_b™d_ty≥" ); 
£i
.
m_îpGu¨dB™dTy≥
 = val;

1605 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "îp_À·_gu¨d_b™d_width" ); 
£i
.
m_îpLe·Gu¨dB™dWidth
 = val;

1606 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "îp_right_gu¨d_b™d_width"); 
£i
.
m_îpRightGu¨dB™dWidth
 = val;

1609 
	}
}

1611 
Void
 
	gSEIRódî
::
	$xP¨£SEISphîeRŸ©i⁄
(
SEISphîeRŸ©i⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1613 
UI¡
 
vÆ
;

1614 
I¡
 
svÆ
;

1615 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1616 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "•hîe_rŸ©i⁄_ˇn˚l_Êag" ); 
£i
.
m_•hîeRŸ©i⁄C™˚lFœg
 = val;

1617 if–!
£i
.
m_•hîeRŸ©i⁄C™˚lFœg
 )

1619 
	`£i_ªad_Êag
 ( 
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "•hîe_rŸ©i⁄_≥rsi°í˚_Êag" ); 
£i
.
m_•hîeRŸ©i⁄Pîsi°í˚Fœg
 = val;

1620 
	`£i_ªad_code
 ( 
pDecodedMesßgeOuçutSåóm
, 6, 
vÆ
, "sphere_rotation_reserved_zero_6bits" );

1621 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
svÆ
, "•hîe_rŸ©i⁄_yaw" ); 
£i
.
m_•hîeRŸ©i⁄Yaw
 = sval;

1622 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
svÆ
, "•hîe_rŸ©i⁄_pôch" ); 
£i
.
m_•hîeRŸ©i⁄Pôch
 = sval;

1623 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
svÆ
, "•hîe_rŸ©i⁄_rﬁl" ); 
£i
.
m_•hîeRŸ©i⁄Rﬁl
 = sval;

1625 
	}
}

1627 
Void
 
	gSEIRódî
::
	$xP¨£SEIOmniVõwp‹t
(
SEIOmniVõwp‹t
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1629 
UI¡
 
code
;

1630 
I¡
 
scode
;

1631 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1632 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 10, 
code
, "omni_võwp‹t_id" ); 
£i
.
m_omniVõwp‹tId
 = code;

1633 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "omni_võwp‹t_ˇn˚l_Êag" ); 
£i
.
m_omniVõwp‹tC™˚lFœg
 = code;

1634 i‡(!
£i
.
m_omniVõwp‹tC™˚lFœg
)

1636 
UI¡
 
numRegi⁄s
;

1637 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
code
, "omni_võwp‹t_≥rsi°í˚_Êag" ); 
£i
.
m_omniVõwp‹tPîsi°í˚Fœg
 = code;

1638 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
numRegi⁄s
, "omni_viewport_cnt_minus1" );ÇumRegions++;

1639 
£i
.
m_omniVõwp‹tRegi⁄s
.
	`ªsize
(
numRegi⁄s
);

1640 
UI¡
 
ªgi⁄
=0;Ñegi⁄<
numRegi⁄s
;Ñegion++)

1642 
SEIOmniVõwp‹t
::
OmniVõwp‹t
 &
võwp‹t
 = 
£i
.
m_omniVõwp‹tRegi⁄s
[
ªgi⁄
];

1643 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
scode
, "omni_võwp‹t_azimuth_˚¡ª" ); 
võwp‹t
.
azimuthCíåe
 = scode;

1644 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
scode
, "omni_võwp‹t_ñev©i⁄_˚¡ª" ); 
võwp‹t
.
ñev©i⁄Cíåe
 = scode;

1645 
	`£i_ªad_scode
–
pDecodedMesßgeOuçutSåóm
, 32, 
scode
, "omni_võwp‹t_tût_˚¡ª" ); 
võwp‹t
.
tûtCíåe
 = 
code
;

1646 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
code
, "omni_võwp‹t_h‹_ønge" ); 
võwp‹t
.
h‹R™ge
 = code;

1647 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
code
, "omni_võwp‹t_vî_ønge" ); 
võwp‹t
.
vîR™ge
 = code;

1652 
£i
.
m_omniVõwp‹tRegi⁄s
.
	`˛ór
();

1653 
£i
.
m_omniVõwp‹tPîsi°í˚Fœg
=
Ál£
;

1655 
	}
}

1657 
Void
 
	gSEIRódî
::
	$xP¨£SEIA¬Ÿ©edRegi⁄s
(
SEIA¬Ÿ©edRegi⁄s
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1659 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1660 
UI¡
 
vÆ
;

1662 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_ˇn˚l_Êag"); 
£i
.
m_hdr
.
m_ˇn˚lFœg
 = val;

1663 i‡(!
£i
.
m_hdr
.
m_ˇn˚lFœg
)

1665 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_nŸ_›timized_f‹_võwög_Êag"); 
£i
.
m_hdr
.
m_nŸO±imizedF‹VõwögFœg
 = val;

1666 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_åue_mŸi⁄_Êag"); 
£i
.
m_hdr
.
m_åueMŸi⁄Fœg
 = val;

1667 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_oc˛uded_obje˘_Êag"); 
£i
.
m_hdr
.
m_oc˛udedObje˘Fœg
 = val;

1668 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_∑πül_obje˘_Êag_¥e£¡_Êag"); 
£i
.
m_hdr
.
m_∑πülObje˘FœgPª£¡Fœg
 = val;

1669 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_obje˘_œbñ_¥e£¡_Êag"); 
£i
.
m_hdr
.
m_obje˘LabñPª£¡Fœg
 = val;

1670 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_obje˘_c⁄fidí˚_öfo_¥e£¡_Êag"); 
£i
.
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
 = val;

1671 i‡(
£i
.
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
)

1673 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 4, 
vÆ
, "¨_obje˘_c⁄fidí˚_Àngth_möus_1"); 
£i
.
m_hdr
.
m_obje˘C⁄fidí˚Lígth
 = (val + 1);

1675 i‡(
£i
.
m_hdr
.
m_obje˘LabñPª£¡Fœg
)

1677 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_obje˘_œbñ_œnguage_¥e£¡_Êag"); 
£i
.
m_hdr
.
m_obje˘LabñL™guagePª£¡Fœg
 = val;

1678 i‡(
£i
.
m_hdr
.
m_obje˘LabñL™guagePª£¡Fœg
)

1681 
m_pcBô°ªam
->
	`gëNumBôsRód
() % 8 != 0)

1683 
UI¡
 
code
;

1684 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
code
, "ar_bit_equal_to_zero");

1686 
£i
.
m_hdr
.
m_™nŸ©edRegi⁄sObje˘LabñL™g
.
	`˛ór
();

1689 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "ar_label_language");

1690 i‡(
vÆ
)

1692 
	`as£π
(
£i
.
m_hdr
.
m_™nŸ©edRegi⁄sObje˘LabñL™g
.
	`size
()<256);

1693 
£i
.
m_hdr
.
m_™nŸ©edRegi⁄sObje˘LabñL™g
.
	`push_back
(()
vÆ
);

1695 } 
vÆ
 != '\0');

1699 
UI¡
 
numLabñUpd©es
;

1700 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
numLabñUpd©es
, "ar_num_label_updates");

1701 
	`as£π
(
numLabñUpd©es
<256);

1703 
£i
.
m_™nŸ©edLabñs
.
	`˛ór
();

1704 
£i
.
m_™nŸ©edLabñs
.
	`ªsize
(
numLabñUpd©es
);

1705 autÿ
ô
=
£i
.
m_™nŸ©edLabñs
.
	`begö
(); it!=£i.m_™nŸ©edLabñs.
	`íd
(); it++)

1707 
SEIA¬Ÿ©edRegi⁄s
::
A¬Ÿ©edRegi⁄Labñ
 &
¨
 = 
ô
->
£c⁄d
;

1708 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_œbñ_idx[]"); 
ô
->
fú°
 = val;

1709 
	`as£π
(
vÆ
<256);

1710 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_œbñ_ˇn˚l_Êag"); 
¨
.
œbñVÆid
 = !val;

1711 i‡(
¨
.
œbñVÆid
)

1713 
¨
.
œbñ
.
	`˛ór
();

1715 
m_pcBô°ªam
->
	`gëNumBôsRód
() % 8 != 0)

1717 
UI¡
 
code
;

1718 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
code
, "ar_bit_equal_to_zero");

1722 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "ar_label[]");

1723 i‡(
vÆ
)

1725 
	`as£π
(
¨
.
œbñ
.
	`size
()<256);

1726 
¨
.
œbñ
.
	`push_back
(()
vÆ
);

1728 } 
vÆ
 != '\0');

1732 
UI¡
 
numObjUpd©es
;

1733 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
numObjUpd©es
, "ar_num_object_updates");

1734 
	`as£π
(
numObjUpd©es
<256);

1735 
£i
.
m_™nŸ©edRegi⁄s
.
	`˛ór
();

1736 
£i
.
m_™nŸ©edRegi⁄s
.
	`ªsize
(
numObjUpd©es
);

1737 autÿ
ô
=
£i
.
m_™nŸ©edRegi⁄s
.
	`begö
(); it!=£i.m_™nŸ©edRegi⁄s.
	`íd
(); it++)

1739 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_obje˘_idx"); 
ô
->
fú°
=val;

1740 
	`as£π
(
vÆ
<256);

1741 
SEIA¬Ÿ©edRegi⁄s
::
A¬Ÿ©edRegi⁄Obje˘
 &
¨
 = 
ô
->
£c⁄d
;

1742 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_obje˘_ˇn˚l_Êag"); 
¨
.
obje˘C™˚lFœg
 = val;

1743 
¨
.
obje˘LabñVÆid
=
Ál£
;

1744 
¨
.
boundögBoxVÆid
=
Ál£
;

1746 i‡(!
¨
.
obje˘C™˚lFœg
)

1748 i‡(
£i
.
m_hdr
.
m_obje˘LabñPª£¡Fœg
)

1750 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_obje˘_œbñ_upd©e_Êag"); 
¨
.
obje˘LabñVÆid
 = val;

1751 i‡(
¨
.
obje˘LabñVÆid
)

1753 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_obje˘_œbñ_idx"); 
¨
.
objLabñIdx
 = val;

1754 
	`as£π
(
vÆ
<256);

1757 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_boundög_box_upd©e_Êag"); 
¨
.
boundögBoxVÆid
 = val;

1758 i‡(
¨
.
boundögBoxVÆid
)

1760 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "¨_boundög_box_t›"); 
¨
.
boundögBoxT›
 = val;

1761 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "¨_boundög_box_À·"); 
¨
.
boundögBoxLe·
 = val;

1762 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "¨_boundög_box_width"); 
¨
.
boundögBoxWidth
 = val;

1763 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "¨_boundög_box_height"); 
¨
.
boundögBoxHeight
 = val;

1764 i‡(
£i
.
m_hdr
.
m_∑πülObje˘FœgPª£¡Fœg
)

1766 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "¨_∑πül_obje˘_Êag"); 
¨
.
∑πülObje˘Fœg
 = val;

1768 i‡(
£i
.
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
)

1770 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 
£i
.
m_hdr
.
m_obje˘C⁄fidí˚Lígth
, 
vÆ
, "¨_obje˘_c⁄fidí˚"); 
¨
.
obje˘C⁄fidí˚
 = val;

1776 
	}
}

1778 
Void
 
	gSEIRódî
::
	$xP¨£SEICubem≠Proje˘i⁄
(
SEICubem≠Proje˘i⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1780 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1781 
UI¡
 
vÆ
;

1783 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "cmp_ˇn˚l_Êag"); 
£i
.
m_cmpC™˚lFœg
 = val;

1784 i‡(!
£i
.
m_cmpC™˚lFœg
)

1786 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "cmp_≥rsi°í˚_Êag"); 
£i
.
m_cmpPîsi°í˚Fœg
 = val;

1788 
	}
}

1792 
Void
 
	gSEIRódî
::
	$xP¨£SEIRegi⁄Wi£Packög
(
SEIRegi⁄Wi£Packög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1794 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1795 
UI¡
 
vÆ
;

1797 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "rwp_ˇn˚l_Êag" ); 
£i
.
m_rwpC™˚lFœg
 = val;

1798 i‡(!
£i
.
m_rwpC™˚lFœg
)

1800 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "rwp_≥rsi°í˚_Êag" ); 
£i
.
m_rwpPîsi°í˚Fœg
 = val;

1801 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "c⁄°ôuít_pi˘uª_m©chög_Êag" ); 
£i
.
m_c⁄°ôuítPi˘uªM©chögFœg
 = val;

1802 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 5, 
vÆ
, "rwp_reserved_zero_5bits" );

1803 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "num_∑cked_ªgi⁄s" ); 
£i
.
m_numPackedRegi⁄s
 = val;

1804 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "¥oj_pi˘uª_width" ); 
£i
.
m_¥ojPi˘uªWidth
 = val;

1805 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "¥oj_pi˘uª_height" ); 
£i
.
m_¥ojPi˘uªHeight
 = val;

1806 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "∑cked_pi˘uª_width" ); 
£i
.
m_∑ckedPi˘uªWidth
 = val;

1807 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "∑cked_pi˘uª_height" ); 
£i
.
m_∑ckedPi˘uªHeight
 = val;

1809 
£i
.
m_rwpTønsf‹mTy≥
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1810 
£i
.
m_rwpGu¨dB™dFœg
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1811 
£i
.
m_¥ojRegi⁄Width
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1812 
£i
.
m_¥ojRegi⁄Height
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1813 
£i
.
m_rwpProjRegi⁄T›
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1814 
£i
.
m_¥ojRegi⁄Le·
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1815 
£i
.
m_∑ckedRegi⁄Width
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1816 
£i
.
m_∑ckedRegi⁄Height
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1817 
£i
.
m_∑ckedRegi⁄T›
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1818 
£i
.
m_∑ckedRegi⁄Le·
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1819 
£i
.
m_rwpLe·Gu¨dB™dWidth
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1820 
£i
.
m_rwpRightGu¨dB™dWidth
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1821 
£i
.
m_rwpT›Gu¨dB™dHeight
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1822 
£i
.
m_rwpBŸtomGu¨dB™dHeight
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1823 
£i
.
m_rwpGu¨dB™dNŸU£dF‹PªdFœg
.
	`ªsize
(£i.
m_numPackedRegi⁄s
);

1824 
£i
.
m_rwpGu¨dB™dTy≥
.
	`ªsize
(4*£i.
m_numPackedRegi⁄s
);

1826  
I¡
 
i
=0; i < 
£i
.
m_numPackedRegi⁄s
; i++ )

1828 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
vÆ
, "rwp_reserved_zero_4bits" );

1829 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
vÆ
, "rwp_tTønsf‹m_ty≥" ); 
£i
.
m_rwpTønsf‹mTy≥
[
i
] = val;

1830 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "rwp_gu¨d_b™d_Êag" ); 
£i
.
m_rwpGu¨dB™dFœg
[
i
] = val;

1831 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "¥oj_ªgi⁄_width" ); 
£i
.
m_¥ojRegi⁄Width
[
i
] = val;

1832 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "¥oj_ªgi⁄_height" ); 
£i
.
m_¥ojRegi⁄Height
[
i
] = val;

1833 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "rwp_¥oj_ªgi⁄T›" ); 
£i
.
m_rwpProjRegi⁄T›
[
i
] = val;

1834 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "¥oj_ªgi⁄_À·" ); 
£i
.
m_¥ojRegi⁄Le·
[
i
] = val;

1835 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "∑cked_ªgi⁄_width" ); 
£i
.
m_∑ckedRegi⁄Width
[
i
] = val;

1836 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "∑cked_ªgi⁄_height" ); 
£i
.
m_∑ckedRegi⁄Height
[
i
] = val;

1837 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "∑cked_ªgi⁄_t›" ); 
£i
.
m_∑ckedRegi⁄T›
[
i
] = val;

1838 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "∑cked_ªgi⁄_À·" ); 
£i
.
m_∑ckedRegi⁄Le·
[
i
] = val;

1839 if–
£i
.
m_rwpGu¨dB™dFœg
[
i
] )

1841 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "rwp_À·_gu¨d_b™d_width" ); 
£i
.
m_rwpLe·Gu¨dB™dWidth
[
i
] = val;

1842 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "rwp_right_gu¨d_b™d_width" ); 
£i
.
m_rwpRightGu¨dB™dWidth
[
i
] = val;

1843 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "rwp_t›_gu¨d_b™d_height" ); 
£i
.
m_rwpT›Gu¨dB™dHeight
[
i
] = val;

1844 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "rwp_bŸtom_gu¨d_b™d_height" ); 
£i
. 
m_rwpBŸtomGu¨dB™dHeight
[
i
] = val;

1845 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "rwp_gu¨d_b™d_nŸ_u£d_f‹Pªd_Êag" ); 
£i
.
m_rwpGu¨dB™dNŸU£dF‹PªdFœg
[
i
] = val;

1846  
I¡
 
j
=0; j < 4; j++ )

1848 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
vÆ
, "rwp_gu¨d_b™d_ty≥" ); 
£i
.
m_rwpGu¨dB™dTy≥
[
i
*4 + 
j
] = val;

1850 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 3, 
vÆ
, "rwp_guard_band_reserved_zero_3bits" );

1854 
	}
}

1856 
Void
 
	gSEIRódî
::
	$xP¨£SEIFisheyeVideoInfo
(
SEIFisheyeVideoInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1858 
UI¡
 
vÆ
;

1860 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1861 
£i
.
vÆues
 = 
	`TComSEIFisheyeVideoInfo
();

1863 
TComSEIFisheyeVideoInfo
 &
öfo
=
£i
.
vÆues
;

1865 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "fisheye_ˇn˚l_Êag"); 
öfo
.
m_fisheyeC™˚lFœg
 = val;

1866 i‡(!
öfo
.
m_fisheyeC™˚lFœg
)

1868 
I¡
 
svÆ
;

1870 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
vÆ
, "fisheye_≥rsi°í˚_Êag"); 
öfo
.
m_fisheyePîsi°í˚Fœg
 = val;

1871 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 3, 
vÆ
, "fisheye_võw_dimísi⁄_idc"); 
öfo
.
m_fisheyeVõwDimísi⁄Idc
 = val;

1872 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 3, 
vÆ
, "fisheye_reserved_zero_3bits");

1873 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
vÆ
, "fisheye_num_active_area_minus1");

1874 
öfo
.
m_fisheyeA˘iveAªas
.
	`ªsize
(
vÆ
+1);

1876 
°d
::
size_t
 
i
 = 0; i < 
öfo
.
m_fisheyeA˘iveAªas
.
	`size
(); i++)

1878 
TComSEIFisheyeVideoInfo
::
A˘iveAªaInfo
 &
¨ó
=
öfo
.
m_fisheyeA˘iveAªas
[
i
];

1879 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_cúcuœr_ªgi⁄_˚¡ª_x[i]"); 
¨ó
.
m_fisheyeCúcuœrRegi⁄CíåeX
 = val;

1880 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_cúcuœr_ªgi⁄_˚¡ª_y[i]"); 
¨ó
.
m_fisheyeCúcuœrRegi⁄CíåeY
 = val;

1881 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_ª˘_ªgi⁄_t›[i]"); 
¨ó
.
m_fisheyeRe˘Regi⁄T›
 = val;

1882 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_ª˘_ªgi⁄_À·[i]"); 
¨ó
.
m_fisheyeRe˘Regi⁄Le·
 = val;

1883 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_ª˘_ªgi⁄_width[i]"); 
¨ó
.
m_fisheyeRe˘Regi⁄Width
 = val;

1884 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_ª˘_ªgi⁄_Height[i]"); 
¨ó
.
m_fisheyeRe˘Regi⁄Height
 = val;

1885 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_cúcuœr_ªgi⁄_ødius[i]"); 
¨ó
.
m_fisheyeCúcuœrRegi⁄Radius
 = val;

1886 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_s˚√_ødius[i]"); 
¨ó
.
m_fisheyeS˚√Radius
 = val;

1888 
	`£i_ªad_scode
(
pDecodedMesßgeOuçutSåóm
, 32, 
svÆ
, "fisheye_ˇmîa_˚¡ª_azimuth[i]"); 
¨ó
.
m_fisheyeCamîaCíåeAzimuth
 = sval;

1889 
	`£i_ªad_scode
(
pDecodedMesßgeOuçutSåóm
, 32, 
svÆ
, "fisheye_ˇmîa_˚¡ª_ñev©i⁄[i]"); 
¨ó
.
m_fisheyeCamîaCíåeEÀv©i⁄
 = sval;

1890 
	`£i_ªad_scode
(
pDecodedMesßgeOuçutSåóm
, 32, 
svÆ
, "fisheye_ˇmîa_˚¡ª_tût[i]"); 
¨ó
.
m_fisheyeCamîaCíåeTût
 = sval;

1892 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_ˇmîa_˚¡ª_off£t_x[i]"); 
¨ó
.
m_fisheyeCamîaCíåeOff£tX
 = val;

1893 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_ˇmîa_˚¡ª_off£t_y[i]"); 
¨ó
.
m_fisheyeCamîaCíåeOff£tY
 = val;

1894 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_ˇmîa_˚¡ª_off£t_z[i]"); 
¨ó
.
m_fisheyeCamîaCíåeOff£tZ
 = val;

1895 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
vÆ
, "fisheye_fõld_of_võw[i]"); 
¨ó
.
m_fisheyeFõldOfVõw
 = val;

1896 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
vÆ
, "fisheye_num_polynomial_coeffs[i]");

1897 
¨ó
.
m_fisheyePﬁynomülC€ff
.
	`ªsize
(
vÆ
);

1899 
°d
::
size_t
 
j
 = 0; j < 
¨ó
.
m_fisheyePﬁynomülC€ff
.
	`size
(); j++)

1901 
	`£i_ªad_scode
(
pDecodedMesßgeOuçutSåóm
, 32, 
svÆ
, "fisheye_pﬁynomül_c€ff[i][j]"); 
¨ó
.
m_fisheyePﬁynomülC€ff
[
j
] = sval;

1905 
	}
}

1907 
Void
 
	gSEIRódî
::
	$xP¨£SEICﬁourRem≠pögInfo
(
SEICﬁourRem≠pögInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
)

1909 
UI¡
 
uiVÆ
;

1910 
I¡
 
iVÆ
;

1911 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

1913 
	`£i_ªad_uvlc
–
pDecodedMesßgeOuçutSåóm
, 
uiVÆ
, "cﬁour_ªm≠_id" ); 
£i
.
m_cﬁourRem≠Id
 = uiVal;

1914 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiVÆ
, "cﬁour_ªm≠_ˇn˚l_Êag" ); 
£i
.
m_cﬁourRem≠C™˚lFœg
 = uiVal;

1915 if–!
£i
.
m_cﬁourRem≠C™˚lFœg
 )

1917 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiVÆ
, "cﬁour_ªm≠_≥rsi°í˚_Êag" ); 
£i
.
m_cﬁourRem≠Pîsi°í˚Fœg
 = uiVal;

1918 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiVÆ
, "cﬁour_ªm≠_video_sig«l_öfo_¥e£¡_Êag" ); 
£i
.
m_cﬁourRem≠VideoSig«lInfoPª£¡Fœg
 = uiVal;

1919 i‡–
£i
.
m_cﬁourRem≠VideoSig«lInfoPª£¡Fœg
 )

1921 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiVÆ
, "cﬁour_ªm≠_fuŒ_ønge_Êag" ); 
£i
.
m_cﬁourRem≠FuŒR™geFœg
 = uiVal;

1922 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiVÆ
, "cﬁour_ªm≠_¥im¨õs" ); 
£i
.
m_cﬁourRem≠Prim¨õs
 = uiVal;

1923 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiVÆ
, "cﬁour_ªm≠_å™s„r_fun˘i⁄" ); 
£i
.
m_cﬁourRem≠Tøns„rFun˘i⁄
 = uiVal;

1924 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiVÆ
, "cﬁour_ªm≠_m©rix_c€fficõ¡s" ); 
£i
.
m_cﬁourRem≠M©rixC€fficõ¡s
 = uiVal;

1926 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiVÆ
, "cﬁour_ªm≠_öput_bô_dïth" ); 
£i
.
m_cﬁourRem≠I≈utBôDïth
 = uiVal;

1927 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiVÆ
, "cﬁour_ªm≠_bô_dïth" ); 
£i
.
m_cﬁourRem≠BôDïth
 = uiVal;

1929  
I¡
 
c
=0 ; c<3 ; c++ )

1931 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiVÆ
, "¥e_lut_num_vÆ_möus1[c]" ); 
£i
.
m_¥eLutNumVÆMöus1
[
c
] = (uiVal==0) ? 1 : uiVal;

1932 
£i
.
m_¥eLut
[
c
].
	`ªsize
(£i.
m_¥eLutNumVÆMöus1
[c]+1);

1933 if–
uiVÆ
> 0 )

1935  
I¡
 
i
=0 ; i<=
£i
.
m_¥eLutNumVÆMöus1
[
c
] ; i++ )

1937 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, (–
£i
.
m_cﬁourRem≠I≈utBôDïth
 + 7 ) >> 3 ) << 3, 
uiVÆ
, "¥e_lut_coded_vÆue[c][i]" ); sei.
m_¥eLut
[
c
][
i
].
codedVÆue
 = uiVal;

1938 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, (–
£i
.
m_cﬁourRem≠BôDïth
 + 7 ) >> 3 ) << 3, 
uiVÆ
, "¥e_lut_èrgë_vÆue[c][i]" ); sei.
m_¥eLut
[
c
][
i
].
èrgëVÆue
 = uiVal;

1943 
£i
.
m_¥eLut
[
c
][0].
codedVÆue
 = 0;

1944 
£i
.
m_¥eLut
[
c
][0].
èrgëVÆue
 = 0;

1945 
£i
.
m_¥eLut
[
c
][1].
codedVÆue
 = (1 << sei.
m_cﬁourRem≠I≈utBôDïth
) - 1 ;

1946 
£i
.
m_¥eLut
[
c
][1].
èrgëVÆue
 = (1 << sei.
m_cﬁourRem≠BôDïth
) - 1 ;

1950 
	`£i_ªad_Êag
–
pDecodedMesßgeOuçutSåóm
, 
uiVÆ
, "cﬁour_ªm≠_m©rix_¥e£¡_Êag" ); 
£i
.
m_cﬁourRem≠M©rixPª£¡Fœg
 = uiVal;

1951 if–
£i
.
m_cﬁourRem≠M©rixPª£¡Fœg
 )

1953 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 4, 
uiVÆ
, "log2_m©rix_díom" ); 
£i
.
m_log2M©rixDíom
 = uiVal;

1954  
I¡
 
c
=0 ; c<3 ; c++ )

1956  
I¡
 
i
=0 ; i<3 ; i++ )

1958 
	`£i_ªad_svlc
–
pDecodedMesßgeOuçutSåóm
, 
iVÆ
, "cﬁour_ªm≠_c€ffs[c][i]" ); 
£i
.
m_cﬁourRem≠C€ffs
[
c
][
i
] = iVal;

1964 
£i
.
m_log2M©rixDíom
 = 10;

1965  
I¡
 
c
=0 ; c<3 ; c++ )

1967  
I¡
 
i
=0 ; i<3 ; i++ )

1969 
£i
.
m_cﬁourRem≠C€ffs
[
c
][
i
] = (c==iË<< sei.
m_log2M©rixDíom
;

1973  
I¡
 
c
=0 ; c<3 ; c++ )

1975 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, 8, 
uiVÆ
, "po°_lut_num_vÆ_möus1[c]" ); 
£i
.
m_po°LutNumVÆMöus1
[
c
] = (uiVal==0) ? 1 : uiVal;

1976 
£i
.
m_po°Lut
[
c
].
	`ªsize
(£i.
m_po°LutNumVÆMöus1
[c]+1);

1977 if–
uiVÆ
 > 0 )

1979  
I¡
 
i
=0 ; i<=
£i
.
m_po°LutNumVÆMöus1
[
c
] ; i++ )

1981 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, (–
£i
.
m_cﬁourRem≠BôDïth
 + 7 ) >> 3 ) << 3, 
uiVÆ
, "po°_lut_coded_vÆue[c][i]" ); sei.
m_po°Lut
[
c
][
i
].
codedVÆue
 = uiVal;

1982 
	`£i_ªad_code
–
pDecodedMesßgeOuçutSåóm
, (–
£i
.
m_cﬁourRem≠BôDïth
 + 7 ) >> 3 ) << 3, 
uiVÆ
, "po°_lut_èrgë_vÆue[c][i]" ); sei.
m_po°Lut
[
c
][
i
].
èrgëVÆue
 = uiVal;

1987 
£i
.
m_po°Lut
[
c
][0].
codedVÆue
 = 0;

1988 
£i
.
m_po°Lut
[
c
][0].
èrgëVÆue
 = 0;

1989 
£i
.
m_po°Lut
[
c
][1].
èrgëVÆue
 = (1 << sei.
m_cﬁourRem≠BôDïth
) - 1;

1990 
£i
.
m_po°Lut
[
c
][1].
codedVÆue
 = (1 << sei.
m_cﬁourRem≠BôDïth
) - 1;

1994 
	}
}

1997 
Void
 
	gSEIRódî
::
	$xP¨£SEIDeöãæa˚FõldIdítifiˇti⁄
–
SEIDeöãæa˚FõldIdítifiˇti⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
 )

1999 
UI¡
 
code
;

2000 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

2002 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
code
, "deöãæa˚d_pi˘uª_sour˚_∑rôy_Êag"); 
£i
.
m_deöãæa˚dPi˘uªSour˚P¨ôyFœg
 = code!=0;

2003 
	}
}

2006 
Void
 
	gSEIRódî
::
	$xP¨£SEIC⁄ã¡LightLevñInfo
–
SEIC⁄ã¡LightLevñInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
 )

2008 
UI¡
 
code
;

2009 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

2011 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "max_c⁄ã¡_light_Àvñ"); 
£i
.
m_maxC⁄ã¡LightLevñ
 = code;

2012 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "max_pic_avîage_light_Àvñ"); 
£i
.
m_maxPicAvîageLightLevñ
 = code;

2013 
	}
}

2016 
Void
 
	gSEIRódî
::
	$xP¨£SEIDïídítRAPIndiˇti⁄
–
SEIDïídítRAPIndiˇti⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
 )

2018 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

2019 
	}
}

2022 
Void
 
	gSEIRódî
::
	$xP¨£SEICodedRegi⁄Com∂ëi⁄
–
SEICodedRegi⁄Com∂ëi⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
 )

2024 
UI¡
 
code
;

2025 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

2027 
	`£i_ªad_uvlc
(
pDecodedMesßgeOuçutSåóm
, 
code
, "√xt_£gmít_addªss"); 
£i
.
m_√xtSegmítAddªss
= code;

2028 i‡(
code
)

2030 
	`£i_ªad_Êag
(
pDecodedMesßgeOuçutSåóm
, 
code
, "ödïídít_¶i˚_£gmít_Êag"); 
£i
.
m_ödïídítSli˚SegmítFœg
 = code!=0;

2034 
£i
.
m_ödïídítSli˚SegmítFœg
=
Ál£
;

2036 
	}
}

2039 
Void
 
	gSEIRódî
::
	$xP¨£SEIA…î«tiveTøns„rCh¨a˘îi°ics
(
SEIA…î«tiveTøns„rCh¨a˘îi°ics
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
o°ªam
* 
pDecodedMesßgeOuçutSåóm
)

2041 
UI¡
 
code
;

2042 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

2044 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
code
, "¥e„ºed_å™s„r_ch¨a˘îi°ics"); 
£i
.
m_¥e„ºedTøns„rCh¨a˘îi°ics
 = code;

2045 
	}
}

2048 
Void
 
	gSEIRódî
::
	$xP¨£SEIAmbõ¡VõwögEnvú⁄mít
–
SEIAmbõ¡VõwögEnvú⁄mít
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
 )

2050 
UI¡
 
code
;

2051 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

2053 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 32, 
code
, "ambõ¡_ûlumö™˚"); 
£i
.
m_ambõ¡IŒumö™˚
= code;

2054 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "ambõ¡_light_x"); 
£i
.
m_ambõ¡LightX
 = (
USh‹t
)code;

2055 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
code
, "ambõ¡_light_y"); 
£i
.
m_ambõ¡LightY
 = (
USh‹t
)code;

2056 
	}
}

2057 
Void
 
	gSEIRódî
::
	$xP¨£SEIRegi⁄ÆNe°ög
–
SEIRegi⁄ÆNe°ög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
 )

2059 
UI¡
 
uiCode
;

2060 
	`ouçut_£i_mesßge_hódî
(
£i
, 
pDecodedMesßgeOuçutSåóm
, 
∑ylﬂdSize
);

2061 
UI¡
 
numRegi⁄s
, 
numSEIs
;

2063 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
uiCode
, "regional_nesting_id");

2064 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
uiCode
, "ªgi⁄Æ_√°ög_num_ª˘_ªgi⁄s"); 
numRegi⁄s
 = uiCode;

2066 
£i
.
	`˛órRegi⁄s
();

2067 
UI¡
 
i
 = 0; i < 
numRegi⁄s
; i++)

2069 
RNSEIWödow
 
ªgi⁄
;

2070 
I¡
 
lOff£t
, 
rOff£t
, 
tOff£t
, 
bOff£t
, 
ªgi⁄Id
;

2071 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
uiCode
, "ªgi⁄Æ_√°ög_ª˘_ªgi⁄_id"); 
ªgi⁄Id
 = uiCode;

2072 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
uiCode
, "ªgi⁄Æ_√°ög_ª˘_À·_off£t"); 
lOff£t
 = uiCode;

2073 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
uiCode
, "ªgi⁄Æ_√°ög_ª˘_right_off£t"); 
rOff£t
 = uiCode;

2074 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
uiCode
, "ªgi⁄Æ_√°ög_ª˘_t›_off£t"); 
tOff£t
 = uiCode;

2075 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 16, 
uiCode
, "ªgi⁄Æ_√°ög_ª˘_bŸtom_off£t"); 
bOff£t
 = uiCode;

2076 
ªgi⁄
.
	`£tRegi⁄Id
(
ªgi⁄Id
);

2077 
ªgi⁄
.
	`£tWödow
(
lOff£t
, 
rOff£t
, 
tOff£t
, 
bOff£t
);

2079 
£i
.
	`addRegi⁄
(&
ªgi⁄
);

2081 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
uiCode
, "num_£i_mesßges_ö_ªgi⁄Æ_√°ög_möus1"); 
numSEIs
 = uiCode + 1;

2082 
UI¡
 
i
 = 0; i < 
numSEIs
; i++)

2084 
SEIRegi⁄ÆNe°ög
::
SEILi°OfIndi˚s
 
£iWôhRegi⁄Indi˚s
;

2085 
UI¡
 
numRegi⁄sF‹SEI
;

2086 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
uiCode
, "num_ªgi⁄s_f‹_£i_mesßge[i]"); 
numRegi⁄sF‹SEI
 = uiCode;

2087 
UI¡
 
j
 = 0; j < 
numRegi⁄sF‹SEI
; j++)

2089 
	`£i_ªad_code
(
pDecodedMesßgeOuçutSåóm
, 8, 
uiCode
, "regional_nesting_sei_region_idx[i][j]");

2090 
£iWôhRegi⁄Indi˚s
.
m_li°OfIndi˚s
.
	`push_back
(
uiCode
);

2093 
SEIMesßges
 
£iReg
;

2094 
	`xRódSEImesßge
(
£iReg
, 
NAL_UNIT_PREFIX_SEI
, 
•s
, 
pDecodedMesßgeOuçutSåóm
, 
SEI
::
ªgi⁄Æ_√°ög_£i_mesßges
, 
°d
::
	`°rög
(""));

2095 
£iWôhRegi⁄Indi˚s
.
m_£iMesßge
 = 
£iReg
.
	`‰⁄t
();

2096 
£i
.
	`addRegi⁄ÆSEI
–
£iWôhRegi⁄Indi˚s
 ) ;

2098 
	}
}

	@TLibDecoder/SEIread.h

39 #i‚de‡
__SEIREAD__


40 
	#__SEIREAD__


	)

42 #i‡
_MSC_VER
 > 1000

43 #¥agm®
⁄˚


49 
	~"TLibComm⁄/SEI.h
"

50 
˛ass
 
	gTComI≈utBô°ªam
;

53 ˛as†
	cSEIRódî
: 
public
 
Sy¡axEÀmítP¨£r


55 
public
:

56 
	$SEIRódî
() {};

57 
vútuÆ
 ~
	$SEIRódî
(Ë{
	}
};

58 
Void
 
∑r£SEImesßge
(
TComI≈utBô°ªam
* 
bs
, 
SEIMesßges
& 
£is
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

60 
	g¥Ÿe˘ed
:

61 
Void
 
xRódSEImesßge
 (
SEIMesßges
& 
£is
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
, c⁄° 
ve˘‹
<
SEI
::
PaylﬂdTy≥
>& 
ÆlowedSeiTy≥s
, std::
°rög
 c⁄° &
ty≥Name
);

62 
Void
 
xRódSEIPaylﬂdD©a
 (
I¡
 c⁄° 
∑ylﬂdTy≥
, I¡ c⁄° 
∑ylﬂdSize
, 
SEI
 *&
£i
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
, std::
°rög
 c⁄° &
ty≥Name
);

63 
Void
 
xP¨£SEIBuf„rögPîiod
 (
SEIBuf„rögPîiod
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

64 
Void
 
xP¨£SEIPi˘uªTimög
 (
SEIPi˘uªTimög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

65 
Void
 
xP¨£SEIP™SˇnRe˘
 (
SEIP™SˇnRe˘
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

66 
Void
 
xP¨£SEIFûÀrPaylﬂd
 (
SEIFûÀrPaylﬂd
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

67 
Void
 
xP¨£SEIU£rD©aRegi°îed
 (
SEIU£rD©aRegi°îed
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

68 
Void
 
xP¨£SEIU£rD©aUƒegi°îed
 (
SEIU£rD©aUƒegi°îed
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

69 
Void
 
xP¨£SEIRecovîyPoöt
 (
SEIRecovîyPoöt
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

70 
Void
 
xP¨£SEIS˚√Info
 (
SEIS˚√Info
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

71 
Void
 
xP¨£SEIPi˘uªS«pshŸ
 (
SEIPi˘uªS«pshŸ
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

72 
Void
 
xP¨£SEIProgªssiveReföemítSegmítSèπ
(
SEIProgªssiveReföemítSegmítSèπ
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

73 
Void
 
xP¨£SEIProgªssiveReföemítSegmítEnd
(
SEIProgªssiveReföemítSegmítEnd
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

74 
Void
 
xP¨£SEIFûmGøöCh¨a˘îi°ics
 (
SEIFûmGøöCh¨a˘îi°ics
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

75 
Void
 
xP¨£SEIPo°FûãrHöt
 (
SEIPo°FûãrHöt
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

76 
Void
 
xP¨£SEIT⁄eM≠pögInfo
 (
SEIT⁄eM≠pögInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

77 
Void
 
xP¨£SEIFømePackög
 (
SEIFømePackög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

78 
Void
 
xP¨£SEIDi•œyOrõ¡©i⁄
 (
SEIDi•œyOrõ¡©i⁄
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

79 
Void
 
xP¨£SEIGªíMëad©aInfo
 (
SEIGªíMëad©aInfo
& 
£i
, 
UI¡
 
∑yLﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

80 
Void
 
xP¨£SEISOPDes¸ùti⁄
 (
SEISOPDes¸ùti⁄
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

81 
Void
 
xP¨£SEIA˘iveP¨amëîSës
 (
SEIA˘iveP¨amëîSës
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

82 
Void
 
xP¨£SEIDecodögUnôInfo
 (
SEIDecodögUnôInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

83 
Void
 
xP¨£SEITemp‹ÆLevñ0Index
 (
SEITemp‹ÆLevñ0Index
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

84 
Void
 
xP¨£SEIDecodedPi˘uªHash
 (
SEIDecodedPi˘uªHash
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

85 
Void
 
xP¨£SEISˇœbÀNe°ög
 (
SEISˇœbÀNe°ög
& 
£i
, c⁄° 
NÆUnôTy≥
 
«lUnôTy≥
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
 *
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

86 
Void
 
xP¨£SEIRegi⁄Re‰eshInfo
 (
SEIRegi⁄Re‰eshInfo
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

87 
Void
 
xP¨£SEINoDi•œy
 (
SEINoDi•œy
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

88 
Void
 
xP¨£SEITimeCode
 (
SEITimeCode
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

89 
Void
 
xP¨£SEIMa°îögDi•œyCﬁourVﬁume
 (
SEIMa°îögDi•œyCﬁourVﬁume
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

90 
Void
 
xP¨£SEISegmíãdRe˘FømePackög
 (
SEISegmíãdRe˘FømePackög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

91 
Void
 
xP¨£SEITempMŸi⁄C⁄°øötsTûeSës
 (
SEITempMŸi⁄C⁄°øöedTûeSës
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

92 #i‡
MCTS_EXTRACTION


93 
Void
 
xP¨£SEIMCTSExåa˘i⁄InfoSë
 (
SEIMCTSExåa˘i⁄InfoSë
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

95 
Void
 
xP¨£SEIChromaReßm∂ögFûãrHöt
 (
SEIChromaReßm∂ögFûãrHöt
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

96 
Void
 
xP¨£SEIK√eFun˘i⁄Info
 (
SEIK√eFun˘i⁄Info
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

97 
Void
 
xP¨£SEIC⁄ã¡CﬁourVﬁume
 (
SEIC⁄ã¡CﬁourVﬁume
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

98 
Void
 
xP¨£SEIEquúe˘™guœrProje˘i⁄
 (
SEIEquúe˘™guœrProje˘i⁄
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

99 
Void
 
xP¨£SEISphîeRŸ©i⁄
 (
SEISphîeRŸ©i⁄
 &
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

100 
Void
 
xP¨£SEIOmniVõwp‹t
 (
SEIOmniVõwp‹t
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

101 
Void
 
xP¨£SEICubem≠Proje˘i⁄
 (
SEICubem≠Proje˘i⁄
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

102 
Void
 
xP¨£SEIA¬Ÿ©edRegi⁄s
 (
SEIA¬Ÿ©edRegi⁄s
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

103 
Void
 
xP¨£SEIRegi⁄Wi£Packög
 (
SEIRegi⁄Wi£Packög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

104 
Void
 
xP¨£SEIFisheyeVideoInfo
(
SEIFisheyeVideoInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

105 
Void
 
xP¨£SEICﬁourRem≠pögInfo
 (
SEICﬁourRem≠pögInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

106 
Void
 
xP¨£SEIDeöãæa˚FõldIdítifiˇti⁄
(
SEIDeöãæa˚FõldIdítifiˇti⁄
& 
£i
,
UI¡
 
∑yLﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

107 
Void
 
xP¨£SEIC⁄ã¡LightLevñInfo
 (
SEIC⁄ã¡LightLevñInfo
& 
£i
, 
UI¡
 
∑yLﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

108 
Void
 
xP¨£SEIDïídítRAPIndiˇti⁄
 (
SEIDïídítRAPIndiˇti⁄
& 
£i
, 
UI¡
 
∑yLﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

109 
Void
 
xP¨£SEICodedRegi⁄Com∂ëi⁄
 (
SEICodedRegi⁄Com∂ëi⁄
& 
£i
, 
UI¡
 
∑yLﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

110 
Void
 
xP¨£SEIA…î«tiveTøns„rCh¨a˘îi°ics
(
SEIA…î«tiveTøns„rCh¨a˘îi°ics
& 
£i
, 
UI¡
 
∑yLﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

111 
Void
 
xP¨£SEIAmbõ¡VõwögEnvú⁄mít
 (
SEIAmbõ¡VõwögEnvú⁄mít
& 
£i
, 
UI¡
 
∑yLﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

112 
Void
 
xP¨£SEIRegi⁄ÆNe°ög
 ( 
SEIRegi⁄ÆNe°ög
& 
£i
, 
UI¡
 
∑ylﬂdSize
, c⁄° 
TComSPS
* 
•s
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
 );

113 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


114 
Void
 
xP¨£SEIShuâîI¡îvÆ
 (
SEIShuâîI¡îvÆInfo
& 
£i
, 
UI¡
 
∑ylﬂdSize
, 
°d
::
o°ªam
 *
pDecodedMesßgeOuçutSåóm
);

116 
Void
 
£i_ªad_scode
(
°d
::
o°ªam
 *
pOS
, 
UI¡
 
uiLígth
, 
I¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
);

117 
Void
 
£i_ªad_code
(
°d
::
o°ªam
 *
pOS
, 
UI¡
 
uiLígth
, UI¡& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
);

118 
Void
 
£i_ªad_uvlc
(
°d
::
o°ªam
 *
pOS
, 
UI¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
);

119 
Void
 
£i_ªad_svlc
(
°d
::
o°ªam
 *
pOS
, 
I¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
);

120 
Void
 
£i_ªad_Êag
(
°d
::
o°ªam
 *
pOS
, 
UI¡
& 
ruiCode
, c⁄° 
TCh¨
 *
pSymbﬁName
);

	@TLibDecoder/SyntaxElementParser.cpp

41 
	~"TLibComm⁄/Comm⁄Def.h
"

42 
	~"TLibComm⁄/TComRom.h
"

43 
	~"TLibComm⁄/TComBôSåóm.h
"

44 
	~"Sy¡axEÀmítP¨£r.h
"

45 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


46 
	~"TLibComm⁄/TComCodögSèti°ics.h
"

49 #i‡
ENC_DEC_TRACE


51 
Void
 
	$xTø˚Ac˚ssUnôDñimôî
 ()

53 
	`Ârötf
–
g_hTø˚
, "=========== Access Unit Delimiter ===========\n");

54 
	}
}

56 
Void
 
	$xTø˚FûÀrD©a
 ()

58 
	`Ârötf
–
g_hTø˚
, "=========== Filler Data ===========\n");

59 
	}
}

65 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
!=0

67 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódSCodeChk
 ( 
UI¡
 
Àngth
, 
I¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° I¡ 
möVÆIn˛
, c⁄° I¡ 
maxVÆIn˛
 )

69 
	`READ_SCODE
(
Àngth
, 
vÆ
, 
pSymbﬁName
);

70 
TDecC⁄f‹m™˚Check
::
	`checkR™ge
(
vÆ
, 
pSymbﬁName
, 
möVÆIn˛
, 
maxVÆIn˛
);

71 
	}
}

73 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódCodeChk
 ( 
UI¡
 
Àngth
, UI¡& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° UI¡ 
möVÆIn˛
, c⁄° UI¡ 
maxVÆIn˛
 )

75 
	`READ_CODE
(
Àngth
, 
vÆ
, 
pSymbﬁName
);

76 
TDecC⁄f‹m™˚Check
::
	`checkR™ge
(
vÆ
, 
pSymbﬁName
, 
möVÆIn˛
, 
maxVÆIn˛
);

77 
	}
}

79 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódUvlcChk
 ( 
UI¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° UI¡ 
möVÆIn˛
, c⁄° UI¡ 
maxVÆIn˛
 )

81 
	`READ_UVLC
(
vÆ
, 
pSymbﬁName
);

82 
TDecC⁄f‹m™˚Check
::
	`checkR™ge
(
vÆ
, 
pSymbﬁName
, 
möVÆIn˛
, 
maxVÆIn˛
);

83 
	}
}

85 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódSvlcChk
 ( 
I¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° I¡ 
möVÆIn˛
, c⁄° I¡ 
maxVÆIn˛
 )

87 
	`READ_SVLC
(
vÆ
, 
pSymbﬁName
);

88 
TDecC⁄f‹m™˚Check
::
	`checkR™ge
(
vÆ
, 
pSymbﬁName
, 
möVÆIn˛
, 
maxVÆIn˛
);

89 
	}
}

91 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódFœgChk
 ( 
UI¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° UI¡ 
möVÆIn˛
, c⁄° UI¡ 
maxVÆIn˛
 )

93 
	`READ_FLAG
(
vÆ
, 
pSymbﬁName
);

94 
TDecC⁄f‹m™˚Check
::
	`checkR™ge
(
vÆ
, 
pSymbﬁName
, 
möVÆIn˛
, 
maxVÆIn˛
);

95 
	}
}

101 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


102 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódSCode
 (
UI¡
 
uiLígth
, 
I¡
& 
rVÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

104 
Void
 
Sy¡axEÀmítP¨£r
::
	$xRódSCode
 (
UI¡
 
uiLígth
, 
I¡
& 
rVÆue
)

107 
UI¡
 
vÆ
;

108 
	`as£π
 ( 
uiLígth
 > 0 && uiLength<=32);

109 
m_pcBô°ªam
->
	`ªad
 (
uiLígth
, 
vÆ
);

110 
rVÆue

uiLígth
>=32 ? 
	`I¡
(
vÆ
Ë: ( (-I¡–vÆ & (
	`UI¡
(1)<<(uiLength-1)))) | Int(val) );

112 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


113 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
pSymbﬁName
, 
uiLígth
, 
rVÆue
);

115 #i‡
ENC_DEC_TRACE


116 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

117 i‡(
uiLígth
 < 10)

119 
	`Ârötf
–
g_hTø˚
, "%-50†i(%dË : %d\n", 
pSymbﬁName
, 
uiLígth
, 
rVÆue
 );

123 
	`Ârötf
–
g_hTø˚
, "%-50†i(%dË: %d\n", 
pSymbﬁName
, 
uiLígth
, 
rVÆue
 );

125 
	`fÊush
 ( 
g_hTø˚
 );

127 
	}
}

129 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


130 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódCode
 (
UI¡
 
uiLígth
, UI¡& 
rVÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

132 
Void
 
Sy¡axEÀmítP¨£r
::
	$xRódCode
 (
UI¡
 
uiLígth
, UI¡& 
rVÆue
)

135 
	`as£π
 ( 
uiLígth
 > 0 );

136 
m_pcBô°ªam
->
	`ªad
 (
uiLígth
, 
rVÆue
);

137 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


138 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
pSymbﬁName
, 
uiLígth
, 
rVÆue
);

140 #i‡
ENC_DEC_TRACE


141 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

142 i‡(
uiLígth
 < 10)

144 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË : %u\n", 
pSymbﬁName
, 
uiLígth
, 
rVÆue
 );

148 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË: %u\n", 
pSymbﬁName
, 
uiLígth
, 
rVÆue
 );

150 
	`fÊush
 ( 
g_hTø˚
 );

152 
	}
}

155 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


156 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódUvlc
–
UI¡
& 
rVÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

158 
Void
 
Sy¡axEÀmítP¨£r
::
	$xRódUvlc
–
UI¡
& 
rVÆue
)

161 
UI¡
 
uiVÆ
 = 0;

162 
UI¡
 
uiCode
 = 0;

163 
UI¡
 
uiLígth
;

164 
m_pcBô°ªam
->
	`ªad
–1, 
uiCode
 );

165 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


166 
UI¡
 
tŸÆLí
=1;

169 if–0 =
uiCode
 )

171 
uiLígth
 = 0;

173  ! ( 
uiCode
 & 1 ))

175 
m_pcBô°ªam
->
	`ªad
–1, 
uiCode
 );

176 
uiLígth
++;

179 
m_pcBô°ªam
->
	`ªad
–
uiLígth
, 
uiVÆ
 );

181 
uiVÆ
 +(1 << 
uiLígth
)-1;

182 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


183 
tŸÆLí
+=
uiLígth
+uiLength;

187 
rVÆue
 = 
uiVÆ
;

188 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


189 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
pSymbﬁName
, 
	`I¡
(
tŸÆLí
), 
rVÆue
);

192 #i‡
ENC_DEC_TRACE


193 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

194 
	`Ârötf
–
g_hTø˚
, "%-50†ue(vË: %u\n", 
pSymbﬁName
, 
rVÆue
 );

195 
	`fÊush
 ( 
g_hTø˚
 );

197 
	}
}

199 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


200 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódSvlc
–
I¡
& 
rVÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

202 
Void
 
Sy¡axEÀmítP¨£r
::
	$xRódSvlc
–
I¡
& 
rVÆue
)

205 
UI¡
 
uiBôs
 = 0;

206 
m_pcBô°ªam
->
	`ªad
–1, 
uiBôs
 );

207 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


208 
UI¡
 
tŸÆLí
=1;

210 if–0 =
uiBôs
 )

212 
UI¡
 
uiLígth
 = 0;

214  ! ( 
uiBôs
 & 1 ))

216 
m_pcBô°ªam
->
	`ªad
–1, 
uiBôs
 );

217 
uiLígth
++;

220 
m_pcBô°ªam
->
	`ªad
–
uiLígth
, 
uiBôs
 );

222 
uiBôs
 +(1 << 
uiLígth
);

223 
rVÆue
 = ( 
uiBôs
 & 1Ë? -(
I¡
)(uiBits>>1) : (Int)(uiBits>>1);

224 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


225 
tŸÆLí
+=
uiLígth
+uiLength;

230 
rVÆue
 = 0;

232 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


233 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
pSymbﬁName
, 
	`I¡
(
tŸÆLí
), 
rVÆue
);

236 #i‡
ENC_DEC_TRACE


237 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

238 
	`Ârötf
–
g_hTø˚
, "%-50†£(vË: %d\n", 
pSymbﬁName
, 
rVÆue
 );

239 
	`fÊush
 ( 
g_hTø˚
 );

242 
	}
}

244 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


245 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódFœg
 (
UI¡
& 
rVÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

247 
Void
 
Sy¡axEÀmítP¨£r
::
	$xRódFœg
 (
UI¡
& 
rVÆue
)

250 
m_pcBô°ªam
->
	`ªad
–1, 
rVÆue
 );

251 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


252 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
pSymbﬁName
, 1, 
	`I¡
(
rVÆue
));

255 #i‡
ENC_DEC_TRACE


256 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

257 
	`Ârötf
–
g_hTø˚
, "%-50†u(1Ë : %d\n", 
pSymbﬁName
, 
rVÆue
 );

258 
	`fÊush
 ( 
g_hTø˚
 );

260 
	}
}

262 
Void
 
	gSy¡axEÀmítP¨£r
::
	$xRódRb•TøûögBôs
()

264 
UI¡
 
bô
;

265 
	`READ_FLAG
–
bô
, "rbsp_stop_one_bit");

266 
	`as£π
 (
bô
==1);

267 
I¡
 
˙t
 = 0;

268 
m_pcBô°ªam
->
	`gëNumBôsU¡ûByãAlig√d
())

270 
	`READ_FLAG
–
bô
, "rbsp_alignment_zero_bit");

271 
	`as£π
 (
bô
==0);

272 
˙t
++;

274 
	`as£π
(
˙t
<8);

275 
	}
}

277 
Void
 
	gAUDRódî
::
	$∑r£Ac˚ssUnôDñimôî
(
TComI≈utBô°ªam
* 
bs
, 
UI¡
 &
picTy≥
)

279 
	`£tBô°ªam
(
bs
);

281 #i‡
ENC_DEC_TRACE


282 
	`xTø˚Ac˚ssUnôDñimôî
();

285 
	`READ_CODE
 (3, 
picTy≥
, "pic_type");

286 
	`xRódRb•TøûögBôs
();

287 
	}
}

289 
Void
 
	gFDRódî
::
	$∑r£FûÀrD©a
(
TComI≈utBô°ªam
* 
bs
, 
UI¡
 &
fdSize
)

291 
	`£tBô°ªam
(
bs
);

292 #i‡
ENC_DEC_TRACE


293 
	`xTø˚FûÀrD©a
();

295 
UI¡
 
ffByã
;

296 
fdSize
 = 0;

297  
m_pcBô°ªam
->
	`gëNumBôsLe·
() >8 )

299 
	`READ_CODE
 (8, 
ffByã
, "ff_byte");

300 
	`as£π
 (
ffByã
==0xff);

301 
fdSize
++;

303 
	`xRódRb•TøûögBôs
();

304 
	}
}

	@TLibDecoder/SyntaxElementParser.h

38 #i‚de‡
__SYNTAXELEMENTPARSER__


39 
	#__SYNTAXELEMENTPARSER__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/TComRom.h
"

46 
	~"TDecC⁄f‹m™˚.h
"

48 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
!=0

49 
	#READ_SCODE_CHK
(
Àngth
, 
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódSCodeChk
 (Üígth, code,Çame, möVÆIn˛, maxVÆIn˛ )

	)

50 
	#READ_CODE_CHK
(
Àngth
, 
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódCodeChk
 (Üígth, code,Çame, möVÆIn˛, maxVÆIn˛ )

	)

51 
	#READ_UVLC_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódUvlcChk
 ( code,Çame, möVÆIn˛, maxVÆIn˛ )

	)

52 
	#READ_SVLC_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódSvlcChk
 ( code,Çame, möVÆIn˛, maxVÆIn˛ )

	)

53 
	#READ_FLAG_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódFœgChk
 ( code,Çame, möVÆIn˛, maxVÆIn˛ )

	)

54 #ñi‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


55 
	#READ_SCODE_CHK
(
Àngth
, 
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódSCode
 (Üígth, code,Çamê)

	)

56 
	#READ_CODE_CHK
(
Àngth
, 
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódCode
 (Üígth, code,Çamê)

	)

57 
	#READ_UVLC_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódUvlc
 ( code,Çamê)

	)

58 
	#READ_SVLC_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódSvlc
 ( code,Çamê)

	)

59 
	#READ_FLAG_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódFœg
 ( code,Çamê)

	)

61 
	#READ_SCODE_CHK
(
Àngth
, 
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódSCode
 (Üígth, codê)

	)

62 
	#READ_CODE_CHK
(
Àngth
, 
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódCode
 (Üígth, codê)

	)

63 
	#READ_UVLC_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódUvlc
 ( codê)

	)

64 
	#READ_SVLC_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódSvlc
 ( codê)

	)

65 
	#READ_FLAG_CHK
–
code
, 
«me
, 
möVÆIn˛
, 
maxVÆIn˛
Ë
	`xRódFœg
 ( codê)

	)

69 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


70 
	#READ_SCODE
(
Àngth
, 
code
, 
«me
Ë
	`xRódSCode
 (Üígth, code,Çamê)

	)

71 
	#READ_CODE
(
Àngth
, 
code
, 
«me
Ë
	`xRódCode
 (Üígth, code,Çamê)

	)

72 
	#READ_UVLC
–
code
, 
«me
Ë
	`xRódUvlc
 ( code,Çamê)

	)

73 
	#READ_SVLC
–
code
, 
«me
Ë
	`xRódSvlc
 ( code,Çamê)

	)

74 
	#READ_FLAG
–
code
, 
«me
Ë
	`xRódFœg
 ( code,Çamê)

	)

77 
	#READ_SCODE
(
Àngth
, 
code
, 
«me
Ë
	`xRódSCode
 (Üígth, codê)

	)

78 
	#READ_CODE
(
Àngth
, 
code
, 
«me
Ë
	`xRódCode
 (Üígth, codê)

	)

79 
	#READ_UVLC
–
code
, 
«me
Ë
	`xRódUvlc
 ( codê)

	)

80 
	#READ_SVLC
–
code
, 
«me
Ë
	`xRódSvlc
 ( codê)

	)

81 
	#READ_FLAG
–
code
, 
«me
Ë
	`xRódFœg
 ( codê)

	)

92 ˛as†
	cSy¡axEÀmítP¨£r


94 
	m¥Ÿe˘ed
:

95 
TComI≈utBô°ªam
* 
m_pcBô°ªam
;

97 
	$Sy¡axEÀmítP¨£r
()

98 : 
	$m_pcBô°ªam
 (
NULL
)

100 
vútuÆ
 ~
	$Sy¡axEÀmítP¨£r
(Ë{
	}
};

102 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
!=0

103 
Void
 
xRódSCodeChk
 ( 
UI¡
 
Àngth
, 
I¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° I¡ 
möVÆIn˛
, c⁄° I¡ 
maxVÆIn˛
 );

104 
Void
 
xRódCodeChk
 ( 
UI¡
 
Àngth
, UI¡& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° UI¡ 
möVÆIn˛
, c⁄° UI¡ 
maxVÆIn˛
 );

105 
Void
 
xRódUvlcChk
 ( 
UI¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° UI¡ 
möVÆIn˛
, c⁄° UI¡ 
maxVÆIn˛
 );

106 
Void
 
xRódSvlcChk
 ( 
I¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° I¡ 
möVÆIn˛
, c⁄° I¡ 
maxVÆIn˛
 );

107 
Void
 
xRódFœgChk
 ( 
UI¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
, c⁄° UI¡ 
möVÆIn˛
, c⁄° UI¡ 
maxVÆIn˛
 );

110 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS
 || 
ENC_DEC_TRACE


111 
Void
 
xRódSCode
 ( 
UI¡
 
Àngth
, 
I¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
 );

112 
Void
 
xRódCode
 ( 
UI¡
 
Àngth
, UI¡& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
 );

113 
Void
 
xRódUvlc
 ( 
UI¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
 );

114 
Void
 
xRódSvlc
 ( 
I¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
 );

115 
Void
 
xRódFœg
 ( 
UI¡
& 
vÆ
, c⁄° 
TCh¨
 *
pSymbﬁName
 );

117 
Void
 
xRódSCode
 ( 
UI¡
 
Àngth
, 
I¡
& 
vÆ
 );

118 
Void
 
xRódCode
 ( 
UI¡
 
Àngth
, UI¡& 
vÆ
 );

119 
Void
 
xRódUvlc
 ( 
UI¡
& 
vÆ
 );

120 
Void
 
xRódSvlc
 ( 
I¡
& 
vÆ
 );

121 
Void
 
xRódFœg
 ( 
UI¡
& 
vÆ
 );

123 
	gpublic
:

124 
Void
 
	$£tBô°ªam
 ( 
TComI≈utBô°ªam
* 
p
 ) { 
m_pcBô°ªam
 =Ö; 
	}
}

125 
TComI≈utBô°ªam
* 
	$gëBô°ªam
(Ë{  
m_pcBô°ªam
; 
	}
}

127 
	g¥Ÿe˘ed
:

128 
Void
 
xRódRb•TøûögBôs
();

131 ˛as†
	cAUDRódî
: 
public
 
Sy¡axEÀmítP¨£r


133 
public
:

134 
	$AUDRódî
() {};

135 
vútuÆ
 ~
	$AUDRódî
(Ë{
	}
};

136 
Void
 
∑r£Ac˚ssUnôDñimôî
(
TComI≈utBô°ªam
* 
bs
, 
UI¡
 &
picTy≥
);

139 ˛as†
	cFDRódî
: 
public
 
Sy¡axEÀmítP¨£r


141 
public
:

142 
	$FDRódî
() {};

143 
vútuÆ
 ~
	$FDRódî
(Ë{
	}
};

144 
Void
 
∑r£FûÀrD©a
(
TComI≈utBô°ªam
* 
bs
, 
UI¡
 &
fdSize
);

	@TLibDecoder/TDecBinCoder.h

38 #i‚de‡
__TDECBINCODER__


39 
	#__TDECBINCODER__


	)

41 
	~"TLibComm⁄/C⁄ãxtModñ.h
"

42 
	~"TLibComm⁄/TComBôSåóm.h
"

44 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


45 
˛ass
 
	gTComCodögSèti°icsCœssTy≥
;

50 
˛ass
 
	gTDecBöCABAC
;

52 ˛as†
	cTDecBöIf


54 
	mpublic
:

55 
vútuÆ
 
Void
 
öô
 ( 
TComI≈utBô°ªam
* 
pcTComBô°ªam
 ) = 0;

56 
vútuÆ
 
Void
 
unöô
 () = 0;

58 
vútuÆ
 
Void
 
°¨t
 () = 0;

59 
vútuÆ
 
Void
 
föish
 () = 0;

61 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


62 
vútuÆ
 
Void
 
decodeBö
 ( 
UI¡
& 
ruiBö
, 
C⁄ãxtModñ
& 
rcCtxModñ
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 ) = 0;

63 
vútuÆ
 
Void
 
decodeBöEP
 ( 
UI¡
& 
ruiBö
 , c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 ) = 0;

64 
vútuÆ
 
Void
 
decodeBösEP
 ( 
UI¡
& 
ruiBös
, 
I¡
 
numBös
 , c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 ) = 0;

66 
vútuÆ
 
Void
 
decodeBö
 ( 
UI¡
& 
ruiBö
, 
C⁄ãxtModñ
& 
rcCtxModñ
 ) = 0;

67 
vútuÆ
 
Void
 
decodeBöEP
 ( 
UI¡
& 
ruiBö
 ) = 0;

68 
vútuÆ
 
Void
 
decodeBösEP
 ( 
UI¡
& 
ruiBös
, 
I¡
 
numBös
 ) = 0;

71 
vútuÆ
 
Void
 
Æign
 () = 0;

73 
vútuÆ
 
Void
 
decodeBöTrm
 ( 
UI¡
& 
ruiBö
 ) = 0;

75 
vútuÆ
 
Void
 
xRódPCMCode
 ( 
UI¡
 
uiLígth
, UI¡& 
ruiCode
) = 0;

77 
	mvútuÆ
 ~
	$TDecBöIf
() {}

79 
vútuÆ
 
Void
 
	`c›ySèã
 ( c⁄° 
TDecBöIf
* 
pcTDecBöIf
 ) = 0;

80 
vútuÆ
 
TDecBöCABAC
* 
	$gëTDecBöCABAC
 (Ë{  0; 
	}
}

81 
vútuÆ
 c⁄° 
TDecBöCABAC
* 
	$gëTDecBöCABAC
 (Ëc⁄° {  0; 
	}
}

	@TLibDecoder/TDecBinCoderCABAC.cpp

38 
	~"TDecBöCodîCABAC.h
"

39 
	~"TLibComm⁄/Debug.h
"

40 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


41 
	~"TLibComm⁄/TComCodögSèti°ics.h
"

47 
	gTDecBöCABAC
::
	$TDecBöCABAC
()

48 : 
	$m_pcTComBô°ªam
( 0 )

50 
	}
}

52 
TDecBöCABAC
::~
	$TDecBöCABAC
()

54 
	}
}

56 
Void


57 
TDecBöCABAC
::
	$öô
–
TComI≈utBô°ªam
* 
pcTComBô°ªam
 )

59 
m_pcTComBô°ªam
 = 
pcTComBô°ªam
;

60 
	}
}

62 
Void


63 
	gTDecBöCABAC
::
	$unöô
()

65 
m_pcTComBô°ªam
 = 0;

66 
	}
}

68 
Void


69 
	gTDecBöCABAC
::
	$°¨t
()

71 
	`as£π
–
m_pcTComBô°ªam
->
	`gëNumBôsU¡ûByãAlig√d
() == 0 );

72 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


73 
TComCodögSèti°ics
::
	`Upd©eCABACSèt
(
STATS__CABAC_INITIALISATION
, 512, 510, 0);

75 
m_uiR™ge
 = 510;

76 
m_bôsNìded
 = -8;

77 
m_uiVÆue
 = (
m_pcTComBô°ªam
->
	`ªadByã
() << 8);

78 
m_uiVÆue
 |
m_pcTComBô°ªam
->
	`ªadByã
();

79 
	}
}

81 
Void


82 
	gTDecBöCABAC
::
	$föish
()

84 
UI¡
 
œ°Byã
;

86 
m_pcTComBô°ªam
->
	`≥ekPªviousByã
–
œ°Byã
 );

88 
	`as£π
–((
œ°Byã
 << (8 + 
m_bôsNìded
)) & 0xff) == 0x80 );

89 
	}
}

96 
Void


97 
	gTDecBöCABAC
::
	$c›ySèã
–c⁄° 
TDecBöIf
* 
pcTDecBöIf
 )

99 c⁄° 
TDecBöCABAC
* 
pcTDecBöCABAC
 = 
pcTDecBöIf
->
	`gëTDecBöCABAC
();

100 
m_uiR™ge
 = 
pcTDecBöCABAC
->m_uiRange;

101 
m_uiVÆue
 = 
pcTDecBöCABAC
->m_uiValue;

102 
m_bôsNìded

pcTDecBöCABAC
->m_bitsNeeded;

103 
	}
}

107 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


108 
Void
 
	gTDecBöCABAC
::
	$decodeBö
–
UI¡
& 
ruiBö
, 
C⁄ãxtModñ
 &
rcCtxModñ
, c⁄° 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

110 
Void
 
TDecBöCABAC
::
	$decodeBö
–
UI¡
& 
ruiBö
, 
C⁄ãxtModñ
 &
rcCtxModñ
 )

113 #i‡
DEBUG_CABAC_BINS


114 c⁄° 
UI¡
 
°¨tögR™ge
 = 
m_uiR™ge
;

117 
UI¡
 
uiLPS
 = 
TComCABACTabÀs
::
sm_aucLPSTabÀ
[ 
rcCtxModñ
.
	`gëSèã
(Ë][ ( 
m_uiR™ge
 >> 6 ) - 4 ];

118 
m_uiR™ge
 -
uiLPS
;

119 
UI¡
 
sˇÀdR™ge
 = 
m_uiR™ge
 << 7;

121 if–
m_uiVÆue
 < 
sˇÀdR™ge
 )

124 
ruiBö
 = 
rcCtxModñ
.
	`gëMps
();

125 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


126 
TComCodögSèti°ics
::
	`Upd©eCABACSèt
(
whichSèt
, 
m_uiR™ge
+
uiLPS
, m_uiR™ge, 
	`I¡
(
ruiBö
));

128 
rcCtxModñ
.
	`upd©eMPS
();

130 i‡–
sˇÀdR™ge
 < ( 256 << 7 ) )

132 
m_uiR™ge
 = 
sˇÀdR™ge
 >> 6;

133 
m_uiVÆue
 += m_uiValue;

135 i‡–++
m_bôsNìded
 == 0 )

137 
m_bôsNìded
 = -8;

138 
m_uiVÆue
 +
m_pcTComBô°ªam
->
	`ªadByã
();

145 
ruiBö
 = 1 - 
rcCtxModñ
.
	`gëMps
();

146 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


147 
TComCodögSèti°ics
::
	`Upd©eCABACSèt
(
whichSèt
, 
m_uiR™ge
+
uiLPS
, uiLPS, 
	`I¡
(
ruiBö
));

149 
I¡
 
numBôs
 = 
TComCABACTabÀs
::
sm_aucRí‹mTabÀ
[ 
uiLPS
 >> 3 ];

150 
m_uiVÆue
 = ( m_uiVÆuê- 
sˇÀdR™ge
 ) << 
numBôs
;

151 
m_uiR™ge
 = 
uiLPS
 << 
numBôs
;

152 
rcCtxModñ
.
	`upd©eLPS
();

154 
m_bôsNìded
 +
numBôs
;

156 i‡–
m_bôsNìded
 >= 0 )

158 
m_uiVÆue
 +
m_pcTComBô°ªam
->
	`ªadByã
(Ë<< 
m_bôsNìded
;

159 
m_bôsNìded
 -= 8;

163 #i‡
DEBUG_CABAC_BINS


164 i‡((
g_debugCou¡î
 + 
debugCabacBöWödow
Ë>
debugCabacBöT¨gëLöe
)

166 
°d
::
cout
 << 
g_debugCou¡î
 << ": codög bö vÆuê" << 
ruiBö
 << ",Ñ™gê[" << 
°¨tögR™ge
 << "->" << 
m_uiR™ge
 << "]\n";

169 i‡(
g_debugCou¡î
 >
debugCabacBöT¨gëLöe
)

171 
UCh¨
 
bªakPoötThis
;

172 
bªakPoötThis
 = 7;

174 i‡(
g_debugCou¡î
 >(
debugCabacBöT¨gëLöe
 + 
debugCabacBöWödow
))

176 
	`exô
(0);

178 
g_debugCou¡î
++;

180 
	}
}

183 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


184 
Void
 
	gTDecBöCABAC
::
	$decodeBöEP
–
UI¡
& 
ruiBö
, c⁄° 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

186 
Void
 
TDecBöCABAC
::
	$decodeBöEP
–
UI¡
& 
ruiBö
 )

189 i‡(
m_uiR™ge
 == 256)

191 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


192 
	`decodeAlig√dBösEP
(
ruiBö
, 1, 
whichSèt
);

194 
	`decodeAlig√dBösEP
(
ruiBö
, 1);

199 
m_uiVÆue
 += m_uiValue;

201 i‡–++
m_bôsNìded
 >= 0 )

203 
m_bôsNìded
 = -8;

204 
m_uiVÆue
 +
m_pcTComBô°ªam
->
	`ªadByã
();

207 
ruiBö
 = 0;

208 
UI¡
 
sˇÀdR™ge
 = 
m_uiR™ge
 << 7;

209 i‡–
m_uiVÆue
 >
sˇÀdR™ge
 )

211 
ruiBö
 = 1;

212 
m_uiVÆue
 -
sˇÀdR™ge
;

214 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


215 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
whichSèt
, 1, 
	`I¡
(
ruiBö
));

217 
	}
}

219 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


220 
Void
 
	gTDecBöCABAC
::
	$decodeBösEP
–
UI¡
& 
ruiBö
, 
I¡
 
numBös
, c⁄° 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

222 
Void
 
TDecBöCABAC
::
	$decodeBösEP
–
UI¡
& 
ruiBö
, 
I¡
 
numBös
 )

225 i‡(
m_uiR™ge
 == 256)

227 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


228 
	`decodeAlig√dBösEP
(
ruiBö
, 
numBös
, 
whichSèt
);

230 
	`decodeAlig√dBösEP
(
ruiBö
, 
numBös
);

235 
UI¡
 
bös
 = 0;

236 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


237 
I¡
 
‹igNumBös
=
numBös
;

239  
numBös
 > 8 )

241 
m_uiVÆue
 = ( m_uiVÆuê<< 8 ) + ( 
m_pcTComBô°ªam
->
	`ªadByã
(Ë<< ( 8 + 
m_bôsNìded
 ) );

243 
UI¡
 
sˇÀdR™ge
 = 
m_uiR™ge
 << 15;

244  
I¡
 
i
 = 0; i < 8; i++ )

246 
bös
 += bins;

247 
sˇÀdR™ge
 >>= 1;

248 i‡–
m_uiVÆue
 >
sˇÀdR™ge
 )

250 
bös
++;

251 
m_uiVÆue
 -
sˇÀdR™ge
;

254 
numBös
 -= 8;

257 
m_bôsNìded
 +
numBös
;

258 
m_uiVÆue
 <<
numBös
;

260 i‡–
m_bôsNìded
 >= 0 )

262 
m_uiVÆue
 +
m_pcTComBô°ªam
->
	`ªadByã
(Ë<< 
m_bôsNìded
;

263 
m_bôsNìded
 -= 8;

266 
UI¡
 
sˇÀdR™ge
 = 
m_uiR™ge
 << ( 
numBös
 + 7 );

267  
I¡
 
i
 = 0; i < 
numBös
; i++ )

269 
bös
 += bins;

270 
sˇÀdR™ge
 >>= 1;

271 i‡–
m_uiVÆue
 >
sˇÀdR™ge
 )

273 
bös
++;

274 
m_uiVÆue
 -
sˇÀdR™ge
;

278 
ruiBö
 = 
bös
;

279 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


280 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
whichSèt
, 
‹igNumBös
, 
	`I¡
(
ruiBö
));

282 
	}
}

284 
Void
 
	gTDecBöCABAC
::
	$Æign
()

286 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


287 
TComCodögSèti°ics
::
	`Upd©eCABACSèt
(
STATS__CABAC_EP_BIT_ALIGNMENT
, 
m_uiR™ge
, 256, 0);

289 
m_uiR™ge
 = 256;

290 
	}
}

292 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


293 
Void
 
	gTDecBöCABAC
::
	$decodeAlig√dBösEP
–
UI¡
& 
ruiBös
, 
I¡
 
numBös
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

295 
Void
 
TDecBöCABAC
::
	$decodeAlig√dBösEP
–
UI¡
& 
ruiBös
, 
I¡
 
numBös
 )

298 
I¡
 
bösRemaöög
 = 
numBös
;

299 
ruiBös
 = 0;

301 
	`as£π
(
m_uiR™ge
 == 256);

303 
bösRemaöög
 > 0)

305 c⁄° 
UI¡
 
bösToRód
 = 
°d
::
mö
<UI¡>(
bösRemaöög
, 8);

306 c⁄° 
UI¡
 
böMask
 = (1 << 
bösToRód
) - 1;

317 c⁄° 
UI¡
 
√wBös
 = (
m_uiVÆue
 >> (15 - 
bösToRód
)Ë& 
böMask
;

319 
ruiBös
 = (ruiBö†<< 
bösToRód
Ë| 
√wBös
;

320 
m_uiVÆue
 = (m_uiVÆuê<< 
bösToRód
) & 0x7FFF;

322 
bösRemaöög
 -
bösToRód
;

323 
m_bôsNìded
 +
bösToRód
;

325 i‡(
m_bôsNìded
 >= 0)

327 
m_uiVÆue
 |
m_pcTComBô°ªam
->
	`ªadByã
(Ë<< 
m_bôsNìded
;

328 
m_bôsNìded
 -= 8;

332 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


333 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
whichSèt
, 
numBös
, 
	`I¡
(
ruiBös
));

335 
	}
}

337 
Void


338 
	gTDecBöCABAC
::
	$decodeBöTrm
–
UI¡
& 
ruiBö
 )

340 
m_uiR™ge
 -= 2;

341 
UI¡
 
sˇÀdR™ge
 = 
m_uiR™ge
 << 7;

342 if–
m_uiVÆue
 >
sˇÀdR™ge
 )

344 
ruiBö
 = 1;

345 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


346 
TComCodögSèti°ics
::
	`Upd©eCABACSèt
(
STATS__CABAC_TRM_BITS
, 
m_uiR™ge
+2, 2, 
ruiBö
);

347 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
STATS__BYTE_ALIGNMENT_BITS
, -
m_bôsNìded
, 0);

352 
ruiBö
 = 0;

353 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


354 
TComCodögSèti°ics
::
	`Upd©eCABACSèt
(
STATS__CABAC_TRM_BITS
, 
m_uiR™ge
+2, m_uiR™ge, 
ruiBö
);

356 i‡–
sˇÀdR™ge
 < ( 256 << 7 ) )

358 
m_uiR™ge
 = 
sˇÀdR™ge
 >> 6;

359 
m_uiVÆue
 += m_uiValue;

361 i‡–++
m_bôsNìded
 == 0 )

363 
m_bôsNìded
 = -8;

364 
m_uiVÆue
 +
m_pcTComBô°ªam
->
	`ªadByã
();

368 
	}
}

375 
Void
 
	gTDecBöCABAC
::
	$xRódPCMCode
(
UI¡
 
uiLígth
, UI¡& 
ruiCode
)

377 
	`as£π
 ( 
uiLígth
 > 0 );

378 
m_pcTComBô°ªam
->
	`ªad
 (
uiLígth
, 
ruiCode
);

379 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


380 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
STATS__CABAC_PCM_CODE_BITS
, 
uiLígth
, 
ruiCode
);

382 
	}
}

	@TLibDecoder/TDecBinCoderCABAC.h

38 #i‚de‡
__TDECBINCODERCABAC__


39 
	#__TDECBINCODERCABAC__


	)

41 
	~"TLibComm⁄/TComCABACTabÀs.h
"

42 
	~"TDecBöCodî.h
"

47 ˛as†
	cTDecBöCABAC
 : 
public
 
TDecBöIf


49 
public
:

50 
TDecBöCABAC
 ();

51 
	mvútuÆ
 ~
TDecBöCABAC
();

53 
Void
 
öô
 ( 
TComI≈utBô°ªam
* 
pcTComBô°ªam
 );

54 
Void
 
unöô
 ();

56 
Void
 
°¨t
 ();

57 
Void
 
föish
 ();

59 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


60 
Void
 
decodeBö
 ( 
UI¡
& 
ruiBö
, 
C⁄ãxtModñ
& 
rcCtxModñ
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

61 
Void
 
decodeBöEP
 ( 
UI¡
& 
ruiBö
 , c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

62 
Void
 
decodeBösEP
 ( 
UI¡
& 
ruiBö
, 
I¡
 
numBös
 , c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

63 
Void
 
decodeAlig√dBösEP
–
UI¡
& 
ruiBös
, 
I¡
 
numBös
 , c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

65 
Void
 
decodeBö
 ( 
UI¡
& 
ruiBö
, 
C⁄ãxtModñ
& 
rcCtxModñ
 );

66 
Void
 
decodeBöEP
 ( 
UI¡
& 
ruiBö
 );

67 
Void
 
decodeBösEP
 ( 
UI¡
& 
ruiBö
, 
I¡
 
numBös
 );

68 
Void
 
decodeAlig√dBösEP
–
UI¡
& 
ruiBös
, 
I¡
 
numBös
 );

71 
Void
 
Æign
 ();

73 
Void
 
decodeBöTrm
 ( 
UI¡
& 
ruiBö
 );

75 
Void
 
xRódPCMCode
 ( 
UI¡
 
uiLígth
, UI¡& 
ruiCode
 );

77 
Void
 
c›ySèã
 ( c⁄° 
TDecBöIf
* 
pcTDecBöIf
 );

78 
TDecBöCABAC
* 
	$gëTDecBöCABAC
(Ë{  
this
; }

79 c⁄° 
TDecBöCABAC
* 
	$gëTDecBöCABAC
(Ëc⁄° {  
this
; 
	}
}

81 
	g¥iv©e
:

82 
TComI≈utBô°ªam
* 
m_pcTComBô°ªam
;

83 
UI¡
 
	gm_uiR™ge
;

84 
UI¡
 
	gm_uiVÆue
;

85 
I¡
 
	gm_bôsNìded
;

	@TLibDecoder/TDecCAVLC.cpp

38 
	~"TDecCAVLC.h
"

39 
	~"SEIªad.h
"

40 
	~"TDecSli˚.h
"

41 
	~"TLibComm⁄/TComChromaF‹m©.h
"

42 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


43 
	~"TLibComm⁄/TComCodögSèti°ics.h
"

45 
	~"TDecC⁄f‹m™˚.h
"

50 #i‡
ENC_DEC_TRACE


51 #i‡
MCTS_EXTRACTION


52 
Void
 
	$xTø˚VPSHódîDec
 ()

54 
Void
 
	$xTø˚VPSHódî
()

57 
	`Ârötf
–
g_hTø˚
, "=========== Video Parameter Set ===========\n" );

58 
	}
}

60 #i‡
MCTS_EXTRACTION


61 
Void
 
	$xTø˚SPSHódîDec
()

63 
Void
 
	$xTø˚SPSHódî
()

66 
	`Ârötf
–
g_hTø˚
, "=========== Sequence Parameter Set ===========\n" );

67 
	}
}

69 #i‡
MCTS_EXTRACTION


70 
Void
 
	$xTø˚PPSHódîDec
()

72 
Void
 
	$xTø˚PPSHódî
()

75 
	`Ârötf
–
g_hTø˚
, "=========== Picture Parameter Set ===========\n");

76 
	}
}

78 #i‡
MCTS_EXTRACTION


79 
Void
 
	$xTø˚Sli˚HódîDec
()

81 
Void
 
	$xTø˚Sli˚Hódî
()

84 
	`Ârötf
–
g_hTø˚
, "=========== Slice ===========\n");

85 
	}
}

93 
	gTDecCavlc
::
	$TDecCavlc
()

95 
	}
}

97 
TDecCavlc
::~
	$TDecCavlc
()

100 
	}
}

106 
Void
 
TDecCavlc
::
	$∑r£Sh‹tTîmRefPicSë
–
TComSPS
* 
•s
, 
TComRe„ªn˚Pi˘uªSë
* 
Ωs
, 
I¡
 
idx
 )

108 
UI¡
 
code
;

109 
UI¡
 
öãrRPSPªd
;

110 i‡(
idx
 > 0)

112 
	`READ_FLAG
(
öãrRPSPªd
, "öãr_ªf_pic_£t_¥edi˘i⁄_Êag"); 
Ωs
->
	`£tI¡îRPSPªdi˘i⁄
(interRPSPred);

116 
öãrRPSPªd
 = 
Ál£
;

117 
Ωs
->
	`£tI¡îRPSPªdi˘i⁄
(
Ál£
);

120 i‡(
öãrRPSPªd
)

122 
UI¡
 
bô
;

123 if(
idx
 =
•s
->
	`gëRPSLi°
()->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
())

125 
	`READ_UVLC
(
code
, "delta_idx_minus1" );

129 
code
 = 0;

131 #i‡
MCTS_EXTRACTION


132 
Ωs
->
	`£tDñèRIdxMöus1
(
code
);

134 
	`as£π
(
code
 <
idx
-1);

135 
I¡
 
rIdx
 = 
idx
 - 1 - 
code
;

136 
	`as£π
 (
rIdx
 <
idx
-1 &&ÑIdx >= 0);

137 
TComRe„ªn˚Pi˘uªSë
* 
ΩsRef
 = 
•s
->
	`gëRPSLi°
()->
	`gëRe„ªn˚Pi˘uªSë
(
rIdx
);

138 
I¡
 
k
 = 0, 
k0
 = 0, 
k1
 = 0;

139 
	`READ_CODE
(1, 
bô
, "delta_rps_sign");

140 
	`READ_UVLC
(
code
, "abs_delta_rps_minus1");

141 
I¡
 
dñèRPS
 = (1 - 2 * 
bô
Ë* (
code
 + 1);

142 #i‡
MCTS_EXTRACTION


143 
Ωs
->
	`£tDñèRPS
(
dñèRPS
);

145 
I¡
 
j
=0 ; j <
ΩsRef
->
	`gëNumbîOfPi˘uªs
(); j++)

147 
	`READ_CODE
(1, 
bô
, "used_by_curr_pic_flag" );

148 
I¡
 
ªfIdc
 = 
bô
;

149 i‡(
ªfIdc
 == 0)

151 
	`READ_CODE
(1, 
bô
, "use_delta_flag" );

152 
ªfIdc
 = 
bô
<<1;

154 i‡(
ªfIdc
 == 1 ||ÑefIdc == 2)

156 
I¡
 
dñèPOC
 = 
dñèRPS
 + ((
j
 < 
ΩsRef
->
	`gëNumbîOfPi˘uªs
())?ÑpsRef->
	`gëDñèPOC
(j) : 0);

157 
Ωs
->
	`£tDñèPOC
(
k
, 
dñèPOC
);

158 
Ωs
->
	`£tU£d
(
k
, (
ªfIdc
 == 1));

160 i‡(
dñèPOC
 < 0)

162 
k0
++;

166 
k1
++;

168 
k
++;

170 
Ωs
->
	`£tRefIdc
(
j
,
ªfIdc
);

172 
Ωs
->
	`£tNumRefIdc
(
ΩsRef
->
	`gëNumbîOfPi˘uªs
()+1);

173 
Ωs
->
	`£tNumbîOfPi˘uªs
(
k
);

174 
Ωs
->
	`£tNumbîOfNeg©ivePi˘uªs
(
k0
);

175 
Ωs
->
	`£tNumbîOfPosôivePi˘uªs
(
k1
);

176 
Ωs
->
	`s‹tDñèPOC
();

180 
	`READ_UVLC
(
code
, "num_√g©ive_pics"); 
Ωs
->
	`£tNumbîOfNeg©ivePi˘uªs
(code);

181 
	`READ_UVLC
(
code
, "num_posôive_pics"); 
Ωs
->
	`£tNumbîOfPosôivePi˘uªs
(code);

182 
I¡
 
¥ev
 = 0;

183 
I¡
 
poc
;

184 
I¡
 
j
=0 ; j < 
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
(); j++)

186 
	`READ_UVLC
(
code
, "delta_poc_s0_minus1");

187 
poc
 = 
¥ev
-
code
-1;

188 
¥ev
 = 
poc
;

189 
Ωs
->
	`£tDñèPOC
(
j
,
poc
);

190 
	`READ_FLAG
(
code
, "u£d_by_cuº_pic_s0_Êag"); 
Ωs
->
	`£tU£d
(
j
,code);

192 
¥ev
 = 0;

193 
I¡
 
j
=
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
(); j <Ñps->gëNumbîOfNeg©ivePi˘uªs()+Ωs->
	`gëNumbîOfPosôivePi˘uªs
(); j++)

195 
	`READ_UVLC
(
code
, "delta_poc_s1_minus1");

196 
poc
 = 
¥ev
+
code
+1;

197 
¥ev
 = 
poc
;

198 
Ωs
->
	`£tDñèPOC
(
j
,
poc
);

199 
	`READ_FLAG
(
code
, "u£d_by_cuº_pic_s1_Êag"); 
Ωs
->
	`£tU£d
(
j
,code);

201 
Ωs
->
	`£tNumbîOfPi˘uªs
‘ps->
	`gëNumbîOfNeg©ivePi˘uªs
()+Ωs->
	`gëNumbîOfPosôivePi˘uªs
());

203 #i‡
PRINT_RPS_INFO


204 
Ωs
->
	`¥ötDñèPOC
();

206 
	}
}

208 
Void
 
	gTDecCavlc
::
	$∑r£PPS
(
TComPPS
* 
pcPPS
)

210 #i‡
ENC_DEC_TRACE


211 #i‡
MCTS_EXTRACTION


212 
	`xTø˚PPSHódîDec
 ();

214 
	`xTø˚PPSHódî
();

217 
UI¡
 
uiCode
;

219 
I¡
 
iCode
;

221 
	`READ_UVLC_CHK
–
uiCode
, "pps_pic_parameter_set_id", 0, 63);

222 
	`as£π
(
uiCode
 <= 63);

223 
pcPPS
->
	`£tPPSId
 (
uiCode
);

225 
	`READ_UVLC_CHK
–
uiCode
, "pps_seq_parameter_set_id", 0, 15);

226 
	`as£π
(
uiCode
 <= 15);

227 
pcPPS
->
	`£tSPSId
 (
uiCode
);

229 
	`READ_FLAG
–
uiCode
, "dïídít_¶i˚_£gmíts_íabÀd_Êag" ); 
pcPPS
->
	`£tDïídítSli˚SegmítsE«bÀdFœg
 ( uiCode == 1 );

231 
	`READ_FLAG
–
uiCode
, "ouçut_Êag_¥e£¡_Êag" ); 
pcPPS
->
	`£tOuçutFœgPª£¡Fœg
( uiCode==1 );

233 
	`READ_CODE
(3, 
uiCode
, "num_exåa_¶i˚_hódî_bôs"); 
pcPPS
->
	`£tNumExåaSli˚HódîBôs
(uiCode);

235 
	`READ_FLAG
–
uiCode
, "sign_d©a_hidög_íabÀd_Êag" ); 
pcPPS
->
	`£tSignD©aHidögE«bÀdFœg
( uiCode );

237 
	`READ_FLAG
–
uiCode
, "ˇbac_öô_¥e£¡_Êag" ); 
pcPPS
->
	`£tCabacInôPª£¡Fœg
–uiCodê? 
åue
 : 
Ál£
 );

239 
	`READ_UVLC_CHK
(
uiCode
, "num_ref_idx_l0_default_active_minus1", 0, 14);

240 
	`as£π
(
uiCode
 <= 14);

241 
pcPPS
->
	`£tNumRefIdxL0DeÁu…A˘ive
(
uiCode
+1);

243 
	`READ_UVLC_CHK
(
uiCode
, "num_ref_idx_l1_default_active_minus1", 0, 14);

244 
	`as£π
(
uiCode
 <= 14);

245 
pcPPS
->
	`£tNumRefIdxL1DeÁu…A˘ive
(
uiCode
+1);

247 
	`READ_SVLC_CHK
(
iCode
, "öô_qp_möus26", 
°d
::
numîic_limôs
<
I¡
>::
	`mö
(), 25 ); 
pcPPS
->
	`£tPicInôQPMöus26
(iCode);

248 
	`READ_FLAG
–
uiCode
, "c⁄°øöed_öåa_¥ed_Êag" ); 
pcPPS
->
	`£tC⁄°øöedI¡øPªd
–uiCodê? 
åue
 : 
Ál£
 );

249 
	`READ_FLAG
–
uiCode
, "transform_skip_enabled_flag" );

250 
pcPPS
->
	`£tU£Tønsf‹mSkù
 ( 
uiCode
 ? 
åue
 : 
Ál£
 );

252 
	`READ_FLAG
–
uiCode
, "cu_qp_dñè_íabÀd_Êag" ); 
pcPPS
->
	`£tU£DQP
–uiCodê? 
åue
 : 
Ál£
 );

253 if–
pcPPS
->
	`gëU£DQP
() )

255 
	`READ_UVLC
–
uiCode
, "diff_cu_qp_delta_depth" );

256 
pcPPS
->
	`£tMaxCuDQPDïth
–
uiCode
 );

260 
pcPPS
->
	`£tMaxCuDQPDïth
( 0 );

262 
	`READ_SVLC_CHK
–
iCode
, "pps_cb_qp_offset", -12, 12);

263 
pcPPS
->
	`£tQpOff£t
(
COMPONENT_Cb
, 
iCode
);

264 
	`as£π
–
pcPPS
->
	`gëQpOff£t
(
COMPONENT_Cb
) >= -12 );

265 
	`as£π
–
pcPPS
->
	`gëQpOff£t
(
COMPONENT_Cb
) <= 12 );

267 
	`READ_SVLC_CHK
–
iCode
, "pps_cr_qp_offset", -12, 12);

268 
pcPPS
->
	`£tQpOff£t
(
COMPONENT_Cr
, 
iCode
);

269 
	`as£π
–
pcPPS
->
	`gëQpOff£t
(
COMPONENT_Cr
) >= -12 );

270 
	`as£π
–
pcPPS
->
	`gëQpOff£t
(
COMPONENT_Cr
) <= 12 );

272 
	`as£π
(
MAX_NUM_COMPONENT
<=3);

274 
	`READ_FLAG
–
uiCode
, "pps_slice_chroma_qp_offsets_present_flag" );

275 
pcPPS
->
	`£tSli˚ChromaQpFœg
–
uiCode
 ? 
åue
 : 
Ál£
 );

277 
	`READ_FLAG
–
uiCode
, "weighted_pred_flag" );

278 
pcPPS
->
	`£tU£WP
–
uiCode
==1 );

279 
	`READ_FLAG
–
uiCode
, "weighted_bipred_flag" );

280 
pcPPS
->
	`£tWPBiPªd
–
uiCode
==1 );

282 
	`READ_FLAG
–
uiCode
, "transquant_bypass_enabled_flag");

283 
pcPPS
->
	`£tTønsqu™tBy∑ssE«bÀdFœg
(
uiCode
 ? 
åue
 : 
Ál£
);

284 
	`READ_FLAG
–
uiCode
, "tûes_íabÀd_Êag" ); 
pcPPS
->
	`£tTûesE«bÀdFœg
 ( uiCode == 1 );

285 
	`READ_FLAG
–
uiCode
, "íå›y_codög_sync_íabÀd_Êag" ); 
pcPPS
->
	`£tE¡r›yCodögSyncE«bÀdFœg
( uiCode == 1 );

287 if–
pcPPS
->
	`gëTûesE«bÀdFœg
() )

289 
	`READ_UVLC
 ( 
uiCode
, "num_tûe_cﬁumns_möus1" ); 
pcPPS
->
	`£tNumTûeCﬁumnsMöus1
( uiCode );

290 
	`READ_UVLC
 ( 
uiCode
, "num_tûe_rows_möus1" ); 
pcPPS
->
	`£tNumTûeRowsMöus1
( uiCode );

291 
	`READ_FLAG
 ( 
uiCode
, "unif‹m_•acög_Êag" ); 
pcPPS
->
	`£tTûeUnif‹mS∑cögFœg
( uiCode == 1 );

293 c⁄° 
UI¡
 
tûeCﬁumnsMöus1
 = 
pcPPS
->
	`gëNumTûeCﬁumnsMöus1
();

294 c⁄° 
UI¡
 
tûeRowsMöus1
 = 
pcPPS
->
	`gëNumTûeRowsMöus1
();

296 i‡–!
pcPPS
->
	`gëTûeUnif‹mS∑cögFœg
())

298 i‡(
tûeCﬁumnsMöus1
 > 0)

300 
°d
::
ve˘‹
<
I¡
> 
	`cﬁumnWidth
(
tûeCﬁumnsMöus1
);

301 
UI¡
 
i
 = 0; i < 
tûeCﬁumnsMöus1
; i++)

303 
	`READ_UVLC
–
uiCode
, "column_width_minus1" );

304 
cﬁumnWidth
[
i
] = 
uiCode
+1;

306 
pcPPS
->
	`£tTûeCﬁumnWidth
(
cﬁumnWidth
);

309 i‡(
tûeRowsMöus1
 > 0)

311 
°d
::
ve˘‹
<
I¡
> 
	`rowHeight
 (
tûeRowsMöus1
);

312 
UI¡
 
i
 = 0; i < 
tûeRowsMöus1
; i++)

314 
	`READ_UVLC
–
uiCode
, "row_height_minus1" );

315 
rowHeight
[
i
] = 
uiCode
 + 1;

317 
pcPPS
->
	`£tTûeRowHeight
(
rowHeight
);

320 
	`as£π
 ((
tûeCﬁumnsMöus1
 + 
tûeRowsMöus1
) != 0);

321 
	`READ_FLAG
 ( 
uiCode
, "lo›_fûãr_a¸oss_tûes_íabÀd_Êag" ); 
pcPPS
->
	`£tLo›FûãrA¸ossTûesE«bÀdFœg
–uiCodê? 
åue
 : 
Ál£
 );

323 
	`READ_FLAG
–
uiCode
, "µs_lo›_fûãr_a¸oss_¶i˚s_íabÀd_Êag" ); 
pcPPS
->
	`£tLo›FûãrA¸ossSli˚sE«bÀdFœg
–uiCodê? 
åue
 : 
Ál£
 );

324 
	`READ_FLAG
–
uiCode
, "deblockög_fûãr_c⁄åﬁ_¥e£¡_Êag" ); 
pcPPS
->
	`£tDeblockögFûãrC⁄åﬁPª£¡Fœg
–uiCodê? 
åue
 : 
Ál£
 );

325 if(
pcPPS
->
	`gëDeblockögFûãrC⁄åﬁPª£¡Fœg
())

327 
	`READ_FLAG
–
uiCode
, "deblockög_fûãr_ovîride_íabÀd_Êag" ); 
pcPPS
->
	`£tDeblockögFûãrOvîrideE«bÀdFœg
–uiCodê? 
åue
 : 
Ál£
 );

328 
	`READ_FLAG
–
uiCode
, "µs_deblockög_fûãr_dißbÀd_Êag" ); 
pcPPS
->
	`£tPPSDeblockögFûãrDißbÀdFœg
(uiCodê? 
åue
 : 
Ál£
 );

329 if(!
pcPPS
->
	`gëPPSDeblockögFûãrDißbÀdFœg
())

331 
	`READ_SVLC
 ( 
iCode
, "µs_bëa_off£t_div2" ); 
pcPPS
->
	`£tDeblockögFûãrBëaOff£tDiv2
( iCode );

332 
	`READ_SVLC
 ( 
iCode
, "µs_tc_off£t_div2" ); 
pcPPS
->
	`£tDeblockögFûãrTcOff£tDiv2
( iCode );

335 
	`READ_FLAG
–
uiCode
, "µs_sˇlög_li°_d©a_¥e£¡_Êag" ); 
pcPPS
->
	`£tSˇlögLi°Pª£¡Fœg
–uiCodê? 
åue
 : 
Ál£
 );

336 if(
pcPPS
->
	`gëSˇlögLi°Pª£¡Fœg
 ())

338 
	`∑r£SˇlögLi°
–&(
pcPPS
->
	`gëSˇlögLi°
()) );

341 
	`READ_FLAG
–
uiCode
, "lists_modification_present_flag");

342 
pcPPS
->
	`£tLi°sModifiˇti⁄Pª£¡Fœg
(
uiCode
);

344 
	`READ_UVLC
–
uiCode
, "log2_parallel_merge_level_minus2");

345 
pcPPS
->
	`£tLog2P¨ÆÀlMîgeLevñMöus2
 (
uiCode
);

347 
	`READ_FLAG
–
uiCode
, "slice_segment_header_extension_present_flag");

348 
pcPPS
->
	`£tSli˚HódîExãnsi⁄Pª£¡Fœg
(
uiCode
);

350 
	`READ_FLAG
–
uiCode
, "pps_extension_present_flag");

351 i‡(
uiCode
)

353 #i‡
ENC_DEC_TRACE
 || 
RExt__DECODER_DEBUG_BIT_STATISTICS


354 c⁄° 
TCh¨
 *
sy¡axSåögs
[]={ "pps_range_extension_flag",

364 
Boﬁ
 
µs_exãnsi⁄_Êags
[
NUM_PPS_EXTENSION_FLAGS
];

365 
I¡
 
i
=0; i<
NUM_PPS_EXTENSION_FLAGS
; i++)

367 
	`READ_FLAG
–
uiCode
, 
sy¡axSåögs
[
i
] );

368 
µs_exãnsi⁄_Êags
[
i
] = 
uiCode
!=0;

371 
Boﬁ
 
bSkùTøûögExãnsi⁄Bôs
=
Ál£
;

372 
I¡
 
i
=0; i<
NUM_PPS_EXTENSION_FLAGS
; i++)

374 i‡(
µs_exãnsi⁄_Êags
[
i
])

376 
	`PPSExãnsi⁄FœgIndex
(
i
))

378 
PPS_EXT__REXT
:

380 
TComPPSRExt
 &
µsR™geExãnsi⁄
 = 
pcPPS
->
	`gëPpsR™geExãnsi⁄
();

381 
	`as£π
(!
bSkùTøûögExãnsi⁄Bôs
);

383 i‡(
pcPPS
->
	`gëU£Tønsf‹mSkù
())

385 
	`READ_UVLC
–
uiCode
, "log2_max_transform_skip_block_size_minus2");

386 
µsR™geExãnsi⁄
.
	`£tLog2MaxTønsf‹mSkùBlockSize
(
uiCode
+2);

389 
	`READ_FLAG
–
uiCode
, "cross_component_prediction_enabled_flag");

390 
µsR™geExãnsi⁄
.
	`£tCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
(
uiCode
 != 0);

392 
	`READ_FLAG
–
uiCode
, "chroma_qp_offset_list_enabled_flag");

393 i‡(
uiCode
 == 0)

395 
µsR™geExãnsi⁄
.
	`˛órChromaQpOff£tLi°
();

396 
µsR™geExãnsi⁄
.
	`£tDiffCuChromaQpOff£tDïth
(0);

400 
	`READ_UVLC
(
uiCode
, "diff_cu_chroma_qp_off£t_dïth"); 
µsR™geExãnsi⁄
.
	`£tDiffCuChromaQpOff£tDïth
(uiCode);

401 
UI¡
 
èbÀSizeMöus1
 = 0;

402 
	`READ_UVLC_CHK
(
èbÀSizeMöus1
, "chroma_qp_off£t_li°_Àn_möus1", 0, 
MAX_QP_OFFSET_LIST_SIZE
-1);

403 
	`as£π
(
èbÀSizeMöus1
 < 
MAX_QP_OFFSET_LIST_SIZE
);

405 
I¡
 
cuChromaQpOff£tIdx
 = 0; cuChromaQpOff£tIdx <(
èbÀSizeMöus1
); cuChromaQpOffsetIdx++)

407 
I¡
 
cbOff£t
;

408 
I¡
 
¸Off£t
;

409 
	`READ_SVLC_CHK
(
cbOff£t
, "cb_qp_offset_list[i]", -12, 12);

410 
	`as£π
(
cbOff£t
 >= -12 && cbOffset <= 12);

411 
	`READ_SVLC_CHK
(
¸Off£t
, "cr_qp_offset_list[i]", -12, 12);

412 
	`as£π
(
¸Off£t
 >= -12 && crOffset <= 12);

414 
µsR™geExãnsi⁄
.
	`£tChromaQpOff£tLi°E¡ry
(
cuChromaQpOff£tIdx
+1, 
cbOff£t
, 
¸Off£t
);

416 
	`as£π
(
µsR™geExãnsi⁄
.
	`gëChromaQpOff£tLi°Lí
(Ë=
èbÀSizeMöus1
 + 1);

419 
	`READ_UVLC
–
uiCode
, "log2_sao_offset_scale_luma");

420 
µsR™geExãnsi⁄
.
	`£tLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_LUMA
, 
uiCode
);

421 
	`READ_UVLC
–
uiCode
, "log2_sao_offset_scale_chroma");

422 
µsR™geExãnsi⁄
.
	`£tLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_CHROMA
, 
uiCode
);

426 
bSkùTøûögExãnsi⁄Bôs
=
åue
;

431 i‡(
bSkùTøûögExãnsi⁄Bôs
)

433  
	`xM‹eRb•D©a
() )

435 
	`READ_FLAG
–
uiCode
, "pps_extension_data_flag");

439 
	`xRódRb•TøûögBôs
();

440 
	}
}

442 
Void
 
	gTDecCavlc
::
	$∑r£VUI
(
TComVUI
* 
pcVUI
, 
TComSPS
 *
pcSPS
)

444 #i‡
ENC_DEC_TRACE


445 
	`Ârötf
–
g_hTø˚
, "----------- vui_parameters -----------\n");

447 
UI¡
 
uiCode
;

449 
	`READ_FLAG
–
uiCode
, "a•e˘_øtio_öfo_¥e£¡_Êag"); 
pcVUI
->
	`£tA•e˘R©ioInfoPª£¡Fœg
(uiCode);

450 i‡(
pcVUI
->
	`gëA•e˘R©ioInfoPª£¡Fœg
())

452 
	`READ_CODE
(8, 
uiCode
, "a•e˘_øtio_idc"); 
pcVUI
->
	`£tA•e˘R©ioIdc
(uiCode);

453 i‡(
pcVUI
->
	`gëA•e˘R©ioIdc
() == 255)

455 
	`READ_CODE
(16, 
uiCode
, "ßr_width"); 
pcVUI
->
	`£tS¨Width
(uiCode);

456 
	`READ_CODE
(16, 
uiCode
, "ßr_height"); 
pcVUI
->
	`£tS¨Height
(uiCode);

460 
	`READ_FLAG
–
uiCode
, "ovîsˇn_öfo_¥e£¡_Êag"); 
pcVUI
->
	`£tOvîsˇnInfoPª£¡Fœg
(uiCode);

461 i‡(
pcVUI
->
	`gëOvîsˇnInfoPª£¡Fœg
())

463 
	`READ_FLAG
–
uiCode
, "ovîsˇn_≠¥›rüã_Êag"); 
pcVUI
->
	`£tOvîsˇnAµr›rüãFœg
(uiCode);

466 
	`READ_FLAG
–
uiCode
, "video_sig«l_ty≥_¥e£¡_Êag"); 
pcVUI
->
	`£tVideoSig«lTy≥Pª£¡Fœg
(uiCode);

467 i‡(
pcVUI
->
	`gëVideoSig«lTy≥Pª£¡Fœg
())

469 
	`READ_CODE
(3, 
uiCode
, "video_f‹m©"); 
pcVUI
->
	`£tVideoF‹m©
(uiCode);

470 
	`READ_FLAG
–
uiCode
, "video_fuŒ_ønge_Êag"); 
pcVUI
->
	`£tVideoFuŒR™geFœg
(uiCode);

471 
	`READ_FLAG
–
uiCode
, "cﬁour_des¸ùti⁄_¥e£¡_Êag"); 
pcVUI
->
	`£tCﬁourDes¸ùti⁄Pª£¡Fœg
(uiCode);

472 i‡(
pcVUI
->
	`gëCﬁourDes¸ùti⁄Pª£¡Fœg
())

474 
	`READ_CODE
(8, 
uiCode
, "cﬁour_¥im¨õs"); 
pcVUI
->
	`£tCﬁourPrim¨õs
(uiCode);

475 
	`READ_CODE
(8, 
uiCode
, "å™s„r_ch¨a˘îi°ics"); 
pcVUI
->
	`£tTøns„rCh¨a˘îi°ics
(uiCode);

476 
	`READ_CODE
(8, 
uiCode
, "m©rix_c€ffs"); 
pcVUI
->
	`£tM©rixC€fficõ¡s
(uiCode);

480 
	`READ_FLAG
–
uiCode
, "chroma_loc_öfo_¥e£¡_Êag"); 
pcVUI
->
	`£tChromaLocInfoPª£¡Fœg
(uiCode);

481 i‡(
pcVUI
->
	`gëChromaLocInfoPª£¡Fœg
())

483 
	`READ_UVLC
–
uiCode
, "chroma_ßm∂e_loc_ty≥_t›_fõld" ); 
pcVUI
->
	`£tChromaSam∂eLocTy≥T›Fõld
(uiCode);

484 
	`READ_UVLC
–
uiCode
, "chroma_ßm∂e_loc_ty≥_bŸtom_fõld" ); 
pcVUI
->
	`£tChromaSam∂eLocTy≥BŸtomFõld
(uiCode);

487 
	`READ_FLAG
–
uiCode
, "√uåÆ_chroma_ödiˇti⁄_Êag"); 
pcVUI
->
	`£tNeuåÆChromaIndiˇti⁄Fœg
(uiCode);

489 
	`READ_FLAG
–
uiCode
, "fõld_£q_Êag"); 
pcVUI
->
	`£tFõldSeqFœg
(uiCode);

491 
	`READ_FLAG
(
uiCode
, "‰ame_fõld_öfo_¥e£¡_Êag"); 
pcVUI
->
	`£tFømeFõldInfoPª£¡Fœg
(uiCode);

493 
	`READ_FLAG
–
uiCode
, "default_display_window_flag");

494 i‡(
uiCode
 != 0)

496 
Wödow
 &
defDi•
 = 
pcVUI
->
	`gëDeÁu…Di•œyWödow
();

497 
	`READ_UVLC
–
uiCode
, "def_di•_wö_À·_off£t" ); 
defDi•
.
	`£tWödowLe·Off£t
 ( uiCodê* 
TComSPS
::
	`gëWöUnôX
–
pcSPS
->
	`gëChromaF‹m©Idc
()) );

498 
	`READ_UVLC
–
uiCode
, "def_di•_wö_right_off£t" ); 
defDi•
.
	`£tWödowRightOff£t
 ( uiCodê* 
TComSPS
::
	`gëWöUnôX
–
pcSPS
->
	`gëChromaF‹m©Idc
()) );

499 
	`READ_UVLC
–
uiCode
, "def_di•_wö_t›_off£t" ); 
defDi•
.
	`£tWödowT›Off£t
 ( uiCodê* 
TComSPS
::
	`gëWöUnôY
–
pcSPS
->
	`gëChromaF‹m©Idc
()) );

500 
	`READ_UVLC
–
uiCode
, "def_di•_wö_bŸtom_off£t" ); 
defDi•
.
	`£tWödowBŸtomOff£t
–uiCodê* 
TComSPS
::
	`gëWöUnôY
–
pcSPS
->
	`gëChromaF‹m©Idc
()) );

503 
TimögInfo
 *
timögInfo
 = 
pcVUI
->
	`gëTimögInfo
();

504 
	`READ_FLAG
–
uiCode
, "vui_timög_öfo_¥e£¡_Êag"); 
timögInfo
->
	`£tTimögInfoPª£¡Fœg
 (uiCodê? 
åue
 : 
Ál£
);

505 if(
timögInfo
->
	`gëTimögInfoPª£¡Fœg
())

507 
	`READ_CODE
–32, 
uiCode
, "vui_num_unôs_ö_tick"); 
timögInfo
->
	`£tNumUnôsInTick
 (uiCode);

508 
	`READ_CODE
–32, 
uiCode
, "vui_time_sˇÀ"); 
timögInfo
->
	`£tTimeSˇÀ
 (uiCode);

509 
	`READ_FLAG
–
uiCode
, "vui_poc_¥›‹ti⁄Æ_to_timög_Êag"); 
timögInfo
->
	`£tPocPr›‹ti⁄ÆToTimögFœg
(uiCodê? 
åue
 : 
Ál£
);

510 if(
timögInfo
->
	`gëPocPr›‹ti⁄ÆToTimögFœg
())

512 
	`READ_UVLC
–
uiCode
, "vui_num_ticks_poc_diff_⁄e_möus1"); 
timögInfo
->
	`£tNumTicksPocDiffO√Möus1
 (uiCode);

515 
	`READ_FLAG
–
uiCode
, "vui_hrd_∑ømëîs_¥e£¡_Êag"); 
pcVUI
->
	`£tHrdP¨amëîsPª£¡Fœg
(uiCode);

516 if–
pcVUI
->
	`gëHrdP¨amëîsPª£¡Fœg
() )

518 
	`∑r£HrdP¨amëîs
–
pcVUI
->
	`gëHrdP¨amëîs
(), 1, 
pcSPS
->
	`gëMaxTLayîs
() - 1 );

522 
	`READ_FLAG
–
uiCode
, "bô°ªam_ª°ri˘i⁄_Êag"); 
pcVUI
->
	`£tBô°ªamRe°ri˘i⁄Fœg
(uiCode);

523 i‡(
pcVUI
->
	`gëBô°ªamRe°ri˘i⁄Fœg
())

525 
	`READ_FLAG
–
uiCode
, "tûes_fixed_°ru˘uª_Êag"); 
pcVUI
->
	`£tTûesFixedSåu˘uªFœg
(uiCode);

526 
	`READ_FLAG
–
uiCode
, "mŸi⁄_ve˘‹s_ovî_pic_bound¨õs_Êag"); 
pcVUI
->
	`£tMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(uiCode);

527 
	`READ_FLAG
–
uiCode
, "ª°ri˘ed_ªf_pic_li°s_Êag"); 
pcVUI
->
	`£tRe°ri˘edRefPicLi°sFœg
(uiCode);

528 
	`READ_UVLC
–
uiCode
, "mö_•©ül_£gmíèti⁄_idc"); 
pcVUI
->
	`£tMöS∑tülSegmíèti⁄Idc
(uiCode);

529 
	`as£π
(
uiCode
 < 4096);

530 
	`READ_UVLC
–
uiCode
, "max_byãs_≥r_pic_díom" ); 
pcVUI
->
	`£tMaxByãsPîPicDíom
(uiCode);

531 
	`READ_UVLC
–
uiCode
, "max_bôs_≥r_mö_cu_díom" ); 
pcVUI
->
	`£tMaxBôsPîMöCuDíom
(uiCode);

532 
	`READ_UVLC
–
uiCode
, "log2_max_mv_Àngth_h‹iz⁄èl" ); 
pcVUI
->
	`£tLog2MaxMvLígthH‹iz⁄èl
(uiCode);

533 
	`READ_UVLC
–
uiCode
, "log2_max_mv_Àngth_vîtiˇl" ); 
pcVUI
->
	`£tLog2MaxMvLígthVîtiˇl
(uiCode);

535 
	}
}

537 
Void
 
	gTDecCavlc
::
	$∑r£HrdP¨amëîs
(
TComHRD
 *
hrd
, 
Boﬁ
 
comm⁄InfPª£¡Fœg
, 
UI¡
 
maxNumSubLayîsMöus1
)

539 
UI¡
 
uiCode
;

540 if–
comm⁄InfPª£¡Fœg
 )

542 
	`READ_FLAG
–
uiCode
, "«l_hrd_∑ømëîs_¥e£¡_Êag" ); 
hrd
->
	`£tNÆHrdP¨amëîsPª£¡Fœg
–uiCodê=1 ? 
åue
 : 
Ál£
 );

543 
	`READ_FLAG
–
uiCode
, "v˛_hrd_∑ømëîs_¥e£¡_Êag" ); 
hrd
->
	`£tV˛HrdP¨amëîsPª£¡Fœg
–uiCodê=1 ? 
åue
 : 
Ál£
 );

544 if–
hrd
->
	`gëNÆHrdP¨amëîsPª£¡Fœg
(Ë|| hrd->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() )

546 
	`READ_FLAG
–
uiCode
, "sub_pic_hrd_∑øms_¥e£¡_Êag" ); 
hrd
->
	`£tSubPicCpbP¨amsPª£¡Fœg
–uiCodê=1 ? 
åue
 : 
Ál£
 );

547 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

549 
	`READ_CODE
–8, 
uiCode
, "tick_divis‹_möus2" ); 
hrd
->
	`£tTickDivis‹Möus2
( uiCode );

550 
	`READ_CODE
–5, 
uiCode
, "du_˝b_ªmovÆ_dñay_ö¸emít_Àngth_möus1" ); 
hrd
->
	`£tDuCpbRemovÆDñayLígthMöus1
( uiCode );

551 
	`READ_FLAG
–
uiCode
, "sub_pic_˝b_∑øms_ö_pic_timög_£i_Êag" ); 
hrd
->
	`£tSubPicCpbP¨amsInPicTimögSEIFœg
–uiCodê=1 ? 
åue
 : 
Ál£
 );

552 
	`READ_CODE
–5, 
uiCode
, "dpb_ouçut_dñay_du_Àngth_möus1" ); 
hrd
->
	`£tDpbOuçutDñayDuLígthMöus1
( uiCode );

554 
	`READ_CODE
–4, 
uiCode
, "bô_øã_sˇÀ" ); 
hrd
->
	`£tBôR©eSˇÀ
( uiCode );

555 
	`READ_CODE
–4, 
uiCode
, "˝b_size_sˇÀ" ); 
hrd
->
	`£tCpbSizeSˇÀ
( uiCode );

556 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

558 
	`READ_CODE
–4, 
uiCode
, "˝b_size_du_sˇÀ" ); 
hrd
->
	`£tDuCpbSizeSˇÀ
( uiCode );

560 
	`READ_CODE
–5, 
uiCode
, "öôül_˝b_ªmovÆ_dñay_Àngth_möus1" ); 
hrd
->
	`£tInôülCpbRemovÆDñayLígthMöus1
( uiCode );

561 
	`READ_CODE
–5, 
uiCode
, "au_˝b_ªmovÆ_dñay_Àngth_möus1" ); 
hrd
->
	`£tCpbRemovÆDñayLígthMöus1
( uiCode );

562 
	`READ_CODE
–5, 
uiCode
, "dpb_ouçut_dñay_Àngth_möus1" ); 
hrd
->
	`£tDpbOuçutDñayLígthMöus1
( uiCode );

565 
I¡
 
i
, 
j
, 
«lOrV˛
;

566  
i
 = 0; i <
maxNumSubLayîsMöus1
; i ++ )

568 
	`READ_FLAG
–
uiCode
, "fixed_pic_øã_gíîÆ_Êag" ); 
hrd
->
	`£tFixedPicR©eFœg
–
i
, uiCodê=1 ? 
åue
 : 
Ál£
 );

569 if–!
hrd
->
	`gëFixedPicR©eFœg
–
i
 ) )

571 
	`READ_FLAG
–
uiCode
, "fixed_pic_øã_wôhö_cvs_Êag" ); 
hrd
->
	`£tFixedPicR©eWôhöCvsFœg
–
i
, uiCodê=1 ? 
åue
 : 
Ál£
 );

575 
hrd
->
	`£tFixedPicR©eWôhöCvsFœg
–
i
, 
åue
 );

578 
hrd
->
	`£tLowDñayHrdFœg
–
i
, 0 );

579 
hrd
->
	`£tCpbC¡Möus1
 ( 
i
, 0 );

581 if–
hrd
->
	`gëFixedPicR©eWôhöCvsFœg
–
i
 ) )

583 
	`READ_UVLC
–
uiCode
, "ñemíèl_duøti⁄_ö_tc_möus1" ); 
hrd
->
	`£tPicDuøti⁄InTcMöus1
–
i
, uiCode );

587 
	`READ_FLAG
–
uiCode
, "low_dñay_hrd_Êag" ); 
hrd
->
	`£tLowDñayHrdFœg
–
i
, uiCodê=1 ? 
åue
 : 
Ál£
 );

589 i‡(!
hrd
->
	`gëLowDñayHrdFœg
–
i
 ))

591 
	`READ_UVLC
–
uiCode
, "˝b_˙t_möus1" ); 
hrd
->
	`£tCpbC¡Möus1
–
i
, uiCode );

594  
«lOrV˛
 = 0;ÇalOrVcl < 2;ÇalOrVcl ++ )

596 if–––
«lOrV˛
 =0 ) && ( 
hrd
->
	`gëNÆHrdP¨amëîsPª£¡Fœg
() ) ) ||

597 ––
«lOrV˛
 =1 ) && ( 
hrd
->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() ) ) )

599  
j
 = 0; j <–
hrd
->
	`gëCpbC¡Möus1
–
i
 ) ); j ++ )

601 
	`READ_UVLC
–
uiCode
, "bô_øã_vÆue_möus1" ); 
hrd
->
	`£tBôR©eVÆueMöus1
–
i
, 
j
, 
«lOrV˛
, uiCode );

602 
	`READ_UVLC
–
uiCode
, "˝b_size_vÆue_möus1" ); 
hrd
->
	`£tCpbSizeVÆueMöus1
–
i
, 
j
, 
«lOrV˛
, uiCode );

603 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

605 
	`READ_UVLC
–
uiCode
, "˝b_size_du_vÆue_möus1" ); 
hrd
->
	`£tDuCpbSizeVÆueMöus1
–
i
, 
j
, 
«lOrV˛
, uiCode );

606 
	`READ_UVLC
–
uiCode
, "bô_øã_du_vÆue_möus1" ); 
hrd
->
	`£tDuBôR©eVÆueMöus1
–
i
, 
j
, 
«lOrV˛
, uiCode );

608 
	`READ_FLAG
–
uiCode
, "cbr_Êag" ); 
hrd
->
	`£tCbrFœg
–
i
, 
j
, 
«lOrV˛
, uiCodê=1 ? 
åue
 : 
Ál£
 );

613 
	}
}

615 
Void
 
	gTDecCavlc
::
	$∑r£SPS
(
TComSPS
* 
pcSPS
)

617 #i‡
ENC_DEC_TRACE


618 #i‡
MCTS_EXTRACTION


619 
	`xTø˚SPSHódîDec
 ();

621 
	`xTø˚SPSHódî
 ();

625 
UI¡
 
uiCode
;

626 
	`READ_CODE
–4, 
uiCode
, "•s_video_∑ømëî_£t_id"); 
pcSPS
->
	`£tVPSId
 ( uiCode );

627 
	`READ_CODE_CHK
–3, 
uiCode
, "•s_max_sub_œyîs_möus1", 0, 6 ); 
pcSPS
->
	`£tMaxTLayîs
 ( uiCode+1 );

628 
	`as£π
(
uiCode
 <= 6);

630 
	`READ_FLAG
–
uiCode
, "•s_ãmp‹Æ_id_√°ög_Êag" ); 
pcSPS
->
	`£tTemp‹ÆIdNe°ögFœg
 ( uiCodê> 0 ? 
åue
 : 
Ál£
 );

631 i‡–
pcSPS
->
	`gëMaxTLayîs
() == 1 )

634 
TDecC⁄f‹m™˚Check
::
	`checkR™ge
(
uiCode
, "sps_temporal_id_nesting_flag", 1U, 1U);

635 
	`as£π
–
uiCode
 == 1 );

638 
	`∑r£PTL
(
pcSPS
->
	`gëPTL
(), 1,ÖcSPS->
	`gëMaxTLayîs
() - 1);

639 
	`READ_UVLC_CHK
–
uiCode
, "•s_£q_∑ømëî_£t_id", 0, 15 ); 
pcSPS
->
	`£tSPSId
( uiCode );

640 
	`as£π
(
uiCode
 <= 15);

642 
	`READ_UVLC_CHK
–
uiCode
, "chroma_f‹m©_idc", 0, 3 ); 
pcSPS
->
	`£tChromaF‹m©Idc
–
	`ChromaF‹m©
(uiCode) );

643 
	`as£π
(
uiCode
 <= 3);

645 if–
pcSPS
->
	`gëChromaF‹m©Idc
(Ë=
CHROMA_444
 )

647 
	`READ_FLAG_CHK
–
uiCode
, "separate_colour_plane_flag", 0, 0);

648 
	`as£π
(
uiCode
 == 0);

652 
	`READ_UVLC_CHK
 ( 
uiCode
, "pic_width_ö_luma_ßm∂es", 1, 
°d
::
numîic_limôs
<
UI¡
>::
	`max
(Ë); 
pcSPS
->
	`£tPicWidthInLumaSam∂es
 ( uiCode );

653 
	`READ_UVLC_CHK
 ( 
uiCode
, "pic_height_ö_luma_ßm∂es", 1, 
°d
::
numîic_limôs
<
UI¡
>::
	`max
(Ë); 
pcSPS
->
	`£tPicHeightInLumaSam∂es
( uiCode );

654 
	`READ_FLAG
–
uiCode
, "conformance_window_flag");

655 i‡(
uiCode
 != 0)

657 
Wödow
 &
c⁄f
 = 
pcSPS
->
	`gëC⁄f‹m™˚Wödow
();

658 c⁄° 
UI¡
 
subWidthC
 = 
TComSPS
::
	`gëWöUnôX
–
pcSPS
->
	`gëChromaF‹m©Idc
() );

659 c⁄° 
UI¡
 
subHeightC
 = 
TComSPS
::
	`gëWöUnôY
–
pcSPS
->
	`gëChromaF‹m©Idc
() );

660 
	`READ_UVLC
–
uiCode
, "c⁄f_wö_À·_off£t" ); 
c⁄f
.
	`£tWödowLe·Off£t
 ( uiCodê* 
subWidthC
 );

661 
	`READ_UVLC
–
uiCode
, "c⁄f_wö_right_off£t" ); 
c⁄f
.
	`£tWödowRightOff£t
 ( uiCodê* 
subWidthC
 );

662 
	`READ_UVLC
–
uiCode
, "c⁄f_wö_t›_off£t" ); 
c⁄f
.
	`£tWödowT›Off£t
 ( uiCodê* 
subHeightC
 );

663 
	`READ_UVLC
–
uiCode
, "c⁄f_wö_bŸtom_off£t" ); 
c⁄f
.
	`£tWödowBŸtomOff£t
–uiCodê* 
subHeightC
 );

664 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
UI¡
>(
c⁄f
.
	`gëWödowLe·Off£t
()+c⁄f.
	`gëWödowRightOff£t
(), "c⁄f‹m™˚ wödow width i¿pixñs", 0, 
pcSPS
->
	`gëPicWidthInLumaSam∂es
()-1);

667 
	`READ_UVLC_CHK
–
uiCode
, "bit_depth_luma_minus8", 0, 8 );

668 
	`as£π
(
uiCode
 <= 8);

669 #i‡
O0043_BEST_EFFORT_DECODING


670 
pcSPS
->
	`£tSåómBôDïth
(
CHANNEL_TYPE_LUMA
, 8 + 
uiCode
);

671 c⁄° 
UI¡
 
f‹˚DecodeBôDïth
 = 
pcSPS
->
	`gëF‹˚DecodeBôDïth
();

672 i‡(
f‹˚DecodeBôDïth
 != 0)

674 
uiCode
 = 
f‹˚DecodeBôDïth
 - 8;

676 
	`as£π
(
uiCode
 <= 8);

678 
pcSPS
->
	`£tBôDïth
(
CHANNEL_TYPE_LUMA
, 8 + 
uiCode
);

680 #i‡
O0043_BEST_EFFORT_DECODING


681 
pcSPS
->
	`£tQpBDOff£t
(
CHANNEL_TYPE_LUMA
, (
I¡
Ë(6*’cSPS->
	`gëSåómBôDïth
(CHANNEL_TYPE_LUMA)-8)) );

683 
pcSPS
->
	`£tQpBDOff£t
(
CHANNEL_TYPE_LUMA
, (
I¡
Ë(6*
uiCode
) );

686 
	`READ_UVLC_CHK
–
uiCode
, "bit_depth_chroma_minus8", 0, 8 );

687 
	`as£π
(
uiCode
 <= 8);

688 #i‡
O0043_BEST_EFFORT_DECODING


689 
pcSPS
->
	`£tSåómBôDïth
(
CHANNEL_TYPE_CHROMA
, 8 + 
uiCode
);

690 i‡(
f‹˚DecodeBôDïth
 != 0)

692 
uiCode
 = 
f‹˚DecodeBôDïth
 - 8;

694 
	`as£π
(
uiCode
 <= 8);

696 
pcSPS
->
	`£tBôDïth
(
CHANNEL_TYPE_CHROMA
, 8 + 
uiCode
);

697 #i‡
O0043_BEST_EFFORT_DECODING


698 
pcSPS
->
	`£tQpBDOff£t
(
CHANNEL_TYPE_CHROMA
, (
I¡
Ë(6*’cSPS->
	`gëSåómBôDïth
(CHANNEL_TYPE_CHROMA)-8)) );

700 
pcSPS
->
	`£tQpBDOff£t
(
CHANNEL_TYPE_CHROMA
, (
I¡
Ë(6*
uiCode
) );

703 
	`READ_UVLC_CHK
–
uiCode
, "log2_max_pic_‹dî_˙t_lsb_möus4", 0, 12 ); 
pcSPS
->
	`£tBôsF‹POC
( 4 + uiCode );

705 
UI¡
 
subLayîOrdîögInfoPª£¡Fœg
;

706 
	`READ_FLAG
(
subLayîOrdîögInfoPª£¡Fœg
, "sps_sub_layer_ordering_info_present_flag");

708 
UI¡
 
i
=0; i <
pcSPS
->
	`gëMaxTLayîs
()-1; i++)

710 
	`READ_UVLC
 ( 
uiCode
, "sps_max_dec_pic_buffering_minus1[i]");

711 
pcSPS
->
	`£tMaxDecPicBuf„rög
–
uiCode
 + 1, 
i
);

712 
	`READ_UVLC
 ( 
uiCode
, "sps_max_num_reorder_pics[i]" );

713 
pcSPS
->
	`£tNumRe‹dîPics
(
uiCode
, 
i
);

714 
	`READ_UVLC
 ( 
uiCode
, "sps_max_latency_increase_plus1[i]");

715 
pcSPS
->
	`£tMaxL©ícyIn¸ó£Plus1
–
uiCode
, 
i
 );

717 i‡(!
subLayîOrdîögInfoPª£¡Fœg
)

719 
i
++; i <
pcSPS
->
	`gëMaxTLayîs
()-1; i++)

721 
pcSPS
->
	`£tMaxDecPicBuf„rög
’cSPS->
	`gëMaxDecPicBuf„rög
(0), 
i
);

722 
pcSPS
->
	`£tNumRe‹dîPics
’cSPS->
	`gëNumRe‹dîPics
(0), 
i
);

723 
pcSPS
->
	`£tMaxL©ícyIn¸ó£Plus1
’cSPS->
	`gëMaxL©ícyIn¸ó£Plus1
(0), 
i
);

729 c⁄° 
UI¡
 
maxLog2CtbSize
 = 
TDecC⁄f‹m™˚Check
::
	`gëMaxLog2CtbSize
(*(
pcSPS
->
	`gëPTL
()));

730 c⁄° 
UI¡
 
möLog2CtbSize
 = 
TDecC⁄f‹m™˚Check
::
	`gëMöLog2CtbSize
(*(
pcSPS
->
	`gëPTL
()));

731 
	`READ_UVLC_CHK
–
uiCode
, "log2_mö_luma_codög_block_size_möus3", 0, 
maxLog2CtbSize
-3 );

732 
	`as£π
(
uiCode
 <
maxLog2CtbSize
-3);

733 
I¡
 
möCbLog2SizeY
 = 
uiCode
 + 3;

734 
pcSPS
->
	`£tLog2MöCodögBlockSize
(
möCbLog2SizeY
);

738 c⁄° 
UI¡
 
möLog2DiffMaxMöLumaCodögBlockSize
 = 
möLog2CtbSize
 < 
möCbLog2SizeY
 ? 0 : minLog2CtbSize - minCbLog2SizeY;

739 c⁄° 
UI¡
 
maxLog2DiffMaxMöLumaCodögBlockSize
 = 
maxLog2CtbSize
 - 
möCbLog2SizeY
;

741 
	`READ_UVLC_CHK
–
uiCode
, "log2_diff_max_mö_luma_codög_block_size", 
möLog2DiffMaxMöLumaCodögBlockSize
, 
maxLog2DiffMaxMöLumaCodögBlockSize
);

742 
	`as£π
(
uiCode
 >
möLog2DiffMaxMöLumaCodögBlockSize
 && uiCodê<
maxLog2DiffMaxMöLumaCodögBlockSize
);

743 
pcSPS
->
	`£tLog2DiffMaxMöCodögBlockSize
(
uiCode
);

745 c⁄° 
I¡
 
maxCUDïthDñè
 = 
uiCode
;

746 c⁄° 
I¡
 
˘bLog2SizeY
 = 
möCbLog2SizeY
 + 
maxCUDïthDñè
;

747 
pcSPS
->
	`£tMaxCUWidth
 ( 1<<
˘bLog2SizeY
 );

748 
pcSPS
->
	`£tMaxCUHeight
 ( 1<<
˘bLog2SizeY
 );

749 
	`READ_UVLC_CHK
–
uiCode
, "log2_mö_luma_å™sf‹m_block_size_möus2", 0, 
möCbLog2SizeY
-1-2 );

750 c⁄° 
UI¡
 
möTbLog2SizeY
 = 
uiCode
 + 2;

751 
pcSPS
->
	`£tQuadåìTULog2MöSize
–
möTbLog2SizeY
 );

754 
	`READ_UVLC_CHK
–
uiCode
, "log2_diff_max_mö_luma_å™sf‹m_block_size", 0, 
mö
<
UI¡
>(5U, 
˘bLog2SizeY
Ë- 
möTbLog2SizeY
 );

755 
pcSPS
->
	`£tQuadåìTULog2MaxSize
–
uiCode
 +ÖcSPS->
	`gëQuadåìTULog2MöSize
() );

756 
pcSPS
->
	`£tMaxTrSize
–1<<(
uiCode
 +ÖcSPS->
	`gëQuadåìTULog2MöSize
()) );

758 
	`READ_UVLC_CHK
–
uiCode
, "max_å™sf‹m_hõørchy_dïth_öãr", 0, 
˘bLog2SizeY
 - 
möTbLog2SizeY
); 
pcSPS
->
	`£tQuadåìTUMaxDïthI¡î
( uiCode+1 );

759 
	`READ_UVLC_CHK
–
uiCode
, "max_å™sf‹m_hõørchy_dïth_öåa", 0, 
˘bLog2SizeY
 - 
möTbLog2SizeY
); 
pcSPS
->
	`£tQuadåìTUMaxDïthI¡ø
( uiCode+1 );

761 
I¡
 
addCuDïth
 = 
	`max
 (0, 
möCbLog2SizeY
 - (I¡)
pcSPS
->
	`gëQuadåìTULog2MöSize
() );

762 
pcSPS
->
	`£tMaxTŸÆCUDïth
–
maxCUDïthDñè
 + 
addCuDïth
 + 
	`gëMaxCUDïthOff£t
’cSPS->
	`gëChromaF‹m©Idc
(),ÖcSPS->
	`gëQuadåìTULog2MöSize
()) );

764 
	`READ_FLAG
–
uiCode
, "sˇlög_li°_íabÀd_Êag" ); 
pcSPS
->
	`£tSˇlögLi°Fœg
 ( uiCode );

765 if(
pcSPS
->
	`gëSˇlögLi°Fœg
())

767 
	`READ_FLAG
–
uiCode
, "•s_sˇlög_li°_d©a_¥e£¡_Êag" ); 
pcSPS
->
	`£tSˇlögLi°Pª£¡Fœg
 ( uiCode );

768 if(
pcSPS
->
	`gëSˇlögLi°Pª£¡Fœg
 ())

770 
	`∑r£SˇlögLi°
–&(
pcSPS
->
	`gëSˇlögLi°
()) );

773 
	`READ_FLAG
–
uiCode
, "amp_íabÀd_Êag" ); 
pcSPS
->
	`£tU£AMP
( uiCode );

774 
	`READ_FLAG
–
uiCode
, "ßm∂e_ad≠tive_off£t_íabÀd_Êag" ); 
pcSPS
->
	`£tU£SAO
 ( uiCodê? 
åue
 : 
Ál£
 );

776 
	`READ_FLAG
–
uiCode
, "pcm_íabÀd_Êag" ); 
pcSPS
->
	`£tU£PCM
–uiCodê? 
åue
 : 
Ál£
 );

777 if–
pcSPS
->
	`gëU£PCM
() )

779 #i‡
O0043_BEST_EFFORT_DECODING


780 
	`READ_CODE_CHK
–4, 
uiCode
, "pcm_ßm∂e_bô_dïth_luma_möus1", 0, 
pcSPS
->
	`gëSåómBôDïth
(
CHANNEL_TYPE_LUMA
Ë);ÖcSPS->
	`£tPCMBôDïth
 ( CHANNEL_TYPE_LUMA, 1 + uiCode );

781 
	`READ_CODE_CHK
–4, 
uiCode
, "pcm_ßm∂e_bô_dïth_chroma_möus1", 0, 
pcSPS
->
	`gëSåómBôDïth
(
CHANNEL_TYPE_LUMA
Ë);ÖcSPS->
	`£tPCMBôDïth
 ( 
CHANNEL_TYPE_CHROMA
, 1 + uiCode );

783 
	`READ_CODE_CHK
–4, 
uiCode
, "pcm_ßm∂e_bô_dïth_luma_möus1", 0, 
pcSPS
->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
Ë);ÖcSPS->
	`£tPCMBôDïth
 ( CHANNEL_TYPE_LUMA, 1 + uiCode );

784 
	`READ_CODE_CHK
–4, 
uiCode
, "pcm_ßm∂e_bô_dïth_chroma_möus1", 0, 
pcSPS
->
	`gëBôDïth
(
CHANNEL_TYPE_CHROMA
Ë);ÖcSPS->
	`£tPCMBôDïth
 ( CHANNEL_TYPE_CHROMA, 1 + uiCode );

786 
	`READ_UVLC_CHK
–
uiCode
, "log2_mö_pcm_luma_codög_block_size_möus3", 
°d
::
mö
<
UI¡
>(
möCbLog2SizeY
, 5 )-3, std::mö<UI¡>(
˘bLog2SizeY
, 5)-3);

787 c⁄° 
UI¡
 
log2MöIpcmCbSizeY
 = 
uiCode
+3;

788 
pcSPS
->
	`£tPCMLog2MöSize
 (
log2MöIpcmCbSizeY
);

789 
	`READ_UVLC_CHK
–
uiCode
, "log2_diff_max_mö_pcm_luma_codög_block_size", 0, (
°d
::
mö
<
UI¡
>(
˘bLog2SizeY
,5Ë- 
log2MöIpcmCbSizeY
) );

790 
pcSPS
->
	`£tPCMLog2MaxSize
 ( 
uiCode
+pcSPS->
	`gëPCMLog2MöSize
() );

791 
	`READ_FLAG
–
uiCode
, "pcm_lo›_fûãr_dißbÀ_Êag" ); 
pcSPS
->
	`£tPCMFûãrDißbÀFœg
 ( uiCodê? 
åue
 : 
Ál£
 );

794 
	`READ_UVLC_CHK
–
uiCode
, "num_short_term_ref_pic_sets", 0, 64 );

795 
	`as£π
(
uiCode
 <= 64);

796 
pcSPS
->
	`¸óãRPSLi°
(
uiCode
);

798 
TComRPSLi°
* 
ΩsLi°
 = 
pcSPS
->
	`gëRPSLi°
();

799 
TComRe„ªn˚Pi˘uªSë
* 
Ωs
;

801 
UI¡
 
i
=0; i< 
ΩsLi°
->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
(); i++)

803 
Ωs
 = 
ΩsLi°
->
	`gëRe„ªn˚Pi˘uªSë
(
i
);

804 
	`∑r£Sh‹tTîmRefPicSë
(
pcSPS
,
Ωs
,
i
);

806 
	`READ_FLAG
–
uiCode
, "l⁄g_ãrm_ªf_pics_¥e£¡_Êag" ); 
pcSPS
->
	`£tL⁄gTîmRefsPª£¡
(uiCode);

807 i‡(
pcSPS
->
	`gëL⁄gTîmRefsPª£¡
())

809 
	`READ_UVLC_CHK
–
uiCode
, "num_long_term_ref_pics_sps", 0, 32 );

810 
pcSPS
->
	`£tNumL⁄gTîmRefPicSPS
(
uiCode
);

811 
UI¡
 
k
 = 0; k < 
pcSPS
->
	`gëNumL⁄gTîmRefPicSPS
(); k++)

813 
	`READ_CODE
–
pcSPS
->
	`gëBôsF‹POC
(), 
uiCode
, "lt_ref_pic_poc_lsb_sps" );

814 
pcSPS
->
	`£tLtRefPicPocLsbSps
(
k
, 
uiCode
);

815 
	`READ_FLAG
–
uiCode
, "used_by_curr_pic_lt_sps_flag[i]");

816 
pcSPS
->
	`£tU£dByCuºPicLtSPSFœg
(
k
, 
uiCode
?1:0);

819 
	`READ_FLAG
–
uiCode
, "•s_ãmp‹Æ_mvp_íabÀd_Êag" ); 
pcSPS
->
	`£tSPSTemp‹ÆMVPE«bÀdFœg
(uiCode);

821 
	`READ_FLAG
–
uiCode
, "°r⁄g_öåa_smoŸhög_íabÀ_Êag" ); 
pcSPS
->
	`£tU£Så⁄gI¡øSmoŸhög
(uiCode);

823 
	`READ_FLAG
–
uiCode
, "vui_∑ømëîs_¥e£¡_Êag" ); 
pcSPS
->
	`£tVuiP¨amëîsPª£¡Fœg
(uiCode);

825 i‡(
pcSPS
->
	`gëVuiP¨amëîsPª£¡Fœg
())

827 
	`∑r£VUI
(
pcSPS
->
	`gëVuiP¨amëîs
(),ÖcSPS);

830 
	`READ_FLAG
–
uiCode
, "sps_extension_present_flag");

831 i‡(
uiCode
)

833 #i‡
ENC_DEC_TRACE
 || 
RExt__DECODER_DEBUG_BIT_STATISTICS


834 c⁄° 
TCh¨
 *
sy¡axSåögs
[]={ "sps_range_extension_flag",

843 
Boﬁ
 
•s_exãnsi⁄_Êags
[
NUM_SPS_EXTENSION_FLAGS
];

845 
I¡
 
i
=0; i<
NUM_SPS_EXTENSION_FLAGS
; i++)

847 
	`READ_FLAG
–
uiCode
, 
sy¡axSåögs
[
i
] );

848 
•s_exãnsi⁄_Êags
[
i
] = 
uiCode
!=0;

851 
Boﬁ
 
bSkùTøûögExãnsi⁄Bôs
=
Ál£
;

852 
I¡
 
i
=0; i<
NUM_SPS_EXTENSION_FLAGS
; i++)

854 i‡(
•s_exãnsi⁄_Êags
[
i
])

856 
	`SPSExãnsi⁄FœgIndex
(
i
))

858 
SPS_EXT__REXT
:

859 
	`as£π
(!
bSkùTøûögExãnsi⁄Bôs
);

861 
TComSPSRExt
 &
•sR™geExãnsi⁄
 = 
pcSPS
->
	`gëSpsR™geExãnsi⁄
();

862 
	`READ_FLAG
–
uiCode
, "å™sf‹m_skù_rŸ©i⁄_íabÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tTønsf‹mSkùRŸ©i⁄E«bÀdFœg
(uiCode != 0);

863 
	`READ_FLAG
–
uiCode
, "å™sf‹m_skù_c⁄ãxt_íabÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tTønsf‹mSkùC⁄ãxtE«bÀdFœg
 (uiCode != 0);

864 
	`READ_FLAG
–
uiCode
, "im∂icô_rdpcm_íabÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_IMPLICIT
, (uiCode != 0));

865 
	`READ_FLAG
–
uiCode
, "ex∂icô_rdpcm_íabÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_EXPLICIT
, (uiCode != 0));

866 
	`READ_FLAG
–
uiCode
, "exãnded_¥ecisi⁄_¥o˚ssög_Êag"); 
•sR™geExãnsi⁄
.
	`£tExãndedPªcisi⁄Pro˚ssögFœg
 (uiCode != 0);

867 
	`READ_FLAG
–
uiCode
, "öåa_smoŸhög_dißbÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tI¡øSmoŸhögDißbÀdFœg
 (uiCode != 0);

868 
	`READ_FLAG
–
uiCode
, "high_¥ecisi⁄_off£ts_íabÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tHighPªcisi⁄Off£tsE«bÀdFœg
 (uiCode != 0);

869 
	`READ_FLAG
–
uiCode
, "≥rsi°ít_ri˚_ad≠èti⁄_íabÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
 (uiCode != 0);

870 
	`READ_FLAG
–
uiCode
, "ˇbac_by∑ss_Æignmít_íabÀd_Êag"); 
•sR™geExãnsi⁄
.
	`£tCabacBy∑ssAlignmítE«bÀdFœg
 (uiCode != 0);

874 
bSkùTøûögExãnsi⁄Bôs
=
åue
;

879 i‡(
bSkùTøûögExãnsi⁄Bôs
)

881  
	`xM‹eRb•D©a
() )

883 
	`READ_FLAG
–
uiCode
, "sps_extension_data_flag");

888 
	`xRódRb•TøûögBôs
();

889 
	}
}

891 
Void
 
	gTDecCavlc
::
	$∑r£VPS
(
TComVPS
* 
pcVPS
)

893 #i‡
ENC_DEC_TRACE


894 #i‡
MCTS_EXTRACTION


895 
	`xTø˚VPSHódîDec
 ();

897 
	`xTø˚VPSHódî
();

900 
UI¡
 
uiCode
;

902 
	`READ_CODE
–4, 
uiCode
, "vps_video_∑ømëî_£t_id" ); 
pcVPS
->
	`£tVPSId
( uiCode );

903 
	`READ_FLAG
–
uiCode
, "vps_ba£_œyî_öã∫Æ_Êag" ); 
	`as£π
(uiCode == 1);

904 
	`READ_FLAG
–
uiCode
, "vps_ba£_œyî_avaûabÀ_Êag" ); 
	`as£π
(uiCode == 1);

905 
	`READ_CODE
–6, 
uiCode
, "vps_max_layers_minus1" );

906 
	`READ_CODE
–3, 
uiCode
, "vps_max_sub_œyîs_möus1" ); 
pcVPS
->
	`£tMaxTLayîs
–uiCodê+ 1 ); 
	`as£π
(uiCode+1 <
MAX_TLAYER
);

907 
	`READ_FLAG
–
uiCode
, "vps_ãmp‹Æ_id_√°ög_Êag" ); 
pcVPS
->
	`£tTemp‹ÆNe°ögFœg
–uiCodê? 
åue
:
Ál£
 );

908 
	`as£π
 (
pcVPS
->
	`gëMaxTLayîs
()>1||pcVPS->
	`gëTemp‹ÆNe°ögFœg
());

909 
	`READ_CODE
–16, 
uiCode
, "vps_ª£rved_0xffff_16bôs" ); 
	`as£π
(uiCode == 0xffff);

910 
	`∑r£PTL
 ( 
pcVPS
->
	`gëPTL
(), 
åue
,ÖcVPS->
	`gëMaxTLayîs
()-1);

911 
UI¡
 
subLayîOrdîögInfoPª£¡Fœg
;

912 
	`READ_FLAG
(
subLayîOrdîögInfoPª£¡Fœg
, "vps_sub_layer_ordering_info_present_flag");

913 
UI¡
 
i
 = 0; i <
pcVPS
->
	`gëMaxTLayîs
()-1; i++)

915 
	`READ_UVLC
–
uiCode
, "vps_max_dec_pic_buf„rög_möus1[i]" ); 
pcVPS
->
	`£tMaxDecPicBuf„rög
–uiCodê+ 1, 
i
 );

916 
	`READ_UVLC
–
uiCode
, "vps_max_num_ª‹dî_pics[i]" ); 
pcVPS
->
	`£tNumRe‹dîPics
–uiCode, 
i
 );

917 
	`READ_UVLC
–
uiCode
, "vps_max_œãncy_ö¸ó£_∂us1[i]" ); 
pcVPS
->
	`£tMaxL©ícyIn¸ó£
–uiCode, 
i
 );

919 i‡(!
subLayîOrdîögInfoPª£¡Fœg
)

921 
i
++; i <
pcVPS
->
	`gëMaxTLayîs
()-1; i++)

923 
pcVPS
->
	`£tMaxDecPicBuf„rög
’cVPS->
	`gëMaxDecPicBuf„rög
(0), 
i
);

924 
pcVPS
->
	`£tNumRe‹dîPics
’cVPS->
	`gëNumRe‹dîPics
(0), 
i
);

925 
pcVPS
->
	`£tMaxL©ícyIn¸ó£
’cVPS->
	`gëMaxL©ícyIn¸ó£
(0), 
i
);

931 
	`as£π
–
pcVPS
->
	`gëNumHrdP¨amëîs
(Ë< 
MAX_VPS_OP_SETS_PLUS1
 );

932 
	`as£π
–
pcVPS
->
	`gëMaxNuhRe£rvedZîoLayîId
(Ë< 
MAX_VPS_NUH_RESERVED_ZERO_LAYER_ID_PLUS1
 );

933 
	`READ_CODE
–6, 
uiCode
, "vps_max_œyî_id" ); 
pcVPS
->
	`£tMaxNuhRe£rvedZîoLayîId
( uiCode );

934 
	`READ_UVLC
–
uiCode
, "vps_num_œyî_£ts_möus1" ); 
pcVPS
->
	`£tMaxOpSës
( uiCode + 1 );

935  
UI¡
 
›sIdx
 = 1; opsIdx <–
pcVPS
->
	`gëMaxOpSës
() - 1 ); opsIdx ++ )

938  
UI¡
 
i
 = 0; i <
pcVPS
->
	`gëMaxNuhRe£rvedZîoLayîId
(); i ++ )

940 
	`READ_FLAG
–
uiCode
, "œyî_id_ö˛uded_Êag[›sIdx][i]" ); 
pcVPS
->
	`£tLayîIdIn˛udedFœg
–uiCodê=1 ? 
åue
 : 
Ál£
, 
›sIdx
, 
i
 );

944 
TimögInfo
 *
timögInfo
 = 
pcVPS
->
	`gëTimögInfo
();

945 
	`READ_FLAG
–
uiCode
, "vps_timög_öfo_¥e£¡_Êag"); 
timögInfo
->
	`£tTimögInfoPª£¡Fœg
 (uiCodê? 
åue
 : 
Ál£
);

946 if(
timögInfo
->
	`gëTimögInfoPª£¡Fœg
())

948 
	`READ_CODE
–32, 
uiCode
, "vps_num_unôs_ö_tick"); 
timögInfo
->
	`£tNumUnôsInTick
 (uiCode);

949 
	`READ_CODE
–32, 
uiCode
, "vps_time_sˇÀ"); 
timögInfo
->
	`£tTimeSˇÀ
 (uiCode);

950 
	`READ_FLAG
–
uiCode
, "vps_poc_¥›‹ti⁄Æ_to_timög_Êag"); 
timögInfo
->
	`£tPocPr›‹ti⁄ÆToTimögFœg
(uiCodê? 
åue
 : 
Ál£
);

951 if(
timögInfo
->
	`gëPocPr›‹ti⁄ÆToTimögFœg
())

953 
	`READ_UVLC
–
uiCode
, "vps_num_ticks_poc_diff_⁄e_möus1"); 
timögInfo
->
	`£tNumTicksPocDiffO√Möus1
 (uiCode);

956 
	`READ_UVLC
–
uiCode
, "vps_num_hrd_∑ømëîs" ); 
pcVPS
->
	`£tNumHrdP¨amëîs
( uiCode );

958 if–
pcVPS
->
	`gëNumHrdP¨amëîs
() > 0 )

960 
pcVPS
->
	`¸óãHrdP¨amBuf„r
();

962  
UI¡
 
i
 = 0; i < 
pcVPS
->
	`gëNumHrdP¨amëîs
(); i ++ )

964 
	`READ_UVLC
–
uiCode
, "hrd_œyî_£t_idx[i]" ); 
pcVPS
->
	`£tHrdOpSëIdx
–uiCode, 
i
 );

965 if–
i
 > 0 )

967 
	`READ_FLAG
–
uiCode
, "˝rms_¥e£¡_Êag[i]" ); 
pcVPS
->
	`£tC¥msPª£¡Fœg
–uiCodê=1 ? 
åue
 : 
Ál£
, 
i
 );

971 
pcVPS
->
	`£tC¥msPª£¡Fœg
–
åue
, 
i
 );

974 
	`∑r£HrdP¨amëîs
(
pcVPS
->
	`gëHrdP¨amëîs
(
i
),ÖcVPS->
	`gëC¥msPª£¡Fœg
–ò),ÖcVPS->
	`gëMaxTLayîs
() - 1);

978 
	`READ_FLAG
–
uiCode
, "vps_extension_flag" );

979 i‡(
uiCode
)

981  
	`xM‹eRb•D©a
() )

983 
	`READ_FLAG
–
uiCode
, "vps_extension_data_flag");

987 
	`xRódRb•TøûögBôs
();

988 
	}
}

990 
Void
 
	gTDecCavlc
::
	$∑r£Sli˚Hódî
 (
TComSli˚
* 
pcSli˚
, 
P¨amëîSëM™agî
 *
∑ømëîSëM™agî
, c⁄° 
I¡
 
¥evTid0POC
)

992 
UI¡
 
uiCode
;

993 
I¡
 
iCode
;

995 #i‡
ENC_DEC_TRACE


996 #i‡
MCTS_EXTRACTION


997 
	`xTø˚Sli˚HódîDec
();

999 
	`xTø˚Sli˚Hódî
();

1002 
TComPPS
* 
µs
 = 
NULL
;

1003 
TComSPS
* 
•s
 = 
NULL
;

1005 
UI¡
 
fú°Sli˚SegmítInPic
;

1006 
	`READ_FLAG
–
fú°Sli˚SegmítInPic
, "first_slice_segment_in_pic_flag" );

1007 if–
pcSli˚
->
	`gëR≠PicFœg
())

1009 
	`READ_FLAG
–
uiCode
, "no_output_of_prior_pics_flag" );

1010 
pcSli˚
->
	`£tNoOuçutPri‹PicsFœg
(
uiCode
 ? 
åue
 : 
Ál£
);

1012 
	`READ_UVLC
 ( 
uiCode
, "¶i˚_pic_∑ømëî_£t_id" ); 
pcSli˚
->
	`£tPPSId
(uiCode);

1013 
µs
 = 
∑ømëîSëM™agî
->
	`gëPPS
(
uiCode
);

1015 
	`as£π
(
µs
!=0);

1016 
•s
 = 
∑ømëîSëM™agî
->
	`gëSPS
(
µs
->
	`gëSPSId
());

1018 
	`as£π
(
•s
!=0);

1020 c⁄° 
ChromaF‹m©
 
chFmt
 = 
•s
->
	`gëChromaF‹m©Idc
();

1021 c⁄° 
UI¡
 
numVÆidComp
=
	`gëNumbîVÆidComp⁄íts
(
chFmt
);

1022 c⁄° 
Boﬁ
 
bChroma
=(
chFmt
!=
CHROMA_400
);

1024 if–
µs
->
	`gëDïídítSli˚SegmítsE«bÀdFœg
(Ë&& ( !
fú°Sli˚SegmítInPic
 ))

1026 
	`READ_FLAG
–
uiCode
, "dïídít_¶i˚_£gmít_Êag" ); 
pcSli˚
->
	`£tDïídítSli˚SegmítFœg
(uiCodê? 
åue
 : 
Ál£
);

1030 
pcSli˚
->
	`£tDïídítSli˚SegmítFœg
(
Ál£
);

1032 
I¡
 
numCTUs
 = ((
•s
->
	`gëPicWidthInLumaSam∂es
()+•s->
	`gëMaxCUWidth
()-1)/•s->gëMaxCUWidth())*((•s->
	`gëPicHeightInLumaSam∂es
()+•s->
	`gëMaxCUHeight
()-1)/sps->getMaxCUHeight());

1033 
UI¡
 
¶i˚SegmítAddªss
 = 0;

1034 
I¡
 
bôsSli˚SegmítAddªss
 = 0;

1035 
numCTUs
>(1<<
bôsSli˚SegmítAddªss
))

1037 
bôsSli˚SegmítAddªss
++;

1040 if(!
fú°Sli˚SegmítInPic
)

1042 
	`READ_CODE
–
bôsSli˚SegmítAddªss
, 
¶i˚SegmítAddªss
, "slice_segment_address" );

1045 
pcSli˚
->
	`£tSli˚SegmítCurSèπCtuTsAddr
–
¶i˚SegmítAddªss
 );

1046 
pcSli˚
->
	`£tSli˚SegmítCurEndCtuTsAddr
(
numCTUs
);

1048 i‡(!
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
())

1050 
pcSli˚
->
	`£tSli˚CurSèπCtuTsAddr
(
¶i˚SegmítAddªss
);

1051 
pcSli˚
->
	`£tSli˚CurEndCtuTsAddr
(
numCTUs
);

1054 if(!
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
())

1056 
I¡
 
i
 = 0; i < 
µs
->
	`gëNumExåaSli˚HódîBôs
(); i++)

1058 
	`READ_FLAG
(
uiCode
, "slice_reserved_flag[]");

1061 
	`READ_UVLC
 ( 
uiCode
, "¶i˚_ty≥" ); 
pcSli˚
->
	`£tSli˚Ty≥
((
Sli˚Ty≥
)uiCode);

1062 if–
µs
->
	`gëOuçutFœgPª£¡Fœg
() )

1064 
	`READ_FLAG
–
uiCode
, "pic_ouçut_Êag" ); 
pcSli˚
->
	`£tPicOuçutFœg
–uiCodê? 
åue
 : 
Ál£
 );

1068 
pcSli˚
->
	`£tPicOuçutFœg
–
åue
 );

1075 if–
pcSli˚
->
	`gëIdrPicFœg
() )

1077 
pcSli˚
->
	`£tPOC
(0);

1078 
TComRe„ªn˚Pi˘uªSë
* 
Ωs
 = 
pcSli˚
->
	`gëLoˇlRPS
();

1079 (*
Ωs
)=
	`TComRe„ªn˚Pi˘uªSë
();

1080 
pcSli˚
->
	`£tRPS
(
Ωs
);

1084 
	`READ_CODE
(
•s
->
	`gëBôsF‹POC
(), 
uiCode
, "slice_pic_order_cnt_lsb");

1085 
I¡
 
iPOClsb
 = 
uiCode
;

1086 
I¡
 
iPªvPOC
 = 
¥evTid0POC
;

1087 
I¡
 
iMaxPOClsb
 = 1<< 
•s
->
	`gëBôsF‹POC
();

1088 
I¡
 
iPªvPOClsb
 = 
iPªvPOC
 & (
iMaxPOClsb
 - 1);

1089 
I¡
 
iPªvPOCmsb
 = 
iPªvPOC
-
iPªvPOClsb
;

1090 
I¡
 
iPOCmsb
;

1091 if––
iPOClsb
 < 
iPªvPOClsb
 ) && ( ( iPªvPOClsb - iPOClsb ) >–
iMaxPOClsb
 / 2 ) ) )

1093 
iPOCmsb
 = 
iPªvPOCmsb
 + 
iMaxPOClsb
;

1095 if–(
iPOClsb
 > 
iPªvPOClsb
 ) && ( (iPOClsb - iPªvPOClsb ) > ( 
iMaxPOClsb
 / 2 ) ) )

1097 
iPOCmsb
 = 
iPªvPOCmsb
 - 
iMaxPOClsb
;

1101 
iPOCmsb
 = 
iPªvPOCmsb
;

1103 i‡–
pcSli˚
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


1104 || 
pcSli˚
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


1105 || 
pcSli˚
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP
 )

1108 
iPOCmsb
 = 0;

1110 
pcSli˚
->
	`£tPOC
 (
iPOCmsb
+
iPOClsb
);

1112 
TComRe„ªn˚Pi˘uªSë
* 
Ωs
;

1113 
Ωs
 = 
pcSli˚
->
	`gëLoˇlRPS
();

1114 (*
Ωs
)=
	`TComRe„ªn˚Pi˘uªSë
();

1116 
pcSli˚
->
	`£tRPS
(
Ωs
);

1117 
	`READ_FLAG
–
uiCode
, "short_term_ref_pic_set_sps_flag" );

1118 if(
uiCode
 == 0)

1120 
	`∑r£Sh‹tTîmRefPicSë
(
•s
,
Ωs
, sps->
	`gëRPSLi°
()->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
());

1121 #i‡
MCTS_EXTRACTION


1122 
pcSli˚
->
	`£tRPSidx
(-1);

1127 
I¡
 
numBôs
 = 0;

1128 (1 << 
numBôs
Ë< 
•s
->
	`gëRPSLi°
()->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
())

1130 
numBôs
++;

1132 i‡(
numBôs
 > 0)

1134 
	`READ_CODE
–
numBôs
, 
uiCode
, "short_term_ref_pic_set_idx");

1135 #i‡
MCTS_EXTRACTION


1136 
pcSli˚
->
	`£tRPSidx
(
uiCode
);

1141 
uiCode
 = 0;

1144 *
Ωs
 = *(
•s
->
	`gëRPSLi°
()->
	`gëRe„ªn˚Pi˘uªSë
(
uiCode
));

1146 if(
•s
->
	`gëL⁄gTîmRefsPª£¡
())

1148 
I¡
 
off£t
 = 
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
()+Ωs->
	`gëNumbîOfPosôivePi˘uªs
();

1149 
UI¡
 
numOfLåp
 = 0;

1150 
UI¡
 
numLåpInSPS
 = 0;

1151 i‡(
•s
->
	`gëNumL⁄gTîmRefPicSPS
() > 0)

1153 
	`READ_UVLC
–
uiCode
, "num_long_term_sps");

1154 
numLåpInSPS
 = 
uiCode
;

1155 
numOfLåp
 +
numLåpInSPS
;

1156 
Ωs
->
	`£tNumbîOfL⁄gãrmPi˘uªs
(
numOfLåp
);

1158 
I¡
 
bôsF‹LåpInSPS
 = 0;

1159 
•s
->
	`gëNumL⁄gTîmRefPicSPS
(Ë> (1 << 
bôsF‹LåpInSPS
))

1161 
bôsF‹LåpInSPS
++;

1163 
	`READ_UVLC
–
uiCode
, "num_l⁄g_ãrm_pics"); 
Ωs
->
	`£tNumbîOfL⁄gãrmPi˘uªs
(uiCode);

1164 
numOfLåp
 +
uiCode
;

1165 
Ωs
->
	`£tNumbîOfL⁄gãrmPi˘uªs
(
numOfLåp
);

1166 
I¡
 
maxPicOrdîC¡LSB
 = 1 << 
•s
->
	`gëBôsF‹POC
();

1167 
I¡
 
¥evDñèMSB
 = 0, 
dñèPocMSBCy˛eLT
 = 0;

1168 
I¡
 
j
=
off£t
+
Ωs
->
	`gëNumbîOfL⁄gãrmPi˘uªs
()-1, 
k
 = 0; k < 
numOfLåp
; j--, k++)

1170 
I¡
 
pocLsbLt
;

1171 i‡(
k
 < 
numLåpInSPS
)

1173 
uiCode
 = 0;

1174 i‡(
bôsF‹LåpInSPS
 > 0)

1176 
	`READ_CODE
(
bôsF‹LåpInSPS
, 
uiCode
, "lt_idx_sps[i]");

1178 
Boﬁ
 
u£dByCuºFromSPS
=
•s
->
	`gëU£dByCuºPicLtSPSFœg
(
uiCode
);

1180 
pocLsbLt
 = 
•s
->
	`gëLtRefPicPocLsbSps
(
uiCode
);

1181 
Ωs
->
	`£tU£d
(
j
,
u£dByCuºFromSPS
);

1185 
	`READ_CODE
(
•s
->
	`gëBôsF‹POC
(), 
uiCode
, "poc_lsb_…"); 
pocLsbLt
= uiCode;

1186 
	`READ_FLAG
–
uiCode
, "u£d_by_cuº_pic_…_Êag"); 
Ωs
->
	`£tU£d
(
j
,uiCode);

1188 
	`READ_FLAG
(
uiCode
,"delta_poc_msb_present_flag");

1189 
Boﬁ
 
mSBPª£¡Fœg
 = 
uiCode
 ? 
åue
 : 
Ál£
;

1190 if(
mSBPª£¡Fœg
)

1192 
	`READ_UVLC
–
uiCode
, "delta_poc_msb_cycle_lt[i]" );

1193 
Boﬁ
 
dñèFœg
 = 
Ál£
;

1195 if–(
j
 =
off£t
+
Ωs
->
	`gëNumbîOfL⁄gãrmPi˘uªs
()-1Ë|| (j =off£t+(
numOfLåp
-
numLåpInSPS
)-1) )

1197 
dñèFœg
 = 
åue
;

1199 if(
dñèFœg
)

1201 
dñèPocMSBCy˛eLT
 = 
uiCode
;

1205 
dñèPocMSBCy˛eLT
 = 
uiCode
 + 
¥evDñèMSB
;

1208 
I¡
 
pocLTCuº
 = 
pcSli˚
->
	`gëPOC
(Ë- 
dñèPocMSBCy˛eLT
 * 
maxPicOrdîC¡LSB


1209 - 
iPOClsb
 + 
pocLsbLt
;

1210 
Ωs
->
	`£tPOC
 (
j
, 
pocLTCuº
);

1211 
Ωs
->
	`£tDñèPOC
(
j
, - 
pcSli˚
->
	`gëPOC
(Ë+ 
pocLTCuº
);

1212 
Ωs
->
	`£tCheckLTMSBPª£¡
(
j
,
åue
);

1216 
Ωs
->
	`£tPOC
 (
j
, 
pocLsbLt
);

1217 
Ωs
->
	`£tDñèPOC
(
j
, - 
pcSli˚
->
	`gëPOC
(Ë+ 
pocLsbLt
);

1218 
Ωs
->
	`£tCheckLTMSBPª£¡
(
j
,
Ál£
);

1221 if–
j
 =
off£t
+(
numOfLåp
-
numLåpInSPS
)-1 )

1223 
dñèPocMSBCy˛eLT
 = 0;

1226 
¥evDñèMSB
 = 
dñèPocMSBCy˛eLT
;

1228 
off£t
 +
Ωs
->
	`gëNumbîOfL⁄gãrmPi˘uªs
();

1229 
Ωs
->
	`£tNumbîOfPi˘uªs
(
off£t
);

1231 i‡–
pcSli˚
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


1232 || 
pcSli˚
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


1233 || 
pcSli˚
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP
 )

1236 
Ωs
 = 
pcSli˚
->
	`gëLoˇlRPS
();

1237 (*
Ωs
)=
	`TComRe„ªn˚Pi˘uªSë
();

1238 
pcSli˚
->
	`£tRPS
(
Ωs
);

1240 i‡(
•s
->
	`gëSPSTemp‹ÆMVPE«bÀdFœg
())

1242 
	`READ_FLAG
–
uiCode
, "slice_temporal_mvp_enabled_flag" );

1243 
pcSli˚
->
	`£tE«bÀTMVPFœg
–
uiCode
 =1 ? 
åue
 : 
Ál£
 );

1247 
pcSli˚
->
	`£tE«bÀTMVPFœg
(
Ál£
);

1250 if(
•s
->
	`gëU£SAO
())

1252 
	`READ_FLAG
(
uiCode
, "¶i˚_ßo_luma_Êag"); 
pcSli˚
->
	`£tSaoE«bÀdFœg
(
CHANNEL_TYPE_LUMA
, (
Boﬁ
)uiCode);

1254 i‡(
bChroma
)

1256 
	`READ_FLAG
(
uiCode
, "¶i˚_ßo_chroma_Êag"); 
pcSli˚
->
	`£tSaoE«bÀdFœg
(
CHANNEL_TYPE_CHROMA
, (
Boﬁ
)uiCode);

1260 i‡(
pcSli˚
->
	`gëIdrPicFœg
())

1262 
pcSli˚
->
	`£tE«bÀTMVPFœg
(
Ál£
);

1264 i‡(!
pcSli˚
->
	`isI¡ø
())

1267 
	`READ_FLAG
–
uiCode
, "num_ref_idx_active_override_flag");

1268 i‡(
uiCode
)

1270 
	`READ_UVLC
 (
uiCode
, "num_ªf_idx_l0_a˘ive_möus1" ); 
pcSli˚
->
	`£tNumRefIdx
–
REF_PIC_LIST_0
, uiCode + 1 );

1271 i‡(
pcSli˚
->
	`isI¡îB
())

1273 
	`READ_UVLC
 (
uiCode
, "num_ªf_idx_l1_a˘ive_möus1" ); 
pcSli˚
->
	`£tNumRefIdx
–
REF_PIC_LIST_1
, uiCode + 1 );

1277 
pcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_1
, 0);

1282 
pcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_0
, 
µs
->
	`gëNumRefIdxL0DeÁu…A˘ive
());

1283 i‡(
pcSli˚
->
	`isI¡îB
())

1285 
pcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_1
, 
µs
->
	`gëNumRefIdxL1DeÁu…A˘ive
());

1289 
pcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_1
,0);

1294 
TComRefPicLi°Modifiˇti⁄
* 
ªfPicLi°Modifiˇti⁄
 = 
pcSli˚
->
	`gëRefPicLi°Modifiˇti⁄
();

1295 if(!
pcSli˚
->
	`isI¡ø
())

1297 if–!
µs
->
	`gëLi°sModifiˇti⁄Pª£¡Fœg
(Ë|| 
pcSli˚
->
	`gëNumRpsCuºTempLi°
() <= 1 )

1299 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicLi°Modifiˇti⁄FœgL0
( 0 );

1303 
	`READ_FLAG
–
uiCode
, "ªf_pic_li°_modifiˇti⁄_Êag_l0" ); 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicLi°Modifiˇti⁄FœgL0
( uiCode ? 1 : 0 );

1306 if(
ªfPicLi°Modifiˇti⁄
->
	`gëRefPicLi°Modifiˇti⁄FœgL0
())

1308 
uiCode
 = 0;

1309 
I¡
 
i
 = 0;

1310 
I¡
 
numRpsCuºTempLi°0
 = 
pcSli˚
->
	`gëNumRpsCuºTempLi°
();

1311 i‡–
numRpsCuºTempLi°0
 > 1 )

1313 
I¡
 
Àngth
 = 1;

1314 
numRpsCuºTempLi°0
 --;

1315  
numRpsCuºTempLi°0
 >>= 1)

1317 
Àngth
 ++;

1319 
i
 = 0; i < 
pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_0
); i ++)

1321 
	`READ_CODE
–
Àngth
, 
uiCode
, "list_entry_l0" );

1322 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicSëIdxL0
(
i
, 
uiCode
 );

1327 
i
 = 0; i < 
pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_0
); i ++)

1329 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicSëIdxL0
(
i
, 0 );

1336 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicLi°Modifiˇti⁄FœgL0
(0);

1338 if(
pcSli˚
->
	`isI¡îB
())

1340 if–!
µs
->
	`gëLi°sModifiˇti⁄Pª£¡Fœg
(Ë|| 
pcSli˚
->
	`gëNumRpsCuºTempLi°
() <= 1 )

1342 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicLi°Modifiˇti⁄FœgL1
( 0 );

1346 
	`READ_FLAG
–
uiCode
, "ªf_pic_li°_modifiˇti⁄_Êag_l1" ); 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicLi°Modifiˇti⁄FœgL1
( uiCode ? 1 : 0 );

1348 if(
ªfPicLi°Modifiˇti⁄
->
	`gëRefPicLi°Modifiˇti⁄FœgL1
())

1350 
uiCode
 = 0;

1351 
I¡
 
i
 = 0;

1352 
I¡
 
numRpsCuºTempLi°1
 = 
pcSli˚
->
	`gëNumRpsCuºTempLi°
();

1353 i‡–
numRpsCuºTempLi°1
 > 1 )

1355 
I¡
 
Àngth
 = 1;

1356 
numRpsCuºTempLi°1
 --;

1357  
numRpsCuºTempLi°1
 >>= 1)

1359 
Àngth
 ++;

1361 
i
 = 0; i < 
pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_1
); i ++)

1363 
	`READ_CODE
–
Àngth
, 
uiCode
, "list_entry_l1" );

1364 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicSëIdxL1
(
i
, 
uiCode
 );

1369 
i
 = 0; i < 
pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_1
); i ++)

1371 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicSëIdxL1
(
i
, 0 );

1378 
ªfPicLi°Modifiˇti⁄
->
	`£tRefPicLi°Modifiˇti⁄FœgL1
(0);

1380 i‡(
pcSli˚
->
	`isI¡îB
())

1382 
	`READ_FLAG
–
uiCode
, "mvd_l1_zîo_Êag" ); 
pcSli˚
->
	`£tMvdL1ZîoFœg
–(uiCodê? 
åue
 : 
Ál£
) );

1385 
pcSli˚
->
	`£tCabacInôFœg
–
Ál£
 );

1386 if(
µs
->
	`gëCabacInôPª£¡Fœg
(Ë&& !
pcSli˚
->
	`isI¡ø
())

1388 
	`READ_FLAG
(
uiCode
, "cabac_init_flag");

1389 
pcSli˚
->
	`£tCabacInôFœg
–
uiCode
 ? 
åue
 : 
Ál£
 );

1392 i‡–
pcSli˚
->
	`gëE«bÀTMVPFœg
() )

1394 i‡–
pcSli˚
->
	`gëSli˚Ty≥
(Ë=
B_SLICE
 )

1396 
	`READ_FLAG
–
uiCode
, "collocated_from_l0_flag" );

1397 
pcSli˚
->
	`£tCﬁFromL0Fœg
(
uiCode
);

1401 
pcSli˚
->
	`£tCﬁFromL0Fœg
( 1 );

1404 i‡–
pcSli˚
->
	`gëSli˚Ty≥
(Ë!
I_SLICE
 &&

1405 ((
pcSli˚
->
	`gëCﬁFromL0Fœg
(Ë=1 &&ÖcSli˚->
	`gëNumRefIdx
(
REF_PIC_LIST_0
) > 1)||

1406 (
pcSli˚
->
	`gëCﬁFromL0Fœg
(Ë=0 &&ÖcSli˚->
	`gëNumRefIdx
(
REF_PIC_LIST_1
) > 1)))

1408 
	`READ_UVLC
–
uiCode
, "collocated_ref_idx" );

1409 
pcSli˚
->
	`£tCﬁRefIdx
(
uiCode
);

1413 
pcSli˚
->
	`£tCﬁRefIdx
(0);

1416 i‡–(
µs
->
	`gëU£WP
(Ë&& 
pcSli˚
->
	`gëSli˚Ty≥
()==
P_SLICE
Ë|| (µs->
	`gëWPBiPªd
(Ë&&ÖcSli˚->gëSli˚Ty≥()==
B_SLICE
) )

1418 
	`xP¨£PªdWeightTabÀ
(
pcSli˚
, 
•s
);

1419 
pcSli˚
->
	`öôWpSˇlög
(
•s
);

1421 i‡(!
pcSli˚
->
	`isI¡ø
())

1423 
	`READ_UVLC
–
uiCode
, "five_minus_max_num_merge_cand");

1424 
pcSli˚
->
	`£tMaxNumMîgeC™d
(
MRG_MAX_NUM_CANDS
 - 
uiCode
);

1427 
	`READ_SVLC
–
iCode
, "slice_qp_delta" );

1428 
pcSli˚
->
	`£tSli˚Qp
 (26 + 
µs
->
	`gëPicInôQPMöus26
(Ë+ 
iCode
);

1430 
	`as£π
–
pcSli˚
->
	`gëSli˚Qp
(Ë>-
•s
->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
) );

1431 
	`as£π
–
pcSli˚
->
	`gëSli˚Qp
() <= 51 );

1433 i‡(
µs
->
	`gëSli˚ChromaQpFœg
())

1435 i‡(
numVÆidComp
>
COMPONENT_Cb
)

1437 
	`READ_SVLC
–
iCode
, "slice_cb_qp_offset" );

1438 
pcSli˚
->
	`£tSli˚ChromaQpDñè
(
COMPONENT_Cb
, 
iCode
 );

1439 
	`as£π
–
pcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cb
) >= -12 );

1440 
	`as£π
–
pcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cb
) <= 12 );

1441 
	`as£π
–(
µs
->
	`gëQpOff£t
(
COMPONENT_Cb
Ë+ 
pcSli˚
->
	`gëSli˚ChromaQpDñè
(COMPONENT_Cb)) >= -12 );

1442 
	`as£π
–(
µs
->
	`gëQpOff£t
(
COMPONENT_Cb
Ë+ 
pcSli˚
->
	`gëSli˚ChromaQpDñè
(COMPONENT_Cb)) <= 12 );

1445 i‡(
numVÆidComp
>
COMPONENT_Cr
)

1447 
	`READ_SVLC
–
iCode
, "slice_cr_qp_offset" );

1448 
pcSli˚
->
	`£tSli˚ChromaQpDñè
(
COMPONENT_Cr
, 
iCode
 );

1449 
	`as£π
–
pcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cr
) >= -12 );

1450 
	`as£π
–
pcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cr
) <= 12 );

1451 
	`as£π
–(
µs
->
	`gëQpOff£t
(
COMPONENT_Cr
Ë+ 
pcSli˚
->
	`gëSli˚ChromaQpDñè
(COMPONENT_Cr)) >= -12 );

1452 
	`as£π
–(
µs
->
	`gëQpOff£t
(
COMPONENT_Cr
Ë+ 
pcSli˚
->
	`gëSli˚ChromaQpDñè
(COMPONENT_Cr)) <= 12 );

1456 i‡(
µs
->
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°E«bÀdFœg
())

1458 
	`READ_FLAG
(
uiCode
, "cu_chroma_qp_off£t_íabÀd_Êag"); 
pcSli˚
->
	`£tU£ChromaQpAdj
(uiCode != 0);

1462 
pcSli˚
->
	`£tU£ChromaQpAdj
(
Ál£
);

1465 i‡(
µs
->
	`gëDeblockögFûãrC⁄åﬁPª£¡Fœg
())

1467 if(
µs
->
	`gëDeblockögFûãrOvîrideE«bÀdFœg
())

1469 
	`READ_FLAG
 ( 
uiCode
, "deblockög_fûãr_ovîride_Êag" ); 
pcSli˚
->
	`£tDeblockögFûãrOvîrideFœg
(uiCodê? 
åue
 : 
Ál£
);

1473 
pcSli˚
->
	`£tDeblockögFûãrOvîrideFœg
(0);

1475 if(
pcSli˚
->
	`gëDeblockögFûãrOvîrideFœg
())

1477 
	`READ_FLAG
 ( 
uiCode
, "¶i˚_deblockög_fûãr_dißbÀd_Êag" ); 
pcSli˚
->
	`£tDeblockögFûãrDißbÀ
(uiCode ? 1 : 0);

1478 if(!
pcSli˚
->
	`gëDeblockögFûãrDißbÀ
())

1480 
	`READ_SVLC
–
iCode
, "¶i˚_bëa_off£t_div2" ); 
pcSli˚
->
	`£tDeblockögFûãrBëaOff£tDiv2
(iCode);

1481 
	`as£π
(
pcSli˚
->
	`gëDeblockögFûãrBëaOff£tDiv2
() >= -6 &&

1482 
pcSli˚
->
	`gëDeblockögFûãrBëaOff£tDiv2
() <= 6);

1483 
	`READ_SVLC
–
iCode
, "¶i˚_tc_off£t_div2" ); 
pcSli˚
->
	`£tDeblockögFûãrTcOff£tDiv2
(iCode);

1484 
	`as£π
(
pcSli˚
->
	`gëDeblockögFûãrTcOff£tDiv2
() >= -6 &&

1485 
pcSli˚
->
	`gëDeblockögFûãrTcOff£tDiv2
() <= 6);

1490 
pcSli˚
->
	`£tDeblockögFûãrDißbÀ
 ( 
µs
->
	`gëPPSDeblockögFûãrDißbÀdFœg
() );

1491 
pcSli˚
->
	`£tDeblockögFûãrBëaOff£tDiv2
–
µs
->
	`gëDeblockögFûãrBëaOff£tDiv2
() );

1492 
pcSli˚
->
	`£tDeblockögFûãrTcOff£tDiv2
 ( 
µs
->
	`gëDeblockögFûãrTcOff£tDiv2
() );

1497 
pcSli˚
->
	`£tDeblockögFûãrDißbÀ
 ( 
Ál£
 );

1498 
pcSli˚
->
	`£tDeblockögFûãrBëaOff£tDiv2
( 0 );

1499 
pcSli˚
->
	`£tDeblockögFûãrTcOff£tDiv2
 ( 0 );

1502 
Boﬁ
 
isSAOE«bÀd
 = 
•s
->
	`gëU£SAO
(Ë&& (
pcSli˚
->
	`gëSaoE«bÀdFœg
(
CHANNEL_TYPE_LUMA
Ë|| (
bChroma
 &&ÖcSli˚->gëSaoE«bÀdFœg(
CHANNEL_TYPE_CHROMA
)));

1503 
Boﬁ
 
isDBFE«bÀd
 = (!
pcSli˚
->
	`gëDeblockögFûãrDißbÀ
());

1505 if(
µs
->
	`gëLo›FûãrA¸ossSli˚sE«bÀdFœg
(Ë&& ( 
isSAOE«bÀd
 || 
isDBFE«bÀd
 ))

1507 
	`READ_FLAG
–
uiCode
, "slice_loop_filter_across_slices_enabled_flag");

1511 
uiCode
 = 
µs
->
	`gëLo›FûãrA¸ossSli˚sE«bÀdFœg
()?1:0;

1513 
pcSli˚
->
	`£tLFCrossSli˚Bound¨yFœg
–(
uiCode
==1)?
åue
:
Ál£
);

1517 
°d
::
ve˘‹
<
UI¡
> 
íåyPoötOff£t
;

1518 if–
µs
->
	`gëTûesE«bÀdFœg
(Ë||Öps->
	`gëE¡r›yCodögSyncE«bÀdFœg
() )

1520 
UI¡
 
numE¡ryPoötOff£ts
;

1521 
UI¡
 
off£tLíMöus1
;

1522 
	`READ_UVLC
(
numE¡ryPoötOff£ts
, "num_entry_point_offsets");

1523 i‡(
numE¡ryPoötOff£ts
>0)

1525 
	`READ_UVLC
(
off£tLíMöus1
, "offset_len_minus1");

1526 
íåyPoötOff£t
.
	`ªsize
(
numE¡ryPoötOff£ts
);

1527 
UI¡
 
idx
=0; idx<
numE¡ryPoötOff£ts
; idx++)

1529 
	`READ_CODE
(
off£tLíMöus1
+1, 
uiCode
, "entry_point_offset_minus1");

1530 
íåyPoötOff£t
[ 
idx
 ] = 
uiCode
 + 1;

1535 if(
µs
->
	`gëSli˚HódîExãnsi⁄Pª£¡Fœg
())

1537 
	`READ_UVLC
(
uiCode
,"slice_segment_header_extension_length");

1538 
I¡
 
i
=0; i<
uiCode
; i++)

1540 
UI¡
 
ign‹ed
;

1541 
	`READ_CODE
(8,
ign‹ed
,"slice_segment_header_extension_data_byte");

1544 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


1545 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
STATS__BYTE_ALIGNMENT_BITS
,
m_pcBô°ªam
->
	`ªadByãAlignmít
(),0);

1547 
m_pcBô°ªam
->
	`ªadByãAlignmít
();

1550 
pcSli˚
->
	`˛órSub°ªamSizes
();

1552 if–
µs
->
	`gëTûesE«bÀdFœg
(Ë||Öps->
	`gëE¡r›yCodögSyncE«bÀdFœg
() )

1554 
I¡
 
ídOfSli˚HódîLoˇti⁄
 = 
m_pcBô°ªam
->
	`gëByãLoˇti⁄
();

1557  
UI¡
 
curByãIdx
 = 0; curByãIdx<
m_pcBô°ªam
->
	`numEmuœti⁄Pªvíti⁄ByãsRód
(); curByteIdx++ )

1559 i‡–
m_pcBô°ªam
->
	`gëEmuœti⁄Pªvíti⁄ByãLoˇti⁄
–
curByãIdx
 ) < 
ídOfSli˚HódîLoˇti⁄
 )

1561 
ídOfSli˚HódîLoˇti⁄
++;

1565 
I¡
 
curE¡ryPoötOff£t
 = 0;

1566 
I¡
 
¥evE¡ryPoötOff£t
 = 0;

1567 
UI¡
 
idx
=0; idx<
íåyPoötOff£t
.
	`size
(); idx++)

1569 
curE¡ryPoötOff£t
 +
íåyPoötOff£t
[ 
idx
 ];

1571 
I¡
 
emuœti⁄Pªvíti⁄ByãCou¡
 = 0;

1572  
UI¡
 
curByãIdx
 = 0; curByãIdx<
m_pcBô°ªam
->
	`numEmuœti⁄Pªvíti⁄ByãsRód
(); curByteIdx++ )

1574 i‡–
m_pcBô°ªam
->
	`gëEmuœti⁄Pªvíti⁄ByãLoˇti⁄
–
curByãIdx
 ) >–
¥evE¡ryPoötOff£t
 + 
ídOfSli˚HódîLoˇti⁄
 ) &&

1575 
m_pcBô°ªam
->
	`gëEmuœti⁄Pªvíti⁄ByãLoˇti⁄
–
curByãIdx
 ) < ( 
curE¡ryPoötOff£t
 + 
ídOfSli˚HódîLoˇti⁄
 ) )

1577 
emuœti⁄Pªvíti⁄ByãCou¡
++;

1581 
íåyPoötOff£t
[ 
idx
 ] -
emuœti⁄Pªvíti⁄ByãCou¡
;

1582 
¥evE¡ryPoötOff£t
 = 
curE¡ryPoötOff£t
;

1583 
pcSli˚
->
	`addSub°ªamSize
(
íåyPoötOff£t
 [ 
idx
 ] );

1588 
	}
}

1590 
Void
 
	gTDecCavlc
::
	$∑r£PTL
–
TComPTL
 *
ΩcPTL
, 
Boﬁ
 
¥ofûePª£¡Fœg
, 
I¡
 
maxNumSubLayîsMöus1
 )

1592 
UI¡
 
uiCode
;

1593 if(
¥ofûePª£¡Fœg
)

1595 
	`∑r£ProfûeTõr
(
ΩcPTL
->
	`gëGíîÆPTL
(), 
Ál£
);

1597 
	`READ_CODE
–8, 
uiCode
, "gíîÆ_Àvñ_idc" ); 
ΩcPTL
->
	`gëGíîÆPTL
()->
	`£tLevñIdc
(
Levñ
::
	`Name
(uiCode));

1599 
I¡
 
i
 = 0; i < 
maxNumSubLayîsMöus1
; i++)

1601 
	`READ_FLAG
–
uiCode
, "sub_œyî_¥ofûe_¥e£¡_Êag[i]" ); 
ΩcPTL
->
	`£tSubLayîProfûePª£¡Fœg
(
i
, uiCode);

1602 
	`READ_FLAG
–
uiCode
, "sub_œyî_Àvñ_¥e£¡_Êag[i]" ); 
ΩcPTL
->
	`£tSubLayîLevñPª£¡Fœg
 (
i
, uiCode);

1605 i‡(
maxNumSubLayîsMöus1
 > 0)

1607 
I¡
 
i
 = 
maxNumSubLayîsMöus1
; i < 8; i++)

1609 
	`READ_CODE
(2, 
uiCode
, "reserved_zero_2bits");

1610 
	`as£π
(
uiCode
 == 0);

1614 
I¡
 
i
 = 0; i < 
maxNumSubLayîsMöus1
; i++)

1616 if–
ΩcPTL
->
	`gëSubLayîProfûePª£¡Fœg
(
i
) )

1618 
	`∑r£ProfûeTõr
(
ΩcPTL
->
	`gëSubLayîPTL
(
i
), 
åue
);

1620 if(
ΩcPTL
->
	`gëSubLayîLevñPª£¡Fœg
(
i
))

1622 
	`READ_CODE
–8, 
uiCode
, "sub_œyî_Àvñ_idc[i]" ); 
ΩcPTL
->
	`gëSubLayîPTL
(
i
)->
	`£tLevñIdc
(
Levñ
::
	`Name
(uiCode));

1625 
	}
}

1627 #i‡
ENC_DEC_TRACE
 || 
RExt__DECODER_DEBUG_BIT_STATISTICS


1628 
Void
 
	gTDecCavlc
::
	$∑r£ProfûeTõr
(
ProfûeTõrLevñ
 *
±l
, c⁄° 
Boﬁ
 
bIsSubLayî
)

1629 
	#PTL_TRACE_TEXT
(
txt
Ë
bIsSubLayî
?("sub_œyî_"ÅxtË: ("gíîÆ_"Åxt)

	)

1631 
Void
 
TDecCavlc
::
	$∑r£ProfûeTõr
(
ProfûeTõrLevñ
 *
±l
, c⁄° 
Boﬁ
 )

1632 
	#PTL_TRACE_TEXT
(
txt
Ë
	)
txt

1635 
UI¡
 
uiCode
;

1636 
	`READ_CODE
(2 , 
uiCode
, 
	`PTL_TRACE_TEXT
("¥ofûe_•a˚" )); 
±l
->
	`£tProfûeS∑˚
(uiCode);

1637 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("tõr_Êag" )); 
±l
->
	`£tTõrFœg
 (uiCodê? 
Levñ
::
HIGH
 : Levñ::
MAIN
);

1638 
	`READ_CODE
(5 , 
uiCode
, 
	`PTL_TRACE_TEXT
("¥ofûe_idc" )); 
±l
->
	`£tProfûeIdc
 (
Profûe
::
	`Name
(uiCode));

1639 
I¡
 
j
 = 0; j < 32; j++)

1641 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("¥ofûe_com∑tibûôy_Êag[][j]" )); 
±l
->
	`£tProfûeCom∑tibûôyFœg
(
j
, uiCode ? 1 : 0);

1643 
	`READ_FLAG
(
uiCode
, 
	`PTL_TRACE_TEXT
("¥ogªssive_sour˚_Êag" )); 
±l
->
	`£tProgªssiveSour˚Fœg
(uiCodê? 
åue
 : 
Ál£
);

1645 
	`READ_FLAG
(
uiCode
, 
	`PTL_TRACE_TEXT
("öãæa˚d_sour˚_Êag" )); 
±l
->
	`£tI¡îœ˚dSour˚Fœg
(uiCodê? 
åue
 : 
Ál£
);

1647 
	`READ_FLAG
(
uiCode
, 
	`PTL_TRACE_TEXT
("n⁄_∑cked_c⁄°øöt_Êag" )); 
±l
->
	`£tN⁄PackedC⁄°øötFœg
(uiCodê? 
åue
 : 
Ál£
);

1649 
	`READ_FLAG
(
uiCode
, 
	`PTL_TRACE_TEXT
("‰ame_⁄ly_c⁄°øöt_Êag" )); 
±l
->
	`£tFømeO∆yC⁄°øötFœg
(uiCodê? 
åue
 : 
Ál£
);

1651 i‡(
±l
->
	`gëProfûeIdc
(Ë=
Profûe
::
MAINREXT
 ||Öé->
	`gëProfûeCom∑tibûôyFœg
(Profile::MAINREXT) ||

1652 
±l
->
	`gëProfûeIdc
(Ë=
Profûe
::
HIGHTHROUGHPUTREXT
 ||Öé->
	`gëProfûeCom∑tibûôyFœg
(Profile::HIGHTHROUGHPUTREXT))

1654 
UI¡
 
maxBôDïth
=16;

1655 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("max_12bô_c⁄°øöt_Êag" )); i‡(uiCodeË
maxBôDïth
=12;

1656 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("max_10bô_c⁄°øöt_Êag" )); i‡(uiCodeË
maxBôDïth
=10;

1657 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("max_8bô_c⁄°øöt_Êag" )); i‡(uiCodeË
maxBôDïth
=8;

1658 
±l
->
	`£tBôDïthC⁄°øöt
(
maxBôDïth
);

1659 
ChromaF‹m©
 
chromaFmtC⁄°øöt
=
CHROMA_444
;

1660 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("max_422chroma_c⁄°øöt_Êag" )); i‡(uiCodeË
chromaFmtC⁄°øöt
=
CHROMA_422
;

1661 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("max_420chroma_c⁄°øöt_Êag" )); i‡(uiCodeË
chromaFmtC⁄°øöt
=
CHROMA_420
;

1662 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("max_m⁄ochrome_c⁄°øöt_Êag" )); i‡(uiCodeË
chromaFmtC⁄°øöt
=
CHROMA_400
;

1663 
±l
->
	`£tChromaF‹m©C⁄°øöt
(
chromaFmtC⁄°øöt
);

1664 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("öåa_c⁄°øöt_Êag" )); 
±l
->
	`£tI¡øC⁄°øötFœg
(uiCode != 0);

1665 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("⁄e_pi˘uª_⁄ly_c⁄°øöt_Êag")); 
±l
->
	`£tO√Pi˘uªO∆yC⁄°øötFœg
(uiCode != 0);

1666 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("lowî_bô_øã_c⁄°øöt_Êag" )); 
±l
->
	`£tLowîBôR©eC⁄°øötFœg
(uiCode != 0);

1667 
	`READ_CODE
(16, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_34bits[0..15]" ));

1668 
	`READ_CODE
(16, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_34bits[16..31]" ));

1669 
	`READ_CODE
(2, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_34bits[32..33]" ));

1673 
±l
->
	`£tBôDïthC⁄°øöt
(’é->
	`gëProfûeIdc
(Ë=
Profûe
::
MAIN10
)?10:8);

1674 
±l
->
	`£tChromaF‹m©C⁄°øöt
(
CHROMA_420
);

1675 
±l
->
	`£tI¡øC⁄°øötFœg
(
Ál£
);

1676 
±l
->
	`£tLowîBôR©eC⁄°øötFœg
(
åue
);

1677 i‡(
±l
->
	`gëProfûeIdc
(Ë=
Profûe
::
MAIN10
 ||Öé->
	`gëProfûeCom∑tibûôyFœg
(Profile::MAIN10))

1679 
	`READ_CODE
(7, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_7bits" ));

1680 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("⁄e_pi˘uª_⁄ly_c⁄°øöt_Êag")); 
±l
->
	`£tO√Pi˘uªO∆yC⁄°øötFœg
(uiCode != 0);

1681 
	`READ_CODE
(16, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_35bits[0..15]" ));

1682 
	`READ_CODE
(16, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_35bits[16..31]" ));

1683 
	`READ_CODE
(3, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_35bits[32..34]" ));

1687 
	`READ_CODE
(16, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_43bits[0..15]" ));

1688 
	`READ_CODE
(16, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_43bits[16..31]" ));

1689 
	`READ_CODE
(11, 
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_43bits[32..42]" ));

1693 i‡((
±l
->
	`gëProfûeIdc
(Ë>
Profûe
::
MAIN
 &&Öé->gëProfûeIdc(Ë<Profûe::
HIGHTHROUGHPUTREXT
) ||

1694 
±l
->
	`gëProfûeCom∑tibûôyFœg
(
Profûe
::
MAIN
) ||

1695 
±l
->
	`gëProfûeCom∑tibûôyFœg
(
Profûe
::
MAIN10
) ||

1696 
±l
->
	`gëProfûeCom∑tibûôyFœg
(
Profûe
::
MAINSTILLPICTURE
) ||

1697 
±l
->
	`gëProfûeCom∑tibûôyFœg
(
Profûe
::
MAINREXT
) ||

1698 
±l
->
	`gëProfûeCom∑tibûôyFœg
(
Profûe
::
HIGHTHROUGHPUTREXT
) )

1700 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("öbld_Êag" )); 
	`as£π
(uiCode == 0);

1704 
	`READ_FLAG
–
uiCode
, 
	`PTL_TRACE_TEXT
("reserved_zero_bit" ));

1706 #unde‡
PTL_TRACE_TEXT


1707 
	}
}

1709 
Void
 
	gTDecCavlc
::
	$∑r£Tîmö©ögBô
–
UI¡
& 
ruiBô
 )

1711 
ruiBô
 = 
Ál£
;

1712 
I¡
 
iBôsLe·
 = 
m_pcBô°ªam
->
	`gëNumBôsLe·
();

1713 if(
iBôsLe·
 <= 8)

1715 
UI¡
 
uiPìkVÆue
 = 
m_pcBô°ªam
->
	`≥ekBôs
(
iBôsLe·
);

1716 i‡(
uiPìkVÆue
 =(1<<(
iBôsLe·
-1)))

1718 
ruiBô
 = 
åue
;

1721 
	}
}

1723 
Void
 
	gTDecCavlc
::
	$∑r£RemaöögByãs
–
Boﬁ
 
noTøûögByãsEx≥˘ed
 )

1725 i‡(
noTøûögByãsEx≥˘ed
)

1727 c⁄° 
UI¡
 
numbîOfRemaöögSub°ªamByãs
=
m_pcBô°ªam
->
	`gëNumBôsLe·
();

1728 
	`as£π
 (
numbîOfRemaöögSub°ªamByãs
 == 0);

1732 
m_pcBô°ªam
->
	`gëNumBôsLe·
())

1734 
UI¡
 
åaûögNuŒByã
=
m_pcBô°ªam
->
	`ªadByã
();

1735 i‡(
åaûögNuŒByã
!=0)

1737 
	`¥ötf
("Tøûög byã should bê0, buàha†vÆuê%02x\n", 
åaûögNuŒByã
);

1738 
	`as£π
(
åaûögNuŒByã
==0);

1742 
	}
}

1744 
Void
 
	gTDecCavlc
::
	$∑r£SkùFœg
–
TComD©aCU
* , 
UI¡
 , UInt )

1746 
	`as£π
(0);

1747 
	}
}

1749 
Void
 
	gTDecCavlc
::
	$∑r£CUTønsqu™tBy∑ssFœg
–
TComD©aCU
* , 
UI¡
 , UInt )

1751 
	`as£π
(0);

1752 
	}
}

1754 
Void
 
	gTDecCavlc
::
	$∑r£MVPIdx
–
I¡
& )

1756 
	`as£π
(0);

1757 
	}
}

1759 
Void
 
	gTDecCavlc
::
	$∑r£S∂ôFœg
 ( 
TComD©aCU
* , 
UI¡
 , UInt )

1761 
	`as£π
(0);

1762 
	}
}

1764 
Void
 
	gTDecCavlc
::
	$∑r£P¨tSize
–
TComD©aCU
* , 
UI¡
 , UInt )

1766 
	`as£π
(0);

1767 
	}
}

1769 
Void
 
	gTDecCavlc
::
	$∑r£PªdMode
–
TComD©aCU
* , 
UI¡
 , UInt )

1771 
	`as£π
(0);

1772 
	}
}

1782 
Void
 
	gTDecCavlc
::
	$∑r£IPCMInfo
–
TComD©aCU
* , 
UI¡
 , UInt )

1784 
	`as£π
(0);

1785 
	}
}

1787 
Void
 
	gTDecCavlc
::
	$∑r£I¡øDúLumaAng
 ( 
TComD©aCU
* , 
UI¡
 , UInt )

1789 
	`as£π
(0);

1790 
	}
}

1792 
Void
 
	gTDecCavlc
::
	$∑r£I¡øDúChroma
–
TComD©aCU
* , 
UI¡
 , UInt )

1794 
	`as£π
(0);

1795 
	}
}

1797 
Void
 
	gTDecCavlc
::
	$∑r£I¡îDú
–
TComD©aCU
* , 
UI¡
& , UInt )

1799 
	`as£π
(0);

1800 
	}
}

1802 
Void
 
	gTDecCavlc
::
	$∑r£RefFrmIdx
–
TComD©aCU
* , 
I¡
& , 
RefPicLi°
 )

1804 
	`as£π
(0);

1805 
	}
}

1807 
Void
 
	gTDecCavlc
::
	$∑r£Mvd
–
TComD©aCU
* , 
UI¡
 , UI¡ , UI¡ , 
RefPicLi°
 )

1809 
	`as£π
(0);

1810 
	}
}

1812 
Void
 
	gTDecCavlc
::
	$∑r£CrossComp⁄ítPªdi˘i⁄
–
˛ass
 
TComTU
& , 
Comp⁄ítID
 )

1814 
	`as£π
(0);

1815 
	}
}

1817 
Void
 
	gTDecCavlc
::
	$∑r£DñèQP
–
TComD©aCU
* , 
UI¡
 , UInt )

1819 
	`as£π
(0);

1820 
	}
}

1822 
Void
 
	gTDecCavlc
::
	$∑r£ChromaQpAdju°mít
–
TComD©aCU
* , 
UI¡
 , UInt )

1824 
	`as£π
(0);

1825 
	}
}

1827 
Void
 
	gTDecCavlc
::
	$∑r£C€ffNxN
–
TComTU
 & , 
Comp⁄ítID
 )

1829 
	`as£π
(0);

1830 
	}
}

1832 
Void
 
	gTDecCavlc
::
	$∑r£Tønsf‹mSubdivFœg
–
UI¡
& , UInt )

1834 
	`as£π
(0);

1835 
	}
}

1837 
Void
 
	gTDecCavlc
::
	$∑r£QtCbf
–
TComTU
 & , c⁄° 
Comp⁄ítID
 , c⁄° 
Boﬁ
 )

1839 
	`as£π
(0);

1840 
	}
}

1842 
Void
 
	gTDecCavlc
::
	$∑r£QtRoŸCbf
–
UI¡
 , UInt& )

1844 
	`as£π
(0);

1845 
	}
}

1847 
Void
 
	gTDecCavlc
::
	$∑r£Tønsf‹mSkùFœgs
 (
TComTU
 & , 
Comp⁄ítID
 )

1849 
	`as£π
(0);

1850 
	}
}

1852 
Void
 
	gTDecCavlc
::
	$∑r£MîgeFœg
 ( 
TComD©aCU
* , 
UI¡
 , UInt , UInt )

1854 
	`as£π
(0);

1855 
	}
}

1857 
Void
 
	gTDecCavlc
::
	$∑r£MîgeIndex
 ( 
TComD©aCU
* , 
UI¡
& )

1859 
	`as£π
(0);

1860 
	}
}

1867 
Void
 
	gTDecCavlc
::
	$xP¨£PªdWeightTabÀ
–
TComSli˚
* 
pcSli˚
, c⁄° 
TComSPS
 *
•s
 )

1869 
WPSˇlögP¨am
 *
wp
;

1870 c⁄° 
ChromaF‹m©
 
chFmt
 = 
•s
->
	`gëChromaF‹m©Idc
();

1871 c⁄° 
I¡
 
numVÆidComp
 = 
	`I¡
(
	`gëNumbîVÆidComp⁄íts
(
chFmt
));

1872 c⁄° 
Boﬁ
 
bChroma
 = (
chFmt
!=
CHROMA_400
);

1873 c⁄° 
Sli˚Ty≥
 
eSli˚Ty≥
 = 
pcSli˚
->
	`gëSli˚Ty≥
();

1874 c⁄° 
I¡
 
iNbRef
 = (
eSli˚Ty≥
 =
B_SLICE
 ) ? (2) : (1);

1875 
UI¡
 
uiLog2WeightDíomLuma
=0, 
uiLog2WeightDíomChroma
=0;

1876 
UI¡
 
uiTŸÆSig«ŒedWeightFœgs
 = 0;

1878 
I¡
 
iDñèDíom
;

1880 
	`READ_UVLC
–
uiLog2WeightDíomLuma
, "luma_log2_weight_denom" );

1881 
	`as£π
–
uiLog2WeightDíomLuma
 <= 7 );

1882 if–
bChroma
 )

1884 
	`READ_SVLC
–
iDñèDíom
, "delta_chroma_log2_weight_denom" );

1885 
	`as£π
((
iDñèDíom
 + (
I¡
)
uiLog2WeightDíomLuma
)>=0);

1886 
	`as£π
((
iDñèDíom
 + (
I¡
)
uiLog2WeightDíomLuma
)<=7);

1887 
uiLog2WeightDíomChroma
 = (
UI¡
)(
iDñèDíom
 + 
uiLog2WeightDíomLuma
);

1890  
I¡
 
iNumRef
=0 ; iNumRef<
iNbRef
 ; iNumRef++ )

1892 
RefPicLi°
 
eRefPicLi°
 = ( 
iNumRef
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

1893  
I¡
 
iRefIdx
=0 ; iRefIdx<
pcSli˚
->
	`gëNumRefIdx
(
eRefPicLi°
) ; iRefIdx++ )

1895 
pcSli˚
->
	`gëWpSˇlög
(
eRefPicLi°
, 
iRefIdx
, 
wp
);

1897 
wp
[
COMPONENT_Y
].
uiLog2WeightDíom
 = 
uiLog2WeightDíomLuma
;

1898 
I¡
 
j
=1; j<
numVÆidComp
; j++)

1900 
wp
[
j
].
uiLog2WeightDíom
 = 
uiLog2WeightDíomChroma
;

1903 
UI¡
 
uiCode
;

1904 
	`READ_FLAG
–
uiCode
, 
iNumRef
==0?"luma_weight_l0_flag[i]":"luma_weight_l1_flag[i]" );

1905 
wp
[
COMPONENT_Y
].
bPª£¡Fœg
 = ( 
uiCode
 == 1 );

1906 
uiTŸÆSig«ŒedWeightFœgs
 +
wp
[
COMPONENT_Y
].
bPª£¡Fœg
;

1908 i‡–
bChroma
 )

1910 
UI¡
 
uiCode
;

1911  
I¡
 
iRefIdx
=0 ; iRefIdx<
pcSli˚
->
	`gëNumRefIdx
(
eRefPicLi°
) ; iRefIdx++ )

1913 
pcSli˚
->
	`gëWpSˇlög
(
eRefPicLi°
, 
iRefIdx
, 
wp
);

1914 
	`READ_FLAG
–
uiCode
, 
iNumRef
==0?"chroma_weight_l0_flag[i]":"chroma_weight_l1_flag[i]" );

1915 
I¡
 
j
=1; j<
numVÆidComp
; j++)

1917 
wp
[
j
].
bPª£¡Fœg
 = ( 
uiCode
 == 1 );

1919 
uiTŸÆSig«ŒedWeightFœgs
 +2*
wp
[
COMPONENT_Cb
].
bPª£¡Fœg
;

1922  
I¡
 
iRefIdx
=0 ; iRefIdx<
pcSli˚
->
	`gëNumRefIdx
(
eRefPicLi°
) ; iRefIdx++ )

1924 
pcSli˚
->
	`gëWpSˇlög
(
eRefPicLi°
, 
iRefIdx
, 
wp
);

1925 i‡–
wp
[
COMPONENT_Y
].
bPª£¡Fœg
 )

1927 
I¡
 
iDñèWeight
;

1928 
	`READ_SVLC
–
iDñèWeight
, 
iNumRef
==0?"delta_luma_weight_l0[i]":"delta_luma_weight_l1[i]" );

1929 
	`as£π
–
iDñèWeight
 >= -128 );

1930 
	`as£π
–
iDñèWeight
 <= 127 );

1931 
wp
[
COMPONENT_Y
].
iWeight
 = (
iDñèWeight
 + (1<<wp[COMPONENT_Y].
uiLog2WeightDíom
));

1932 
	`READ_SVLC
–
wp
[
COMPONENT_Y
].
iOff£t
, 
iNumRef
==0?"luma_offset_l0[i]":"luma_offset_l1[i]" );

1933 
I¡
 
ønge
=
•s
->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
(Ë? (1<<•s->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
))/2 : 128;

1934 
	`as£π
–
wp
[0].
iOff£t
 >-
ønge
 );

1935 
	`as£π
–
wp
[0].
iOff£t
 < 
ønge
 );

1939 
wp
[
COMPONENT_Y
].
iWeight
 = (1 << wp[COMPONENT_Y].
uiLog2WeightDíom
);

1940 
wp
[
COMPONENT_Y
].
iOff£t
 = 0;

1942 i‡–
bChroma
 )

1944 i‡–
wp
[
COMPONENT_Cb
].
bPª£¡Fœg
 )

1946 
I¡
 
ønge
=
•s
->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
(Ë? (1<<•s->
	`gëBôDïth
(
CHANNEL_TYPE_CHROMA
))/2 : 128;

1947  
I¡
 
j
=1 ; j<
numVÆidComp
 ; j++ )

1949 
I¡
 
iDñèWeight
;

1950 
	`READ_SVLC
–
iDñèWeight
, 
iNumRef
==0?"delta_chroma_weight_l0[i]":"delta_chroma_weight_l1[i]" );

1951 
	`as£π
–
iDñèWeight
 >= -128 );

1952 
	`as£π
–
iDñèWeight
 <= 127 );

1953 
wp
[
j
].
iWeight
 = (
iDñèWeight
 + (1<<wp[j].
uiLog2WeightDíom
));

1955 
I¡
 
iDñèChroma
;

1956 
	`READ_SVLC
–
iDñèChroma
, 
iNumRef
==0?"delta_chroma_offset_l0[i]":"delta_chroma_offset_l1[i]" );

1957 
	`as£π
–
iDñèChroma
 >-4*
ønge
);

1958 
	`as£π
–
iDñèChroma
 < 4*
ønge
);

1959 
I¡
 
¥ed
 = ( 
ønge
 - ( (Ñ™ge*
wp
[
j
].
iWeight
)>>(wp[j].
uiLog2WeightDíom
) ) );

1960 
wp
[
j
].
iOff£t
 = 
	`Clù3
(-
ønge
,Ñ™ge-1, (
iDñèChroma
 + 
¥ed
) );

1965  
I¡
 
j
=1 ; j<
numVÆidComp
 ; j++ )

1967 
wp
[
j
].
iWeight
 = (1 << wp[j].
uiLog2WeightDíom
);

1968 
wp
[
j
].
iOff£t
 = 0;

1974  
I¡
 
iRefIdx
=
pcSli˚
->
	`gëNumRefIdx
(
eRefPicLi°
Ë; iRefIdx<
MAX_NUM_REF
 ; iRefIdx++ )

1976 
pcSli˚
->
	`gëWpSˇlög
(
eRefPicLi°
, 
iRefIdx
, 
wp
);

1978 
wp
[0].
bPª£¡Fœg
 = 
Ál£
;

1979 
wp
[1].
bPª£¡Fœg
 = 
Ál£
;

1980 
wp
[2].
bPª£¡Fœg
 = 
Ál£
;

1983 
	`as£π
(
uiTŸÆSig«ŒedWeightFœgs
<=24);

1984 
	}
}

1989 
Void
 
	gTDecCavlc
::
	$∑r£SˇlögLi°
(
TComSˇlögLi°
* 
sˇlögLi°
)

1991 
UI¡
 
code
, 
sizeId
, 
li°Id
;

1992 
Boﬁ
 
sˇlögLi°PªdModeFœg
;

1994 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

1996 
li°Id
 = 0;Üi°Id < 
SCALING_LIST_NUM
;ÜistId++)

1998 i‡((
sizeId
==
SCALING_LIST_32x32
Ë&& (
li°Id
%(
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
) != 0))

2000 
I¡
 *
§c
 = 
sˇlögLi°
->
	`gëSˇlögLi°Addªss
(
sizeId
, 
li°Id
);

2001 c⁄° 
I¡
 
size
 = 
	`mö
(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[
sizeId
]);

2002 c⁄° 
I¡
 *
§cNextSmÆÀrSize
 = 
sˇlögLi°
->
	`gëSˇlögLi°Addªss
(
sizeId
-1, 
li°Id
);

2003 
I¡
 
i
=0; i<
size
; i++)

2005 
§c
[
i
] = 
§cNextSmÆÀrSize
[i];

2007 
sˇlögLi°
->
	`£tSˇlögLi°DC
(
sizeId
,
li°Id
,(sizeId > 
SCALING_LIST_8x8
Ë? sˇlögLi°->
	`gëSˇlögLi°DC
(sizeId-1,Üi°IdË: 
§c
[0]);

2011 
	`READ_FLAG
–
code
, "scaling_list_pred_mode_flag");

2012 
sˇlögLi°PªdModeFœg
 = (
code
Ë? 
åue
 : 
Ál£
;

2013 
sˇlögLi°
->
	`£tSˇlögLi°PªdModeFœg
(
sizeId
, 
li°Id
, 
sˇlögLi°PªdModeFœg
);

2014 if(!
sˇlögLi°PªdModeFœg
)

2016 
	`READ_UVLC
–
code
, "scaling_list_pred_matrix_id_delta");

2018 i‡(
sizeId
==
SCALING_LIST_32x32
)

2020 
code
*=(
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
);

2023 
sˇlögLi°
->
	`£tRefM©rixId
 (
sizeId
,
li°Id
,(
UI¡
)((
I¡
)÷i°Id)-(
code
)));

2024 if–
sizeId
 > 
SCALING_LIST_8x8
 )

2026 
sˇlögLi°
->
	`£tSˇlögLi°DC
(
sizeId
,
li°Id
,(÷i°Id =sˇlögLi°->
	`gëRefM©rixId
 (sizeId,li°Id))? 16 :sˇlögLi°->
	`gëSˇlögLi°DC
(sizeId, scalingList->getRefMatrixId (sizeId,listId))));

2028 
sˇlögLi°
->
	`¥o˚ssRefM©rix
–
sizeId
, 
li°Id
, sˇlögLi°->
	`gëRefM©rixId
 (sizeId,listId));

2033 
	`xDecodeSˇlögLi°
(
sˇlögLi°
, 
sizeId
, 
li°Id
);

2040 
	}
}

2046 
Void
 
	gTDecCavlc
::
	$xDecodeSˇlögLi°
(
TComSˇlögLi°
 *
sˇlögLi°
, 
UI¡
 
sizeId
, UI¡ 
li°Id
)

2048 
I¡
 
i
,
c€fNum
 = 
	`mö
(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[
sizeId
]);

2049 
I¡
 
d©a
;

2050 
I¡
 
sˇlögLi°DcC€fMöus8
 = 0;

2051 
I¡
 
√xtC€f
 = 
SCALING_LIST_START_VALUE
;

2052 
UI¡
* 
sˇn
 = 
g_sˇnOrdî
[
SCAN_UNGROUPED
][
SCAN_DIAG
][
sizeId
==0 ? 2 : 3][sizeId==0 ? 2 : 3];

2053 
I¡
 *
d°
 = 
sˇlögLi°
->
	`gëSˇlögLi°Addªss
(
sizeId
, 
li°Id
);

2055 if–
sizeId
 > 
SCALING_LIST_8x8
 )

2057 
	`READ_SVLC
–
sˇlögLi°DcC€fMöus8
, "scaling_list_dc_coef_minus8");

2058 
sˇlögLi°
->
	`£tSˇlögLi°DC
(
sizeId
,
li°Id
,
sˇlögLi°DcC€fMöus8
 + 8);

2059 
√xtC€f
 = 
sˇlögLi°
->
	`gëSˇlögLi°DC
(
sizeId
,
li°Id
);

2062 
i
 = 0; i < 
c€fNum
; i++)

2064 
	`READ_SVLC
–
d©a
, "scaling_list_delta_coef");

2065 
√xtC€f
 = (√xtC€‡+ 
d©a
 + 256 ) % 256;

2066 
d°
[
sˇn
[
i
]] = 
√xtC€f
;

2068 
	}
}

2070 
Boﬁ
 
	gTDecCavlc
::
	$xM‹eRb•D©a
()

2072 
I¡
 
bôsLe·
 = 
m_pcBô°ªam
->
	`gëNumBôsLe·
();

2075 i‡(
bôsLe·
 > 8)

2077  
åue
;

2080 
UCh¨
 
œ°Byã
 = 
m_pcBô°ªam
->
	`≥ekBôs
(
bôsLe·
);

2081 
I¡
 
˙t
 = 
bôsLe·
;

2084 (
˙t
>0Ë&& ((
œ°Byã
 & 1) == 0))

2086 
œ°Byã
 >>= 1;

2087 
˙t
--;

2090 
˙t
--;

2093 
	`as£π
 (
˙t
>=0);

2096  (
˙t
>0);

2097 
	}
}

2099 
Void
 
	gTDecCavlc
::
	$∑r£Ex∂icôRdpcmMode
–
TComTU
& , 
Comp⁄ítID
 )

2101 
	`as£π
(0);

2102 
	}
}

	@TLibDecoder/TDecCAVLC.h

38 #i‚de‡
__TDECCAVLC__


39 
	#__TDECCAVLC__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TDecE¡r›y.h
"

46 
	~"Sy¡axEÀmítP¨£r.h
"

56 
˛ass
 
	gTDecCavlc
 : 
public
 
Sy¡axEÀmítP¨£r
,Öubli¯
	gTDecE¡r›yIf


58 
	gpublic
:

59 
TDecCavlc
();

60 
	gvútuÆ
 ~
TDecCavlc
();

62 
	g¥Ÿe˘ed
:

64 
Void
 
∑r£Sh‹tTîmRefPicSë
 (
TComSPS
* 
pcSPS
, 
TComRe„ªn˚Pi˘uªSë
* 
pcRPS
, 
I¡
 
idx
);

66 
	gpublic
:

69 
Void
 
ª£tE¡r›y
 ( 
TComSli˚
* ) { 
as£π
(0); };

70 
Void
 
£tBô°ªam
 ( 
TComI≈utBô°ªam
* 
p
 ) { 
	gm_pcBô°ªam
 =Ö; }

71 
Void
 
∑r£Tønsf‹mSubdivFœg
–
UI¡
& 
ruiSubdivFœg
, UI¡ 
uiLog2Tønsf‹mBlockSize
 );

72 
Void
 
∑r£QtCbf
 ( 
˛ass
 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 );

73 
Void
 
∑r£QtRoŸCbf
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡& 
uiQtRoŸCbf
 );

74 
Void
 
∑r£VPS
 ( 
TComVPS
* 
pcVPS
 );

75 
Void
 
∑r£SPS
 ( 
TComSPS
* 
pcSPS
 );

76 
Void
 
∑r£PPS
 ( 
TComPPS
* 
pcPPS
 );

77 
Void
 
∑r£VUI
 ( 
TComVUI
* 
pcVUI
, 
TComSPS
* 
pcSPS
 );

78 
Void
 
∑r£SEI
 ( 
SEIMesßges
& );

79 
Void
 
∑r£PTL
 ( 
TComPTL
 *
ΩcPTL
, 
Boﬁ
 
¥ofûePª£¡Fœg
, 
I¡
 
maxNumSubLayîsMöus1
 );

80 
Void
 
∑r£ProfûeTõr
 (
ProfûeTõrLevñ
 *
±l
, c⁄° 
Boﬁ
 
bIsSubLayî
);

81 
Void
 
∑r£HrdP¨amëîs
 (
TComHRD
 *
hrd
, 
Boﬁ
 
˝rms_¥e£¡_Êag
, 
UI¡
 
ãmpLevñHigh
);

82 
Void
 
∑r£Sli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
, 
P¨amëîSëM™agî
 *
∑ømëîSëM™agî
, c⁄° 
I¡
 
¥evTid0POC
);

83 
Void
 
∑r£Tîmö©ögBô
 ( 
UI¡
& 
ruiBô
 );

84 
Void
 
∑r£RemaöögByãs
 ( 
Boﬁ
 
noTøûögByãsEx≥˘ed
 );

86 
Void
 
∑r£MVPIdx
 ( 
I¡
& 
riMVPIdx
 );

88 
Void
 
∑r£SkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

89 
Void
 
∑r£CUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

90 
Void
 
∑r£MîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiPUIdx
 );

91 
Void
 
∑r£MîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiMîgeIndex
 );

92 
Void
 
∑r£S∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

93 
Void
 
∑r£P¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

94 
Void
 
∑r£PªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

96 
Void
 
∑r£I¡øDúLumaAng
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

97 
Void
 
∑r£I¡øDúChroma
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

99 
Void
 
∑r£I¡îDú
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiI¡îDú
, UI¡ 
uiAbsP¨tIdx
 );

100 
Void
 
∑r£RefFrmIdx
 ( 
TComD©aCU
* 
pcCU
, 
I¡
& 
riRefFrmIdx
, 
RefPicLi°
 
eRefLi°
 );

101 
Void
 
∑r£Mvd
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tAddr
,UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
, 
RefPicLi°
 
eRefLi°
 );

103 
Void
 
∑r£CrossComp⁄ítPªdi˘i⁄
–
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

105 
Void
 
∑r£DñèQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

106 
Void
 
∑r£ChromaQpAdju°mít
–
TComD©aCU
* 
cu
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
);

108 
Void
 
∑r£C€ffNxN
 ( 
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

110 
Void
 
∑r£Tønsf‹mSkùFœgs
 ( 
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
 );

112 
Void
 
∑r£IPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
);

114 
Void
 
xP¨£PªdWeightTabÀ
 ( 
TComSli˚
* 
pcSli˚
, c⁄° 
TComSPS
 *
•s
 );

115 
Void
 
∑r£SˇlögLi°
 ( 
TComSˇlögLi°
* 
sˇlögLi°
 );

116 
Void
 
xDecodeSˇlögLi°
 ( 
TComSˇlögLi°
 *
sˇlögLi°
, 
UI¡
 
sizeId
, UI¡ 
li°Id
);

118 
Void
 
∑r£Ex∂icôRdpcmMode
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

120 
	g¥Ÿe˘ed
:

121 
Boﬁ
 
xM‹eRb•D©a
();

	@TLibDecoder/TDecConformance.cpp

38 
	~"TDecC⁄f‹m™˚.h
"

39 
	~"TLibComm⁄/TComSli˚.h
"

40 
	~"TLibComm⁄/TComPic.h
"

41 
	~"TLibComm⁄/TComPicSym.h
"

42 
	~"NALªad.h
"

43 
	~<m©h.h
>

45 #i‡!
DPB_ENCODER_USAGE_CHECK


46 
UI¡


47 
	gLevñTõrFótuªs
::
	$gëMaxPicWidthInLumaSam∂es
() const

49  
	`UI¡
(
	`sqπ
(
maxLumaPs
*8.0));

50 
	}
}

52 
UI¡


53 
	gLevñTõrFótuªs
::
	$gëMaxPicHeightInLumaSam∂es
() const

55  
	`UI¡
(
	`sqπ
(
maxLumaPs
*8.0));

56 
	}
}

59 
UI¡


60 
	gTDecC⁄f‹m™˚Check
::
	$gëMöLog2CtbSize
(c⁄° 
TComPTL
 &
±l
,

61 
UI¡
 
œyîPlus1
)

63 c⁄° 
ProfûeTõrLevñ
 *
pPTL
 = (
œyîPlus1
==0Ë? 
±l
.
	`gëGíîÆPTL
(Ë:Öé.
	`gëSubLayîPTL
(layerPlus1-1);

64  (
pPTL
->
	`gëLevñIdc
(Ë< 
Levñ
::
LEVEL5
) ? 4 : 5;

65 
	}
}

68 
UI¡


69 
	gTDecC⁄f‹m™˚Check
::
	$gëMaxLog2CtbSize
(c⁄° 
TComPTL
 & ,

70 
UI¡
 )

72  
MAX_CU_DEPTH
;

73 
	}
}

76 
	gTDecC⁄f‹m™˚Check
::
	$TDecC⁄f‹m™˚Check
()

77 #i‡
MCTS_ENC_CHECK


78 :
	$m_tm˘sCheckE«bÀd
(
Ál£
)

79 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK


80 , 
	`m_numbîOfSli˚sInPi˘uª
(0)

81 , 
	$m_byãsInPi˘uª
(0)

84 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK


85 : 
	`m_numbîOfSli˚sInPi˘uª
(0)

86 , 
	$m_byãsInPi˘uª
(0)

90 
	}
}

92 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 != 0

94 #i‡!
DPB_ENCODER_USAGE_CHECK


95 c⁄° 
UI¡64
 
	gMAX_CNFUINT64
 = 
°d
::
numîic_limôs
<UI¡64>::
max
();

97 c⁄° 
LevñTõrFótuªs
 
	gmaöLevñTõrInfo
[] =

99 { 
Levñ
::
LEVEL1
 , 36864, { 350, 0 }, 16, 1, 1, 552960ULL, { 128, 0 }, { 2, 2} },

100 { 
Levñ
::
LEVEL2
 , 122880, { 1500, 0 }, 16, 1, 1, 3686400ULL, { 1500, 0 }, { 2, 2} },

101 { 
Levñ
::
LEVEL2_1
, 245760, { 3000, 0 }, 20, 1, 1, 7372800ULL, { 3000, 0 }, { 2, 2} },

102 { 
Levñ
::
LEVEL3
 , 552960, { 6000, 0 }, 30, 2, 2, 16588800ULL, { 6000, 0 }, { 2, 2} },

103 { 
Levñ
::
LEVEL3_1
, 983040, { 10000, 0 }, 40, 3, 3, 33177600ULL, { 10000, 0 }, { 2, 2} },

104 { 
Levñ
::
LEVEL4
 , 2228224, { 12000, 30000 }, 75, 5, 5, 66846720ULL, { 12000, 30000 }, { 4, 4} },

105 { 
Levñ
::
LEVEL4_1
, 2228224, { 20000, 50000 }, 75, 5, 5, 133693440ULL, { 20000, 50000 }, { 4, 4} },

106 { 
Levñ
::
LEVEL5
 , 8912896, { 25000, 100000 }, 200, 11, 10, 267386880ULL, { 25000, 100000 }, { 6, 4} },

107 { 
Levñ
::
LEVEL5_1
, 8912896, { 40000, 160000 }, 200, 11, 10, 534773760ULL, { 40000, 160000 }, { 8, 4} },

108 { 
Levñ
::
LEVEL5_2
, 8912896, { 60000, 240000 }, 200, 11, 10, 1069547520ULL, { 60000, 240000 }, { 8, 4} },

109 { 
Levñ
::
LEVEL6
 , 35651584, { 60000, 240000 }, 600, 22, 20, 1069547520ULL, { 60000, 240000 }, { 8, 4} },

110 { 
Levñ
::
LEVEL6_1
, 35651584, { 120000, 480000 }, 600, 22, 20, 2139095040ULL, { 120000, 480000 }, { 8, 4} },

111 { 
Levñ
::
LEVEL6_2
, 35651584, { 240000, 800000 }, 600, 22, 20, 4278190080ULL, { 240000, 800000 }, { 6, 4} },

112 { 
Levñ
::
LEVEL8_5
, 
MAX_UINT
, { MAX_UINT, MAX_UINT }, MAX_UINT, MAX_UINT, MAX_UINT, 
MAX_CNFUINT64
, {MAX_UINT, MAX_UINT }, { 0, 0} },

113 { 
Levñ
::
NONE
 }

116 c⁄° 
ProfûeFótuªs
 
	gvÆidProfûes
[] =

118 { 
Profûe
::
MAIN
, "Maö", 8, 
CHROMA_420
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

119 { 
Profûe
::
MAIN10
, "Maö10", 10, 
CHROMA_420
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1875, 10 , 
maöLevñTõrInfo
 },

120 { 
Profûe
::
MAIN10
, "Maö10 Stû»Pi˘uª", 10, 
CHROMA_420
, 
Ál£
, 
åue
, 
ENABLED
 , 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1
 , fÆ£, 256, 64,Åruê, 1000, 1100, 1875, 10 , 
maöLevñTõrInfo
 },

121 { 
Profûe
::
MAINSTILLPICTURE
, "Maö Stû»Pi˘uª", 8, 
CHROMA_420
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1
 , fÆ£, 256, 64, 
åue
 , 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

122 { 
Profûe
::
MAINREXT
, "M⁄ochrome", 8, 
CHROMA_400
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 667, 733, 1000, 10 , 
maöLevñTõrInfo
 },

123 { 
Profûe
::
MAINREXT
, "M⁄ochromê12", 12, 
CHROMA_400
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

124 { 
Profûe
::
MAINREXT
, "M⁄ochromê16", 16, 
CHROMA_400
, 
Ál£
, fÆ£, 
ENABLED
 , 
OPTIONAL
, OPTIONAL, 
DISABLED
, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1333, 1467, 2000, 10 , 
maöLevñTõrInfo
 },

125 { 
Profûe
::
MAINREXT
, "Maö 12", 12, 
CHROMA_420
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1500, 1650, 2250, 10 , 
maöLevñTõrInfo
 },

126 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 10", 10, 
CHROMA_422
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, 
OPTIONAL
, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1667, 1833, 2500, 5 , 
maöLevñTõrInfo
 },

127 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 12", 12, 
CHROMA_422
, 
Ál£
, fÆ£, 
ENABLED
 , 
DISABLED
, DISABLED, 
OPTIONAL
, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

128 { 
Profûe
::
MAINREXT
, "Maö 4:4:4", 8, 
CHROMA_444
, 
Ál£
, fÆ£, 
ENABLED
 , 
OPTIONAL
, 
DISABLED
, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

129 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 10", 10, 
CHROMA_444
, 
Ál£
, fÆ£, 
ENABLED
 , 
OPTIONAL
, 
DISABLED
, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2500, 2750, 3750, 5 , 
maöLevñTõrInfo
 },

130 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 12", 12, 
CHROMA_444
, 
Ál£
, fÆ£, 
ENABLED
 , 
OPTIONAL
, 
DISABLED
, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 3000, 3300, 4500, 5 , 
maöLevñTõrInfo
 },

131 { 
Profûe
::
MAINREXT
, "Maö I¡ø", 8, 
CHROMA_420
, 
åue
 , 
Ál£
, 
OPTIONAL
, 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1500, 10 , 
maöLevñTõrInfo
 },

132 { 
Profûe
::
MAINREXT
, "Maö 10 I¡ø", 10, 
CHROMA_420
, 
åue
 , 
Ál£
, 
OPTIONAL
, 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1000, 1100, 1875, 10 , 
maöLevñTõrInfo
 },

133 { 
Profûe
::
MAINREXT
, "Maö 12 I¡ø", 12, 
CHROMA_420
, 
åue
 , 
Ál£
, 
OPTIONAL
, 
DISABLED
, DISABLED, DISABLED, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1500, 1650, 2250, 10 , 
maöLevñTõrInfo
 },

134 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 10 I¡ø", 10, 
CHROMA_422
, 
åue
 , 
Ál£
, 
OPTIONAL
, 
DISABLED
, DISABLED, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 1667, 1833, 2500, 5 , 
maöLevñTõrInfo
 },

135 { 
Profûe
::
MAINREXT
, "Maö 4:2:2 12 I¡ø", 12, 
CHROMA_422
, 
åue
 , 
Ál£
, 
OPTIONAL
, 
DISABLED
, DISABLED, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

136 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 I¡ø", 8, 
CHROMA_444
, 
åue
 , 
Ál£
, 
OPTIONAL
, OPTIONAL, 
DISABLED
, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

137 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 10 I¡ø", 10, 
CHROMA_444
, 
åue
 , 
Ál£
, 
OPTIONAL
, OPTIONAL, 
DISABLED
, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 2500, 2750, 3750, 5 , 
maöLevñTõrInfo
 },

138 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 12 I¡ø", 12, 
CHROMA_444
, 
åue
 , 
Ál£
, 
OPTIONAL
, OPTIONAL, 
DISABLED
, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 3000, 3300, 4500, 5 , 
maöLevñTõrInfo
 },

139 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 16 I¡ø", 16, 
CHROMA_444
, 
åue
 , 
Ál£
, 
OPTIONAL
, OPTIONAL, OPTIONAL, OPTIONAL, 
DISABLED
, 
HBR_1_OR_2
 , fÆ£, 256, 64, fÆ£, 4000, 4400, 6000, 5 , 
maöLevñTõrInfo
 },

140 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 Stû»Pi˘uª", 8, 
CHROMA_444
, 
åue
 ,Åruê, 
OPTIONAL
, OPTIONAL, 
DISABLED
, OPTIONAL, DISABLED, 
HBR_1_OR_2
 , 
Ál£
, 256, 64,Åruê, 2000, 2200, 3000, 5 , 
maöLevñTõrInfo
 },

141 { 
Profûe
::
MAINREXT
, "Maö 4:4:4 16 Stû»Pi˘uª", 16, 
CHROMA_444
, 
åue
 ,Åruê, 
OPTIONAL
, OPTIONAL, OPTIONAL, OPTIONAL, 
DISABLED
, 
HBR_1_OR_2
 , 
Ál£
, 256, 64,Åruê, 4000, 4400, 6000, 5 , 
maöLevñTõrInfo
 },

142 { 
Profûe
::
HIGHTHROUGHPUTREXT
, "High Throughpuà4:4:4 16 I¡ø", 16, 
CHROMA_444
, 
åue
 , 
Ál£
, 
OPTIONAL
, OPTIONAL, OPTIONAL, OPTIONAL, 
ENABLED
 , 
HBR_12_OR_24
 ,Åruê, 256, 64, fÆ£, 4000, 4400, 6000, 5 , 
maöLevñTõrInfo
 },

143 { 
Profûe
::
NONE
, 0 }

150 
Void


151 
	$checkSPS
(c⁄° 
TComSPS
 &
•s
,

152 c⁄° 
ProfûeLevñTõrFótuªs
 &
„©uªs
)

159 c⁄° 
UI¡
 
möCbSizeY
 = 1<<(
•s
.
	`gëLog2MöCodögBlockSize
());

161 i‡(
•s
.
	`gëPicWidthInLumaSam∂es
(Ë% 
möCbSizeY
 != 0 )

163 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "pi˘uª width (" << 
•s
.
	`gëPicWidthInLumaSam∂es
(Ë<< "Ëmu° bê®mu…ùÀ o‡möCbSizeY (=" << 
möCbSizeY
 << ")\n";

164 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

167 i‡(
•s
.
	`gëPicHeightInLumaSam∂es
(Ë% 
möCbSizeY
 != 0 )

169 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "pi˘uª heighà(" << 
•s
.
	`gëPicHeightInLumaSam∂es
(Ë<< "Ëmu° bê®mu…ùÀ o‡möCbSizeY (=" << 
möCbSizeY
 << ")\n";

170 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

174 i‡(
•s
.
	`gëPicWidthInLumaSam∂es
(Ë> 
„©uªs
.
	`gëLevñTõrFótuªs
()->
	`gëMaxPicWidthInLumaSam∂es
())

176 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "pi˘uª width (" << 
•s
.
	`gëPicWidthInLumaSam∂es
(Ë<< "Ëex˚ed†thêmaximumáŒowed byÅhêÀvñ (" << 
„©uªs
.
	`gëLevñTõrFótuªs
()->
	`gëMaxPicWidthInLumaSam∂es
() << ")\n";

177 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

180 i‡(
•s
.
	`gëPicHeightInLumaSam∂es
(Ë> 
„©uªs
.
	`gëLevñTõrFótuªs
()->
	`gëMaxPicHeightInLumaSam∂es
())

182 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "pi˘uª heighà(" << 
•s
.
	`gëPicHeightInLumaSam∂es
(Ë<< "Ëex˚ed†thêmaximumáŒowed byÅhêÀvñ (" << 
„©uªs
.
	`gëLevñTõrFótuªs
()->
	`gëMaxPicHeightInLumaSam∂es
() << ")\n";

183 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

186 i‡(
•s
.
	`gëPicWidthInLumaSam∂es
(Ë* sps.
	`gëPicHeightInLumaSam∂es
(Ë> 
„©uªs
.
	`gëLevñTõrFótuªs
()->
maxLumaPs
)

188 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "pi˘uª sam∂e†(" << 
•s
.
	`gëPicWidthInLumaSam∂es
(Ë<< " * " << sps.
	`gëPicHeightInLumaSam∂es
(Ë<< "Ëex˚ed†thêmaximumáŒowed byÅhêÀvñ (" << 
„©uªs
.
	`gëLevñTõrFótuªs
()->
maxLumaPs
 << ")\n";

189 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

191 
	}
}

194 
Void


195 
	$checkTûes
(c⁄° 
TComSPS
 &
•s
,

196 c⁄° 
TComPPS
 &
µs
,

197 c⁄° 
TComPic
 &
pic
,

198 c⁄° 
ProfûeLevñTõrFótuªs
 &
„©uªs
)

200 i‡(
µs
.
	`gëTûesE«bÀdFœg
())

203 c⁄° 
I¡
 
möWidthInCtus
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
möTûeCﬁumnWidthInLumaSam∂es
/ 
•s
.
	`gëMaxCUWidth
();

204 c⁄° 
I¡
 
möHeightInCtus
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
möTûeRowHeightInLumaSam∂es
 / 
•s
.
	`gëMaxCUHeight
();

206 c⁄° 
I¡
 
numCﬁs
 = 
µs
.
	`gëNumTûeCﬁumnsMöus1
() + 1;

207 c⁄° 
I¡
 
numRows
 = 
µs
.
	`gëNumTûeRowsMöus1
() + 1;

208 i‡(
numCﬁs
 > 
„©uªs
.
	`gëLevñTõrFótuªs
()->
maxTûeCﬁs
)

210 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "numbî o‡tûêcﬁumn†(" << 
numCﬁs
 << "Ëex˚ed†thêmaximumáŒowed byÅhêÀvñ (" << 
„©uªs
.
	`gëLevñTõrFótuªs
()->
maxTûeCﬁs
 << ")\n";

211 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

213 i‡(
numRows
 > 
„©uªs
.
	`gëLevñTõrFótuªs
()->
maxTûeRows
)

215 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "numbî o‡tûêrow†(" << 
numRows
 << "Ëex˚ed†thêmaximumáŒowed byÅhêÀvñ (" << 
„©uªs
.
	`gëLevñTõrFótuªs
()->
maxTûeRows
 << ")\n";

216 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

219 
I¡
 
row
=0;Ñow < 
numRows
;Ñow++)

221 
I¡
 
cﬁ
=0; cﬁ < 
numCﬁs
; col++)

223 c⁄° 
I¡
 
tûeIdx
 = 
row
 * 
numCﬁs
 + 
cﬁ
;

224 c⁄° 
TComTûe
 &
tûe
 = *(
pic
.
	`gëPicSym
()->
	`gëTComTûe
(
tûeIdx
));

225 i‡(
tûe
.
	`gëTûeWidthInCtus
(Ë< 
möWidthInCtus
)

227 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "width o‡tûê(" << 
cﬁ
 << ", " << 
row
 << "Ëi†toÿ«ºow f‹Åhê¥ofûê-Ñód " << 
tûe
.
	`gëTûeWidthInCtus
()*
•s
.
	`gëMaxCUWidth
(Ë<< "mu° bê" << 
möWidthInCtus
*sps.getMaxCUWidth() << "\n";

228 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

230 i‡(
tûe
.
	`gëTûeHeightInCtus
(Ë< 
möHeightInCtus
)

232 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "heighào‡tûê(" << 
cﬁ
 << ", " << 
row
 << "Ëi†toÿthö f‹Åhê¥ofûê-Ñód " << 
tûe
.
	`gëTûeHeightInCtus
()*
•s
.
	`gëMaxCUHeight
(Ë<< " mu° bê" << 
möHeightInCtus
*sps.getMaxCUHeight() << "\n";

233 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

238 i‡(
µs
.
	`gëE¡r›yCodögSyncE«bÀdFœg
(Ë&& !
„©uªs
.
	`gëProfûeFótuªs
()->
bWave‰⁄tsAndTûesC™BeU£dSimu…™eou¶y
)

240 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
() << "profile doesÇotÖermitÉntropy coding syncándÅilesÅo be simultaneouslyÉnabled\n";

241 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

244 
	}
}

247 
Void


248 
	$checkPPS
(c⁄° 
TComSPS
 &
•s
,

249 c⁄° 
TComPPS
 &
µs
,

250 c⁄° 
TComPic
 &
pic
,

251 c⁄° 
ProfûeLevñTõrFótuªs
 &
„©uªs
)

253 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
I¡
>(
µs
.
	`gëPicInôQPMöus26
(), "öô_qp_möus26", -(
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
)-8)*6-26, 25);

254 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
UI¡
>(
µs
.
	`gëMaxCuDQPDïth
(), "diff_cu_qp_dñè_dïth", 0, 
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
());

255 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
UI¡
>(
µs
.
	`gëLog2P¨ÆÀlMîgeLevñMöus2
(), "log2_∑øŒñ_mîge_Àvñ_möus2", 0, 
•s
.
	`gëLog2MöCodögBlockSize
(Ë+ sps.
	`gëLog2DiffMaxMöCodögBlockSize
() - 2);

257 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
UI¡
>(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_LUMA
), "log2_ßo_off£t_sˇÀ_luma", 0, 
°d
::
	`max
(
•s
.
	`gëBôDïth
(CHANNEL_TYPE_LUMA), 10)-10);

258 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
UI¡
>(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_CHROMA
), "log2_ßo_off£t_sˇÀ_chroma", 0, 
°d
::
	`max
(
•s
.
	`gëBôDïth
(CHANNEL_TYPE_CHROMA), 10)-10);

260 
	`checkTûes
(
•s
, 
µs
, 
pic
, 
„©uªs
);

261 
	}
}

263 #i‡!
DPB_ENCODER_USAGE_CHECK


264 
Void


265 
	gProfûeLevñTõrFótuªs
::
	$a˘iv©e
(c⁄° 
TComSPS
 &
•s
)

267 c⁄° 
ProfûeTõrLevñ
 &
±l
 = *(
•s
.
	`gëPTL
()->
	`gëGíîÆPTL
());

269 
m_tõr
 = 
±l
.
	`gëTõrFœg
();

271 
I¡
 
i
=0; 
vÆidProfûes
[i].
¥ofûe
 !
Profûe
::
NONE
; i++)

273 i‡(
±l
.
	`gëProfûeIdc
(Ë=
vÆidProfûes
[
i
].
¥ofûe
 &&

274 
±l
.
	`gëBôDïthC⁄°øöt
(Ë=
vÆidProfûes
[
i
].
maxBôDïth
 &&

275 
±l
.
	`gëChromaF‹m©C⁄°øöt
(Ë=
vÆidProfûes
[
i
].
maxChromaF‹m©
 &&

276 
±l
.
	`gëI¡øC⁄°øötFœg
(Ë=
vÆidProfûes
[
i
].
gíîÆI¡øC⁄°øötFœg
 &&

277 
±l
.
	`gëO√Pi˘uªO∆yC⁄°øötFœg
(Ë=
vÆidProfûes
[
i
].
gíîÆO√Pi˘uªO∆yC⁄°øötFœg
 )

279 
m_pProfûe
 = &(
vÆidProfûes
[
i
]);

284 i‡(
m_pProfûe
 != 0)

287 c⁄° 
LevñTõrFótuªs
 *
pLTF
 = 
m_pProfûe
->
pLevñTõrsLi°Info
;

288 c⁄° 
Levñ
::
Name
 
•sLevñName
 = 
•s
.
	`gëPTL
()->
	`gëGíîÆPTL
()->
	`gëLevñIdc
();

289 i‡(
•sLevñName
!=
Levñ
::
LEVEL8_5
 || 
m_pProfûe
->
bC™U£Levñ8p5
)

291 
I¡
 
i
=0; 
pLTF
[i].
Àvñ
!=
Levñ
::
NONE
; i++)

293 i‡(
pLTF
[
i
].
Àvñ
 =
•sLevñName
)

295 
m_pLevñTõr
 = &(
pLTF
[
i
]);

302 c⁄° 
UI¡
 
˘bSizeY
 = 
•s
.
	`gëMaxCUWidth
();

303 c⁄° 
UI¡
 
bôDïthY
 = 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
);

304 c⁄° 
UI¡
 
˘bWidthC
 = 
˘bSizeY
 >> 
	`gëCh™√lTy≥SˇÀX
(
CHANNEL_TYPE_CHROMA
, 
•s
.
	`gëChromaF‹m©Idc
());

305 c⁄° 
UI¡
 
˘bHeightC
 = 
˘bSizeY
 >> 
	`gëCh™√lTy≥SˇÀY
(
CHANNEL_TYPE_CHROMA
, 
•s
.
	`gëChromaF‹m©Idc
());

306 c⁄° 
UI¡
 
bôDïthC
 = 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
);

308 c⁄° 
UI¡
 
øwCtuBôs
 = 
˘bSizeY
*˘bSizeY*
bôDïthY
+2*(
˘bWidthC
*
˘bHeightC
)*
bôDïthC
;

309 
m_maxRawCtuBôs
=(
øwCtuBôs
*5)/3;

312 
	}
}

316 
Void


317 
	$checkToﬁAvaûabûôy
(c⁄° 
TComSPS
 &
•s
,

318 c⁄° 
TComPPS
 &
µs
,

319 c⁄° 
ProfûeLevñTõrFótuªs
 &
„©uªs
)

321 #i‡
DPB_ENCODER_USAGE_CHECK


322 c⁄° 
ProfûeFótuªs
::
TRISTATE
 
ªxtToﬁsE«bÀd
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
gíîÆRExtToﬁsE«bÀd
;

323 i‡–
ªxtToﬁsE«bÀd
 !
ProfûeFótuªs
::
OPTIONAL
)

325 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
ªxtToﬁsE«bÀd
 =
ProfûeFótuªs
::
ENABLED
;

327 c⁄° 
TRISTATE
 
ªxtToﬁsE«bÀd
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
gíîÆRExtToﬁsE«bÀd
;

328 i‡–
ªxtToﬁsE«bÀd
 !
OPTIONAL
)

330 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
ªxtToﬁsE«bÀd
 =
ENABLED
;

332 
°d
::
°rög
 
Êags
;

333 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëTønsf‹mSkùRŸ©i⁄E«bÀdFœg
(Ë!
bW™ãdFœgSèã
Ë
Êags
+=",Åransform_skip_rotation_enabled_flag";

334 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëTønsf‹mSkùC⁄ãxtE«bÀdFœg
(Ë!
bW™ãdFœgSèã
Ë
Êags
+=",Åransform_skip_context_enabled_flag";

335 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_IMPLICIT
Ë!
bW™ãdFœgSèã
Ë
Êags
+=", implicit_rdpcm_enabled_flag";

336 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_EXPLICIT
Ë!
bW™ãdFœgSèã
Ë
Êags
+=",Éxplicit_rdpcm_enabled_flag";

337 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëI¡øSmoŸhögDißbÀdFœg
(Ë!
bW™ãdFœgSèã
Ë
Êags
+=", intra_smoothing_disabled_flag";

338 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
(Ë!
bW™ãdFœgSèã
Ë
Êags
+=",Öersistent_rice_adaptation_enabled_flag";

339 #i‡
DPB_ENCODER_USAGE_CHECK


340 i‡(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
(Ë!2 && 
ªxtToﬁsE«bÀd
==
ProfûeFótuªs
::
DISABLED
 ) 
Êags
+=",Üog2_max_transform_skip_block_size_minus2";

342 i‡(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
(Ë!2 && 
ªxtToﬁsE«bÀd
==
DISABLED
 ) 
Êags
+=",Üog2_max_transform_skip_block_size_minus2";

345 i‡(!
Êags
.
	`em±y
())

347 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "thêfﬁlowög fœg†mu°áŒ bê" << (
bW™ãdFœgSèã
 ? "1" : "0"Ë<< " i¿thê¥ofûê'" << 
„©uªs
.
	`gëProfûeFótuªs
()->
pNameSåög
 << "' c⁄f‹m™˚Öoöt: " + 
Êags
.
	`sub°r
(2) + "\n";

348 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

353 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
UI¡
>(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
()-2, "log2_max_å™sf‹m_skù_block_size_möus2", 0, 
•s
.
	`gëQuadåìTULog2MaxSize
()-2);

356 #i‡
DPB_ENCODER_USAGE_CHECK


357 i‡(
„©uªs
.
	`gëProfûeFótuªs
()->
exãndedPªcisi⁄Pro˚ssögFœg
 !
ProfûeFótuªs
::
OPTIONAL
)

359 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
exãndedPªcisi⁄Pro˚ssögFœg
 =
ProfûeFótuªs
::
ENABLED
;

361 i‡(
„©uªs
.
	`gëProfûeFótuªs
()->
exãndedPªcisi⁄Pro˚ssögFœg
 !
OPTIONAL
)

363 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
exãndedPªcisi⁄Pro˚ssögFœg
 =
ENABLED
;

365 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
(Ë!
bW™ãdFœgSèã
)

367 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "exãnded_¥ecisi⁄_¥o˚ssög_Êag mu° bê" << (
bW™ãdFœgSèã
 ? "1" : "0"Ë<< " i¿thê¥ofûê'" << 
„©uªs
.
	`gëProfûeFótuªs
()->
pNameSåög
 << "' conformanceÖoint\n";

368 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

372 #i‡
DPB_ENCODER_USAGE_CHECK


373 i‡(
„©uªs
.
	`gëProfûeFótuªs
()->
chromaQpOff£tLi°E«bÀdFœg
 !
ProfûeFótuªs
::
OPTIONAL
)

375 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
chromaQpOff£tLi°E«bÀdFœg
 =
ProfûeFótuªs
::
ENABLED
;

377 i‡(
„©uªs
.
	`gëProfûeFótuªs
()->
chromaQpOff£tLi°E«bÀdFœg
 !
OPTIONAL
)

379 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
chromaQpOff£tLi°E«bÀdFœg
 =
ENABLED
;

381 i‡(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°E«bÀdFœg
(Ë!
bW™ãdFœgSèã
)

383 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "chroma_qp_off£t_li°_íabÀd_Êag mu° bê" << (
bW™ãdFœgSèã
 ? "1" : "0"Ë<< " i¿thê¥ofûê'" << 
„©uªs
.
	`gëProfûeFótuªs
()->
pNameSåög
 << "' conformanceÖoint\n";

384 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

387 i‡(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°E«bÀdFœg
())

389 
TDecC⁄f‹m™˚Check
::
checkR™ge
<
UI¡
>(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëDiffCuChromaQpOff£tDïth
(), "diff_cu_chroma_qp_off£t_dïth", 0, 
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
());

392 #i‡
DPB_ENCODER_USAGE_CHECK


393 i‡(
„©uªs
.
	`gëProfûeFótuªs
()->
ˇbacBy∑ssAlignmítE«bÀdFœg
 !
ProfûeFótuªs
::
OPTIONAL
)

395 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
ˇbacBy∑ssAlignmítE«bÀdFœg
 =
ProfûeFótuªs
::
ENABLED
;

397 i‡(
„©uªs
.
	`gëProfûeFótuªs
()->
ˇbacBy∑ssAlignmítE«bÀdFœg
 !
OPTIONAL
)

399 c⁄° 
Boﬁ
 
bW™ãdFœgSèã
 = 
„©uªs
.
	`gëProfûeFótuªs
()->
ˇbacBy∑ssAlignmítE«bÀdFœg
 =
ENABLED
;

401 i‡(
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëCabacBy∑ssAlignmítE«bÀdFœg
(Ë!
bW™ãdFœgSèã
)

403 
TDecC⁄f‹m™˚Check
::
	`gëSåóm
(Ë<< "ˇbac_by∑ss_Æignmít_íabÀd_Êag mu° bê" << (
bW™ãdFœgSèã
 ? "1" : "0"Ë<< " i¿thê¥ofûê'" << 
„©uªs
.
	`gëProfûeFótuªs
()->
pNameSåög
 << "' conformanceÖoint\n";

404 
TDecC⁄f‹m™˚Check
::
	`föishW¨nögRï‹t
();

407 
	}
}

410 
Void


411 
	gTDecC⁄f‹m™˚Check
::
	$checkSli˚A˘iv©i⁄
(c⁄° 
TComSli˚
 &
¶i˚
,

412 c⁄° 
I≈utNALUnô
 &
«lu
,

413 c⁄° 
TComPic
 &
pic
,

414 c⁄° 
Boﬁ
 
bFú°Sli˚InSåóm
,

415 c⁄° 
Boﬁ
 
bFú°Sli˚InSequí˚
,

416 c⁄° 
Boﬁ
 
bFú°Sli˚InPi˘uª
)

418 c⁄° 
TComSPS
 &
•s
=*(
¶i˚
.
	`gëSPS
());

419 c⁄° 
TComPPS
 &
µs
=*(
¶i˚
.
	`gëPPS
());

421 i‡(!
	`doCheckög
()) ;

423 
m_a˘iv©edFótuªs
.
	`a˘iv©e
(
•s
);

425 i‡(
m_a˘iv©edFótuªs
.
	`gëProfûeFótuªs
(Ë=0 || m_a˘iv©edFótuªs.
	`gëLevñTõrFótuªs
() == 0)

427 i‡(
m_a˘iv©edFótuªs
.
	`gëProfûeFótuªs
() == 0)

429 
	`gëSåóm
() << "UnknownÖrofile/constraint flag combination discovered\n";

433 
	`gëSåóm
() << "UnknownÜevel IDC discovered\n";

435 
	`föishW¨nögRï‹t
();

440 
	`checkSPS
(
•s
, 
m_a˘iv©edFótuªs
);

441 
	`checkPPS
(
•s
, 
µs
, 
pic
, 
m_a˘iv©edFótuªs
);

442 
	`checkToﬁAvaûabûôy
(
•s
, 
µs
, 
m_a˘iv©edFótuªs
);

444 i‡(
m_a˘iv©edFótuªs
.
	`gëProfûeFótuªs
()->
	`⁄lyIRAPPi˘uªs
(Ë&& (
«lu
.
m_«lUnôTy≥
 < 
NAL_UNIT_CODED_SLICE_BLA_W_LP
 ||ÇÆu.m_«lUnôTy≥> 
NAL_UNIT_RESERVED_IRAP_VCL23
))

446 
	`gëSåóm
() << "Bad NALU forán intra constrainedÖrofile\n";

447 
	`föishW¨nögRï‹t
();

450 i‡(
bFú°Sli˚InSåóm
 || 
bFú°Sli˚InSequí˚
 || 
bFú°Sli˚InPi˘uª
)

452 
m_numbîOfSli˚sInPi˘uª
=1;

453 
m_byãsInPi˘uª
=0;

457 
m_numbîOfSli˚sInPi˘uª
++;

458 i‡(
m_numbîOfSli˚sInPi˘uª
 > 
m_a˘iv©edFótuªs
.
	`gëLevñTõrFótuªs
()->
maxSli˚SegmítsPîPi˘uª
)

460 
	`gëSåóm
() << "Too many slice segments inÅheÖicture\n";

461 
	`föishW¨nögRï‹t
();

466 
m_byãsInPi˘uª
+=
«lu
.
	`gëBô°ªam
().
	`gëFifo
().
	`size
();

467 i‡(
m_byãsInPi˘uª
*8 > 
m_a˘iv©edFótuªs
.
	`gëCpbSizeInBôs
())

469 
	`gëSåóm
() << "Entireáccess unit must fit withinÅhe CPBÉven if split into multiple decoding units (section C.2.2 Timing of decoding unitárrival)\n";

470 
	`föishW¨nögRï‹t
();

473 
	}
}

476 
Void


477 
	gTDecC⁄f‹m™˚Check
::
	$checkCtuDecodög
(c⁄° 
UI¡
 
numU£dBôs
)

479 i‡(
numU£dBôs
 > 
m_a˘iv©edFótuªs
.
	`gëMaxRawCtuBôs
())

481 
	`gëSåóm
() << "CTUÉxceeds maximum RAW CTU bitsÜimits.\n";

482 
	`föishW¨nögRï‹t
();

484 
	}
}

	@TLibDecoder/TDecConformance.h

38 #i‚de‡
__TDECCONFORMANCE__


39 
	#__TDECCONFORMANCE__


	)

42 #i‚de‡
DECODER_PARTIAL_CONFORMANCE_CHECK


43 
	#DECODER_PARTIAL_CONFORMANCE_CHECK
 0

45 

	)

48 #i‡
_MSC_VER
 > 1000

49 #¥agm®
⁄˚


52 
	~"TLibComm⁄/Comm⁄Def.h
"

53 #i‡
DPB_ENCODER_USAGE_CHECK


54 
	~"TLibComm⁄/ProfûeLevñTõrFótuªs.h
"

56 
	~<°dio.h
>

57 
	~<io°ªam
>

58 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 == 2

59 
	~<°dlib.h
>

64 
˛ass
 
	gTComSli˚
;

65 #i‡!
DPB_ENCODER_USAGE_CHECK


66 
˛ass
 
	gTComSPS
;

67 
˛ass
 
	gTComPPS
;

69 
˛ass
 
	gI≈utNALUnô
;

70 
˛ass
 
	gTComPTL
;

71 
˛ass
 
	gTComPic
;

73 #i‡!
DPB_ENCODER_USAGE_CHECK


74 
	eTRISTATE


76 
	mDISABLED
=0,

77 
	mOPTIONAL
=1,

78 
	mENABLED
=2

79 } 
	tTRISTATE
;

82 
	eHBRFACTOREQN


84 
	mHBR_1
 = 0,

85 
	mHBR_1_OR_2
 = 1,

86 
	mHBR_12_OR_24
 = 2

87 } 
	tHBRFACTOREQN
;

90 
	sLevñTõrFótuªs


92 
	mLevñ
::
Name
 
Àvñ
;

93 
UI¡
 
	mmaxLumaPs
;

94 
UI¡
 
	mmaxCpb
[
Levñ
::
NUMBER_OF_TIERS
];

95 
UI¡
 
	mmaxSli˚SegmítsPîPi˘uª
;

96 
UI¡
 
	mmaxTûeRows
;

97 
UI¡
 
	mmaxTûeCﬁs
;

98 
UI¡64
 
	mmaxLumaSr
;

99 
UI¡
 
	mmaxBr
[
Levñ
::
NUMBER_OF_TIERS
];

100 
UI¡
 
	mmöCrBa£
[
Levñ
::
NUMBER_OF_TIERS
];

101 
UI¡
 
gëMaxPicWidthInLumaSam∂es
() const;

102 
UI¡
 
gëMaxPicHeightInLumaSam∂es
() const;

106 
	sProfûeFótuªs


108 
	mProfûe
::
Name
 
¥ofûe
;

109 c⁄° 
TCh¨
 *
	mpNameSåög
;

110 
UI¡
 
	mmaxBôDïth
;

111 
ChromaF‹m©
 
	mmaxChromaF‹m©
;

112 
Boﬁ
 
	mgíîÆI¡øC⁄°øötFœg
;

113 
Boﬁ
 
	mgíîÆO√Pi˘uªO∆yC⁄°øötFœg
;

114 
TRISTATE
 
	mgíîÆLowîBôR©eC⁄°øöt
;

115 
TRISTATE
 
	mgíîÆRExtToﬁsE«bÀd
;

116 
TRISTATE
 
	mexãndedPªcisi⁄Pro˚ssögFœg
;

117 
TRISTATE
 
	mchromaQpOff£tLi°E«bÀdFœg
;

118 
TRISTATE
 
	mˇbacBy∑ssAlignmítE«bÀdFœg
;

119 
HBRFACTOREQN
 
	mhbrFa˘‹Eqn
;

120 
Boﬁ
 
	mbWave‰⁄tsAndTûesC™BeU£dSimu…™eou¶y
;

122 
UI¡
 
	mmöTûeCﬁumnWidthInLumaSam∂es
;

123 
UI¡
 
	mmöTûeRowHeightInLumaSam∂es
;

124 
Boﬁ
 
	mbC™U£Levñ8p5
;

125 
UI¡
 
	m˝bV˛Fa˘‹
;

126 
UI¡
 
	m˝bNÆFa˘‹
;

127 
UI¡
 
	mf‹m©C≠abûôyFa˘‹x1000
;

128 
UI¡
 
	mmöCrSˇÀFa˘‹x10
;

129 c⁄° 
LevñTõrFótuªs
 *
	mpLevñTõrsLi°Info
;

131 
Boﬁ
 
chromaF‹m©VÆid
(
ChromaF‹m©
 
chFmt
Ëc⁄° {  (
	m¥ofûe
 =
Profûe
::
MAINREXT
 || 
¥ofûe
 =Profûe::
HIGHTHROUGHPUTREXT
Ë? chFmt<=
maxChromaF‹m©
 : (chFmt == maxChromaFormat ); }

132 
Boﬁ
 
⁄lyIRAPPi˘uªs
(Ëc⁄° {  
	mgíîÆI¡øC⁄°øötFœg
; }

133 
UI¡
 
gëHbrFa˘‹
(
Boﬁ
 
bLowîBôR©eC⁄°øötFœg
) const

135  
	mhbrFa˘‹Eqn
==
HBR_1_OR_2
 ? (2-(
bLowîBôR©eC⁄°øötFœg
?1:0)) :

136 (
hbrFa˘‹Eqn
==
HBR_12_OR_24
 ? 12*(2-(
bLowîBôR©eC⁄°øötFœg
?1:0)) :

142 ˛as†
	cProfûeLevñTõrFótuªs


144 
	m¥iv©e
:

145 c⁄° 
ProfûeFótuªs
 *
m_pProfûe
;

146 c⁄° 
LevñTõrFótuªs
 *
	mm_pLevñTõr
;

147 
UI¡
 
	mm_hbrFa˘‹
;

148 
	mLevñ
::
Tõr
 
m_tõr
;

149 
UI¡
 
	mm_maxRawCtuBôs
;

150 
	mpublic
:

151 
	$ProfûeLevñTõrFótuªs
(Ë: 
	`m_pProfûe
(0), 
	`m_pLevñTõr
(0), 
	`m_hbrFa˘‹
(0), 
	`m_tõr
(
Levñ
::
MAIN
), 
	$m_maxRawCtuBôs
(0) { }

153 
Void
 
	`a˘iv©e
(c⁄° 
TComSPS
 &
•s
);

155 c⁄° 
ProfûeFótuªs
 *
	$gëProfûeFótuªs
(Ëc⁄° {  
m_pProfûe
; 
	}
}

156 c⁄° 
LevñTõrFótuªs
 *
	$gëLevñTõrFótuªs
(Ëc⁄° {  
m_pLevñTõr
; 
	}
}

157 
	gLevñ
::
Tõr
 
	$gëTõr
(Ëc⁄° {  
m_tõr
; 
	}
}

158 
UI¡64
 
	$gëCpbSizeInBôs
(Ëc⁄° {  (
m_pLevñTõr
!=0 && 
m_pProfûe
!=0Ë? 
	`UI¡64
(m_pProfûe->
˝bV˛Fa˘‹
Ë* m_pLevñTõr->
maxCpb
[
m_tõr
?1:0] : UI¡64(0); 
	}
}

159 
DoubÀ
 
	$gëMöCr
(Ëc⁄° {  (
m_pLevñTõr
!=0 && 
m_pProfûe
!=0Ë? (m_pProfûe->
möCrSˇÀFa˘‹x10
 * m_pLevñTõr->
möCrBa£
[
m_tõr
?1:0])/10.0 : 0.0 ; 
	}
}

160 
UI¡
 
	$gëMaxRawCtuBôs
(Ëc⁄° {  
m_maxRawCtuBôs
; 
	}
}

165 ˛as†
	cTDecC⁄f‹m™˚Check


167 
	m¥iv©e
:

168 #i‡
MCTS_ENC_CHECK


169 
Boﬁ
 
m_tm˘sCheckE«bÀd
;

171 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK


172 
UI¡
 
	mm_numbîOfSli˚sInPi˘uª
;

173 
UI¡64
 
	mm_byãsInPi˘uª
;

175 
ProfûeLevñTõrFótuªs
 
	mm_a˘iv©edFótuªs
;

177 
	mpublic
:

181 
ölöe
 
Boﬁ
 
	$doCheckög
()

183  
DECODER_PARTIAL_CONFORMANCE_CHECK
 != 0;

186 
UI¡
 
	`gëMöLog2CtbSize
(c⁄° 
TComPTL
 &
±l
, UI¡ 
œyîPlus1
=0);

187 
UI¡
 
	`gëMaxLog2CtbSize
(c⁄° 
TComPTL
 &
±l
, UI¡ 
œyîPlus1
=0);

190 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 == 0

191 
ölöe
 
°d
::
o°ªam
 &
	$gëSåóm
(Ë{  
°d
::
cout
; 
	}
}

193 
ölöe
 
Void
 
	$föishW¨nögRï‹t
(Ë{ 
	}
}

195 
	gãm∂©e
 <
˛ass
 
	gT
>

196 
Void
 
	$checkR™ge
(c⁄° 
T
& , c⁄° 
TCh¨
 *, c⁄° T& , c⁄° T& ) { 
	}
}

201 
ölöe
 
	g°d
::
o°ªam
 &
	$gëSåóm
()

203 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 == 1

204 
°d
::
cout
 << "WARNING: Conformance failure - ";

205  
°d
::
cout
;

207 
°d
::
˚º
 << "ERROR: Conformance failure - ";

208  
°d
::
˚º
;

210 
	}
}

212 
ölöe
 
Void
 
	$föishW¨nögRï‹t
()

214 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 == 2

215 
	`exô
(1);

217 
	}
}

219 
	gãm∂©e
 <
˛ass
 
	gT
>

220 
Void
 
	$checkR™ge
(c⁄° 
T
& 
vÆ
, c⁄° 
TCh¨
 *
«me
, c⁄° T& 
möVÆIn˛usive
, c⁄° T& 
maxVÆIn˛usive
)

222 i‡(
vÆ
<
möVÆIn˛usive
 || vÆ>
maxVÆIn˛usive
)

224 
	`gëSåóm
(Ë<< 
«me
 << " mu° bêöÅhêøngêo‡" << 
möVÆIn˛usive
 << "Åÿ" << 
maxVÆIn˛usive
 << " (ö˛usiveË- decoded vÆuêo‡" << 
vÆ
 << "\n";

225 
	`föishW¨nögRï‹t
();

227 
	}
}

234 
TDecC⁄f‹m™˚Check
();

236 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 == 0

237 
Void


238 
	$checkSli˚A˘iv©i⁄
(c⁄° 
TComSli˚
 & ,

239 c⁄° 
I≈utNALUnô
 & ,

240 c⁄° 
TComPic
 & ,

241 c⁄° 
Boﬁ
 ,

242 c⁄° 
Boﬁ
 ,

243 c⁄° 
Boﬁ
 ) { 
	}
}

245 
Void


246 
	$checkCtuDecodög
(c⁄° 
UI¡
 
numU£dBôs
Ë{ 
	}
}

248 
Void


249 
checkSli˚A˘iv©i⁄
(c⁄° 
TComSli˚
 &
¶i˚
,

250 c⁄° 
I≈utNALUnô
 &
«lu
,

251 c⁄° 
TComPic
 &
pic
,

252 c⁄° 
Boﬁ
 
bFú°Sli˚InSåóm
,

253 c⁄° 
Boﬁ
 
bFú°Sli˚InSequí˚
,

254 c⁄° 
Boﬁ
 
bFú°Sli˚InPi˘uª
);

256 
Void


257 
checkCtuDecodög
(c⁄° 
UI¡
 
numU£dBôs
);

260 #i‡
MCTS_ENC_CHECK


261 
Void
 
	$íabÀTM˘sCheck
(
Boﬁ
 
íabÀd
Ë{ 
m_tm˘sCheckE«bÀd
 =É«bÀd; 
	}
};

262 
Boﬁ
 
	$gëTM˘sCheck
(Ëc⁄° {  
m_tm˘sCheckE«bÀd
; 
	}
}

263 
Void
 
	$ÊagTM˘sEº‹
(c⁄° *
îr‹
)

265 
	`Ârötf
(
°dîr
, "TMCTS checkÉº‹: %s\n", 
îr‹
);

266 
	}
}

	@TLibDecoder/TDecCu.cpp

38 
	~"TDecCu.h
"

39 
	~"TLibComm⁄/TComTU.h
"

40 
	~"TLibComm⁄/TComPªdi˘i⁄.h
"

49 
	gTDecCu
::
	$TDecCu
()

51 
m_µcYuvResi
 = 
NULL
;

52 
m_µcYuvReco
 = 
NULL
;

53 
m_µcCU
 = 
NULL
;

54 
	}
}

56 
	gTDecCu
::~
	$TDecCu
()

58 
	}
}

60 #i‡
MCTS_ENC_CHECK


61 
Void
 
TDecCu
::
	$öô
–
TDecE¡r›y
* 
pcE¡r›yDecodî
, 
TComTrQu™t
* 
pcTrQu™t
, 
TComPªdi˘i⁄
* 
pcPªdi˘i⁄
, 
TDecC⁄f‹m™˚Check
* 
pC⁄f‹m™˚Check
)

63 
Void
 
TDecCu
::
	$öô
(
TDecE¡r›y
* 
pcE¡r›yDecodî
, 
TComTrQu™t
* 
pcTrQu™t
, 
TComPªdi˘i⁄
* 
pcPªdi˘i⁄
)

66 
m_pcE¡r›yDecodî
 = 
pcE¡r›yDecodî
;

67 
m_pcTrQu™t
 = 
pcTrQu™t
;

68 
m_pcPªdi˘i⁄
 = 
pcPªdi˘i⁄
;

69 #i‡
MCTS_ENC_CHECK


70 
m_pC⁄f‹m™˚Check
 = 
pC⁄f‹m™˚Check
;

72 
	}
}

80 
Void
 
	gTDecCu
::
	$¸óã
–
UI¡
 
uiMaxDïth
, UI¡ 
uiMaxWidth
, UI¡ 
uiMaxHeight
, 
ChromaF‹m©
 
chromaF‹m©IDC
 )

82 
m_uiMaxDïth
 = 
uiMaxDïth
+1;

84 
m_µcYuvResi
 = 
√w
 
TComYuv
*[
m_uiMaxDïth
-1];

85 
m_µcYuvReco
 = 
√w
 
TComYuv
*[
m_uiMaxDïth
-1];

86 
m_µcCU
 = 
√w
 
TComD©aCU
*[
m_uiMaxDïth
-1];

88  
UI¡
 
ui
 = 0; uò< 
m_uiMaxDïth
-1; ui++ )

90 
UI¡
 
uiNumP¨tôi⁄s
 = 1<<––
m_uiMaxDïth
 - 
ui
 - 1 )<<1 );

91 
UI¡
 
uiWidth
 = 
uiMaxWidth
 >> 
ui
;

92 
UI¡
 
uiHeight
 = 
uiMaxHeight
 >> 
ui
;

102 
m_µcYuvResi
[
ui
] = 
√w
 
TComYuv
; m_µcYuvResi[ui]->
	`¸óã
–
uiWidth
, 
uiHeight
, 
chromaF‹m©IDC
 );

103 
m_µcYuvReco
[
ui
] = 
√w
 
TComYuv
; m_µcYuvReco[ui]->
	`¸óã
–
uiWidth
, 
uiHeight
, 
chromaF‹m©IDC
 );

104 
m_µcCU
 [
ui
] = 
√w
 
TComD©aCU
; m_µcCU [ui]->
	`¸óã
–
chromaF‹m©IDC
, 
uiNumP¨tôi⁄s
, 
uiWidth
, 
uiHeight
, 
åue
, 
uiMaxWidth
 >> (
m_uiMaxDïth
 - 1) );

107 
m_bDecodeDQP
 = 
Ál£
;

108 
m_IsChromaQpAdjCoded
 = 
Ál£
;

111 
UI¡
* 
piTmp
 = &
g_auiZsˇnToRa°î
[0];

112 
	`öôZsˇnToRa°î
(
m_uiMaxDïth
, 1, 0, 
piTmp
);

113 
	`öôRa°îToZsˇn
–
uiMaxWidth
, 
uiMaxHeight
, 
m_uiMaxDïth
 );

116 
	`öôRa°îToPñXY
–
uiMaxWidth
, 
uiMaxHeight
, 
m_uiMaxDïth
 );

117 
	}
}

119 
Void
 
	gTDecCu
::
	$de°roy
()

121  
UI¡
 
ui
 = 0; uò< 
m_uiMaxDïth
-1; ui++ )

123 
m_µcYuvResi
[
ui
]->
	`de°roy
(); 
dñëe
 m_µcYuvResi[ui]; m_µcYuvResi[ui] = 
NULL
;

124 
m_µcYuvReco
[
ui
]->
	`de°roy
(); 
dñëe
 m_µcYuvReco[ui]; m_µcYuvReco[ui] = 
NULL
;

125 
m_µcCU
 [
ui
]->
	`de°roy
(); 
dñëe
 m_µcCU [ui]; m_µcCU [ui] = 
NULL
;

128 
dñëe
 [] 
m_µcYuvResi
; m_µcYuvResò
NULL
;

129 
dñëe
 [] 
m_µcYuvReco
; m_µcYuvRecÿ
NULL
;

130 
dñëe
 [] 
m_µcCU
 ; m_µcCU = 
NULL
;

131 
	}
}

142 
Void
 
	gTDecCu
::
	$decodeCtu
–
TComD©aCU
* 
pCtu
, 
Boﬁ
& 
isLa°CtuOfSli˚Segmít
 )

144 i‡–
pCtu
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£DQP
() )

146 
	`£tdQPFœg
(
åue
);

149 i‡–
pCtu
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
() )

151 
	`£tIsChromaQpAdjCoded
(
åue
);

155 
	`xDecodeCU
–
pCtu
, 0, 0, 
isLa°CtuOfSli˚Segmít
);

156 
	}
}

162 
Void
 
	gTDecCu
::
	$decom¥essCtu
–
TComD©aCU
* 
pCtu
 )

164 
	`xDecom¥essCU
–
pCtu
, 0, 0 );

165 
	}
}

172 
Boﬁ
 
	gTDecCu
::
	$xDecodeSli˚End
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

174 
UI¡
 
uiIsLa°CtuOfSli˚Segmít
;

176 i‡(
pcCU
->
	`isLa°SubCUOfCtu
(
uiAbsP¨tIdx
))

178 
m_pcE¡r›yDecodî
->
	`decodeTîmö©ögBô
–
uiIsLa°CtuOfSli˚Segmít
 );

182 
uiIsLa°CtuOfSli˚Segmít
=0;

185  
uiIsLa°CtuOfSli˚Segmít
>0;

186 
	}
}

189 
Void
 
	gTDecCu
::
	$xDecodeCU
–
TComD©aCU
*c⁄° 
pcCU
, c⁄° 
UI¡
 
uiAbsP¨tIdx
, c⁄° UI¡ 
uiDïth
, 
Boﬁ
 &
isLa°CtuOfSli˚Segmít
)

191 
TComPic
* 
pcPic
 = 
pcCU
->
	`gëPic
();

192 c⁄° 
TComSPS
 &
•s
 = 
pcPic
->
	`gëPicSym
()->
	`gëSPS
();

193 c⁄° 
TComPPS
 &
µs
 = 
pcPic
->
	`gëPicSym
()->
	`gëPPS
();

194 c⁄° 
UI¡
 
maxCuWidth
 = 
•s
.
	`gëMaxCUWidth
();

195 c⁄° 
UI¡
 
maxCuHeight

•s
.
	`gëMaxCUHeight
();

196 
UI¡
 
uiCurNumP¨ts
 = 
pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
<<1);

197 
UI¡
 
uiQNumP¨ts
 = 
uiCurNumP¨ts
>>2;

200 
Boﬁ
 
bBound¨y
 = 
Ál£
;

201 
UI¡
 
uiLPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

202 
UI¡
 
uiRPñX
 = 
uiLPñX
 + (
maxCuWidth
>>
uiDïth
) - 1;

203 
UI¡
 
uiTPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

204 
UI¡
 
uiBPñY
 = 
uiTPñY
 + (
maxCuHeight
>>
uiDïth
) - 1;

206 if––
uiRPñX
 < 
•s
.
	`gëPicWidthInLumaSam∂es
(ËË&& ( 
uiBPñY
 < sps.
	`gëPicHeightInLumaSam∂es
() ) )

208 
m_pcE¡r›yDecodî
->
	`decodeS∂ôFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

212 
bBound¨y
 = 
åue
;

214 if–––
uiDïth
 < 
pcCU
->
	`gëDïth
–
uiAbsP¨tIdx
 ) ) && ( uiDïth < 
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
(ËËË|| 
bBound¨y
 )

216 
UI¡
 
uiIdx
 = 
uiAbsP¨tIdx
;

217 if–
uiDïth
 =
µs
.
	`gëMaxCuDQPDïth
(Ë&&Öps.
	`gëU£DQP
())

219 
	`£tdQPFœg
(
åue
);

220 
pcCU
->
	`£tQPSubP¨ts
–pcCU->
	`gëRefQP
(
uiAbsP¨tIdx
), uiAbsP¨tIdx, 
uiDïth
 );

223 if–
uiDïth
 =
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëDiffCuChromaQpOff£tDïth
(Ë&& 
pcCU
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
() )

225 
	`£tIsChromaQpAdjCoded
(
åue
);

228  
UI¡
 
uiP¨tUnôIdx
 = 0; uiPartUnitIdx < 4; uiPartUnitIdx++ )

230 
uiLPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiIdx
] ];

231 
uiTPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiIdx
] ];

233 i‡–!
isLa°CtuOfSli˚Segmít
 && ( 
uiLPñX
 < 
•s
.
	`gëPicWidthInLumaSam∂es
(ËË&& ( 
uiTPñY
 < sps.
	`gëPicHeightInLumaSam∂es
() ) )

235 
	`xDecodeCU
–
pcCU
, 
uiIdx
, 
uiDïth
+1, 
isLa°CtuOfSli˚Segmít
 );

239 
pcCU
->
	`£tOutsideCUP¨t
–
uiIdx
, 
uiDïth
+1 );

242 
uiIdx
 +
uiQNumP¨ts
;

244 if–
uiDïth
 =
µs
.
	`gëMaxCuDQPDïth
(Ë&&Öps.
	`gëU£DQP
())

246 i‡–
	`gëdQPFœg
() )

248 
UI¡
 
uiQPSrcP¨tIdx
 = 
uiAbsP¨tIdx
;

249 
pcCU
->
	`£tQPSubP¨ts
–pcCU->
	`gëRefQP
–
uiQPSrcP¨tIdx
 ), 
uiAbsP¨tIdx
, 
uiDïth
 );

255 if–
uiDïth
 <
µs
.
	`gëMaxCuDQPDïth
(Ë&&Öps.
	`gëU£DQP
())

257 
	`£tdQPFœg
(
åue
);

258 
pcCU
->
	`£tQPSubP¨ts
–pcCU->
	`gëRefQP
(
uiAbsP¨tIdx
), uiAbsP¨tIdx, 
uiDïth
 );

261 if–
uiDïth
 <
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëDiffCuChromaQpOff£tDïth
(Ë&& 
pcCU
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
() )

263 
	`£tIsChromaQpAdjCoded
(
åue
);

266 i‡(
µs
.
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

268 
m_pcE¡r›yDecodî
->
	`decodeCUTønsqu™tBy∑ssFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

272 if–!
pcCU
->
	`gëSli˚
()->
	`isI¡ø
())

274 
m_pcE¡r›yDecodî
->
	`decodeSkùFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

278 if–
pcCU
->
	`isSkù≥d
(
uiAbsP¨tIdx
) )

280 
m_µcCU
[
uiDïth
]->
	`c›yI¡îPªdInfoFrom
–
pcCU
, 
uiAbsP¨tIdx
, 
REF_PIC_LIST_0
 );

281 
m_µcCU
[
uiDïth
]->
	`c›yI¡îPªdInfoFrom
–
pcCU
, 
uiAbsP¨tIdx
, 
REF_PIC_LIST_1
 );

282 
TComMvFõld
 
cMvFõldNeighbours
[
MRG_MAX_NUM_CANDS
 << 1];

283 
UCh¨
 
uhI¡îDúNeighbours
[
MRG_MAX_NUM_CANDS
];

284 
I¡
 
numVÆidMîgeC™d
 = 0;

285  
UI¡
 
ui
 = 0; uò< 
m_µcCU
[
uiDïth
]->
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
(); ++ui )

287 
uhI¡îDúNeighbours
[
ui
] = 0;

289 
m_pcE¡r›yDecodî
->
	`decodeMîgeIndex
–
pcCU
, 0, 
uiAbsP¨tIdx
, 
uiDïth
 );

290 
UI¡
 
uiMîgeIndex
 = 
pcCU
->
	`gëMîgeIndex
(
uiAbsP¨tIdx
);

291 #i‡
MCTS_ENC_CHECK


292 
UI¡
 
numS∑tülMîgeC™did©es
 = 0;

293 
m_µcCU
[
uiDïth
]->
	`gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
numS∑tülMîgeC™did©es
, 
uiMîgeIndex
 );

294 i‡–
m_pC⁄f‹m™˚Check
->
	`gëTM˘sCheck
(Ë&& 
m_µcCU
[
uiDïth
]->
	`isLa°CﬁumnCTUInTûe
(Ë&& (
uiMîgeIndex
 >
numS∑tülMîgeC™did©es
) )

296 
m_pC⁄f‹m™˚Check
->
	`ÊagTM˘sEº‹
("Merge Index usingÇon-spatial merge candidate (Skip)");

299 
m_µcCU
[
uiDïth
]->
	`gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
uiMîgeIndex
 );

301 
pcCU
->
	`£tI¡îDúSubP¨ts
–
uhI¡îDúNeighbours
[
uiMîgeIndex
], 
uiAbsP¨tIdx
, 0, 
uiDïth
 );

303 
TComMv
 
	`cTmpMv
( 0, 0 );

304  
UI¡
 
uiRefLi°Idx
 = 0; uiRefListIdx < 2; uiRefListIdx++ )

306 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
	`RefPicLi°
–
uiRefLi°Idx
 ) ) > 0 )

308 
pcCU
->
	`£tMVPIdxSubP¨ts
–0, 
	`RefPicLi°
–
uiRefLi°Idx
 ), 
uiAbsP¨tIdx
, 0, 
uiDïth
);

309 
pcCU
->
	`£tMVPNumSubP¨ts
–0, 
	`RefPicLi°
–
uiRefLi°Idx
 ), 
uiAbsP¨tIdx
, 0, 
uiDïth
);

310 
pcCU
->
	`gëCUMvFõld
–
	`RefPicLi°
–
uiRefLi°Idx
 ) )->
	`£tAŒMvd
–
cTmpMv
, 
SIZE_2Nx2N
, 
uiAbsP¨tIdx
, 
uiDïth
 );

311 
pcCU
->
	`gëCUMvFõld
–
	`RefPicLi°
–
uiRefLi°Idx
 ) )->
	`£tAŒMvFõld
–
cMvFõldNeighbours
[ 2*
uiMîgeIndex
 + uiRefLi°Idx ], 
SIZE_2Nx2N
, 
uiAbsP¨tIdx
, 
uiDïth
 );

314 
	`xFöishDecodeCU
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
isLa°CtuOfSli˚Segmít
 );

318 
m_pcE¡r›yDecodî
->
	`decodePªdMode
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

319 
m_pcE¡r›yDecodî
->
	`decodeP¨tSize
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

321 i‡(
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) &&ÖcCU->
	`gëP¨tôi⁄Size
–uiAbsP¨tIdx ) =
SIZE_2Nx2N
 )

323 
m_pcE¡r›yDecodî
->
	`decodeIPCMInfo
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

325 if(
pcCU
->
	`gëIPCMFœg
(
uiAbsP¨tIdx
))

327 
	`xFöishDecodeCU
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
isLa°CtuOfSli˚Segmít
 );

333 
m_pcE¡r›yDecodî
->
	`decodePªdInfo
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
m_µcCU
[uiDepth]);

336 
Boﬁ
 
bCodeDQP
 = 
	`gëdQPFœg
();

337 
Boﬁ
 
isChromaQpAdjCoded
 = 
	`gëIsChromaQpAdjCoded
();

338 
m_pcE¡r›yDecodî
->
	`decodeC€ff
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
bCodeDQP
, 
isChromaQpAdjCoded
 );

339 
	`£tIsChromaQpAdjCoded
–
isChromaQpAdjCoded
 );

340 
	`£tdQPFœg
–
bCodeDQP
 );

341 
	`xFöishDecodeCU
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
isLa°CtuOfSli˚Segmít
 );

342 
	}
}

344 
Void
 
	gTDecCu
::
	$xFöishDecodeCU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
 &
isLa°CtuOfSli˚Segmít
)

346 if–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£DQP
())

348 
pcCU
->
	`£tQPSubP¨ts
–
	`gëdQPFœg
()?pcCU->
	`gëRefQP
(
uiAbsP¨tIdx
):pcCU->
	`gëCodedQP
(), uiAbsP¨tIdx, 
uiDïth
 );

351 i‡(
pcCU
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
(Ë&& !
	`gëIsChromaQpAdjCoded
())

353 
pcCU
->
	`£tChromaQpAdjSubP¨ts
–pcCU->
	`gëCodedChromaQpAdj
(), 
uiAbsP¨tIdx
, 
uiDïth
 );

356 
isLa°CtuOfSli˚Segmít
 = 
	`xDecodeSli˚End
–
pcCU
, 
uiAbsP¨tIdx
 );

357 
	}
}

359 
Void
 
	gTDecCu
::
	$xDecom¥essCU
–
TComD©aCU
* 
pCtu
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

361 
TComPic
* 
pcPic
 = 
pCtu
->
	`gëPic
();

362 
TComSli˚
 * 
pcSli˚
 = 
pCtu
->
	`gëSli˚
();

363 c⁄° 
TComSPS
 &
•s
=*(
pcSli˚
->
	`gëSPS
());

365 
Boﬁ
 
bBound¨y
 = 
Ál£
;

366 
UI¡
 
uiLPñX
 = 
pCtu
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

367 
UI¡
 
uiRPñX
 = 
uiLPñX
 + (
•s
.
	`gëMaxCUWidth
()>>
uiDïth
) - 1;

368 
UI¡
 
uiTPñY
 = 
pCtu
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

369 
UI¡
 
uiBPñY
 = 
uiTPñY
 + (
•s
.
	`gëMaxCUHeight
()>>
uiDïth
) - 1;

371 if––
uiRPñX
 >
•s
.
	`gëPicWidthInLumaSam∂es
(ËË|| ( 
uiBPñY
 >•s.
	`gëPicHeightInLumaSam∂es
() ) )

373 
bBound¨y
 = 
åue
;

376 if–––
uiDïth
 < 
pCtu
->
	`gëDïth
–
uiAbsP¨tIdx
 ) ) && ( uiDïth < 
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
(ËËË|| 
bBound¨y
 )

378 
UI¡
 
uiNextDïth
 = 
uiDïth
 + 1;

379 
UI¡
 
uiQNumP¨ts
 = 
pCtu
->
	`gëTŸÆNumP¨t
(Ë>> (
uiNextDïth
<<1);

380 
UI¡
 
uiIdx
 = 
uiAbsP¨tIdx
;

381  
UI¡
 
uiP¨tIdx
 = 0; uiPartIdx < 4; uiPartIdx++ )

383 
uiLPñX
 = 
pCtu
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiIdx
] ];

384 
uiTPñY
 = 
pCtu
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiIdx
] ];

386 if––
uiLPñX
 < 
•s
.
	`gëPicWidthInLumaSam∂es
(ËË&& ( 
uiTPñY
 < sps.
	`gëPicHeightInLumaSam∂es
() ) )

388 
	`xDecom¥essCU
(
pCtu
, 
uiIdx
, 
uiNextDïth
 );

391 
uiIdx
 +
uiQNumP¨ts
;

397 
m_µcYuvResi
[
uiDïth
]->
	`˛ór
();

399 
m_µcCU
[
uiDïth
]->
	`c›ySubCU
–
pCtu
, 
uiAbsP¨tIdx
 );

401  
m_µcCU
[
uiDïth
]->
	`gëPªdi˘i⁄Mode
(0) )

403 
MODE_INTER
:

404 
	`xRec⁄I¡î
–
m_µcCU
[
uiDïth
], uiDepth );

406 
MODE_INTRA
:

407 
	`xRec⁄I¡øQT
–
m_µcCU
[
uiDïth
], uiDepth );

410 
	`as£π
(0);

414 #i‡
DEBUG_STRING


415 c⁄° 
PªdMode
 
¥edMode
=
m_µcCU
[
uiDïth
]->
	`gëPªdi˘i⁄Mode
(0);

416 i‡(
DebugO±i⁄Li°
::
DebugSåög_Såu˘uª
.
	`gëI¡
()&
	`DebugSåögGëPªdModeMask
(
¥edMode
))

418 
P¨tSize
 
eSize
=
m_µcCU
[
uiDïth
]->
	`gëP¨tôi⁄Size
(0);

419 
°d
::
o°ªam
 &
	`ss
(°d::
cout
);

421 
ss
 <<"###: " << (
¥edMode
==
MODE_INTRA
?"I¡ø ":"I¡î "Ë<< 
∑πSizeToSåög
[
eSize
] << " CUáà" << 
m_µcCU
[
uiDïth
]->
	`gëCUPñX
(Ë<< ", " << m_µcCU[uiDïth]->
	`gëCUPñY
(Ë<< " width=" << 
	`UI¡
(m_µcCU[uiDïth]->
	`gëWidth
(0)Ë<< 
°d
::
ídl
;

425 i‡–
m_µcCU
[
uiDïth
]->
	`isLos¶essCoded
(0Ë&& (m_µcCU[uiDïth]->
	`gëIPCMFœg
(0Ë=
Ál£
))

427 
	`xFûlPCMBuf„r
(
m_µcCU
[
uiDïth
], uiDepth);

430 
	`xC›yToPic
–
m_µcCU
[
uiDïth
], 
pcPic
, 
uiAbsP¨tIdx
, uiDepth );

431 
	}
}

433 
Void
 
	gTDecCu
::
	$xRec⁄I¡î
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 )

437 #i‡
MCTS_ENC_CHECK


438 i‡(
m_pC⁄f‹m™˚Check
->
	`gëTM˘sCheck
(Ë&& !
m_pcPªdi˘i⁄
->
	`checkTM˘sMvp
(
pcCU
))

440 
m_pC⁄f‹m™˚Check
->
	`ÊagTM˘sEº‹
("motion vectorácrossÅile boundaries");

443 
m_pcPªdi˘i⁄
->
	`mŸi⁄Com≥nßti⁄
–
pcCU
, 
m_µcYuvReco
[
uiDïth
] );

445 #i‡
DEBUG_STRING


446 c⁄° 
I¡
 
debugPªdModeMask
=
	`DebugSåögGëPªdModeMask
(
MODE_INTER
);

447 i‡(
DebugO±i⁄Li°
::
DebugSåög_Pªd
.
	`gëI¡
()&
debugPªdModeMask
)

449 
	`¥ötBlockToSåóm
(
°d
::
cout
, "###öãr-¥ed: ", *(
m_µcYuvReco
[
uiDïth
]));

454 
	`xDecodeI¡îTextuª
–
pcCU
, 
uiDïth
 );

456 #i‡
DEBUG_STRING


457 i‡(
DebugO±i⁄Li°
::
DebugSåög_Resi
.
	`gëI¡
()&
debugPªdModeMask
)

459 
	`¥ötBlockToSåóm
(
°d
::
cout
, "###öãr-ªsi: ", *(
m_µcYuvResi
[
uiDïth
]));

464 i‡–
pcCU
->
	`gëQtRoŸCbf
( 0) )

466 
m_µcYuvReco
[
uiDïth
]->
	`addClù
–m_µcYuvReco[uiDïth], 
m_µcYuvResi
[uiDïth], 0, 
pcCU
->
	`gëWidth
–0 ),ÖcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïths
() );

470 
m_µcYuvReco
[
uiDïth
]->
	`c›yP¨tToP¨tYuv
–m_µcYuvReco[uiDïth],0, 
pcCU
->
	`gëWidth
–0 ),pcCU->
	`gëHeight
( 0 ));

472 #i‡
DEBUG_STRING


473 i‡(
DebugO±i⁄Li°
::
DebugSåög_Reco
.
	`gëI¡
()&
debugPªdModeMask
)

475 
	`¥ötBlockToSåóm
(
°d
::
cout
, "###öãr-ªco: ", *(
m_µcYuvReco
[
uiDïth
]));

479 
	}
}

482 
Void


483 
	gTDecCu
::
	$xI¡øRecBlk
–
TComYuv
* 
pcRecoYuv
,

484 
TComYuv
* 
pcPªdYuv
,

485 
TComYuv
* 
pcResiYuv
,

486 c⁄° 
Comp⁄ítID
 
compID
,

487 
TComTU
 &
rTu
)

489 i‡(!
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

493 c⁄° 
Boﬁ
 
bIsLuma
 = 
	`isLuma
(
compID
);

496 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

497 c⁄° 
TComSPS
 &
•s
=*(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

498 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

500 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
 =
rTu
.
	`gëRe˘
(
compID
);

501 c⁄° 
UI¡
 
uiWidth
 = 
tuRe˘
.
width
;

502 c⁄° 
UI¡
 
uiHeight
 = 
tuRe˘
.
height
;

503 c⁄° 
UI¡
 
uiSåide
 = 
pcRecoYuv
->
	`gëSåide
 (
compID
);

504 
Pñ
* 
piPªd
 = 
pcPªdYuv
->
	`gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

505 c⁄° 
ChromaF‹m©
 
chFmt
 = 
rTu
.
	`GëChromaF‹m©
();

507 i‡(
uiWidth
 !
uiHeight
)

513 
TComTURecur£
 
	`subTURecur£
(
rTu
, 
Ál£
, 
TComTU
::
VERTICAL_SPLIT
, 
åue
, 
compID
);

518 
	`xI¡øRecBlk
(
pcRecoYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
compID
, 
subTURecur£
);

519 } 
subTURecur£
.
	`√xtSe˘i⁄
(
rTu
));

526 c⁄° 
UI¡
 
uiChPªdMode
 = 
pcCU
->
	`gëI¡øDú
–
	`toCh™√lTy≥
(
compID
), 
uiAbsP¨tIdx
 );

527 c⁄° 
UI¡
 
∑πsPîMöCU
 = 1<<(2*(
•s
.
	`gëMaxTŸÆCUDïth
(Ë- sps.
	`gëLog2DiffMaxMöCodögBlockSize
()));

528 c⁄° 
UI¡
 
uiChCodedMode
 = (
uiChPªdMode
==
DM_CHROMA_IDX
 && !
bIsLuma
Ë? 
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
	`gëChromasC‹ª•⁄dögPULumaIdx
(
uiAbsP¨tIdx
, 
chFmt
, 
∑πsPîMöCU
)) : uiChPredMode;

529 c⁄° 
UI¡
 
uiChFöÆMode
 = ((
chFmt
 =
CHROMA_422
Ë&& !
bIsLuma
Ë? 
g_chroma422I¡øAngÀM≠pögTabÀ
[
uiChCodedMode
] : uiChCodedMode;

532 c⁄° 
Boﬁ
 
bU£FûãªdPªdi˘i⁄s
=
TComPªdi˘i⁄
::
	`fûãrögI¡øRe„ªn˚Sam∂es
(
compID
, 
uiChFöÆMode
, 
uiWidth
, 
uiHeight
, 
chFmt
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëI¡øSmoŸhögDißbÀdFœg
());

534 #i‡
DEBUG_STRING


535 
°d
::
o°ªam
 &
	`ss
(°d::
cout
);

538 
	`DEBUG_STRING_NEW
(
sTemp
)

539 
m_pcPªdi˘i⁄
->
	`öôI¡øP©ã∫ChTy≥
–
rTu
, 
compID
, 
bU£FûãªdPªdi˘i⁄s
 
	`DEBUG_STRING_PASS_INTO
(
sTemp
) );

544 
m_pcPªdi˘i⁄
->
	`¥edI¡øAng
–
compID
, 
uiChFöÆMode
, 0 , 0, 
piPªd
, 
uiSåide
, 
rTu
, 
bU£FûãªdPªdi˘i⁄s
 );

546 #i‡
DEBUG_STRING


547 
ss
 << 
sTemp
;

551 
Pñ
* 
piResi
 = 
pcResiYuv
->
	`gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

552 
TC€ff
* 
pcC€ff
 = 
pcCU
->
	`gëC€ff
(
compID
Ë+ 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

554 c⁄° 
QpP¨am
 
	`cQP
(*
pcCU
, 
compID
);

557 
	`DEBUG_STRING_NEW
(
sDebug
);

558 #i‡
DEBUG_STRING


559 c⁄° 
I¡
 
debugPªdModeMask
=
	`DebugSåögGëPªdModeMask
(
MODE_INTRA
);

560 
°d
::
°rög
 *
psDebug
=(
DebugO±i⁄Li°
::
DebugSåög_InvTøn
.
	`gëI¡
()&
debugPªdModeMask
Ë? &
sDebug
 : 0;

563 i‡(
pcCU
->
	`gëCbf
(
uiAbsP¨tIdx
, 
compID
, 
rTu
.
	`GëTønsf‹mDïthRñ
()) != 0)

565 
m_pcTrQu™t
->
	`övTønsf‹mNxN
–
rTu
, 
compID
, 
piResi
, 
uiSåide
, 
pcC€ff
, 
cQP
 
	`DEBUG_STRING_PASS_INTO
(
psDebug
) );

569 
UI¡
 
y
 = 0; y < 
uiHeight
; y++)

571 
UI¡
 
x
 = 0; x < 
uiWidth
; x++)

573 
piResi
[(
y
 * 
uiSåide
Ë+ 
x
] = 0;

578 #i‡
DEBUG_STRING


579 i‡(
psDebug
)

581 
ss
 << (*
psDebug
);

586 c⁄° 
UI¡
 
uiRecIPªdSåide
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëSåide
(
compID
);

588 c⁄° 
Boﬁ
 
u£CrossComp⁄ítPªdi˘i⁄
 = 
	`isChroma
(
compID
Ë&& (
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
uiAbsP¨tIdx
, compID) != 0);

589 c⁄° 
Pñ
* 
pResiLuma
 = 
pcResiYuv
->
	`gëAddr
–
COMPONENT_Y
, 
uiAbsP¨tIdx
 );

590 c⁄° 
I¡
 
°rideLuma
 = 
pcResiYuv
->
	`gëSåide
–
COMPONENT_Y
 );

592 
Pñ
* 
pPªd
 = 
piPªd
;

593 
Pñ
* 
pResi
 = 
piResi
;

594 
Pñ
* 
pReco
 = 
pcRecoYuv
->
	`gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

595 
Pñ
* 
pRecIPªd
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
–
compID
,ÖcCU->
	`gëCtuRsAddr
(),ÖcCU->
	`gëZ‹dîIdxInCtu
(Ë+ 
uiAbsP¨tIdx
 );

598 #i‡
DEBUG_STRING


599 c⁄° 
Boﬁ
 
bDebugPªd
=((
DebugO±i⁄Li°
::
DebugSåög_Pªd
.
	`gëI¡
()&
debugPªdModeMask
Ë&& 
	`DEBUG_STRING_CHANNEL_CONDITION
(
compID
));

600 c⁄° 
Boﬁ
 
bDebugResi
=((
DebugO±i⁄Li°
::
DebugSåög_Resi
.
	`gëI¡
()&
debugPªdModeMask
Ë&& 
	`DEBUG_STRING_CHANNEL_CONDITION
(
compID
));

601 c⁄° 
Boﬁ
 
bDebugReco
=((
DebugO±i⁄Li°
::
DebugSåög_Reco
.
	`gëI¡
()&
debugPªdModeMask
Ë&& 
	`DEBUG_STRING_CHANNEL_CONDITION
(
compID
));

602 i‡(
bDebugPªd
 || 
bDebugResi
 || 
bDebugReco
)

604 
ss
 << "###: " << "CompID: " << 
compID
 << "Öªd modê(ch/fö): " << 
uiChPªdMode
 << "/" << 
uiChFöÆMode
 << "ábsP¨tIdx: " << 
rTu
.
	`GëAbsP¨tIdxTU
(Ë<< 
°d
::
ídl
;

608 c⁄° 
I¡
 
˛ùbd
 = 
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

609 #i‡
O0043_BEST_EFFORT_DECODING


610 c⁄° 
I¡
 
bôDïthDñè
 = 
•s
.
	`gëSåómBôDïth
(
	`toCh™√lTy≥
(
compID
)Ë- 
˛ùbd
;

613 if–
u£CrossComp⁄ítPªdi˘i⁄
 )

615 
TComTrQu™t
::
	`¸ossComp⁄ítPªdi˘i⁄
–
rTu
, 
compID
, 
pResiLuma
, 
piResi
,ÖiResi, 
uiWidth
, 
uiHeight
, 
°rideLuma
, 
uiSåide
, uiSåide, 
åue
 );

618  
UI¡
 
uiY
 = 0; uiY < 
uiHeight
; uiY++ )

620 #i‡
DEBUG_STRING


621 i‡(
bDebugPªd
 || 
bDebugResi
 || 
bDebugReco
)

623 
ss
 << "###: ";

626 i‡(
bDebugPªd
)

628 
ss
 << " -Öred: ";

629  
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

631 
ss
 << 
pPªd
[ 
uiX
 ] << ", ";

634 i‡(
bDebugResi
)

636 
ss
 << " -Ñesi: ";

640  
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

642 #i‡
DEBUG_STRING


643 i‡(
bDebugResi
)

645 
ss
 << 
pResi
[ 
uiX
 ] << ", ";

648 #i‡
O0043_BEST_EFFORT_DECODING


649 
pReco
 [ 
uiX
 ] = 
	`ClùBD
–
rightShi·EvíRoundög
<
Pñ
>(
pPªd
[ uiX ] + 
pResi
[ uiX ], 
bôDïthDñè
), 
˛ùbd
 );

651 
pReco
 [ 
uiX
 ] = 
	`ClùBD
–
pPªd
[ uiX ] + 
pResi
[ uiX ], 
˛ùbd
 );

653 
pRecIPªd
[ 
uiX
 ] = 
pReco
[ uiX ];

655 #i‡
DEBUG_STRING


656 i‡(
bDebugReco
)

658 
ss
 << " -Ñeco: ";

659  
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

661 
ss
 << 
pReco
[ 
uiX
 ] << ", ";

665 i‡(
bDebugPªd
 || 
bDebugResi
 || 
bDebugReco
)

667 
ss
 << "\n";

670 
pPªd
 +
uiSåide
;

671 
pResi
 +
uiSåide
;

672 
pReco
 +
uiSåide
;

673 
pRecIPªd
 +
uiRecIPªdSåide
;

675 
	}
}

678 
Void


679 
	gTDecCu
::
	$xRec⁄I¡øQT
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 )

681 i‡(
pcCU
->
	`gëIPCMFœg
(0))

683 
	`xRec⁄PCM
–
pcCU
, 
uiDïth
 );

686 c⁄° 
UI¡
 
numChTy≥
 = 
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
()!=
CHROMA_400
 ? 2 : 1;

687 
UI¡
 
chTy≥
=
CHANNEL_TYPE_LUMA
; chTy≥<
numChTy≥
; chType++)

689 c⁄° 
Ch™√lTy≥
 
ch™Ty≥
=
	`Ch™√lTy≥
(
chTy≥
);

690 c⁄° 
Boﬁ
 
NxNPUHas4P¨ts
 = ::
	`isChroma
(
ch™Ty≥
Ë? 
	`íabÀ4ChromaPUsInI¡øNxNCU
(
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
()Ë: 
åue
;

691 c⁄° 
UI¡
 
uiInôTrDïth
 = ( 
pcCU
->
	`gëP¨tôi⁄Size
(0Ë!
SIZE_2Nx2N
 && 
NxNPUHas4P¨ts
 ? 1 : 0 );

693 
TComTURecur£
 
	`tuRecur£CU
(
pcCU
, 0);

694 
TComTURecur£
 
	`tuRecur£WôhPU
(
tuRecur£CU
, 
Ál£
, (
uiInôTrDïth
==0)?
TComTU
::
DONT_SPLIT
 : TComTU::
QUAD_SPLIT
);

698 
	`xI¡øRecQT
–
m_µcYuvReco
[
uiDïth
], m_µcYuvReco[uiDïth], 
m_µcYuvResi
[uiDïth], 
ch™Ty≥
, 
tuRecur£WôhPU
 );

699 } 
tuRecur£WôhPU
.
	`√xtSe˘i⁄
(
tuRecur£CU
));

701 
	}
}

715 
Void


716 
	gTDecCu
::
	$xI¡øRecQT
(
TComYuv
* 
pcRecoYuv
,

717 
TComYuv
* 
pcPªdYuv
,

718 
TComYuv
* 
pcResiYuv
,

719 c⁄° 
Ch™√lTy≥
 
chTy≥
,

720 
TComTU
 &
rTu
)

722 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

723 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

724 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

725 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

726 if–
uiTrMode
 =
uiTrDïth
 )

728 i‡(
	`isLuma
(
chTy≥
))

730 
	`xI¡øRecBlk
–
pcRecoYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
COMPONENT_Y
, 
rTu
 );

734 c⁄° 
UI¡
 
numVÆidComp
=
	`gëNumbîVÆidComp⁄íts
(
rTu
.
	`GëChromaF‹m©
());

735 
UI¡
 
compID
=
COMPONENT_Cb
; compID<
numVÆidComp
; compID++)

737 
	`xI¡øRecBlk
–
pcRecoYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
	`Comp⁄ítID
(
compID
), 
rTu
 );

743 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

746 
	`xI¡øRecQT
–
pcRecoYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
chTy≥
, 
tuRecur£Chûd
 );

747 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
));

749 
	}
}

751 
Void
 
	gTDecCu
::
	$xC›yToPic
–
TComD©aCU
* 
pcCU
, 
TComPic
* 
pcPic
, 
UI¡
 
uiZ‹dîIdx
, UI¡ 
uiDïth
 )

753 
UI¡
 
uiCtuRsAddr
 = 
pcCU
->
	`gëCtuRsAddr
();

755 
m_µcYuvReco
[
uiDïth
]->
	`c›yToPicYuv
 ( 
pcPic
->
	`gëPicYuvRec
 (), 
uiCtuRsAddr
, 
uiZ‹dîIdx
 );

758 
	}
}

760 
Void
 
	gTDecCu
::
	$xDecodeI¡îTextuª
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 )

763 
TComTURecur£
 
	`tuRecur
(
pcCU
, 0, 
uiDïth
);

765 
UI¡
 
ch
=0; ch<
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
(); ch++)

767 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

768 
	`DEBUG_STRING_OUTPUT
(
°d
::
cout
, 
debug_ª‹dî_d©a_öãr_tokí
[
compID
])

770 
m_pcTrQu™t
->
	`övRecurTønsf‹mNxN
 ( 
compID
, 
m_µcYuvResi
[
uiDïth
], 
tuRecur
 );

773 
	`DEBUG_STRING_OUTPUT
(
°d
::
cout
, 
debug_ª‹dî_d©a_öãr_tokí
[
MAX_NUM_COMPONENT
])

774 
	}
}

787 
Void
 
	gTDecCu
::
	$xDecodePCMTextuª
–
TComD©aCU
* 
pcCU
, c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° 
Pñ
 *
piPCM
, Pñ* 
piReco
, c⁄° UI¡ 
uiSåide
, c⁄° UI¡ 
uiWidth
, c⁄° UI¡ 
uiHeight
, c⁄° 
Comp⁄ítID
 
compID
)

789 
Pñ
* 
piPicReco
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
(
compID
,ÖcCU->
	`gëCtuRsAddr
(),ÖcCU->
	`gëZ‹dîIdxInCtu
()+
uiP¨tIdx
);

790 c⁄° 
UI¡
 
uiPicSåide
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëSåide
(
compID
);

791 c⁄° 
TComSPS
 &
•s
 = *(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

792 c⁄° 
UI¡
 
uiPcmLe·Shi·Bô
 = 
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
)Ë- sps.
	`gëPCMBôDïth
(toChannelType(compID));

794 
UI¡
 
uiY
 = 0; uiY < 
uiHeight
; uiY++ )

796 
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

798 
piReco
[
uiX
] = (
piPCM
[uiX] << 
uiPcmLe·Shi·Bô
);

799 
piPicReco
[
uiX
] = 
piReco
[uiX];

801 
piPCM
 +
uiWidth
;

802 
piReco
 +
uiSåide
;

803 
piPicReco
 +
uiPicSåide
;

805 
	}
}

812 
Void
 
	gTDecCu
::
	$xRec⁄PCM
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 )

814 c⁄° 
UI¡
 
maxCuWidth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
();

815 c⁄° 
UI¡
 
maxCuHeight
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUHeight
();

816 
UI¡
 
ch
=0; ch < 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
(); ch++)

818 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

819 c⁄° 
UI¡
 
width
 = (
maxCuWidth
 >>(
uiDïth
+
m_µcYuvResi
[uiDïth]->
	`gëComp⁄ítSˇÀX
(
compID
)));

820 c⁄° 
UI¡
 
height
 = (
maxCuHeight
>>(
uiDïth
+
m_µcYuvResi
[uiDïth]->
	`gëComp⁄ítSˇÀY
(
compID
)));

821 c⁄° 
UI¡
 
°ride
 = 
m_µcYuvResi
[
uiDïth
]->
	`gëSåide
(
compID
);

822 
Pñ
 * 
pPCMCh™√l
 = 
pcCU
->
	`gëPCMSam∂e
(
compID
);

823 
Pñ
 * 
pRecCh™√l
 = 
m_µcYuvReco
[
uiDïth
]->
	`gëAddr
(
compID
);

824 
	`xDecodePCMTextuª
–
pcCU
, 0, 
pPCMCh™√l
, 
pRecCh™√l
, 
°ride
, 
width
, 
height
, 
compID
 );

826 
	}
}

832 
Void
 
	gTDecCu
::
	$xFûlPCMBuf„r
(
TComD©aCU
* 
pCU
, 
UI¡
 
dïth
)

834 c⁄° 
ChromaF‹m©
 
f‹m©
 = 
pCU
->
	`gëPic
()->
	`gëChromaF‹m©
();

835 c⁄° 
UI¡
 
numVÆidComp
 = 
	`gëNumbîVÆidComp⁄íts
(
f‹m©
);

836 c⁄° 
UI¡
 
maxCuWidth
 = 
pCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
();

837 c⁄° 
UI¡
 
maxCuHeight
 = 
pCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUHeight
();

839 
UI¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
numVÆidComp
; componentIndex++)

841 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

843 c⁄° 
UI¡
 
width
 = 
maxCuWidth
 >> (
dïth
 + 
	`gëComp⁄ítSˇÀX
(
comp⁄ít
, 
f‹m©
));

844 c⁄° 
UI¡
 
height
 = 
maxCuHeight
 >> (
dïth
 + 
	`gëComp⁄ítSˇÀY
(
comp⁄ít
, 
f‹m©
));

846 
Pñ
 *
sour˚
 = 
m_µcYuvReco
[
dïth
]->
	`gëAddr
(
comp⁄ít
, 0, 
width
);

847 
Pñ
 *
de°ö©i⁄
 = 
pCU
->
	`gëPCMSam∂e
(
comp⁄ít
);

849 c⁄° 
UI¡
 
sour˚Såide
 = 
m_µcYuvReco
[
dïth
]->
	`gëSåide
(
comp⁄ít
);

851 
I¡
 
löe
 = 0;Üöê< 
height
;Üine++)

853 
I¡
 
cﬁumn
 = 0; cﬁum¿< 
width
; column++)

855 
de°ö©i⁄
[
cﬁumn
] = 
sour˚
[column];

858 
sour˚
 +
sour˚Såide
;

859 
de°ö©i⁄
 +
width
;

862 
	}
}

	@TLibDecoder/TDecCu.h

38 #i‚de‡
__TDECCU__


39 
	#__TDECCU__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/TComTrQu™t.h
"

46 
	~"TDecE¡r›y.h
"

47 
	~"TDecC⁄f‹m™˚.h
"

57 ˛as†
	cTDecCu


59 
	m¥iv©e
:

60 
UI¡
 
m_uiMaxDïth
;

61 
TComYuv
** 
	mm_µcYuvResi
;

62 
TComYuv
** 
	mm_µcYuvReco
;

63 
TComD©aCU
** 
	mm_µcCU
;

66 
TComTrQu™t
* 
	mm_pcTrQu™t
;

67 
TComPªdi˘i⁄
* 
	mm_pcPªdi˘i⁄
;

68 
TDecE¡r›y
* 
	mm_pcE¡r›yDecodî
;

69 #i‡
MCTS_ENC_CHECK


70 
TDecC⁄f‹m™˚Check
* 
	mm_pC⁄f‹m™˚Check
;

73 
Boﬁ
 
	mm_bDecodeDQP
;

74 
Boﬁ
 
	mm_IsChromaQpAdjCoded
;

76 
	mpublic
:

77 
TDecCu
();

78 
	mvútuÆ
 ~
TDecCu
();

81 #i‡
MCTS_ENC_CHECK


82 
Void
 
öô
 (
TDecE¡r›y
* 
pcE¡r›yDecodî
, 
TComTrQu™t
* 
pcTrQu™t
, 
TComPªdi˘i⁄
* 
pcPªdi˘i⁄
, 
TDecC⁄f‹m™˚Check
* 
pC⁄f‹m™˚Check
);

84 
Void
 
öô
 ( 
TDecE¡r›y
* 
pcE¡r›yDecodî
, 
TComTrQu™t
* 
pcTrQu™t
, 
TComPªdi˘i⁄
* 
pcPªdi˘i⁄
 );

88 
Void
 
¸óã
 ( 
UI¡
 
uiMaxDïth
, UI¡ 
uiMaxWidth
, UI¡ 
uiMaxHeight
, 
ChromaF‹m©
 
chromaF‹m©IDC
 );

91 
Void
 
de°roy
 ();

94 
Void
 
decodeCtu
 ( 
TComD©aCU
* 
pCtu
, 
Boﬁ
 &
isLa°CtuOfSli˚Segmít
 );

97 
Void
 
decom¥essCtu
 ( 
TComD©aCU
* 
pCtu
 );

99 
	m¥Ÿe˘ed
:

101 
Void
 
xDecodeCU
 ( 
TComD©aCU
* c⁄° 
pcCU
, c⁄° 
UI¡
 
uiAbsP¨tIdx
, c⁄° UI¡ 
uiDïth
, 
Boﬁ
 &
isLa°CtuOfSli˚Segmít
);

102 
Void
 
xFöishDecodeCU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
 &
isLa°CtuOfSli˚Segmít
);

103 
Boﬁ
 
xDecodeSli˚End
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

104 
Void
 
xDecom¥essCU
 ( 
TComD©aCU
* 
pCtu
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

106 
Void
 
xRec⁄I¡î
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 );

108 
Void
 
xRec⁄I¡øQT
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 );

109 
Void
 
xI¡øRecBlk
 ( 
TComYuv
* 
pcRecoYuv
, TComYuv* 
pcPªdYuv
, TComYuv* 
pcResiYuv
, c⁄° 
Comp⁄ítID
 
comp⁄ít
, 
TComTU
 &
rTu
 );

110 
Void
 
xI¡øRecQT
 ( 
TComYuv
* 
pcRecoYuv
, TComYuv* 
pcPªdYuv
, TComYuv* 
pcResiYuv
, c⁄° 
Ch™√lTy≥
 
chTy≥
, 
TComTU
 &
rTu
 );

112 
Void
 
xRec⁄PCM
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 );

114 
Void
 
xDecodeI¡îTextuª
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 );

115 
Void
 
xDecodePCMTextuª
 ( 
TComD©aCU
* 
pcCU
, c⁄° 
UI¡
 
uiP¨tIdx
, c⁄° 
Pñ
 *
piPCM
, Pñ* 
piReco
, c⁄° UI¡ 
uiSåide
, c⁄° UI¡ 
uiWidth
, c⁄° UI¡ 
uiHeight
, c⁄° 
Comp⁄ítID
 
compID
);

117 
Void
 
xC›yToPic
 ( 
TComD©aCU
* 
pcCU
, 
TComPic
* 
pcPic
, 
UI¡
 
uiZ‹dîIdx
, UI¡ 
uiDïth
 );

119 
Boﬁ
 
	$gëdQPFœg
 (Ë{  
m_bDecodeDQP
; }

120 
Void
 
	$£tdQPFœg
 ( 
Boﬁ
 
b
 ) { 
m_bDecodeDQP
 = b; 
	}
}

121 
Boﬁ
 
	$gëIsChromaQpAdjCoded
 (Ë{  
m_IsChromaQpAdjCoded
; 
	}
}

122 
Void
 
	$£tIsChromaQpAdjCoded
 ( 
Boﬁ
 
b
 ) { 
m_IsChromaQpAdjCoded
 = b; 
	}
}

124 
Void
 
xFûlPCMBuf„r
 (
TComD©aCU
* 
pCU
, 
UI¡
 
dïth
);

	@TLibDecoder/TDecEntropy.cpp

38 
	~"TDecE¡r›y.h
"

39 
	~"TLibComm⁄/TComTU.h
"

40 
	~"TLibComm⁄/TComPªdi˘i⁄.h
"

42 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


43 
	~"../TLibComm⁄/Debug.h
"

44 c⁄° 
Boﬁ
 
	gbDebugRQT
 = 
DebugO±i⁄Li°
::
DebugRQT
.
gëI¡
()!=0;

45 c⁄° 
Boﬁ
 
	gbDebugPªdE«bÀd
 = 
DebugO±i⁄Li°
::
DebugPªd
.
gëI¡
()!=0;

51 
Void
 
	gTDecE¡r›y
::
	$£tE¡r›yDecodî
 ( 
TDecE¡r›yIf
* 
p
 )

53 
m_pcE¡r›yDecodîIf
 = 
p
;

54 
	}
}

56 
	~"TLibComm⁄/TComSam∂eAd≠tiveOff£t.h
"

58 
Void
 
	gTDecE¡r›y
::
	$decodeSkùFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

60 
m_pcE¡r›yDecodîIf
->
	`∑r£SkùFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

61 
	}
}

64 
Void
 
	gTDecE¡r›y
::
	$decodeCUTønsqu™tBy∑ssFœg
(
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

66 
m_pcE¡r›yDecodîIf
->
	`∑r£CUTønsqu™tBy∑ssFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

67 
	}
}

77 
Void
 
	gTDecE¡r›y
::
	$decodeMîgeFœg
–
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiPUIdx
 )

80 
m_pcE¡r›yDecodîIf
->
	`∑r£MîgeFœg
–
pcSubCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
uiPUIdx
 );

81 
	}
}

90 
Void
 
	gTDecE¡r›y
::
	$decodeMîgeIndex
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiP¨tIdx
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

92 
UI¡
 
uiMîgeIndex
 = 0;

93 
m_pcE¡r›yDecodîIf
->
	`∑r£MîgeIndex
–
pcCU
, 
uiMîgeIndex
 );

94 
pcCU
->
	`£tMîgeIndexSubP¨ts
–
uiMîgeIndex
, 
uiAbsP¨tIdx
, 
uiP¨tIdx
, 
uiDïth
 );

95 
	}
}

97 
Void
 
	gTDecE¡r›y
::
	$decodeS∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

99 
m_pcE¡r›yDecodîIf
->
	`∑r£S∂ôFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

100 
	}
}

102 
Void
 
	gTDecE¡r›y
::
	$decodePªdMode
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

104 
m_pcE¡r›yDecodîIf
->
	`∑r£PªdMode
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

105 
	}
}

107 
Void
 
	gTDecE¡r›y
::
	$decodeP¨tSize
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

109 
m_pcE¡r›yDecodîIf
->
	`∑r£P¨tSize
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

110 
	}
}

112 
Void
 
	gTDecE¡r›y
::
	$decodePªdInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, TComD©aCU* 
pcSubCU
 )

114 if–
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) )

116 
	`decodeI¡øDúModeLuma
 ( 
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

117 i‡(
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
()!=
CHROMA_400
)

119 
	`decodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

120 i‡(
	`íabÀ4ChromaPUsInI¡øNxNCU
(
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
()Ë&&ÖcCU->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 )==
SIZE_NxN
)

122 
UI¡
 
uiP¨tOff£t
 = ( 
pcCU
->
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (ÖcCU->
	`gëDïth
(
uiAbsP¨tIdx
) << 1 ) ) >> 2;

123 
	`decodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
 + 
uiP¨tOff£t
, 
uiDïth
+1 );

124 
	`decodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
 + 
uiP¨tOff£t
*2, 
uiDïth
+1 );

125 
	`decodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
 + 
uiP¨tOff£t
*3, 
uiDïth
+1 );

131 
	`decodePUWi£
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
pcSubCU
 );

133 
	}
}

141 
Void
 
	gTDecE¡r›y
::
	$decodeIPCMInfo
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

143 if(!
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëU£PCM
()

144 || 
pcCU
->
	`gëWidth
(
uiAbsP¨tIdx
Ë> (1<<pcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPCMLog2MaxSize
())

145 || 
pcCU
->
	`gëWidth
(
uiAbsP¨tIdx
Ë< (1<<pcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPCMLog2MöSize
()) )

150 
m_pcE¡r›yDecodîIf
->
	`∑r£IPCMInfo
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

151 
	}
}

153 
Void
 
	gTDecE¡r›y
::
	$decodeI¡øDúModeLuma
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

155 
m_pcE¡r›yDecodîIf
->
	`∑r£I¡øDúLumaAng
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

156 
	}
}

158 
Void
 
	gTDecE¡r›y
::
	$decodeI¡øDúModeChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

160 
m_pcE¡r›yDecodîIf
->
	`∑r£I¡øDúChroma
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

161 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


162 i‡(
bDebugPªdE«bÀd
)

164 
UI¡
 
cdú
=
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_CHROMA
, 
uiAbsP¨tIdx
);

165 i‡(
cdú
==36)

167 
cdú
=
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
uiAbsP¨tIdx
);

169 
	`¥ötf
("codög chrom®I¡ø dú: %d, uiAbsP¨tIdx: %d,Üum®dú: %d\n", 
cdú
, 
uiAbsP¨tIdx
, 
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, uiAbsPartIdx));

172 
	}
}

182 
Void
 
	gTDecE¡r›y
::
	$decodePUWi£
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, TComD©aCU* 
pcSubCU
 )

184 
P¨tSize
 
eP¨tSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 );

185 
UI¡
 
uiNumPU
 = ( 
eP¨tSize
 =
SIZE_2Nx2N
 ? 1 : (ÉP¨tSizê=
SIZE_NxN
 ? 4 : 2 ) );

186 
UI¡
 
uiPUOff£t
 = ( 
g_auiPUOff£t
[
	`UI¡
–
eP¨tSize
 )] << ( ( 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxTŸÆCUDïth
(Ë- 
uiDïth
 ) << 1 ) ) >> 4;

188 
TComMvFõld
 
cMvFõldNeighbours
[
MRG_MAX_NUM_CANDS
 << 1];

189 
UCh¨
 
uhI¡îDúNeighbours
[
MRG_MAX_NUM_CANDS
];

191  
UI¡
 
ui
 = 0; uò< 
pcCU
->
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
(); ui++ )

193 
uhI¡îDúNeighbours
[
ui
] = 0;

195 
I¡
 
numVÆidMîgeC™d
 = 0;

196 
Boﬁ
 
hasMîgedC™dLi°
 = 
Ál£
;

198 #i‡
MCTS_ENC_CHECK


199 
UI¡
 
numS∑tülMîgeC™did©es
 = 0;

201 
pcSubCU
->
	`c›yI¡îPªdInfoFrom
–
pcCU
, 
uiAbsP¨tIdx
, 
REF_PIC_LIST_0
 );

202 
pcSubCU
->
	`c›yI¡îPªdInfoFrom
–
pcCU
, 
uiAbsP¨tIdx
, 
REF_PIC_LIST_1
 );

203  
UI¡
 
uiP¨tIdx
 = 0, 
uiSubP¨tIdx
 = 
uiAbsP¨tIdx
; uiP¨tIdx < 
uiNumPU
; uiP¨tIdx++, uiSubP¨tIdx +
uiPUOff£t
 )

205 
	`decodeMîgeFœg
–
pcCU
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

206 i‡–
pcCU
->
	`gëMîgeFœg
–
uiSubP¨tIdx
 ) )

208 
	`decodeMîgeIndex
–
pcCU
, 
uiP¨tIdx
, 
uiSubP¨tIdx
, 
uiDïth
 );

209 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


210 i‡(
bDebugPªdE«bÀd
)

212 
°d
::
cout
 << "Coded mîgêÊag, CUábsP¨tIdx: " << 
uiAbsP¨tIdx
 << " PU(" << 
uiP¨tIdx
 << "ËabsP¨tIdx: " << 
uiSubP¨tIdx
;

213 
°d
::
cout
 << " mîgêödex: " << (
UI¡
)
pcCU
->
	`gëMîgeIndex
(
uiSubP¨tIdx
Ë<< std::
ídl
;

217 c⁄° 
UI¡
 
uiMîgeIndex
 = 
pcCU
->
	`gëMîgeIndex
(
uiSubP¨tIdx
);

218 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëLog2P¨ÆÀlMîgeLevñMöus2
(Ë&& 
eP¨tSize
 !
SIZE_2Nx2N
 && 
pcSubCU
->
	`gëWidth
( 0 ) <= 8 )

220 i‡–!
hasMîgedC™dLi°
 )

222 
pcSubCU
->
	`£tP¨tSizeSubP¨ts
–
SIZE_2Nx2N
, 0, 
uiDïth
 );

223 #i‡
MCTS_ENC_CHECK


224 
numS∑tülMîgeC™did©es
 = 0;

225 
pcSubCU
->
	`gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
numS∑tülMîgeC™did©es
 );

227 
pcSubCU
->
	`gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
 );

229 
pcSubCU
->
	`£tP¨tSizeSubP¨ts
–
eP¨tSize
, 0, 
uiDïth
 );

230 
hasMîgedC™dLi°
 = 
åue
;

235 #i‡
MCTS_ENC_CHECK


236 
numS∑tülMîgeC™did©es
 = 0;

237 
pcSubCU
->
	`gëI¡îMîgeC™did©es
–
uiSubP¨tIdx
-
uiAbsP¨tIdx
, 
uiP¨tIdx
, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
numS∑tülMîgeC™did©es
, 
uiMîgeIndex
 );

239 
pcSubCU
->
	`gëI¡îMîgeC™did©es
–
uiSubP¨tIdx
-
uiAbsP¨tIdx
, 
uiP¨tIdx
, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
uiMîgeIndex
 );

243 #i‡
MCTS_ENC_CHECK


244 i‡(
m_pC⁄f‹m™˚Check
->
	`gëTM˘sCheck
(Ë&& 
pcSubCU
->
	`isLa°CﬁumnCTUInTûe
(Ë&& (
uiMîgeIndex
 >
numS∑tülMîgeC™did©es
) )

246 
m_pC⁄f‹m™˚Check
->
	`ÊagTM˘sEº‹
("Merge Index usingÇon-spatial merge candidate (Merge)");

250 
pcCU
->
	`£tI¡îDúSubP¨ts
–
uhI¡îDúNeighbours
[
uiMîgeIndex
], 
uiSubP¨tIdx
, 
uiP¨tIdx
, 
uiDïth
 );

252 
TComMv
 
	`cTmpMv
( 0, 0 );

253  
UI¡
 
uiRefLi°Idx
 = 0; uiRefListIdx < 2; uiRefListIdx++ )

255 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
	`RefPicLi°
–
uiRefLi°Idx
 ) ) > 0 )

257 
pcCU
->
	`£tMVPIdxSubP¨ts
–0, 
	`RefPicLi°
–
uiRefLi°Idx
 ), 
uiSubP¨tIdx
, 
uiP¨tIdx
, 
uiDïth
);

258 
pcCU
->
	`£tMVPNumSubP¨ts
–0, 
	`RefPicLi°
–
uiRefLi°Idx
 ), 
uiSubP¨tIdx
, 
uiP¨tIdx
, 
uiDïth
);

259 
pcCU
->
	`gëCUMvFõld
–
	`RefPicLi°
–
uiRefLi°Idx
 ) )->
	`£tAŒMvd
–
cTmpMv
, 
eP¨tSize
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

260 
pcCU
->
	`gëCUMvFõld
–
	`RefPicLi°
–
uiRefLi°Idx
 ) )->
	`£tAŒMvFõld
–
cMvFõldNeighbours
[ 2*
uiMîgeIndex
 + uiRefLi°Idx ], 
eP¨tSize
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

267 
	`decodeI¡îDúPU
–
pcCU
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

268  
UI¡
 
uiRefLi°Idx
 = 0; uiRefListIdx < 2; uiRefListIdx++ )

270 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
	`RefPicLi°
–
uiRefLi°Idx
 ) ) > 0 )

272 
	`decodeRefFrmIdxPU
–
pcCU
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
, 
	`RefPicLi°
–
uiRefLi°Idx
 ) );

273 
	`decodeMvdPU
 ( 
pcCU
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
, 
	`RefPicLi°
–
uiRefLi°Idx
 ) );

274 
	`decodeMVPIdxPU
 ( 
pcSubCU
, 
uiSubP¨tIdx
-
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
, 
	`RefPicLi°
–
uiRefLi°Idx
 ) );

275 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


276 i‡(
bDebugPªdE«bÀd
)

278 
°d
::
cout
 << "ªfLi°Idx: " << 
uiRefLi°Idx
 << std::
ídl
;

279 
°d
::
cout
 << "MVD h‹iz⁄èl: " << 
pcCU
->
	`gëCUMvFõld
(
	`RefPicLi°
(
uiRefLi°Idx
))->
	`gëMvd
–
uiAbsP¨tIdx
 ).
	`gëH‹
(Ë<< std::
ídl
;

280 
°d
::
cout
 << "MVD vîtiˇl: " << 
pcCU
->
	`gëCUMvFõld
(
	`RefPicLi°
(
uiRefLi°Idx
))->
	`gëMvd
–
uiAbsP¨tIdx
 ).
	`gëVî
(Ë<< std::
ídl
;

281 
°d
::
cout
 << "MVPIdxPU: " << 
pcCU
->
	`gëMVPIdx
(
	`RefPicLi°
–
uiRefLi°Idx
 ), 
uiSubP¨tIdx
Ë<< std::
ídl
;

282 
°d
::
cout
 << "I¡îDú: " << (
UI¡
)
pcCU
->
	`gëI¡îDú
(
uiSubP¨tIdx
Ë<< std::
ídl
;

289 i‡–(
pcCU
->
	`gëI¡îDú
(
uiSubP¨tIdx
Ë=3Ë&& 
pcSubCU
->
	`isBùªdRe°ri˘i⁄
(
uiP¨tIdx
) )

291 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_1
 )->
	`£tAŒMv
–
	`TComMv
(0,0), 
eP¨tSize
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
);

292 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_1
 )->
	`£tAŒRefIdx
–-1, 
eP¨tSize
, 
uiSubP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
);

293 
pcCU
->
	`£tI¡îDúSubP¨ts
–1, 
uiSubP¨tIdx
, 
uiP¨tIdx
, 
uiDïth
);

297 
	}
}

306 
Void
 
	gTDecE¡r›y
::
	$decodeI¡îDúPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
 )

308 
UI¡
 
uiI¡îDú
;

310 i‡–
pcCU
->
	`gëSli˚
()->
	`isI¡îP
() )

312 
uiI¡îDú
 = 1;

316 
m_pcE¡r›yDecodîIf
->
	`∑r£I¡îDú
–
pcCU
, 
uiI¡îDú
, 
uiAbsP¨tIdx
 );

319 
pcCU
->
	`£tI¡îDúSubP¨ts
–
uiI¡îDú
, 
uiAbsP¨tIdx
, 
uiP¨tIdx
, 
uiDïth
 );

320 
	}
}

322 
Void
 
	gTDecE¡r›y
::
	$decodeRefFrmIdxPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

324 
I¡
 
iRefFrmIdx
 = 0;

325 
I¡
 
iP¨£RefFrmIdx
 = 
pcCU
->
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) & ( 1 << 
eRefLi°
 );

327 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
eRefLi°
 ) > 1 && 
iP¨£RefFrmIdx
 )

329 
m_pcE¡r›yDecodîIf
->
	`∑r£RefFrmIdx
–
pcCU
, 
iRefFrmIdx
, 
eRefLi°
 );

331 i‡–!
iP¨£RefFrmIdx
 )

333 
iRefFrmIdx
 = 
NOT_VALID
;

337 
iRefFrmIdx
 = 0;

340 
P¨tSize
 
eP¨tSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 );

341 
pcCU
->
	`gëCUMvFõld
–
eRefLi°
 )->
	`£tAŒRefIdx
–
iRefFrmIdx
, 
eP¨tSize
, 
uiAbsP¨tIdx
, 
uiDïth
, 
uiP¨tIdx
 );

342 
	}
}

352 
Void
 
	gTDecE¡r›y
::
	$decodeMvdPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

354 i‡–
pcCU
->
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) & ( 1 << 
eRefLi°
 ) )

356 
m_pcE¡r›yDecodîIf
->
	`∑r£Mvd
–
pcCU
, 
uiAbsP¨tIdx
, 
uiP¨tIdx
, 
uiDïth
, 
eRefLi°
 );

358 
	}
}

360 
Void
 
	gTDecE¡r›y
::
	$decodeMVPIdxPU
–
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiP¨tAddr
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

362 
I¡
 
iMVPIdx
 = -1;

364 
TComMv
 
	`cZîoMv
( 0, 0 );

365 
TComMv
 
cMv
 = 
cZîoMv
;

366 
I¡
 
iRefIdx
 = -1;

368 
TComCUMvFõld
* 
pcSubCUMvFõld
 = 
pcSubCU
->
	`gëCUMvFõld
–
eRefLi°
 );

369 
AMVPInfo
* 
pAMVPInfo
 = 
pcSubCUMvFõld
->
	`gëAMVPInfo
();

371 
iRefIdx
 = 
pcSubCUMvFõld
->
	`gëRefIdx
(
uiP¨tAddr
);

372 
cMv
 = 
cZîoMv
;

374 i‡–(
pcSubCU
->
	`gëI¡îDú
(
uiP¨tAddr
Ë& ( 1 << 
eRefLi°
 )) )

376 
m_pcE¡r›yDecodîIf
->
	`∑r£MVPIdx
–
iMVPIdx
 );

378 
pcSubCU
->
	`fûlMvpC™d
(
uiP¨tIdx
, 
uiP¨tAddr
, 
eRefLi°
, 
iRefIdx
, 
pAMVPInfo
);

379 #i‡
MCTS_ENC_CHECK


380 i‡((
iRefIdx
 >0Ë&& 
m_pC⁄f‹m™˚Check
->
	`gëTM˘sCheck
(Ë&& 
pcSubCU
->
	`isLa°CﬁumnCTUInTûe
(Ë&& (
iMVPIdx
 =
pAMVPInfo
->
numS∑tülMVPC™did©es
))

382 
m_pC⁄f‹m™˚Check
->
	`ÊagTM˘sEº‹
("Merge Index usingÇon-spatial merge candidate (AMVP)");

385 
pcSubCU
->
	`£tMVPNumSubP¨ts
(
pAMVPInfo
->
iN
, 
eRefLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
, 
uiDïth
);

386 
pcSubCU
->
	`£tMVPIdxSubP¨ts
–
iMVPIdx
, 
eRefLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
, 
uiDïth
 );

387 i‡–
iRefIdx
 >= 0 )

389 
m_pcPªdi˘i⁄
->
	`gëMvPªdAMVP
–
pcSubCU
, 
uiP¨tIdx
, 
uiP¨tAddr
, 
eRefLi°
, 
cMv
);

390 
cMv
 +
pcSubCUMvFõld
->
	`gëMvd
–
uiP¨tAddr
 );

393 
P¨tSize
 
eP¨tSize
 = 
pcSubCU
->
	`gëP¨tôi⁄Size
–
uiP¨tAddr
 );

394 
pcSubCU
->
	`gëCUMvFõld
–
eRefLi°
 )->
	`£tAŒMv
(
cMv
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
uiP¨tIdx
);

395 
	}
}

397 
Void
 
	gTDecE¡r›y
::
	$xDecodeTønsf‹m
 ( 
Boﬁ
& 
bCodeDQP
, Boﬁ& 
isChromaQpAdjCoded
, 
TComTU
 &
rTu
, c⁄° 
I¡
 
quadåìTULog2MöSizeInCU
 )

399 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

400 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

401 c⁄° 
UI¡
 
uiDïth
=
rTu
.
	`GëTønsf‹mDïthTŸÆ
();

402 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

404 
UI¡
 
uiSubdiv
;

405 c⁄° 
UI¡
 
numVÆidComp⁄ít
 = 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

406 c⁄° 
Boﬁ
 
bChroma
 = 
	`isChromaE«bÀd
(
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
());

408 c⁄° 
UI¡
 
uiLog2TøfoSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

409 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


410 i‡(
bDebugRQT
)

412 
	`¥ötf
("x..codeTransform: offsetLuma=%d offsetChroma=%dábsPartIdx=%d, uiDepth=%d\n width=%d, height=%d, uiTrIdx=%d, uiInnerQuadIdx=%d\n",

413 
rTu
.
	`gëC€fficõ¡Off£t
(
COMPONENT_Y
),ÑTu.gëC€fficõ¡Off£t(
COMPONENT_Cb
), 
uiAbsP¨tIdx
, 
uiDïth
,ÑTu.
	`gëRe˘
(COMPONENT_Y).
width
,ÑTu.gëRe˘(COMPONENT_Y).
height
,ÑTu.
	`GëTønsf‹mDïthRñ
(),ÑTu.
	`GëSe˘i⁄Numbî
());

414 
	`fÊush
(
°dout
);

418 if–
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
Ë&&ÖcCU->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdxË=
SIZE_NxN
 && 
uiDïth
 =pcCU->
	`gëDïth
(uiAbsPartIdx) )

420 
uiSubdiv
 = 1;

422 if–(
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTUMaxDïthI¡î
(Ë=1Ë&& (pcCU->
	`isI¡î
(
uiAbsP¨tIdx
)Ë&& (ÖcCU->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdxË!
SIZE_2Nx2N
 ) && (
uiDïth
 =pcCU->
	`gëDïth
(uiAbsPartIdx)) )

424 
uiSubdiv
 = (
uiLog2TøfoSize
 >
quadåìTULog2MöSizeInCU
);

426 if–
uiLog2TøfoSize
 > 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
() )

428 
uiSubdiv
 = 1;

430 if–
uiLog2TøfoSize
 =
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MöSize
() )

432 
uiSubdiv
 = 0;

434 if–
uiLog2TøfoSize
 =
quadåìTULog2MöSizeInCU
 )

436 
uiSubdiv
 = 0;

440 
	`as£π
–
uiLog2TøfoSize
 > 
quadåìTULog2MöSizeInCU
 );

441 
m_pcE¡r›yDecodîIf
->
	`∑r£Tønsf‹mSubdivFœg
–
uiSubdiv
, 5 - 
uiLog2TøfoSize
 );

444 
I¡
 
ch™
=
COMPONENT_Cb
; ch™<
numVÆidComp⁄ít
; chan++)

446 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch™
);

447 c⁄° 
UI¡
 
åDïthTŸÆAdj
=
rTu
.
	`GëTønsf‹mDïthTŸÆAdj
(
compID
);

449 c⁄° 
Boﬁ
 
bFú°CbfOfCU
 = 
uiTrDïth
 == 0;

451 if–
bFú°CbfOfCU
 )

453 
pcCU
->
	`£tCbfSubP¨ts
–0, 
compID
, 
rTu
.
	`GëAbsP¨tIdxTU
(compID), 
åDïthTŸÆAdj
);

455 if–
bFú°CbfOfCU
 || 
rTu
.
	`Pro˚ssögAŒQuadø¡s
(
compID
) )

457 if–
bFú°CbfOfCU
 || 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
compID
, 
uiTrDïth
 - 1 ) )

459 
m_pcE¡r›yDecodîIf
->
	`∑r£QtCbf
–
rTu
, 
compID
, (
uiSubdiv
 == 0) );

464 if–
uiSubdiv
 )

466 c⁄° 
UI¡
 
uiQP¨tNum
 = 
pcCU
->
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
(Ë>> ((
uiDïth
+1) << 1);

467 
UI¡
 
uiYUVCbf
[
MAX_NUM_COMPONENT
] = {0,0,0};

469 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
åue
);

473 
	`xDecodeTønsf‹m
–
bCodeDQP
, 
isChromaQpAdjCoded
, 
tuRecur£Chûd
, 
quadåìTULog2MöSizeInCU
 );

474 
UI¡
 
chûdTUAbsP¨tIdx
=
tuRecur£Chûd
.
	`GëAbsP¨tIdxTU
();

475 
UI¡
 
ch
=0; ch<
numVÆidComp⁄ít
; ch++)

477 
uiYUVCbf
[
ch
] |
pcCU
->
	`gëCbf
(
chûdTUAbsP¨tIdx
 , 
	`Comp⁄ítID
(ch), 
uiTrDïth
+1 );

479 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
) );

481 
UI¡
 
ch
=0; ch<
numVÆidComp⁄ít
; ch++)

483 
UCh¨
 *
pBa£
 = 
pcCU
->
	`gëCbf
–
	`Comp⁄ítID
(
ch
ËË+ 
uiAbsP¨tIdx
;

484 c⁄° 
UCh¨
 
Êag
 = 
uiYUVCbf
[
ch
] << 
uiTrDïth
;

486  
UI¡
 
ui
 = 0; uò< 4 * 
uiQP¨tNum
; ++ui )

488 
pBa£
[
ui
] |
Êag
;

494 
	`as£π
–
uiDïth
 >
pcCU
->
	`gëDïth
–
uiAbsP¨tIdx
 ) );

495 
pcCU
->
	`£tTrIdxSubP¨ts
–
uiTrDïth
, 
uiAbsP¨tIdx
, 
uiDïth
 );

498 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

499 
	`DTRACE_CABAC_T
( "\tTrIdx:ábspart=" );

500 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 );

501 
	`DTRACE_CABAC_T
( "\tdepth=" );

502 
	`DTRACE_CABAC_V
–
uiDïth
 );

503 
	`DTRACE_CABAC_T
( "\ttrdepth=" );

504 
	`DTRACE_CABAC_V
–
uiTrDïth
 );

505 
	`DTRACE_CABAC_T
( "\n" );

508 
pcCU
->
	`£tCbfSubP¨ts
 ( 0, 
COMPONENT_Y
, 
uiAbsP¨tIdx
, 
uiDïth
 );

510 if–(!
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
)Ë&& 
uiDïth
 =pcCU->
	`gëDïth
–uiAbsP¨tIdx ) && ((!
bChroma
Ë|| (!pcCU->
	`gëCbf
–uiAbsP¨tIdx, 
COMPONENT_Cb
, 0 ) && !pcCU->gëCbf–uiAbsP¨tIdx, 
COMPONENT_Cr
, 0 )) ))

512 
pcCU
->
	`£tCbfSubP¨ts
–1 << 
uiTrDïth
, 
COMPONENT_Y
, 
uiAbsP¨tIdx
, 
uiDïth
 );

516 
m_pcE¡r›yDecodîIf
->
	`∑r£QtCbf
–
rTu
, 
COMPONENT_Y
, 
åue
 );

521 
UI¡
 
cbf
[
MAX_NUM_COMPONENT
]={0,0,0};

522 
Boﬁ
 
vÆidCbf
 = 
Ál£
;

523 
Boﬁ
 
vÆidChromaCbf
 = 
Ál£
;

524 c⁄° 
UI¡
 
uiTrIdx
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

526 
UI¡
 
ch
=0; ch<
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
(); ch++)

528 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

530 
cbf
[
compID
] = 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, compID, 
uiTrIdx
 );

532 i‡(
cbf
[
compID
] != 0)

534 
vÆidCbf
 = 
åue
;

535 i‡(
	`isChroma
(
compID
))

537 
vÆidChromaCbf
 = 
åue
;

542 i‡–
vÆidCbf
 )

546 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£DQP
() )

548 i‡–
bCodeDQP
 )

550 c⁄° 
UI¡
 
uiAbsP¨tIdxCU
=
rTu
.
	`GëAbsP¨tIdxCU
();

551 
	`decodeQP
–
pcCU
, 
uiAbsP¨tIdxCU
);

552 
bCodeDQP
 = 
Ál£
;

556 i‡–
pcCU
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
() )

558 i‡–
vÆidChromaCbf
 && 
isChromaQpAdjCoded
 && !
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
rTu
.
	`GëAbsP¨tIdxCU
()) )

560 
	`decodeChromaQpAdju°mít
–
pcCU
, 
rTu
.
	`GëAbsP¨tIdxCU
() );

561 
isChromaQpAdjCoded
 = 
Ál£
;

565 c⁄° 
UI¡
 
numVÆidComp
=
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

567 
UI¡
 
ch
=
COMPONENT_Y
; ch<
numVÆidComp
; ch++)

569 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

571 if–
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
) )

573 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


574 i‡(
bDebugRQT
)

576 
	`¥ötf
("CÆ»NxN f‹ ch™ %d width=%d height=%d cbf=%d\n", 
compID
, 
rTu
.
	`gëRe˘
(compID).
width
,ÑTu.gëRe˘(compID).
height
, 1);

580 i‡(
rTu
.
	`gëRe˘
(
compID
).
width
 !rTu.gëRe˘(compID).
height
)

583 
TComTURecur£
 
	`subTUIãøt‹
(
rTu
, 
Ál£
, 
TComTU
::
VERTICAL_SPLIT
, 
åue
, 
compID
);

587 c⁄° 
UI¡
 
subTUCBF
 = 
pcCU
->
	`gëCbf
(
subTUIãøt‹
.
	`GëAbsP¨tIdxTU
(), 
compID
, (
uiTrIdx
 + 1));

589 i‡(
subTUCBF
 != 0)

591 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


592 i‡(
bDebugRQT
)

594 
	`¥ötf
("CÆ»NxN f‹ ch™ %d width=%d height=%d cbf=%d\n", 
compID
, 
subTUIãøt‹
.
	`gëRe˘
(compID).
width
, subTUIãøt‹.gëRe˘(compID).
height
, 1);

597 
m_pcE¡r›yDecodîIf
->
	`∑r£C€ffNxN
–
subTUIãøt‹
, 
compID
 );

599 } 
subTUIãøt‹
.
	`√xtSe˘i⁄
(
rTu
));

603 if(
	`isChroma
(
compID
Ë&& (
cbf
[
COMPONENT_Y
] != 0))

605 
m_pcE¡r›yDecodîIf
->
	`∑r£CrossComp⁄ítPªdi˘i⁄
–
rTu
, 
compID
 );

608 if(
cbf
[
compID
] != 0)

610 
m_pcE¡r›yDecodîIf
->
	`∑r£C€ffNxN
–
rTu
, 
compID
 );

618 
	}
}

620 
Void
 
	gTDecE¡r›y
::
	$decodeQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

622 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£DQP
() )

624 
m_pcE¡r›yDecodîIf
->
	`∑r£DñèQP
–
pcCU
, 
uiAbsP¨tIdx
,ÖcCU->
	`gëDïth
( uiAbsPartIdx ) );

626 
	}
}

628 
Void
 
	gTDecE¡r›y
::
	$decodeChromaQpAdju°mít
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

630 i‡–
pcCU
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
() )

632 
m_pcE¡r›yDecodîIf
->
	`∑r£ChromaQpAdju°mít
–
pcCU
, 
uiAbsP¨tIdx
,ÖcCU->
	`gëDïth
( uiAbsPartIdx ) );

634 
	}
}

638 
Void
 
	gTDecE¡r›y
::
	$decodeC€ff
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
& 
bCodeDQP
, Boﬁ& 
isChromaQpAdjCoded
 )

640 if–
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
) )

645 
UI¡
 
uiQtRoŸCbf
 = 1;

646 if–!–
pcCU
->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
Ë=
SIZE_2Nx2N
 &&ÖcCU->
	`gëMîgeFœg
( uiAbsPartIdx ) ) )

648 
m_pcE¡r›yDecodîIf
->
	`∑r£QtRoŸCbf
–
uiAbsP¨tIdx
, 
uiQtRoŸCbf
 );

650 i‡–!
uiQtRoŸCbf
 )

652 c⁄° 
UI¡
 
cbfZîo
[
MAX_NUM_COMPONENT
]={0,0,0};

653 
pcCU
->
	`£tCbfSubP¨ts
–
cbfZîo
, 
uiAbsP¨tIdx
, 
uiDïth
 );

654 
pcCU
->
	`£tTrIdxSubP¨ts
–0 , 
uiAbsP¨tIdx
, 
uiDïth
 );

660 
TComTURecur£
 
	`tuRecur£
(
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
);

662 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


663 i‡(
bDebugRQT
)

665 
	`¥ötf
("..codeC€ff: uiAbsP¨tIdx=%d, PU f‹m©=%d, 2Nx2N=%d, NxN=%d\n", 
uiAbsP¨tIdx
, 
pcCU
->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdx), 
SIZE_2Nx2N
, 
SIZE_NxN
);

669 
I¡
 
quadåìTULog2MöSizeInCU
 = 
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
);

671 
	`xDecodeTønsf‹m
–
bCodeDQP
, 
isChromaQpAdjCoded
, 
tuRecur£
, 
quadåìTULog2MöSizeInCU
 );

672 
	}
}

	@TLibDecoder/TDecEntropy.h

38 #i‚de‡
__TDECENTROPY__


39 
	#__TDECENTROPY__


	)

41 
	~"TLibComm⁄/Comm⁄Def.h
"

42 
	~"TLibComm⁄/TComBôSåóm.h
"

43 
	~"TLibComm⁄/TComSli˚.h
"

44 
	~"TLibComm⁄/TComPic.h
"

45 
	~"TLibComm⁄/TComSam∂eAd≠tiveOff£t.h
"

46 
	~"TLibComm⁄/TComRe˘™gÀ.h
"

47 
	~"TDecC⁄f‹m™˚.h
"

49 
˛ass
 
	gTDecSbac
;

50 
˛ass
 
	gTDecCavlc
;

51 
˛ass
 
	gP¨amëîSëM™agîDecodî
;

52 
˛ass
 
	gTComPªdi˘i⁄
;

62 ˛as†
	cTDecE¡r›yIf


64 
	mpublic
:

66 
vútuÆ
 
Void
 
ª£tE¡r›y
 ( 
TComSli˚
* 
pcSli˚
 ) = 0;

67 
vútuÆ
 
Void
 
£tBô°ªam
 ( 
TComI≈utBô°ªam
* 
p
 ) = 0;

69 
vútuÆ
 
Void
 
∑r£VPS
 ( 
TComVPS
* 
pcVPS
 ) = 0;

70 
vútuÆ
 
Void
 
∑r£SPS
 ( 
TComSPS
* 
pcSPS
 ) = 0;

71 
vútuÆ
 
Void
 
∑r£PPS
 ( 
TComPPS
* 
pcPPS
 ) = 0;

73 
vútuÆ
 
Void
 
∑r£Sli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
, 
P¨amëîSëM™agî
 *
∑ømëîSëM™agî
, c⁄° 
I¡
 
¥evTid0POC
) = 0;

75 
vútuÆ
 
Void
 
∑r£Tîmö©ögBô
 ( 
UI¡
& 
ruûsLa°
 ) = 0;

76 
vútuÆ
 
Void
 
∑r£RemaöögByãs
–
Boﬁ
 
noTøûögByãsEx≥˘ed
 ) = 0;

78 
vútuÆ
 
Void
 
∑r£MVPIdx
 ( 
I¡
& 
riMVPIdx
 ) = 0;

80 
	mpublic
:

81 
vútuÆ
 
Void
 
∑r£SkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

82 
vútuÆ
 
Void
 
∑r£CUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

83 
vútuÆ
 
Void
 
∑r£S∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

84 
vútuÆ
 
Void
 
∑r£MîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiPUIdx
 ) = 0;

85 
vútuÆ
 
Void
 
∑r£MîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiMîgeIndex
 ) = 0;

86 
vútuÆ
 
Void
 
∑r£P¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

87 
vútuÆ
 
Void
 
∑r£PªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

89 
vútuÆ
 
Void
 
∑r£I¡øDúLumaAng
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

90 
vútuÆ
 
Void
 
∑r£I¡øDúChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

92 
vútuÆ
 
Void
 
∑r£I¡îDú
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiI¡îDú
, UI¡ 
uiAbsP¨tIdx
 ) = 0;

93 
vútuÆ
 
Void
 
∑r£RefFrmIdx
 ( 
TComD©aCU
* 
pcCU
, 
I¡
& 
riRefFrmIdx
, 
RefPicLi°
 
eRefLi°
 ) = 0;

94 
vútuÆ
 
Void
 
∑r£Mvd
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tAddr
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
, 
RefPicLi°
 
eRefLi°
 ) = 0;

96 
vútuÆ
 
Void
 
∑r£CrossComp⁄ítPªdi˘i⁄
 ( 
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 ) = 0;

98 
vútuÆ
 
Void
 
∑r£Tønsf‹mSubdivFœg
–
UI¡
& 
ruiSubdivFœg
, UI¡ 
uiLog2Tønsf‹mBlockSize
 ) = 0;

99 
vútuÆ
 
Void
 
∑r£QtCbf
 ( 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 ) = 0;

100 
vútuÆ
 
Void
 
∑r£QtRoŸCbf
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡& 
uiQtRoŸCbf
 ) = 0;

102 
vútuÆ
 
Void
 
∑r£DñèQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

103 
vútuÆ
 
Void
 
∑r£ChromaQpAdju°mít
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

105 
vútuÆ
 
Void
 
∑r£IPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
) = 0;

107 
vútuÆ
 
Void
 
∑r£C€ffNxN
–
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 ) = 0;

109 
vútuÆ
 
Void
 
∑r£Tønsf‹mSkùFœgs
 ( 
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
 ) = 0;

111 
vútuÆ
 
Void
 
∑r£Ex∂icôRdpcmMode
 ( 
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 ) = 0;

113 
	mvútuÆ
 ~
	$TDecE¡r›yIf
() {}

114 
	}
};

117 ˛as†
	cTDecE¡r›y


119 
	m¥iv©e
:

120 
TDecE¡r›yIf
* 
m_pcE¡r›yDecodîIf
;

121 
TComPªdi˘i⁄
* 
	mm_pcPªdi˘i⁄
;

122 #i‡
MCTS_ENC_CHECK


123 
TDecC⁄f‹m™˚Check
* 
	mm_pC⁄f‹m™˚Check
;

129 
	mpublic
:

130 #i‡
MCTS_ENC_CHECK


131 
Void
 
	$öô
 (
TComPªdi˘i⁄
* 
p
, 
TDecC⁄f‹m™˚Check
* 
pC⁄f‹m™˚Check
Ë{
m_pcPªdi˘i⁄
 =Ö; 
m_pC⁄f‹m™˚Check
=pConformanceCheck;}

133 
Void
 
	$öô
 (
TComPªdi˘i⁄
* 
p
Ë{
m_pcPªdi˘i⁄
 =Ö;
	}
}

135 
Void
 
decodePUWi£
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, TComD©aCU* 
pcSubCU
 );

136 
Void
 
decodeI¡îDúPU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
 );

137 
Void
 
decodeRefFrmIdxPU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

138 
Void
 
decodeMvdPU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

139 
Void
 
decodeMVPIdxPU
 ( 
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiP¨tAddr
, UI¡ 
uiDïth
, UI¡ 
uiP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

141 
Void
 
£tE¡r›yDecodî
 ( 
TDecE¡r›yIf
* 
p
 );

142 
Void
 
	$£tBô°ªam
 ( 
TComI≈utBô°ªam
* 
p
 ) { 
m_pcE¡r›yDecodîIf
->
	`£tBô°ªam
’); 
	}
}

143 
Void
 
	$ª£tE¡r›y
 ( 
TComSli˚
* 
p
Ë{ 
m_pcE¡r›yDecodîIf
->
	`ª£tE¡r›y
’); 
	}
}

145 
Void
 
	$decodeVPS
 ( 
TComVPS
* 
pcVPS
 ) { 
m_pcE¡r›yDecodîIf
->
	`∑r£VPS
’cVPS); 
	}
}

146 
Void
 
	$decodeSPS
 ( 
TComSPS
* 
pcSPS
 ) { 
m_pcE¡r›yDecodîIf
->
	`∑r£SPS
’cSPS); 
	}
}

147 
Void
 
	$decodePPS
 ( 
TComPPS
* 
pcPPS
 ) { 
m_pcE¡r›yDecodîIf
->
	`∑r£PPS
’cPPS); 
	}
}

148 
Void
 
	$decodeSli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
, 
P¨amëîSëM™agî
 *
∑ømëîSëM™agî
, c⁄° 
I¡
 
¥evTid0POC
Ë{ 
m_pcE¡r›yDecodîIf
->
	`∑r£Sli˚Hódî
’cSli˚,Ö¨amëîSëM™agî,ÖªvTid0POC); 
	}
}

150 
Void
 
	$decodeTîmö©ögBô
 ( 
UI¡
& 
ruiIsLa°
 ) { 
m_pcE¡r›yDecodîIf
->
	`∑r£Tîmö©ögBô
‘uiIsLa°); 
	}
}

151 
Void
 
	$decodeRemaöögByãs
–
Boﬁ
 
noTøûögByãsEx≥˘ed
 ) { 
m_pcE¡r›yDecodîIf
->
	`∑r£RemaöögByãs
“oTøûögByãsEx≥˘ed); 
	}
}

153 
TDecE¡r›yIf
* 
	$gëE¡r›yDecodî
(Ë{  
m_pcE¡r›yDecodîIf
; 
	}
}

155 
	gpublic
:

156 
Void
 
decodeS∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

157 
Void
 
decodeSkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

158 
Void
 
decodeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

159 
Void
 
decodeMîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiPUIdx
 );

160 
Void
 
decodeMîgeIndex
 ( 
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiP¨tIdx
, UI¡ 
uiP¨tAddr
, UI¡ 
uiDïth
 );

161 
Void
 
decodePªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

162 
Void
 
decodeP¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

164 
Void
 
decodeIPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

166 
Void
 
decodePªdInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, TComD©aCU* 
pcSubCU
 );

168 
Void
 
decodeI¡øDúModeLuma
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

169 
Void
 
decodeI¡øDúModeChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

171 
Void
 
decodeQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

172 
Void
 
decodeChromaQpAdju°mít
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

174 
	g¥iv©e
:

176 
Void
 
xDecodeTønsf‹m
 ( 
Boﬁ
& 
bCodeDQP
, Boﬁ& 
isChromaQpAdjCoded
, 
TComTU
 &
rTu
, c⁄° 
I¡
 
quadåìTULog2MöSizeInCU
 );

178 
	gpublic
:

180 
Void
 
decodeC€ff
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
& 
bCodeDQP
, Boﬁ& 
isChromaQpAdjCoded
 );

	@TLibDecoder/TDecGop.cpp

38 
	~"TDecG›.h
"

39 
	~"TDecCAVLC.h
"

40 
	~"TDecSbac.h
"

41 
	~"TDecBöCodî.h
"

42 
	~"TDecBöCodîCABAC.h
"

43 
	~"libmd5/MD5.h
"

44 
	~"TLibComm⁄/SEI.h
"

46 
	~<time.h
>

50 
Void
 
ˇlcAndPrötHashSètus
(
TComPicYuv
& 
pic
, c⁄° 
SEIDecodedPi˘uªHash
* 
pi˘uªHashSEI
, c⁄° 
BôDïths
 &
bôDïths
, 
UI¡
 &
numChecksumEº‹s
);

55 
	gTDecG›
::
	$TDecG›
()

56 : 
	$m_numbîOfChecksumEº‹sDëe˘ed
(0)

58 
m_dDecTime
 = 0;

59 
	}
}

61 
	gTDecG›
::~
	$TDecG›
()

64 
	}
}

66 
Void
 
TDecG›
::
	$¸óã
()

69 
	}
}

72 
Void
 
TDecG›
::
	$de°roy
()

74 
	}
}

76 
Void
 
TDecG›
::
	$öô
–
TDecE¡r›y
* 
pcE¡r›yDecodî
,

77 
TDecSbac
* 
pcSbacDecodî
,

78 
TDecBöCABAC
* 
pcBöCABAC
,

79 
TDecCavlc
* 
pcCavlcDecodî
,

80 
TDecSli˚
* 
pcSli˚Decodî
,

81 
TComLo›Fûãr
* 
pcLo›Fûãr
,

82 
TComSam∂eAd≠tiveOff£t
* 
pcSAO


85 
m_pcE¡r›yDecodî
 = 
pcE¡r›yDecodî
;

86 
m_pcSbacDecodî
 = 
pcSbacDecodî
;

87 
m_pcBöCABAC
 = 
pcBöCABAC
;

88 
m_pcCavlcDecodî
 = 
pcCavlcDecodî
;

89 
m_pcSli˚Decodî
 = 
pcSli˚Decodî
;

90 
m_pcLo›Fûãr
 = 
pcLo›Fûãr
;

91 
m_pcSAO
 = 
pcSAO
;

92 
m_numbîOfChecksumEº‹sDëe˘ed
 = 0;

93 
	}
}

103 
Void
 
	gTDecG›
::
	$decom¥essSli˚
(
TComI≈utBô°ªam
* 
pcBô°ªam
, 
TComPic
* 
pcPic
)

105 
TComSli˚
* 
pcSli˚
 = 
pcPic
->
	`gëSli˚
’cPic->
	`gëCuºSli˚Idx
());

108 
TComI≈utBô°ªam
 **
µcSub°ªams
 = 
NULL
;

111 
˛ock_t
 
iBef‹eTime
 = 
	`˛ock
();

112 
m_pcSbacDecodî
->
	`öô
–(
TDecBöIf
*)
m_pcBöCABAC
 );

113 
m_pcE¡r›yDecodî
->
	`£tE¡r›yDecodî
 (
m_pcSbacDecodî
);

115 c⁄° 
UI¡
 
uiNumSub°ªams
 = 
pcSli˚
->
	`gëNumbîOfSub°ªamSizes
()+1;

118 
µcSub°ªams
 = 
√w
 
TComI≈utBô°ªam
*[
uiNumSub°ªams
];

119  
UI¡
 
ui
 = 0 ; uò< 
uiNumSub°ªams
 ; ui++ )

121 
µcSub°ªams
[
ui
] = 
pcBô°ªam
->
	`exåa˘Sub°ªam
(ui+1 < 
uiNumSub°ªams
 ? (
pcSli˚
->
	`gëSub°ªamSize
(ui)<<3Ë:ÖcBô°ªam->
	`gëNumBôsLe·
());

124 
m_pcSli˚Decodî
->
	`decom¥essSli˚
–
µcSub°ªams
, 
pcPic
, 
m_pcSbacDecodî
);

126 
UI¡
 
ui
 = 0; uò< 
uiNumSub°ªams
; ui++)

128 
dñëe
 
µcSub°ªams
[
ui
];

130 
dñëe
[] 
µcSub°ªams
;

132 
m_dDecTime
 +(
DoubÀ
)(
	`˛ock
()-
iBef‹eTime
Ë/ 
CLOCKS_PER_SEC
;

133 
	}
}

135 
Void
 
	gTDecG›
::
	$fûãrPi˘uª
(
TComPic
* 
pcPic
)

137 
TComSli˚
* 
pcSli˚
 = 
pcPic
->
	`gëSli˚
’cPic->
	`gëCuºSli˚Idx
());

140 
˛ock_t
 
iBef‹eTime
 = 
	`˛ock
();

143 
Boﬁ
 
bLFCrossTûeBound¨y
 = 
pcSli˚
->
	`gëPPS
()->
	`gëLo›FûãrA¸ossTûesE«bÀdFœg
();

144 
m_pcLo›Fûãr
->
	`£tCfg
(
bLFCrossTûeBound¨y
);

145 
m_pcLo›Fûãr
->
	`lo›FûãrPic
–
pcPic
 );

147 if–
pcSli˚
->
	`gëSPS
()->
	`gëU£SAO
() )

149 
m_pcSAO
->
	`ªc⁄°ru˘BlkSAOP¨ams
(
pcPic
,ÖcPic->
	`gëPicSym
()->
	`gëSAOBlkP¨am
());

150 
m_pcSAO
->
	`SAOPro˚ss
(
pcPic
);

151 
m_pcSAO
->
	`PCMLFDißbÀPro˚ss
(
pcPic
);

154 
pcPic
->
	`com¥essMŸi⁄
();

155 
TCh¨
 
c
 = (
pcSli˚
->
	`isI¡ø
(Ë? 'I' :ÖcSli˚->
	`isI¡îP
() ? 'P' : 'B');

156 i‡(!
pcSli˚
->
	`isRe„ªn˚d
())

158 
c
 += 32;

162 
	`¥ötf
("POC %4d TId: %1d ( %c-SLICE, QP%3d ) ", 
pcSli˚
->
	`gëPOC
(),

163 
pcSli˚
->
	`gëTLayî
(),

164 
c
,

165 
pcSli˚
->
	`gëSli˚Qp
() );

167 
m_dDecTime
 +(
DoubÀ
)(
	`˛ock
()-
iBef‹eTime
Ë/ 
CLOCKS_PER_SEC
;

168 
	`¥ötf
 ("[DT %6.3f] ", 
m_dDecTime
 );

169 
m_dDecTime
 = 0;

171 
I¡
 
iRefLi°
 = 0; iRefList < 2; iRefList++)

173 
	`¥ötf
 ("[L%d ", 
iRefLi°
);

174 
I¡
 
iRefIndex
 = 0; iRefIndex < 
pcSli˚
->
	`gëNumRefIdx
(
	`RefPicLi°
(
iRefLi°
)); iRefIndex++)

176 
	`¥ötf
 ("%d ", 
pcSli˚
->
	`gëRefPOC
(
	`RefPicLi°
(
iRefLi°
), 
iRefIndex
));

178 
	`¥ötf
 ("] ");

180 i‡(
m_decodedPi˘uªHashSEIE«bÀd
)

182 
SEIMesßges
 
pi˘uªHashes
 = 
	`gëSeisByTy≥
(
pcPic
->
	`gëSEIs
(), 
SEI
::
DECODED_PICTURE_HASH
 );

183 c⁄° 
SEIDecodedPi˘uªHash
 *
hash
 = ( 
pi˘uªHashes
.
	`size
(Ë> 0 ) ? (SEIDecodedPi˘uªHash*Ë*’i˘uªHashes.
	`begö
()Ë: 
NULL
;

184 i‡(
pi˘uªHashes
.
	`size
() > 1)

186 
	`¥ötf
 ("Warning: Got multiple decodedÖicture hash SEI messages. Using first.");

188 
	`ˇlcAndPrötHashSètus
(*(
pcPic
->
	`gëPicYuvRec
()), 
hash
, 
pcSli˚
->
	`gëSPS
()->
	`gëBôDïths
(), 
m_numbîOfChecksumEº‹sDëe˘ed
);

191 
	`¥ötf
("\n");

193 
pcPic
->
	`£tOuçutM¨k
’cPic->
	`gëSli˚
(0)->
	`gëPicOuçutFœg
(Ë? 
åue
 : 
Ál£
);

194 
pcPic
->
	`£tRec⁄M¨k
(
åue
);

195 
	}
}

208 
Void
 
	$ˇlcAndPrötHashSètus
(
TComPicYuv
& 
pic
, c⁄° 
SEIDecodedPi˘uªHash
* 
pi˘uªHashSEI
, c⁄° 
BôDïths
 &
bôDïths
, 
UI¡
 &
numChecksumEº‹s
)

211 
TComPi˘uªHash
 
ªc⁄_dige°
;

212 
I¡
 
numCh¨
=0;

213 c⁄° 
TCh¨
* 
hashTy≥
 = "\0";

215 i‡(
pi˘uªHashSEI
)

217 
pi˘uªHashSEI
->
mëhod
)

219 
HASHTYPE_MD5
:

221 
hashTy≥
 = "MD5";

222 
numCh¨
 = 
	`ˇlcMD5
(
pic
, 
ªc⁄_dige°
, 
bôDïths
);

225 
HASHTYPE_CRC
:

227 
hashTy≥
 = "CRC";

228 
numCh¨
 = 
	`ˇlcCRC
(
pic
, 
ªc⁄_dige°
, 
bôDïths
);

231 
HASHTYPE_CHECKSUM
:

233 
hashTy≥
 = "Checksum";

234 
numCh¨
 = 
	`ˇlcChecksum
(
pic
, 
ªc⁄_dige°
, 
bôDïths
);

239 
	`as£π
 (!"unknown hashÅype");

246 c⁄° 
TCh¨
* 
ok
 = "(unk)";

247 
Boﬁ
 
mism©ch
 = 
Ál£
;

249 i‡(
pi˘uªHashSEI
)

251 
ok
 = "(OK)";

252 i‡(
ªc⁄_dige°
 !
pi˘uªHashSEI
->
m_pi˘uªHash
)

254 
ok
 = "(***ERROR***)";

255 
mism©ch
 = 
åue
;

259 
	`¥ötf
("[%s:%s,%s] ", 
hashTy≥
, 
	`hashToSåög
(
ªc⁄_dige°
, 
numCh¨
).
	`c_°r
(), 
ok
);

261 i‡(
mism©ch
)

263 
numChecksumEº‹s
++;

264 
	`¥ötf
("[rx%s:%s] ", 
hashTy≥
, 
	`hashToSåög
(
pi˘uªHashSEI
->
m_pi˘uªHash
, 
numCh¨
).
	`c_°r
());

266 
	}
}

	@TLibDecoder/TDecGop.h

38 #i‚de‡
__TDECGOP__


39 
	#__TDECGOP__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/Comm⁄Def.h
"

46 
	~"TLibComm⁄/TComBôSåóm.h
"

47 
	~"TLibComm⁄/TComLi°.h
"

48 
	~"TLibComm⁄/TComPicYuv.h
"

49 
	~"TLibComm⁄/TComPic.h
"

50 
	~"TLibComm⁄/TComLo›Fûãr.h
"

51 
	~"TLibComm⁄/TComSam∂eAd≠tiveOff£t.h
"

53 
	~"TDecE¡r›y.h
"

54 
	~"TDecSli˚.h
"

55 
	~"TDecBöCodî.h
"

56 
	~"TDecBöCodîCABAC.h
"

66 ˛as†
	cTDecG›


68 
	m¥iv©e
:

69 
TComLi°
<
TComPic
*> 
m_cLi°Pic
;

72 
TDecE¡r›y
* 
	mm_pcE¡r›yDecodî
;

73 
TDecSbac
* 
	mm_pcSbacDecodî
;

74 
TDecBöCABAC
* 
	mm_pcBöCABAC
;

75 
TDecCavlc
* 
	mm_pcCavlcDecodî
;

76 
TDecSli˚
* 
	mm_pcSli˚Decodî
;

77 
TComLo›Fûãr
* 
	mm_pcLo›Fûãr
;

79 
TComSam∂eAd≠tiveOff£t
* 
	mm_pcSAO
;

80 
DoubÀ
 
	mm_dDecTime
;

81 
I¡
 
	mm_decodedPi˘uªHashSEIE«bÀd
;

82 
UI¡
 
	mm_numbîOfChecksumEº‹sDëe˘ed
;

84 
	mpublic
:

85 
TDecG›
();

86 
	mvútuÆ
 ~
TDecG›
();

88 
Void
 
öô
 ( 
TDecE¡r›y
* 
pcE¡r›yDecodî
,

89 
TDecSbac
* 
pcSbacDecodî
,

90 
TDecBöCABAC
* 
pcBöCABAC
,

91 
TDecCavlc
* 
pcCavlcDecodî
,

92 
TDecSli˚
* 
pcSli˚Decodî
,

93 
TComLo›Fûãr
* 
pcLo›Fûãr
,

94 
TComSam∂eAd≠tiveOff£t
* 
pcSAO


96 
Void
 
¸óã
 ();

97 
Void
 
de°roy
 ();

98 
Void
 
decom¥essSli˚
(
TComI≈utBô°ªam
* 
pcBô°ªam
, 
TComPic
* 
pcPic
 );

99 
Void
 
fûãrPi˘uª
 (
TComPic
* 
pcPic
 );

101 
Void
 
	$£tDecodedPi˘uªHashSEIE«bÀd
(
I¡
 
íabÀd
Ë{ 
m_decodedPi˘uªHashSEIE«bÀd
 =Énabled; }

102 
UI¡
 
	$gëNumbîOfChecksumEº‹sDëe˘ed
(Ëc⁄° {  
m_numbîOfChecksumEº‹sDëe˘ed
; 
	}
}

	@TLibDecoder/TDecSbac.cpp

38 
	~"TDecSbac.h
"

39 
	~"TLibComm⁄/TComTU.h
"

40 
	~"TLibComm⁄/TComTrQu™t.h
"

42 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


43 
	~"TLibComm⁄/TComCodögSèti°ics.h
"

45 
	#RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
a
Ë, 
	)
a

47 
	#RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
a
)

	)

53 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


54 
	~"../TLibComm⁄/Debug.h
"

62 
	gTDecSbac
::
	$TDecSbac
()

64 : 
	`m_pcBô°ªam
 ( 0 )

65 , 
	`m_pcTDecBöIf
 ( 
NULL
 )

66 , 
	`m_numC⁄ãxtModñs
 ( 0 )

67 , 
	`m_cCUS∂ôFœgSCModñ
 ( 1, 1, 
NUM_SPLIT_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

68 , 
	`m_cCUSkùFœgSCModñ
 ( 1, 1, 
NUM_SKIP_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

69 , 
	`m_cCUMîgeFœgExtSCModñ
 ( 1, 1, 
NUM_MERGE_FLAG_EXT_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

70 , 
	`m_cCUMîgeIdxExtSCModñ
 ( 1, 1, 
NUM_MERGE_IDX_EXT_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

71 , 
	`m_cCUP¨tSizeSCModñ
 ( 1, 1, 
NUM_PART_SIZE_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

72 , 
	`m_cCUPªdModeSCModñ
 ( 1, 1, 
NUM_PRED_MODE_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

73 , 
	`m_cCUI¡øPªdSCModñ
 ( 1, 1, 
NUM_INTRA_PREDICT_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

74 , 
	`m_cCUChromaPªdSCModñ
 ( 1, 1, 
NUM_CHROMA_PRED_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

75 , 
	`m_cCUDñèQpSCModñ
 ( 1, 1, 
NUM_DELTA_QP_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

76 , 
	`m_cCUI¡îDúSCModñ
 ( 1, 1, 
NUM_INTER_DIR_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

77 , 
	`m_cCURefPicSCModñ
 ( 1, 1, 
NUM_REF_NO_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

78 , 
	`m_cCUMvdSCModñ
 ( 1, 1, 
NUM_MV_RES_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

79 , 
	`m_cCUQtCbfSCModñ
 ( 1, 
NUM_QT_CBF_CTX_SETS
, 
NUM_QT_CBF_CTX_PER_SET
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

80 , 
	`m_cCUTønsSubdivFœgSCModñ
 ( 1, 1, 
NUM_TRANS_SUBDIV_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

81 , 
	`m_cCUQtRoŸCbfSCModñ
 ( 1, 1, 
NUM_QT_ROOT_CBF_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

82 , 
	`m_cCUSigC€ffGroupSCModñ
 ( 1, 2, 
NUM_SIG_CG_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

83 , 
	`m_cCUSigSCModñ
 ( 1, 1, 
NUM_SIG_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

84 , 
	`m_cCuCtxLa°X
 ( 1, 
NUM_CTX_LAST_FLAG_SETS
, 
NUM_CTX_LAST_FLAG_XY
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

85 , 
	`m_cCuCtxLa°Y
 ( 1, 
NUM_CTX_LAST_FLAG_SETS
, 
NUM_CTX_LAST_FLAG_XY
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

86 , 
	`m_cCUO√SCModñ
 ( 1, 1, 
NUM_ONE_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

87 , 
	`m_cCUAbsSCModñ
 ( 1, 1, 
NUM_ABS_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

88 , 
	`m_cMVPIdxSCModñ
 ( 1, 1, 
NUM_MVP_IDX_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

89 , 
	`m_cSaoMîgeSCModñ
 ( 1, 1, 
NUM_SAO_MERGE_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

90 , 
	`m_cSaoTy≥IdxSCModñ
 ( 1, 1, 
NUM_SAO_TYPE_IDX_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

91 , 
	`m_cTønsf‹mSkùSCModñ
 ( 1, 
MAX_NUM_CHANNEL_TYPE
, 
NUM_TRANSFORMSKIP_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

92 , 
	`m_CUTønsqu™tBy∑ssFœgSCModñ
 ( 1, 1, 
NUM_CU_TRANSQUANT_BYPASS_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

93 , 
	`m_ex∂icôRdpcmFœgSCModñ
 ( 1, 
MAX_NUM_CHANNEL_TYPE
, 
NUM_EXPLICIT_RDPCM_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

94 , 
	`m_ex∂icôRdpcmDúSCModñ
 ( 1, 
MAX_NUM_CHANNEL_TYPE
, 
NUM_EXPLICIT_RDPCM_DIR_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

95 , 
	`m_cCrossComp⁄ítPªdi˘i⁄SCModñ
 ( 1, 1, 
NUM_CROSS_COMPONENT_PREDICTION_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

96 , 
	`m_ChromaQpAdjFœgSCModñ
 ( 1, 1, 
NUM_CHROMA_QP_ADJ_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

97 , 
	`m_ChromaQpAdjIdcSCModñ
 ( 1, 1, 
NUM_CHROMA_QP_ADJ_IDC_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

99 
	`as£π
–
m_numC⁄ãxtModñs
 <
MAX_NUM_CTX_MOD
 );

100 
	}
}

102 
	gTDecSbac
::~
	$TDecSbac
()

104 
	}
}

110 
Void
 
TDecSbac
::
	$ª£tE¡r›y
(
TComSli˚
* 
pSli˚
)

112 
Sli˚Ty≥
 
¶i˚Ty≥
 = 
pSli˚
->
	`gëSli˚Ty≥
();

113 
I¡
 
qp
 = 
pSli˚
->
	`gëSli˚Qp
();

115 i‡(
pSli˚
->
	`gëPPS
()->
	`gëCabacInôPª£¡Fœg
(Ë&&ÖSli˚->
	`gëCabacInôFœg
())

117 
¶i˚Ty≥
)

119 
P_SLICE
:

120 
¶i˚Ty≥
 = 
B_SLICE
;

122 
B_SLICE
:

123 
¶i˚Ty≥
 = 
P_SLICE
;

126 
	`as£π
(0);

131 
m_cCUS∂ôFœgSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SPLIT_FLAG
 );

132 
m_cCUSkùFœgSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SKIP_FLAG
 );

133 
m_cCUMîgeFœgExtSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MERGE_FLAG_EXT
 );

134 
m_cCUMîgeIdxExtSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MERGE_IDX_EXT
 );

135 
m_cCUP¨tSizeSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_PART_SIZE
 );

136 
m_cCUPªdModeSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_PRED_MODE
 );

137 
m_cCUI¡øPªdSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_INTRA_PRED_MODE
 );

138 
m_cCUChromaPªdSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CHROMA_PRED_MODE
 );

139 
m_cCUI¡îDúSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_INTER_DIR
 );

140 
m_cCUMvdSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MVD
 );

141 
m_cCURefPicSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_REF_PIC
 );

142 
m_cCUDñèQpSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_DQP
 );

143 
m_cCUQtCbfSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_QT_CBF
 );

144 
m_cCUQtRoŸCbfSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_QT_ROOT_CBF
 );

145 
m_cCUSigC€ffGroupSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SIG_CG_FLAG
 );

146 
m_cCUSigSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SIG_FLAG
 );

147 
m_cCuCtxLa°X
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_LAST
 );

148 
m_cCuCtxLa°Y
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_LAST
 );

149 
m_cCUO√SCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_ONE_FLAG
 );

150 
m_cCUAbsSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_ABS_FLAG
 );

151 
m_cMVPIdxSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MVP_IDX
 );

152 
m_cSaoMîgeSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SAO_MERGE_FLAG
 );

153 
m_cSaoTy≥IdxSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SAO_TYPE_IDX
 );

154 
m_cCUTønsSubdivFœgSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_TRANS_SUBDIV_FLAG
 );

155 
m_cTønsf‹mSkùSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_TRANSFORMSKIP_FLAG
 );

156 
m_CUTønsqu™tBy∑ssFœgSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CU_TRANSQUANT_BYPASS_FLAG
 );

157 
m_ex∂icôRdpcmFœgSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_EXPLICIT_RDPCM_FLAG
);

158 
m_ex∂icôRdpcmDúSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_EXPLICIT_RDPCM_DIR
);

159 
m_cCrossComp⁄ítPªdi˘i⁄SCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CROSS_COMPONENT_PREDICTION
 );

160 
m_ChromaQpAdjFœgSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CHROMA_QP_ADJ_FLAG
 );

161 
m_ChromaQpAdjIdcSCModñ
.
	`öôBuf„r
 ( 
¶i˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CHROMA_QP_ADJ_IDC
 );

163 
UI¡
 
°©i°icIndex
 = 0; sèti°icIndex < 
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
 ; statisticIndex++)

165 
m_gﬁombRi˚Ad≠èti⁄Sèti°ics
[
°©i°icIndex
] = 0;

168 
m_pcTDecBöIf
->
	`°¨t
();

169 
	}
}

171 
Void
 
	gTDecSbac
::
	$∑r£Tîmö©ögBô
–
UI¡
& 
ruiBô
 )

173 
m_pcTDecBöIf
->
	`decodeBöTrm
–
ruiBô
 );

174 i‡–
ruiBô
 == 1 )

176 
m_pcTDecBöIf
->
	`föish
();

178 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


179 
TComCodögSèti°ics
::
	`In¸emítSèti°icEP
(
STATS__TRAILING_BITS
, 
m_pcBô°ªam
->
	`ªadOutTøûögBôs
(),0);

181 
m_pcBô°ªam
->
	`ªadOutTøûögBôs
();

184 
	}
}

186 
Void
 
	gTDecSbac
::
	$∑r£RemaöögByãs
–
Boﬁ
 
noTøûögByãsEx≥˘ed
 )

188 i‡(
noTøûögByãsEx≥˘ed
)

190 c⁄° 
UI¡
 
numbîOfRemaöögSub°ªamByãs
=
m_pcBô°ªam
->
	`gëNumBôsLe·
();

191 
	`as£π
 (
numbîOfRemaöögSub°ªamByãs
 == 0);

195 
m_pcBô°ªam
->
	`gëNumBôsLe·
())

197 
UI¡
 
åaûögNuŒByã
=
m_pcBô°ªam
->
	`ªadByã
();

198 i‡(
åaûögNuŒByã
!=0)

200 
	`¥ötf
("Tøûög byã should bê0, buàha†vÆuê%02x\n", 
åaûögNuŒByã
);

201 
	`as£π
(
åaûögNuŒByã
==0);

205 
	}
}

207 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


208 
Void
 
	gTDecSbac
::
	$xRódU«ryMaxSymbﬁ
–
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, UI¡ 
uiMaxSymbﬁ
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

210 
Void
 
TDecSbac
::
	$xRódU«ryMaxSymbﬁ
–
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, UI¡ 
uiMaxSymbﬁ
 )

213 i‡(
uiMaxSymbﬁ
 == 0)

215 
ruiSymbﬁ
 = 0;

219 
m_pcTDecBöIf
->
	`decodeBö
–
ruiSymbﬁ
, 
pcSCModñ
[0] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
) );

221 if–
ruiSymbﬁ
 =0 || 
uiMaxSymbﬁ
 == 1 )

226 
UI¡
 
uiSymbﬁ
 = 0;

227 
UI¡
 
uiC⁄t
;

231 
m_pcTDecBöIf
->
	`decodeBö
–
uiC⁄t
, 
pcSCModñ
[ 
iOff£t
 ] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
) );

232 
uiSymbﬁ
++;

233 }  
uiC⁄t
 && ( 
uiSymbﬁ
 < 
uiMaxSymbﬁ
 - 1 ) );

235 if–
uiC⁄t
 && ( 
uiSymbﬁ
 =
uiMaxSymbﬁ
 - 1 ) )

237 
uiSymbﬁ
++;

240 
ruiSymbﬁ
 = 
uiSymbﬁ
;

241 
	}
}

243 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


244 
Void
 
	gTDecSbac
::
	$xRódEpExGﬁomb
–
UI¡
& 
ruiSymbﬁ
, UI¡ 
uiCou¡
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

246 
Void
 
TDecSbac
::
	$xRódEpExGﬁomb
–
UI¡
& 
ruiSymbﬁ
, UI¡ 
uiCou¡
 )

249 
UI¡
 
uiSymbﬁ
 = 0;

250 
UI¡
 
uiBô
 = 1;

252  
uiBô
 )

254 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiBô
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
) );

255 
uiSymbﬁ
 +
uiBô
 << 
uiCou¡
++;

258 i‡–--
uiCou¡
 )

260 
UI¡
 
bös
;

261 
m_pcTDecBöIf
->
	`decodeBösEP
–
bös
, 
uiCou¡
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
) );

262 
uiSymbﬁ
 +
bös
;

265 
ruiSymbﬁ
 = 
uiSymbﬁ
;

266 
	}
}

268 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


269 
Void
 
	gTDecSbac
::
	$xRódU«rySymbﬁ
–
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

271 
Void
 
TDecSbac
::
	$xRódU«rySymbﬁ
–
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
 )

274 
m_pcTDecBöIf
->
	`decodeBö
–
ruiSymbﬁ
, 
pcSCModñ
[0] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
));

276 if–!
ruiSymbﬁ
 )

281 
UI¡
 
uiSymbﬁ
 = 0;

282 
UI¡
 
uiC⁄t
;

286 
m_pcTDecBöIf
->
	`decodeBö
–
uiC⁄t
, 
pcSCModñ
[ 
iOff£t
 ] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
));

287 
uiSymbﬁ
++;

288 }  
uiC⁄t
 );

290 
ruiSymbﬁ
 = 
uiSymbﬁ
;

291 
	}
}

300 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


301 
Void
 
	gTDecSbac
::
	$xRódC€fRemaöExGﬁomb
 ( 
UI¡
 &
rSymbﬁ
, UI¡ &
rP¨am
, c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 )

303 
Void
 
TDecSbac
::
	$xRódC€fRemaöExGﬁomb
 ( 
UI¡
 &
rSymbﬁ
, UI¡ &
rP¨am
, c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 )

306 
UI¡
 
¥efix
 = 0;

307 
UI¡
 
codeW‹d
 = 0;

309 i‡(
u£LimôedPªfixLígth
)

311 c⁄° 
UI¡
 
l⁄ge°PossibÀPªfix
 = (32 - (
COEF_REMAIN_BIN_REDUCTION
 + 
maxLog2TrDy«micR™ge
)) + COEF_REMAIN_BIN_REDUCTION;

315 
¥efix
++;

316 
m_pcTDecBöIf
->
	`decodeBöEP
–
codeW‹d
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
) );

317 } (
codeW‹d
 !0Ë&& (
¥efix
 < 
l⁄ge°PossibÀPªfix
));

323 
¥efix
++;

324 
m_pcTDecBöIf
->
	`decodeBöEP
–
codeW‹d
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
) );

325 }  
codeW‹d
);

328 
codeW‹d
 = 1 - codeWord;

329 
¥efix
 -
codeW‹d
;

330 
codeW‹d
=0;

332 i‡(
¥efix
 < 
COEF_REMAIN_BIN_REDUCTION
 )

334 
m_pcTDecBöIf
->
	`decodeBösEP
(
codeW‹d
,
rP¨am
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
));

335 
rSymbﬁ
 = (
¥efix
<<
rP¨am
Ë+ 
codeW‹d
;

337 i‡(
u£LimôedPªfixLígth
)

339 c⁄° 
UI¡
 
maximumPªfixLígth
 = (32 - (
COEF_REMAIN_BIN_REDUCTION
 + 
maxLog2TrDy«micR™ge
));

341 c⁄° 
UI¡
 
¥efixLígth
 = 
¥efix
 - 
COEF_REMAIN_BIN_REDUCTION
;

342 c⁄° 
UI¡
 
suffixLígth
 = (
¥efixLígth
 =
maximumPªfixLígth
Ë? (
maxLog2TrDy«micR™ge
 - 
rP¨am
) :ÖrefixLength;

344 
m_pcTDecBöIf
->
	`decodeBösEP
(
codeW‹d
, (
suffixLígth
 + 
rP¨am
Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
));

346 
rSymbﬁ
 = 
codeW‹d
 + ((((1 << 
¥efixLígth
Ë- 1Ë+ 
COEF_REMAIN_BIN_REDUCTION
Ë<< 
rP¨am
);

350 
m_pcTDecBöIf
->
	`decodeBösEP
(
codeW‹d
,
¥efix
-
COEF_REMAIN_BIN_REDUCTION
+
rP¨am
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
whichSèt
));

351 
rSymbﬁ
 = (((1<<(
¥efix
-
COEF_REMAIN_BIN_REDUCTION
))+COEF_REMAIN_BIN_REDUCTION-1)<<
rP¨am
)+
codeW‹d
;

353 
	}
}

364 
Void
 
	gTDecSbac
::
	$∑r£IPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

366 
UI¡
 
uiSymbﬁ
;

368 
m_pcTDecBöIf
->
	`decodeBöTrm
(
uiSymbﬁ
);

370 i‡(
uiSymbﬁ
 == 1)

372 
Boﬁ
 
bIpcmFœg
 = 
åue
;

373 c⁄° 
TComSPS
 &
•s
=*(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

375 
pcCU
->
	`£tP¨tSizeSubP¨ts
 ( 
SIZE_2Nx2N
, 
uiAbsP¨tIdx
, 
uiDïth
 );

376 
pcCU
->
	`£tSizeSubP¨ts
 ( 
•s
.
	`gëMaxCUWidth
()>>
uiDïth
, sps.
	`gëMaxCUHeight
()>>uiDïth, 
uiAbsP¨tIdx
, uiDepth );

377 
pcCU
->
	`£tTrIdxSubP¨ts
 ( 0, 
uiAbsP¨tIdx
, 
uiDïth
 );

378 
pcCU
->
	`£tIPCMFœgSubP¨ts
 ( 
bIpcmFœg
, 
uiAbsP¨tIdx
, 
uiDïth
 );

380 c⁄° 
UI¡
 
möC€ffSizeY
 = 
pcCU
->
	`gëPic
()->
	`gëMöCUWidth
(Ë*ÖcCU->gëPic()->
	`gëMöCUHeight
();

381 c⁄° 
UI¡
 
off£tY
 = 
möC€ffSizeY
 * 
uiAbsP¨tIdx
;

382 
UI¡
 
ch
=0; ch < 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
(); ch++)

384 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

385 c⁄° 
UI¡
 
off£t
 = 
off£tY
 >> (
pcCU
->
	`gëPic
()->
	`gëComp⁄ítSˇÀX
(
compID
Ë+ÖcCU->gëPic()->
	`gëComp⁄ítSˇÀY
(compID));

386 
Pñ
 * 
pPCMSam∂e
 = 
pcCU
->
	`gëPCMSam∂e
(
compID
Ë+ 
off£t
;

387 c⁄° 
UI¡
 
width
 = 
pcCU
->
	`gëWidth
 (
uiAbsP¨tIdx
Ë>>ÖcCU->
	`gëPic
()->
	`gëComp⁄ítSˇÀX
(
compID
);

388 c⁄° 
UI¡
 
height
 = 
pcCU
->
	`gëHeight
(
uiAbsP¨tIdx
Ë>>ÖcCU->
	`gëPic
()->
	`gëComp⁄ítSˇÀY
(
compID
);

389 c⁄° 
UI¡
 
ßm∂eBôs
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPCMBôDïth
(
	`toCh™√lTy≥
(
compID
));

390 
UI¡
 
y
=0; y<
height
; y++)

392 
UI¡
 
x
=0; x<
width
; x++)

394 
UI¡
 
ßm∂e
;

395 
m_pcTDecBöIf
->
	`xRódPCMCode
(
ßm∂eBôs
, 
ßm∂e
);

396 
pPCMSam∂e
[
x
] = 
ßm∂e
;

398 
pPCMSam∂e
 +
width
;

402 
m_pcTDecBöIf
->
	`°¨t
();

404 
	}
}

406 
Void
 
	gTDecSbac
::
	$∑r£CUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

408 
UI¡
 
uiSymbﬁ
;

409 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_CUTønsqu™tBy∑ssFœgSCModñ
.
	`gë
–0, 0, 0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__TQ_BYPASS_FLAG
) );

410 
pcCU
->
	`£tCUTønsqu™tBy∑ssSubP¨ts
(
uiSymbﬁ
 ? 
åue
 : 
Ál£
, 
uiAbsP¨tIdx
, 
uiDïth
);

411 
	}
}

419 
Void
 
	gTDecSbac
::
	$∑r£SkùFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

421 if–
pcCU
->
	`gëSli˚
()->
	`isI¡ø
() )

426 
UI¡
 
uiSymbﬁ
 = 0;

427 
UI¡
 
uiCtxSkù
 = 
pcCU
->
	`gëCtxSkùFœg
–
uiAbsP¨tIdx
 );

428 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_cCUSkùFœgSCModñ
.
	`gë
–0, 0, 
uiCtxSkù
 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SKIP_FLAG
) );

429 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

430 
	`DTRACE_CABAC_T
( "\tSkipFlag" );

431 
	`DTRACE_CABAC_T
( "\tuiCtxSkip: ");

432 
	`DTRACE_CABAC_V
–
uiCtxSkù
 );

433 
	`DTRACE_CABAC_T
( "\tuiSymbol: ");

434 
	`DTRACE_CABAC_V
–
uiSymbﬁ
 );

435 
	`DTRACE_CABAC_T
( "\n");

437 if–
uiSymbﬁ
 )

439 
pcCU
->
	`£tSkùFœgSubP¨ts
–
åue
, 
uiAbsP¨tIdx
, 
uiDïth
 );

440 
pcCU
->
	`£tPªdModeSubP¨ts
–
MODE_INTER
, 
uiAbsP¨tIdx
, 
uiDïth
 );

441 
pcCU
->
	`£tP¨tSizeSubP¨ts
–
SIZE_2Nx2N
, 
uiAbsP¨tIdx
, 
uiDïth
 );

442 
pcCU
->
	`£tSizeSubP¨ts
–pcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()>>
uiDïth
,ÖcCU->gëSli˚()->gëSPS()->
	`gëMaxCUHeight
()>>uiDïth, 
uiAbsP¨tIdx
, uiDepth );

443 
pcCU
->
	`£tMîgeFœgSubP¨ts
–
åue
 , 
uiAbsP¨tIdx
, 0, 
uiDïth
 );

445 
	}
}

455 
Void
 
	gTDecSbac
::
	$∑r£MîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiPUIdx
 )

457 
UI¡
 
uiSymbﬁ
;

458 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, *
m_cCUMîgeFœgExtSCModñ
.
	`gë
–0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MERGE_FLAG
) );

459 
pcCU
->
	`£tMîgeFœgSubP¨ts
–
uiSymbﬁ
 ? 
åue
 : 
Ál£
, 
uiAbsP¨tIdx
, 
uiPUIdx
, 
uiDïth
 );

461 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

462 
	`DTRACE_CABAC_T
( "\tMergeFlag: " );

463 
	`DTRACE_CABAC_V
–
uiSymbﬁ
 );

464 
	`DTRACE_CABAC_T
( "\tAddress: " );

465 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCtuRsAddr
() );

466 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx: " );

467 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 );

468 
	`DTRACE_CABAC_T
( "\n" );

469 
	}
}

471 
Void
 
	gTDecSbac
::
	$∑r£MîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiMîgeIndex
 )

473 
UI¡
 
uiU«ryIdx
 = 0;

474 
UI¡
 
uiNumC™d
 = 
pcCU
->
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
();

475 i‡–
uiNumC™d
 > 1 )

477  ; 
uiU«ryIdx
 < 
uiNumC™d
 - 1; ++uiUnaryIdx )

479 
UI¡
 
uiSymbﬁ
 = 0;

480 i‡–
uiU«ryIdx
==0 )

482 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_cCUMîgeIdxExtSCModñ
.
	`gë
–0, 0, 0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MERGE_INDEX
) );

486 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiSymbﬁ
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MERGE_INDEX
) );

488 if–
uiSymbﬁ
 == 0 )

494 
ruiMîgeIndex
 = 
uiU«ryIdx
;

496 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

497 
	`DTRACE_CABAC_T
( "\tparseMergeIndex()" )

498 
	`DTRACE_CABAC_T
( "\tuiMRGIdx= " )

499 
	`DTRACE_CABAC_V
–
ruiMîgeIndex
 )

500 
	`DTRACE_CABAC_T
( "\n" )

501 
	}
}

503 
Void
 
	gTDecSbac
::
	$∑r£MVPIdx
 ( 
I¡
& 
riMVPIdx
 )

505 
UI¡
 
uiSymbﬁ
;

506 
	`xRódU«ryMaxSymbﬁ
(
uiSymbﬁ
, 
m_cMVPIdxSCModñ
.
	`gë
(0), 1, 
AMVP_MAX_NUM_CANDS
-1 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVP_IDX
) );

507 
riMVPIdx
 = 
uiSymbﬁ
;

508 
	}
}

510 
Void
 
	gTDecSbac
::
	$∑r£S∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

512 if–
uiDïth
 =
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëLog2DiffMaxMöCodögBlockSize
() )

514 
pcCU
->
	`£tDïthSubP¨ts
–
uiDïth
, 
uiAbsP¨tIdx
 );

517 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


518 c⁄° 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__CABAC_BITS__SPLIT_FLAG
, 
g_aucC⁄vîtToBô
[
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()>>
uiDïth
]+2);

521 
UI¡
 
uiSymbﬁ
;

522 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_cCUS∂ôFœgSCModñ
.
	`gë
–0, 0, 
pcCU
->
	`gëCtxS∂ôFœg
–
uiAbsP¨tIdx
, 
uiDïth
 ) ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

523 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

524 
	`DTRACE_CABAC_T
( "\tSplitFlag\n" )

525 
pcCU
->
	`£tDïthSubP¨ts
–
uiDïth
 + 
uiSymbﬁ
, 
uiAbsP¨tIdx
 );

528 
	}
}

536 
Void
 
	gTDecSbac
::
	$∑r£P¨tSize
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

538 
UI¡
 
uiSymbﬁ
, 
uiMode
 = 0;

539 
P¨tSize
 
eMode
;

540 c⁄° 
UCh¨
 
cuWidth
 =
	`UCh¨
(
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()>>
uiDïth
);

541 c⁄° 
UCh¨
 
cuHeight
=
	`UCh¨
(
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUHeight
()>>
uiDïth
);

542 c⁄° 
I¡
 
log2DiffMaxMöCodögBlockSize
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëLog2DiffMaxMöCodögBlockSize
();

544 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


545 c⁄° 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__CABAC_BITS__PART_SIZE
, 
g_aucC⁄vîtToBô
[
cuWidth
]+2);

548 
	`as£π
 ( 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëLog2DiffMaxMöCodögBlockSize
(Ë=
log2DiffMaxMöCodögBlockSize
);

549 i‡–
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) )

551 
uiSymbﬁ
 = 1;

552 if–
uiDïth
 =
log2DiffMaxMöCodögBlockSize
 )

554 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_cCUP¨tSizeSCModñ
.
	`gë
–0, 0, 0Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

556 
eMode
 = 
uiSymbﬁ
 ? 
SIZE_2Nx2N
 : 
SIZE_NxN
;

557 
UI¡
 
uiTrLevñ
 = 0;

558 
UI¡
 
uiWidthInBô
 = 
g_aucC⁄vîtToBô
[
pcCU
->
	`gëWidth
(
uiAbsP¨tIdx
)]+2;

559 
UI¡
 
uiTrSizeInBô
 = 
g_aucC⁄vîtToBô
[
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxTrSize
()]+2;

560 
uiTrLevñ
 = 
uiWidthInBô
 >
uiTrSizeInBô
 ? uiWidthInBit - uiTrSizeInBit : 0;

561 if–
eMode
 =
SIZE_NxN
 )

563 
pcCU
->
	`£tTrIdxSubP¨ts
–1+
uiTrLevñ
, 
uiAbsP¨tIdx
, 
uiDïth
 );

567 
pcCU
->
	`£tTrIdxSubP¨ts
–
uiTrLevñ
, 
uiAbsP¨tIdx
, 
uiDïth
 );

572 
UI¡
 
uiMaxNumBôs
 = 2;

574 if–
uiDïth
 =
log2DiffMaxMöCodögBlockSize
 && !–
cuWidth
 =8 && 
cuHeight
 == 8 ) )

576 
uiMaxNumBôs
 ++;

579  
UI¡
 
ui
 = 0; uò< 
uiMaxNumBôs
; ui++ )

581 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_cCUP¨tSizeSCModñ
.
	`gë
–0, 0, 
ui
Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

582 i‡–
uiSymbﬁ
 )

586 
uiMode
++;

588 
eMode
 = (
P¨tSize
Ë
uiMode
;

589 i‡–
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëU£AMP
(Ë&& 
uiDïth
 < 
log2DiffMaxMöCodögBlockSize
 )

591 i‡(
eMode
 =
SIZE_2NxN
)

593 
m_pcTDecBöIf
->
	`decodeBö
(
uiSymbﬁ
, 
m_cCUP¨tSizeSCModñ
.
	`gë
–0, 0, 3 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
));

594 i‡(
uiSymbﬁ
 == 0)

596 
m_pcTDecBöIf
->
	`decodeBöEP
(
uiSymbﬁ
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

597 
eMode
 = (
uiSymbﬁ
 =0? 
SIZE_2NxnU
 : 
SIZE_2NxnD
);

600 i‡(
eMode
 =
SIZE_Nx2N
)

602 
m_pcTDecBöIf
->
	`decodeBö
(
uiSymbﬁ
, 
m_cCUP¨tSizeSCModñ
.
	`gë
–0, 0, 3 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

603 i‡(
uiSymbﬁ
 == 0)

605 
m_pcTDecBöIf
->
	`decodeBöEP
(
uiSymbﬁ
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

606 
eMode
 = (
uiSymbﬁ
 =0? 
SIZE_nLx2N
 : 
SIZE_nRx2N
);

611 
pcCU
->
	`£tP¨tSizeSubP¨ts
–
eMode
, 
uiAbsP¨tIdx
, 
uiDïth
 );

612 
pcCU
->
	`£tSizeSubP¨ts
–
cuWidth
, 
cuHeight
, 
uiAbsP¨tIdx
, 
uiDïth
 );

613 
	}
}

622 
Void
 
	gTDecSbac
::
	$∑r£PªdMode
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

624 if–
pcCU
->
	`gëSli˚
()->
	`isI¡ø
() )

626 
pcCU
->
	`£tPªdModeSubP¨ts
–
MODE_INTRA
, 
uiAbsP¨tIdx
, 
uiDïth
 );

630 
UI¡
 
uiSymbﬁ
;

631 
I¡
 
iPªdMode
 = 
MODE_INTER
;

632 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_cCUPªdModeSCModñ
.
	`gë
–0, 0, 0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__PRED_MODE
) );

633 
iPªdMode
 +
uiSymbﬁ
;

634 
pcCU
->
	`£tPªdModeSubP¨ts
–(
PªdMode
)
iPªdMode
, 
uiAbsP¨tIdx
, 
uiDïth
 );

635 
	}
}

638 
Void
 
	gTDecSbac
::
	$∑r£I¡øDúLumaAng
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
 )

640 
P¨tSize
 
mode
 = 
pcCU
->
	`gëP¨tôi⁄Size
–
absP¨tIdx
 );

641 
UI¡
 
∑πNum
 = 
mode
==
SIZE_NxN
?4:1;

642 
UI¡
 
∑πOff£t
 = ( 
pcCU
->
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (ÖcCU->
	`gëDïth
(
absP¨tIdx
) << 1 ) ) >> 2;

643 
UI¡
 
mpmPªd
[4],
symbﬁ
;

644 
I¡
 
j
,
öåaPªdMode
;

645 i‡(
mode
==
SIZE_NxN
)

647 
dïth
++;

649 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


650 c⁄° 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__CABAC_BITS__INTRA_DIR_ANG
, 
g_aucC⁄vîtToBô
[
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()>>
dïth
]+2, 
CHANNEL_TYPE_LUMA
);

652 
j
=0;j<
∑πNum
;j++)

654 
m_pcTDecBöIf
->
	`decodeBö
–
symbﬁ
, 
m_cCUI¡øPªdSCModñ
.
	`gë
–0, 0, 0Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

655 
mpmPªd
[
j
] = 
symbﬁ
;

657 
j
=0;j<
∑πNum
;j++)

659 
I¡
 
¥eds
[
NUM_MOST_PROBABLE_MODES
] = {-1, -1, -1};

660 
pcCU
->
	`gëI¡øDúPªdi˘‹
(
absP¨tIdx
+
∑πOff£t
*
j
, 
¥eds
, 
COMPONENT_Y
);

661 i‡(
mpmPªd
[
j
])

663 
m_pcTDecBöIf
->
	`decodeBöEP
–
symbﬁ
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

664 i‡(
symbﬁ
)

666 
m_pcTDecBöIf
->
	`decodeBöEP
–
symbﬁ
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

667 
symbﬁ
++;

669 
öåaPªdMode
 = 
¥eds
[
symbﬁ
];

673 
m_pcTDecBöIf
->
	`decodeBösEP
–
symbﬁ
, 5 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

674 
öåaPªdMode
 = 
symbﬁ
;

677 i‡(
¥eds
[0] >Öreds[1])

679 
°d
::
	`sw≠
(
¥eds
[0],Öreds[1]);

681 i‡(
¥eds
[0] >Öreds[2])

683 
°d
::
	`sw≠
(
¥eds
[0],Öreds[2]);

685 i‡(
¥eds
[1] >Öreds[2])

687 
°d
::
	`sw≠
(
¥eds
[1],Öreds[2]);

689  
UI¡
 
i
 = 0; i < 
NUM_MOST_PROBABLE_MODES
; i++ )

691 
öåaPªdMode
 +–öåaPªdModê>
¥eds
[
i
] );

694 
pcCU
->
	`£tI¡øDúSubP¨ts
(
CHANNEL_TYPE_LUMA
, (
UCh¨
)
öåaPªdMode
, 
absP¨tIdx
+
∑πOff£t
*
j
, 
dïth
 );

696 
	}
}

699 
Void
 
	gTDecSbac
::
	$∑r£I¡øDúChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

701 
UI¡
 
uiSymbﬁ
;

702 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


703 c⁄° 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__CABAC_BITS__INTRA_DIR_ANG
, 
g_aucC⁄vîtToBô
[
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()>>
uiDïth
]+2, 
CHANNEL_TYPE_CHROMA
);

706 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, 
m_cCUChromaPªdSCModñ
.
	`gë
–0, 0, 0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

707 if–
uiSymbﬁ
 == 0 )

709 
uiSymbﬁ
 = 
DM_CHROMA_IDX
;

713 
UI¡
 
uiIPªdMode
;

714 
m_pcTDecBöIf
->
	`decodeBösEP
–
uiIPªdMode
, 2 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

715 
UI¡
 
uiAŒowedChromaDú
[ 
NUM_CHROMA_MODE
 ];

716 
pcCU
->
	`gëAŒowedChromaDú
–
uiAbsP¨tIdx
, 
uiAŒowedChromaDú
 );

717 
uiSymbﬁ
 = 
uiAŒowedChromaDú
[ 
uiIPªdMode
 ];

720 
pcCU
->
	`£tI¡øDúSubP¨ts
–
CHANNEL_TYPE_CHROMA
, 
uiSymbﬁ
, 
uiAbsP¨tIdx
, 
uiDïth
 );

721 
	}
}

724 
Void
 
	gTDecSbac
::
	$∑r£I¡îDú
–
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiI¡îDú
, UI¡ 
uiAbsP¨tIdx
 )

726 
UI¡
 
uiSymbﬁ
;

727 c⁄° 
UI¡
 
uiCtx
 = 
pcCU
->
	`gëCtxI¡îDú
–
uiAbsP¨tIdx
 );

728 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCUI¡îDúSCModñ
.
	`gë
( 0 );

730 
uiSymbﬁ
 = 0;

731 i‡(
pcCU
->
	`gëP¨tôi⁄Size
(
uiAbsP¨tIdx
Ë=
SIZE_2Nx2N
 ||ÖcCU->
	`gëHeight
(uiAbsPartIdx) != 8 )

733 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, *–
pCtx
 + 
uiCtx
 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__INTER_DIR
) );

736 if–
uiSymbﬁ
 )

738 
uiSymbﬁ
 = 2;

742 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, *–
pCtx
 + 4 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__INTER_DIR
) );

743 
	`as£π
(
uiSymbﬁ
 == 0 || uiSymbol == 1);

746 
uiSymbﬁ
++;

747 
ruiI¡îDú
 = 
uiSymbﬁ
;

749 
	}
}

751 
Void
 
	gTDecSbac
::
	$∑r£RefFrmIdx
–
TComD©aCU
* 
pcCU
, 
I¡
& 
riRefFrmIdx
, 
RefPicLi°
 
eRefLi°
 )

753 
UI¡
 
uiSymbﬁ
;

755 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCURefPicSCModñ
.
	`gë
( 0 );

756 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, *
pCtx
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__REF_FRM_IDX
) );

758 if–
uiSymbﬁ
 )

760 
UI¡
 
uiRefNum
 = 
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
eRefLi°
 ) - 2;

761 
pCtx
++;

762 
UI¡
 
ui
;

763  
ui
 = 0; uò< 
uiRefNum
; ++ui )

765 if–
ui
 == 0 )

767 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, *
pCtx
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__REF_FRM_IDX
) );

771 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiSymbﬁ
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__REF_FRM_IDX
) );

773 if–
uiSymbﬁ
 == 0 )

778 
uiSymbﬁ
 = 
ui
 + 1;

780 
riRefFrmIdx
 = 
uiSymbﬁ
;

783 
	}
}

785 
Void
 
	gTDecSbac
::
	$∑r£Mvd
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
, 
RefPicLi°
 
eRefLi°
 )

787 
UI¡
 
uiSymbﬁ
;

788 
UI¡
 
uiH‹Abs
;

789 
UI¡
 
uiVîAbs
;

790 
UI¡
 
uiH‹Sign
 = 0;

791 
UI¡
 
uiVîSign
 = 0;

792 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCUMvdSCModñ
.
	`gë
( 0 );

794 if(
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
(Ë&& 
eRefLi°
 =
REF_PIC_LIST_1
 &&ÖcCU->
	`gëI¡îDú
(
uiAbsP¨tIdx
)==3)

796 
uiH‹Abs
=0;

797 
uiVîAbs
=0;

801 
m_pcTDecBöIf
->
	`decodeBö
–
uiH‹Abs
, *
pCtx
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD
) );

802 
m_pcTDecBöIf
->
	`decodeBö
–
uiVîAbs
, *
pCtx
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD
) );

804 c⁄° 
Boﬁ
 
bH‹AbsGr0
 = 
uiH‹Abs
 != 0;

805 c⁄° 
Boﬁ
 
bVîAbsGr0
 = 
uiVîAbs
 != 0;

806 
pCtx
++;

808 if–
bH‹AbsGr0
 )

810 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, *
pCtx
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD
) );

811 
uiH‹Abs
 +
uiSymbﬁ
;

814 if–
bVîAbsGr0
 )

816 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
, *
pCtx
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD
) );

817 
uiVîAbs
 +
uiSymbﬁ
;

820 if–
bH‹AbsGr0
 )

822 if–2 =
uiH‹Abs
 )

824 
	`xRódEpExGﬁomb
–
uiSymbﬁ
, 1 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD_EP
) );

825 
uiH‹Abs
 +
uiSymbﬁ
;

828 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiH‹Sign
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD_EP
) );

831 if–
bVîAbsGr0
 )

833 if–2 =
uiVîAbs
 )

835 
	`xRódEpExGﬁomb
–
uiSymbﬁ
, 1 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD_EP
) );

836 
uiVîAbs
 +
uiSymbﬁ
;

839 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiVîSign
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__MVD_EP
) );

844 c⁄° 
TComMv
 
	`cMv
–
uiH‹Sign
 ? -
	`I¡
–
uiH‹Abs
 ): uiH‹Abs, 
uiVîSign
 ? -I¡–
uiVîAbs
 ) : uiVerAbs );

845 
pcCU
->
	`gëCUMvFõld
–
eRefLi°
 )->
	`£tAŒMvd
–
cMv
,ÖcCU->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 ), uiAbsP¨tIdx, 
uiDïth
, 
uiP¨tIdx
 );

847 
	}
}

849 
Void
 
	gTDecSbac
::
	$∑r£CrossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 )

851 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

853 if–
	`isLuma
(
compID
Ë|| !
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
() )

858 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

860 i‡(!
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
Ë|| (pcCU->
	`gëI¡øDú
–
CHANNEL_TYPE_CHROMA
, uiAbsP¨tIdx ) =
DM_CHROMA_IDX
))

862 
SCh¨
 
Æpha
 = 0;

863 
UI¡
 
symbﬁ
 = 0;

865 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

866 
	`DTRACE_CABAC_T
("\tparseCrossComponentPrediction()")

867 
	`DTRACE_CABAC_T
( "\tAddr=" )

868 
	`DTRACE_CABAC_V
–
compID
 )

869 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

870 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 )

871 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


872 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__CABAC_BITS__CROSS_COMPONENT_PREDICTION
, (
g_aucC⁄vîtToBô
[
rTu
.
	`gëRe˘
(
compID
).
width
] + 2), compID);

874 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCrossComp⁄ítPªdi˘i⁄SCModñ
.
	`gë
(0, 0Ë+ ((
compID
 =
COMPONENT_Cr
Ë? (
NUM_CROSS_COMPONENT_PREDICTION_CTX
 >> 1) : 0);

875 
m_pcTDecBöIf
->
	`decodeBö
–
symbﬁ
, 
pCtx
[0] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

877 if(
symbﬁ
 != 0)

880 
UI¡
 
sign
 = 0;

881 
m_pcTDecBöIf
->
	`decodeBö
–
symbﬁ
, 
pCtx
[1] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

883 i‡(
symbﬁ
 != 0)

887 
	`xRódU«ryMaxSymbﬁ
–
symbﬁ
, (
pCtx
 + 2), 1, 2 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

888 
symbﬁ
 += 1;

890 
m_pcTDecBöIf
->
	`decodeBö
–
sign
, 
pCtx
[4] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

892 
Æpha
 = (
sign
 !0Ë? -(1 << 
symbﬁ
) : (1 << symbol);

894 
	`DTRACE_CABAC_T
( "\tAlpha=" )

895 
	`DTRACE_CABAC_V
–
Æpha
 )

896 
	`DTRACE_CABAC_T
( "\n" )

898 
pcCU
->
	`£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
–
Æpha
, 
compID
, 
uiAbsP¨tIdx
, 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
( compID ) );

900 
	}
}

902 
Void
 
	gTDecSbac
::
	$∑r£Tønsf‹mSubdivFœg
–
UI¡
& 
ruiSubdivFœg
, UI¡ 
uiLog2Tønsf‹mBlockSize
 )

904 
m_pcTDecBöIf
->
	`decodeBö
–
ruiSubdivFœg
, 
m_cCUTønsSubdivFœgSCModñ
.
	`gë
–0, 0, 
uiLog2Tønsf‹mBlockSize
 )

905 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
	`TComCodögSèti°icsCœssTy≥
(
STATS__CABAC_BITS__TRANSFORM_SUBDIV_FLAG
, 5-
uiLog2Tønsf‹mBlockSize
))

907 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

908 
	`DTRACE_CABAC_T
( "\tparseTransformSubdivFlag()" )

909 
	`DTRACE_CABAC_T
( "\tsymbol=" )

910 
	`DTRACE_CABAC_V
–
ruiSubdivFœg
 )

911 
	`DTRACE_CABAC_T
( "\tctx=" )

912 
	`DTRACE_CABAC_V
–
uiLog2Tønsf‹mBlockSize
 )

913 
	`DTRACE_CABAC_T
( "\n" )

914 
	}
}

916 
Void
 
	gTDecSbac
::
	$∑r£QtRoŸCbf
–
UI¡
 
uiAbsP¨tIdx
, UI¡& 
uiQtRoŸCbf
 )

918 
UI¡
 
uiSymbﬁ
;

919 c⁄° 
UI¡
 
uiCtx
 = 0;

920 
m_pcTDecBöIf
->
	`decodeBö
–
uiSymbﬁ
 , 
m_cCUQtRoŸCbfSCModñ
.
	`gë
–0, 0, 
uiCtx
 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__QT_ROOT_CBF
) );

921 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

922 
	`DTRACE_CABAC_T
( "\tparseQtRootCbf()" )

923 
	`DTRACE_CABAC_T
( "\tsymbol=" )

924 
	`DTRACE_CABAC_V
–
uiSymbﬁ
 )

925 
	`DTRACE_CABAC_T
( "\tctx=" )

926 
	`DTRACE_CABAC_V
–
uiCtx
 )

927 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

928 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 )

929 
	`DTRACE_CABAC_T
( "\n" )

931 
uiQtRoŸCbf
 = 
uiSymbﬁ
;

932 
	}
}

934 
Void
 
	gTDecSbac
::
	$∑r£DñèQP
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

936 
I¡
 
qp
;

937 
UI¡
 
uiDQp
;

938 
I¡
 
iDQp
;

940 
UI¡
 
uiSymbﬁ
;

942 
	`xRódU«ryMaxSymbﬁ
 (
uiDQp
, &
m_cCUDñèQpSCModñ
.
	`gë
–0, 0, 0 ), 1, 
CU_DQP_TU_CMAX
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__DELTA_QP_EP
) );

944 if–
uiDQp
 >
CU_DQP_TU_CMAX
)

946 
	`xRódEpExGﬁomb
–
uiSymbﬁ
, 
CU_DQP_EG_k
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__DELTA_QP_EP
));

947 
uiDQp
+=
uiSymbﬁ
;

950 i‡–
uiDQp
 > 0 )

952 
UI¡
 
uiSign
;

953 
I¡
 
qpBdOff£tY
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
);

954 
m_pcTDecBöIf
->
	`decodeBöEP
(
uiSign
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__DELTA_QP_EP
));

955 
iDQp
 = 
uiDQp
;

956 if(
uiSign
)

958 
iDQp
 = -iDQp;

960 
qp
 = (((
I¡
Ë
pcCU
->
	`gëRefQP
–
uiAbsP¨tIdx
 ) + 
iDQp
 + 52 + 2*
qpBdOff£tY
 )%(52+qpBdOffsetY)) - qpBdOffsetY;

964 
qp
 = 
pcCU
->
	`gëRefQP
(
uiAbsP¨tIdx
);

967 
pcCU
->
	`£tQPSubP¨ts
(
qp
, 
uiAbsP¨tIdx
, 
uiDïth
);

968 
pcCU
->
	`£tCodedQP
(
qp
);

969 
	}
}

974 
Void
 
	gTDecSbac
::
	$∑r£ChromaQpAdju°mít
–
TComD©aCU
* 
cu
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
 )

976 
UI¡
 
symbﬁ
;

977 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


978 c⁄° 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__CABAC_BITS__CHROMA_QP_ADJUSTMENT
, 
g_aucC⁄vîtToBô
[
cu
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()>>
dïth
]+2, 
CHANNEL_TYPE_CHROMA
);

981 
I¡
 
chromaQpOff£tLi°Lí
 = 
cu
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°Lí
();

984 
m_pcTDecBöIf
->
	`decodeBö
–
symbﬁ
, 
m_ChromaQpAdjFœgSCModñ
.
	`gë
–0, 0, 0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

986 i‡(
symbﬁ
 && 
chromaQpOff£tLi°Lí
 > 1)

989 
	`xRódU«ryMaxSymbﬁ
–
symbﬁ
, &
m_ChromaQpAdjIdcSCModñ
.
	`gë
–0, 0, 0 ), 0, 
chromaQpOff£tLi°Lí
 - 1 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

990 
symbﬁ
++;

995 
cu
->
	`£tChromaQpAdjSubP¨ts
–
symbﬁ
, 
absP¨tIdx
, 
dïth
 );

996 
cu
->
	`£tCodedChromaQpAdj
(
symbﬁ
);

997 
	}
}

999 
Void
 
	gTDecSbac
::
	$∑r£QtCbf
–
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 )

1001 
TComD©aCU
* 
pcCU
 = 
rTu
.
	`gëCU
();

1003 c⁄° 
UI¡
 
absP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
(
compID
);

1004 c⁄° 
UI¡
 
TUDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

1005 c⁄° 
UI¡
 
uiCtx
 = 
pcCU
->
	`gëCtxQtCbf
–
rTu
, 
	`toCh™√lTy≥
(
compID
) );

1006 c⁄° 
UI¡
 
c⁄ãxtSë
 = 
	`toCh™√lTy≥
(
compID
);

1008 c⁄° 
UI¡
 
width
 = 
rTu
.
	`gëRe˘
(
compID
).width;

1009 c⁄° 
UI¡
 
height
 = 
rTu
.
	`gëRe˘
(
compID
).height;

1010 c⁄° 
Boﬁ
 
ˇnQuadS∂ô
 = (
width
 >(
MIN_TU_SIZE
 * 2)Ë&& (
height
 >= (MIN_TU_SIZE * 2));

1011 c⁄° 
UI¡
 
covîedP¨tIdxes
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
);

1027 c⁄° 
UI¡
 
lowe°TUDïth
 = 
TUDïth
 + ((!
lowe°Levñ
 && !
ˇnQuadS∂ô
) ? 1 : 0);

1028 
UI¡
 
lowe°TUCBF
 = 0;

1030 i‡((
width
 !
height
Ë&& (
lowe°Levñ
 || !
ˇnQuadS∂ô
))

1032 c⁄° 
UI¡
 
subTUDïth
 = 
lowe°TUDïth
 + 1;

1033 c⁄° 
UI¡
 
∑πIdxesPîSubTU
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
) >> 1;

1035 
UI¡
 
comböedSubTUCBF
 = 0;

1037 
UI¡
 
subTU
 = 0; subTU < 2; subTU++)

1039 
UI¡
 
uiCbf
 = 
MAX_UINT
;

1040 
m_pcTDecBöIf
->
	`decodeBö
(
uiCbf
, 
m_cCUQtCbfSCModñ
.
	`gë
(0, 
c⁄ãxtSë
, 
uiCtx
Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
	`TComCodögSèti°icsCœssTy≥
(
STATS__CABAC_BITS__QT_CBF
, 
g_aucC⁄vîtToBô
[
rTu
.
	`gëRe˘
(
compID
).
width
]+2, compID)));

1042 c⁄° 
UI¡
 
subTUAbsP¨tIdx
 = 
absP¨tIdx
 + (
subTU
 * 
∑πIdxesPîSubTU
);

1043 
pcCU
->
	`£tCbfP¨tR™ge
((
uiCbf
 << 
subTUDïth
), 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
);

1044 
comböedSubTUCBF
 |
uiCbf
;

1046 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

1047 
	`DTRACE_CABAC_T
( "\tparseQtCbf()" )

1048 
	`DTRACE_CABAC_T
( "\tsub-TU=" )

1049 
	`DTRACE_CABAC_V
–
subTU
 )

1050 
	`DTRACE_CABAC_T
( "\tsymbol=" )

1051 
	`DTRACE_CABAC_V
–
uiCbf
 )

1052 
	`DTRACE_CABAC_T
( "\tctx=" )

1053 
	`DTRACE_CABAC_V
–
uiCtx
 )

1054 
	`DTRACE_CABAC_T
( "\tetype=" )

1055 
	`DTRACE_CABAC_V
–
compID
 )

1056 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

1057 
	`DTRACE_CABAC_V
–
subTUAbsP¨tIdx
 )

1058 
	`DTRACE_CABAC_T
( "\n" )

1062 i‡(
comböedSubTUCBF
 != 0)

1064 
pcCU
->
	`bôwi£OrCbfP¨tR™ge
((
comböedSubTUCBF
 << 
lowe°TUDïth
), 
compID
, 
absP¨tIdx
, 
covîedP¨tIdxes
);

1065 
lowe°TUCBF
 = 
comböedSubTUCBF
;

1070 
UI¡
 
uiCbf
 = 
MAX_UINT
;

1071 
m_pcTDecBöIf
->
	`decodeBö
(
uiCbf
, 
m_cCUQtCbfSCModñ
.
	`gë
(0, 
c⁄ãxtSë
, 
uiCtx
Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
	`TComCodögSèti°icsCœssTy≥
(
STATS__CABAC_BITS__QT_CBF
, 
g_aucC⁄vîtToBô
[
rTu
.
	`gëRe˘
(
compID
).
width
]+2, compID)));

1073 
pcCU
->
	`£tCbfSubP¨ts
((
uiCbf
 << 
lowe°TUDïth
), 
compID
, 
absP¨tIdx
, 
rTu
.
	`GëTønsf‹mDïthTŸÆAdj
(compID));

1075 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

1076 
	`DTRACE_CABAC_T
( "\tparseQtCbf()" )

1077 
	`DTRACE_CABAC_T
( "\tsymbol=" )

1078 
	`DTRACE_CABAC_V
–
uiCbf
 )

1079 
	`DTRACE_CABAC_T
( "\tctx=" )

1080 
	`DTRACE_CABAC_V
–
uiCtx
 )

1081 
	`DTRACE_CABAC_T
( "\tetype=" )

1082 
	`DTRACE_CABAC_V
–
compID
 )

1083 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

1084 
	`DTRACE_CABAC_V
–
rTu
.
	`GëAbsP¨tIdxTU
(
compID
) )

1085 
	`DTRACE_CABAC_T
( "\n" )

1087 
lowe°TUCBF
 = 
uiCbf
;

1091 i‡(
lowe°TUCBF
 != 0)

1093 
UI¡
 
dïth
 = 
TUDïth
; dïth < 
lowe°TUDïth
; depth++)

1095 
pcCU
->
	`bôwi£OrCbfP¨tR™ge
((
lowe°TUCBF
 << 
dïth
), 
compID
, 
absP¨tIdx
, 
covîedP¨tIdxes
);

1098 
	}
}

1101 
Void
 
	gTDecSbac
::
	$∑r£Tønsf‹mSkùFœgs
 (
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
)

1103 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

1104 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
(
comp⁄ít
);

1106 i‡(
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
))

1111 i‡(!
	`TUCompRe˘HasAssocüãdTønsf‹mSkùFœg
(
rTu
.
	`gëRe˘
(
comp⁄ít
), 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
()))

1116 
UI¡
 
u£Tønsf‹mSkù
;

1118 
m_pcTDecBöIf
->
	`decodeBö
–
u£Tønsf‹mSkù
 , 
m_cTønsf‹mSkùSCModñ
.
	`gë
–0, 
	`toCh™√lTy≥
(
comp⁄ít
), 0 )

1119 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
	`TComCodögSèti°icsCœssTy≥
(
STATS__CABAC_BITS__TRANSFORM_SKIP_FLAGS
, 
comp⁄ít
))

1122 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

1123 
	`DTRACE_CABAC_T
("\tparseTransformSkip()");

1124 
	`DTRACE_CABAC_T
( "\tsymbol=" )

1125 
	`DTRACE_CABAC_V
–
u£Tønsf‹mSkù
 )

1126 
	`DTRACE_CABAC_T
( "\tAddr=" )

1127 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCtuRsAddr
() )

1128 
	`DTRACE_CABAC_T
( "\tetype=" )

1129 
	`DTRACE_CABAC_V
–
comp⁄ít
 )

1130 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

1131 
	`DTRACE_CABAC_V
–
rTu
.
	`GëAbsP¨tIdxTU
() )

1132 
	`DTRACE_CABAC_T
( "\n" )

1134 
pcCU
->
	`£tTønsf‹mSkùP¨tR™ge
–
u£Tønsf‹mSkù
, 
comp⁄ít
, 
uiAbsP¨tIdx
, 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(component));

1135 
	}
}

1148 
Void
 
	gTDecSbac
::
	$∑r£La°Signifiˇ¡XY
–
UI¡
& 
uiPosLa°X
, UI¡& 
uiPosLa°Y
, 
I¡
 
width
, I¡ 
height
, 
Comp⁄ítID
 
comp⁄ít
, UI¡ 
uiSˇnIdx
 )

1150 
UI¡
 
uiLa°
;

1152 
C⁄ãxtModñ
 *
pCtxX
 = 
m_cCuCtxLa°X
.
	`gë
–0, 
	`toCh™√lTy≥
(
comp⁄ít
) );

1153 
C⁄ãxtModñ
 *
pCtxY
 = 
m_cCuCtxLa°Y
.
	`gë
–0, 
	`toCh™√lTy≥
(
comp⁄ít
) );

1155 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


1156 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__CABAC_BITS__LAST_SIG_X_Y
, 
g_aucC⁄vîtToBô
[
width
]+2, 
comp⁄ít
);

1160 i‡–
uiSˇnIdx
 =
SCAN_VER
 )

1162 
	`sw≠
–
width
, 
height
 );

1165 
I¡
 
blkSizeOff£tX
, 
blkSizeOff£tY
, 
shi·X
, 
shi·Y
;

1166 
	`gëLa°Signifiˇ¡C⁄ãxtP¨amëîs
(
comp⁄ít
, 
width
, 
height
, 
blkSizeOff£tX
, 
blkSizeOff£tY
, 
shi·X
, 
shi·Y
);

1172  
uiPosLa°X
 = 0; uiPosLa°X < 
g_uiGroupIdx
[ 
width
 - 1 ]; uiPosLastX++ )

1174 
m_pcTDecBöIf
->
	`decodeBö
–
uiLa°
, *–
pCtxX
 + 
blkSizeOff£tX
 + (
uiPosLa°X
 >>
shi·X
ËË
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

1176 if–!
uiLa°
 )

1184  
uiPosLa°Y
 = 0; uiPosLa°Y < 
g_uiGroupIdx
[ 
height
 - 1 ]; uiPosLastY++ )

1186 
m_pcTDecBöIf
->
	`decodeBö
–
uiLa°
, *–
pCtxY
 + 
blkSizeOff£tY
 + (
uiPosLa°Y
 >>
shi·Y
)Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

1188 if–!
uiLa°
 )

1196 i‡–
uiPosLa°X
 > 3 )

1198 
UI¡
 
uiTemp
 = 0;

1199 
UI¡
 
uiCou¡
 = ( 
uiPosLa°X
 - 2 ) >> 1;

1200  
I¡
 
i
 = 
uiCou¡
 - 1; i >= 0; i-- )

1202 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiLa°
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

1203 
uiTemp
 +
uiLa°
 << 
i
;

1205 
uiPosLa°X
 = 
g_uiMöInGroup
[ uiPosLa°X ] + 
uiTemp
;

1207 i‡–
uiPosLa°Y
 > 3 )

1209 
UI¡
 
uiTemp
 = 0;

1210 
UI¡
 
uiCou¡
 = ( 
uiPosLa°Y
 - 2 ) >> 1;

1211  
I¡
 
i
 = 
uiCou¡
 - 1; i >= 0; i-- )

1213 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiLa°
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
) );

1214 
uiTemp
 +
uiLa°
 << 
i
;

1216 
uiPosLa°Y
 = 
g_uiMöInGroup
[ uiPosLa°Y ] + 
uiTemp
;

1219 if–
uiSˇnIdx
 =
SCAN_VER
 )

1221 
	`sw≠
–
uiPosLa°X
, 
uiPosLa°Y
 );

1223 
	}
}

1225 
Void
 
	gTDecSbac
::
	$∑r£C€ffNxN
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 )

1227 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

1228 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
(
compID
);

1229 c⁄° 
TComRe˘™gÀ
 &
rRe˘
=
rTu
.
	`gëRe˘
(
compID
);

1230 c⁄° 
UI¡
 
uiWidth
=
rRe˘
.
width
;

1231 c⁄° 
UI¡
 
uiHeight
=
rRe˘
.
height
;

1232 
TC€ff
* 
pcC€f
=(
pcCU
->
	`gëC€ff
(
compID
)+
rTu
.
	`gëC€fficõ¡Off£t
(compID));

1233 c⁄° 
TComSPS
 &
•s
=*(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

1235 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

1236 
	`DTRACE_CABAC_T
( "\tparseCoeffNxN()\teType=" )

1237 
	`DTRACE_CABAC_V
–
compID
 )

1238 
	`DTRACE_CABAC_T
( "\twidth=" )

1239 
	`DTRACE_CABAC_V
–
uiWidth
 )

1240 
	`DTRACE_CABAC_T
( "\theight=" )

1241 
	`DTRACE_CABAC_V
–
uiHeight
 )

1242 
	`DTRACE_CABAC_T
( "\tdepth=" )

1244 
	`DTRACE_CABAC_V
–
rTu
.
	`GëTønsf‹mDïthTŸÆ
() )

1245 
	`DTRACE_CABAC_T
( "\tabspartidx=" )

1247 
	`DTRACE_CABAC_V
–
rTu
.
	`GëAbsP¨tIdxTU
(
compID
) )

1248 
	`DTRACE_CABAC_T
( "\ttoCU-X=" )

1249 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCUPñX
() )

1250 
	`DTRACE_CABAC_T
( "\ttoCU-Y=" )

1251 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCUPñY
() )

1252 
	`DTRACE_CABAC_T
( "\tCU-addr=" )

1253 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCtuRsAddr
() )

1254 
	`DTRACE_CABAC_T
( "\tinCU-X=" )

1256 
	`DTRACE_CABAC_V
–
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
rTu
.
	`GëAbsP¨tIdxTU
(
compID
)] ] )

1257 
	`DTRACE_CABAC_T
( "\tinCU-Y=" )

1259 
	`DTRACE_CABAC_V
–
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
rTu
.
	`GëAbsP¨tIdxTU
(
compID
)] ] )

1260 
	`DTRACE_CABAC_T
( "\tpredmode=" )

1261 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëPªdi˘i⁄Mode
–
uiAbsP¨tIdx
 ) )

1262 
	`DTRACE_CABAC_T
( "\n" )

1266 if–
uiWidth
 > 
•s
.
	`gëMaxTrSize
() )

1268 
°d
::
˚º
 << "ERROR:Ö¨£C€ffNxN wa†∑s£dá TU wôh dimísi⁄†œrgîÅh™ÅhêmaximumáŒowed size" << std::
ídl
;

1269 
	`as£π
(
Ál£
);

1270 
	`exô
(1);

1277 c⁄° 
Ch™√lTy≥
 
chTy≥
 = 
	`toCh™√lTy≥
(
compID
);

1278 c⁄° 
UI¡
 
uiLog2BlockWidth
 = 
g_aucC⁄vîtToBô
[ 
uiWidth
 ] + 2;

1279 c⁄° 
UI¡
 
uiLog2BlockHeight
 = 
g_aucC⁄vîtToBô
[ 
uiHeight
 ] + 2;

1280 c⁄° 
UI¡
 
uiMaxNumC€ff
 = 
uiWidth
 * 
uiHeight
;

1281 c⁄° 
UI¡
 
uiMaxNumC€ffM1
 = 
uiMaxNumC€ff
 - 1;

1283 c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
 = 
	`toCh™√lTy≥
(
compID
);

1284 c⁄° 
Boﬁ
 
exãndedPªcisi⁄
 = 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
();

1286 c⁄° 
Boﬁ
 
ÆignCABACBef‹eBy∑ss
 = 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëCabacBy∑ssAlignmítE«bÀdFœg
();

1287 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
•s
.
	`gëMaxLog2TrDy«micR™ge
(
ch™√lTy≥
);

1289 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


1290 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥_group
(
STATS__CABAC_BITS__SIG_COEFF_GROUP_FLAG
, 
uiLog2BlockWidth
, 
compID
);

1291 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥_m≠
(
STATS__CABAC_BITS__SIG_COEFF_MAP_FLAG
, 
uiLog2BlockWidth
, 
compID
);

1292 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥_gt1
(
STATS__CABAC_BITS__GT1_FLAG
, 
uiLog2BlockWidth
, 
compID
);

1293 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥_gt2
(
STATS__CABAC_BITS__GT2_FLAG
, 
uiLog2BlockWidth
, 
compID
);

1296 
Boﬁ
 
beVÆid
;

1297 i‡(
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
))

1299 
beVÆid
 = 
Ál£
;

1300 if((!
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
)Ë&&ÖcCU->
	`isRDPCME«bÀd
(uiAbsPartIdx))

1302 
	`∑r£Ex∂icôRdpcmMode
(
rTu
, 
compID
);

1307 
beVÆid
 = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëSignD©aHidögE«bÀdFœg
();

1310 
UI¡
 
absSum
 = 0;

1314 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£Tønsf‹mSkù
())

1316 
	`∑r£Tønsf‹mSkùFœgs
(
rTu
, 
compID
);

1318 if(
pcCU
->
	`gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
Ë&& (!pcCU->
	`isI¡ø
(uiAbsP¨tIdx)Ë&&ÖcCU->
	`isRDPCME«bÀd
(uiAbsPartIdx) )

1320 
	`∑r£Ex∂icôRdpcmMode
(
rTu
, 
compID
);

1321 if(
pcCU
->
	`gëEx∂icôRdpcmMode
(
compID
, 
uiAbsP¨tIdx
Ë!
RDPCM_OFF
)

1324 
beVÆid
 = 
Ál£
;

1329 
I¡
 
uiI¡øMode
 = -1;

1330 c⁄° 
Boﬁ
 
bIsLuma
 = 
	`isLuma
(
compID
);

1331 
I¡
 
isI¡ø
 = 
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
) ? 1 : 0;

1332 i‡–
isI¡ø
 && 
pcCU
->
	`isRDPCME«bÀd
(
uiAbsP¨tIdx
) )

1334 c⁄° 
UI¡
 
∑πsPîMöCU
 = 1<<(2*(
•s
.
	`gëMaxTŸÆCUDïth
(Ë- sps.
	`gëLog2DiffMaxMöCodögBlockSize
()));

1335 
uiI¡øMode
 = 
pcCU
->
	`gëI¡øDú
–
	`toCh™√lTy≥
(
compID
), 
uiAbsP¨tIdx
 );

1336 
uiI¡øMode
 = (uiI¡øMode==
DM_CHROMA_IDX
 && !
bIsLuma
Ë? 
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
	`gëChromasC‹ª•⁄dögPULumaIdx
(
uiAbsP¨tIdx
, 
rTu
.
	`GëChromaF‹m©
(), 
∑πsPîMöCU
)) : uiIntraMode;

1337 
uiI¡øMode
 = ((
rTu
.
	`GëChromaF‹m©
(Ë=
CHROMA_422
Ë&& !
bIsLuma
Ë? 
g_chroma422I¡øAngÀM≠pögTabÀ
[uiIntraMode] : uiIntraMode;

1339 
Boﬁ
 
å™sf‹mSkù
 = 
pcCU
->
	`gëTønsf‹mSkù
–
uiAbsP¨tIdx
,
compID
);

1340 
Boﬁ
 
rdpcm_lossy
 = ( 
å™sf‹mSkù
 && ( (
uiI¡øMode
 =
HOR_IDX
Ë|| (uiI¡øModê=
VER_IDX
) ) );

1341 i‡–
rdpcm_lossy
 )

1343 
beVÆid
 = 
Ál£
;

1349 c⁄° 
Boﬁ
 
bU£GﬁombRi˚P¨amëîAd≠èti⁄
 = 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
();

1350 
UI¡
 &
cuºítGﬁombRi˚Sèti°ic
 = 
m_gﬁombRi˚Ad≠èti⁄Sèti°ics
[
rTu
.
	`gëGﬁombRi˚Sèti°icsIndex
(
compID
)];

1353 
TUE¡r›yCodögP¨amëîs
 
codögP¨amëîs
;

1354 
	`gëTUE¡r›yCodögP¨amëîs
(
codögP¨amëîs
, 
rTu
, 
compID
);

1357 
UI¡
 
uiPosLa°X
, 
uiPosLa°Y
;

1358 
	`∑r£La°Signifiˇ¡XY
–
uiPosLa°X
, 
uiPosLa°Y
, 
uiWidth
, 
uiHeight
, 
compID
, 
codögP¨amëîs
.
sˇnTy≥
 );

1359 
UI¡
 
uiBlkPosLa°
 = 
uiPosLa°X
 + (
uiPosLa°Y
<<
uiLog2BlockWidth
);

1360 
pcC€f
[ 
uiBlkPosLa°
 ] = 1;

1363 
UI¡
 
uiSˇnPosLa°
;

1364  
uiSˇnPosLa°
 = 0; uiSˇnPosLa° < 
uiMaxNumC€ffM1
; uiScanPosLast++ )

1366 
UI¡
 
uiBlkPos
 = 
codögP¨amëîs
.
sˇn
[ 
uiSˇnPosLa°
 ];

1367 if–
uiBlkPosLa°
 =
uiBlkPos
 )

1373 
C⁄ãxtModñ
 * c⁄° 
ba£C€ffGroupCtx
 = 
m_cCUSigC€ffGroupSCModñ
.
	`gë
–0, 
	`isChroma
(
chTy≥
) );

1374 
C⁄ãxtModñ
 * c⁄° 
ba£Ctx
 = 
m_cCUSigSCModñ
.
	`gë
–0, 0 ) + 
	`gëSignifiˇn˚M≠C⁄ãxtOff£t
(
compID
);

1376 c⁄° 
I¡
 
iLa°SˇnSë
 = 
uiSˇnPosLa°
 >> 
MLS_CG_SIZE
;

1377 
UI¡
 
c1
 = 1;

1378 
UI¡
 
uiGoRi˚P¨am
 = 0;

1381 
UI¡
 
uiSigC€ffGroupFœg
[ 
MLS_GRP_NUM
 ];

1382 
	`mem£t
–
uiSigC€ffGroupFœg
, 0, (
UI¡
Ë* 
MLS_GRP_NUM
 );

1384 
I¡
 
iSˇnPosSig
 = (I¡Ë
uiSˇnPosLa°
;

1385  
I¡
 
iSubSë
 = 
iLa°SˇnSë
; iSubSet >= 0; iSubSet-- )

1387 
I¡
 
iSubPos
 = 
iSubSë
 << 
MLS_CG_SIZE
;

1388 
uiGoRi˚P¨am
 = 
cuºítGﬁombRi˚Sèti°ic
 / 
RExt__GOLOMB_RICE_INCREMENT_DIVISOR
;

1389 
Boﬁ
 
upd©eGﬁombRi˚Sèti°ics
 = 
bU£GﬁombRi˚P¨amëîAd≠èti⁄
;

1390 
I¡
 
numN⁄Zîo
 = 0;

1392 
I¡
 
œ°NZPosInCG
 = -1;

1393 
I¡
 
fú°NZPosInCG
 = 1 << 
MLS_CG_SIZE
;

1395 
Boﬁ
 
esˇ≥D©aPª£¡InGroup
 = 
Ál£
;

1397 
I¡
 
pos
[1 << 
MLS_CG_SIZE
];

1399 if–
iSˇnPosSig
 =(
I¡
Ë
uiSˇnPosLa°
 )

1401 
œ°NZPosInCG
 = 
iSˇnPosSig
;

1402 
fú°NZPosInCG
 = 
iSˇnPosSig
;

1403 
iSˇnPosSig
--;

1404 
pos
[ 
numN⁄Zîo
 ] = 
uiBlkPosLa°
;

1405 
numN⁄Zîo
 = 1;

1409 
I¡
 
iCGBlkPos
 = 
codögP¨amëîs
.
sˇnCG
[ 
iSubSë
 ];

1410 
I¡
 
iCGPosY
 = 
iCGBlkPos
 / 
codögP¨amëîs
.
widthInGroups
;

1411 
I¡
 
iCGPosX
 = 
iCGBlkPos
 - (
iCGPosY
 * 
codögP¨amëîs
.
widthInGroups
);

1413 if–
iSubSë
 =
iLa°SˇnSë
 || iSubSet == 0)

1415 
uiSigC€ffGroupFœg
[ 
iCGBlkPos
 ] = 1;

1419 
UI¡
 
uiSigC€ffGroup
;

1420 
UI¡
 
uiCtxSig
 = 
TComTrQu™t
::
	`gëSigC€ffGroupCtxInc
–
uiSigC€ffGroupFœg
, 
iCGPosX
, 
iCGPosY
, 
codögP¨amëîs
.
widthInGroups
, codögP¨amëîs.
heightInGroups
 );

1421 
m_pcTDecBöIf
->
	`decodeBö
–
uiSigC€ffGroup
, 
ba£C€ffGroupCtx
[ 
uiCtxSig
 ] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥_group
) );

1422 
uiSigC€ffGroupFœg
[ 
iCGBlkPos
 ] = 
uiSigC€ffGroup
;

1426 c⁄° 
I¡
 
∑âînSigCtx
 = 
TComTrQu™t
::
	`ˇlcP©ã∫SigCtx
(
uiSigC€ffGroupFœg
, 
iCGPosX
, 
iCGPosY
, 
codögP¨amëîs
.
widthInGroups
, codögP¨amëîs.
heightInGroups
);

1428 
UI¡
 
uiBlkPos
, 
uiSig
, 
uiCtxSig
;

1429  ; 
iSˇnPosSig
 >
iSubPos
; iScanPosSig-- )

1431 
uiBlkPos
 = 
codögP¨amëîs
.
sˇn
[ 
iSˇnPosSig
 ];

1432 
uiSig
 = 0;

1434 if–
uiSigC€ffGroupFœg
[ 
iCGBlkPos
 ] )

1436 if–
iSˇnPosSig
 > 
iSubPos
 || 
iSubSë
 =0 || 
numN⁄Zîo
 )

1438 
uiCtxSig
 = 
TComTrQu™t
::
	`gëSigCtxInc
–
∑âînSigCtx
, 
codögP¨amëîs
, 
iSˇnPosSig
, 
uiLog2BlockWidth
, 
uiLog2BlockHeight
, 
chTy≥
 );

1439 
m_pcTDecBöIf
->
	`decodeBö
–
uiSig
, 
ba£Ctx
[ 
uiCtxSig
 ] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥_m≠
) );

1443 
uiSig
 = 1;

1446 
pcC€f
[ 
uiBlkPos
 ] = 
uiSig
;

1447 if–
uiSig
 )

1449 
pos
[ 
numN⁄Zîo
 ] = 
uiBlkPos
;

1450 
numN⁄Zîo
 ++;

1451 if–
œ°NZPosInCG
 == -1 )

1453 
œ°NZPosInCG
 = 
iSˇnPosSig
;

1455 
fú°NZPosInCG
 = 
iSˇnPosSig
;

1459 if–
numN⁄Zîo
 > 0 )

1461 
Boﬁ
 
signHiddí
 = ( 
œ°NZPosInCG
 - 
fú°NZPosInCG
 >
SBH_THRESHOLD
 );

1463 
absSum
 = 0;

1465 c⁄° 
UI¡
 
uiCtxSë
 = 
	`gëC⁄ãxtSëIndex
(
compID
, 
iSubSë
, (
c1
 == 0));

1466 
c1
 = 1;

1467 
UI¡
 
uiBö
;

1469 
C⁄ãxtModñ
 *
ba£CtxMod
 = 
m_cCUO√SCModñ
.
	`gë
–0, 0 ) + (
NUM_ONE_FLAG_CTX_PER_SET
 * 
uiCtxSë
);

1471 
I¡
 
absC€ff
[1 << 
MLS_CG_SIZE
];

1473  
I¡
 
i
 = 0; i < 
numN⁄Zîo
; i++)

1475 
absC€ff
[
i
] = 1;

1477 
I¡
 
numC1Fœg
 = 
	`mö
(
numN⁄Zîo
, 
C1FLAG_NUMBER
);

1478 
I¡
 
fú°C2FœgIdx
 = -1;

1480  
I¡
 
idx
 = 0; idx < 
numC1Fœg
; idx++ )

1482 
m_pcTDecBöIf
->
	`decodeBö
–
uiBö
, 
ba£CtxMod
[
c1
] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥_gt1
) );

1483 if–
uiBö
 == 1 )

1485 
c1
 = 0;

1486 i‡(
fú°C2FœgIdx
 == -1)

1488 
fú°C2FœgIdx
 = 
idx
;

1492 
esˇ≥D©aPª£¡InGroup
 = 
åue
;

1495 if–(
c1
 < 3) && (c1 > 0) )

1497 
c1
++;

1499 
absC€ff
[ 
idx
 ] = 
uiBö
 + 1;

1502 i‡(
c1
 == 0)

1504 
ba£CtxMod
 = 
m_cCUAbsSCModñ
.
	`gë
–0, 0 ) + (
NUM_ABS_FLAG_CTX_PER_SET
 * 
uiCtxSë
);

1505 i‡–
fú°C2FœgIdx
 != -1)

1507 
m_pcTDecBöIf
->
	`decodeBö
–
uiBö
, 
ba£CtxMod
[0] 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥_gt2
) );

1508 
absC€ff
[ 
fú°C2FœgIdx
 ] = 
uiBö
 + 2;

1509 i‡(
uiBö
 != 0)

1511 
esˇ≥D©aPª£¡InGroup
 = 
åue
;

1516 
esˇ≥D©aPª£¡InGroup
 =Ésˇ≥D©aPª£¡InGrou∞|| (
numN⁄Zîo
 > 
C1FLAG_NUMBER
);

1518 c⁄° 
Boﬁ
 
ÆignGroup
 = 
esˇ≥D©aPª£¡InGroup
 && 
ÆignCABACBef‹eBy∑ss
;

1520 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


1521 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥_signs
((
ÆignGroup
 ? 
STATS__CABAC_BITS__ALIGNED_SIGN_BIT
 : 
STATS__CABAC_BITS__SIGN_BIT
 ), 
uiLog2BlockWidth
, 
compID
);

1522 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥_escs
 ((
ÆignGroup
 ? 
STATS__CABAC_BITS__ALIGNED_ESCAPE_BITS
 : 
STATS__CABAC_BITS__ESCAPE_BITS
), 
uiLog2BlockWidth
, 
compID
);

1525 i‡(
ÆignGroup
)

1527 
m_pcTDecBöIf
->
	`Æign
();

1530 
UI¡
 
c€ffSigns
;

1531 i‡–
signHiddí
 && 
beVÆid
 )

1533 
m_pcTDecBöIf
->
	`decodeBösEP
–
c€ffSigns
, 
numN⁄Zîo
-1 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥_signs
) );

1534 
c€ffSigns
 <<32 - (
numN⁄Zîo
-1);

1538 
m_pcTDecBöIf
->
	`decodeBösEP
–
c€ffSigns
, 
numN⁄Zîo
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥_signs
) );

1539 
c€ffSigns
 <<32 - 
numN⁄Zîo
;

1542 
I¡
 
iFú°C€ff2
 = 1;

1543 i‡(
esˇ≥D©aPª£¡InGroup
)

1545  
I¡
 
idx
 = 0; idx < 
numN⁄Zîo
; idx++ )

1547 
UI¡
 
ba£Levñ
 = (
idx
 < 
C1FLAG_NUMBER
)? (2 + 
iFú°C€ff2
) : 1;

1549 if–
absC€ff
[ 
idx
 ] =
ba£Levñ
)

1551 
UI¡
 
uiLevñ
;

1552 
	`xRódC€fRemaöExGﬁomb
–
uiLevñ
, 
uiGoRi˚P¨am
, 
exãndedPªcisi⁄
, 
maxLog2TrDy«micR™ge
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥_escs
) );

1554 
absC€ff
[ 
idx
 ] = 
uiLevñ
 + 
ba£Levñ
;

1556 i‡(
absC€ff
[
idx
] > (3 << 
uiGoRi˚P¨am
))

1558 
uiGoRi˚P¨am
 = 
bU£GﬁombRi˚P¨amëîAd≠èti⁄
 ? (uiGoRi˚P¨am + 1Ë: (
°d
::
mö
<
UI¡
>((uiGoRiceParam + 1), 4));

1561 i‡(
upd©eGﬁombRi˚Sèti°ics
)

1563 c⁄° 
UI¡
 
öôülGﬁombRi˚P¨amëî
 = 
cuºítGﬁombRi˚Sèti°ic
 / 
RExt__GOLOMB_RICE_INCREMENT_DIVISOR
;

1565 i‡(
uiLevñ
 >(3 << 
öôülGﬁombRi˚P¨amëî
))

1567 
cuºítGﬁombRi˚Sèti°ic
++;

1569 i‡(((
uiLevñ
 * 2Ë< (1 << 
öôülGﬁombRi˚P¨amëî
)Ë&& (
cuºítGﬁombRi˚Sèti°ic
 > 0))

1571 
cuºítGﬁombRi˚Sèti°ic
--;

1574 
upd©eGﬁombRi˚Sèti°ics
 = 
Ál£
;

1578 if(
absC€ff
[ 
idx
 ] >= 2)

1580 
iFú°C€ff2
 = 0;

1585  
I¡
 
idx
 = 0; idx < 
numN⁄Zîo
; idx++ )

1587 
I¡
 
blkPos
 = 
pos
[ 
idx
 ];

1589 
pcC€f
[ 
blkPos
 ] = 
absC€ff
[ 
idx
 ];

1590 
absSum
 +
absC€ff
[ 
idx
 ];

1592 i‡–
idx
 =
numN⁄Zîo
-1 && 
signHiddí
 && 
beVÆid
 )

1595 i‡(
absSum
&0x1)

1597 
pcC€f
[ 
blkPos
 ] = -pcCoef[ blkPos ];

1602 
I¡
 
sign
 = 
°©ic_ˇ°
<I¡>–
c€ffSigns
 ) >> 31;

1603 
pcC€f
[ 
blkPos
 ] = (ÖcC€f[ blkPo†] ^ 
sign
 ) - sign;

1604 
c€ffSigns
 <<= 1;

1610 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


1611 
	`¥ötSBACC€ffD©a
(
uiPosLa°X
, 
uiPosLa°Y
, 
uiWidth
, 
uiHeight
, 
compID
, 
uiAbsP¨tIdx
, 
codögP¨amëîs
.
sˇnTy≥
, 
pcC€f
);

1615 
	}
}

1617 
Void
 
	gTDecSbac
::
	$∑r£SaoMaxUvlc
 ( 
UI¡
& 
vÆ
, UI¡ 
maxSymbﬁ
 )

1619 i‡(
maxSymbﬁ
 == 0)

1621 
vÆ
 = 0;

1625 
UI¡
 
code
;

1626 
I¡
 
i
;

1627 
m_pcTDecBöIf
->
	`decodeBöEP
–
code
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SAO
) );

1628 i‡–
code
 == 0 )

1630 
vÆ
 = 0;

1634 
i
=1;

1637 
m_pcTDecBöIf
->
	`decodeBöEP
–
code
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SAO
) );

1638 i‡–
code
 == 0 )

1642 
i
++;

1643 i‡(
i
 =
maxSymbﬁ
)

1649 
vÆ
 = 
i
;

1650 
	}
}

1652 
Void
 
	gTDecSbac
::
	$∑r£SaoUÊc
 (
UI¡
 
uiLígth
, UI¡& 
riVÆ
)

1654 
m_pcTDecBöIf
->
	`decodeBösEP
 ( 
riVÆ
, 
uiLígth
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SAO
) );

1655 
	}
}

1657 
Void
 
	gTDecSbac
::
	$∑r£SaoMîge
 (
UI¡
& 
ruiVÆ
)

1659 
UI¡
 
uiCode
;

1660 
m_pcTDecBöIf
->
	`decodeBö
–
uiCode
, 
m_cSaoMîgeSCModñ
.
	`gë
–0, 0, 0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SAO
) );

1661 
ruiVÆ
 = (
I¡
)
uiCode
;

1662 
	}
}

1664 
Void
 
	gTDecSbac
::
	$∑r£SaoTy≥Idx
 (
UI¡
& 
ruiVÆ
)

1666 
UI¡
 
uiCode
;

1667 
m_pcTDecBöIf
->
	`decodeBö
–
uiCode
, 
m_cSaoTy≥IdxSCModñ
.
	`gë
–0, 0, 0 ) 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SAO
) );

1668 i‡(
uiCode
 == 0)

1670 
ruiVÆ
 = 0;

1674 
m_pcTDecBöIf
->
	`decodeBöEP
–
uiCode
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SAO
) );

1675 i‡(
uiCode
 == 0)

1677 
ruiVÆ
 = 1;

1681 
ruiVÆ
 = 2;

1684 
	}
}

1686 
Void
 
	gTDecSbac
::
	$∑r£SaoSign
(
UI¡
& 
vÆ
)

1688 
m_pcTDecBöIf
->
	`decodeBöEP
 ( 
vÆ
 
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
STATS__CABAC_BITS__SAO
) );

1689 
	}
}

1691 
Void
 
	gTDecSbac
::
	$∑r£SAOBlkP¨am
 (
SAOBlkP¨am
& 
ßoBlkP¨am


1692 , 
Boﬁ
* 
¶i˚E«bÀd


1693 , 
Boﬁ
 
À·MîgeAvaû


1694 , 
Boﬁ
 
aboveMîgeAvaû


1695 , c⁄° 
BôDïths
 &
bôDïths


1698 
UI¡
 
uiSymbﬁ
;

1700 
Boﬁ
 
isLe·Mîge
 = 
Ál£
;

1701 
Boﬁ
 
isAboveMîge

Ál£
;

1703 if(
À·MîgeAvaû
)

1705 
	`∑r£SaoMîge
(
uiSymbﬁ
);

1706 
isLe·Mîge
 = (
uiSymbﬁ
?
åue
:
Ál£
);

1709 if–
aboveMîgeAvaû
 && !
isLe·Mîge
)

1711 
	`∑r£SaoMîge
(
uiSymbﬁ
);

1712 
isAboveMîge
 = (
uiSymbﬁ
?
åue
:
Ál£
);

1715 if(
isLe·Mîge
 || 
isAboveMîge
)

1717 
UI¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
MAX_NUM_COMPONENT
; componentIndex++)

1719 
ßoBlkP¨am
[
comp⁄ítIndex
].
modeIdc
 = (
¶i˚E«bÀd
[comp⁄ítIndex]Ë? 
SAO_MODE_MERGE
 : 
SAO_MODE_OFF
;

1720 
ßoBlkP¨am
[
comp⁄ítIndex
].
ty≥Idc
 = (
isLe·Mîge
)?
SAO_MERGE_LEFT
:
SAO_MERGE_ABOVE
;

1725 
I¡
 
compId
=
COMPONENT_Y
; compId < 
MAX_NUM_COMPONENT
; compId++)

1727 c⁄° 
Comp⁄ítID
 
compIdx
=
	`Comp⁄ítID
(
compId
);

1728 c⁄° 
Comp⁄ítID
 
fú°CompOfChTy≥
 = 
	`gëFú°Comp⁄ítOfCh™√l
(
	`toCh™√lTy≥
(
compIdx
));

1729 
SAOOff£t
& 
˘bP¨am
 = 
ßoBlkP¨am
[
compIdx
];

1730 #i‡
O0043_BEST_EFFORT_DECODING


1731 c⁄° 
I¡
 
bôDïthOrig
 = 
bôDïths
.
°ªam
[
	`toCh™√lTy≥
(
compIdx
)];

1732 c⁄° 
I¡
 
f‹˚BôDïthAdju°
 = 
bôDïthOrig
 - 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compIdx
)];

1734 c⁄° 
I¡
 
bôDïthOrig
 = 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compIdx
)];

1736 c⁄° 
I¡
 
maxOff£tQVÆ
=
TComSam∂eAd≠tiveOff£t
::
	`gëMaxOff£tQVÆ
(
bôDïthOrig
);

1737 if(!
¶i˚E«bÀd
[
compIdx
])

1740 
˘bP¨am
.
modeIdc
 = 
SAO_MODE_OFF
;

1745 if(
compIdx
 =
fú°CompOfChTy≥
)

1747 
	`∑r£SaoTy≥Idx
(
uiSymbﬁ
);

1749 
	`as£π
(
uiSymbﬁ
 ==0 || uiSymbol ==1 || uiSymbol ==2);

1751 if(
uiSymbﬁ
 ==0)

1753 
˘bP¨am
.
modeIdc
 = 
SAO_MODE_OFF
;

1755 if(
uiSymbﬁ
 == 1)

1757 
˘bP¨am
.
modeIdc
 = 
SAO_MODE_NEW
;

1758 
˘bP¨am
.
ty≥Idc
 = 
SAO_TYPE_START_BO
;

1762 
˘bP¨am
.
modeIdc
 = 
SAO_MODE_NEW
;

1763 
˘bP¨am
.
ty≥Idc
 = 
SAO_TYPE_START_EO
;

1769 
˘bP¨am
.
modeIdc
 = 
ßoBlkP¨am
[
COMPONENT_Cb
].modeIdc;

1770 
˘bP¨am
.
ty≥Idc
 = 
ßoBlkP¨am
[
COMPONENT_Cb
].typeIdc;

1773 if(
˘bP¨am
.
modeIdc
 =
SAO_MODE_NEW
)

1775 
I¡
 
off£t
[4];

1776 
I¡
 
i
=0; i< 4; i++)

1778 
	`∑r£SaoMaxUvlc
(
uiSymbﬁ
, 
maxOff£tQVÆ
 );

1779 
off£t
[
i
] = (
I¡
)
uiSymbﬁ
;

1782 if(
˘bP¨am
.
ty≥Idc
 =
SAO_TYPE_START_BO
)

1784 
I¡
 
i
=0; i< 4; i++)

1786 if(
off£t
[
i
] != 0)

1788 
	`∑r£SaoSign
(
uiSymbﬁ
);

1789 if(
uiSymbﬁ
)

1791 #i‡
O0043_BEST_EFFORT_DECODING


1792 
off£t
[
i
] >>
f‹˚BôDïthAdju°
;

1794 
off£t
[
i
] = -offset[i];

1798 
	`∑r£SaoUÊc
(
NUM_SAO_BO_CLASSES_LOG2
, 
uiSymbﬁ
 );

1799 
˘bP¨am
.
ty≥AuxInfo
 = 
uiSymbﬁ
;

1801 
I¡
 
i
=0; i<4; i++)

1803 
˘bP¨am
.
off£t
[(˘bP¨am.
ty≥AuxInfo
+
i
)%
MAX_NUM_SAO_CLASSES
] = offset[i];

1809 
˘bP¨am
.
ty≥AuxInfo
 = 0;

1811 if(
fú°CompOfChTy≥
 =
compIdx
)

1813 
	`∑r£SaoUÊc
(
NUM_SAO_EO_TYPES_LOG2
, 
uiSymbﬁ
 );

1814 
˘bP¨am
.
ty≥Idc
 +
uiSymbﬁ
;

1818 
˘bP¨am
.
ty≥Idc
 = 
ßoBlkP¨am
[
fú°CompOfChTy≥
].typeIdc;

1820 
˘bP¨am
.
off£t
[
SAO_CLASS_EO_FULL_VALLEY
] = offset[0];

1821 
˘bP¨am
.
off£t
[
SAO_CLASS_EO_HALF_VALLEY
] = offset[1];

1822 
˘bP¨am
.
off£t
[
SAO_CLASS_EO_PLAIN
 ] = 0;

1823 
˘bP¨am
.
off£t
[
SAO_CLASS_EO_HALF_PEAK
 ] = -offset[2];

1824 
˘bP¨am
.
off£t
[
SAO_CLASS_EO_FULL_PEAK
 ] = -offset[3];

1829 
	}
}

1836 
Void
 
	gTDecSbac
::
	$xC›yC⁄ãxtsFrom
–c⁄° 
TDecSbac
* 
pSrc
 )

1838 
	`mem˝y
(
m_c⁄ãxtModñs
, 
pSrc
->m_c⁄ãxtModñs, 
m_numC⁄ãxtModñs
*(m_contextModels[0]));

1839 
	`mem˝y
(
m_gﬁombRi˚Ad≠èti⁄Sèti°ics
, 
pSrc
->m_gﬁombRi˚Ad≠èti⁄Sèti°ics, ((
UI¡
Ë* 
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
));

1840 
	}
}

1842 
Void
 
	gTDecSbac
::
	$xC›yFrom
–c⁄° 
TDecSbac
* 
pSrc
 )

1844 
m_pcTDecBöIf
->
	`c›ySèã
–
pSrc
->m_pcTDecBinIf );

1845 
	`xC›yC⁄ãxtsFrom
–
pSrc
 );

1846 
	}
}

1848 
Void
 
	gTDecSbac
::
	$lﬂd
 ( c⁄° 
TDecSbac
* 
pSrc
 )

1850 
	`xC›yFrom
(
pSrc
);

1851 
	}
}

1853 
Void
 
	gTDecSbac
::
	$lﬂdC⁄ãxts
 ( c⁄° 
TDecSbac
* 
pSrc
 )

1855 
	`xC›yC⁄ãxtsFrom
(
pSrc
);

1856 
	}
}

1862 
Void
 
	gTDecSbac
::
	$∑r£Ex∂icôRdpcmMode
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 )

1864 
TComD©aCU
* 
cu
 = 
rTu
.
	`gëCU
();

1865 c⁄° 
UI¡
 
absP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
(
compID
);

1866 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
compID
);

1867 c⁄° 
UI¡
 
tuHeight
 = 
g_aucC⁄vîtToBô
[
ª˘
.
height
];

1868 c⁄° 
UI¡
 
tuWidth
 = 
g_aucC⁄vîtToBô
[
ª˘
.
width
];

1869 
UI¡
 
code
 = 0;

1871 
	`as£π
(
tuHeight
 =
tuWidth
);

1873 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


1874 c⁄° 
TComCodögSèti°icsCœssTy≥
 
	`˘y≥
(
STATS__EXPLICIT_RDPCM_BITS
, 
g_aucC⁄vîtToBô
[
cu
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxCUWidth
()>>
rTu
.
	`GëTønsf‹mDïthTŸÆ
()]+2);

1877 
m_pcTDecBöIf
->
	`decodeBö
(
code
, 
m_ex∂icôRdpcmFœgSCModñ
.
	`gë
 (0, 
	`toCh™√lTy≥
(
compID
), 0Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
));

1879 if(
code
 == 0)

1881 
cu
->
	`£tEx∂icôRdpcmModeP¨tR™ge
–
RDPCM_OFF
, 
compID
, 
absP¨tIdx
, 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(compID));

1885 
m_pcTDecBöIf
->
	`decodeBö
(
code
, 
m_ex∂icôRdpcmDúSCModñ
.
	`gë
 (0, 
	`toCh™√lTy≥
(
compID
), 0Ë
	`RExt__DECODER_DEBUG_BIT_STATISTICS_PASS_OPT_ARG
(
˘y≥
));

1886 if(
code
 == 0)

1888 
cu
->
	`£tEx∂icôRdpcmModeP¨tR™ge
–
RDPCM_HOR
, 
compID
, 
absP¨tIdx
, 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(compID));

1892 
cu
->
	`£tEx∂icôRdpcmModeP¨tR™ge
–
RDPCM_VER
, 
compID
, 
absP¨tIdx
, 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(compID));

1895 
	}
}

	@TLibDecoder/TDecSbac.h

38 #i‚de‡
__TDECSBAC__


39 
	#__TDECSBAC__


	)

42 #i‡
_MSC_VER
 > 1000

43 #¥agm®
⁄˚


47 
	~"TDecE¡r›y.h
"

48 
	~"TDecBöCodî.h
"

49 
	~"TLibComm⁄/C⁄ãxtTabÀs.h
"

50 
	~"TLibComm⁄/C⁄ãxtModñ.h
"

51 
	~"TLibComm⁄/C⁄ãxtModñ3DBuf„r.h
"

60 
˛ass
 
	gSEImesßges
;

63 ˛as†
	cTDecSbac
 : 
public
 
TDecE¡r›yIf


65 
public
:

66 
TDecSbac
();

67 
	mvútuÆ
 ~
TDecSbac
();

69 
Void
 
	$öô
 ( 
TDecBöIf
* 
p
 ) { 
m_pcTDecBöIf
 =Ö; }

70 
Void
 
	$unöô
 ( ) { 
m_pcTDecBöIf
 = 0; 
	}
}

72 
Void
 
lﬂd
 ( c⁄° 
TDecSbac
* 
pSrc
 );

73 
Void
 
lﬂdC⁄ãxts
 ( c⁄° 
TDecSbac
* 
pSrc
 );

74 
Void
 
xC›yFrom
 ( c⁄° 
TDecSbac
* 
pSrc
 );

75 
Void
 
xC›yC⁄ãxtsFrom
 ( c⁄° 
TDecSbac
* 
pSrc
 );

77 
Void
 
ª£tE¡r›y
 (
TComSli˚
* 
pSli˚
 );

78 
Void
 
	$£tBô°ªam
 ( 
TComI≈utBô°ªam
* 
p
 ) { 
m_pcBô°ªam
 =Ö; 
m_pcTDecBöIf
->
	`öô
–∞); 
	}
}

79 
Void
 
	$∑r£VPS
 ( 
TComVPS
* ) {
	}
}

80 
Void
 
	$∑r£SPS
 ( 
TComSPS
* ) {
	}
}

81 
Void
 
	$∑r£PPS
 ( 
TComPPS
* ) {
	}
}

83 
Void
 
	$∑r£Sli˚Hódî
 ( 
TComSli˚
* , 
P¨amëîSëM™agî
* , c⁄° 
I¡
 ) {
	}
}

84 
Void
 
∑r£Tîmö©ögBô
 ( 
UI¡
& 
ruiBô
 );

85 
Void
 
∑r£RemaöögByãs
 ( 
Boﬁ
 
noTøûögByãsEx≥˘ed
);

86 
Void
 
∑r£MVPIdx
 ( 
I¡
& 
riMVPIdx
 );

87 
Void
 
∑r£SaoMaxUvlc
 ( 
UI¡
& 
vÆ
, UI¡ 
maxSymbﬁ
 );

88 
Void
 
∑r£SaoMîge
 ( 
UI¡
& 
ruiVÆ
 );

89 
Void
 
∑r£SaoTy≥Idx
 ( 
UI¡
& 
ruiVÆ
 );

90 
Void
 
∑r£SaoUÊc
 ( 
UI¡
 
uiLígth
, UI¡& 
ruiVÆ
 );

91 
Void
 
∑r£SAOBlkP¨am
 (
SAOBlkP¨am
& 
ßoBlkP¨am
, 
Boﬁ
* 
¶i˚E«bÀd
, Boﬁ 
À·MîgeAvaû
, Boﬁ 
aboveMîgeAvaû
, c⁄° 
BôDïths
 &
bôDïths
);

92 
Void
 
∑r£SaoSign
 (
UI¡
& 
vÆ
);

94 
	g¥iv©e
:

95 #i‡
RExt__DECODER_DEBUG_BIT_STATISTICS


96 
Void
 
xRódU«rySymbﬁ
 ( 
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

97 
Void
 
xRódU«ryMaxSymbﬁ
 ( 
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, UI¡ 
uiMaxSymbﬁ
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

98 
Void
 
xRódEpExGﬁomb
 ( 
UI¡
& 
ruiSymbﬁ
, UI¡ 
uiCou¡
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

99 
Void
 
xRódC€fRemaöExGﬁomb
 ( 
UI¡
 &
rSymbﬁ
, UI¡ &
rP¨am
, c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
, c⁄° 
˛ass
 
TComCodögSèti°icsCœssTy≥
 &
whichSèt
 );

101 
Void
 
xRódU«rySymbﬁ
 ( 
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
 );

102 
Void
 
xRódU«ryMaxSymbﬁ
 ( 
UI¡
& 
ruiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, UI¡ 
uiMaxSymbﬁ
 );

103 
Void
 
xRódEpExGﬁomb
 ( 
UI¡
& 
ruiSymbﬁ
, UI¡ 
uiCou¡
 );

104 
Void
 
xRódC€fRemaöExGﬁomb
 ( 
UI¡
 &
rSymbﬁ
, UI¡ &
rP¨am
, c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 );

106 
	g¥iv©e
:

107 
TComI≈utBô°ªam
* 
m_pcBô°ªam
;

108 
TDecBöIf
* 
	gm_pcTDecBöIf
;

110 
	gpublic
:

112 
Void
 
∑r£SkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

113 
Void
 
∑r£CUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

114 
Void
 
∑r£S∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

115 
Void
 
∑r£MîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiPUIdx
 );

116 
Void
 
∑r£MîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiMîgeIndex
 );

117 
Void
 
∑r£P¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

118 
Void
 
∑r£PªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

120 
Void
 
∑r£I¡øDúLumaAng
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

121 
Void
 
∑r£I¡øDúChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

123 
Void
 
∑r£I¡îDú
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiI¡îDú
, UI¡ 
uiAbsP¨tIdx
 );

124 
Void
 
∑r£RefFrmIdx
 ( 
TComD©aCU
* 
pcCU
, 
I¡
& 
riRefFrmIdx
, 
RefPicLi°
 
eRefLi°
 );

125 
Void
 
∑r£Mvd
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiP¨tIdx
, UI¡ 
uiDïth
, 
RefPicLi°
 
eRefLi°
 );

127 
Void
 
∑r£CrossComp⁄ítPªdi˘i⁄
 ( 
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

129 
Void
 
∑r£Tønsf‹mSubdivFœg
–
UI¡
& 
ruiSubdivFœg
, UI¡ 
uiLog2Tønsf‹mBlockSize
 );

130 
Void
 
∑r£QtCbf
 ( 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 );

131 
Void
 
∑r£QtRoŸCbf
 ( 
UI¡
 
uiAbsP¨tIdx
, UI¡& 
uiQtRoŸCbf
 );

133 
Void
 
∑r£DñèQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

134 
Void
 
∑r£ChromaQpAdju°mít
–
TComD©aCU
* 
cu
, 
UI¡
 
absP¨tIdx
, UI¡ 
dïth
 );

136 
Void
 
∑r£IPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
);

138 
Void
 
∑r£La°Signifiˇ¡XY
–
UI¡
& 
uiPosLa°X
, UI¡& 
uiPosLa°Y
, 
I¡
 
width
, I¡ 
height
, 
Comp⁄ítID
 
comp⁄ít
, UI¡ 
uiSˇnIdx
 );

139 
Void
 
∑r£C€ffNxN
 ( 
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

140 
Void
 
∑r£Tønsf‹mSkùFœgs
 ( 
˛ass
 
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
 );

142 
Void
 
	$∑r£SˇlögLi°
 ( 
TComSˇlögLi°
* ) {
	}
}

144 
Void
 
∑r£Ex∂icôRdpcmMode
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

146 
	g¥iv©e
:

147 
C⁄ãxtModñ
 
m_c⁄ãxtModñs
[
MAX_NUM_CTX_MOD
];

148 
I¡
 
	gm_numC⁄ãxtModñs
;

149 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUS∂ôFœgSCModñ
;

150 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUSkùFœgSCModñ
;

151 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUMîgeFœgExtSCModñ
;

152 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUMîgeIdxExtSCModñ
;

153 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUP¨tSizeSCModñ
;

154 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUPªdModeSCModñ
;

155 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUI¡øPªdSCModñ
;

156 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUChromaPªdSCModñ
;

157 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUDñèQpSCModñ
;

158 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUI¡îDúSCModñ
;

159 
C⁄ãxtModñ3DBuf„r
 
	gm_cCURefPicSCModñ
;

160 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUMvdSCModñ
;

161 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUQtCbfSCModñ
;

162 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUTønsSubdivFœgSCModñ
;

163 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUQtRoŸCbfSCModñ
;

165 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUSigC€ffGroupSCModñ
;

166 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUSigSCModñ
;

167 
C⁄ãxtModñ3DBuf„r
 
	gm_cCuCtxLa°X
;

168 
C⁄ãxtModñ3DBuf„r
 
	gm_cCuCtxLa°Y
;

169 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUO√SCModñ
;

170 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUAbsSCModñ
;

172 
C⁄ãxtModñ3DBuf„r
 
	gm_cMVPIdxSCModñ
;

174 
C⁄ãxtModñ3DBuf„r
 
	gm_cSaoMîgeSCModñ
;

175 
C⁄ãxtModñ3DBuf„r
 
	gm_cSaoTy≥IdxSCModñ
;

176 
C⁄ãxtModñ3DBuf„r
 
	gm_cTønsf‹mSkùSCModñ
;

177 
C⁄ãxtModñ3DBuf„r
 
	gm_CUTønsqu™tBy∑ssFœgSCModñ
;

178 
C⁄ãxtModñ3DBuf„r
 
	gm_ex∂icôRdpcmFœgSCModñ
;

179 
C⁄ãxtModñ3DBuf„r
 
	gm_ex∂icôRdpcmDúSCModñ
;

180 
C⁄ãxtModñ3DBuf„r
 
	gm_cCrossComp⁄ítPªdi˘i⁄SCModñ
;

182 
C⁄ãxtModñ3DBuf„r
 
	gm_ChromaQpAdjFœgSCModñ
;

183 
C⁄ãxtModñ3DBuf„r
 
	gm_ChromaQpAdjIdcSCModñ
;

185 
UI¡
 
	gm_gﬁombRi˚Ad≠èti⁄Sèti°ics
[
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
];

	@TLibDecoder/TDecSlice.cpp

38 
	~"TDecSli˚.h
"

39 
	~"TDecC⁄f‹m™˚.h
"

48 
	gTDecSli˚
::
	$TDecSli˚
()

50 
	}
}

52 
TDecSli˚
::~
	$TDecSli˚
()

54 
	}
}

56 
Void
 
TDecSli˚
::
	$¸óã
()

58 
	}
}

60 
Void
 
TDecSli˚
::
	$de°roy
()

62 
	}
}

64 
Void
 
TDecSli˚
::
	$öô
(
TDecE¡r›y
* 
pcE¡r›yDecodî
, 
TDecCu
* 
pcCuDecodî
, 
TDecC⁄f‹m™˚Check
 *
pDecC⁄f‹m™˚Check
)

66 
m_pcE¡r›yDecodî
 = 
pcE¡r›yDecodî
;

67 
m_pcCuDecodî
 = 
pcCuDecodî
;

68 
m_pDecC⁄f‹m™˚Check
 = 
pDecC⁄f‹m™˚Check
;

69 
	}
}

72 
	$¥ötöfo
(
UCh¨
* 
d©a
, 
row
, 
cﬁ
, c⁄° * 
èg
)

74 
UCh¨
 
vÆ
 = 0;

75 
	`¥ötf
("mvöfo:%s:%d:%d:", 
èg
, 
row
, 
cﬁ
);

76 
size_t
 
i
 = 0; i < 
row
; i++)

78 
size_t
 
j
 = 0; j < 
cﬁ
; j++)

80 
vÆ
 = 
d©a
[
i
*
cﬁ
 + 
j
];

81 
	`¥ötf
("%02d,", 
vÆ
);

84 
	`¥ötf
("\n");

85 
	}
}

87 
Void
 
	gTDecSli˚
::
	$decom¥essSli˚
(
TComI≈utBô°ªam
** 
µcSub°ªams
, 
TComPic
* 
pcPic
, 
TDecSbac
* 
pcSbacDecodî
)

89 
TComSli˚
* 
pcSli˚
 = 
pcPic
->
	`gëSli˚
’cPic->
	`gëCuºSli˚Idx
());

91 c⁄° 
I¡
 
°¨tCtuTsAddr
 = 
pcSli˚
->
	`gëSli˚SegmítCurSèπCtuTsAddr
();

92 c⁄° 
I¡
 
°¨tCtuRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
°¨tCtuTsAddr
);

93 c⁄° 
UI¡
 
numCtusInFøme
 = 
pcPic
->
	`gëNumbîOfCtusInFøme
();

95 c⁄° 
UI¡
 
‰ameWidthInCtus
 = 
pcPic
->
	`gëPicSym
()->
	`gëFømeWidthInCtus
();

96 c⁄° 
Boﬁ
 
dïSli˚SegmítsE«bÀd
 = 
pcSli˚
->
	`gëPPS
()->
	`gëDïídítSli˚SegmítsE«bÀdFœg
();

97 c⁄° 
Boﬁ
 
wave‰⁄tsE«bÀd
 = 
pcSli˚
->
	`gëPPS
()->
	`gëE¡r›yCodögSyncE«bÀdFœg
();

99 
m_pcE¡r›yDecodî
->
	`£tE¡r›yDecodî
 ( 
pcSbacDecodî
 );

100 
m_pcE¡r›yDecodî
->
	`£tBô°ªam
 ( 
µcSub°ªams
[0] );

101 
m_pcE¡r›yDecodî
->
	`ª£tE¡r›y
 (
pcSli˚
);

104 
pcPic
->
	`£tPicYuvPªd
( 0 );

105 
pcPic
->
	`£tPicYuvResi
( 0 );

107 #i‡
ENC_DEC_TRACE


108 
g_bJu°DoIt
 = 
g_bEncDecTø˚E«bÀ
;

110 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

111 
	`DTRACE_CABAC_T
( "\tPOC: " );

112 
	`DTRACE_CABAC_V
–
pcPic
->
	`gëPOC
() );

113 
	`DTRACE_CABAC_T
( "\n" );

115 #i‡
ENC_DEC_TRACE


116 
g_bJu°DoIt
 = 
g_bEncDecTø˚DißbÀ
;

121 c⁄° 
UI¡
 
subSåómOff£t
=
pcPic
->
	`gëSub°ªamF‹CtuAddr
(
°¨tCtuRsAddr
, 
åue
, 
pcSli˚
);

124 i‡(
dïSli˚SegmítsE«bÀd
)

127 c⁄° 
UI¡
 
°¨tTûeIdx
=
pcPic
->
	`gëPicSym
()->
	`gëTûeIdxM≠
(
°¨tCtuRsAddr
);

128 c⁄° 
TComTûe
 *
pCuºítTûe
=
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
(
°¨tTûeIdx
);

129 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
pCuºítTûe
->
	`gëFú°CtuRsAddr
();

131 if–
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
(Ë&& 
°¨tCtuRsAddr
 !
fú°CtuRsAddrOfTûe
)

133 i‡–
pCuºítTûe
->
	`gëTûeWidthInCtus
(Ë>2 || !
wave‰⁄tsE«bÀd
)

135 
pcSbacDecodî
->
	`lﬂdC⁄ãxts
(&
m_œ°Sli˚SegmítEndC⁄ãxtSèã
);

142 
Boﬁ
 
isLa°CtuOfSli˚Segmít
 = 
Ál£
;

143  
UI¡
 
˘uTsAddr
 = 
°¨tCtuTsAddr
; !
isLa°CtuOfSli˚Segmít
 && ctuTsAdd∏< 
numCtusInFøme
; ctuTsAddr++)

145 c⁄° 
UI¡
 
˘uRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
˘uTsAddr
);

146 c⁄° 
TComTûe
 &
cuºítTûe
 = *(
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
’cPic->gëPicSym()->
	`gëTûeIdxM≠
(
˘uRsAddr
)));

147 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
cuºítTûe
.
	`gëFú°CtuRsAddr
();

148 c⁄° 
UI¡
 
tûeXPosInCtus
 = 
fú°CtuRsAddrOfTûe
 % 
‰ameWidthInCtus
;

149 c⁄° 
UI¡
 
tûeYPosInCtus
 = 
fú°CtuRsAddrOfTûe
 / 
‰ameWidthInCtus
;

150 c⁄° 
UI¡
 
˘uXPosInCtus
 = 
˘uRsAddr
 % 
‰ameWidthInCtus
;

151 c⁄° 
UI¡
 
˘uYPosInCtus
 = 
˘uRsAddr
 / 
‰ameWidthInCtus
;

152 c⁄° 
UI¡
 
uiSubSåm
=
pcPic
->
	`gëSub°ªamF‹CtuAddr
(
˘uRsAddr
, 
åue
, 
pcSli˚
)-
subSåómOff£t
;

153 
TComD©aCU
* 
pCtu
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 );

154 
pCtu
->
	`öôCtu
–
pcPic
, 
˘uRsAddr
 );

156 
m_pcE¡r›yDecodî
->
	`£tBô°ªam
–
µcSub°ªams
[
uiSubSåm
] );

159 i‡(
˘uRsAddr
 =
fú°CtuRsAddrOfTûe
)

161 i‡(
˘uTsAddr
 !
°¨tCtuTsAddr
)

163 
m_pcE¡r›yDecodî
->
	`ª£tE¡r›y
(
pcSli˚
);

166 i‡(
˘uXPosInCtus
 =
tûeXPosInCtus
 && 
wave‰⁄tsE«bÀd
)

169 i‡(
˘uTsAddr
 !
°¨tCtuTsAddr
)

171 
m_pcE¡r›yDecodî
->
	`ª£tE¡r›y
(
pcSli˚
);

173 
TComD©aCU
 *
pCtuUp
 = 
pCtu
->
	`gëCtuAbove
();

174 i‡–
pCtuUp
 && ((
˘uRsAddr
%
‰ameWidthInCtus
+1) < frameWidthInCtus) )

176 
TComD©aCU
 *
pCtuTR
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 - 
‰ameWidthInCtus
 + 1 );

177 i‡–
pCtu
->
	`CUIsFromSameSli˚AndTûe
(
pCtuTR
) )

180 
pcSbacDecodî
->
	`lﬂdC⁄ãxts
–&
m_íå›yCodögSyncC⁄ãxtSèã
 );

185 #i‡
ENC_DEC_TRACE


186 
g_bJu°DoIt
 = 
g_bEncDecTø˚E«bÀ
;

189 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 != 0

190 c⁄° 
UI¡
 
numRemaöögBôsPri‹ToCtu
=
µcSub°ªams
[
uiSubSåm
]->
	`gëNumBôsLe·
();

193 i‡–
pcSli˚
->
	`gëSPS
()->
	`gëU£SAO
() )

195 
SAOBlkP¨am
& 
ßoblkP¨am
 = (
pcPic
->
	`gëPicSym
()->
	`gëSAOBlkP¨am
())[
˘uRsAddr
];

196 
Boﬁ
 
bIsSAOSli˚E«bÀd
 = 
Ál£
;

197 
Boﬁ
 
¶i˚E«bÀd
[
MAX_NUM_COMPONENT
];

198 
I¡
 
comp
=0; com∞< 
MAX_NUM_COMPONENT
; comp++)

200 
Comp⁄ítID
 
compId
=
	`Comp⁄ítID
(
comp
);

201 
¶i˚E«bÀd
[
compId
] = 
pcSli˚
->
	`gëSaoE«bÀdFœg
(
	`toCh™√lTy≥
(compId)Ë&& (
comp
 < 
pcPic
->
	`gëNumbîVÆidComp⁄íts
());

202 i‡(
¶i˚E«bÀd
[
compId
])

204 
bIsSAOSli˚E«bÀd
=
åue
;

206 
ßoblkP¨am
[
compId
].
modeIdc
 = 
SAO_MODE_OFF
;

208 i‡(
bIsSAOSli˚E«bÀd
)

210 
Boﬁ
 
À·MîgeAvaû
 = 
Ál£
;

211 
Boﬁ
 
aboveMîgeAvaû

Ál£
;

214 
I¡
 
rx
 = (
˘uRsAddr
 % 
‰ameWidthInCtus
);

215 if(
rx
 > 0)

217 
À·MîgeAvaû
 = 
pcPic
->
	`gëSAOMîgeAvaûabûôy
(
˘uRsAddr
, ctuRsAddr-1);

220 
I¡
 
ry
 = (
˘uRsAddr
 / 
‰ameWidthInCtus
);

221 if(
ry
 > 0)

223 
aboveMîgeAvaû
 = 
pcPic
->
	`gëSAOMîgeAvaûabûôy
(
˘uRsAddr
, ctuRsAddr-
‰ameWidthInCtus
);

226 
pcSbacDecodî
->
	`∑r£SAOBlkP¨am
–
ßoblkP¨am
, 
¶i˚E«bÀd
, 
À·MîgeAvaû
, 
aboveMîgeAvaû
, 
pcSli˚
->
	`gëSPS
()->
	`gëBôDïths
());

230 
m_pcCuDecodî
->
	`decodeCtu
 ( 
pCtu
, 
isLa°CtuOfSli˚Segmít
 );

232 #i‡
DECODER_PARTIAL_CONFORMANCE_CHECK
 != 0

233 c⁄° 
UI¡
 
numRemaöögBôsPo°Ctu
=
µcSub°ªams
[
uiSubSåm
]->
	`gëNumBôsLe·
();

234 i‡(
TDecC⁄f‹m™˚Check
::
	`doCheckög
(Ë&& 
m_pDecC⁄f‹m™˚Check
)

236 
m_pDecC⁄f‹m™˚Check
->
	`checkCtuDecodög
(
numRemaöögBôsPri‹ToCtu
-
numRemaöögBôsPo°Ctu
);

240 
m_pcCuDecodî
->
	`decom¥essCtu
 ( 
pCtu
 );

242 
	`¥ötf
("mvöfo:˘u_x=%d:˘u_y=%d\n", 
˘uXPosInCtus
, 
˘uYPosInCtus
);

243 
	`¥ötöfo
((
UCh¨
*)
pCtu
->
m_skùFœg
, 16, 16, "skipflag");

244 
	`¥ötöfo
((
UCh¨
*)
pCtu
->
m_pcTrC€ff
, 16, 16, "TrCoeff");

245 
zîoMvFœg
[256] = {};

246 
size_t
 
i
 = 0; i < 256; i++)

248 i‡((!
pCtu
->
m_acCUMvFõld
[0].
m_pcMv
[
i
].
m_iH‹
) &&

249 (!
pCtu
->
m_acCUMvFõld
[0].
m_pcMv
[
i
].
m_iVî
) &&

250 (!
pCtu
->
m_acCUMvFõld
[1].
m_pcMv
[
i
].
m_iH‹
) &&

251 (!
pCtu
->
m_acCUMvFõld
[1].
m_pcMv
[
i
].
m_iVî
))

253 
zîoMvFœg
[
i
] = 1;

256 
	`¥ötöfo
((
UCh¨
*)
zîoMvFœg
, 16, 16, "zeromvflag");

259 #i‡
ENC_DEC_TRACE


260 
g_bJu°DoIt
 = 
g_bEncDecTø˚DißbÀ
;

264 i‡–
˘uXPosInCtus
 =
tûeXPosInCtus
+1 && 
wave‰⁄tsE«bÀd
)

266 
m_íå›yCodögSyncC⁄ãxtSèã
.
	`lﬂdC⁄ãxts
–
pcSbacDecodî
 );

269 i‡(
isLa°CtuOfSli˚Segmít
)

271 #i‡
DECODER_CHECK_SUBSTREAM_AND_SLICE_TRAILING_BYTES


272 
pcSbacDecodî
->
	`∑r£RemaöögByãs
(
Ál£
);

274 if(!
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
())

276 
pcSli˚
->
	`£tSli˚CurEndCtuTsAddr
–
˘uTsAddr
+1 );

278 
pcSli˚
->
	`£tSli˚SegmítCurEndCtuTsAddr
–
˘uTsAddr
+1 );

280 i‡–
˘uXPosInCtus
 + 1 =
tûeXPosInCtus
 + 
cuºítTûe
.
	`gëTûeWidthInCtus
() &&

281 –
˘uYPosInCtus
 + 1 =
tûeYPosInCtus
 + 
cuºítTûe
.
	`gëTûeHeightInCtus
(Ë|| 
wave‰⁄tsE«bÀd
)

286 
UI¡
 
böVÆ
;

287 
pcSbacDecodî
->
	`∑r£Tîmö©ögBô
–
böVÆ
 );

288 
	`as£π
–
böVÆ
 );

289 #i‡
DECODER_CHECK_SUBSTREAM_AND_SLICE_TRAILING_BYTES


290 
pcSbacDecodî
->
	`∑r£RemaöögByãs
(
åue
);

296 
	`as£π
(
isLa°CtuOfSli˚Segmít
 =
åue
);

299 if–
dïSli˚SegmítsE«bÀd
 )

301 
m_œ°Sli˚SegmítEndC⁄ãxtSèã
.
	`lﬂdC⁄ãxts
–
pcSbacDecodî
 );

304 
	}
}

	@TLibDecoder/TDecSlice.h

38 #i‚de‡
__TDECSLICE__


39 
	#__TDECSLICE__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/Comm⁄Def.h
"

46 
	~"TLibComm⁄/TComBôSåóm.h
"

47 
	~"TLibComm⁄/TComPic.h
"

48 
	~"TDecE¡r›y.h
"

49 
	~"TDecCu.h
"

50 
	~"TDecSbac.h
"

51 
	~"TDecBöCodîCABAC.h
"

60 
˛ass
 
	gTDecC⁄f‹m™˚Check
;

63 ˛as†
	cTDecSli˚


65 
	m¥iv©e
:

67 
TDecE¡r›y
* 
m_pcE¡r›yDecodî
;

68 
TDecCu
* 
	mm_pcCuDecodî
;

69 
TDecC⁄f‹m™˚Check
 *
	mm_pDecC⁄f‹m™˚Check
;

71 
TDecSbac
 
	mm_œ°Sli˚SegmítEndC⁄ãxtSèã
;

72 
TDecSbac
 
	mm_íå›yCodögSyncC⁄ãxtSèã
;

73 
	mpublic
:

74 
TDecSli˚
();

75 
	mvútuÆ
 ~
TDecSli˚
();

77 
Void
 
öô
 ( 
TDecE¡r›y
* 
pcE¡r›yDecodî
, 
TDecCu
* 
pcMbDecodî
, 
TDecC⁄f‹m™˚Check
 *
pDecC⁄f‹m™˚Check
 );

78 
Void
 
¸óã
 ();

79 
Void
 
de°roy
 ();

81 
Void
 
decom¥essSli˚
 ( 
TComI≈utBô°ªam
** 
µcSub°ªams
, 
TComPic
* 
pcPic
, 
TDecSbac
* 
pcSbacDecodî
 );

	@TLibDecoder/TDecTop.cpp

38 
	~"NALªad.h
"

39 
	~"TDecT›.h
"

40 
	~"TDecC⁄f‹m™˚.h
"

45 
	gTDecT›
::
	$TDecT›
()

46 : 
	`m_iMaxRefPicNum
(0)

47 , 
	`m_assocüãdIRAPTy≥
(
NAL_UNIT_INVALID
)

48 , 
	`m_pocCRA
(0)

49 , 
	`m_pocR™domAc˚ss
(
MAX_INT
)

50 , 
	`m_cLi°Pic
()

51 , 
	`m_∑ømëîSëM™agî
()

52 , 
	`m_≠cSli˚PûŸ
(
NULL
)

53 , 
	`m_SEIs
()

54 , 
	`m_cPªdi˘i⁄
()

55 , 
	`m_cTrQu™t
()

56 , 
	`m_cG›Decodî
()

57 , 
	`m_cSli˚Decodî
()

58 , 
	`m_cCuDecodî
()

59 , 
	`m_cE¡r›yDecodî
()

60 , 
	`m_cCavlcDecodî
()

61 , 
	`m_cSbacDecodî
()

62 , 
	`m_cBöCABAC
()

63 , 
	`m_£iRódî
()

64 , 
	`m_cLo›Fûãr
()

65 , 
	`m_cSAO
()

66 , 
	`m_pcPic
(
NULL
)

67 , 
	`m_¥evPOC
(
MAX_INT
)

68 , 
	`m_¥evTid0POC
(0)

69 , 
	$m_bFú°Sli˚InPi˘uª
(
åue
)

70 #i‡
FGS_RDD5_ENABLE


71 , 
	`m_bFú°Pi˘uªInSequí˚
(
åue
)

72 , 
	`m_gøöCh¨a˘îi°ic
()

73 , 
	$m_gøöBuf
()

75 , 
	`m_bFú°Sli˚InSequí˚
(
åue
)

76 , 
	`m_¥evSli˚Skù≥d
(
Ál£
)

77 , 
	`m_skù≥dPOC
(0)

78 , 
	`m_bFú°Sli˚InBô°ªam
(
åue
)

79 , 
	`m_œ°POCNoOuçutPri‹Pics
(-1)

80 , 
	`m_isNoOuçutPri‹Pics
(
Ál£
)

81 , 
	$m_¸aNoRa¶OuçutFœg
(
Ál£
)

82 #i‡
O0043_BEST_EFFORT_DECODING


83 , 
	$m_f‹˚DecodeBôDïth
(8)

85 , 
	`m_pDecodedSEIOuçutSåóm
(
NULL
)

86 , 
	$m_w¨nögMesßgeSkùPi˘uª
(
Ál£
)

87 #i‡
MCTS_ENC_CHECK


88 , 
	$m_tm˘sCheckE«bÀd
(
Ál£
)

90 , 
	$m_¥efixSEINALUs
()

92 #i‡
ENC_DEC_TRACE


93 i‡(
g_hTø˚
 =
NULL
)

95 
g_hTø˚
 = 
	`f›í
( "TraceDec.txt", "wb" );

97 
g_bJu°DoIt
 = 
g_bEncDecTø˚DißbÀ
;

98 
g_nSymbﬁCou¡î
 = 0;

100 
	}
}

102 
	gTDecT›
::~
	$TDecT›
()

104 #i‡
ENC_DEC_TRACE


105 i‡(
g_hTø˚
 !
°dout
)

107 
	`f˛o£
–
g_hTø˚
 );

110 !
m_¥efixSEINALUs
.
	`em±y
())

112 
dñëe
 
m_¥efixSEINALUs
.
	`‰⁄t
();

113 
m_¥efixSEINALUs
.
	`p›_‰⁄t
();

115 
	}
}

117 
Void
 
	gTDecT›
::
	$¸óã
()

119 
m_cG›Decodî
.
	`¸óã
();

120 
m_≠cSli˚PûŸ
 = 
√w
 
TComSli˚
;

121 
m_uiSli˚Idx
 = 0;

122 
	}
}

124 
Void
 
	gTDecT›
::
	$de°roy
()

126 
m_cG›Decodî
.
	`de°roy
();

128 
dñëe
 
m_≠cSli˚PûŸ
;

129 
m_≠cSli˚PûŸ
 = 
NULL
;

131 
m_cSli˚Decodî
.
	`de°roy
();

132 
	}
}

134 
Void
 
	gTDecT›
::
	$öô
()

137 
	`öôROM
();

138 
m_cG›Decodî
.
	`öô
–&
m_cE¡r›yDecodî
, &
m_cSbacDecodî
, &
m_cBöCABAC
, &
m_cCavlcDecodî
, &
m_cSli˚Decodî
, &
m_cLo›Fûãr
, &
m_cSAO
);

139 
m_cSli˚Decodî
.
	`öô
–&
m_cE¡r›yDecodî
, &
m_cCuDecodî
, &
m_c⁄f‹m™˚Check
 );

140 #i‡
MCTS_ENC_CHECK


141 
m_cE¡r›yDecodî
.
	`öô
(&
m_cPªdi˘i⁄
, &
m_c⁄f‹m™˚Check
 );

143 
m_cE¡r›yDecodî
.
	`öô
(&
m_cPªdi˘i⁄
);

145 
	}
}

147 
Void
 
	gTDecT›
::
	$dñëePicBuf„r
 ( )

149 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
m_cLi°Pic
.
	`begö
();

150 
I¡
 
iSize
 = 
	`I¡
–
m_cLi°Pic
.
	`size
() );

152 
I¡
 
i
 = 0; i < 
iSize
; i++ )

154 
TComPic
* 
pcPic
 = *(
ôîPic
++);

155 
pcPic
->
	`de°roy
();

157 
dñëe
 
pcPic
;

158 
pcPic
 = 
NULL
;

161 
m_cSAO
.
	`de°roy
();

163 
m_cLo›Fûãr
. 
	`de°roy
();

166 
	`de°royROM
();

167 
	}
}

169 
Void
 
	gTDecT›
::
	$xGëNewPicBuf„r
 ( c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
TComPic
*& 
ΩcPic
, c⁄° 
UI¡
 
ãmp‹ÆLayî
 )

171 
m_iMaxRefPicNum
 = 
•s
.
	`gëMaxDecPicBuf„rög
(
ãmp‹ÆLayî
);

172 i‡(
m_cLi°Pic
.
	`size
(Ë< (
UI¡
)
m_iMaxRefPicNum
)

174 
ΩcPic
 = 
√w
 
	`TComPic
();

176 #i‡
REDUCED_ENCODER_MEMORY


177 
ΩcPic
->
	`¸óã
 ( 
•s
, 
µs
, 
Ál£
, 
åue
);

179 
ΩcPic
->
	`¸óã
 ( 
•s
, 
µs
, 
åue
);

182 
m_cLi°Pic
.
	`pushBack
–
ΩcPic
 );

187 
Boﬁ
 
bBuf„rIsAvaûabÀ
 = 
Ál£
;

188 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
m_cLi°Pic
.
	`begö
();

189 
ôîPic
 !
m_cLi°Pic
.
	`íd
())

191 
ΩcPic
 = *(
ôîPic
++);

192 i‡–
ΩcPic
->
	`gëRec⁄M¨k
(Ë=
Ál£
 &&ÑpcPic->
	`gëOuçutM¨k
() == false)

194 
ΩcPic
->
	`£tOuçutM¨k
(
Ál£
);

195 
bBuf„rIsAvaûabÀ
 = 
åue
;

199 i‡–
ΩcPic
->
	`gëSli˚
–0 )->
	`isRe„ªn˚d
(Ë=
Ál£
 &&ÑpcPic->
	`gëOuçutM¨k
() == false)

201 
ΩcPic
->
	`£tOuçutM¨k
(
Ál£
);

202 
ΩcPic
->
	`£tRec⁄M¨k
–
Ál£
 );

203 
ΩcPic
->
	`gëPicYuvRec
()->
	`£tB‹dîExãnsi⁄
–
Ál£
 );

204 
bBuf„rIsAvaûabÀ
 = 
åue
;

209 i‡–!
bBuf„rIsAvaûabÀ
 )

212 
m_iMaxRefPicNum
++;

213 
ΩcPic
 = 
√w
 
	`TComPic
();

214 
m_cLi°Pic
.
	`pushBack
–
ΩcPic
 );

216 
ΩcPic
->
	`de°roy
();

217 #i‡
REDUCED_ENCODER_MEMORY


218 
ΩcPic
->
	`¸óã
 ( 
•s
, 
µs
, 
Ál£
, 
åue
);

220 
ΩcPic
->
	`¸óã
 ( 
•s
, 
µs
, 
åue
);

222 
	}
}

224 
Void
 
	gTDecT›
::
execuãLo›Fûãrs
(
I¡
& 
poc
, 
TComLi°
<
TComPic
*>*& 
ΩcLi°Pic
)

226 i‡(!
	gm_pcPic
)

232 
TComPic
* 
	gpcPic
 = 
m_pcPic
;

236 
	gm_cG›Decodî
.
fûãrPi˘uª
(
pcPic
);

238 
	gTComSli˚
::
s‹tPicLi°
–
m_cLi°Pic
 );

239 
	gpoc
 = 
pcPic
->
gëSli˚
(
m_uiSli˚Idx
-1)->
gëPOC
();

240 
	gΩcLi°Pic
 = &
m_cLi°Pic
;

241 
	gm_cCuDecodî
.
de°roy
();

242 
	gm_bFú°Sli˚InPi˘uª
 = 
åue
;

247 
Void
 
	gTDecT›
::
checkNoOuçutPri‹Pics
 (
TComLi°
<
TComPic
*>* 
pcLi°Pic
)

249 i‡(!
pcLi°Pic
 || !
m_isNoOuçutPri‹Pics
)

254 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
pcLi°Pic
->
begö
();

256 
	gôîPic
 !
pcLi°Pic
->
íd
())

258 
TComPic
* 
pcPicTmp
 = *(
ôîPic
++);

259 i‡(
	gm_œ°POCNoOuçutPri‹Pics
 !
pcPicTmp
->
gëPOC
())

261 
pcPicTmp
->
£tOuçutM¨k
(
Ál£
);

266 
Void
 
	gTDecT›
::
	$xCª©eLo°Pi˘uª
(
I¡
 
iLo°Poc
)

268 
	`¥ötf
("\nö£πögÜo°Öo¯: %d\n",
iLo°Poc
);

269 
TComPic
 *
cFûlPic
;

270 
	`xGëNewPicBuf„r
(*(
m_∑ømëîSëM™agî
.
	`gëFú°SPS
()), *(m_∑ømëîSëM™agî.
	`gëFú°PPS
()), 
cFûlPic
, 0);

271 
cFûlPic
->
	`gëSli˚
(0)->
	`öôSli˚
();

273 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
m_cLi°Pic
.
	`begö
();

274 
I¡
 
˛o£°Poc
 = 1000000;

275  
ôîPic
 !
m_cLi°Pic
.
	`íd
())

277 
TComPic
 * 
ΩcPic
 = *(
ôîPic
++);

278 if(
	`abs
(
ΩcPic
->
	`gëPicSym
()->
	`gëSli˚
(0)->
	`gëPOC
(Ë-
iLo°Poc
)<
˛o£°Poc
&&abs‘pcPic->gëPicSym()->gëSli˚(0)->gëPOC(Ë-iLo°Poc)!=0&&ΩcPic->gëPicSym()->gëSli˚(0)->gëPOC()!=
m_≠cSli˚PûŸ
->getPOC())

280 
˛o£°Poc
=
	`abs
(
ΩcPic
->
	`gëPicSym
()->
	`gëSli˚
(0)->
	`gëPOC
(Ë-
iLo°Poc
);

283 
ôîPic
 = 
m_cLi°Pic
.
	`begö
();

284  
ôîPic
 !
m_cLi°Pic
.
	`íd
())

286 
TComPic
 *
ΩcPic
 = *(
ôîPic
++);

287 if(
	`abs
(
ΩcPic
->
	`gëPicSym
()->
	`gëSli˚
(0)->
	`gëPOC
(Ë-
iLo°Poc
)==
˛o£°Poc
&&ΩcPic->gëPicSym()->gëSli˚(0)->gëPOC()!=
m_≠cSli˚PûŸ
->getPOC())

289 
	`¥ötf
("c›yögÖi˘uª %dÅÿ%d (%d)\n",
ΩcPic
->
	`gëPicSym
()->
	`gëSli˚
(0)->
	`gëPOC
(Ë,
iLo°Poc
,
m_≠cSli˚PûŸ
->getPOC());

290 
ΩcPic
->
	`gëPicYuvRec
()->
	`c›yToPic
(
cFûlPic
->getPicYuvRec());

294 
cFûlPic
->
	`£tCuºSli˚Idx
(0);

295 
I¡
 
˘uRsAddr
=0; ctuRsAddr<
cFûlPic
->
	`gëNumbîOfCtusInFøme
(); ctuRsAddr++)

297 
cFûlPic
->
	`gëCtu
(
˘uRsAddr
)->
	`öôCtu
(cFillPic, ctuRsAddr);

299 
cFûlPic
->
	`gëSli˚
(0)->
	`£tRe„ªn˚d
(
åue
);

300 
cFûlPic
->
	`gëSli˚
(0)->
	`£tPOC
(
iLo°Poc
);

301 
	`xUpd©ePªviousTid0POC
(
cFûlPic
->
	`gëSli˚
(0));

302 
cFûlPic
->
	`£tRec⁄M¨k
(
åue
);

303 
cFûlPic
->
	`£tOuçutM¨k
(
åue
);

304 if(
m_pocR™domAc˚ss
 =
MAX_INT
)

306 
m_pocR™domAc˚ss
 = 
iLo°Poc
;

308 
	}
}

310 #i‡
MCTS_EXTRACTION


311 
Void
 
	gTDecT›
::
	$xA˘iv©eP¨amëîSës
(
Boﬁ
 
bSkùCabacAndRec⁄°ru˘i⁄
)

313 
Void
 
TDecT›
::
	$xA˘iv©eP¨amëîSës
()

316 i‡(
m_bFú°Sli˚InPi˘uª
)

318 c⁄° 
TComPPS
 *
µs
 = 
m_∑ømëîSëM™agî
.
	`gëPPS
(
m_≠cSli˚PûŸ
->
	`gëPPSId
());

319 
	`as£π
 (
µs
 != 0);

321 c⁄° 
TComSPS
 *
•s
 = 
m_∑ømëîSëM™agî
.
	`gëSPS
(
µs
->
	`gëSPSId
());

322 
	`as£π
 (
•s
 != 0);

324 
m_∑ømëîSëM™agî
.
	`˛órSPSCh™gedFœg
(
•s
->
	`gëSPSId
());

325 
m_∑ømëîSëM™agî
.
	`˛órPPSCh™gedFœg
(
µs
->
	`gëPPSId
());

327 i‡(
Ál£
 =
m_∑ømëîSëM™agî
.
	`a˘iv©ePPS
(
m_≠cSli˚PûŸ
->
	`gëPPSId
(),m_≠cSli˚PûŸ->
	`isIRAP
()))

329 
	`¥ötf
 ("Parameter setáctivation failed!");

330 
	`as£π
 (0);

333 
	`xP¨£PªfixSEImesßges
();

334 #i‡
MCTS_ENC_CHECK


335 
	`xA«ly£PªfixSEImesßges
();

338 #i‡
RExt__HIGH_BIT_DEPTH_SUPPORT
==0

339 i‡(
•s
->
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
(Ë|| sps->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
)>12 || sps->gëBôDïth(
CHANNEL_TYPE_CHROMA
)>12 )

341 
	`¥ötf
("High bit depth support must beÉnabledát compile-time in orderÅo decodeÅhis bitstream\n");

342 
	`as£π
 (0);

343 
	`exô
(1);

352 
	`xGëNewPicBuf„r
 (*(
•s
), *(
µs
), 
m_pcPic
, 
m_≠cSli˚PûŸ
->
	`gëTLayî
());

353 
m_≠cSli˚PûŸ
->
	`≠∂yRe„ªn˚Pi˘uªSë
(
m_cLi°Pic
, m_≠cSli˚PûŸ->
	`gëRPS
());

354 #i‡
FGS_RDD5_ENABLE


356 
m_pcPic
->
	`¸óãGøöSy¡hesizî
(
m_bFú°Pi˘uªInSequí˚
, &
m_gøöCh¨a˘îi°ic
, &
m_gøöBuf
, 
•s
);

357 
m_bFú°Pi˘uªInSequí˚
 = 
Ál£
;

360 
	`as£π
(
m_pcPic
->
	`gëNumAŒoˇãdSli˚
(Ë=(
m_uiSli˚Idx
 + 1));

361 
m_≠cSli˚PûŸ
 = 
m_pcPic
->
	`gëPicSym
()->
	`sw≠Sli˚Obje˘
(m_≠cSli˚PûŸ, 
m_uiSli˚Idx
);

364 
TComSli˚
 *
pSli˚
 = 
m_pcPic
->
	`gëSli˚
(
m_uiSli˚Idx
);

367 
µs
=
pSli˚
->
	`gëPPS
();

368 
•s
=
pSli˚
->
	`gëSPS
();

371 
m_cSAO
.
	`¸óã
–
•s
->
	`gëPicWidthInLumaSam∂es
(), sps->
	`gëPicHeightInLumaSam∂es
(), sps->
	`gëChromaF‹m©Idc
(), sps->
	`gëMaxCUWidth
(), sps->
	`gëMaxCUHeight
(), sps->
	`gëMaxTŸÆCUDïth
(), 
µs
->
	`gëPpsR™geExãnsi⁄
().
	`gëLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_LUMA
),Öps->gëPpsR™geExãnsi⁄().gëLog2SaoOff£tSˇÀ(
CHANNEL_TYPE_CHROMA
) );

372 
m_cLo›Fûãr
.
	`¸óã
–
•s
->
	`gëMaxTŸÆCUDïth
() );

373 
m_cPªdi˘i⁄
.
	`öôTempBuff
(
•s
->
	`gëChromaF‹m©Idc
());

376 
Boﬁ
 
isFõld
 = 
Ál£
;

377 
Boﬁ
 
isT›Fõld
 = 
Ál£
;

379 if(!
m_SEIs
.
	`em±y
())

382 
SEIMesßges
 
pi˘uªTimögSEIs
 = 
	`gëSeisByTy≥
(
m_SEIs
, 
SEI
::
PICTURE_TIMING
);

383 i‡(
pi˘uªTimögSEIs
.
	`size
()>0)

385 
SEIPi˘uªTimög
* 
pi˘uªTimög
 = (SEIPi˘uªTimög*Ë*(
pi˘uªTimögSEIs
.
	`begö
());

386 
isFõld
 = (
pi˘uªTimög
->
m_picSåu˘
 == 1) || (pictureTiming->m_picStruct == 2) || (pictureTiming->m_picStruct == 9) || (pictureTiming->m_picStruct == 10) || (pictureTiming->m_picStruct == 11) || (pictureTiming->m_picStruct == 12);

387 
isT›Fõld
 = (
pi˘uªTimög
->
m_picSåu˘
 == 1) || (pictureTiming->m_picStruct == 9) || (pictureTiming->m_picStruct == 11);

392 
m_pcPic
->
	`£tFõld
(
isFõld
);

393 
m_pcPic
->
	`£tT›Fõld
(
isT›Fõld
);

396 
m_pcPic
->
	`£tSEIs
(
m_SEIs
);

397 
m_SEIs
.
	`˛ór
();

398 #i‡
MCTS_EXTRACTION


399 i‡(!
bSkùCabacAndRec⁄°ru˘i⁄
)

403 
m_cCuDecodî
.
	`¸óã
 ( 
•s
->
	`gëMaxTŸÆCUDïth
(), sps->
	`gëMaxCUWidth
(), sps->
	`gëMaxCUHeight
(), sps->
	`gëChromaF‹m©Idc
() );

404 #i‡
MCTS_ENC_CHECK


405 
m_cCuDecodî
.
	`öô
 ( &
m_cE¡r›yDecodî
, &
m_cTrQu™t
, &
m_cPªdi˘i⁄
, &
m_c⁄f‹m™˚Check
 );

407 
m_cCuDecodî
.
	`öô
(&
m_cE¡r›yDecodî
, &
m_cTrQu™t
, &
m_cPªdi˘i⁄
);

409 
m_cTrQu™t
.
	`öô
 ( 
•s
->
	`gëMaxTrSize
() );

411 
m_cSli˚Decodî
.
	`¸óã
();

413 #i‡
MCTS_EXTRACTION


419 
m_pcPic
->
	`ÆloˇãNewSli˚
();

420 
	`as£π
(
m_pcPic
->
	`gëNumAŒoˇãdSli˚
(Ë=(
m_uiSli˚Idx
 + 1));

421 
m_≠cSli˚PûŸ
 = 
m_pcPic
->
	`gëPicSym
()->
	`sw≠Sli˚Obje˘
(m_≠cSli˚PûŸ, 
m_uiSli˚Idx
);

423 
TComSli˚
 *
pSli˚
 = 
m_pcPic
->
	`gëSli˚
(
m_uiSli˚Idx
);

425 c⁄° 
TComSPS
 *
•s
 = 
pSli˚
->
	`gëSPS
();

426 c⁄° 
TComPPS
 *
µs
 = 
pSli˚
->
	`gëPPS
();

429 i‡(
m_∑ømëîSëM™agî
.
	`gëSPSCh™gedFœg
(
•s
->
	`gëSPSId
()) )

431 
	`¥ötf
("Error -áÇew SPS has been decoded whileÖrocessingáÖicture\n");

432 
	`exô
(1);

434 i‡(
m_∑ømëîSëM™agî
.
	`gëPPSCh™gedFœg
(
µs
->
	`gëPPSId
()) )

436 
	`¥ötf
("Error -áÇew PPS has been decoded whileÖrocessingáÖicture\n");

437 
	`exô
(1);

440 
	`xP¨£PªfixSEImesßges
();

441 #i‡
MCTS_ENC_CHECK


442 
	`xA«ly£PªfixSEImesßges
();

445 if(!
m_SEIs
.
	`em±y
())

448 
SEIMesßges
 &
picSEI
 = 
m_pcPic
->
	`gëSEIs
();

449 
SEIMesßges
 
decodögUnôInfos
 = 
	`exåa˘SeisByTy≥
 (
m_SEIs
, 
SEI
::
DECODING_UNIT_INFO
);

450 
picSEI
.
	`ö£π
’icSEI.
	`íd
(), 
decodögUnôInfos
.
	`begö
(), decodingUnitInfos.end());

451 
	`dñëeSEIs
(
m_SEIs
);

454 
	}
}

457 
Void
 
	gTDecT›
::
	$xP¨£PªfixSEIsF‹UnknownVCLNÆ
()

459 !
m_¥efixSEINALUs
.
	`em±y
())

462 
	`¥ötf
("Discarding Prefix SEIássociated with unknown VCL NAL unit.\n");

463 
dñëe
 
m_¥efixSEINALUs
.
	`‰⁄t
();

466 
	}
}

469 
Void
 
	gTDecT›
::
	$xP¨£PªfixSEImesßges
()

471 !
m_¥efixSEINALUs
.
	`em±y
())

473 
I≈utNALUnô
 &
«lu
=*
m_¥efixSEINALUs
.
	`‰⁄t
();

474 
m_£iRódî
.
	`∑r£SEImesßge
–&(
«lu
.
	`gëBô°ªam
()), 
m_SEIs
,ÇÆu.
m_«lUnôTy≥
, 
m_∑ømëîSëM™agî
.
	`gëA˘iveSPS
(), 
m_pDecodedSEIOuçutSåóm
 );

475 
dñëe
 
m_¥efixSEINALUs
.
	`‰⁄t
();

476 
m_¥efixSEINALUs
.
	`p›_‰⁄t
();

478 
	}
}

480 #i‡
MCTS_ENC_CHECK


481 
Void
 
	gTDecT›
::
	$xA«ly£PªfixSEImesßges
()

483 i‡(
m_tm˘sCheckE«bÀd
)

485 
SEIMesßges
 
m˘sSEIs
 = 
	`gëSeisByTy≥
(
m_SEIs
, 
SEI
::
TEMP_MOTION_CONSTRAINED_TILE_SETS
);

486 
SEIMesßges
::
ôî©‹
 
ô
 = 
m˘sSEIs
.
	`begö
(); ià!m˘sSEIs.
	`íd
(); it++)

488 
SEITempMŸi⁄C⁄°øöedTûeSës
 *
m˘s
 = (SEITempMŸi⁄C⁄°øöedTûeSës*)(*
ô
);

489 i‡(!
m˘s
->
m_óch_tûe_⁄e_tûe_£t_Êag
)

491 
	`¥ötf
("cannot (yet) check Temporal constrained MCTS ifÉach_tile_one_tile_set_flag isÇotÉnabled\n");

492 
	`exô
(1);

496 
	`¥ötf
("MCTS checkÉnabled!\n");

497 
m_c⁄f‹m™˚Check
.
	`íabÀTM˘sCheck
(
åue
);

501 
	}
}

504 #i‡
MCTS_EXTRACTION


505 
Boﬁ
 
	gTDecT›
::
	$xDecodeSli˚
(
I≈utNALUnô
 &
«lu
, 
I¡
 &
iSkùFøme
, I¡ 
iPOCLa°Di•œy
, 
Boﬁ
 
bSkùCabacAndRec⁄°ru˘i⁄
)

507 
Boﬁ
 
TDecT›
::
	$xDecodeSli˚
(
I≈utNALUnô
 &
«lu
, 
I¡
 &
iSkùFøme
, I¡ 
iPOCLa°Di•œy
)

510 
m_≠cSli˚PûŸ
->
	`öôSli˚
();

513 i‡(
m_bFú°Sli˚InPi˘uª
)

515 
m_uiSli˚Idx
 = 0;

519 
m_≠cSli˚PûŸ
->
	`c›ySli˚Info
–
m_pcPic
->
	`gëPicSym
()->
	`gëSli˚
(
m_uiSli˚Idx
-1) );

521 
m_≠cSli˚PûŸ
->
	`£tSli˚Idx
(
m_uiSli˚Idx
);

523 
m_≠cSli˚PûŸ
->
	`£tNÆUnôTy≥
(
«lu
.
m_«lUnôTy≥
);

524 
Boﬁ
 
n⁄Re„ªn˚Fœg
 = (
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_TRAIL_N
 ||

525 
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_TSA_N
 ||

526 
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_STSA_N
 ||

527 
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RADL_N
 ||

528 
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RASL_N
);

529 
m_≠cSli˚PûŸ
->
	`£tTemp‹ÆLayîN⁄Re„ªn˚Fœg
(
n⁄Re„ªn˚Fœg
);

530 
m_≠cSli˚PûŸ
->
	`£tRe„ªn˚d
(
åue
);

531 
m_≠cSli˚PûŸ
->
	`£tTLayîInfo
(
«lu
.
m_ãmp‹ÆId
);

533 #i‡
ENC_DEC_TRACE


534 c⁄° 
UI¡64
 
‹igöÆSymbﬁCou¡
 = 
g_nSymbﬁCou¡î
;

537 
m_cE¡r›yDecodî
.
	`decodeSli˚Hódî
 (
m_≠cSli˚PûŸ
, &
m_∑ømëîSëM™agî
, 
m_¥evTid0POC
);

540 if(
m_≠cSli˚PûŸ
->
	`gëDïídítSli˚SegmítFœg
(Ë&& 
m_¥evSli˚Skù≥d
)

542 
m_≠cSli˚PûŸ
->
	`£tPOC
(
m_skù≥dPOC
);

545 
	`xUpd©ePªviousTid0POC
(
m_≠cSli˚PûŸ
);

547 
m_≠cSli˚PûŸ
->
	`£tAssocüãdIRAPPOC
(
m_pocCRA
);

548 
m_≠cSli˚PûŸ
->
	`£tAssocüãdIRAPTy≥
(
m_assocüãdIRAPTy≥
);

551 i‡(
m_≠cSli˚PûŸ
->
	`gëR≠PicFœg
())

553 i‡((
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë>
NAL_UNIT_CODED_SLICE_BLA_W_LP
 && m_≠cSli˚PûŸ->gëNÆUnôTy≥(Ë<
NAL_UNIT_CODED_SLICE_IDR_N_LP
) ||

554 (
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
 && 
m_bFú°Sli˚InSequí˚
) ||

555 (
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
 && m_≠cSli˚PûŸ->
	`gëH™dÀCøAsBœFœg
()))

557 
m_≠cSli˚PûŸ
->
	`£tNoRa¶OuçutFœg
(
åue
);

560 i‡(!
m_bFú°Sli˚InBô°ªam
 && 
m_≠cSli˚PûŸ
->
	`gëR≠PicFœg
(Ë&& m_≠cSli˚PûŸ->
	`gëNoRa¶OuçutFœg
())

562 i‡(
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
)

564 
m_≠cSli˚PûŸ
->
	`£tNoOuçutPri‹PicsFœg
(
åue
);

569 
m_≠cSli˚PûŸ
->
	`£tNoOuçutPri‹PicsFœg
(
Ál£
);

572 if(
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
)

574 
m_¸aNoRa¶OuçutFœg
 = 
m_≠cSli˚PûŸ
->
	`gëNoRa¶OuçutFœg
();

577 i‡(
m_≠cSli˚PûŸ
->
	`gëR≠PicFœg
(Ë&& m_≠cSli˚PûŸ->
	`gëNoOuçutPri‹PicsFœg
())

579 
m_œ°POCNoOuçutPri‹Pics
 = 
m_≠cSli˚PûŸ
->
	`gëPOC
();

580 
m_isNoOuçutPri‹Pics
 = 
åue
;

584 
m_isNoOuçutPri‹Pics
 = 
Ál£
;

588 i‡(
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RASL_N
 || m_≠cSli˚PûŸ->gëNÆUnôTy≥(Ë=
NAL_UNIT_CODED_SLICE_RASL_R
)

590 i‡–
m_¸aNoRa¶OuçutFœg
 )

592 
m_≠cSli˚PûŸ
->
	`£tPicOuçutFœg
(
Ál£
);

596 i‡(
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
 && 
m_¸aNoRa¶OuçutFœg
)

598 
TComPPS
 *
µs
 = 
m_∑ømëîSëM™agî
.
	`gëPPS
(
m_≠cSli˚PûŸ
->
	`gëPPSId
());

599 
	`as£π
 (
µs
 != 0);

600 
TComSPS
 *
•s
 = 
m_∑ømëîSëM™agî
.
	`gëSPS
(
µs
->
	`gëSPSId
());

601 
	`as£π
 (
•s
 != 0);

602 
I¡
 
iMaxPOClsb
 = 1 << 
•s
->
	`gëBôsF‹POC
();

603 
m_≠cSli˚PûŸ
->
	`£tPOC
–m_≠cSli˚PûŸ->
	`gëPOC
(Ë& (
iMaxPOClsb
 - 1) );

604 
	`xUpd©ePªviousTid0POC
(
m_≠cSli˚PûŸ
);

609 i‡(
	`isR™domAc˚ssSkùPi˘uª
(
iSkùFøme
, 
iPOCLa°Di•œy
))

611 
m_¥evSli˚Skù≥d
 = 
åue
;

612 
m_skù≥dPOC
 = 
m_≠cSli˚PûŸ
->
	`gëPOC
();

613  
Ál£
;

616 i‡(
	`isSkùPi˘uªF‹BLA
(
iPOCLa°Di•œy
))

618 
m_¥evSli˚Skù≥d
 = 
åue
;

619 
m_skù≥dPOC
 = 
m_≠cSli˚PûŸ
->
	`gëPOC
();

620  
Ál£
;

624 
m_¥evSli˚Skù≥d
 = 
Ál£
;

627 i‡(!
m_≠cSli˚PûŸ
->
	`gëDïídítSli˚SegmítFœg
(Ë&& m_≠cSli˚PûŸ->
	`gëPOC
()!=
m_¥evPOC
 && !
m_bFú°Sli˚InSequí˚
 && (m_≠cSli˚PûŸ->
	`gëSli˚CurSèπCtuTsAddr
() != 0))

629 
	`¥ötf
 ("Warning,Åhe first slice ofáÖicture might have beenÜost!\n");

633 i‡(!
m_≠cSli˚PûŸ
->
	`gëDïídítSli˚SegmítFœg
(Ë&& (m_≠cSli˚PûŸ->
	`gëSli˚CurSèπCtuTsAddr
(Ë=0 && !
m_bFú°Sli˚InPi˘uª
) )

635 i‡(
m_¥evPOC
 >
m_pocR™domAc˚ss
)

637 
m_¥evPOC
 = 
m_≠cSli˚PûŸ
->
	`gëPOC
();

638 #i‡
ENC_DEC_TRACE


640 
g_nSymbﬁCou¡î
 = 
‹igöÆSymbﬁCou¡
;

642  
åue
;

644 
m_¥evPOC
 = 
m_≠cSli˚PûŸ
->
	`gëPOC
();

649 
I¡
 
lo°Poc
;

650 (
lo°Poc
=
m_≠cSli˚PûŸ
->
	`checkTh©AŒRefPicsAªAvaûabÀ
(
m_cLi°Pic
, m_≠cSli˚PûŸ->
	`gëRPS
(), 
åue
, 
m_pocR™domAc˚ss
)) > 0)

652 
	`xCª©eLo°Pi˘uª
(
lo°Poc
-1);

656 i‡(!
m_≠cSli˚PûŸ
->
	`gëDïídítSli˚SegmítFœg
())

658 
m_¥evPOC
 = 
m_≠cSli˚PûŸ
->
	`gëPOC
();

662 #i‡
MCTS_EXTRACTION


663 
	`xA˘iv©eP¨amëîSës
(
bSkùCabacAndRec⁄°ru˘i⁄
);

665 
	`xA˘iv©eP¨amëîSës
();

669 
TComSli˚
* 
pcSli˚
 = 
m_pcPic
->
	`gëPicSym
()->
	`gëSli˚
(
m_uiSli˚Idx
);

671 i‡(
TDecC⁄f‹m™˚Check
::
	`doCheckög
())

673 
m_c⁄f‹m™˚Check
.
	`checkSli˚A˘iv©i⁄
(*
pcSli˚
, 
«lu
, *
m_pcPic
, 
m_bFú°Sli˚InBô°ªam
, 
m_bFú°Sli˚InSequí˚
, 
m_bFú°Sli˚InPi˘uª
);

676 
m_bFú°Sli˚InSequí˚
 = 
Ál£
;

677 
m_bFú°Sli˚InBô°ªam
 = 
Ál£
;

681 
pcSli˚
->
	`£tSli˚SegmítCurSèπCtuTsAddr
–
m_pcPic
->
	`gëPicSym
()->
	`gëCtuRsToTsAddrM≠
’cSli˚->
	`gëSli˚SegmítCurSèπCtuTsAddr
()) );

682 
pcSli˚
->
	`£tSli˚SegmítCurEndCtuTsAddr
–
m_pcPic
->
	`gëPicSym
()->
	`gëCtuRsToTsAddrM≠
’cSli˚->
	`gëSli˚SegmítCurEndCtuTsAddr
()) );

683 if(!
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
())

685 
pcSli˚
->
	`£tSli˚CurSèπCtuTsAddr
(
m_pcPic
->
	`gëPicSym
()->
	`gëCtuRsToTsAddrM≠
’cSli˚->
	`gëSli˚CurSèπCtuTsAddr
()));

686 
pcSli˚
->
	`£tSli˚CurEndCtuTsAddr
(
m_pcPic
->
	`gëPicSym
()->
	`gëCtuRsToTsAddrM≠
’cSli˚->
	`gëSli˚CurEndCtuTsAddr
()));

689 
m_pcPic
->
	`£tTLayî
(
«lu
.
m_ãmp‹ÆId
);

691 i‡(!
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
())

693 
pcSli˚
->
	`checkCRA
’cSli˚->
	`gëRPS
(), 
m_pocCRA
, 
m_assocüãdIRAPTy≥
, 
m_cLi°Pic
);

694 #i‡
MCTS_EXTRACTION


695 i‡(
bSkùCabacAndRec⁄°ru˘i⁄
)

697 
m_bFú°Sli˚InPi˘uª
 = 
Ál£
;

698 
m_uiSli˚Idx
++;

699  
Ál£
;

703 
pcSli˚
->
	`£tRefPicLi°
–
m_cLi°Pic
, 
åue
 );

707 i‡(
pcSli˚
->
	`isI¡îB
(Ë&&ÖcSli˚->
	`gëNumRefIdx
(
REF_PIC_LIST_1
) == 0)

709 
I¡
 
iNumRefIdx
 = 
pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_0
);

710 
pcSli˚
->
	`£tNumRefIdx
 ( 
REF_PIC_LIST_1
, 
iNumRefIdx
 );

712 
I¡
 
iRefIdx
 = 0; iRefIdx < 
iNumRefIdx
; iRefIdx++)

714 
pcSli˚
->
	`£tRefPic
’cSli˚->
	`gëRefPic
(
REF_PIC_LIST_0
, 
iRefIdx
), 
REF_PIC_LIST_1
, iRefIdx);

717 i‡(!
pcSli˚
->
	`isI¡ø
())

719 
Boﬁ
 
bLowDñay
 = 
åue
;

720 
I¡
 
iCuºPOC
 = 
pcSli˚
->
	`gëPOC
();

721 
I¡
 
iRefIdx
 = 0;

723 
iRefIdx
 = 0; iRefIdx < 
pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_0
Ë&& 
bLowDñay
; iRefIdx++)

725 i‡–
pcSli˚
->
	`gëRefPic
(
REF_PIC_LIST_0
, 
iRefIdx
)->
	`gëPOC
(Ë> 
iCuºPOC
 )

727 
bLowDñay
 = 
Ál£
;

730 i‡(
pcSli˚
->
	`isI¡îB
())

732 
iRefIdx
 = 0; iRefIdx < 
pcSli˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_1
Ë&& 
bLowDñay
; iRefIdx++)

734 i‡–
pcSli˚
->
	`gëRefPic
(
REF_PIC_LIST_1
, 
iRefIdx
)->
	`gëPOC
(Ë> 
iCuºPOC
 )

736 
bLowDñay
 = 
Ál£
;

741 
pcSli˚
->
	`£tCheckLDC
(
bLowDñay
);

745 
pcSli˚
->
	`£tRefPOCLi°
();

748 
m_pcPic
->
	`£tCuºSli˚Idx
(
m_uiSli˚Idx
);

749 if(
pcSli˚
->
	`gëSPS
()->
	`gëSˇlögLi°Fœg
())

751 
TComSˇlögLi°
 
sˇlögLi°
;

752 if(
pcSli˚
->
	`gëPPS
()->
	`gëSˇlögLi°Pª£¡Fœg
())

754 
sˇlögLi°
 = 
pcSli˚
->
	`gëPPS
()->
	`gëSˇlögLi°
();

756 i‡(
pcSli˚
->
	`gëSPS
()->
	`gëSˇlögLi°Pª£¡Fœg
())

758 
sˇlögLi°
 = 
pcSli˚
->
	`gëSPS
()->
	`gëSˇlögLi°
();

762 
sˇlögLi°
.
	`£tDeÁu…SˇlögLi°
();

764 
m_cTrQu™t
.
	`£tSˇlögLi°Dec
(
sˇlögLi°
);

765 
m_cTrQu™t
.
	`£tU£SˇlögLi°
(
åue
);

769 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
] =

771 
pcSli˚
->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
CHANNEL_TYPE_LUMA
),

772 
pcSli˚
->
	`gëSPS
()->
	`gëMaxLog2TrDy«micR™ge
(
CHANNEL_TYPE_CHROMA
)

774 
m_cTrQu™t
.
	`£tFœtSˇlögLi°
(
maxLog2TrDy«micR™ge
, 
pcSli˚
->
	`gëSPS
()->
	`gëBôDïths
());

775 
m_cTrQu™t
.
	`£tU£SˇlögLi°
(
Ál£
);

778 
	`¥ötf
("mvinfo:POC=%d:pic_w=%d:pic_h=%d:ctu_w=%d:ctu_h=%d\n",

779 
pcSli˚
->
	`gëPOC
(),

780 
pcSli˚
->
	`gëSPS
()->
	`gëPicWidthInLumaSam∂es
(),

781 
pcSli˚
->
	`gëSPS
()->
	`gëPicHeightInLumaSam∂es
(),

782 
pcSli˚
->
	`gëSPS
()->
	`gëMaxCUWidth
(),

783 
pcSli˚
->
	`gëSPS
()->
	`gëMaxCUHeight
());

786 
m_cG›Decodî
.
	`decom¥essSli˚
(&(
«lu
.
	`gëBô°ªam
()), 
m_pcPic
);

788 
m_bFú°Sli˚InPi˘uª
 = 
Ál£
;

789 
m_uiSli˚Idx
++;

791  
Ál£
;

792 
	}
}

794 
Void
 
	gTDecT›
::
xDecodeVPS
(c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
)

796 
TComVPS
* 
vps
 = 
√w
 TComVPS();

798 
	gm_cE¡r›yDecodî
.
decodeVPS
–
vps
 );

799 
	gm_∑ømëîSëM™agî
.
°‹eVPS
(
vps
, 
«luD©a
);

802 
Void
 
	gTDecT›
::
xDecodeSPS
(c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
)

804 
TComSPS
* 
•s
 = 
√w
 TComSPS();

805 #i‡
O0043_BEST_EFFORT_DECODING


806 
	g•s
->
£tF‹˚DecodeBôDïth
(
m_f‹˚DecodeBôDïth
);

808 
	gm_cE¡r›yDecodî
.
decodeSPS
–
•s
 );

809 
	gm_∑ømëîSëM™agî
.
°‹eSPS
(
•s
, 
«luD©a
);

812 
Void
 
	gTDecT›
::
xDecodePPS
(c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
)

814 
TComPPS
* 
µs
 = 
√w
 TComPPS();

815 
	gm_cE¡r›yDecodî
.
decodePPS
–
µs
 );

816 
	gm_∑ømëîSëM™agî
.
°‹ePPS
–
µs
, 
«luD©a
);

819 #i‡
MCTS_EXTRACTION


820 
Boﬁ
 
	gTDecT›
::
	$decode
(
I≈utNALUnô
& 
«lu
, 
I¡
& 
iSkùFøme
, I¡& 
iPOCLa°Di•œy
, 
Boﬁ
 
bSkùCabacAndRec⁄°ru˘i⁄
)

822 
Boﬁ
 
TDecT›
::
	$decode
(
I≈utNALUnô
& 
«lu
, 
I¡
& 
iSkùFøme
, I¡& 
iPOCLa°Di•œy
)

826 i‡(
«lu
.
m_nuhLayîId
 > 0)

828 
	`Ârötf
 (
°dîr
, "W¨nög: found NAL unô wôhÇuh_œyî_idÉquÆÅÿ%d. Ign‹ög.\n", 
«lu
.
m_nuhLayîId
);

829  
Ál£
;

832 
m_cE¡r›yDecodî
.
	`£tE¡r›yDecodî
 (&
m_cCavlcDecodî
);

833 
m_cE¡r›yDecodî
.
	`£tBô°ªam
 (&(
«lu
.
	`gëBô°ªam
()));

835 
«lu
.
m_«lUnôTy≥
)

837 
NAL_UNIT_VPS
:

838 
	`xDecodeVPS
(
«lu
.
	`gëBô°ªam
().
	`gëFifo
());

839  
Ál£
;

841 
NAL_UNIT_SPS
:

842 
	`xDecodeSPS
(
«lu
.
	`gëBô°ªam
().
	`gëFifo
());

843  
Ál£
;

845 
NAL_UNIT_PPS
:

846 
	`xDecodePPS
(
«lu
.
	`gëBô°ªam
().
	`gëFifo
());

847  
Ál£
;

849 
NAL_UNIT_PREFIX_SEI
:

851 
m_¥efixSEINALUs
.
	`push_back
(
√w
 
	`I≈utNALUnô
(
«lu
));

852  
Ál£
;

854 
NAL_UNIT_SUFFIX_SEI
:

855 i‡(
m_pcPic
)

857 
m_£iRódî
.
	`∑r£SEImesßge
–&(
«lu
.
	`gëBô°ªam
()), 
m_pcPic
->
	`gëSEIs
(),ÇÆu.
m_«lUnôTy≥
, 
m_∑ømëîSëM™agî
.
	`gëA˘iveSPS
(), 
m_pDecodedSEIOuçutSåóm
 );

861 
	`¥ötf
 ("Note:Ñeceived suffix SEI butÇoÖicture currentlyáctive.\n");

863  
Ál£
;

865 
NAL_UNIT_CODED_SLICE_TRAIL_R
:

866 
NAL_UNIT_CODED_SLICE_TRAIL_N
:

867 
NAL_UNIT_CODED_SLICE_TSA_R
:

868 
NAL_UNIT_CODED_SLICE_TSA_N
:

869 
NAL_UNIT_CODED_SLICE_STSA_R
:

870 
NAL_UNIT_CODED_SLICE_STSA_N
:

871 
NAL_UNIT_CODED_SLICE_BLA_W_LP
:

872 
NAL_UNIT_CODED_SLICE_BLA_W_RADL
:

873 
NAL_UNIT_CODED_SLICE_BLA_N_LP
:

874 
NAL_UNIT_CODED_SLICE_IDR_W_RADL
:

875 
NAL_UNIT_CODED_SLICE_IDR_N_LP
:

876 
NAL_UNIT_CODED_SLICE_CRA
:

877 
NAL_UNIT_CODED_SLICE_RADL_N
:

878 
NAL_UNIT_CODED_SLICE_RADL_R
:

879 
NAL_UNIT_CODED_SLICE_RASL_N
:

880 
NAL_UNIT_CODED_SLICE_RASL_R
:

881 #i‡
MCTS_EXTRACTION


882  
	`xDecodeSli˚
(
«lu
, 
iSkùFøme
, 
iPOCLa°Di•œy
, 
bSkùCabacAndRec⁄°ru˘i⁄
);

884  
	`xDecodeSli˚
(
«lu
, 
iSkùFøme
, 
iPOCLa°Di•œy
);

888 
NAL_UNIT_EOS
:

889 
m_assocüãdIRAPTy≥
 = 
NAL_UNIT_INVALID
;

890 
m_pocCRA
 = 0;

891 
m_pocR™domAc˚ss
 = 
MAX_INT
;

892 
m_¥evPOC
 = 
MAX_INT
;

893 
m_¥evSli˚Skù≥d
 = 
Ál£
;

894 
m_skù≥dPOC
 = 0;

895  
Ál£
;

897 
NAL_UNIT_ACCESS_UNIT_DELIMITER
:

899 
AUDRódî
 
audRódî
;

900 
UI¡
 
picTy≥
;

901 
audRódî
.
	`∑r£Ac˚ssUnôDñimôî
(&(
«lu
.
	`gëBô°ªam
()),
picTy≥
);

902 
	`¥ötf
 ("Note: found NAL_UNIT_ACCESS_UNIT_DELIMITER\n");

903  
Ál£
;

906 
NAL_UNIT_EOB
:

907  
Ál£
;

909 
NAL_UNIT_FILLER_DATA
:

911 
FDRódî
 
fdRódî
;

912 
UI¡
 
size
;

913 
fdRódî
.
	`∑r£FûÀrD©a
(&(
«lu
.
	`gëBô°ªam
()),
size
);

914 
	`¥ötf
 ("NŸe: found NAL_UNIT_FILLER_DATA wôh %u byã†∑ylﬂd.\n", 
size
);

915  
Ál£
;

918 
NAL_UNIT_RESERVED_VCL_N10
:

919 
NAL_UNIT_RESERVED_VCL_R11
:

920 
NAL_UNIT_RESERVED_VCL_N12
:

921 
NAL_UNIT_RESERVED_VCL_R13
:

922 
NAL_UNIT_RESERVED_VCL_N14
:

923 
NAL_UNIT_RESERVED_VCL_R15
:

925 
NAL_UNIT_RESERVED_IRAP_VCL22
:

926 
NAL_UNIT_RESERVED_IRAP_VCL23
:

928 
NAL_UNIT_RESERVED_VCL24
:

929 
NAL_UNIT_RESERVED_VCL25
:

930 
NAL_UNIT_RESERVED_VCL26
:

931 
NAL_UNIT_RESERVED_VCL27
:

932 
NAL_UNIT_RESERVED_VCL28
:

933 
NAL_UNIT_RESERVED_VCL29
:

934 
NAL_UNIT_RESERVED_VCL30
:

935 
NAL_UNIT_RESERVED_VCL31
:

936 
	`¥ötf
 ("Note: foundÑeserved VCL NAL unit.\n");

937 
	`xP¨£PªfixSEIsF‹UnknownVCLNÆ
();

938  
Ál£
;

940 
NAL_UNIT_RESERVED_NVCL41
:

941 
NAL_UNIT_RESERVED_NVCL42
:

942 
NAL_UNIT_RESERVED_NVCL43
:

943 
NAL_UNIT_RESERVED_NVCL44
:

944 
NAL_UNIT_RESERVED_NVCL45
:

945 
NAL_UNIT_RESERVED_NVCL46
:

946 
NAL_UNIT_RESERVED_NVCL47
:

947 
	`¥ötf
 ("Note: foundÑeserved NAL unit.\n");

948  
Ál£
;

949 
NAL_UNIT_UNSPECIFIED_48
:

950 
NAL_UNIT_UNSPECIFIED_49
:

951 
NAL_UNIT_UNSPECIFIED_50
:

952 
NAL_UNIT_UNSPECIFIED_51
:

953 
NAL_UNIT_UNSPECIFIED_52
:

954 
NAL_UNIT_UNSPECIFIED_53
:

955 
NAL_UNIT_UNSPECIFIED_54
:

956 
NAL_UNIT_UNSPECIFIED_55
:

957 
NAL_UNIT_UNSPECIFIED_56
:

958 
NAL_UNIT_UNSPECIFIED_57
:

959 
NAL_UNIT_UNSPECIFIED_58
:

960 
NAL_UNIT_UNSPECIFIED_59
:

961 
NAL_UNIT_UNSPECIFIED_60
:

962 
NAL_UNIT_UNSPECIFIED_61
:

963 
NAL_UNIT_UNSPECIFIED_62
:

964 
NAL_UNIT_UNSPECIFIED_63
:

965 
	`¥ötf
 ("Note: found unspecified NAL unit.\n");

966  
Ál£
;

968 
	`as£π
 (0);

972  
Ál£
;

973 
	}
}

981 
Boﬁ
 
	gTDecT›
::
	$isSkùPi˘uªF‹BLA
(
I¡
& 
iPOCLa°Di•œy
)

983 i‡((
m_assocüãdIRAPTy≥
 =
NAL_UNIT_CODED_SLICE_BLA_N_LP
 || m_assocüãdIRAPTy≥ =
NAL_UNIT_CODED_SLICE_BLA_W_LP
 || m_assocüãdIRAPTy≥ =
NAL_UNIT_CODED_SLICE_BLA_W_RADL
) &&

984 
m_≠cSli˚PûŸ
->
	`gëPOC
(Ë< 
m_pocCRA
 && (m_≠cSli˚PûŸ->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RASL_R
 || m_≠cSli˚PûŸ->gëNÆUnôTy≥(Ë=
NAL_UNIT_CODED_SLICE_RASL_N
))

986 
iPOCLa°Di•œy
++;

987  
åue
;

989  
Ál£
;

990 
	}
}

1005 
Boﬁ
 
	gTDecT›
::
	$isR™domAc˚ssSkùPi˘uª
(
I¡
& 
iSkùFøme
, I¡& 
iPOCLa°Di•œy
)

1007 i‡(
iSkùFøme
)

1009 
iSkùFøme
--;

1010  
åue
;

1012 i‡(
m_pocR™domAc˚ss
 =
MAX_INT
)

1014 i‡–
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA


1015 || 
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


1016 || 
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP


1017 || 
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL
 )

1020 
m_pocR™domAc˚ss
 = 
m_≠cSli˚PûŸ
->
	`gëPOC
();

1022 i‡–
m_≠cSli˚PûŸ
->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 || m_≠cSli˚PûŸ->gëNÆUnôTy≥(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP
 )

1024 
m_pocR™domAc˚ss
 = -
MAX_INT
;

1028 if(!
m_w¨nögMesßgeSkùPi˘uª
)

1030 
	`¥ötf
("\nWarning:Åhis isÇotá validÑandomáccessÖointándÅhe data is discarded untilÅhe first CRAÖicture");

1031 
m_w¨nögMesßgeSkùPi˘uª
 = 
åue
;

1033  
åue
;

1037 i‡(
m_≠cSli˚PûŸ
->
	`gëPOC
(Ë< 
m_pocR™domAc˚ss
 && (m_≠cSli˚PûŸ->
	`gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RASL_R
 || m_≠cSli˚PûŸ->gëNÆUnôTy≥(Ë=
NAL_UNIT_CODED_SLICE_RASL_N
))

1039 
iPOCLa°Di•œy
++;

1040  
åue
;

1043  
Ál£
;

1044 
	}
}

	@TLibDecoder/TDecTop.h

38 #i‚de‡
__TDECTOP__


39 
	#__TDECTOP__


	)

41 
	~"TLibComm⁄/Comm⁄Def.h
"

42 
	~"TLibComm⁄/TComLi°.h
"

43 
	~"TLibComm⁄/TComPicYuv.h
"

44 
	~"TLibComm⁄/TComPic.h
"

45 
	~"TLibComm⁄/TComTrQu™t.h
"

46 
	~"TLibComm⁄/TComPªdi˘i⁄.h
"

47 
	~"TLibComm⁄/SEI.h
"

49 
	~"TDecG›.h
"

50 
	~"TDecE¡r›y.h
"

51 
	~"TDecSbac.h
"

52 
	~"TDecCAVLC.h
"

53 
	~"SEIªad.h
"

54 
	~"TDecC⁄f‹m™˚.h
"

56 
˛ass
 
	gI≈utNALUnô
;

66 ˛as†
	cTDecT›


68 
	m¥iv©e
:

69 
I¡
 
m_iMaxRefPicNum
;

71 
NÆUnôTy≥
 
	mm_assocüãdIRAPTy≥
;

72 
I¡
 
	mm_pocCRA
;

73 
I¡
 
	mm_pocR™domAc˚ss
;

75 
	mTComLi°
<
	mTComPic
*> 
	mm_cLi°Pic
;

76 
P¨amëîSëM™agî
 
	mm_∑ømëîSëM™agî
;

77 
TComSli˚
* 
	mm_≠cSli˚PûŸ
;

79 
SEIMesßges
 
	mm_SEIs
;

82 
TComPªdi˘i⁄
 
	mm_cPªdi˘i⁄
;

83 
TComTrQu™t
 
	mm_cTrQu™t
;

84 
TDecG›
 
	mm_cG›Decodî
;

85 
TDecSli˚
 
	mm_cSli˚Decodî
;

86 
TDecCu
 
	mm_cCuDecodî
;

87 
TDecE¡r›y
 
	mm_cE¡r›yDecodî
;

88 
TDecCavlc
 
	mm_cCavlcDecodî
;

89 
TDecSbac
 
	mm_cSbacDecodî
;

90 
TDecBöCABAC
 
	mm_cBöCABAC
;

91 
SEIRódî
 
	mm_£iRódî
;

92 
TComLo›Fûãr
 
	mm_cLo›Fûãr
;

93 
TComSam∂eAd≠tiveOff£t
 
	mm_cSAO
;

94 
TDecC⁄f‹m™˚Check
 
	mm_c⁄f‹m™˚Check
;

96 
Boﬁ
 
isSkùPi˘uªF‹BLA
(
I¡
& 
iPOCLa°Di•œy
);

97 
Boﬁ
 
isR™domAc˚ssSkùPi˘uª
(
I¡
& 
iSkùFøme
, I¡& 
iPOCLa°Di•œy
);

98 
TComPic
* 
	mm_pcPic
;

99 
UI¡
 
	mm_uiSli˚Idx
;

100 
I¡
 
	mm_¥evPOC
;

101 
I¡
 
	mm_¥evTid0POC
;

102 
Boﬁ
 
	mm_bFú°Sli˚InPi˘uª
;

103 #i‡
FGS_RDD5_ENABLE


104 
Boﬁ
 
	mm_bFú°Pi˘uªInSequí˚
;

105 
SEIFûmGøöSy¡hesizî
 
	mm_gøöCh¨a˘îi°ic
;

106 
TComPicYuv
 
	mm_gøöBuf
;

108 
Boﬁ
 
	mm_bFú°Sli˚InSequí˚
;

109 
Boﬁ
 
	mm_¥evSli˚Skù≥d
;

110 
I¡
 
	mm_skù≥dPOC
;

111 
Boﬁ
 
	mm_bFú°Sli˚InBô°ªam
;

112 
I¡
 
	mm_œ°POCNoOuçutPri‹Pics
;

113 
Boﬁ
 
	mm_isNoOuçutPri‹Pics
;

114 
Boﬁ
 
	mm_¸aNoRa¶OuçutFœg
;

115 #i‡
O0043_BEST_EFFORT_DECODING


116 
UI¡
 
	mm_f‹˚DecodeBôDïth
;

118 
	m°d
::
o°ªam
 *
m_pDecodedSEIOuçutSåóm
;

120 
Boﬁ
 
	mm_w¨nögMesßgeSkùPi˘uª
;

122 #i‡
MCTS_ENC_CHECK


123 
Boﬁ
 
	mm_tm˘sCheckE«bÀd
;

126 
	m°d
::
li°
<
I≈utNALUnô
*> 
m_¥efixSEINALUs
;

127 
	mpublic
:

128 
TDecT›
();

129 
	mvútuÆ
 ~
TDecT›
();

131 
Void
 
¸óã
 ();

132 
Void
 
de°roy
 ();

134 
Void
 
	$£tDecodedPi˘uªHashSEIE«bÀd
(
I¡
 
íabÀd
Ë{ 
m_cG›Decodî
.
	`£tDecodedPi˘uªHashSEIE«bÀd
(enabled); }

135 #i‡
MCTS_ENC_CHECK


136 
Void
 
	$£tTM˘sCheckE«bÀd
(
Boﬁ
 
íabÀd
Ë{ 
m_tm˘sCheckE«bÀd
 =É«bÀd; 
	}
}

139 
Void
 
öô
();

140 #i‡
MCTS_EXTRACTION


141 
	gSEIMesßges
& 
	$gëSEIs
(Ë{  
m_SEIs
; 
	}
}

142 
TComSli˚
* 
	$gëApcSli˚PûŸ
(Ë{  
m_≠cSli˚PûŸ
; 
	}
}

143 
TComPic
* 
	$gëPcPic
(Ëc⁄° {  
m_pcPic
; 
	}
}

144 
Boﬁ
 
decode
(
I≈utNALUnô
& 
«lu
, 
I¡
& 
iSkùFøme
, I¡& 
iPOCLa°Di•œy
, Boﬁ 
bSkùCabacAndRec⁄°ru˘i⁄
=
Ál£
);

146 
Boﬁ
 
decode
(
I≈utNALUnô
& 
«lu
, 
I¡
& 
iSkùFøme
, I¡& 
iPOCLa°Di•œy
);

148 
Void
 
dñëePicBuf„r
();

151 
Void
 
execuãLo›Fûãrs
(
I¡
& 
poc
, 
TComLi°
<
TComPic
*>*& 
ΩcLi°Pic
);

152 
Void
 
checkNoOuçutPri‹Pics
 (
TComLi°
<
TComPic
*>* 
ΩcLi°Pic
);

154 
Boﬁ
 
	$gëNoOuçutPri‹PicsFœg
 (Ë{  
m_isNoOuçutPri‹Pics
; 
	}
}

155 
Void
 
	$£tNoOuçutPri‹PicsFœg
 (
Boﬁ
 
vÆ
Ë{ 
m_isNoOuçutPri‹Pics
 = vÆ; 
	}
}

156 
Void
 
	$£tFú°Sli˚InPi˘uª
 (
boﬁ
 
vÆ
Ë{ 
m_bFú°Sli˚InPi˘uª
 = vÆ; 
	}
}

157 
Boﬁ
 
	$gëFú°Sli˚InSequí˚
 (Ë{  
m_bFú°Sli˚InSequí˚
; 
	}
}

158 
Void
 
	$£tFú°Sli˚InSequí˚
 (
boﬁ
 
vÆ
Ë{ 
m_bFú°Sli˚InSequí˚
 = vÆ; 
	}
}

159 #i‡
O0043_BEST_EFFORT_DECODING


160 
Void
 
	$£tF‹˚DecodeBôDïth
(
UI¡
 
bôDïth
Ë{ 
m_f‹˚DecodeBôDïth
 = bôDïth; 
	}
}

162 
Void
 
	$£tDecodedSEIMesßgeOuçutSåóm
(
°d
::
o°ªam
 *
pOpSåóm
Ë{ 
m_pDecodedSEIOuçutSåóm
 =ÖOpSåóm; 
	}
}

163 
UI¡
 
	$gëNumbîOfChecksumEº‹sDëe˘ed
(Ëc⁄° {  
m_cG›Decodî
.
	`gëNumbîOfChecksumEº‹sDëe˘ed
(); 
	}
}

165 
	g¥Ÿe˘ed
:

166 
Void
 
xGëNewPicBuf„r
 (c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
TComPic
*& 
ΩcPic
, c⁄° 
UI¡
 
ãmp‹ÆLayî
);

167 
Void
 
xCª©eLo°Pi˘uª
 (
I¡
 
iLo°POC
);

169 #i‡
MCTS_EXTRACTION


170 
Boﬁ
 
xDecodeSli˚
(
I≈utNALUnô
 &
«lu
, 
I¡
 &
iSkùFøme
, I¡ 
iPOCLa°Di•œy
, Boﬁ 
bSkùCabacAndRec⁄°ru˘i⁄
);

171 
Void
 
xA˘iv©eP¨amëîSës
(
Boﬁ
 
bSkùCabacAndRec⁄°ru˘i⁄
);

173 
Boﬁ
 
xDecodeSli˚
(
I≈utNALUnô
 &
«lu
, 
I¡
 &
iSkùFøme
, I¡ 
iPOCLa°Di•œy
);

174 
Void
 
xA˘iv©eP¨amëîSës
();

176 
Void
 
xDecodeVPS
(c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
);

177 
Void
 
xDecodeSPS
(c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
);

178 
Void
 
xDecodePPS
(c⁄° 
°d
::
ve˘‹
<
UCh¨
> &
«luD©a
);

179 
Void
 
	$xUpd©ePªviousTid0POC
–
TComSli˚
 *
pSli˚
 ) { i‡(’Sli˚->
	`gëTLayî
()==0Ë&& (pSli˚->
	`isRe„ªn˚NÆu
(Ë&& (pSli˚->
	`gëNÆUnôTy≥
()!=
NAL_UNIT_CODED_SLICE_RASL_R
)&& (pSli˚->gëNÆUnôTy≥()!=
NAL_UNIT_CODED_SLICE_RADL_R
))Ë{ 
m_¥evTid0POC
ıSli˚->
	`gëPOC
(); } 
	}
}

180 #i‡
MCTS_EXTRACTION


181 
	gpublic
:

183 
TComLi°
<
TComPic
*>* 
	$gëRpcLi°Pic
(Ë{  &
m_cLi°Pic
; 
	}
};

184 
Void
 
xP¨£PªfixSEImesßges
();

185 #i‡
MCTS_EXTRACTION


186 
	g¥iv©e
:

188 #i‡
MCTS_ENC_CHECK


189 
Void
 
xA«ly£PªfixSEImesßges
();

191 
Void
 
xP¨£PªfixSEIsF‹UnknownVCLNÆ
();

	@TLibEncoder/AnnexBwrite.h

34 #¥agm®
⁄˚


36 #i‚de‡
__ANNEXBWRITE__


37 
	#__ANNEXBWRITE__


	)

39 
	~<o°ªam
>

40 
	~"TLibComm⁄/Ac˚ssUnô.h
"

41 
	~"NALwrôe.h
"

53 
	g°d
::
ve˘‹
<
UI¡
> 
	$wrôeA¬exB
(
°d
::
o°ªam
& 
out
, c⁄° 
Ac˚ssUnô
& 
au
)

55 
°d
::
ve˘‹
<
UI¡
> 
™√xBsizes
;

57 
Ac˚ssUnô
::
c⁄°_ôî©‹
 
ô
 = 
au
.
	`begö
(); ià!au.
	`íd
(); it++)

59 c⁄° 
NALUnôEBSP
& 
«lu
 = **
ô
;

60 
UI¡
 
size
 = 0;

62 c⁄° 
UCh¨
 
°¨t_code_¥efix
[] = {0,0,0,1};

63 i‡(
ô
 =
au
.
	`begö
(Ë|| 
«lu
.
m_«lUnôTy≥
 =
NAL_UNIT_VPS
 ||ÇÆu.m_«lUnôTy≥ =
NAL_UNIT_SPS
 ||ÇÆu.m_«lUnôTy≥ =
NAL_UNIT_PPS
)

73 
out
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(
°¨t_code_¥efix
), 4);

74 
size
 += 4;

78 
out
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(
°¨t_code_¥efix
+1), 3);

79 
size
 += 3;

81 
out
 << 
«lu
.
m_«lUnôD©a
.
	`°r
();

82 
size
 +
	`UI¡
(
«lu
.
m_«lUnôD©a
.
	`°r
().
	`size
());

84 
™√xBsizes
.
	`push_back
(
size
);

87  
™√xBsizes
;

88 
	}
}

	@TLibEncoder/NALwrite.cpp

34 
	~<ve˘‹
>

35 
	~<Æg‹ôhm
>

36 
	~<o°ªam
>

38 
	~"TLibComm⁄/NAL.h
"

39 
	~"TLibComm⁄/TComBôSåóm.h
"

40 
	~"NALwrôe.h
"

42 
usög
 
«me•a˚
 
	g°d
;

47 c⁄° 
UCh¨
 
	gemuœti⁄_¥evíti⁄_thªe_byã
[] = {3};

49 
Void
 
	$wrôeNÆUnôHódî
(
o°ªam
& 
out
, 
OuçutNALUnô
& 
«lu
)

51 
TComOuçutBô°ªam
 
bsNALUHódî
;

53 
bsNALUHódî
.
	`wrôe
(0,1);

54 
bsNALUHódî
.
	`wrôe
(
«lu
.
m_«lUnôTy≥
, 6);

55 
bsNALUHódî
.
	`wrôe
(
«lu
.
m_nuhLayîId
, 6);

56 
bsNALUHódî
.
	`wrôe
(
«lu
.
m_ãmp‹ÆId
+1, 3);

58 
out
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(
bsNALUHódî
.
	`gëByãSåóm
()), bsNALUHódî.
	`gëByãSåómLígth
());

59 
	}
}

64 
Void
 
	$wrôe
(
o°ªam
& 
out
, 
OuçutNALUnô
& 
«lu
)

66 
	`wrôeNÆUnôHódî
(
out
, 
«lu
);

87 
ve˘‹
<
uöt8_t
>& 
rb•
 = 
«lu
.
m_Bô°ªam
.
	`gëFIFO
();

89 
ve˘‹
<
uöt8_t
> 
ouçutBuf„r
;

90 
ouçutBuf„r
.
	`ªsize
(
rb•
.
	`size
()*2+1);

91 
°d
::
size_t
 
ouçutAmou¡
 = 0;

92 
I¡
 
zîoCou¡
 = 0;

93 
ve˘‹
<
uöt8_t
>::
ôî©‹
 
ô
 = 
rb•
.
	`begö
(); ià!rb•.
	`íd
(); it++)

95 c⁄° 
uöt8_t
 
v
=(*
ô
);

96 i‡(
zîoCou¡
==2 && 
v
<=3)

98 
ouçutBuf„r
[
ouçutAmou¡
++]=
emuœti⁄_¥evíti⁄_thªe_byã
[0];

99 
zîoCou¡
=0;

102 i‡(
v
==0)

104 
zîoCou¡
++;

108 
zîoCou¡
=0;

110 
ouçutBuf„r
[
ouçutAmou¡
++]=
v
;

118 i‡(
zîoCou¡
>0)

120 
ouçutBuf„r
[
ouçutAmou¡
++]=
emuœti⁄_¥evíti⁄_thªe_byã
[0];

122 
out
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(&(*
ouçutBuf„r
.
	`begö
())), 
ouçutAmou¡
);

123 
	}
}

	@TLibEncoder/NALwrite.h

34 #¥agm®
⁄˚


36 #i‚de‡
__NALWRITE__


37 
	#__NALWRITE__


	)

39 
	~<o°ªam
>

41 
	~"TLibComm⁄/Comm⁄Def.h
"

42 
	~"TLibComm⁄/TComBôSåóm.h
"

43 
	~"TLibComm⁄/NAL.h
"

52 
	gOuçutNALUnô
 : 
public
 
NALUnô


59 
OuçutNALUnô
(

60 
NÆUnôTy≥
 
«lUnôTy≥
,

61 
UI¡
 
ãmp‹ÆID
 = 0,

62 
UI¡
 
ª£rved_zîo_6bôs
 = 0)

63 : 
NALUnô
(
«lUnôTy≥
, 
ãmp‹ÆID
, 
ª£rved_zîo_6bôs
)

64 , 
m_Bô°ªam
()

67 
	gOuçutNALUnô
& 
	g›î©‹
=(c⁄° 
NALUnô
& 
§c
)

69 
m_Bô°ªam
.
˛ór
();

70 
	g°©ic_ˇ°
<
	gNALUnô
*>(
	gthis
)->
	g›î©‹
=(
§c
);

71  *
	gthis
;

74 
TComOuçutBô°ªam
 
	gm_Bô°ªam
;

77 
Void
 
wrôe
(
°d
::
o°ªam
& 
out
, 
OuçutNALUnô
& 
«lu
);

79 
ölöe
 
	gNALUnôEBSP
::
	$NALUnôEBSP
(
OuçutNALUnô
& 
«lu
)

80 : 
	$NALUnô
(
«lu
)

82 
	`wrôe
(
m_«lUnôD©a
, 
«lu
);

83 
	}
}

	@TLibEncoder/SEIEncoder.cpp

34 
	~"TLibComm⁄/Comm⁄Def.h
"

35 
	~"TLibComm⁄/SEI.h
"

36 
	~"TEncGOP.h
"

37 
	~"TEncT›.h
"

42 
Void
 
	gSEIEncodî
::
	$öôSEIA˘iveP¨amëîSës
 (
SEIA˘iveP¨amëîSës
 *
£iA˘iveP¨amëîSës
, c⁄° 
TComVPS
 *
vps
, c⁄° 
TComSPS
 *
•s
)

44 
	`as£π
 (
m_isInôülized
);

45 
	`as£π
 (
£iA˘iveP¨amëîSës
!=
NULL
);

46 
	`as£π
 (
vps
!=
NULL
);

47 
	`as£π
 (
•s
!=
NULL
);

49 
£iA˘iveP¨amëîSës
->
a˘iveVPSId
 = 
vps
->
	`gëVPSId
();

50 
£iA˘iveP¨amëîSës
->
m_£lfC⁄èöedCvsFœg
 = 
Ál£
;

51 
£iA˘iveP¨amëîSës
->
m_noP¨amëîSëUpd©eFœg
 = 
Ál£
;

52 
£iA˘iveP¨amëîSës
->
numSpsIdsMöus1
 = 0;

53 
£iA˘iveP¨amëîSës
->
a˘iveSeqP¨amëîSëId
.
	`ªsize
(£iA˘iveP¨amëîSës->
numSpsIdsMöus1
 + 1);

54 
£iA˘iveP¨amëîSës
->
a˘iveSeqP¨amëîSëId
[0] = 
•s
->
	`gëSPSId
();

55 
	}
}

57 
Void
 
	gSEIEncodî
::
	$öôSEIFømePackög
(
SEIFømePackög
 *
£iFømePackög
, 
I¡
 
cuºPicNum
)

59 
	`as£π
 (
m_isInôülized
);

60 
	`as£π
 (
£iFømePackög
!=
NULL
);

62 
£iFømePackög
->
m_¨øngemítId
 = 
m_pcCfg
->
	`gëFømePackögAº™gemítSEIId
();

63 
£iFømePackög
->
m_¨øngemítC™˚lFœg
 = 0;

64 
£iFømePackög
->
m_¨øngemítTy≥
 = 
m_pcCfg
->
	`gëFømePackögAº™gemítSEITy≥
();

65 
	`as£π
((
£iFømePackög
->
m_¨øngemítTy≥
 > 2) && (seiFramePacking->m_arrangementType < 6) );

66 
£iFømePackög
->
m_quöcunxSam∂ögFœg
 = 
m_pcCfg
->
	`gëFømePackögAº™gemítSEIQuöcunx
();

67 
£iFømePackög
->
m_c⁄ã¡I¡î¥ë©i⁄Ty≥
 = 
m_pcCfg
->
	`gëFømePackögAº™gemítSEII¡î¥ë©i⁄
();

68 
£iFømePackög
->
m_•©ülFlùpögFœg
 = 0;

69 
£iFømePackög
->
m_‰ame0Flù≥dFœg
 = 0;

70 
£iFømePackög
->
m_fõldVõwsFœg
 = (£iFømePackög->
m_¨øngemítTy≥
 == 2);

71 
£iFømePackög
->
m_cuºítFømeIsFøme0Fœg
 = ((£iFømePackög->
m_¨øngemítTy≥
 =5Ë&& (
cuºPicNum
&1) );

72 
£iFømePackög
->
m_‰ame0SñfC⁄èöedFœg
 = 0;

73 
£iFømePackög
->
m_‰ame1SñfC⁄èöedFœg
 = 0;

74 
£iFømePackög
->
m_‰ame0GridPosôi⁄X
 = 0;

75 
£iFømePackög
->
m_‰ame0GridPosôi⁄Y
 = 0;

76 
£iFømePackög
->
m_‰ame1GridPosôi⁄X
 = 0;

77 
£iFømePackög
->
m_‰ame1GridPosôi⁄Y
 = 0;

78 
£iFømePackög
->
m_¨øngemítRe£rvedByã
 = 0;

79 
£iFømePackög
->
m_¨øngemítPîsi°í˚Fœg
 = 
åue
;

80 
£iFømePackög
->
m_upßm∂edA•e˘R©io
 = 0;

81 
	}
}

83 
Void
 
	gSEIEncodî
::
	$öôSEISegmíãdRe˘FømePackög
(
SEISegmíãdRe˘FømePackög
 *
£iSegmíãdRe˘FømePackög
)

85 
	`as£π
 (
m_isInôülized
);

86 
	`as£π
 (
£iSegmíãdRe˘FømePackög
!=
NULL
);

88 
£iSegmíãdRe˘FømePackög
->
m_¨øngemítC™˚lFœg
 = 
m_pcCfg
->
	`gëSegmíãdRe˘FømePackögAº™gemítSEIC™˚l
();

89 
£iSegmíãdRe˘FømePackög
->
m_c⁄ã¡I¡î¥ë©i⁄Ty≥
 = 
m_pcCfg
->
	`gëSegmíãdRe˘FømePackögAº™gemítSEITy≥
();

90 
£iSegmíãdRe˘FømePackög
->
m_¨øngemítPîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëSegmíãdRe˘FømePackögAº™gemítSEIPîsi°í˚
();

91 
	}
}

93 
Void
 
	gSEIEncodî
::
	$öôSEIDi•œyOrõ¡©i⁄
(
SEIDi•œyOrõ¡©i⁄
* 
£iDi•œyOrõ¡©i⁄
)

95 
	`as£π
 (
m_isInôülized
);

96 
	`as£π
 (
£iDi•œyOrõ¡©i⁄
!=
NULL
);

98 
£iDi•œyOrõ¡©i⁄
->
ˇn˚lFœg
 = 
Ál£
;

99 
£iDi•œyOrõ¡©i⁄
->
h‹Flù
 = 
Ál£
;

100 
£iDi•œyOrõ¡©i⁄
->
vîFlù
 = 
Ál£
;

101 
£iDi•œyOrõ¡©i⁄
->
™ti˛ockwi£RŸ©i⁄
 = 
m_pcCfg
->
	`gëDi•œyOrõ¡©i⁄SEIAngÀ
();

102 
	}
}

104 
Void
 
	gSEIEncodî
::
	$öôSEIT⁄eM≠pögInfo
(
SEIT⁄eM≠pögInfo
 *
£iT⁄eM≠pögInfo
)

106 
	`as£π
 (
m_isInôülized
);

107 
	`as£π
 (
£iT⁄eM≠pögInfo
!=
NULL
);

109 
£iT⁄eM≠pögInfo
->
m_t⁄eM≠Id
 = 
m_pcCfg
->
	`gëTMISEIT⁄eM≠Id
();

110 
£iT⁄eM≠pögInfo
->
m_t⁄eM≠C™˚lFœg
 = 
m_pcCfg
->
	`gëTMISEIT⁄eM≠C™˚lFœg
();

111 
£iT⁄eM≠pögInfo
->
m_t⁄eM≠Pîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëTMISEIT⁄eM≠Pîsi°í˚Fœg
();

113 
£iT⁄eM≠pögInfo
->
m_codedD©aBôDïth
 = 
m_pcCfg
->
	`gëTMISEICodedD©aBôDïth
();

114 
	`as£π
(
£iT⁄eM≠pögInfo
->
m_codedD©aBôDïth
 >= 8 && seiToneMappingInfo->m_codedDataBitDepth <= 14);

115 
£iT⁄eM≠pögInfo
->
m_èrgëBôDïth
 = 
m_pcCfg
->
	`gëTMISEIT¨gëBôDïth
();

116 
	`as£π
(
£iT⁄eM≠pögInfo
->
m_èrgëBôDïth
 >= 1 && seiToneMappingInfo->m_targetBitDepth <= 17);

117 
£iT⁄eM≠pögInfo
->
m_modñId
 = 
m_pcCfg
->
	`gëTMISEIModñID
();

118 
	`as£π
(
£iT⁄eM≠pögInfo
->
m_modñId
 >=0 &&seiToneMappingInfo->m_modelId<=4);

120  
£iT⁄eM≠pögInfo
->
m_modñId
)

124 
£iT⁄eM≠pögInfo
->
m_möVÆue
 = 
m_pcCfg
->
	`gëTMISEIMöVÆue
();

125 
£iT⁄eM≠pögInfo
->
m_maxVÆue
 = 
m_pcCfg
->
	`gëTMISEIMaxVÆue
();

130 
£iT⁄eM≠pögInfo
->
m_sigmoidMidpoöt
 = 
m_pcCfg
->
	`gëTMISEISigmoidMidpoöt
();

131 
£iT⁄eM≠pögInfo
->
m_sigmoidWidth
 = 
m_pcCfg
->
	`gëTMISEISigmoidWidth
();

136 
UI¡
 
num
 = 1u<<(
£iT⁄eM≠pögInfo
->
m_èrgëBôDïth
);

137 
£iT⁄eM≠pögInfo
->
m_°¨tOfCodedI¡îvÆ
.
	`ªsize
(
num
);

138 
I¡
* 
±mp
 = 
m_pcCfg
->
	`gëTMISEISèπOfCodedI¡îva
();

139 if(
±mp
)

141 
I¡
 
i
=0; i<
num
;i++)

143 
£iT⁄eM≠pögInfo
->
m_°¨tOfCodedI¡îvÆ
[
i
] = 
±mp
[i];

150 
£iT⁄eM≠pögInfo
->
m_numPivŸs
 = 
m_pcCfg
->
	`gëTMISEINumPivŸs
();

151 
£iT⁄eM≠pögInfo
->
m_codedPivŸVÆue
.
	`ªsize
(£iT⁄eM≠pögInfo->
m_numPivŸs
);

152 
£iT⁄eM≠pögInfo
->
m_èrgëPivŸVÆue
.
	`ªsize
(£iT⁄eM≠pögInfo->
m_numPivŸs
);

153 
I¡
* 
±mpcoded
 = 
m_pcCfg
->
	`gëTMISEICodedPivŸVÆue
();

154 
I¡
* 
±m±¨gë
 = 
m_pcCfg
->
	`gëTMISEIT¨gëPivŸVÆue
();

155 if(
±mpcoded
&&
±m±¨gë
)

157 
I¡
 
i
=0; i<(
£iT⁄eM≠pögInfo
->
m_numPivŸs
);i++)

159 
£iT⁄eM≠pögInfo
->
m_codedPivŸVÆue
[
i
]=
±mpcoded
[i];

160 
£iT⁄eM≠pögInfo
->
m_èrgëPivŸVÆue
[
i
]=
±m±¨gë
[i];

167 
£iT⁄eM≠pögInfo
->
m_ˇmîaIsoS≥edIdc
 = 
m_pcCfg
->
	`gëTMISEICamîaIsoS≥edIdc
();

168 
£iT⁄eM≠pögInfo
->
m_ˇmîaIsoS≥edVÆue
 = 
m_pcCfg
->
	`gëTMISEICamîaIsoS≥edVÆue
();

169 
	`as£π
–
£iT⁄eM≠pögInfo
->
m_ˇmîaIsoS≥edVÆue
 !=0 );

170 
£iT⁄eM≠pögInfo
->
m_exposuªIndexIdc
 = 
m_pcCfg
->
	`gëTMISEIExposurIndexIdc
();

171 
£iT⁄eM≠pögInfo
->
m_exposuªIndexVÆue
 = 
m_pcCfg
->
	`gëTMISEIExposurIndexVÆue
();

172 
	`as£π
–
£iT⁄eM≠pögInfo
->
m_exposuªIndexVÆue
 !=0 );

173 
£iT⁄eM≠pögInfo
->
m_exposuªCom≥nßti⁄VÆueSignFœg
 = 
m_pcCfg
->
	`gëTMISEIExposuªCom≥nßti⁄VÆueSignFœg
();

174 
£iT⁄eM≠pögInfo
->
m_exposuªCom≥nßti⁄VÆueNumî©‹
 = 
m_pcCfg
->
	`gëTMISEIExposuªCom≥nßti⁄VÆueNumî©‹
();

175 
£iT⁄eM≠pögInfo
->
m_exposuªCom≥nßti⁄VÆueDíomIdc
 = 
m_pcCfg
->
	`gëTMISEIExposuªCom≥nßti⁄VÆueDíomIdc
();

176 
£iT⁄eM≠pögInfo
->
m_ªfS¸ìnLumö™˚Whôe
 = 
m_pcCfg
->
	`gëTMISEIRefS¸ìnLumö™˚Whôe
();

177 
£iT⁄eM≠pögInfo
->
m_exãndedR™geWhôeLevñ
 = 
m_pcCfg
->
	`gëTMISEIExãndedR™geWhôeLevñ
();

178 
	`as£π
–
£iT⁄eM≠pögInfo
->
m_exãndedR™geWhôeLevñ
 >= 100 );

179 
£iT⁄eM≠pögInfo
->
m_nomöÆBœckLevñLumaCodeVÆue
 = 
m_pcCfg
->
	`gëTMISEINomöÆBœckLevñLumaCodeVÆue
();

180 
£iT⁄eM≠pögInfo
->
m_nomöÆWhôeLevñLumaCodeVÆue
 = 
m_pcCfg
->
	`gëTMISEINomöÆWhôeLevñLumaCodeVÆue
();

181 
	`as£π
–
£iT⁄eM≠pögInfo
->
m_nomöÆWhôeLevñLumaCodeVÆue
 > seiT⁄eM≠pögInfo->
m_nomöÆBœckLevñLumaCodeVÆue
 );

182 
£iT⁄eM≠pögInfo
->
m_exãndedWhôeLevñLumaCodeVÆue
 = 
m_pcCfg
->
	`gëTMISEIExãndedWhôeLevñLumaCodeVÆue
();

183 
	`as£π
–
£iT⁄eM≠pögInfo
->
m_exãndedWhôeLevñLumaCodeVÆue
 >£iT⁄eM≠pögInfo->
m_nomöÆWhôeLevñLumaCodeVÆue
 );

188 
	`as£π
(!"Undefined SEIToneMapModelId");

192 
	}
}

194 
Void
 
	gSEIEncodî
::
	$öôSEISOPDes¸ùti⁄
(
SEISOPDes¸ùti⁄
 *
s›Des¸ùti⁄SEI
, 
TComSli˚
 *
¶i˚
, 
I¡
 
picInGOP
, I¡ 
œ°Idr
, I¡ 
cuºGOPSize
)

196 
	`as£π
 (
m_isInôülized
);

197 
	`as£π
 (
s›Des¸ùti⁄SEI
 !
NULL
);

198 
	`as£π
 (
¶i˚
 !
NULL
);

200 
I¡
 
s›CuºPOC
 = 
¶i˚
->
	`gëPOC
();

201 
s›Des¸ùti⁄SEI
->
m_s›SeqP¨amëîSëId
 = 
¶i˚
->
	`gëSPS
()->
	`gëSPSId
();

203 
I¡
 
i
 = 0;

204 
I¡
 
¥evE¡ryId
 = 
picInGOP
;

205 
I¡
 
j
 = 
picInGOP
; j < 
cuºGOPSize
; j++)

207 
I¡
 
dñèPOC
 = 
m_pcCfg
->
	`gëGOPE¡ry
(
j
).
m_POC
 - m_pcCfg->gëGOPE¡ry(
¥evE¡ryId
).m_POC;

208 i‡((
s›CuºPOC
 + 
dñèPOC
Ë< 
m_pcCfg
->
	`gëFømesToBeEncoded
())

210 
s›CuºPOC
 +
dñèPOC
;

211 
s›Des¸ùti⁄SEI
->
m_s›DescV˛NÆuTy≥
[
i
] = 
m_pcEncGOP
->
	`gëNÆUnôTy≥
(
s›CuºPOC
, 
œ°Idr
, 
¶i˚
->
	`gëPic
()->
	`isFõld
());

212 
s›Des¸ùti⁄SEI
->
m_s›DescTemp‹ÆId
[
i
] = 
m_pcCfg
->
	`gëGOPE¡ry
(
j
).
m_ãmp‹ÆId
;

213 
s›Des¸ùti⁄SEI
->
m_s›DescStRpsIdx
[
i
] = 
m_pcEncT›
->
	`gëRe„ªn˚Pi˘uªSëIdxF‹SOP
(
s›CuºPOC
, 
j
);

214 
s›Des¸ùti⁄SEI
->
m_s›DescPocDñè
[
i
] = 
dñèPOC
;

216 
¥evE¡ryId
 = 
j
;

217 
i
++;

221 
s›Des¸ùti⁄SEI
->
m_numPicsInS›Möus1
 = 
i
 - 1;

222 
	}
}

224 
Void
 
	gSEIEncodî
::
	$öôSEIBuf„rögPîiod
(
SEIBuf„rögPîiod
 *
buf„rögPîiodSEI
, 
TComSli˚
 *
¶i˚
)

226 
	`as£π
 (
m_isInôülized
);

227 
	`as£π
 (
buf„rögPîiodSEI
 !
NULL
);

228 
	`as£π
 (
¶i˚
 !
NULL
);

230 
UI¡
 
uiInôülCpbRemovÆDñay
 = (90000/2);

231 
buf„rögPîiodSEI
->
m_öôülCpbRemovÆDñay
 [0][0] = 
uiInôülCpbRemovÆDñay
;

232 
buf„rögPîiodSEI
->
m_öôülCpbRemovÆDñayOff£t
[0][0] = 
uiInôülCpbRemovÆDñay
;

233 
buf„rögPîiodSEI
->
m_öôülCpbRemovÆDñay
 [0][1] = 
uiInôülCpbRemovÆDñay
;

234 
buf„rögPîiodSEI
->
m_öôülCpbRemovÆDñayOff£t
[0][1] = 
uiInôülCpbRemovÆDñay
;

236 
DoubÀ
 
dTmp
 = (DoubÀ)
¶i˚
->
	`gëSPS
()->
	`gëVuiP¨amëîs
()->
	`gëTimögInfo
()->
	`gëNumUnôsInTick
(Ë/ (DoubÀ)¶i˚->gëSPS()->gëVuiP¨amëîs()->gëTimögInfo()->
	`gëTimeSˇÀ
();

238 
UI¡
 
uiTmp
 = (UI¡)–
dTmp
 * 90000.0 );

239 
uiInôülCpbRemovÆDñay
 -
uiTmp
;

240 
uiInôülCpbRemovÆDñay
 -
uiTmp
 / ( 
¶i˚
->
	`gëSPS
()->
	`gëVuiP¨amëîs
()->
	`gëHrdP¨amëîs
()->
	`gëTickDivis‹Möus2
() + 2 );

241 
buf„rögPîiodSEI
->
m_öôülA…CpbRemovÆDñay
 [0][0] = 
uiInôülCpbRemovÆDñay
;

242 
buf„rögPîiodSEI
->
m_öôülA…CpbRemovÆDñayOff£t
[0][0] = 
uiInôülCpbRemovÆDñay
;

243 
buf„rögPîiodSEI
->
m_öôülA…CpbRemovÆDñay
 [0][1] = 
uiInôülCpbRemovÆDñay
;

244 
buf„rögPîiodSEI
->
m_öôülA…CpbRemovÆDñayOff£t
[0][1] = 
uiInôülCpbRemovÆDñay
;

246 
buf„rögPîiodSEI
->
m_øpCpbP¨amsPª£¡Fœg
 = 0;

248 
buf„rögPîiodSEI
->
m_c⁄ˇã«ti⁄Fœg
 = 0;

250 
buf„rögPîiodSEI
->
m_auCpbRemovÆDñayDñè
 = 1;

251 
buf„rögPîiodSEI
->
m_˝bDñayOff£t
 = 0;

252 
buf„rögPîiodSEI
->
m_dpbDñayOff£t
 = 0;

253 
	}
}

258 
Void
 
	gSEIEncodî
::
	$öôSEISˇœbÀNe°ög
(
SEISˇœbÀNe°ög
 *
sˇœbÀNe°ögSEI
, 
SEIMesßges
 &
√°edSEIs
)

260 
	`as£π
 (
m_isInôülized
);

261 
	`as£π
 (
sˇœbÀNe°ögSEI
 !
NULL
);

263 
sˇœbÀNe°ögSEI
->
m_bôSåómSub£tFœg
 = 1;

264 
sˇœbÀNe°ögSEI
->
m_√°ögOpFœg
 = 0;

265 
sˇœbÀNe°ögSEI
->
m_√°ögNumOpsMöus1
 = 0;

266 
sˇœbÀNe°ögSEI
->
m_ÆlLayîsFœg
 = 0;

267 
sˇœbÀNe°ögSEI
->
m_√°ögNoOpMaxTemp‹ÆIdPlus1
 = 6 + 1;

268 
sˇœbÀNe°ögSEI
->
m_√°ögNumLayîsMöus1
 = 1 - 1;

269 
sˇœbÀNe°ögSEI
->
m_√°ögLayîId
[0] = 0;

271 
sˇœbÀNe°ögSEI
->
m_√°edSEIs
.
	`˛ór
();

272 
SEIMesßges
::
ôî©‹
 
ô
=
√°edSEIs
.
	`begö
(); it!Úe°edSEIs.
	`íd
(); it++)

274 
sˇœbÀNe°ögSEI
->
m_√°edSEIs
.
	`push_back
((*
ô
));

276 
	}
}

278 
Void
 
	gSEIEncodî
::
	$öôSEIRecovîyPoöt
(
SEIRecovîyPoöt
 *
ªcovîyPoötSEI
, 
TComSli˚
 *
¶i˚
)

280 
	`as£π
 (
m_isInôülized
);

281 
	`as£π
 (
ªcovîyPoötSEI
 !
NULL
);

282 
	`as£π
 (
¶i˚
 !
NULL
);

284 
ªcovîyPoötSEI
->
m_ªcovîyPocC¡
 = 0;

285 
ªcovîyPoötSEI
->
m_exa˘M©chögFœg
 = ( 
¶i˚
->
	`gëPOC
(Ë=0 ) ? (
åue
Ë: (
Ál£
);

286 
ªcovîyPoötSEI
->
m_brokíLökFœg
 = 
Ál£
;

287 
	}
}

290 
Void
 
	gSEIEncodî
::
	$öôDecodedPi˘uªHashSEI
(
SEIDecodedPi˘uªHash
 *
decodedPi˘uªHashSEI
, 
TComPic
 *
pcPic
, 
°d
::
°rög
 &
rHashSåög
, c⁄° 
BôDïths
 &
bôDïths
)

292 
	`as£π
 (
m_isInôülized
);

293 
	`as£π
 (
decodedPi˘uªHashSEI
!=
NULL
);

294 
	`as£π
 (
pcPic
!=
NULL
);

296 
decodedPi˘uªHashSEI
->
mëhod
 = 
m_pcCfg
->
	`gëDecodedPi˘uªHashSEITy≥
();

297 
m_pcCfg
->
	`gëDecodedPi˘uªHashSEITy≥
())

299 
HASHTYPE_MD5
:

301 
UI¡
 
numCh¨
=
	`ˇlcMD5
(*
pcPic
->
	`gëPicYuvRec
(), 
decodedPi˘uªHashSEI
->
m_pi˘uªHash
, 
bôDïths
);

302 
rHashSåög
 = 
	`hashToSåög
(
decodedPi˘uªHashSEI
->
m_pi˘uªHash
, 
numCh¨
);

305 
HASHTYPE_CRC
:

307 
UI¡
 
numCh¨
=
	`ˇlcCRC
(*
pcPic
->
	`gëPicYuvRec
(), 
decodedPi˘uªHashSEI
->
m_pi˘uªHash
, 
bôDïths
);

308 
rHashSåög
 = 
	`hashToSåög
(
decodedPi˘uªHashSEI
->
m_pi˘uªHash
, 
numCh¨
);

311 
HASHTYPE_CHECKSUM
:

314 
UI¡
 
numCh¨
=
	`ˇlcChecksum
(*
pcPic
->
	`gëPicYuvRec
(), 
decodedPi˘uªHashSEI
->
m_pi˘uªHash
, 
bôDïths
);

315 
rHashSåög
 = 
	`hashToSåög
(
decodedPi˘uªHashSEI
->
m_pi˘uªHash
, 
numCh¨
);

319 
	}
}

321 
Void
 
	gSEIEncodî
::
	$öôTemp‹ÆLevñ0IndexSEI
(
SEITemp‹ÆLevñ0Index
 *
ãmp‹ÆLevñ0IndexSEI
, 
TComSli˚
 *
¶i˚
)

323 
	`as£π
 (
m_isInôülized
);

324 
	`as£π
 (
ãmp‹ÆLevñ0IndexSEI
!=
NULL
);

325 
	`as£π
 (
¶i˚
!=
NULL
);

327 i‡(
¶i˚
->
	`gëR≠PicFœg
())

329 
m_é0Idx
 = 0;

330 
m_øpIdx
 = (m_rapIdx + 1) & 0xFF;

334 
m_é0Idx
 = (m_é0Idx + (
¶i˚
->
	`gëTLayî
() ? 0 : 1)) & 0xFF;

336 
ãmp‹ÆLevñ0IndexSEI
->
é0Idx
 = 
m_é0Idx
;

337 
ãmp‹ÆLevñ0IndexSEI
->
øpIdx
 = 
m_øpIdx
;

338 
	}
}

340 
Void
 
	gSEIEncodî
::
	$öôSEITempMŸi⁄C⁄°øöedTûeSës
 (
SEITempMŸi⁄C⁄°øöedTûeSës
 *
£i
, c⁄° 
TComPPS
 *
µs
)

342 
	`as£π
 (
m_isInôülized
);

343 
	`as£π
 (
£i
!=
NULL
);

344 
	`as£π
 (
µs
!=
NULL
);

346 if(
µs
->
	`gëTûesE«bÀdFœg
())

348 #i‡
MCTS_ENC_CHECK


349 i‡(
m_pcCfg
->
	`gëTMCTSSEITûeC⁄°øöt
())

351 
£i
->
m_mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag
 = 
åue
;

352 
£i
->
m_óch_tûe_⁄e_tûe_£t_Êag
 = 
åue
;

353 
£i
->
m_limôed_tûe_£t_di•œy_Êag
 = 
Ál£
;

354 
£i
->
m_max_mcs_tõr_Àvñ_idc_¥e£¡_Êag
 = 
Ál£
;

355 
£i
->
	`£tNumbîOfTûeSës
(0);

360 
£i
->
m_mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag
 = 
Ál£
;

361 
£i
->
m_óch_tûe_⁄e_tûe_£t_Êag
 = 
Ál£
;

362 
£i
->
m_limôed_tûe_£t_di•œy_Êag
 = 
Ál£
;

363 
£i
->
	`£tNumbîOfTûeSës
((
µs
->
	`gëNumTûeCﬁumnsMöus1
(Ë+ 1Ë* (µs->
	`gëNumTûeRowsMöus1
() + 1));

365 
I¡
 
i
=0; i < 
£i
->
	`gëNumbîOfTûeSës
(); i++)

367 
£i
->
	`tûeSëD©a
(
i
).
m_m˘s_id
 = i;

368 
£i
->
	`tûeSëD©a
(
i
).
	`£tNumbîOfTûeRe˘s
(1);

370 
I¡
 
j
=0; j<
£i
->
	`tûeSëD©a
(
i
).
	`gëNumbîOfTûeRe˘s
(); j++)

372 
£i
->
	`tûeSëD©a
(
i
).
	`t›Le·TûeIndex
(
j
) = i+j;

373 
£i
->
	`tûeSëD©a
(
i
).
	`bŸtomRightTûeIndex
(
j
) = i+j;

376 
£i
->
	`tûeSëD©a
(
i
).
m_exa˘_ßm∂e_vÆue_m©ch_Êag
 = 
Ál£
;

377 
£i
->
	`tûeSëD©a
(
i
).
m_m˘s_tõr_Àvñ_idc_¥e£¡_Êag
 = 
Ál£
;

379 #i‡
MCTS_ENC_CHECK


385 
	`as£π
(!"Tile isÇotÉnabled");

387 
	}
}

389 #i‡
MCTS_EXTRACTION
 && 
MCTS_ENC_CHECK


390 
Void
 
	gSEIEncodî
::
	$öôSEIMCTSExåa˘i⁄Info
(
SEIMCTSExåa˘i⁄InfoSë
 *
£i
, c⁄° 
TComVPS
 *
vps
, c⁄° 
TComSPS
 *
•s
, c⁄° 
TComPPS
 *
µs
)

392 
	`as£π
(
m_isInôülized
);

393 
	`as£π
(
£i
 !
NULL
);

394 
	`as£π
(
vps
 !
NULL
);

395 
	`as£π
(
•s
 !
NULL
);

396 
	`as£π
(
µs
 !
NULL
);

398 
TComVPS
 
√°edVPS
 = *
vps
;

399 
TComSPS
 
√°edSPS
 = *
•s
;

400 
TComPPS
 
√°edPPS
 = *
µs
;

402 i‡(
µs
->
	`gëTûesE«bÀdFœg
())

404 i‡(
m_pcCfg
->
	`gëTMCTSSEITûeC⁄°øöt
())

406 
UI¡
 
numTûes
 = (
µs
->
	`gëNumTûeCﬁumnsMöus1
(Ë+ 1Ë* (µs->
	`gëNumTûeRowsMöus1
() + 1);

407 
UI¡
 
bŸtomTûeRowHeightSam∂eOff£t
 = ( 
•s
->
	`gëPicHeightInLumaSam∂es
(Ë% sps->
	`gëMaxCUHeight
() ) ? sps->getMaxCUHeight() - (sps->getPicHeightInLumaSamples() % sps->getMaxCUHeight()) : 0;

408 
UI¡
 
rightmo°TûeCﬁumnWidthSam∂eOff£t
 = ( 
•s
->
	`gëPicWidthInLumaSam∂es
(Ë% sps->
	`gëMaxCUWidth
() ) ? sps->getMaxCUWidth() - (sps->getPicWidthInLumaSamples() % sps->getMaxCUWidth()) : 0;

409 
TComPicSym
 *
picSym
 = (*(
m_pcEncT›
->
	`gëLi°Pic
()->
	`begö
()))->
	`gëPicSym
();

412  
UI¡
 
m˘sIdx
 = 0; m˘sIdx < 
numTûes
; mctsIdx++)

414 
boﬁ
 
suôabÀEISfound
 = 
Ál£
;

415 
boﬁ
 
isRightmo°TûeCﬁumn
 = (
m˘sIdx
 + 1Ë% (
picSym
->
	`gëNumTûeCﬁumnsMöus1
() + 1) == 0 ;

416 
boﬁ
 
isBŸtomTûeRow
 = 
m˘sIdx
 / (
picSym
->
	`gëNumTûeCﬁumnsMöus1
(Ë+ 1Ë=picSym->
	`gëNumTûeRowsMöus1
();

417 
UI¡
 
curM˘sHeight
 = 
picSym
->
	`gëTComTûe
(
m˘sIdx
)->
	`gëTûeHeightInCtus
(Ë* 
•s
->
	`gëMaxCUHeight
(Ë- (
isBŸtomTûeRow
 ? 
bŸtomTûeRowHeightSam∂eOff£t
 : 0);

418 
UI¡
 
curM˘sWidth
 = 
picSym
->
	`gëTComTûe
(
m˘sIdx
)->
	`gëTûeWidthInCtus
(Ë* 
•s
->
	`gëMaxCUWidth
(Ë- (
isRightmo°TûeCﬁumn
 ? 
rightmo°TûeCﬁumnWidthSam∂eOff£t
 : 0);

420 
°d
::
ve˘‹
< 
SEIMCTSExåa˘i⁄InfoSë
::
MCTSExåa˘i⁄Info
>::
ôî©‹
 
EISôî
 = 
£i
->
m_MCTSExåa˘i⁄InfoSës
.
	`begö
(); EISôî !£i->m_MCTSExåa˘i⁄InfoSës.
	`íd
(Ë&& !
suôabÀEISfound
; EISiter++)

422 i‡––
EISôî
->
m˘sHeight
 =
curM˘sHeight
Ë&& ( EISôî->
m˘sWidth
 =
curM˘sWidth
) )

424 
EISôî
->
m_idxOfM˘sInSë
.
	`push_back
(
°d
::
ve˘‹
<
UI¡
>(1, 
m˘sIdx
 ));

425 
suôabÀEISfound
 = 
åue
;

428 i‡(!
suôabÀEISfound
)

430 
SEIMCTSExåa˘i⁄InfoSë
::
MCTSExåa˘i⁄Info
 
√wEIS
;

431 
√wEIS
.
m˘sHeight
 = 
curM˘sHeight
;

432 
√wEIS
.
m˘sWidth
 = 
curM˘sWidth
;

433 
√wEIS
.
m_idxOfM˘sInSë
.
	`push_back
(
°d
::
ve˘‹
<
UI¡
>(1, 
m˘sIdx
));

434 
£i
->
m_MCTSExåa˘i⁄InfoSës
.
	`push_back
(
√wEIS
);

439 
°d
::
ve˘‹
<
SEIMCTSExåa˘i⁄InfoSë
::
MCTSExåa˘i⁄Info
>::
ôî©‹
 
EISôî
 = 
£i
->
m_MCTSExåa˘i⁄InfoSës
.
	`begö
(); EISôî !£i->m_MCTSExåa˘i⁄InfoSës.
	`íd
(); EISiter++)

441 
EISôî
->
m_¶i˚Re‹dîögE«bÀdFœg
 = 
Ál£
;

443 
TComOuçutBô°ªam
 
vps_rb•
;

444 
TComOuçutBô°ªam
 
•s_rb•
;

445 
TComOuçutBô°ªam
 
µs_rb•
;

447 
√°edSPS
.
	`£tPicHeightInLumaSam∂es
(
EISôî
->
m˘sHeight
);

448 
√°edSPS
.
	`£tPicWidthInLumaSam∂es
(
EISôî
->
m˘sWidth
);

449 
√°edPPS
.
	`£tTûesE«bÀdFœg
(
Ál£
);

451 
m_pcEncGOP
->
	`gíî©eVPS_RBSP
(&
vps_rb•
, &
√°edVPS
);

452 
m_pcEncGOP
->
	`gíî©eSPS_RBSP
(&
•s_rb•
, &
√°edSPS
);

453 
m_pcEncGOP
->
	`gíî©ePPS_RBSP
(&
µs_rb•
, &
√°edPPS
);

455 
EISôî
->
m_vpsRb•D©a
.
	`ªsize
(1);

456 
j
 = 0; j < 
EISôî
->
m_vpsRb•D©a
.
	`size
(); j++)

458 
EISôî
->
m_vpsRb•D©aLígth
.
	`push_back
(
vps_rb•
.
	`gëByãSåómLígth
());

459 
EISôî
->
m_vpsRb•D©a
[
j
] = 
vps_rb•
.
	`gëFIFO
();

462 
EISôî
->
m_•sRb•D©a
.
	`ªsize
(1);

463 
j
 = 0; j < 
EISôî
->
m_•sRb•D©a
.
	`size
(); j++)

465 
EISôî
->
m_•sRb•D©aLígth
.
	`push_back
(
•s_rb•
.
	`gëByãSåómLígth
());

466 
EISôî
->
m_•sRb•D©a
[
j
] = 
•s_rb•
.
	`gëFIFO
();

468 
EISôî
->
m_µsRb•D©a
.
	`ªsize
(1);

469 
EISôî
->
m_µsNuhTemp‹ÆIdPlus1
.
	`ªsize
(1);

470 
j
 = 0; j < 
EISôî
->
m_µsRb•D©a
.
	`size
(); j++)

472 
EISôî
->
m_µsRb•D©aLígth
.
	`push_back
(
µs_rb•
.
	`gëByãSåómLígth
());

473 
EISôî
->
m_µsRb•D©a
[
j
] = 
µs_rb•
.
	`gëFIFO
();

474 
EISôî
->
m_µsNuhTemp‹ÆIdPlus1
[
j
] = 1;

480 
	`as£π
(!"MCTSÇotáctivated");

485 
	`as£π
(!"Tiles isÇotÉnabled");

487 
	}
}

491 
Void
 
	gSEIEncodî
::
	$öôSEIK√eFun˘i⁄Info
(
SEIK√eFun˘i⁄Info
 *
£iK√eFun˘i⁄Info
)

493 
	`as£π
 (
m_isInôülized
);

494 
	`as£π
 (
£iK√eFun˘i⁄Info
!=
NULL
);

496 c⁄° 
TEncCfg
::
TEncSEIK√eFun˘i⁄Inf‹m©i⁄
 &
k√e
=
m_pcCfg
->
	`gëK√eFun˘i⁄Inf‹m©i⁄SEI
();

497 
£iK√eFun˘i⁄Info
->
m_k√eId
 = 
k√e
.
m_k√eFun˘i⁄Id
;

498 
£iK√eFun˘i⁄Info
->
m_k√eC™˚lFœg
 = 
k√e
.
m_k√eFun˘i⁄C™˚lFœg
;

499 i‡–!
£iK√eFun˘i⁄Info
->
m_k√eC™˚lFœg
 )

501 
£iK√eFun˘i⁄Info
->
m_k√ePîsi°í˚Fœg
 = 
k√e
.
m_k√eFun˘i⁄Pîsi°í˚Fœg
;

502 
£iK√eFun˘i⁄Info
->
m_k√eI≈utDønge
 = 
k√e
.
m_öputDR™ge
;

503 
£iK√eFun˘i⁄Info
->
m_k√eI≈utDi•Lumö™˚
 = 
k√e
.
m_öputDi•Lumö™˚
;

504 
£iK√eFun˘i⁄Info
->
m_k√eOuçutDønge
 = 
k√e
.
m_ouçutDR™ge
;

505 
£iK√eFun˘i⁄Info
->
m_k√eOuçutDi•Lumö™˚
 = 
k√e
.
m_ouçutDi•Lumö™˚
;

507 
	`as£π
(
k√e
.
m_k√eSEIK√ePoötPaús
.
	`size
()>0);

508 
£iK√eFun˘i⁄Info
->
m_k√eNumK√ePoötsMöus1
 = (
I¡
Ë
k√e
.
m_k√eSEIK√ePoötPaús
.
	`size
()-1;

509 
£iK√eFun˘i⁄Info
->
m_k√eI≈utK√ePoöt
.
	`ªsize
(£iK√eFun˘i⁄Info->
m_k√eNumK√ePoötsMöus1
+1);

510 
£iK√eFun˘i⁄Info
->
m_k√eOuçutK√ePoöt
.
	`ªsize
(£iK√eFun˘i⁄Info->
m_k√eNumK√ePoötsMöus1
+1);

511 
I¡
 
i
=0; i<=
£iK√eFun˘i⁄Info
->
m_k√eNumK√ePoötsMöus1
; i++)

513 
£iK√eFun˘i⁄Info
->
m_k√eI≈utK√ePoöt
[
i
] = 
k√e
.
m_k√eSEIK√ePoötPaús
[i].
öputK√ePoöt
;

514 
£iK√eFun˘i⁄Info
->
m_k√eOuçutK√ePoöt
[
i
] = 
k√e
.
m_k√eSEIK√ePoötPaús
[i].
ouçutK√ePoöt
;

517 
	}
}

518 
Void
 
	gSEIEncodî
::
	$öôSEIC⁄ã¡CﬁourVﬁume
(
SEIC⁄ã¡CﬁourVﬁume
 *
£iC⁄ã¡CﬁourVﬁume
)

520 
	`as£π
(
m_isInôülized
);

521 
	`as£π
(
£iC⁄ã¡CﬁourVﬁume
 !
NULL
);

522 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvC™˚lFœg
 = 
m_pcCfg
->
	`gëCcvSEIC™˚lFœg
();

523 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëCcvSEIPîsi°í˚Fœg
();

525 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsPª£¡Fœg
 = 
m_pcCfg
->
	`gëCcvSEIPrim¨õsPª£¡Fœg
();

526 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMöLumö™˚VÆuePª£¡Fœg
 = 
m_pcCfg
->
	`gëCcvSEIMöLumö™˚VÆuePª£¡Fœg
();

527 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMaxLumö™˚VÆuePª£¡Fœg
 = 
m_pcCfg
->
	`gëCcvSEIMaxLumö™˚VÆuePª£¡Fœg
();

528 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvAvgLumö™˚VÆuePª£¡Fœg
 = 
m_pcCfg
->
	`gëCcvSEIAvgLumö™˚VÆuePª£¡Fœg
();

532 i‡(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsPª£¡Fœg
 =
åue
)

534 
I¡
 
i
 = 0; i < 
MAX_NUM_COMPONENT
; i++)

536 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsX
[
i
] = (
I¡
Ë(50000.0 * 
m_pcCfg
->
	`gëCcvSEIPrim¨õsX
(i));

537 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsY
[
i
] = (
I¡
Ë(50000.0 * 
m_pcCfg
->
	`gëCcvSEIPrim¨õsY
(i));

541 i‡(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMöLumö™˚VÆuePª£¡Fœg
 =
åue
)

543 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMöLumö™˚VÆue
 = (
I¡
Ë(10000000 * 
m_pcCfg
->
	`gëCcvSEIMöLumö™˚VÆue
());

545 i‡(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMaxLumö™˚VÆuePª£¡Fœg
 =
åue
)

547 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMaxLumö™˚VÆue
 = (
I¡
Ë(10000000 * 
m_pcCfg
->
	`gëCcvSEIMaxLumö™˚VÆue
());

549 i‡(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvAvgLumö™˚VÆuePª£¡Fœg
 =
åue
)

551 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvAvgLumö™˚VÆue
 = (
I¡
Ë(10000000 * 
m_pcCfg
->
	`gëCcvSEIAvgLumö™˚VÆue
());

553 
	}
}

555 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


556 
Void
 
	gSEIEncodî
::
	$öôSEIShuâîI¡îvÆInfo
(
SEIShuâîI¡îvÆInfo
 *
£iShuâîI¡îvÆInfo
)

558 
	`as£π
(
m_isInôülized
);

559 
	`as£π
(
£iShuâîI¡îvÆInfo
 !
NULL
);

560 
£iShuâîI¡îvÆInfo
->
m_siiTimeSˇÀ
 = 
m_pcCfg
->
	`gëSiiSEITimeSˇÀ
();

561 
£iShuâîI¡îvÆInfo
->
m_siiFixedSIwôhöCLVS
 = 
m_pcCfg
->
	`gëSiiSEIFixedSIwôhöCLVS
();

562 i‡(
£iShuâîI¡îvÆInfo
->
m_siiFixedSIwôhöCLVS
 =
åue
)

564 
£iShuâîI¡îvÆInfo
->
m_siiNumUnôsInShuâîI¡îvÆ
 = 
m_pcCfg
->
	`gëSiiSEINumUnôsInShuâîI¡îvÆ
();

568 
£iShuâîI¡îvÆInfo
->
m_siiMaxSubLayîsMöus1
 = 
m_pcCfg
->
	`gëSiiSEIMaxSubLayîsMöus1
();

569 
£iShuâîI¡îvÆInfo
->
m_siiSubLayîNumUnôsInSI
.
	`ªsize
(£iShuâîI¡îvÆInfo->
m_siiMaxSubLayîsMöus1
+1);

570 
I¡
 
i
 = 0; i <
£iShuâîI¡îvÆInfo
->
m_siiMaxSubLayîsMöus1
; i++)

572 
£iShuâîI¡îvÆInfo
->
m_siiSubLayîNumUnôsInSI
[
i
] = 
m_pcCfg
->
	`gëSiiSEISubLayîNumUnôsInSI
(i);

575 
	}
}

578 #i‡
SEI_ENCODER_CONTROL


579 
Void
 
	gSEIEncodî
::
	$öôSEIFûmGøöCh¨a˘îi°ics
(
SEIFûmGøöCh¨a˘îi°ics
 *
£iFûmGøö
)

581 
	`as£π
(
m_isInôülized
);

582 
	`as£π
(
£iFûmGøö
 !
NULL
);

584 
£iFûmGøö
->
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
 = 
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEIC™˚lFœg
();

585 
£iFûmGøö
->
m_fûmGøöCh¨a˘îi°icsPîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEIPîsi°í˚Fœg
();

586 
£iFûmGøö
->
m_fûmGøöModñId
 = 
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEIModñID
();

587 
£iFûmGøö
->
m_£∑øãCﬁourDes¸ùti⁄Pª£¡Fœg
 = 
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEISïCﬁourDescPª£¡
();

588 
£iFûmGøö
->
m_bÀndögModeId
 = 
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEIBÀndögModeID
();

589 
£iFûmGøö
->
m_log2SˇÀFa˘‹
 = 
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEILog2SˇÀFa˘‹
();

590 
i
 = 0; i < 
MAX_NUM_COMPONENT
; i++)

592 
£iFûmGøö
->
m_compModñ
[
i
].
bPª£¡Fœg
 = 
m_pcCfg
->
	`gëFGCSEICompModñPª£¡
(i);

593 #i‡
FGS_RDD5_ENABLE


594 i‡(
£iFûmGøö
->
m_compModñ
[
i
].
bPª£¡Fœg
)

596 
£iFûmGøö
->
m_compModñ
[
i
].
numModñVÆues
 = 1 + 
m_pcCfg
->
	`gëFGCSEINumModñVÆuesMöus1
(i);

597 
£iFûmGøö
->
m_compModñ
[
i
].
öãnsôyVÆues
.
	`ªsize
(1 + 
m_pcCfg
->
	`gëFGCSEINumI¡ísôyI¡îvÆMöus1
(i));

598 
UI¡
 
j
 = 0; j <
m_pcCfg
->
	`gëFGCSEINumI¡ísôyI¡îvÆMöus1
(
i
); j++)

600 
£iFûmGøö
->
m_compModñ
[
i
].
öãnsôyVÆues
[
j
].
öãnsôyI¡îvÆLowîBound
 = 
m_pcCfg
->
	`gëFGCSEII¡ísôyI¡îvÆLowîBound
(i, j);

601 
£iFûmGøö
->
m_compModñ
[
i
].
öãnsôyVÆues
[
j
].
öãnsôyI¡îvÆUµîBound
 = 
m_pcCfg
->
	`gëFGCSEII¡ísôyI¡îvÆUµîBound
(i, j);

602 
£iFûmGøö
->
m_compModñ
[
i
].
öãnsôyVÆues
[
j
].
compModñVÆue
.
	`ªsize
(£iFûmGøö->m_compModñ[i].
numModñVÆues
);

603 
UI¡
 
k
 = 0; k < 
£iFûmGøö
->
m_compModñ
[
i
].
numModñVÆues
; k++)

605 
£iFûmGøö
->
m_compModñ
[
i
].
öãnsôyVÆues
[
j
].
compModñVÆue
[
k
] = 
m_pcCfg
->
	`gëFGCSEICompModñVÆue
(i, j, k);

611 
	}
}

613 
Void
 
	gSEIEncodî
::
	$öôSEIC⁄ã¡LightLevñ
(
SEIC⁄ã¡LightLevñInfo
 *
£iCLL
)

615 
	`as£π
(
m_isInôülized
);

616 
	`as£π
(
£iCLL
 !
NULL
);

618 
£iCLL
->
m_maxC⁄ã¡LightLevñ
 = 
m_pcCfg
->
	`gëCLLSEIMaxC⁄ã¡LightLevñ
();

619 
£iCLL
->
m_maxPicAvîageLightLevñ
 = 
m_pcCfg
->
	`gëCLLSEIMaxPicAvgLightLevñ
();

620 
	}
}

622 
Void
 
	gSEIEncodî
::
	$öôSEIAmbõ¡VõwögEnvú⁄mít
(
SEIAmbõ¡VõwögEnvú⁄mít
 *
£iAmbVõwEnvú⁄mít
)

624 
	`as£π
(
m_isInôülized
);

625 
	`as£π
(
£iAmbVõwEnvú⁄mít
 !
NULL
);

627 
£iAmbVõwEnvú⁄mít
->
m_ambõ¡IŒumö™˚
 = 
m_pcCfg
->
	`gëAmbõ¡VõwögEnvú⁄mítSEIIŒumö™˚
();

628 
£iAmbVõwEnvú⁄mít
->
m_ambõ¡LightX
 = 
m_pcCfg
->
	`gëAmbõ¡VõwögEnvú⁄mítSEIAmbõ¡LightX
();

629 
£iAmbVõwEnvú⁄mít
->
m_ambõ¡LightY
 = 
m_pcCfg
->
	`gëAmbõ¡VõwögEnvú⁄mítSEIAmbõ¡LightY
();

630 
	}
}

633 
Void
 
	gSEIEncodî
::
	$öôSEIEΩ
(
SEIEquúe˘™guœrProje˘i⁄
* 
£iEquúe˘™guœrProje˘i⁄
)

635 
	`as£π
 (
m_isInôülized
);

636 
	`as£π
 (
£iEquúe˘™guœrProje˘i⁄
!=
NULL
);

638 
£iEquúe˘™guœrProje˘i⁄
->
m_îpC™˚lFœg
 = 
m_pcCfg
->
	`gëEΩSEIC™˚lFœg
();

639 i‡(!
£iEquúe˘™guœrProje˘i⁄
->
m_îpC™˚lFœg
)

641 
£iEquúe˘™guœrProje˘i⁄
->
m_îpPîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëEΩSEIPîsi°í˚Fœg
();

642 
£iEquúe˘™guœrProje˘i⁄
->
m_îpGu¨dB™dFœg
 = 
m_pcCfg
->
	`gëEΩSEIGu¨dB™dFœg
();

643 i‡(
£iEquúe˘™guœrProje˘i⁄
->
m_îpGu¨dB™dFœg
 == 1)

645 
£iEquúe˘™guœrProje˘i⁄
->
m_îpGu¨dB™dTy≥
 = 
m_pcCfg
->
	`gëEΩSEIGu¨dB™dTy≥
();

646 
£iEquúe˘™guœrProje˘i⁄
->
m_îpLe·Gu¨dB™dWidth
 = 
m_pcCfg
->
	`gëEΩSEILe·Gu¨dB™dWidth
();

647 
£iEquúe˘™guœrProje˘i⁄
->
m_îpRightGu¨dB™dWidth
 = 
m_pcCfg
->
	`gëEΩSEIRightGu¨dB™dWidth
();

650 
	}
}

652 
Void
 
	gSEIEncodî
::
	$öôSEISphîeRŸ©i⁄
(
SEISphîeRŸ©i⁄
* 
£iSphîeRŸ©i⁄
)

654 
	`as£π
 (
m_isInôülized
);

655 
	`as£π
 (
£iSphîeRŸ©i⁄
!=
NULL
);

657 
£iSphîeRŸ©i⁄
->
m_•hîeRŸ©i⁄C™˚lFœg
 = 
m_pcCfg
->
	`gëSphîeRŸ©i⁄SEIC™˚lFœg
();

658 i‡–!
£iSphîeRŸ©i⁄
->
m_•hîeRŸ©i⁄C™˚lFœg
 )

660 
£iSphîeRŸ©i⁄
->
m_•hîeRŸ©i⁄Pîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëSphîeRŸ©i⁄SEIPîsi°í˚Fœg
();

661 
£iSphîeRŸ©i⁄
->
m_•hîeRŸ©i⁄Yaw
 = 
m_pcCfg
->
	`gëSphîeRŸ©i⁄SEIYaw
();

662 
£iSphîeRŸ©i⁄
->
m_•hîeRŸ©i⁄Pôch
 = 
m_pcCfg
->
	`gëSphîeRŸ©i⁄SEIPôch
();

663 
£iSphîeRŸ©i⁄
->
m_•hîeRŸ©i⁄Rﬁl
 = 
m_pcCfg
->
	`gëSphîeRŸ©i⁄SEIRﬁl
();

665 
	}
}

667 
Void
 
	gSEIEncodî
::
	$öôSEIOmniVõwp‹t
(
SEIOmniVõwp‹t
* 
£iOmniVõwp‹t
)

669 
	`as£π
 (
m_isInôülized
);

670 
	`as£π
 (
£iOmniVõwp‹t
!=
NULL
);

672 
£iOmniVõwp‹t
->
m_omniVõwp‹tId
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIId
();

673 
£iOmniVõwp‹t
->
m_omniVõwp‹tC™˚lFœg
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIC™˚lFœg
();

674 i‡–!
£iOmniVõwp‹t
->
m_omniVõwp‹tC™˚lFœg
 )

676 
£iOmniVõwp‹t
->
m_omniVõwp‹tPîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIPîsi°í˚Fœg
();

677 
£iOmniVõwp‹t
->
m_omniVõwp‹tC¡Möus1
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIC¡Möus1
();

679 
£iOmniVõwp‹t
->
m_omniVõwp‹tRegi⁄s
.
	`ªsize
(£iOmniVõwp‹t->
m_omniVõwp‹tC¡Möus1
+1);

680 
UI¡
 
i
 = 0; i <
£iOmniVõwp‹t
->
m_omniVõwp‹tC¡Möus1
; i++)

682 
SEIOmniVõwp‹t
::
OmniVõwp‹t
 &
võwp‹t
 = 
£iOmniVõwp‹t
->
m_omniVõwp‹tRegi⁄s
[
i
];

683 
võwp‹t
.
azimuthCíåe
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIAzimuthCíåe
(
i
);

684 
võwp‹t
.
ñev©i⁄Cíåe
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIEÀv©i⁄Cíåe
(
i
);

685 
võwp‹t
.
tûtCíåe
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEITûtCíåe
(
i
);

686 
võwp‹t
.
h‹R™ge
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIH‹R™ge
(
i
);

687 
võwp‹t
.
vîR™ge
 = 
m_pcCfg
->
	`gëOmniVõwp‹tSEIVîR™ge
(
i
);

690 
	}
}

692 
Void
 
	gSEIEncodî
::
	$öôSEICubem≠Proje˘i⁄
(
SEICubem≠Proje˘i⁄
 *
£iCubem≠Proje˘i⁄
)

694 
	`as£π
(
m_isInôülized
);

695 
	`as£π
(
£iCubem≠Proje˘i⁄
 !
NULL
);

696 
£iCubem≠Proje˘i⁄
->
m_cmpC™˚lFœg
 = 
m_pcCfg
->
	`gëCmpSEICmpC™˚lFœg
();

697 
£iCubem≠Proje˘i⁄
->
m_cmpPîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëCmpSEICmpPîsi°í˚Fœg
();

698 
	}
}

700 
Void
 
	gSEIEncodî
::
	$öôSEIRegi⁄Wi£Packög
(
SEIRegi⁄Wi£Packög
 *
£iRegi⁄Wi£Packög
)

702 
	`as£π
 (
m_isInôülized
);

703 
	`as£π
 (
£iRegi⁄Wi£Packög
!=
NULL
);

704 
£iRegi⁄Wi£Packög
->
m_rwpC™˚lFœg
 = 
m_pcCfg
->
	`gëRwpSEIRwpC™˚lFœg
();

705 
£iRegi⁄Wi£Packög
->
m_rwpPîsi°í˚Fœg
 = 
m_pcCfg
->
	`gëRwpSEIRwpPîsi°í˚Fœg
();

706 
£iRegi⁄Wi£Packög
->
m_c⁄°ôuítPi˘uªM©chögFœg
 = 
m_pcCfg
->
	`gëRwpSEIC⁄°ôuítPi˘uªM©chögFœg
();

707 
£iRegi⁄Wi£Packög
->
m_numPackedRegi⁄s
 = 
m_pcCfg
->
	`gëRwpSEINumPackedRegi⁄s
();

708 
£iRegi⁄Wi£Packög
->
m_¥ojPi˘uªWidth
 = 
m_pcCfg
->
	`gëRwpSEIProjPi˘uªWidth
();

709 
£iRegi⁄Wi£Packög
->
m_¥ojPi˘uªHeight
 = 
m_pcCfg
->
	`gëRwpSEIProjPi˘uªHeight
();

710 
£iRegi⁄Wi£Packög
->
m_∑ckedPi˘uªWidth
 = 
m_pcCfg
->
	`gëRwpSEIPackedPi˘uªWidth
();

711 
£iRegi⁄Wi£Packög
->
m_∑ckedPi˘uªHeight
 = 
m_pcCfg
->
	`gëRwpSEIPackedPi˘uªHeight
();

712 
£iRegi⁄Wi£Packög
->
m_rwpTønsf‹mTy≥
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

713 
£iRegi⁄Wi£Packög
->
m_rwpGu¨dB™dFœg
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

714 
£iRegi⁄Wi£Packög
->
m_¥ojRegi⁄Width
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

715 
£iRegi⁄Wi£Packög
->
m_¥ojRegi⁄Height
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

716 
£iRegi⁄Wi£Packög
->
m_rwpProjRegi⁄T›
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

717 
£iRegi⁄Wi£Packög
->
m_¥ojRegi⁄Le·
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

718 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄Width
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

719 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄Height
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

720 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄T›
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

721 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄Le·
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

722 
£iRegi⁄Wi£Packög
->
m_rwpLe·Gu¨dB™dWidth
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

723 
£iRegi⁄Wi£Packög
->
m_rwpRightGu¨dB™dWidth
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

724 
£iRegi⁄Wi£Packög
->
m_rwpT›Gu¨dB™dHeight
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

725 
£iRegi⁄Wi£Packög
->
m_rwpBŸtomGu¨dB™dHeight
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

726 
£iRegi⁄Wi£Packög
->
m_rwpGu¨dB™dNŸU£dF‹PªdFœg
.
	`ªsize
(£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

727 
£iRegi⁄Wi£Packög
->
m_rwpGu¨dB™dTy≥
.
	`ªsize
(4*£iRegi⁄Wi£Packög->
m_numPackedRegi⁄s
);

728  
I¡
 
i
=0; i < 
£iRegi⁄Wi£Packög
->
m_numPackedRegi⁄s
; i++ )

730 
£iRegi⁄Wi£Packög
->
m_rwpTønsf‹mTy≥
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpTønsf‹mTy≥
(i);

731 
£iRegi⁄Wi£Packög
->
m_rwpGu¨dB™dFœg
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpGu¨dB™dFœg
(i);

732 
£iRegi⁄Wi£Packög
->
m_¥ojRegi⁄Width
[
i
] = 
m_pcCfg
->
	`gëRwpSEIProjRegi⁄Width
(i);

733 
£iRegi⁄Wi£Packög
->
m_¥ojRegi⁄Height
[
i
] = 
m_pcCfg
->
	`gëRwpSEIProjRegi⁄Height
(i);

734 
£iRegi⁄Wi£Packög
->
m_rwpProjRegi⁄T›
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpSEIProjRegi⁄T›
(i);

735 
£iRegi⁄Wi£Packög
->
m_¥ojRegi⁄Le·
[
i
] = 
m_pcCfg
->
	`gëRwpSEIProjRegi⁄Le·
(i);

736 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄Width
[
i
] = 
m_pcCfg
->
	`gëRwpSEIPackedRegi⁄Width
(i);

737 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄Height
[
i
] = 
m_pcCfg
->
	`gëRwpSEIPackedRegi⁄Height
(i);

738 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄T›
[
i
] = 
m_pcCfg
->
	`gëRwpSEIPackedRegi⁄T›
(i);

739 
£iRegi⁄Wi£Packög
->
m_∑ckedRegi⁄Le·
[
i
] = 
m_pcCfg
->
	`gëRwpSEIPackedRegi⁄Le·
(i);

740 if–
£iRegi⁄Wi£Packög
->
m_rwpGu¨dB™dFœg
[
i
] )

742 
£iRegi⁄Wi£Packög
->
m_rwpLe·Gu¨dB™dWidth
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpLe·Gu¨dB™dWidth
(i);

743 
£iRegi⁄Wi£Packög
->
m_rwpRightGu¨dB™dWidth
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpRightGu¨dB™dWidth
(i);

744 
£iRegi⁄Wi£Packög
->
m_rwpT›Gu¨dB™dHeight
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpT›Gu¨dB™dHeight
(i);

745 
£iRegi⁄Wi£Packög
->
m_rwpBŸtomGu¨dB™dHeight
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpBŸtomGu¨dB™dHeight
(i);

746 
£iRegi⁄Wi£Packög
->
m_rwpGu¨dB™dNŸU£dF‹PªdFœg
[
i
] = 
m_pcCfg
->
	`gëRwpSEIRwpGu¨dB™dNŸU£dF‹PªdFœg
(i);

747  
I¡
 
j
=0; j < 4; j++ )

749 
£iRegi⁄Wi£Packög
->
m_rwpGu¨dB™dTy≥
[
i
*4 + 
j
] = 
m_pcCfg
->
	`gëRwpSEIRwpGu¨dB™dTy≥
(i*4 + j);

753 
	}
}

755 
Void
 
	gSEIEncodî
::
	$öôSEIFisheyeVideoInfo
(
SEIFisheyeVideoInfo
 *
£iFisheyeVideoInfo
)

757 
	`as£π
(
m_isInôülized
);

758 
	`as£π
(
£iFisheyeVideoInfo
 !
NULL
);

759 
£iFisheyeVideoInfo
->
vÆues
 = 
m_pcCfg
->
	`gëFviSEID©a
();

760 
	}
}

762 
	gãm∂©e
 <
ty≥«me
 
	gT
>

763 
Void
 
ªadTokíVÆue
(
T
 &
ªtu∫edVÆue
,

764 
Boﬁ
 &
Áûed
,

765 
°d
::
i°ªam
 &
is
,

766 c⁄° 
TCh¨
 *
pTokí
,

767 
	$Boﬁ
 (*
∑r£Fn
Ë(
°d
::
i°ªam
 &, 
T
 &)

770 
ªtu∫edVÆue
=
	`T
();

771 i‡(
Áûed
)

776 
I¡
 
c
;

778 (
c
=
is
.
	`gë
())!=
EOF
 && 
	`is•a˚
(c));

780 
c
=='#')

783 (
c
=
is
.
	`gë
())!=
EOF
 && (c!=10 && c!=13));

785 (
c
=
is
.
	`gë
())!=
EOF
 && 
	`is•a˚
(c));

788 
Áûed
=(
c
!=
pTokí
[0]);

790 
I¡
 
pos
;

791 
pos
=1;!
Áûed
 && 
pTokí
[pos]!=0 && 
is
.
	`gë
()==pToken[pos];Öos++);

792 
Áûed
|=(
pTokí
[
pos
]!=0);

794 !
Áûed
 && (
c
=
is
.
	`gë
())!=
EOF
 && 
	`is•a˚
(c));

795 
Áûed
|=(
c
!=':');

797 i‡(!
Áûed
)

799 
Áûed
=
	`∑r£Fn
(
is
, 
ªtu∫edVÆue
);

801 i‡(
Áûed
)

803 
°d
::
˚º
 << "U«bÀÅÿªadÅokí '" << 
pTokí
 << "'\n";

805 
	}
}

807 
	gãm∂©e
 <
ty≥«me
 
	gT
>

808 
Boﬁ
 
	$ªadTokíVÆueP¨sög
(
°d
::
i°ªam
 &
is
, 
T
 & 
ªtu∫edVÆue
)

810 
is
 >> 
ªtu∫edVÆue
;

811 
Boﬁ
 
Áûed
=!
is
.
	`good
();

812 i‡(!
Áûed
)

814 
I¡
 
c
=
is
.
	`gë
();

815 
Áûed
=(
c
!=
EOF
 && !
	`is•a˚
(c));

817  
Áûed
;

818 
	}
}

820 
	gãm∂©e
 <>

821 
Boﬁ
 
	$ªadTokíVÆueP¨sög
(
°d
::
i°ªam
 &
is
, std::
°rög
 & 
ªtu∫edVÆue
)

823 
I¡
 
c
;

827 
c
=
is
.
	`gë
();

828 } 
	`is•a˚
(
c
Ë&& c!=10 && c!=13 && c!=
EOF
);

830 
I¡
 
cuºítQuŸeSymbﬁ
=0;

831 
I¡
 
åaûögS∑˚s
=0;

833 
c
!=
EOF
 && c!=0 && c!=10 && c!=13)

835 i‡(
cuºítQuŸeSymbﬁ
==0 && (
c
=='"' || c=='\''))

837 
cuºítQuŸeSymbﬁ
=
c
;

839 i‡(
c
==
cuºítQuŸeSymbﬁ
)

841 
cuºítQuŸeSymbﬁ
=0;

843 i‡(
	`is•a˚
(
c
Ë&& !
cuºítQuŸeSymbﬁ
)

845 
åaûögS∑˚s
++;

849 i‡(
c
=='\\')

851 
c
=
is
.
	`gë
();

852 i‡(
c
==
EOF
 || c==10 || c==13 || c==0)

854  
åue
;

857 i‡(
åaûögS∑˚s
)

859 
ªtu∫edVÆue
+=
	`°rög
(
åaûögS∑˚s
, ' ');

860 
åaûögS∑˚s
=0;

862 
ªtu∫edVÆue
+=
c
;

864 
c
=
is
.
	`gë
();

867  
cuºítQuŸeSymbﬁ
!=0;

868 
	}
}

870 
	gãm∂©e
 <
ty≥«me
 
	gT
>

871 
Void
 
	$ªadTokíVÆue
(
T
 &
ªtu∫edVÆue
,

872 
Boﬁ
 &
Áûed
,

873 
°d
::
i°ªam
 &
is
,

874 c⁄° 
TCh¨
 *
pTokí
)

876 
	`ªadTokíVÆue
(
ªtu∫edVÆue
, 
Áûed
, 
is
, 
pTokí
, 
ªadTokíVÆueP¨sög
);

877 
	}
}

879 
	gãm∂©e
 <
ty≥«me
 
	gT
>

880 
Void
 
	$ªadTokíVÆueAndVÆid©e
(
T
 &
ªtu∫edVÆue
,

881 
Boﬁ
 &
Áûed
,

882 
°d
::
i°ªam
 &
is
,

883 c⁄° 
TCh¨
 *
pTokí
,

884 c⁄° 
T
 &
möIn˛usive
,

885 c⁄° 
T
 &
maxIn˛usive
)

887 
	`ªadTokíVÆue
(
ªtu∫edVÆue
, 
Áûed
, 
is
, 
pTokí
);

888 i‡(!
Áûed
)

890 i‡(
ªtu∫edVÆue
<
möIn˛usive
 ||Ñëu∫edVÆue>
maxIn˛usive
)

892 
Áûed
=
åue
;

893 
°d
::
˚º
 << "VÆuêf‹Åokí " << 
pTokí
 << " mu° bêöÅhêøngê" << 
möIn˛usive
 << "Åÿ" << 
maxIn˛usive
 << " (ö˛usive); vÆuêªad: " << 
ªtu∫edVÆue
 << std::
ídl
;

896 
	}
}

899 
Void
 
	$ªadTokíVÆueAndVÆid©e
(
Boﬁ
 &
ªtu∫edVÆue
,

900 
Boﬁ
 &
Áûed
,

901 
°d
::
i°ªam
 &
is
,

902 c⁄° 
TCh¨
 *
pTokí
)

904 
	`ªadTokíVÆue
(
ªtu∫edVÆue
, 
Áûed
, 
is
, 
pTokí
);

905 
	}
}

909 
	gãm∂©e
 <
ty≥«me
 
	gT
>

910 
Void
 
ªadTokíVÆue
(
°d
::
ve˘‹
<
T
> &
ªtu∫edVÆue
,

911 
Boﬁ
 &
Áûed
,

912 
°d
::
i°ªam
 &
is
,

913 c⁄° 
TCh¨
 *
pTokí
,

914 c⁄° 
UI¡
 &
numVÆues
)

916 
	gªtu∫edVÆue
=
°d
::
ve˘‹
<
T
>();

917 i‡(
	gÁûed
)

922 
I¡
 
	gc
;

924 (
	gc
=
is
.
gë
())!=
EOF
 && 
is•a˚
(
c
));

926 
	gc
=='#')

929 (
c
=
is
.
gë
())!=
EOF
 && (c!=10 && c!=13));

931 (
	gc
=
is
.
gë
())!=
EOF
 && 
is•a˚
(
c
));

934 
	gÁûed
=(
c
!=
pTokí
[0]);

936 
I¡
 
	gpos
;

937 
	gpos
=1;!
	gÁûed
 && 
	gpTokí
[
pos
]!=0 && 
is
.
gë
()==
pTokí
[pos];Öos++);

938 
	gÁûed
|=(
pTokí
[
pos
]!=0);

940 !
	gÁûed
 && (
	gc
=
is
.
gë
())!=
EOF
 && 
is•a˚
(
c
));

941 
	gÁûed
|=(
c
!=':');

943 
UI¡
 
	gi
 = 0; i < 
	gnumVÆues
; i++)

945 i‡(!
	gÁûed
)

947 
	gis
 >> 
	gªtu∫edVÆue
[
i
];

948 
	gÁûed
=!
is
.
good
();

949 i‡(!
	gÁûed
)

951 
	gc
=
is
.
gë
();

952 
	gÁûed
=(
c
!=
EOF
 && !
is•a˚
(c));

955 i‡(
	gÁûed
)

957 
	g°d
::
˚º
 << "U«bÀÅÿªadÅokí '" << 
pTokí
 << "[" << 
i
 << "]'\n";

962 
	gãm∂©e
 <
ty≥«me
 
	gT
>

963 
Void
 
ªadTokíVÆueAndVÆid©e
(
°d
::
ve˘‹
<
T
> &
ªtu∫edVÆue
,

964 
Boﬁ
 &
Áûed
,

965 
°d
::
i°ªam
 &
is
,

966 c⁄° 
TCh¨
 *
pTokí
,

967 c⁄° 
T
 &
möIn˛usive
,

968 c⁄° 
T
 &
maxIn˛usive
,

969 c⁄° 
UI¡
 &
numVÆues
)

971 
	gªadTokíVÆue
<
	gI¡
>(
	gªtu∫edVÆue
, 
	gÁûed
, 
	gis
, 
	gpTokí
, 
	gnumVÆues
);

972 i‡(!
	gÁûed
)

974 
UI¡
 
	gi
 = 0; i < 
	gnumVÆues
; i++)

976 i‡(
	gªtu∫edVÆue
[
i
]<
	gmöIn˛usive
 ||Ñëu∫edVÆue[i]>
	gmaxIn˛usive
)

978 
	gÁûed
=
åue
;

979 
	g°d
::
˚º
 << "VÆuêf‹Åokí " << 
pTokí
 << "[" << 
i
 << "] mu° bêöÅhêøngê" << 
möIn˛usive
 << "Åÿ" << 
maxIn˛usive
 << " (ö˛usive); vÆuêªad: " << 
ªtu∫edVÆue
[i] << 
°d
::
ídl
;

985 
Boﬁ
 
	gSEIEncodî
::
	$öôSEICﬁourRem≠pögInfo
(
SEICﬁourRem≠pögInfo
* 
£iCﬁourRem≠pögInfo
, 
I¡
 
cuºPOC
)

987 
	`as£π
 (
m_isInôülized
);

988 
	`as£π
 (
£iCﬁourRem≠pögInfo
!=
NULL
);

991 if–!
m_pcCfg
->
	`gëCﬁourRem≠InfoSEIFûeRoŸ
().
	`em±y
())

993 
Boﬁ
 
Áûed
=
Ál£
;

996 
°d
::
°rög
 
	`cﬁourRem≠SEIFûeWôhPoc
(
m_pcCfg
->
	`gëCﬁourRem≠InfoSEIFûeRoŸ
());

998 
°d
::
°rög°ªam
 
suffix
;

999 
suffix
 << "_" << 
cuºPOC
 << ".txt";

1000 
cﬁourRem≠SEIFûeWôhPoc
+=
suffix
.
	`°r
();

1003 
°d
::
if°ªam
 
	`fic
(
cﬁourRem≠SEIFûeWôhPoc
.
	`c_°r
());

1004 i‡(!
fic
.
	`good
(Ë|| !fic.
	`is_›í
())

1006 
°d
::
˚º
 << "NÿCﬁou∏Rem≠pög Inf‹m©i⁄ SEIÖ¨amëî†fûê" << 
cﬁourRem≠SEIFûeWôhPoc
 << " f‹ POC " << 
cuºPOC
 << std::
ídl
;

1007  
Ál£
;

1011 
	`ªadCﬁourRem≠SEI
(
fic
, 
£iCﬁourRem≠pögInfo
, 
Áûed
 );

1013 if–
Áûed
 )

1015 
°d
::
˚º
 << "Eº‹ whûêªadög Cﬁou∏Rem≠pög Inf‹m©i⁄ SEIÖ¨amëî†fûê'" << 
cﬁourRem≠SEIFûeWôhPoc
 << "'" << std::
ídl
;

1016 
	`exô
(
EXIT_FAILURE
);

1019  
åue
;

1020 
	}
}

1022 
Void
 
	gSEIEncodî
::
	$ªadRNSEIWödow
(
°d
::
i°ªam
 &
fic
, 
RNSEIWödowVec
::
ôî©‹
 
ªgi⁄Iãr
, 
Boﬁ
 &
Áûed
 )

1024 
I¡
 
ªgi⁄Id
;

1025 
I¡
 
offLe·
, 
offRight
, 
offT›
, 
offBŸtom
;

1026 
fic
 >> 
ªgi⁄Id
 >> 
offLe·
 >> 
offRight
 >> 
offT›
 >> 
offBŸtom
;

1027 (*
ªgi⁄Iãr
).
	`£tRegi⁄Id
(
ªgi⁄Id
);

1028 (*
ªgi⁄Iãr
).
	`£tWödow
(
offLe·
, 
offRight
, 
offT›
, 
offBŸtom
);

1029 
	}
}

1030 
Void
 
	gSEIEncodî
::
	$ªadCﬁourRem≠SEI
(
°d
::
i°ªam
 &
fic
, 
SEICﬁourRem≠pögInfo
 *
£iCﬁourRem≠pögInfo
, 
Boﬁ
 &
Áûed
 )

1032 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠Id
, 
Áûed
, 
fic
, "cﬁour_ªm≠_id", 
	`UI¡
(0), UInt(0x7fffffff) );

1033 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠C™˚lFœg
, 
Áûed
, 
fic
, "colour_remap_cancel_flag" );

1034 if–!
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠C™˚lFœg
 )

1036 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠Pîsi°í˚Fœg
, 
Áûed
, 
fic
, "colour_remap_persistence_flag" );

1037 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠VideoSig«lInfoPª£¡Fœg
, 
Áûed
, 
fic
, "colour_remap_video_signal_info_present_flag");

1038 if–
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠VideoSig«lInfoPª£¡Fœg
 )

1040 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠FuŒR™geFœg
, 
Áûed
, 
fic
, "colour_remap_full_range_flag" );

1041 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠Prim¨õs
, 
Áûed
, 
fic
, "cﬁour_ªm≠_¥im¨õs", 
	`I¡
(0), Int(255) );

1042 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠Tøns„rFun˘i⁄
, 
Áûed
, 
fic
, "cﬁour_ªm≠_å™s„r_fun˘i⁄", 
	`I¡
(0), Int(255) );

1043 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠M©rixC€fficõ¡s
, 
Áûed
, 
fic
, "cﬁour_ªm≠_m©rix_c€fficõ¡s", 
	`I¡
(0), Int(255) );

1045 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠I≈utBôDïth
, 
Áûed
, 
fic
, "cﬁour_ªm≠_öput_bô_dïth", 
	`I¡
(8), Int(16) );

1046 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠BôDïth
, 
Áûed
, 
fic
, "cﬁour_ªm≠_bô_dïth", 
	`I¡
(8), Int(16) );

1048 c⁄° 
I¡
 
maximumI≈utVÆue
 = (1 << (((
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠I≈utBôDïth
 + 7) >> 3) << 3)) - 1;

1049 c⁄° 
I¡
 
maximumRem≠≥dVÆue
 = (1 << (((
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠BôDïth
 + 7) >> 3) << 3)) - 1;

1051  
I¡
 
c
=0 ; c<3 ; c++ )

1053 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_¥eLutNumVÆMöus1
[
c
], 
Áûed
, 
fic
, "¥e_lut_num_vÆ_möus1[c]", 
	`I¡
(0), Int(32) );

1054 if–
£iCﬁourRem≠pögInfo
->
m_¥eLutNumVÆMöus1
[
c
]>0 )

1056 
£iCﬁourRem≠pögInfo
->
m_¥eLut
[
c
].
	`ªsize
(£iCﬁourRem≠pögInfo->
m_¥eLutNumVÆMöus1
[c]+1);

1057  
I¡
 
i
=0 ; i<=
£iCﬁourRem≠pögInfo
->
m_¥eLutNumVÆMöus1
[
c
] ; i++ )

1059 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_¥eLut
[
c
][
i
].
codedVÆue
, 
Áûed
, 
fic
, "¥e_lut_coded_vÆue[c][i]", 
	`I¡
(0), 
maximumI≈utVÆue
 );

1060 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_¥eLut
[
c
][
i
].
èrgëVÆue
, 
Áûed
, 
fic
, "¥e_lut_èrgë_vÆue[c][i]", 
	`I¡
(0), 
maximumRem≠≥dVÆue
 );

1064 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠M©rixPª£¡Fœg
, 
Áûed
, 
fic
, "colour_remap_matrix_present_flag" );

1065 if–
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠M©rixPª£¡Fœg
 )

1067 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_log2M©rixDíom
, 
Áûed
, 
fic
, "log2_m©rix_díom", 
	`I¡
(0), Int(15) );

1068  
I¡
 
c
=0 ; c<3 ; c++ )

1070  
I¡
 
i
=0 ; i<3 ; i++ )

1072 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_cﬁourRem≠C€ffs
[
c
][
i
], 
Áûed
, 
fic
, "colour_remap_coeffs[c][i]", -32768, 32767 );

1076  
I¡
 
c
=0 ; c<3 ; c++ )

1078 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_po°LutNumVÆMöus1
[
c
], 
Áûed
, 
fic
, "po°_lut_num_vÆ_möus1[c]", 
	`I¡
(0), Int(32) );

1079 if–
£iCﬁourRem≠pögInfo
->
m_po°LutNumVÆMöus1
[
c
]>0 )

1081 
£iCﬁourRem≠pögInfo
->
m_po°Lut
[
c
].
	`ªsize
(£iCﬁourRem≠pögInfo->
m_po°LutNumVÆMöus1
[c]+1);

1082  
I¡
 
i
=0 ; i<=
£iCﬁourRem≠pögInfo
->
m_po°LutNumVÆMöus1
[
c
] ; i++ )

1084 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_po°Lut
[
c
][
i
].
codedVÆue
, 
Áûed
, 
fic
, "po°_lut_coded_vÆue[c][i]", 
	`I¡
(0), 
maximumRem≠≥dVÆue
 );

1085 
	`ªadTokíVÆueAndVÆid©e
(
£iCﬁourRem≠pögInfo
->
m_po°Lut
[
c
][
i
].
èrgëVÆue
, 
Áûed
, 
fic
, "po°_lut_èrgë_vÆue[c][i]", 
	`I¡
(0), 
maximumRem≠≥dVÆue
 );

1090 
	}
}

1091 
Void
 
	gSEIEncodî
::
	$ªadT⁄eM≠pögInfoSEI
(
°d
::
i°ªam
 &
fic
, 
SEIT⁄eM≠pögInfo
 *
£iT⁄eM≠pögInfo
 , 
Boﬁ
 &
Áûed
 )

1093 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_t⁄eM≠Id
, 
Áûed
, 
fic
, "SEIT⁄eM≠Id", 
	`I¡
(0), Int(255) );

1094 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_t⁄eM≠C™˚lFœg
, 
Áûed
, 
fic
, "SEIToneMapCancelFlag");

1095 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_t⁄eM≠Pîsi°í˚Fœg
, 
Áûed
, 
fic
, "SEIToneMapPersistenceFlag");

1096 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_codedD©aBôDïth
, 
Áûed
, 
fic
, "SEIT⁄eM≠CodedD©aBôDïth", 
	`I¡
(8), Int(14) );

1097 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_èrgëBôDïth
, 
Áûed
, 
fic
, "SEIT⁄eM≠T¨gëBôDïth", 
	`I¡
(8), Int(14) );

1098 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_modñId
, 
Áûed
, 
fic
, "SEIT⁄eM≠ModñId", 
	`I¡
(0), Int(4) );

1099 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_möVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠MöVÆue", 
	`I¡
(0), Int((1<<14)-1) );

1100 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_maxVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠MaxVÆue", 
	`I¡
(0), Int((1<<14)-1) );

1101 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_sigmoidMidpoöt
, 
Áûed
, 
fic
, "SEIT⁄eM≠SigmoidMidpoöt", 
	`I¡
(0), Int((1<<14)-1) );

1102 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_sigmoidWidth
, 
Áûed
, 
fic
, "SEIT⁄eM≠SigmoidWidth", 
	`I¡
(0), Int((1<<14)-1) );

1103 
ªadTokíVÆueAndVÆid©e
<
I¡
>(
£iT⁄eM≠pögInfo
->
m_°¨tOfCodedI¡îvÆ
, 
Áûed
, 
fic
, "SEIT⁄eM≠SèπOfCodedI¡îvÆ", 
	`I¡
(0), I¡((1<<16)-1), 
	`UI¡
(1<<£iT⁄eM≠pögInfo->
m_èrgëBôDïth
) );

1104 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_numPivŸs
, 
Áûed
, 
fic
, "SEIT⁄eM≠NumPivŸs", 
	`I¡
(0), Int((1<<16)-1) );

1105 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_codedPivŸVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠CodedPivŸVÆue", 
	`I¡
(0), I¡((1<<16)-1), seiT⁄eM≠pögInfo->
m_numPivŸs
 );

1106 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_èrgëPivŸVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠T¨gëPivŸVÆue", 
	`I¡
(0), I¡((1<<16)-1), seiT⁄eM≠pögInfo->
m_numPivŸs
 );

1107 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_ˇmîaIsoS≥edIdc
, 
Áûed
, 
fic
, "SEIT⁄eM≠CamîaIsoS≥edIdc", 
	`I¡
(0), Int(255) );

1108 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_ˇmîaIsoS≥edVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠CamîaIsoS≥edVÆue", 
	`I¡
(0), Int((~0)-1) );

1109 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_exposuªIndexIdc
, 
Áûed
, 
fic
, "SEIT⁄eM≠ExposuªIndexIdc", 
	`I¡
(0), Int(255) );

1110 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_exposuªIndexVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠ExposuªIndexVÆue", 
	`I¡
(0), Int((~0)-1) );

1111 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_exposuªCom≥nßti⁄VÆueSignFœg
, 
Áûed
, 
fic
, "SEIToneMapExposureCompensationValueSignFlag");

1112 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_exposuªCom≥nßti⁄VÆueNumî©‹
, 
Áûed
, 
fic
, "SEIT⁄eM≠ExposuªCom≥nßti⁄VÆueNumî©‹", 
	`I¡
(0), Int((1<<16)-1) );

1113 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_exposuªCom≥nßti⁄VÆueDíomIdc
, 
Áûed
, 
fic
, "SEIT⁄eM≠ExposuªCom≥nßti⁄VÆueDíomIdc", 
	`I¡
(0), Int((1<<16)-1) );

1114 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_ªfS¸ìnLumö™˚Whôe
, 
Áûed
, 
fic
, "SEIT⁄eM≠RefS¸ìnLumö™˚Whôe", 
	`I¡
(0), Int(10000) );

1115 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_exãndedR™geWhôeLevñ
, 
Áûed
, 
fic
, "SEIT⁄eM≠ExãndedR™geWhôeLevñ", 
	`I¡
(100), Int(10000) );

1116 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_nomöÆBœckLevñLumaCodeVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠NomöÆBœckLevñLumaCodeVÆue", 
	`I¡
(0), Int((1<<16)-1) );

1117 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_nomöÆWhôeLevñLumaCodeVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠NomöÆWhôeLevñLumaCodeVÆue", 
	`I¡
(0), Int((1<<16)-1) );

1118 
	`ªadTokíVÆueAndVÆid©e
(
£iT⁄eM≠pögInfo
->
m_exãndedWhôeLevñLumaCodeVÆue
, 
Áûed
, 
fic
, "SEIT⁄eM≠ExãndedWhôeLevñLumaCodeVÆue", 
	`I¡
(0), Int((1<<16)-1) );

1119 
	}
}

1120 
Void
 
	gSEIEncodî
::
	$ªadChromaReßm∂ögFûãrHötSEI
(
°d
::
i°ªam
 &
fic
, 
SEIChromaReßm∂ögFûãrHöt
 *
£iChromaReßm∂ögFûãrHöt
, 
Boﬁ
 &
Áûed
 )

1122 
I¡
 
h‹FûTy≥
, 
vîFûTy≥
;

1123 
	`ªadTokíVÆueAndVÆid©e
(
h‹FûTy≥
, 
Áûed
, 
fic
, "SEIChromaReßm∂ögH‹iz⁄èlFûãrTy≥", 
	`I¡
(0), Int(2) );

1124 
	`ªadTokíVÆueAndVÆid©e
(
vîFûTy≥
, 
Áûed
, 
fic
, "SEIChromaReßm∂ögVîtiˇlFûãrTy≥", 
	`I¡
(0), Int(2) );

1125 if(
h‹FûTy≥
 =1 || 
vîFûTy≥
 == 1)

1127 
cout
 << "Encoder supportÇeeded for scanningádditional syntaxÉlements of chromaÑesampling filter hint SEI message.\n";

1128 
cout
 << "Addn. codeÇeeded inÑeadChromaResamplingFilterHintSEI()ánd initSEIChromaResamplingFilterHint().\n";

1129 
	`exô
(1);

1131 
	`öôSEIChromaReßm∂ögFûãrHöt
(
£iChromaReßm∂ögFûãrHöt
, 
h‹FûTy≥
, 
vîFûTy≥
);

1132 
	}
}

1133 
Void
 
	gSEIEncodî
::
	$ªadK√eFun˘i⁄InfoSEI
(
°d
::
i°ªam
 &
fic
, 
SEIK√eFun˘i⁄Info
 *
£iK√eFun˘i⁄Info
, 
Boﬁ
 &
Áûed
 )

1135 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eId
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄Id", 
	`I¡
(0), Int(255));

1136 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eC™˚lFœg
, 
Áûed
, 
fic
, "SEIKneeFunctionCancelFlag" );

1137 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√ePîsi°í˚Fœg
, 
Áûed
, 
fic
, "SEIKneeFunctionPersistenceFlag" );

1138 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eI≈utDønge
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄I≈utDønge", 
	`I¡
(0), Int(1000) );

1139 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eI≈utDi•Lumö™˚
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄I≈utDi•Lumö™˚", 
	`I¡
(0), Int(10000) );

1140 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eOuçutDønge
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄OuçutDønge", 
	`I¡
(0), Int(1000) );

1141 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eOuçutDi•Lumö™˚
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄OuçutDi•Lumö™˚",
	`I¡
(0), Int(10000) );

1142 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eNumK√ePoötsMöus1
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄NumK√ePoötsMöus1",
	`I¡
(0), Int(998) );

1143 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eI≈utK√ePoöt
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄I≈utK√ePoötVÆue",
	`I¡
(0), I¡(1000), seiK√eFun˘i⁄Info->
m_k√eNumK√ePoötsMöus1
+1 );

1144 
	`ªadTokíVÆueAndVÆid©e
(
£iK√eFun˘i⁄Info
->
m_k√eOuçutK√ePoöt
, 
Áûed
, 
fic
, "SEIK√eFun˘i⁄I≈utK√ePoötVÆue",
	`I¡
(0), I¡(1000), seiK√eFun˘i⁄Info->
m_k√eNumK√ePoötsMöus1
+1 );

1146 
	}
}

1147 
Void
 
	gSEIEncodî
::
	$ªadC⁄ã¡CﬁourVﬁumeSEI
(
°d
::
i°ªam
 &
fic
, 
SEIC⁄ã¡CﬁourVﬁume
 *
£iC⁄ã¡CﬁourVﬁume
, 
Boﬁ
 &
Áûed
 )

1149 
DoubÀ
 
dCode
, 
¥im¨õs
[2][
MAX_NUM_COMPONENT
];

1150 
	`ªadTokíVÆueAndVÆid©e
(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvC™˚lFœg
, 
Áûed
, 
fic
, "SEICCVCancelFlag" );

1151 
	`ªadTokíVÆueAndVÆid©e
(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPîsi°í˚Fœg
, 
Áûed
, 
fic
, "SEICCVPersistenceFlag" );

1152 
	`ªadTokíVÆueAndVÆid©e
(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsPª£¡Fœg
, 
Áûed
, 
fic
, "SEICCVPrimariesPresent" );

1153 
	`ªadTokíVÆueAndVÆid©e
(
¥im¨õs
[0][0], 
Áûed
, 
fic
, "m_ccvSEIPrim¨õsX0", 
	`DoubÀ
(-100), Double(100));

1154 
	`ªadTokíVÆueAndVÆid©e
(
¥im¨õs
[1][1], 
Áûed
, 
fic
, "m_ccvSEIPrim¨õsY0", 
	`DoubÀ
(-100), Double(100));

1155 
	`ªadTokíVÆueAndVÆid©e
(
¥im¨õs
[0][2], 
Áûed
, 
fic
, "m_ccvSEIPrim¨õsX1", 
	`DoubÀ
(-100), Double(100));

1156 
	`ªadTokíVÆueAndVÆid©e
(
¥im¨õs
[1][0], 
Áûed
, 
fic
, "m_ccvSEIPrim¨õsY1", 
	`DoubÀ
(-100), Double(100));

1157 
	`ªadTokíVÆueAndVÆid©e
(
¥im¨õs
[0][1], 
Áûed
, 
fic
, "m_ccvSEIPrim¨õsX2", 
	`DoubÀ
(-100), Double(100));

1158 
	`ªadTokíVÆueAndVÆid©e
(
¥im¨õs
[1][2], 
Áûed
, 
fic
, "m_ccvSEIPrim¨õsY2", 
	`DoubÀ
(-100), Double(100));

1159 if(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsPª£¡Fœg
)

1161 
I¡
 
i
 = 0; i < 
MAX_NUM_COMPONENT
; i++)

1163 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsX
[
i
] = (
I¡
Ë(50000.0 * 
¥im¨õs
[0][i]);

1164 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvPrim¨õsY
[
i
] = (
I¡
Ë(50000.0 * 
¥im¨õs
[1][i]);

1167 
	`ªadTokíVÆueAndVÆid©e
(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMöLumö™˚VÆuePª£¡Fœg
, 
Áûed
, 
fic
, "SEICCVMinLuminanceValuePresent" );

1168 
	`ªadTokíVÆueAndVÆid©e
(
dCode
, 
Áûed
, 
fic
, "SEICCVMöLumö™˚VÆue", 
	`DoubÀ
(0), Double(429.4967295));

1169 if(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMöLumö™˚VÆuePª£¡Fœg
)

1171 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMöLumö™˚VÆue
 = (
I¡
Ë(10000000 * 
dCode
);

1173 
	`ªadTokíVÆueAndVÆid©e
(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMaxLumö™˚VÆuePª£¡Fœg
, 
Áûed
, 
fic
, "SEICCVMaxLuminanceValuePresent" );

1174 
	`ªadTokíVÆueAndVÆid©e
(
dCode
, 
Áûed
, 
fic
, "SEICCVMaxLumö™˚VÆue", 
	`DoubÀ
(0), Double(429.4967295));

1175 if(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMaxLumö™˚VÆuePª£¡Fœg
)

1177 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvMaxLumö™˚VÆue
 = (
I¡
Ë(10000000 * 
dCode
);

1179 
	`ªadTokíVÆueAndVÆid©e
(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvAvgLumö™˚VÆuePª£¡Fœg
, 
Áûed
, 
fic
, "SEICCVAvgLuminanceValuePresent" );

1180 
	`ªadTokíVÆueAndVÆid©e
(
dCode
, 
Áûed
, 
fic
, "SEICCVAvgLumö™˚VÆue", 
	`DoubÀ
(0), Double(429.4967295));

1181 if(
£iC⁄ã¡CﬁourVﬁume
->
m_ccvAvgLumö™˚VÆuePª£¡Fœg
)

1183 
£iC⁄ã¡CﬁourVﬁume
->
m_ccvAvgLumö™˚VÆue
 = (
I¡
Ë(10000000 * 
dCode
);

1185 
	}
}

1186 
Boﬁ
 
	gSEIEncodî
::
	$öôSEIRegi⁄ÆNe°ög
(
SEIRegi⁄ÆNe°ög
* 
£iRegi⁄ÆNe°ög
, 
I¡
 
cuºPOC
)

1188 
	`as£π
 (
m_isInôülized
);

1189 
	`as£π
 (
£iRegi⁄ÆNe°ög
!=
NULL
);

1190 
I¡
 
numRegi⁄s
;

1191 
RNSEIWödowVec
 
ªgi⁄s
;

1194 if–!
m_pcCfg
->
	`gëRegi⁄ÆNe°ögSEIFûeRoŸ
().
	`em±y
())

1196 
Boﬁ
 
Áûed
=
Ál£
;

1199 
°d
::
°rög
 
	`ªgi⁄ÆNe°ögSEIFûeWôhPoc
(
m_pcCfg
->
	`gëRegi⁄ÆNe°ögSEIFûeRoŸ
());

1201 
°d
::
°rög°ªam
 
suffix
;

1202 
suffix
 << "_" << 
cuºPOC
 << ".txt";

1203 
ªgi⁄ÆNe°ögSEIFûeWôhPoc
+=
suffix
.
	`°r
();

1206 
°d
::
if°ªam
 
	`fic
(
ªgi⁄ÆNe°ögSEIFûeWôhPoc
.
	`c_°r
());

1207 i‡(!
fic
.
	`good
(Ë|| !fic.
	`is_›í
())

1209 
°d
::
˚º
 << "NÿRegi⁄Æ Ne°ög Inf‹m©i⁄ SEIÖ¨amëî†fûê" << 
ªgi⁄ÆNe°ögSEIFûeWôhPoc
 << " f‹ POC " << 
cuºPOC
 << std::
ídl
;

1210  
Ál£
;

1213 
I¡
 
∑ylﬂdTy≥
, 
numSEIs
;

1214 
	`ªadTokíVÆueAndVÆid©e
–
numSEIs
, 
Áûed
, 
fic
, "num_seis", 0, 255 );

1216 
I¡
 
i
 = 0; i < 
numSEIs
; i++)

1218 
Regi⁄ÆSEI
 *
ªgSEI
 = 
NULL
;

1220 
	`ªadTokíVÆueAndVÆid©e
–
numRegi⁄s
, 
Áûed
, 
fic
, "num_regions", 0, 255 );

1221 
ªgi⁄s
.
	`ªsize
(
numRegi⁄s
);

1222 
RNSEIWödowVec
::
ôî©‹
 
ªgi⁄Iãr
;

1223 
ªgi⁄Iãr
 = 
ªgi⁄s
.
	`begö
();Ñegi⁄Iã∏!ªgi⁄s.
	`íd
();ÑegionIter++)

1225 
	`ªadRNSEIWödow
(
fic
, 
ªgi⁄Iãr
, 
Áûed
);

1228 
	`ªadTokíVÆueAndVÆid©e
–
∑ylﬂdTy≥
, 
Áûed
, 
fic
, "payloadType", 0, 255 );

1229 if(!
Regi⁄ÆSEI
::
	`checkRegi⁄ÆNe°edSEIPaylﬂdTy≥
(
SEI
::
	`PaylﬂdTy≥
(
∑ylﬂdTy≥
)))

1231 
cout
 << "PaylﬂdTy≥ " << 
∑ylﬂdTy≥
 << "Çot supported inÑegionalÇesting SEI message. Exiting.\n";

1232 
	`exô
(1);

1236 
SEI
::
	`PaylﬂdTy≥
(
∑ylﬂdTy≥
))

1238 
SEI
::
FILM_GRAIN_CHARACTERISTICS
:

1239 
SEI
::
POST_FILTER_HINT
:

1240 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
:

1241 
SEI
::
USER_DATA_UNREGISTERED
:

1243 
cout
 << "Encodî suµ‹àf‹ " << 
SEI
::
	`gëSEIMesßgeSåög
(SEI::
	`PaylﬂdTy≥
(
∑ylﬂdTy≥
)) <<

1245 
	`exô
(1);

1247 
SEI
::
TONE_MAPPING_INFO
:

1249 
SEIT⁄eM≠pögInfo
 *
£iT⁄eM≠pögInfo
 = 
√w
 SEIToneMappingInfo;

1250 
	`ªadT⁄eM≠pögInfoSEI
(
fic
, 
£iT⁄eM≠pögInfo
, 
Áûed
);

1251 
ªgSEI
 = 
√w
 
	`Regi⁄ÆSEI
(
£iT⁄eM≠pögInfo
, 
ªgi⁄s
);

1254 
SEI
::
CHROMA_RESAMPLING_FILTER_HINT
:

1256 
SEIChromaReßm∂ögFûãrHöt
 *
£iChromaReßm∂ögFûãrHöt
 = 
√w
 SEIChromaResamplingFilterHint;

1257 
	`ªadChromaReßm∂ögFûãrHötSEI
(
fic
, 
£iChromaReßm∂ögFûãrHöt
, 
Áûed
);

1258 
ªgSEI
 = 
√w
 
	`Regi⁄ÆSEI
(
£iChromaReßm∂ögFûãrHöt
, 
ªgi⁄s
);

1261 
SEI
::
KNEE_FUNCTION_INFO
:

1263 
SEIK√eFun˘i⁄Info
 *
£iK√eFun˘i⁄Info
 = 
√w
 SEIKneeFunctionInfo;

1264 
	`ªadK√eFun˘i⁄InfoSEI
(
fic
, 
£iK√eFun˘i⁄Info
, 
Áûed
);

1265 
ªgSEI
 = 
√w
 
	`Regi⁄ÆSEI
(
£iK√eFun˘i⁄Info
, 
ªgi⁄s
);

1268 
SEI
::
COLOUR_REMAPPING_INFO
:

1270 
SEICﬁourRem≠pögInfo
 *
£iCﬁourRem≠pögInfo
 = 
√w
 SEIColourRemappingInfo;

1271 
	`ªadCﬁourRem≠SEI
(
fic
, 
£iCﬁourRem≠pögInfo
, 
Áûed
);

1272 
ªgSEI
 = 
√w
 
	`Regi⁄ÆSEI
(
£iCﬁourRem≠pögInfo
, 
ªgi⁄s
);

1275 
SEI
::
CONTENT_COLOUR_VOLUME
:

1277 
SEIC⁄ã¡CﬁourVﬁume
 *
£iC⁄ã¡CﬁourVﬁume
 = 
√w
 SEIContentColourVolume;

1278 
	`ªadC⁄ã¡CﬁourVﬁumeSEI
(
fic
, 
£iC⁄ã¡CﬁourVﬁume
, 
Áûed
);

1279 
ªgSEI
 = 
√w
 
	`Regi⁄ÆSEI
(
£iC⁄ã¡CﬁourVﬁume
, 
ªgi⁄s
);

1283 
cout
 << "U«bÀÅÿªadÅhê∑ylﬂdTy≥ " << 
∑ylﬂdTy≥
 << " i¿" << 
ªgi⁄ÆNe°ögSEIFûeWôhPoc
 << 
°d
::
ídl
;

1284 
	`exô
(1);

1286 if–
Áûed
 )

1288 
°d
::
˚º
 << "Eº‹ whûêªadögÑegi⁄ÆÇe°ög SEIÖ¨amëî†fûê'" << 
ªgi⁄ÆNe°ögSEIFûeWôhPoc
 << "'" << std::
ídl
;

1289 
	`exô
(
EXIT_FAILURE
);

1292 if(
ªgSEI
)

1294 
£iRegi⁄ÆNe°ög
->
	`addRegi⁄ÆSEI
(
ªgSEI
);

1295 
dñëe
 
ªgSEI
;

1303  
åue
;

1304 
	}
}

1307 
Void
 
	gSEIEncodî
::
	$ªadA¬Ÿ©edRegi⁄SEI
(
°d
::
i°ªam
 &
fic
, 
SEIA¬Ÿ©edRegi⁄s
 *
£iA¬oRegi⁄
, 
Boﬁ
 &
Áûed
)

1309 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_ˇn˚lFœg
, 
Áûed
, 
fic
, "SEIArCancelFlag");

1310 i‡(!
£iA¬oRegi⁄
->
m_hdr
.
m_ˇn˚lFœg
)

1312 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_nŸO±imizedF‹VõwögFœg
, 
Áûed
, 
fic
, "SEIArNotOptForViewingFlag");

1313 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_åueMŸi⁄Fœg
, 
Áûed
, 
fic
, "SEIArTrueMotionFlag");

1314 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_oc˛udedObje˘Fœg
, 
Áûed
, 
fic
, "SEIArOccludedObjsFlag");

1315 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_∑πülObje˘FœgPª£¡Fœg
, 
Áûed
, 
fic
, "SEIArPartialObjsFlagPresentFlag");

1316 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘LabñPª£¡Fœg
, 
Áûed
, 
fic
, "SEIArObjLabelPresentFlag");

1317 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
, 
Áûed
, 
fic
, "SEIArObjConfInfoPresentFlag");

1318 i‡(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
)

1320 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘C⁄fidí˚Lígth
, 
Áûed
, 
fic
, "SEIArObjDëC⁄fLígth", 
	`UI¡
(0), UInt(255));

1322 i‡(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘LabñPª£¡Fœg
)

1324 
	`ªadTokíVÆueAndVÆid©e
(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘LabñL™guagePª£¡Fœg
, 
Áûed
, 
fic
, "SEIArObjLabelLangPresentFlag");

1325 i‡(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘LabñL™guagePª£¡Fœg
)

1327 
	`ªadTokíVÆue
(
£iA¬oRegi⁄
->
m_hdr
.
m_™nŸ©edRegi⁄sObje˘LabñL™g
, 
Áûed
, 
fic
, "SEIArLabelLanguage");

1329 
UI¡
 
numLabñUpd©es
=0;

1330 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
numLabñUpd©es
, 
Áûed
, 
fic
, "SEIArNumLabñUpd©es", 
	`UI¡
(0), UInt(255));

1331 
£iA¬oRegi⁄
->
m_™nŸ©edLabñs
.
	`ªsize
(
numLabñUpd©es
);

1332 autÿ
ô
=
£iA¬oRegi⁄
->
m_™nŸ©edLabñs
.
	`begö
(); it!=£iA¬oRegi⁄->m_™nŸ©edLabñs.
	`íd
(); it++)

1334 
SEIA¬Ÿ©edRegi⁄s
::
A¬Ÿ©edRegi⁄Labñ
 &
¨
=
ô
->
£c⁄d
;

1335 
	`ªadTokíVÆueAndVÆid©e
(
ô
->
fú°
, 
Áûed
, 
fic
, "SEIArLabñIdc[c]", 
	`UI¡
(0), UInt(255));

1336 
boﬁ
 
ˇn˚lFœg
;

1337 
	`ªadTokíVÆueAndVÆid©e
(
ˇn˚lFœg
, 
Áûed
, 
fic
, "SEIArLabelCancelFlag[c]");

1338 
¨
.
œbñVÆid
=!
ˇn˚lFœg
;

1339 i‡(
¨
.
œbñVÆid
)

1341 
	`ªadTokíVÆue
(
¨
.
œbñ
, 
Áûed
, 
fic
, "SEIArLabel[c]");

1345 
UI¡
 
numObje˘Upd©es
=0;

1346 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
numObje˘Upd©es
, 
Áûed
, 
fic
, "SEIArNumObjUpd©es", 
	`UI¡
(0), UInt(255));

1347 
£iA¬oRegi⁄
->
m_™nŸ©edRegi⁄s
.
	`ªsize
(
numObje˘Upd©es
);

1348 autÿ
ô
=
£iA¬oRegi⁄
->
m_™nŸ©edRegi⁄s
.
	`begö
(); it!=£iA¬oRegi⁄->m_™nŸ©edRegi⁄s.
	`íd
(); it++)

1350 
SEIA¬Ÿ©edRegi⁄s
::
A¬Ÿ©edRegi⁄Obje˘
 &
¨
 = 
ô
->
£c⁄d
;

1351 
	`ªadTokíVÆueAndVÆid©e
(
ô
->
fú°
, 
Áûed
, 
fic
, "SEIArObjIdx[c]", 
	`UI¡
(0), UInt(255));

1352 
	`ªadTokíVÆueAndVÆid©e
(
¨
.
obje˘C™˚lFœg
, 
Áûed
, 
fic
, "SEIArObjCancelFlag[c]");

1353 
¨
.
obje˘LabñVÆid
=
Ál£
;

1354 
¨
.
boundögBoxVÆid
=
Ál£
;

1355 i‡(!
¨
.
obje˘C™˚lFœg
)

1357 i‡(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘LabñPª£¡Fœg
)

1359 
	`ªadTokíVÆueAndVÆid©e
(
¨
.
obje˘LabñVÆid
, 
Áûed
, 
fic
, "SEIArObjLabelUpdateFlag[c]");

1360 i‡(
¨
.
obje˘LabñVÆid
)

1362 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
¨
.
objLabñIdx
, 
Áûed
, 
fic
, "SEIArObje˘LabñIdc[c]", 
	`UI¡
(0), UInt(255));

1364 
	`ªadTokíVÆueAndVÆid©e
(
¨
.
boundögBoxVÆid
, 
Áûed
, 
fic
, "SEIArBoundBoxUpdateFlag[c]");

1365 i‡(
¨
.
boundögBoxVÆid
)

1367 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
¨
.
boundögBoxT›
, 
Áûed
, 
fic
, "SEIArObjT›[c]", 
	`UI¡
(0), UInt(0x7fffffff));

1368 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
¨
.
boundögBoxLe·
, 
Áûed
, 
fic
, "SEIArObjLe·[c]", 
	`UI¡
(0), UInt(0x7fffffff));

1369 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
¨
.
boundögBoxWidth
, 
Áûed
, 
fic
, "SEIArObjWidth[c]", 
	`UI¡
(0), UInt(0x7fffffff));

1370 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
¨
.
boundögBoxHeight
, 
Áûed
, 
fic
, "SEIArObjHeight[c]", 
	`UI¡
(0), UInt(0x7fffffff));

1371 i‡(
£iA¬oRegi⁄
->
m_hdr
.
m_∑πülObje˘FœgPª£¡Fœg
)

1373 
	`ªadTokíVÆueAndVÆid©e
(
¨
.
∑πülObje˘Fœg
, 
Áûed
, 
fic
, "SEIArObjPartUpdateFlag[c]");

1375 i‡(
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
)

1377 
ªadTokíVÆueAndVÆid©e
<
UI¡
>(
¨
.
obje˘C⁄fidí˚
, 
Áûed
, 
fic
, "SEIArObjDëC⁄f[c]", 
	`UI¡
(0), UI¡(1<<
£iA¬oRegi⁄
->
m_hdr
.
m_obje˘C⁄fidí˚Lígth
)-1);

1384 
	}
}

1386 
Boﬁ
 
	gSEIEncodî
::
	$öôSEIA¬Ÿ©edRegi⁄s
(
SEIA¬Ÿ©edRegi⁄s
* 
SEIA¬oReg
, 
I¡
 
cuºPOC
)

1388 
	`as£π
(
m_isInôülized
);

1389 
	`as£π
(
SEIA¬oReg
 !
NULL
);

1392 i‡(!
m_pcCfg
->
	`gëA¬Ÿ©edRegi⁄SEIFûeRoŸ
().
	`em±y
())

1394 
Boﬁ
 
Áûed
 = 
Ál£
;

1396 
°d
::
°rög
 
	`A¬oRegi⁄SEIFûeWôhPoc
(
m_pcCfg
->
	`gëA¬Ÿ©edRegi⁄SEIFûeRoŸ
());

1398 
°d
::
°rög°ªam
 
suffix
;

1399 
suffix
 << "_" << 
cuºPOC
 << ".txt";

1400 
A¬oRegi⁄SEIFûeWôhPoc
 +
suffix
.
	`°r
();

1402 
°d
::
if°ªam
 
	`fic
(
A¬oRegi⁄SEIFûeWôhPoc
.
	`c_°r
());

1403 i‡(!
fic
.
	`good
(Ë|| !fic.
	`is_›í
())

1405 
°d
::
˚º
 << "NÿA¬Ÿ©ed Regi⁄†SEIÖ¨amëî†fûê" << 
A¬oRegi⁄SEIFûeWôhPoc
 << " f‹ POC " << 
cuºPOC
 << std::
ídl
;

1406  
Ál£
;

1409 
	`ªadA¬Ÿ©edRegi⁄SEI
(
fic
, 
SEIA¬oReg
, 
Áûed
);

1410 i‡(
Áûed
)

1412 
°d
::
˚º
 << "Eº‹ whûêªadög A¬Ÿ©ed Regi⁄†SEIÖ¨amëî†fûê'" << 
A¬oRegi⁄SEIFûeWôhPoc
 << "'" << std::
ídl
;

1413 
	`exô
(
EXIT_FAILURE
);

1416  
åue
;

1417 
	}
}

1418 
Void
 
	gSEIEncodî
::
	$öôSEIChromaReßm∂ögFûãrHöt
(
SEIChromaReßm∂ögFûãrHöt
 *
£iChromaReßm∂ögFûãrHöt
, 
I¡
 
iH‹FûãrIndex
, I¡ 
iVîFûãrIndex
)

1420 
	`as£π
 (
m_isInôülized
);

1421 
	`as£π
 (
£iChromaReßm∂ögFûãrHöt
!=
NULL
);

1423 
£iChromaReßm∂ögFûãrHöt
->
m_vîChromaFûãrIdc
 = 
iVîFûãrIndex
;

1424 
£iChromaReßm∂ögFûãrHöt
->
m_h‹ChromaFûãrIdc
 = 
iH‹FûãrIndex
;

1425 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrögFõldPro˚ssögFœg
 = 1;

1426 
£iChromaReßm∂ögFûãrHöt
->
m_èrgëF‹m©Idc
 = 3;

1427 
£iChromaReßm∂ögFûãrHöt
->
m_≥r„˘Rec⁄°ru˘i⁄Fœg
 = 
Ál£
;

1430 i‡(
£iChromaReßm∂ögFûãrHöt
->
m_vîChromaFûãrIdc
 == 1)

1432 c⁄° 
I¡
 
numVîtiˇlFûãrs
 = 3;

1433 c⁄° 
I¡
 
vîT≠LígthMöus1
[] = {5,3,3};

1435 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
.
	`ªsize
(
numVîtiˇlFûãrs
);

1436 
I¡
 
i
 = 0; i < 
numVîtiˇlFûãrs
; i ++)

1438 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[
i
].
	`ªsize
(
vîT≠LígthMöus1
[i]+1);

1441 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[0][0] = -3;

1442 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[0][1] = 13;

1443 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[0][2] = 31;

1444 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[0][3] = 23;

1445 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[0][4] = 3;

1446 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[0][5] = -3;

1448 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[1][0] = -1;

1449 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[1][1] = 25;

1450 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[1][2] = 247;

1451 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[1][3] = -15;

1453 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[2][0] = -20;

1454 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[2][1] = 186;

1455 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[2][2] = 100;

1456 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
[2][3] = -10;

1460 
£iChromaReßm∂ögFûãrHöt
->
m_vîFûãrC€ff
.
	`ªsize
(0);

1463 i‡(
£iChromaReßm∂ögFûãrHöt
->
m_h‹ChromaFûãrIdc
 == 1)

1465 
I¡
 c⁄° 
numH‹iz⁄èlFûãrs
 = 1;

1466 c⁄° 
I¡
 
h‹T≠LígthMöus1
[] = {3};

1468 
£iChromaReßm∂ögFûãrHöt
->
m_h‹FûãrC€ff
.
	`ªsize
(
numH‹iz⁄èlFûãrs
);

1469 
I¡
 
i
 = 0; i < 
numH‹iz⁄èlFûãrs
; i ++)

1471 
£iChromaReßm∂ögFûãrHöt
->
m_h‹FûãrC€ff
[
i
].
	`ªsize
(
h‹T≠LígthMöus1
[i]+1);

1473 
£iChromaReßm∂ögFûãrHöt
->
m_h‹FûãrC€ff
[0][0] = 1;

1474 
£iChromaReßm∂ögFûãrHöt
->
m_h‹FûãrC€ff
[0][1] = 6;

1475 
£iChromaReßm∂ögFûãrHöt
->
m_h‹FûãrC€ff
[0][2] = 1;

1479 
£iChromaReßm∂ögFûãrHöt
->
m_h‹FûãrC€ff
.
	`ªsize
(0);

1481 
	}
}

1483 
Void
 
	gSEIEncodî
::
	$öôSEITimeCode
(
SEITimeCode
 *
£iTimeCode
)

1485 
	`as£π
 (
m_isInôülized
);

1486 
	`as£π
 (
£iTimeCode
!=
NULL
);

1488 
£iTimeCode
->
numClockTs
 = 
m_pcCfg
->
	`gëNumbîOfTime£ts
();

1489 
I¡
 
i
 = 0; i < 
£iTimeCode
->
numClockTs
; i++)

1491 
£iTimeCode
->
timeSëAºay
[
i
] = 
m_pcCfg
->
	`gëTimeSë
(i);

1493 
	}
}

1495 
Void
 
	gSEIEncodî
::
	$öôSEIA…î«tiveTøns„rCh¨a˘îi°ics
(
SEIA…î«tiveTøns„rCh¨a˘îi°ics
 *
£iA…TønsCh¨a˘îi°ics
)

1497 
	`as£π
 (
m_isInôülized
);

1498 
	`as£π
 (
£iA…TønsCh¨a˘îi°ics
!=
NULL
);

1500 
£iA…TønsCh¨a˘îi°ics
->
m_¥e„ºedTøns„rCh¨a˘îi°ics
 = 
m_pcCfg
->
	`gëSEIPª„ºedTøns„rCh¨a˘îi°ics
();

1501 
	}
}

1503 
Void
 
	gSEIEncodî
::
	$öôSEIGªíMëad©aInfo
(
SEIGªíMëad©aInfo
 *
£iGªíMëad©aInfo
, 
UI¡
 
u
)

1505 
	`as£π
 (
m_isInôülized
);

1506 
	`as£π
 (
£iGªíMëad©aInfo
!=
NULL
);

1508 
£iGªíMëad©aInfo
->
m_gªíMëad©aTy≥
 = 
m_pcCfg
->
	`gëSEIGªíMëad©aTy≥
();

1509 
£iGªíMëad©aInfo
->
m_xsdMëricTy≥
 = 
m_pcCfg
->
	`gëSEIXSDMëricTy≥
();

1510 
£iGªíMëad©aInfo
->
m_xsdMëricVÆue
 = 
u
;

1511 
	}
}

	@TLibEncoder/SEIEncoder.h

34 #¥agm®
⁄˚


36 #i‚de‡
__SEIENCODER__


37 
	#__SEIENCODER__


	)

39 
	~"TLibComm⁄/SEI.h
"

42 
˛ass
 
	gTEncCfg
;

43 
˛ass
 
	gTEncT›
;

44 
˛ass
 
	gTEncGOP
;

48 ˛as†
	cSEIEncodî


50 
	mpublic
:

51 
	$SEIEncodî
()

52 :
	`m_pcCfg
(
NULL
)

53 ,
	`m_pcEncT›
(
NULL
)

54 ,
	`m_pcEncGOP
(
NULL
)

55 ,
	`m_é0Idx
(0)

56 ,
	`m_øpIdx
(0)

57 ,
	$m_isInôülized
(
Ál£
)

59 
vútuÆ
 ~
	$SEIEncodî
(){
	}
};

61 
Void
 
	$öô
(
TEncCfg
* 
ícCfg
, 
TEncT›
 *
ícT›
, 
TEncGOP
 *
ícGOP
)

63 
m_pcCfg
 = 
ícCfg
;

64 
m_pcEncGOP
 = 
ícGOP
;

65 
m_pcEncT›
 = 
ícT›
;

66 
m_isInôülized
 = 
åue
;

67 
	}
};

70 
Void
 
öôSEIA˘iveP¨amëîSës
 (
SEIA˘iveP¨amëîSës
 *
£i
, c⁄° 
TComVPS
 *
vps
, c⁄° 
TComSPS
 *
•s
);

71 
Void
 
öôSEIFømePackög
(
SEIFømePackög
 *
£i
, 
I¡
 
cuºPicNum
);

72 
Void
 
öôSEIDi•œyOrõ¡©i⁄
(
SEIDi•œyOrõ¡©i⁄
 *
£i
);

73 
Void
 
öôSEIT⁄eM≠pögInfo
(
SEIT⁄eM≠pögInfo
 *
£i
);

74 
Void
 
öôSEISOPDes¸ùti⁄
(
SEISOPDes¸ùti⁄
 *
£i
, 
TComSli˚
 *
¶i˚
, 
I¡
 
picInGOP
, I¡ 
œ°Idr
, I¡ 
cuºGOPSize
);

75 
Void
 
öôSEIBuf„rögPîiod
(
SEIBuf„rögPîiod
 *
£i
, 
TComSli˚
 *
¶i˚
);

76 
Void
 
öôSEISˇœbÀNe°ög
(
SEISˇœbÀNe°ög
 *
£i
, 
SEIMesßges
 &
√°edSEIs
);

77 
Void
 
öôSEIRecovîyPoöt
(
SEIRecovîyPoöt
 *
£i
, 
TComSli˚
 *
¶i˚
);

78 
Void
 
öôSEISegmíãdRe˘FømePackög
(
SEISegmíãdRe˘FømePackög
 *
£i
);

79 
Void
 
öôSEITempMŸi⁄C⁄°øöedTûeSës
 (
SEITempMŸi⁄C⁄°øöedTûeSës
 *
£i
, c⁄° 
TComPPS
 *
µs
);

80 #i‡
MCTS_EXTRACTION


81 
Void
 
öôSEIMCTSExåa˘i⁄Info
(
SEIMCTSExåa˘i⁄InfoSë
 *
£i
, c⁄° 
TComVPS
 *
vps
, c⁄° 
TComSPS
 *
•s
, c⁄° 
TComPPS
 *
µs
);

83 
Void
 
öôSEIK√eFun˘i⁄Info
(
SEIK√eFun˘i⁄Info
 *
£i
);

84 
Void
 
öôSEIC⁄ã¡CﬁourVﬁume
(
SEIC⁄ã¡CﬁourVﬁume
 *
£i
);

85 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


86 
Void
 
öôSEIShuâîI¡îvÆInfo
(
SEIShuâîI¡îvÆInfo
 *
£i
);

88 #i‡
SEI_ENCODER_CONTROL


89 
Void
 
öôSEIFûmGøöCh¨a˘îi°ics
(
SEIFûmGøöCh¨a˘îi°ics
 *
£i
);

90 
Void
 
öôSEIC⁄ã¡LightLevñ
(
SEIC⁄ã¡LightLevñInfo
 *
£i
);

91 
Void
 
öôSEIAmbõ¡VõwögEnvú⁄mít
(
SEIAmbõ¡VõwögEnvú⁄mít
 *
£i
);

93 
Void
 
öôSEIEΩ
(
SEIEquúe˘™guœrProje˘i⁄
 *
£i
);

94 
Void
 
öôSEISphîeRŸ©i⁄
(
SEISphîeRŸ©i⁄
 *
£i
);

95 
Void
 
öôSEIOmniVõwp‹t
(
SEIOmniVõwp‹t
 *
£i
);

96 
Void
 
öôSEICubem≠Proje˘i⁄
(
SEICubem≠Proje˘i⁄
 *
£i
);

97 
Void
 
öôSEIRegi⁄Wi£Packög
(
SEIRegi⁄Wi£Packög
 *
£i
);

98 
Void
 
öôSEIFisheyeVideoInfo
(
SEIFisheyeVideoInfo
 *
£i
);

99 
Void
 
öôSEIChromaReßm∂ögFûãrHöt
(
SEIChromaReßm∂ögFûãrHöt
 *
£i
, 
I¡
 
iH‹FûãrIndex
, I¡ 
iVîFûãrIndex
);

100 
Void
 
öôSEITimeCode
(
SEITimeCode
 *
£i
);

101 
Boﬁ
 
öôSEICﬁourRem≠pögInfo
(
SEICﬁourRem≠pögInfo
 *
£i
, 
I¡
 
cuºPOC
);

102 
Void
 
öôSEIA…î«tiveTøns„rCh¨a˘îi°ics
(
SEIA…î«tiveTøns„rCh¨a˘îi°ics
 *
£i
);

103 
Void
 
ªadT⁄eM≠pögInfoSEI
(
°d
::
i°ªam
 &
fic
, 
SEIT⁄eM≠pögInfo
 *
£iT⁄eM≠pögInfo
 , 
Boﬁ
 &
Áûed
 );

104 
Void
 
ªadChromaReßm∂ögFûãrHötSEI
(
°d
::
i°ªam
 &
fic
, 
SEIChromaReßm∂ögFûãrHöt
 *
£iChromaReßm∂ögFûãrHöt
, 
Boﬁ
 &
Áûed
 );

105 
Void
 
ªadK√eFun˘i⁄InfoSEI
(
°d
::
i°ªam
 &
fic
, 
SEIK√eFun˘i⁄Info
 *
£iK√eFun˘i⁄Info
, 
Boﬁ
 &
Áûed
 );

106 
Void
 
ªadCﬁourRem≠SEI
(
°d
::
i°ªam
 &
fic
, 
SEICﬁourRem≠pögInfo
 *
£iCﬁ‹Rem≠pögInfo
, 
Boﬁ
 &
Áûed
 );

107 
Void
 
ªadC⁄ã¡CﬁourVﬁumeSEI
(
°d
::
i°ªam
 &
fic
, 
SEIC⁄ã¡CﬁourVﬁume
 *
£iC⁄ã¡CﬁourVﬁume
, 
Boﬁ
 &
Áûed
 );

108 
Boﬁ
 
öôSEIRegi⁄ÆNe°ög
(
SEIRegi⁄ÆNe°ög
 *
£i
, 
I¡
 
cuºPOC
);

109 
Void
 
ªadRNSEIWödow
(
°d
::
i°ªam
 &
fic
, 
RNSEIWödowVec
::
ôî©‹
 
ªgi⁄Iãr
, 
Boﬁ
 &
Áûed
 );

110 
Boﬁ
 
öôSEIA¬Ÿ©edRegi⁄s
(
SEIA¬Ÿ©edRegi⁄s
 *
£i
, 
I¡
 
cuºPOC
);

111 
Void
 
ªadA¬Ÿ©edRegi⁄SEI
(
°d
::
i°ªam
 &
fic
, 
SEIA¬Ÿ©edRegi⁄s
 *
£iA¬oRegi⁄
, 
Boﬁ
 &
Áûed
);

113 
Void
 
öôDecodedPi˘uªHashSEI
(
SEIDecodedPi˘uªHash
 *
£i
, 
TComPic
 *
pcPic
, 
°d
::
°rög
 &
rHashSåög
, c⁄° 
BôDïths
 &
bôDïths
);

114 
Void
 
öôTemp‹ÆLevñ0IndexSEI
(
SEITemp‹ÆLevñ0Index
 *
£i
, 
TComSli˚
 *
¶i˚
);

115 
Void
 
öôSEIGªíMëad©aInfo
(
SEIGªíMëad©aInfo
 *
£i
, 
UI¡
 
u
);

117 
	g¥iv©e
:

118 
TEncCfg
* 
m_pcCfg
;

119 
TEncT›
* 
	gm_pcEncT›
;

120 
TEncGOP
* 
	gm_pcEncGOP
;

123 
UI¡
 
	gm_é0Idx
;

124 
UI¡
 
	gm_øpIdx
;

126 
Boﬁ
 
	gm_isInôülized
;

	@TLibEncoder/SEIwrite.cpp

34 
	~"TLibComm⁄/TComBôCou¡î.h
"

35 
	~"TLibComm⁄/TComBôSåóm.h
"

36 
	~"TLibComm⁄/SEI.h
"

37 
	~"TLibComm⁄/TComSli˚.h
"

38 
	~"TLibComm⁄/TComPicYuv.h
"

39 
	~"SEIwrôe.h
"

44 #i‡
ENC_DEC_TRACE


45 
Void
 
	$xTø˚SEIHódî
()

47 
	`Ârötf
–
g_hTø˚
, "=========== SEI message ===========\n");

48 
	}
}

50 
Void
 
	$xTø˚SEIMesßgeTy≥
(
SEI
::
PaylﬂdTy≥
 
∑ylﬂdTy≥
)

52 
	`Ârötf
–
g_hTø˚
, "==========%†SEI mesßgê===========\n", 
SEI
::
	`gëSEIMesßgeSåög
(
∑ylﬂdTy≥
));

53 
	}
}

56 
Void
 
	gSEIWrôî
::
	$xWrôeSEI∑ylﬂdD©a
(
TComBôIf
& 
bs
, c⁄° 
SEI
& 
£i
, c⁄° 
TComSPS
 *
•s
)

58 
£i
.
	`∑ylﬂdTy≥
())

60 
SEI
::
BUFFERING_PERIOD
:

61 
	`xWrôeSEIBuf„rögPîiod
(*
°©ic_ˇ°
<c⁄° 
SEIBuf„rögPîiod
*>(&
£i
), 
•s
);

63 
SEI
::
PICTURE_TIMING
:

64 
	`xWrôeSEIPi˘uªTimög
(*
°©ic_ˇ°
<c⁄° 
SEIPi˘uªTimög
*>(&
£i
), 
•s
);

66 
SEI
::
PAN_SCAN_RECT
:

67 
	`xWrôeSEIP™SˇnRe˘
(*
°©ic_ˇ°
<c⁄° 
SEIP™SˇnRe˘
*>(&
£i
));

69 
SEI
::
FILLER_PAYLOAD
:

70 
	`xWrôeSEIFûÀrPaylﬂd
(*
°©ic_ˇ°
<c⁄° 
SEIFûÀrPaylﬂd
*>(&
£i
));

72 
SEI
::
USER_DATA_REGISTERED_ITU_T_T35
:

73 
	`xWrôeSEIU£rD©aRegi°îed
(*
°©ic_ˇ°
<c⁄° 
SEIU£rD©aRegi°îed
*>(&
£i
));

75 
SEI
::
USER_DATA_UNREGISTERED
:

76 
	`xWrôeSEIU£rD©aUƒegi°îed
(*
°©ic_ˇ°
<c⁄° 
SEIU£rD©aUƒegi°îed
*>(&
£i
));

78 
SEI
::
RECOVERY_POINT
:

79 
	`xWrôeSEIRecovîyPoöt
(*
°©ic_ˇ°
<c⁄° 
SEIRecovîyPoöt
*>(&
£i
));

81 
SEI
::
SCENE_INFO
:

82 
	`xWrôeSEIS˚√Info
(*
°©ic_ˇ°
<c⁄° 
SEIS˚√Info
*>(&
£i
));

84 
SEI
::
PICTURE_SNAPSHOT
:

85 
	`xWrôeSEIPi˘uªS«pshŸ
(*
°©ic_ˇ°
<c⁄° 
SEIPi˘uªS«pshŸ
*>(&
£i
));

87 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_START
:

88 
	`xWrôeSEIProgªssiveReföemítSegmítSèπ
(*
°©ic_ˇ°
<c⁄° 
SEIProgªssiveReföemítSegmítSèπ
*>(&
£i
));

90 
SEI
::
PROGRESSIVE_REFINEMENT_SEGMENT_END
:

91 
	`xWrôeSEIProgªssiveReföemítSegmítEnd
(*
°©ic_ˇ°
<c⁄° 
SEIProgªssiveReföemítSegmítEnd
*>(&
£i
));

93 
SEI
::
FILM_GRAIN_CHARACTERISTICS
:

94 
	`xWrôeSEIFûmGøöCh¨a˘îi°ics
(*
°©ic_ˇ°
<c⁄° 
SEIFûmGøöCh¨a˘îi°ics
*>(&
£i
));

96 
SEI
::
POST_FILTER_HINT
:

97 
	`xWrôeSEIPo°FûãrHöt
(*
°©ic_ˇ°
<c⁄° 
SEIPo°FûãrHöt
*>(&
£i
), 
•s
);

99 
SEI
::
TONE_MAPPING_INFO
:

100 
	`xWrôeSEIT⁄eM≠pögInfo
(*
°©ic_ˇ°
<c⁄° 
SEIT⁄eM≠pögInfo
*>(&
£i
));

102 
SEI
::
FRAME_PACKING
:

103 
	`xWrôeSEIFømePackög
(*
°©ic_ˇ°
<c⁄° 
SEIFømePackög
*>(&
£i
));

105 
SEI
::
DISPLAY_ORIENTATION
:

106 
	`xWrôeSEIDi•œyOrõ¡©i⁄
(*
°©ic_ˇ°
<c⁄° 
SEIDi•œyOrõ¡©i⁄
*>(&
£i
));

108 
SEI
::
GREEN_METADATA
:

109 
	`xWrôeSEIGªíMëad©aInfo
(*
°©ic_ˇ°
<c⁄° 
SEIGªíMëad©aInfo
*>(&
£i
));

111 
SEI
::
SOP_DESCRIPTION
:

112 
	`xWrôeSEISOPDes¸ùti⁄
(*
°©ic_ˇ°
<c⁄° 
SEISOPDes¸ùti⁄
*>(&
£i
));

114 
SEI
::
ACTIVE_PARAMETER_SETS
:

115 
	`xWrôeSEIA˘iveP¨amëîSës
(*
°©ic_ˇ°
<c⁄° 
SEIA˘iveP¨amëîSës
*>(& 
£i
));

117 
SEI
::
DECODING_UNIT_INFO
:

118 
	`xWrôeSEIDecodögUnôInfo
(*
°©ic_ˇ°
<c⁄° 
SEIDecodögUnôInfo
*>(& 
£i
), 
•s
);

120 
SEI
::
TEMPORAL_LEVEL0_INDEX
:

121 
	`xWrôeSEITemp‹ÆLevñ0Index
(*
°©ic_ˇ°
<c⁄° 
SEITemp‹ÆLevñ0Index
*>(&
£i
));

123 
SEI
::
DECODED_PICTURE_HASH
:

124 
	`xWrôeSEIDecodedPi˘uªHash
(*
°©ic_ˇ°
<c⁄° 
SEIDecodedPi˘uªHash
*>(&
£i
));

126 
SEI
::
SCALABLE_NESTING
:

127 
	`xWrôeSEISˇœbÀNe°ög
(
bs
, *
°©ic_ˇ°
<c⁄° 
SEISˇœbÀNe°ög
*>(&
£i
), 
•s
);

129 
SEI
::
REGION_REFRESH_INFO
:

130 
	`xWrôeSEIRegi⁄Re‰eshInfo
(*
°©ic_ˇ°
<c⁄° 
SEIRegi⁄Re‰eshInfo
*>(&
£i
));

132 
SEI
::
NO_DISPLAY
:

133 
	`xWrôeSEINoDi•œy
(*
°©ic_ˇ°
<c⁄° 
SEINoDi•œy
*>(&
£i
));

135 
SEI
::
TIME_CODE
:

136 
	`xWrôeSEITimeCode
(*
°©ic_ˇ°
<c⁄° 
SEITimeCode
*>(&
£i
));

138 
SEI
::
MASTERING_DISPLAY_COLOUR_VOLUME
:

139 
	`xWrôeSEIMa°îögDi•œyCﬁourVﬁume
(*
°©ic_ˇ°
<c⁄° 
SEIMa°îögDi•œyCﬁourVﬁume
*>(&
£i
));

141 
SEI
::
SEGM_RECT_FRAME_PACKING
:

142 
	`xWrôeSEISegmíãdRe˘FømePackög
(*
°©ic_ˇ°
<c⁄° 
SEISegmíãdRe˘FømePackög
*>(&
£i
));

144 
SEI
::
TEMP_MOTION_CONSTRAINED_TILE_SETS
:

145 
	`xWrôeSEITempMŸi⁄C⁄°øöedTûeSës
(*
°©ic_ˇ°
<c⁄° 
SEITempMŸi⁄C⁄°øöedTûeSës
*>(&
£i
));

147 #i‡
MCTS_EXTRACTION


148 
SEI
::
MCTS_EXTRACTION_INFO_SET
:

149 
	`xWrôeSEIMCTSExåa˘i⁄InfoSë
(*
°©ic_ˇ°
<c⁄° 
SEIMCTSExåa˘i⁄InfoSë
*>(&
£i
));

152 
SEI
::
CHROMA_RESAMPLING_FILTER_HINT
:

153 
	`xWrôeSEIChromaReßm∂ögFûãrHöt
(*
°©ic_ˇ°
<c⁄° 
SEIChromaReßm∂ögFûãrHöt
*>(&
£i
));

155 
SEI
::
KNEE_FUNCTION_INFO
:

156 
	`xWrôeSEIK√eFun˘i⁄Info
(*
°©ic_ˇ°
<c⁄° 
SEIK√eFun˘i⁄Info
*>(&
£i
));

158 
SEI
::
COLOUR_REMAPPING_INFO
:

159 
	`xWrôeSEICﬁourRem≠pögInfo
(*
°©ic_ˇ°
<c⁄° 
SEICﬁourRem≠pögInfo
*>(&
£i
));

161 
SEI
::
DEINTERLACE_FIELD_IDENTIFICATION
:

162 
	`xWrôeSEIDeöãæa˚FõldIdítifiˇti⁄
(*
°©ic_ˇ°
<c⁄° 
SEIDeöãæa˚FõldIdítifiˇti⁄
*>(&
£i
));

164 
SEI
::
CONTENT_LIGHT_LEVEL_INFO
:

165 
	`xWrôeSEIC⁄ã¡LightLevñInfo
(*
°©ic_ˇ°
<c⁄° 
SEIC⁄ã¡LightLevñInfo
*>(&
£i
));

167 
SEI
::
DEPENDENT_RAP_INDICATION
:

168 
	`xWrôeSEIDïídítRAPIndiˇti⁄
(*
°©ic_ˇ°
<c⁄° 
SEIDïídítRAPIndiˇti⁄
*>(&
£i
));

170 
SEI
::
CODED_REGION_COMPLETION
:

171 
	`xWrôeSEICodedRegi⁄Com∂ëi⁄
(*
°©ic_ˇ°
<c⁄° 
SEICodedRegi⁄Com∂ëi⁄
*>(&
£i
));

173 
SEI
::
ALTERNATIVE_TRANSFER_CHARACTERISTICS
:

174 
	`xWrôeSEIA…î«tiveTøns„rCh¨a˘îi°ics
(*
°©ic_ˇ°
<c⁄° 
SEIA…î«tiveTøns„rCh¨a˘îi°ics
*>(&
£i
));

176 
SEI
::
AMBIENT_VIEWING_ENVIRONMENT
:

177 
	`xWrôeSEIAmbõ¡VõwögEnvú⁄mít
(*
°©ic_ˇ°
<c⁄° 
SEIAmbõ¡VõwögEnvú⁄mít
*>(&
£i
));

179 
SEI
::
CONTENT_COLOUR_VOLUME
:

180 
	`xWrôeSEIC⁄ã¡CﬁourVﬁume
(*
°©ic_ˇ°
<c⁄° 
SEIC⁄ã¡CﬁourVﬁume
*>(&
£i
));

182 
SEI
::
EQUIRECTANGULAR_PROJECTION
:

183 
	`xWrôeSEIEquúe˘™guœrProje˘i⁄
(*
°©ic_ˇ°
<c⁄° 
SEIEquúe˘™guœrProje˘i⁄
*>(&
£i
));

185 
SEI
::
SPHERE_ROTATION
:

186 
	`xWrôeSEISphîeRŸ©i⁄
(*
°©ic_ˇ°
<c⁄° 
SEISphîeRŸ©i⁄
*>(&
£i
));

188 
SEI
::
OMNI_VIEWPORT
:

189 
	`xWrôeSEIOmniVõwp‹t
(*
°©ic_ˇ°
<c⁄° 
SEIOmniVõwp‹t
*>(&
£i
));

191 
SEI
::
CUBEMAP_PROJECTION
:

192 
	`xWrôeSEICubem≠Proje˘i⁄
(*
°©ic_ˇ°
<c⁄° 
SEICubem≠Proje˘i⁄
*>(&
£i
));

194 
SEI
::
REGION_WISE_PACKING
:

195 
	`xWrôeSEIRegi⁄Wi£Packög
(*
°©ic_ˇ°
<c⁄° 
SEIRegi⁄Wi£Packög
*>(&
£i
));

197 
SEI
::
FISHEYE_VIDEO_INFO
:

198 
	`xWrôeSEIFisheyeVideoInfo
(*
°©ic_ˇ°
<c⁄° 
SEIFisheyeVideoInfo
*>(&
£i
));

200 
SEI
::
REGIONAL_NESTING
:

201 
	`xWrôeSEIRegi⁄ÆNe°ög
(
bs
, *
°©ic_ˇ°
<c⁄° 
SEIRegi⁄ÆNe°ög
*>(&
£i
), 
•s
);

204 
SEI
::
ANNOTATED_REGIONS
:

205 
	`xWrôeSEIA¬Ÿ©edRegi⁄s
(*
°©ic_ˇ°
<c⁄° 
SEIA¬Ÿ©edRegi⁄s
*>(&
£i
), 
•s
);

208 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


209 
SEI
::
SHUTTER_INTERVAL_INFO
:

210 
	`xWrôeSEIShuâîI¡îvÆ
(*
°©ic_ˇ°
<c⁄° 
SEIShuâîI¡îvÆInfo
*>(&
£i
));

214 
	`as£π
(!"TryingÅo write unhandled SEI message");

217 
	`xWrôeByãAlign
();

218 
	}
}

223 
Void
 
	gSEIWrôî
::
	$wrôeSEImesßges
(
TComBôIf
& 
bs
, c⁄° 
SEIMesßges
 &
£iLi°
, c⁄° 
TComSPS
 *
•s
, 
Boﬁ
 
isNe°ed
)

225 #i‡
ENC_DEC_TRACE


226 i‡(
g_HLSTø˚E«bÀ
)

227 
	`xTø˚SEIHódî
();

230 
TComBôCou¡î
 
bs_cou¡
;

232 
SEIMesßges
::
c⁄°_ôî©‹
 
£i
=
£iLi°
.
	`begö
(); sei!=£iLi°.
	`íd
(); sei++)

234 
	`xWrôeSEImesßge
(
bs
, *
£i
, 
•s
);

236 i‡(!
isNe°ed
)

238 
	`xWrôeRb•TøûögBôs
();

240 
	}
}

242 
Void
 
	gSEIWrôî
::
	$xWrôeSEImesßge
(
TComBôIf
& 
bs
, c⁄° 
SEI
 *
£i
, c⁄° 
TComSPS
 *
•s
)

244 #i‡
ENC_DEC_TRACE


245 i‡(
g_HLSTø˚E«bÀ
)

246 
	`xTø˚SEIHódî
();

249 
TComBôCou¡î
 
bs_cou¡
;

253 
bs_cou¡
.
	`ª£tBôs
();

254 
	`£tBô°ªam
(&
bs_cou¡
);

256 #i‡
ENC_DEC_TRACE


257 
Boﬁ
 
åa˚E«bÀ
 = 
g_HLSTø˚E«bÀ
;

258 
g_HLSTø˚E«bÀ
 = 
Ál£
;

260 
	`xWrôeSEI∑ylﬂdD©a
(
bs_cou¡
, *
£i
, 
•s
);

261 #i‡
ENC_DEC_TRACE


262 
g_HLSTø˚E«bÀ
 = 
åa˚E«bÀ
;

264 
UI¡
 
∑ylﬂd_d©a_num_bôs
 = 
bs_cou¡
.
	`gëNumbîOfWrôãnBôs
();

265 
	`as£π
(0 =
∑ylﬂd_d©a_num_bôs
 % 8);

267 
	`£tBô°ªam
(&
bs
);

268 
UI¡
 
∑ylﬂdTy≥
 = 
£i
->
	`∑ylﬂdTy≥
();

269 ; 
∑ylﬂdTy≥
 >= 0xff;ÖayloadType -= 0xff)

271 
	`WRITE_CODE
(0xff, 8, "payload_type");

273 
	`WRITE_CODE
(
∑ylﬂdTy≥
, 8, "payload_type");

275 
UI¡
 
∑ylﬂdSize
 = 
∑ylﬂd_d©a_num_bôs
/8;

276 ; 
∑ylﬂdSize
 >= 0xff;ÖayloadSize -= 0xff)

278 
	`WRITE_CODE
(0xff, 8, "payload_size");

280 
	`WRITE_CODE
(
∑ylﬂdSize
, 8, "payload_size");

283 #i‡
ENC_DEC_TRACE


284 i‡(
g_HLSTø˚E«bÀ
)

285 #i‡
MCTS_EXTRACTION


286 
	`xTø˚SEIMesßgeTy≥
(
£i
->
	`∑ylﬂdTy≥
());

293 
	`xWrôeSEI∑ylﬂdD©a
(
bs
, *
£i
, 
•s
);

294 
	}
}

296 
Void
 
	gSEIWrôî
::
	$xWrôeSEIBuf„rögPîiod
(c⁄° 
SEIBuf„rögPîiod
& 
£i
, c⁄° 
TComSPS
 *
•s
)

298 
I¡
 
i
, 
«lOrV˛
;

299 c⁄° 
TComVUI
 *
vui
 = 
•s
->
	`gëVuiP¨amëîs
();

300 c⁄° 
TComHRD
 *
hrd
 = 
vui
->
	`gëHrdP¨amëîs
();

302 
	`WRITE_UVLC
–
£i
.
m_bpSeqP¨amëîSëId
, "bp_seq_parameter_set_id" );

303 if–!
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

305 
	`WRITE_FLAG
–
£i
.
m_øpCpbP¨amsPª£¡Fœg
, "irap_cpb_params_present_flag" );

307 if–
£i
.
m_øpCpbP¨amsPª£¡Fœg
 )

309 
	`WRITE_CODE
–
£i
.
m_˝bDñayOff£t
, 
hrd
->
	`gëCpbRemovÆDñayLígthMöus1
() + 1, "cpb_delay_offset" );

310 
	`WRITE_CODE
–
£i
.
m_dpbDñayOff£t
, 
hrd
->
	`gëDpbOuçutDñayLígthMöus1
() + 1, "dpb_delay_offset" );

312 
	`WRITE_FLAG
–
£i
.
m_c⁄ˇã«ti⁄Fœg
, "concatenation_flag");

313 
	`WRITE_CODE
–
£i
.
m_auCpbRemovÆDñayDñè
 - 1, ( 
hrd
->
	`gëCpbRemovÆDñayLígthMöus1
() + 1 ), "au_cpb_removal_delay_delta_minus1" );

314  
«lOrV˛
 = 0;ÇalOrVcl < 2;ÇalOrVcl ++ )

316 if–––
«lOrV˛
 =0 ) && ( 
hrd
->
	`gëNÆHrdP¨amëîsPª£¡Fœg
() ) ) ||

317 ––
«lOrV˛
 =1 ) && ( 
hrd
->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() ) ) )

319  
i
 = 0; i < ( 
hrd
->
	`gëCpbC¡Möus1
( 0 ) + 1 ); i ++ )

321 
	`WRITE_CODE
–
£i
.
m_öôülCpbRemovÆDñay
[
i
][
«lOrV˛
],–
hrd
->
	`gëInôülCpbRemovÆDñayLígthMöus1
() + 1 ) , "initial_cpb_removal_delay" );

322 
	`WRITE_CODE
–
£i
.
m_öôülCpbRemovÆDñayOff£t
[
i
][
«lOrV˛
],–
hrd
->
	`gëInôülCpbRemovÆDñayLígthMöus1
() + 1 ), "initial_cpb_removal_delay_offset" );

323 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
(Ë|| 
£i
.
m_øpCpbP¨amsPª£¡Fœg
 )

325 
	`WRITE_CODE
–
£i
.
m_öôülA…CpbRemovÆDñay
[
i
][
«lOrV˛
], ( 
hrd
->
	`gëInôülCpbRemovÆDñayLígthMöus1
() + 1 ) , "initial_alt_cpb_removal_delay" );

326 
	`WRITE_CODE
–
£i
.
m_öôülA…CpbRemovÆDñayOff£t
[
i
][
«lOrV˛
], ( 
hrd
->
	`gëInôülCpbRemovÆDñayLígthMöus1
() + 1 ),"initial_alt_cpb_removal_delay_offset" );

331 
	}
}

334 
Void
 
	gSEIWrôî
::
	$xWrôeSEIPi˘uªTimög
(c⁄° 
SEIPi˘uªTimög
& 
£i
, c⁄° 
TComSPS
 *
•s
)

336 
I¡
 
i
;

337 c⁄° 
TComVUI
 *
vui
 = 
•s
->
	`gëVuiP¨amëîs
();

338 c⁄° 
TComHRD
 *
hrd
 = 
vui
->
	`gëHrdP¨amëîs
();

340 if–
vui
->
	`gëFømeFõldInfoPª£¡Fœg
() )

342 
	`WRITE_CODE
–
£i
.
m_picSåu˘
, 4, "pic_struct" );

343 
	`WRITE_CODE
–
£i
.
m_sour˚SˇnTy≥
, 2, "source_scan_type" );

344 
	`WRITE_FLAG
–
£i
.
m_du∂iˇãFœg
 ? 1 : 0, "duplicate_flag" );

347 if–
hrd
->
	`gëCpbDpbDñaysPª£¡Fœg
() )

349 
	`WRITE_CODE
–
£i
.
m_auCpbRemovÆDñay
 - 1, ( 
hrd
->
	`gëCpbRemovÆDñayLígthMöus1
() + 1 ), "au_cpb_removal_delay_minus1" );

350 
	`WRITE_CODE
–
£i
.
m_picDpbOuçutDñay
, ( 
hrd
->
	`gëDpbOuçutDñayLígthMöus1
() + 1 ), "pic_dpb_output_delay" );

351 if(
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
())

353 
	`WRITE_CODE
(
£i
.
m_picDpbOuçutDuDñay
, 
hrd
->
	`gëDpbOuçutDñayDuLígthMöus1
()+1, "pic_dpb_output_du_delay" );

355 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
(Ë&& hrd->
	`gëSubPicCpbP¨amsInPicTimögSEIFœg
() )

357 
	`WRITE_UVLC
–
£i
.
m_numDecodögUnôsMöus1
, "num_decoding_units_minus1" );

358 
	`WRITE_FLAG
–
£i
.
m_duComm⁄CpbRemovÆDñayFœg
, "du_common_cpb_removal_delay_flag" );

359 if–
£i
.
m_duComm⁄CpbRemovÆDñayFœg
 )

361 
	`WRITE_CODE
–
£i
.
m_duComm⁄CpbRemovÆDñayMöus1
, ( 
hrd
->
	`gëDuCpbRemovÆDñayLígthMöus1
() + 1 ), "du_common_cpb_removal_delay_minus1" );

363  
i
 = 0; i <
£i
.
m_numDecodögUnôsMöus1
; i ++ )

365 
	`WRITE_UVLC
–
£i
.
m_numNÆusInDuMöus1
[ 
i
 ], "num_nalus_in_du_minus1");

366 if––!
£i
.
m_duComm⁄CpbRemovÆDñayFœg
 ) && ( 
i
 < sei.
m_numDecodögUnôsMöus1
 ) )

368 
	`WRITE_CODE
–
£i
.
m_duCpbRemovÆDñayMöus1
[ 
i
 ], ( 
hrd
->
	`gëDuCpbRemovÆDñayLígthMöus1
() + 1 ), "du_cpb_removal_delay_minus1" );

373 
	}
}

376 
Void
 
	gSEIWrôî
::
	$xWrôeSEIP™SˇnRe˘
(c⁄° 
SEIP™SˇnRe˘
 &
£i
)

378 
	`WRITE_UVLC
–
£i
.
m_∑nSˇnRe˘Id
, "pan_scan_rect_id" );

379 c⁄° 
UI¡
 
numRegi⁄s
 = (UI¡Ë
£i
.
m_∑nSˇnRe˘Regi⁄s
.
	`size
();

380 i‡–!
£i
.
m_∑nSˇnRe˘C™˚lFœg
 && 
numRegi⁄s
>0 )

382 
	`WRITE_FLAG
–
£i
.
m_∑nSˇnRe˘C™˚lFœg
, "pan_scan_rect_cancel_flag" );

383 
	`WRITE_UVLC
–
numRegi⁄s
 - 1, "pan_scan_cnt_minus1" );

384 
UI¡
 
ªgi⁄
=0;Ñegi⁄<
numRegi⁄s
;Ñegion++)

386 c⁄° 
SEIP™SˇnRe˘
::
P™SˇnRe˘
 &
ª˘
=
£i
.
m_∑nSˇnRe˘Regi⁄s
[
ªgi⁄
];

387 
	`WRITE_SVLC
–
ª˘
.
À·Off£t
, "pan_scan_rect_left_offset[i]" );

388 
	`WRITE_SVLC
–
ª˘
.
rightOff£t
, "pan_scan_rect_rioht_offset[i]" );

389 
	`WRITE_SVLC
–
ª˘
.
t›Off£t
, "pan_scan_rect_top_offset[i]" );

390 
	`WRITE_SVLC
–
ª˘
.
bŸtomOff£t
, "pan_scan_rect_bottom_offset[i]" );

392 
	`WRITE_FLAG
–
£i
.
m_∑nSˇnRe˘Pîsi°í˚Fœg
, "pan_scan_rect_persistence_flag" );

394 
	}
}

397 
Void
 
	gSEIWrôî
::
	$xWrôeSEIFûÀrPaylﬂd
(c⁄° 
SEIFûÀrPaylﬂd
 &
£i
)

399 
UI¡
 
k
=0; k<
£i
.
m_numFûÀrFFByãs
; k++)

401 
	`WRITE_CODE
( 0xff, 8, "ff_byte" );

403 
	}
}

406 
Void
 
	gSEIWrôî
::
	$xWrôeSEIU£rD©aRegi°îed
(c⁄° 
SEIU£rD©aRegi°îed
 &
£i
)

408 
	`WRITE_CODE
–(
£i
.
m_ôuCou¡ryCode
>255) ? 0xff : sei.m_ituCountryCode, 8, "itu_t_t35_country_code" );

409 i‡(
£i
.
m_ôuCou¡ryCode
>=255)

411 
	`as£π
(
£i
.
m_ôuCou¡ryCode
 < 255+256);

412 
	`WRITE_CODE
–
£i
.
m_ôuCou¡ryCode
-255, 8, "itu_t_t35_country_code_extension_byte" );

414 
UI¡
 
i
=0; i<
£i
.
m_u£rD©a
.
	`size
(); i++)

416 
	`WRITE_CODE
–
£i
.
m_u£rD©a
[
i
], 8, "itu_t_t35_payload_byte" );

418 
	}
}

421 
Void
 
	gSEIWrôî
::
	$xWrôeSEIU£rD©aUƒegi°îed
(c⁄° 
SEIU£rD©aUƒegi°îed
 &
£i
)

423 
UI¡
 
i
 = 0; i < 
ISO_IEC_11578_LEN
; i++)

425 
	`WRITE_CODE
(
£i
.
m_uuid_iso_õc_11578
[
i
], 8 , "sei.uuid_iso_iec_11578[i]");

428 
°d
::
size_t
 
i
 = 0; i < 
£i
.
m_u£rD©a
.
	`size
(); i++)

430 
	`WRITE_CODE
(
£i
.
m_u£rD©a
[
i
], 8 , "user_data");

432 
	}
}

435 
Void
 
	gSEIWrôî
::
	$xWrôeSEIRecovîyPoöt
(c⁄° 
SEIRecovîyPoöt
& 
£i
)

437 
	`WRITE_SVLC
–
£i
.
m_ªcovîyPocC¡
, "recovery_poc_cnt" );

438 
	`WRITE_FLAG
–
£i
.
m_exa˘M©chögFœg
, "exact_matching_flag" );

439 
	`WRITE_FLAG
–
£i
.
m_brokíLökFœg
, "broken_link_flag" );

440 
	}
}

443 
Void
 
	gSEIWrôî
::
	$xWrôeSEIS˚√Info
(c⁄° 
SEIS˚√Info
 &
£i
)

445 
	`WRITE_FLAG
–
£i
.
m_bS˚√InfoPª£¡Fœg
, "scene_info_present_flag" );

446 i‡(
£i
.
m_bS˚√InfoPª£¡Fœg
)

448 
	`WRITE_FLAG
–
£i
.
m_bPªvS˚√IdVÆidFœg
, "prev_scene_id_valid_flag" );

449 
	`WRITE_UVLC
–
£i
.
m_s˚√Id
, "scene_id" );

450 
	`WRITE_UVLC
–
£i
.
m_s˚√Tønsôi⁄Ty≥
, "scene_transition_type" );

451 i‡(
£i
.
m_s˚√Tønsôi⁄Ty≥
 > 3)

453 
	`WRITE_UVLC
–
£i
.
m_£c⁄dS˚√Id
, "second_scene_id" );

456 
	}
}

459 
Void
 
	gSEIWrôî
::
	$xWrôeSEIPi˘uªS«pshŸ
(c⁄° 
SEIPi˘uªS«pshŸ
 &
£i
)

461 
	`WRITE_UVLC
–
£i
.
m_¢≠shŸId
, "snapshot_id" );

462 
	}
}

465 
Void
 
	gSEIWrôî
::
	$xWrôeSEIProgªssiveReföemítSegmítSèπ
(c⁄° 
SEIProgªssiveReföemítSegmítSèπ
 &
£i
)

467 
	`WRITE_UVLC
–
£i
.
m_¥ogªssiveReföemítId
, "progressive_refinement_id" );

468 
	`WRITE_UVLC
–
£i
.
m_picOrdîC¡Dñè
, "pic_order_cnt_delta" );

469 
	}
}

472 
Void
 
	gSEIWrôî
::
	$xWrôeSEIProgªssiveReföemítSegmítEnd
(c⁄° 
SEIProgªssiveReföemítSegmítEnd
 &
£i
)

474 
	`WRITE_UVLC
–
£i
.
m_¥ogªssiveReföemítId
, "progressive_refinement_id" );

475 
	}
}

478 
Void
 
	gSEIWrôî
::
	$xWrôeSEIFûmGøöCh¨a˘îi°ics
(c⁄° 
SEIFûmGøöCh¨a˘îi°ics
 &
£i
)

480 
	`WRITE_FLAG
–
£i
.
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
, "film_grain_characteristics_cancel_flag" );

481 i‡(!
£i
.
m_fûmGøöCh¨a˘îi°icsC™˚lFœg
)

483 
	`WRITE_CODE
–
£i
.
m_fûmGøöModñId
, 2, "film_grain_model_id" );

484 
	`WRITE_FLAG
–
£i
.
m_£∑øãCﬁourDes¸ùti⁄Pª£¡Fœg
, "separate_colour_description_present_flag" );

485 i‡(
£i
.
m_£∑øãCﬁourDes¸ùti⁄Pª£¡Fœg
)

487 
	`WRITE_CODE
–
£i
.
m_fûmGøöBôDïthLumaMöus8
, 3, "film_grain_bit_depth_luma_minus8" );

488 
	`WRITE_CODE
–
£i
.
m_fûmGøöBôDïthChromaMöus8
, 3, "film_grain_bit_depth_chroma_minus8" );

489 
	`WRITE_FLAG
–
£i
.
m_fûmGøöFuŒR™geFœg
, "film_grain_full_range_flag" );

490 
	`WRITE_CODE
–
£i
.
m_fûmGøöCﬁourPrim¨õs
, 8, "film_grain_colour_primaries" );

491 
	`WRITE_CODE
–
£i
.
m_fûmGøöTøns„rCh¨a˘îi°ics
, 8, "film_grain_transfer_characteristics" );

492 
	`WRITE_CODE
–
£i
.
m_fûmGøöM©rixC€ffs
, 8, "film_grain_matrix_coeffs" );

494 
	`WRITE_CODE
–
£i
.
m_bÀndögModeId
, 2, "blending_mode_id" );

495 
	`WRITE_CODE
–
£i
.
m_log2SˇÀFa˘‹
, 4, "log2_scale_factor" );

496 
I¡
 
c
=0; c<3; c++)

498 c⁄° 
SEIFûmGøöCh¨a˘îi°ics
::
CompModñ
 &
cm
=
£i
.
m_compModñ
[
c
];

499 c⁄° 
UI¡
 
numI¡ísôyI¡îvÆs
 = (UI¡Ë
cm
.
öãnsôyVÆues
.
	`size
();

500 c⁄° 
UI¡
 
numModñVÆues
 = 
cm
.numModelValues;

501 
	`WRITE_FLAG
–
£i
.
m_compModñ
[
c
].
bPª£¡Fœg
 && 
numI¡ísôyI¡îvÆs
>0 && 
numModñVÆues
>0, "comp_model_present_flag[c]" );

503 
I¡
 
c
=0; c<3; c++)

505 c⁄° 
SEIFûmGøöCh¨a˘îi°ics
::
CompModñ
 &
cm
=
£i
.
m_compModñ
[
c
];

506 c⁄° 
UI¡
 
numI¡ísôyI¡îvÆs
 = (UI¡Ë
cm
.
öãnsôyVÆues
.
	`size
();

507 c⁄° 
UI¡
 
numModñVÆues
 = 
cm
.numModelValues;

508 i‡(
cm
.
bPª£¡Fœg
 && 
numI¡ísôyI¡îvÆs
>0 && 
numModñVÆues
>0)

510 
	`as£π
(
numI¡ísôyI¡îvÆs
<=256);

511 
	`as£π
(
numModñVÆues
<=8);

512 
	`WRITE_CODE
–
numI¡ísôyI¡îvÆs
-1, 8, "num_intensity_intervals_minus1[c]");

513 
	`WRITE_CODE
–
numModñVÆues
-1, 3, "num_model_values_minus1[c]");

514 
UI¡
 
öãrvÆ
=0; i¡îvÆ<
numI¡ísôyI¡îvÆs
; interval++)

516 c⁄° 
SEIFûmGøöCh¨a˘îi°ics
::
CompModñI¡ísôyVÆues
 &
cmiv
=
cm
.
öãnsôyVÆues
[
öãrvÆ
];

517 
	`WRITE_CODE
–
cmiv
.
öãnsôyI¡îvÆLowîBound
, 8, "intensity_interval_lower_bound[c][i]" );

518 
	`WRITE_CODE
–
cmiv
.
öãnsôyI¡îvÆUµîBound
, 8, "intensity_interval_upper_bound[c][i]" );

519 
	`as£π
(
cmiv
.
compModñVÆue
.
	`size
(Ë=
numModñVÆues
);

520 
UI¡
 
j
=0; j<
cm
.
numModñVÆues
; j++)

522 
	`WRITE_SVLC
(
cmiv
.
compModñVÆue
[
j
], "comp_model_value[c][i]" );

527 
	`WRITE_FLAG
–
£i
.
m_fûmGøöCh¨a˘îi°icsPîsi°í˚Fœg
, "film_grain_characteristics_persistence_flag" );

529 
	}
}

532 
Void
 
	gSEIWrôî
::
	$xWrôeSEIPo°FûãrHöt
(c⁄° 
SEIPo°FûãrHöt
& 
£i
, c⁄° 
TComSPS
 *
•s
)

534 
	`WRITE_UVLC
–
£i
.
m_fûãrHötSizeY
, "filter_hint_size_y" );

535 
	`WRITE_UVLC
–
£i
.
m_fûãrHötSizeX
, "filter_hint_size_x" );

536 
	`WRITE_CODE
–
£i
.
m_fûãrHötTy≥
, 2, "filter_hint_type" );

537 
	`as£π
–(
•s
->
	`gëChromaF‹m©Idc
(Ë=
CHROMA_400
Ë=
£i
.
m_bIsM⁄ochrome
 );

538 c⁄° 
UI¡
 
numChromaCh™√ls
 = 
£i
.
m_bIsM⁄ochrome
 ? 1:3;

539 
	`as£π
–
£i
.
m_fûãrHötVÆues
.
	`size
(Ë=
numChromaCh™√ls
*£i.
m_fûãrHötSizeX
*£i.
m_fûãrHötSizeY
 );

540 
°d
::
size_t
 
i
=0; i<
£i
.
m_fûãrHötVÆues
.
	`size
(); i++)

542 
	`WRITE_SVLC
–
£i
.
m_fûãrHötVÆues
[
i
], "filter_hint_value[][][]" );

544 
	}
}

547 
Void
 
	gSEIWrôî
::
	$xWrôeSEIT⁄eM≠pögInfo
(c⁄° 
SEIT⁄eM≠pögInfo
& 
£i
)

549 
I¡
 
i
;

550 
	`WRITE_UVLC
–
£i
.
m_t⁄eM≠Id
, "tone_map_id" );

551 
	`WRITE_FLAG
–
£i
.
m_t⁄eM≠C™˚lFœg
, "tone_map_cancel_flag" );

552 if–!
£i
.
m_t⁄eM≠C™˚lFœg
 )

554 
	`WRITE_FLAG
–
£i
.
m_t⁄eM≠Pîsi°í˚Fœg
, "tone_map_persistence_flag" );

555 
	`WRITE_CODE
–
£i
.
m_codedD©aBôDïth
, 8, "coded_data_bit_depth" );

556 
	`WRITE_CODE
–
£i
.
m_èrgëBôDïth
, 8, "target_bit_depth" );

557 
	`WRITE_UVLC
–
£i
.
m_modñId
, "model_id" );

558 
£i
.
m_modñId
)

562 
	`WRITE_CODE
–
£i
.
m_möVÆue
, 32, "min_value" );

563 
	`WRITE_CODE
–
£i
.
m_maxVÆue
, 32, "max_value" );

568 
	`WRITE_CODE
–
£i
.
m_sigmoidMidpoöt
, 32, "sigmoid_midpoint" );

569 
	`WRITE_CODE
–
£i
.
m_sigmoidWidth
, 32, "sigmoid_width" );

574 
UI¡
 
num
 = 1u << 
£i
.
m_èrgëBôDïth
;

575 
i
 = 0; i < 
num
; i++)

577 
	`WRITE_CODE
–
£i
.
m_°¨tOfCodedI¡îvÆ
[
i
], (–£i.
m_codedD©aBôDïth
 + 7 ) >> 3 ) << 3, "start_of_coded_interval" );

583 
	`WRITE_CODE
–
£i
.
m_numPivŸs
, 16, "num_pivots" );

584 
i
 = 0; i < 
£i
.
m_numPivŸs
; i++ )

586 
	`WRITE_CODE
–
£i
.
m_codedPivŸVÆue
[
i
], (–£i.
m_codedD©aBôDïth
 + 7 ) >> 3 ) << 3, "coded_pivot_value" );

587 
	`WRITE_CODE
–
£i
.
m_èrgëPivŸVÆue
[
i
], (–£i.
m_èrgëBôDïth
 + 7 ) >> 3 ) << 3, "target_pivot_value");

593 
	`WRITE_CODE
–
£i
.
m_ˇmîaIsoS≥edIdc
, 8, "camera_iso_speed_idc" );

594 if–
£i
.
m_ˇmîaIsoS≥edIdc
 == 255)

596 
	`WRITE_CODE
–
£i
.
m_ˇmîaIsoS≥edVÆue
, 32, "camera_iso_speed_value" );

598 
	`WRITE_CODE
–
£i
.
m_exposuªIndexIdc
, 8, "exposure_index_idc" );

599 if–
£i
.
m_exposuªIndexIdc
 == 255)

601 
	`WRITE_CODE
–
£i
.
m_exposuªIndexVÆue
, 32, "exposure_index_value" );

603 
	`WRITE_FLAG
–
£i
.
m_exposuªCom≥nßti⁄VÆueSignFœg
, "exposure_compensation_value_sign_flag" );

604 
	`WRITE_CODE
–
£i
.
m_exposuªCom≥nßti⁄VÆueNumî©‹
, 16, "exposure_compensation_value_numerator" );

605 
	`WRITE_CODE
–
£i
.
m_exposuªCom≥nßti⁄VÆueDíomIdc
, 16, "exposure_compensation_value_denom_idc" );

606 
	`WRITE_CODE
–
£i
.
m_ªfS¸ìnLumö™˚Whôe
, 32, "ref_screen_luminance_white" );

607 
	`WRITE_CODE
–
£i
.
m_exãndedR™geWhôeLevñ
, 32, "extended_range_white_level" );

608 
	`WRITE_CODE
–
£i
.
m_nomöÆBœckLevñLumaCodeVÆue
, 16, "nominal_black_level_luma_code_value" );

609 
	`WRITE_CODE
–
£i
.
m_nomöÆWhôeLevñLumaCodeVÆue
, 16, "nominal_white_level_luma_code_value" );

610 
	`WRITE_CODE
–
£i
.
m_exãndedWhôeLevñLumaCodeVÆue
, 16, "extended_white_level_luma_code_value" );

615 
	`as£π
(!"Undefined SEIToneMapModelId");

620 
	}
}

623 
Void
 
	gSEIWrôî
::
	$xWrôeSEIFømePackög
(c⁄° 
SEIFømePackög
& 
£i
)

625 
	`WRITE_UVLC
–
£i
.
m_¨øngemítId
, "frame_packing_arrangement_id" );

626 
	`WRITE_FLAG
–
£i
.
m_¨øngemítC™˚lFœg
, "frame_packing_arrangement_cancel_flag" );

628 if–
£i
.
m_¨øngemítC™˚lFœg
 == 0 )

630 
	`WRITE_CODE
–
£i
.
m_¨øngemítTy≥
, 7, "frame_packing_arrangement_type" );

632 
	`WRITE_FLAG
–
£i
.
m_quöcunxSam∂ögFœg
, "quincunx_sampling_flag" );

633 
	`WRITE_CODE
–
£i
.
m_c⁄ã¡I¡î¥ë©i⁄Ty≥
, 6, "content_interpretation_type" );

634 
	`WRITE_FLAG
–
£i
.
m_•©ülFlùpögFœg
, "spatial_flipping_flag" );

635 
	`WRITE_FLAG
–
£i
.
m_‰ame0Flù≥dFœg
, "frame0_flipped_flag" );

636 
	`WRITE_FLAG
–
£i
.
m_fõldVõwsFœg
, "field_views_flag" );

637 
	`WRITE_FLAG
–
£i
.
m_cuºítFømeIsFøme0Fœg
, "current_frame_is_frame0_flag" );

639 
	`WRITE_FLAG
–
£i
.
m_‰ame0SñfC⁄èöedFœg
, "frame0_self_contained_flag" );

640 
	`WRITE_FLAG
–
£i
.
m_‰ame1SñfC⁄èöedFœg
, "frame1_self_contained_flag" );

642 if(
£i
.
m_quöcunxSam∂ögFœg
 =0 && sei.
m_¨øngemítTy≥
 != 5)

644 
	`WRITE_CODE
–
£i
.
m_‰ame0GridPosôi⁄X
, 4, "frame0_grid_position_x" );

645 
	`WRITE_CODE
–
£i
.
m_‰ame0GridPosôi⁄Y
, 4, "frame0_grid_position_y" );

646 
	`WRITE_CODE
–
£i
.
m_‰ame1GridPosôi⁄X
, 4, "frame1_grid_position_x" );

647 
	`WRITE_CODE
–
£i
.
m_‰ame1GridPosôi⁄Y
, 4, "frame1_grid_position_y" );

650 
	`WRITE_CODE
–
£i
.
m_¨øngemítRe£rvedByã
, 8, "frame_packing_arrangement_reserved_byte" );

651 
	`WRITE_FLAG
–
£i
.
m_¨øngemítPîsi°í˚Fœg
, "frame_packing_arrangement_persistence_flag" );

654 
	`WRITE_FLAG
–
£i
.
m_upßm∂edA•e˘R©io
, "upsampled_aspect_ratio" );

655 
	}
}

658 
Void
 
	gSEIWrôî
::
	$xWrôeSEIDi•œyOrõ¡©i⁄
(c⁄° 
SEIDi•œyOrõ¡©i⁄
 &
£i
)

660 
	`WRITE_FLAG
–
£i
.
ˇn˚lFœg
, "display_orientation_cancel_flag" );

661 if–!
£i
.
ˇn˚lFœg
 )

663 
	`WRITE_FLAG
–
£i
.
h‹Flù
, "hor_flip" );

664 
	`WRITE_FLAG
–
£i
.
vîFlù
, "ver_flip" );

665 
	`WRITE_CODE
–
£i
.
™ti˛ockwi£RŸ©i⁄
, 16, "anticlockwise_rotation" );

666 
	`WRITE_FLAG
–
£i
.
≥rsi°í˚Fœg
, "display_orientation_persistence_flag" );

668 
	}
}

671 
Void
 
	gSEIWrôî
::
	$xWrôeSEIGªíMëad©aInfo
(c⁄° 
SEIGªíMëad©aInfo
& 
£i
)

673 
	`WRITE_CODE
(
£i
.
m_gªíMëad©aTy≥
, 8, "green_metadata_type");

675 
	`WRITE_CODE
(
£i
.
m_xsdMëricTy≥
, 8, "xsd_metric_type");

676 
	`WRITE_CODE
(
£i
.
m_xsdMëricVÆue
, 16, "xsd_metric_value");

677 
	}
}

680 
Void
 
	gSEIWrôî
::
	$xWrôeSEISOPDes¸ùti⁄
(c⁄° 
SEISOPDes¸ùti⁄
& 
£i
)

682 
	`WRITE_UVLC
–
£i
.
m_s›SeqP¨amëîSëId
, "sop_seq_parameter_set_id" );

683 
	`WRITE_UVLC
–
£i
.
m_numPicsInS›Möus1
, "num_pics_in_sop_minus1" );

684 
UI¡
 
i
 = 0; i <
£i
.
m_numPicsInS›Möus1
; i++)

686 
	`WRITE_CODE
–
£i
.
m_s›DescV˛NÆuTy≥
[
i
], 6, "sop_desc_vcl_nalu_type" );

687 
	`WRITE_CODE
–
£i
.
m_s›DescTemp‹ÆId
[
i
], 3, "sop_desc_temporal_id" );

688 i‡(
£i
.
m_s›DescV˛NÆuTy≥
[
i
] !
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 && sei.m_s›DescV˛NÆuTy≥[i] !
NAL_UNIT_CODED_SLICE_IDR_N_LP
)

690 
	`WRITE_UVLC
–
£i
.
m_s›DescStRpsIdx
[
i
], "sop_desc_st_rps_idx" );

692 i‡(
i
 > 0)

694 
	`WRITE_SVLC
–
£i
.
m_s›DescPocDñè
[
i
], "sop_desc_poc_delta" );

697 
	}
}

700 
Void
 
	gSEIWrôî
::
	$xWrôeSEIA˘iveP¨amëîSës
(c⁄° 
SEIA˘iveP¨amëîSës
& 
£i
)

702 
	`WRITE_CODE
(
£i
.
a˘iveVPSId
, 4, "active_video_parameter_set_id");

703 
	`WRITE_FLAG
(
£i
.
m_£lfC⁄èöedCvsFœg
, "self_contained_cvs_flag");

704 
	`WRITE_FLAG
(
£i
.
m_noP¨amëîSëUpd©eFœg
, "no_parameter_set_update_flag");

705 
	`WRITE_UVLC
(
£i
.
numSpsIdsMöus1
, "num_sps_ids_minus1");

707 
	`as£π
 (
£i
.
a˘iveSeqP¨amëîSëId
.
	`size
(Ë=(£i.
numSpsIdsMöus1
 + 1));

709 
I¡
 
i
 = 0; i < 
£i
.
a˘iveSeqP¨amëîSëId
.
	`size
(); i++)

711 
	`WRITE_UVLC
(
£i
.
a˘iveSeqP¨amëîSëId
[
i
], "active_seq_parameter_set_id");

713 
	}
}

716 
Void
 
	gSEIWrôî
::
	$xWrôeSEIDecodögUnôInfo
(c⁄° 
SEIDecodögUnôInfo
& 
£i
, c⁄° 
TComSPS
 *
•s
)

718 c⁄° 
TComVUI
 *
vui
 = 
•s
->
	`gëVuiP¨amëîs
();

719 
	`WRITE_UVLC
(
£i
.
m_decodögUnôIdx
, "decoding_unit_idx");

720 if(
vui
->
	`gëHrdP¨amëîs
()->
	`gëSubPicCpbP¨amsInPicTimögSEIFœg
())

722 
	`WRITE_CODE
–
£i
.
m_duS±CpbRemovÆDñay
, (
vui
->
	`gëHrdP¨amëîs
()->
	`gëDuCpbRemovÆDñayLígthMöus1
() + 1), "du_spt_cpb_removal_delay_increment");

724 
	`WRITE_FLAG
–
£i
.
m_dpbOuçutDuDñayPª£¡Fœg
, "dpb_output_du_delay_present_flag");

725 if(
£i
.
m_dpbOuçutDuDñayPª£¡Fœg
)

727 
	`WRITE_CODE
(
£i
.
m_picS±DpbOuçutDuDñay
, 
vui
->
	`gëHrdP¨amëîs
()->
	`gëDpbOuçutDñayDuLígthMöus1
() + 1, "pic_spt_dpb_output_du_delay");

729 
	}
}

732 
Void
 
	gSEIWrôî
::
	$xWrôeSEITemp‹ÆLevñ0Index
(c⁄° 
SEITemp‹ÆLevñ0Index
 &
£i
)

734 
	`WRITE_CODE
–
£i
.
é0Idx
, 8 , "tl0_idx" );

735 
	`WRITE_CODE
–
£i
.
øpIdx
, 8 , "rap_idx" );

736 
	}
}

739 
Void
 
	gSEIWrôî
::
	$xWrôeSEIDecodedPi˘uªHash
(c⁄° 
SEIDecodedPi˘uªHash
& 
£i
)

741 c⁄° 
TCh¨
 *
åa˚Såög
="\0";

742 
£i
.
mëhod
)

744 
HASHTYPE_MD5
: 
åa˚Såög
="picture_md5"; ;

745 
HASHTYPE_CRC
: 
åa˚Såög
="picture_crc"; ;

746 
HASHTYPE_CHECKSUM
: 
åa˚Såög
="picture_checksum"; ;

747 : 
	`as£π
(
Ál£
); ;

750 i‡(
åa˚Såög
 != 0)

752 
	`WRITE_CODE
(
£i
.
mëhod
, 8, "hash_type");

753 
UI¡
 
i
=0; i<
	`UI¡
(
£i
.
m_pi˘uªHash
.
hash
.
	`size
()); i++)

755 
	`WRITE_CODE
(
£i
.
m_pi˘uªHash
.
hash
[
i
], 8, 
åa˚Såög
);

758 
	}
}

761 
Void
 
	gSEIWrôî
::
	$xWrôeSEISˇœbÀNe°ög
(
TComBôIf
& 
bs
, c⁄° 
SEISˇœbÀNe°ög
& 
£i
, c⁄° 
TComSPS
 *
•s
)

763 
	`WRITE_FLAG
–
£i
.
m_bôSåómSub£tFœg
, "bitstream_subset_flag" );

764 
	`WRITE_FLAG
–
£i
.
m_√°ögOpFœg
, "nesting_op_flag " );

765 i‡(
£i
.
m_√°ögOpFœg
)

767 
	`WRITE_FLAG
–
£i
.
m_deÁu…OpFœg
, "default_op_flag" );

768 
	`WRITE_UVLC
–
£i
.
m_√°ögNumOpsMöus1
, "nesting_num_ops_minus1" );

769 
UI¡
 
i
 = (
£i
.
m_deÁu…OpFœg
 ? 1 : 0); i <£i.
m_√°ögNumOpsMöus1
; i++)

771 
	`WRITE_CODE
–
£i
.
m_√°ögMaxTemp‹ÆIdPlus1
[
i
], 3, "nesting_max_temporal_id_plus1" );

772 
	`WRITE_UVLC
–
£i
.
m_√°ögOpIdx
[
i
], "nesting_op_idx" );

777 
	`WRITE_FLAG
–
£i
.
m_ÆlLayîsFœg
, "all_layers_flag" );

778 i‡(!
£i
.
m_ÆlLayîsFœg
)

780 
	`WRITE_CODE
–
£i
.
m_√°ögNoOpMaxTemp‹ÆIdPlus1
, 3, "nesting_no_op_max_temporal_id_plus1" );

781 
	`WRITE_UVLC
–
£i
.
m_√°ögNumLayîsMöus1
, "nesting_num_layers" );

782 
UI¡
 
i
 = 0; i <
£i
.
m_√°ögNumLayîsMöus1
; i++)

784 
	`WRITE_CODE
–
£i
.
m_√°ögLayîId
[
i
], 6, "nesting_layer_id" );

790  
m_pcBôIf
->
	`gëNumbîOfWrôãnBôs
() % 8 != 0 )

792 
	`WRITE_FLAG
( 0, "nesting_zero_bit" );

796 
	`wrôeSEImesßges
(
bs
, 
£i
.
m_√°edSEIs
, 
•s
, 
åue
);

797 
	}
}

800 
Void
 
	gSEIWrôî
::
	$xWrôeSEIRegi⁄Re‰eshInfo
(c⁄° 
SEIRegi⁄Re‰eshInfo
 &
£i
)

802 
	`WRITE_FLAG
–
£i
.
m_gdrF‹egroundFœg
, "gdr_foreground_flag");

803 
	}
}

806 
Void
 
	gSEIWrôî
::
	$xWrôeSEINoDi•œy
(c⁄° 
SEINoDi•œy
& )

809 
	}
}

812 
Void
 
SEIWrôî
::
	$xWrôeSEITimeCode
(c⁄° 
SEITimeCode
& 
£i
)

814 
	`WRITE_CODE
(
£i
.
numClockTs
, 2, "num_clock_ts");

815 
I¡
 
i
 = 0; i < 
£i
.
numClockTs
; i++)

817 c⁄° 
TComSEITimeSë
 &
cuºítTimeSë
 = 
£i
.
timeSëAºay
[
i
];

818 
	`WRITE_FLAG
(
cuºítTimeSë
.
˛ockTimeSèmpFœg
, "clock_time_stamp_flag");

819 if(
cuºítTimeSë
.
˛ockTimeSèmpFœg
)

821 
	`WRITE_FLAG
(
cuºítTimeSë
.
numUnôFõldBa£dFœg
, "units_field_based_flag");

822 
	`WRITE_CODE
(
cuºítTimeSë
.
cou¡ögTy≥
, 5, "counting_type");

823 
	`WRITE_FLAG
(
cuºítTimeSë
.
fuŒTimeSèmpFœg
, "full_timestamp_flag");

824 
	`WRITE_FLAG
(
cuºítTimeSë
.
disc⁄töuôyFœg
, "discontinuity_flag");

825 
	`WRITE_FLAG
(
cuºítTimeSë
.
˙tDr›≥dFœg
, "cnt_dropped_flag");

826 
	`WRITE_CODE
(
cuºítTimeSë
.
numbîOfFømes
, 9, "n_frames");

827 if(
cuºítTimeSë
.
fuŒTimeSèmpFœg
)

829 
	`WRITE_CODE
(
cuºítTimeSë
.
£c⁄dsVÆue
, 6, "seconds_value");

830 
	`WRITE_CODE
(
cuºítTimeSë
.
möuãsVÆue
, 6, "minutes_value");

831 
	`WRITE_CODE
(
cuºítTimeSë
.
hoursVÆue
, 5, "hours_value");

835 
	`WRITE_FLAG
(
cuºítTimeSë
.
£c⁄dsFœg
, "seconds_flag");

836 if(
cuºítTimeSë
.
£c⁄dsFœg
)

838 
	`WRITE_CODE
(
cuºítTimeSë
.
£c⁄dsVÆue
, 6, "seconds_value");

839 
	`WRITE_FLAG
(
cuºítTimeSë
.
möuãsFœg
, "minutes_flag");

840 if(
cuºítTimeSë
.
möuãsFœg
)

842 
	`WRITE_CODE
(
cuºítTimeSë
.
möuãsVÆue
, 6, "minutes_value");

843 
	`WRITE_FLAG
(
cuºítTimeSë
.
hoursFœg
, "hours_flag");

844 if(
cuºítTimeSë
.
hoursFœg
)

846 
	`WRITE_CODE
(
cuºítTimeSë
.
hoursVÆue
, 5, "hours_value");

851 
	`WRITE_CODE
(
cuºítTimeSë
.
timeOff£tLígth
, 5, "time_offset_length");

852 if(
cuºítTimeSë
.
timeOff£tLígth
 > 0)

854 if(
cuºítTimeSë
.
timeOff£tVÆue
 >= 0)

856 
	`WRITE_CODE
((
UI¡
)
cuºítTimeSë
.
timeOff£tVÆue
, cuºítTimeSë.
timeOff£tLígth
, "time_offset_value");

861 
UI¡
 
off£tVÆue
 = ~(
cuºítTimeSë
.
timeOff£tVÆue
) + 1;

862 
off£tVÆue
 |(1 << (
cuºítTimeSë
.
timeOff£tLígth
-1));

863 
	`WRITE_CODE
(
off£tVÆue
, 
cuºítTimeSë
.
timeOff£tLígth
, "time_offset_value");

868 
	}
}

871 
Void
 
	gSEIWrôî
::
	$xWrôeSEIMa°îögDi•œyCﬁourVﬁume
(c⁄° 
SEIMa°îögDi•œyCﬁourVﬁume
& 
£i
)

873 
	`WRITE_CODE
–
£i
.
vÆues
.
¥im¨õs
[0][0], 16, "display_primaries_x[0]" );

874 
	`WRITE_CODE
–
£i
.
vÆues
.
¥im¨õs
[0][1], 16, "display_primaries_y[0]" );

876 
	`WRITE_CODE
–
£i
.
vÆues
.
¥im¨õs
[1][0], 16, "display_primaries_x[1]" );

877 
	`WRITE_CODE
–
£i
.
vÆues
.
¥im¨õs
[1][1], 16, "display_primaries_y[1]" );

879 
	`WRITE_CODE
–
£i
.
vÆues
.
¥im¨õs
[2][0], 16, "display_primaries_x[2]" );

880 
	`WRITE_CODE
–
£i
.
vÆues
.
¥im¨õs
[2][1], 16, "display_primaries_y[2]" );

882 
	`WRITE_CODE
–
£i
.
vÆues
.
whôePoöt
[0], 16, "white_point_x" );

883 
	`WRITE_CODE
–
£i
.
vÆues
.
whôePoöt
[1], 16, "white_point_y" );

885 
	`WRITE_CODE
–
£i
.
vÆues
.
maxLumö™˚
, 32, "max_display_mastering_luminance" );

886 
	`WRITE_CODE
–
£i
.
vÆues
.
möLumö™˚
, 32, "min_display_mastering_luminance" );

887 
	}
}

890 
Void
 
	gSEIWrôî
::
	$xWrôeSEISegmíãdRe˘FømePackög
(c⁄° 
SEISegmíãdRe˘FømePackög
& 
£i
)

892 
	`WRITE_FLAG
–
£i
.
m_¨øngemítC™˚lFœg
, "segmented_rect_frame_packing_arrangement_cancel_flag" );

893 if–
£i
.
m_¨øngemítC™˚lFœg
 == 0 )

895 
	`WRITE_CODE
–
£i
.
m_c⁄ã¡I¡î¥ë©i⁄Ty≥
, 2, "segmented_rect_content_interpretation_type" );

896 
	`WRITE_FLAG
–
£i
.
m_¨øngemítPîsi°í˚Fœg
, "segmented_rect_frame_packing_arrangement_persistence" );

898 
	}
}

901 
Void
 
	gSEIWrôî
::
	$xWrôeSEITempMŸi⁄C⁄°øöedTûeSës
(c⁄° 
SEITempMŸi⁄C⁄°øöedTûeSës
& 
£i
)

904 
	`WRITE_FLAG
((
£i
.
m_mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag
 ? 1 : 0), "mc_all_tiles_exact_sample_value_match_flag");

905 
	`WRITE_FLAG
((
£i
.
m_óch_tûe_⁄e_tûe_£t_Êag
 ? 1 : 0), "each_tile_one_tile_set_flag" );

907 if(!
£i
.
m_óch_tûe_⁄e_tûe_£t_Êag
)

909 
	`WRITE_FLAG
((
£i
.
m_limôed_tûe_£t_di•œy_Êag
 ? 1 : 0), "limited_tile_set_display_flag");

910 
	`WRITE_UVLC
((
£i
.
	`gëNumbîOfTûeSës
() - 1), "num_sets_in_message_minus1" );

912 if(
£i
.
	`gëNumbîOfTûeSës
() > 0)

914 
I¡
 
i
 = 0; i < 
£i
.
	`gëNumbîOfTûeSës
(); i++)

916 
	`WRITE_UVLC
(
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_id
, "mcts_id");

918 if(
£i
.
m_limôed_tûe_£t_di•œy_Êag
)

920 
	`WRITE_FLAG
((
£i
.
	`tûeSëD©a
(
i
).
m_di•œy_tûe_£t_Êag
 ? 1 : 0), "display_tile_set_flag");

923 
	`WRITE_UVLC
((
£i
.
	`tûeSëD©a
(
i
).
	`gëNumbîOfTûeRe˘s
() - 1), "num_tile_rects_in_set_minus1");

925 
I¡
 
j
 = 0; j < 
£i
.
	`tûeSëD©a
(
i
).
	`gëNumbîOfTûeRe˘s
(); j++)

927 
	`WRITE_UVLC
(
£i
.
	`tûeSëD©a
(
i
).
	`t›Le·TûeIndex
 (
j
), "top_left_tile_index");

928 
	`WRITE_UVLC
(
£i
.
	`tûeSëD©a
(
i
).
	`bŸtomRightTûeIndex
(
j
), "bottom_right_tile_index");

931 if(!
£i
.
m_mc_Æl_tûes_exa˘_ßm∂e_vÆue_m©ch_Êag
)

933 
	`WRITE_FLAG
((
£i
.
	`tûeSëD©a
(
i
).
m_exa˘_ßm∂e_vÆue_m©ch_Êag
 ? 1 : 0), "exact_sample_value_match_flag");

936 
	`WRITE_FLAG
((
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_tõr_Àvñ_idc_¥e£¡_Êag
 ? 1 : 0), "mcts_tier_level_idc_present_flag");

938 if(
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_tõr_Àvñ_idc_¥e£¡_Êag
)

940 
	`WRITE_FLAG
((
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_tõr_Êag
 ? 1 : 0), "mcts_tier_flag");

941 
	`WRITE_CODE
–
£i
.
	`tûeSëD©a
(
i
).
m_m˘s_Àvñ_idc
, 8, "mcts_level_idc");

948 
	`WRITE_FLAG
((
£i
.
m_max_mcs_tõr_Àvñ_idc_¥e£¡_Êag
 ? 1 : 0), "max_mcs_tier_level_idc_present_flag");

950 if(
£i
.
m_max_mcs_tõr_Àvñ_idc_¥e£¡_Êag
)

952 
	`WRITE_FLAG
((
£i
.
m_max_m˘s_tõr_Êag
 ? 1 : 0), "max_mcts_tier_flag");

953 
	`WRITE_CODE
–
£i
.
m_max_m˘s_Àvñ_idc
, 8, "max_mcts_level_idc");

956 
	}
}

958 #i‡
MCTS_EXTRACTION


959 
Void
 
	gSEIWrôî
::
	$xWrôeSEIMCTSExåa˘i⁄InfoSë
(c⁄° 
SEIMCTSExåa˘i⁄InfoSë
& 
£i
)

961 
	`as£π
(!
£i
.
m_MCTSExåa˘i⁄InfoSës
.
	`em±y
());

962 
	`WRITE_UVLC
(((
UI¡
)
£i
.
m_MCTSExåa˘i⁄InfoSës
.
	`size
() - 1), "num_sets_in_message_minus1");

963 
°d
::
ve˘‹
<
SEIMCTSExåa˘i⁄InfoSë
::
MCTSExåa˘i⁄Info
>::
c⁄°_ôî©‹
 
MCTSEISôî
 = 
£i
.
m_MCTSExåa˘i⁄InfoSës
.
	`begö
();

964 
MCTSEISôî
 !
£i
.
m_MCTSExåa˘i⁄InfoSës
.
	`íd
(); MCTSEISiter++)

966 
	`WRITE_UVLC
(((
UI¡
)
MCTSEISôî
->
m_idxOfM˘sInSë
.
	`size
() - 1), "num_mcts_sets_minus1[ i ]");

967  
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_idxOfM˘sInSë
.
	`size
(); j++)

969 
	`WRITE_UVLC
(((
UI¡
)
MCTSEISôî
->
m_idxOfM˘sInSë
[
j
].
	`size
() - 1), "num_mcts_in_set_minus1[ i ][ j ]");

970 
I¡
 
k
 = 0; k < 
MCTSEISôî
->
m_idxOfM˘sInSë
[
j
].
	`size
(); k++)

972 
	`WRITE_UVLC
((
MCTSEISôî
->
m_idxOfM˘sInSë
[
j
][
k
]), "idx_of_mcts_in_set[ i ][ j ][ k ]");

975 
	`WRITE_FLAG
((
MCTSEISôî
->
m_¶i˚Re‹dîögE«bÀdFœg
? 1 : 0 ), "slice_reordering_enabled_flag[ i ]");

976 i‡–
MCTSEISôî
->
m_¶i˚Re‹dîögE«bÀdFœg
 )

978 
	`WRITE_UVLC
(((
UI¡
)
MCTSEISôî
->
m_ouçutSli˚SegmítAddªss
.
	`size
() - 1), "num_slice_segments_minus1[ i ]");

979 
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_ouçutSli˚SegmítAddªss
.
	`size
(); j++)

981 
	`WRITE_UVLC
((
MCTSEISôî
->
m_ouçutSli˚SegmítAddªss
[
j
]), "output_slice_segment_address[ i ][ j ]");

984 
	`WRITE_UVLC
(((
UI¡
)
MCTSEISôî
->
m_vpsRb•D©aLígth
.
	`size
() - 1), "num_vps_in_info_set_minus1[i]");

985 
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_vpsRb•D©aLígth
.
	`size
(); j++)

987 
	`WRITE_UVLC
((
MCTSEISôî
->
m_vpsRb•D©aLígth
[
j
]), "vps_rbsp_data_length[i][j]");

989 
	`WRITE_UVLC
(((
UI¡
)
MCTSEISôî
->
m_•sRb•D©aLígth
.
	`size
() - 1), "num_sps_in_info_set_minus1[i]");

990 
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_•sRb•D©aLígth
.
	`size
(); j++)

992 
	`WRITE_UVLC
((
MCTSEISôî
->
m_•sRb•D©aLígth
[
j
]), "sps_rbsp_data_length[i][j]");

994 
	`WRITE_UVLC
(((
UI¡
)
MCTSEISôî
->
m_µsRb•D©aLígth
.
	`size
() - 1), "num_sps_in_info_set_minus1[i]");

995 
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_µsRb•D©aLígth
.
	`size
(); j++)

997 
	`WRITE_UVLC
((
MCTSEISôî
->
m_µsNuhTemp‹ÆIdPlus1
[
j
]), "pps_nuh_temporal_id_plus1[i][j]");

998 
	`WRITE_UVLC
((
MCTSEISôî
->
m_µsRb•D©aLígth
[
j
]), "pps_rbsp_data_length[i][j]");

1001 
m_pcBôIf
->
	`gëNumbîOfWrôãnBôs
() % 8 != 0)

1003 
	`WRITE_FLAG
(0, "mcts_alignment_bit_equal_to_zero");

1005 
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_vpsRb•D©a
.
	`size
(); j++)

1007 
I¡
 
k
 = 0; k < 
MCTSEISôî
->
m_vpsRb•D©aLígth
[
j
]; k++)

1009 
	`WRITE_CODE
((
MCTSEISôî
->
m_vpsRb•D©a
[
j
][
k
]), 8, "vps_rbsp_data_byte[ i ][ j ][ k ]");

1012 
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_•sRb•D©a
.
	`size
(); j++)

1014 
I¡
 
k
 = 0; k < 
MCTSEISôî
->
m_•sRb•D©aLígth
[
j
]; k++)

1016 
	`WRITE_CODE
((
MCTSEISôî
->
m_•sRb•D©a
[
j
][
k
]), 8, "sps_rbsp_data_byte[ i ][ j ][ k ]");

1019 
I¡
 
j
 = 0; j < 
MCTSEISôî
->
m_µsRb•D©a
.
	`size
(); j++)

1021 
I¡
 
k
 = 0; k < 
MCTSEISôî
->
m_µsRb•D©aLígth
[
j
]; k++)

1023 
	`WRITE_CODE
((
MCTSEISôî
->
m_µsRb•D©a
[
j
][
k
]), 8, "pps_rbsp_data_byte[ i ][ j ][ k ]");

1027 
	}
}

1031 
Void
 
	gSEIWrôî
::
	$xWrôeSEIChromaReßm∂ögFûãrHöt
(c⁄° 
SEIChromaReßm∂ögFûãrHöt
 &
£i
)

1033 
	`WRITE_CODE
(
£i
.
m_vîChromaFûãrIdc
, 8, "ver_chroma_filter_idc");

1034 
	`WRITE_CODE
(
£i
.
m_h‹ChromaFûãrIdc
, 8, "hor_chroma_filter_idc");

1035 
	`WRITE_FLAG
(
£i
.
m_vîFûãrögFõldPro˚ssögFœg
, "ver_filtering_field_processing_flag");

1036 if(
£i
.
m_vîChromaFûãrIdc
 =1 || sei.
m_h‹ChromaFûãrIdc
 == 1)

1038 
	`WRITE_UVLC
(
£i
.
m_èrgëF‹m©Idc
, "target_format_idc");

1039 if(
£i
.
m_vîChromaFûãrIdc
 == 1)

1041 c⁄° 
I¡
 
numVîtiˇlFûãr
 = (I¡)
£i
.
m_vîFûãrC€ff
.
	`size
();

1042 
	`WRITE_UVLC
(
numVîtiˇlFûãr
, "num_vertical_filters");

1043 if(
numVîtiˇlFûãr
 > 0)

1045 
I¡
 
i
 = 0; i < 
numVîtiˇlFûãr
; i ++)

1047 c⁄° 
I¡
 
vîT≠LígthMöus1
 = (I¡Ë
£i
.
m_vîFûãrC€ff
[
i
].
	`size
() - 1;

1048 
	`WRITE_UVLC
(
vîT≠LígthMöus1
, "ver_tap_length_minus_1");

1049 
I¡
 
j
 = 0; j < (
vîT≠LígthMöus1
 + 1); j ++)

1051 
	`WRITE_SVLC
(
£i
.
m_vîFûãrC€ff
[
i
][
j
], "ver_filter_coeff");

1056 if(
£i
.
m_h‹ChromaFûãrIdc
 == 1)

1058 c⁄° 
I¡
 
numH‹iz⁄èlFûãr
 = (I¡Ë
£i
.
m_h‹FûãrC€ff
.
	`size
();

1059 
	`WRITE_UVLC
(
numH‹iz⁄èlFûãr
, "num_horizontal_filters");

1060 if(
numH‹iz⁄èlFûãr
 > 0)

1062 
I¡
 
i
 = 0; i < 
numH‹iz⁄èlFûãr
; i ++)

1064 c⁄° 
I¡
 
h‹T≠LígthMöus1
 = (I¡Ë
£i
.
m_h‹FûãrC€ff
[
i
].
	`size
() - 1;

1065 
	`WRITE_UVLC
(
h‹T≠LígthMöus1
, "hor_tap_length_minus_1");

1066 
I¡
 
j
 = 0; j < (
h‹T≠LígthMöus1
 + 1); j ++)

1068 
	`WRITE_SVLC
(
£i
.
m_h‹FûãrC€ff
[
i
][
j
], "hor_filter_coeff");

1074 
	}
}

1077 
Void
 
	gSEIWrôî
::
	$xWrôeSEIK√eFun˘i⁄Info
(c⁄° 
SEIK√eFun˘i⁄Info
 &
£i
)

1079 
	`WRITE_UVLC
–
£i
.
m_k√eId
, "knee_function_id" );

1080 
	`WRITE_FLAG
–
£i
.
m_k√eC™˚lFœg
, "knee_function_cancel_flag" );

1081 i‡–!
£i
.
m_k√eC™˚lFœg
 )

1083 
	`WRITE_FLAG
–
£i
.
m_k√ePîsi°í˚Fœg
, "knee_function_persistence_flag" );

1084 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_k√eI≈utDønge
 , 32, "input_d_range" );

1085 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_k√eI≈utDi•Lumö™˚
, 32, "input_disp_luminance" );

1086 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_k√eOuçutDønge
, 32, "output_d_range" );

1087 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_k√eOuçutDi•Lumö™˚
, 32, "output_disp_luminance" );

1088 
	`WRITE_UVLC
–
£i
.
m_k√eNumK√ePoötsMöus1
, "num_knee_points_minus1" );

1089 
I¡
 
i
 = 0; i <
£i
.
m_k√eNumK√ePoötsMöus1
; i++ )

1091 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_k√eI≈utK√ePoöt
[
i
], 10,"input_knee_point" );

1092 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_k√eOuçutK√ePoöt
[
i
], 10, "output_knee_point" );

1095 
	}
}

1097 
Void
 
	gSEIWrôî
::
	$xWrôeSEIC⁄ã¡CﬁourVﬁume
(c⁄° 
SEIC⁄ã¡CﬁourVﬁume
 &
£i
)

1099 
	`WRITE_FLAG
(
£i
.
m_ccvC™˚lFœg
, "ccv_cancel_flag");

1100 i‡(!
£i
.
m_ccvC™˚lFœg
)

1102 
	`WRITE_FLAG
(
£i
.
m_ccvPîsi°í˚Fœg
, "ccv_persistence_flag");

1103 
	`WRITE_FLAG
(
£i
.
m_ccvPrim¨õsPª£¡Fœg
, "ccv_primaries_present_flag");

1104 
	`WRITE_FLAG
(
£i
.
m_ccvMöLumö™˚VÆuePª£¡Fœg
, "ccv_min_luminance_value_present_flag");

1105 
	`WRITE_FLAG
(
£i
.
m_ccvMaxLumö™˚VÆuePª£¡Fœg
, "ccv_max_luminance_value_present_flag");

1106 
	`WRITE_FLAG
(
£i
.
m_ccvAvgLumö™˚VÆuePª£¡Fœg
, "ccv_avg_luminance_value_present_flag");

1108 i‡(
£i
.
m_ccvPrim¨õsPª£¡Fœg
 =
åue
)

1110 
I¡
 
i
 = 0; i < 
MAX_NUM_COMPONENT
; i++)

1112 
	`WRITE_SCODE
((
I¡
Ë
£i
.
m_ccvPrim¨õsX
[
i
], 32, "ccv_primaries_x[i]");

1113 
	`WRITE_SCODE
((
I¡
Ë
£i
.
m_ccvPrim¨õsY
[
i
], 32, "ccv_primaries_y[i]");

1117 i‡(
£i
.
m_ccvMöLumö™˚VÆuePª£¡Fœg
 =
åue
)

1119 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_ccvMöLumö™˚VÆue
, 32, "ccv_min_luminance_value" );

1121 i‡(
£i
.
m_ccvMöLumö™˚VÆuePª£¡Fœg
 =
åue
)

1123 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_ccvMaxLumö™˚VÆue
, 32, "ccv_max_luminance_value" );

1125 i‡(
£i
.
m_ccvMöLumö™˚VÆuePª£¡Fœg
 =
åue
)

1127 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_ccvAvgLumö™˚VÆue
, 32, "ccv_avg_luminance_value" );

1130 
	}
}

1132 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


1133 
Void
 
	gSEIWrôî
::
	$xWrôeSEIShuâîI¡îvÆ
(c⁄° 
SEIShuâîI¡îvÆInfo
 &
£i
)

1135 
	`WRITE_CODE
(
£i
.
m_siiTimeSˇÀ
, 32, "sii_time_scale");

1136 
	`WRITE_FLAG
(
£i
.
m_siiFixedSIwôhöCLVS
, "fixed_shutter_interval_within_clvs_flag");

1137 i‡(
£i
.
m_siiFixedSIwôhöCLVS
)

1139 
	`WRITE_CODE
(
£i
.
m_siiNumUnôsInShuâîI¡îvÆ
, 32, "sii_num_units_in_shutter_interval");

1143 
	`WRITE_CODE
(
£i
.
m_siiMaxSubLayîsMöus1
, 3, "sii_max_sub_layers_minus1");

1144 
UI¡
 
i
 = 0; i <
£i
.
m_siiMaxSubLayîsMöus1
; i++)

1146 
	`WRITE_CODE
(
£i
.
m_siiSubLayîNumUnôsInSI
[
i
], 32, "sub_layer_num_units_in_shutter_interval[ i ]");

1149 
	}
}

1152 
Void
 
	gSEIWrôî
::
	$xWrôeSEIEquúe˘™guœrProje˘i⁄
(c⁄° 
SEIEquúe˘™guœrProje˘i⁄
 &
£i
)

1154 
	`WRITE_FLAG
–
£i
.
m_îpC™˚lFœg
, "erp_cancel_flag" );

1155 if–!
£i
.
m_îpC™˚lFœg
 )

1157 
	`WRITE_FLAG
–
£i
.
m_îpPîsi°í˚Fœg
, "erp_persistence_flag" );

1158 
	`WRITE_FLAG
–
£i
.
m_îpGu¨dB™dFœg
, "erp_guard_band_flag" );

1159 
	`WRITE_CODE
( 0, 2, "erp_reserved_zero_2bits" );

1160 i‡–
£i
.
m_îpGu¨dB™dFœg
 == 1)

1162 
	`WRITE_CODE
–
£i
.
m_îpGu¨dB™dTy≥
, 3, "erp_guard_band_type" );

1163 
	`WRITE_CODE
–
£i
.
m_îpLe·Gu¨dB™dWidth
, 8, "erp_left_guard_band_width" );

1164 
	`WRITE_CODE
–
£i
.
m_îpRightGu¨dB™dWidth
, 8, "erp_right_guard_band_width" );

1167 
	}
}

1169 
Void
 
	gSEIWrôî
::
	$xWrôeSEISphîeRŸ©i⁄
(c⁄° 
SEISphîeRŸ©i⁄
 &
£i
)

1171 
	`WRITE_FLAG
–
£i
.
m_•hîeRŸ©i⁄C™˚lFœg
, "sphere_rotation_cancel_flag" );

1172 if–!
£i
.
m_•hîeRŸ©i⁄C™˚lFœg
 )

1174 
	`WRITE_FLAG
–
£i
.
m_•hîeRŸ©i⁄Pîsi°í˚Fœg
, "sphere_rotation_persistence_flag" );

1175 
	`WRITE_CODE
( 0, 6, "sphere_rotation_reserved_zero_6bits" );

1176 
	`WRITE_SCODE
(
£i
.
m_•hîeRŸ©i⁄Yaw
, 32, "sphere_rotation_yaw" );

1177 
	`WRITE_SCODE
(
£i
.
m_•hîeRŸ©i⁄Pôch
, 32, "sphere_rotation_pitch" );

1178 
	`WRITE_SCODE
(
£i
.
m_•hîeRŸ©i⁄Rﬁl
, 32, "sphere_rotation_roll" );

1180 
	}
}

1182 
Void
 
	gSEIWrôî
::
	$xWrôeSEIOmniVõwp‹t
(c⁄° 
SEIOmniVõwp‹t
 &
£i
)

1184 
	`WRITE_CODE
–
£i
.
m_omniVõwp‹tId
, 10, "omni_viewport_id" );

1185 
	`WRITE_FLAG
–
£i
.
m_omniVõwp‹tC™˚lFœg
, "omni_viewport_cancel_flag" );

1186 i‡–!
£i
.
m_omniVõwp‹tC™˚lFœg
 )

1188 
	`WRITE_FLAG
–
£i
.
m_omniVõwp‹tPîsi°í˚Fœg
, "omni_viewport_persistence_flag" );

1189 c⁄° 
UI¡
 
numRegi⁄s
 = (UI¡Ë
£i
.
m_omniVõwp‹tRegi⁄s
.
	`size
();

1190 
	`WRITE_CODE
–
numRegi⁄s
 - 1, 4, "omni_viewport_cnt_minus1" );

1191 
UI¡
 
ªgi⁄
=0;Ñegi⁄<
numRegi⁄s
;Ñegion++)

1193 c⁄° 
SEIOmniVõwp‹t
::
OmniVõwp‹t
 &
võwp‹t
=
£i
.
m_omniVõwp‹tRegi⁄s
[
ªgi⁄
];

1194 
	`WRITE_SCODE
–
võwp‹t
.
azimuthCíåe
, 32, "omni_viewport_azimuth_centre" );

1195 
	`WRITE_SCODE
–
võwp‹t
.
ñev©i⁄Cíåe
, 32, "omni_viewport_elevation_centre" );

1196 
	`WRITE_SCODE
–
võwp‹t
.
tûtCíåe
, 32, "omni_viewport_tilt_center" );

1197 
	`WRITE_CODE
–
võwp‹t
.
h‹R™ge
, 32, "omni_viewport_hor_range[i]" );

1198 
	`WRITE_CODE
–
võwp‹t
.
vîR™ge
, 32, "omni_viewport_ver_range[i]" );

1201 
	}
}

1202 
Void
 
	gSEIWrôî
::
	$xWrôeSEICubem≠Proje˘i⁄
(c⁄° 
SEICubem≠Proje˘i⁄
 &
£i
)

1204 
	`WRITE_FLAG
(
£i
.
m_cmpC™˚lFœg
, "cmp_cancel_flag");

1205 i‡(!
£i
.
m_cmpC™˚lFœg
)

1207 
	`WRITE_FLAG
(
£i
.
m_cmpPîsi°í˚Fœg
, "cmp_persistence_flag");

1209 
	}
}

1210 
Void
 
	gSEIWrôî
::
	$xWrôeSEIRegi⁄Wi£Packög
(c⁄° 
SEIRegi⁄Wi£Packög
 &
£i
)

1212 
	`WRITE_FLAG
–
£i
.
m_rwpC™˚lFœg
, "rwp_cancel_flag" );

1213 if(!
£i
.
m_rwpC™˚lFœg
)

1215 
	`WRITE_FLAG
–
£i
.
m_rwpPîsi°í˚Fœg
, "rwp_persistence_flag" );

1216 
	`WRITE_FLAG
–
£i
.
m_c⁄°ôuítPi˘uªM©chögFœg
, "constituent_picture_matching_flag" );

1217 
	`WRITE_CODE
( 0, 5, "rwp_reserved_zero_5bits" );

1218 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_numPackedRegi⁄s
, 8, "num_packed_regions" );

1219 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_¥ojPi˘uªWidth
, 32, "proj_picture_width" );

1220 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_¥ojPi˘uªHeight
, 32, "proj_picture_height" );

1221 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_∑ckedPi˘uªWidth
, 16, "packed_picture_width" );

1222 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_∑ckedPi˘uªHeight
, 16, "packed_picture_height" );

1223  
I¡
 
i
=0; i < 
£i
.
m_numPackedRegi⁄s
; i++ )

1225 
	`WRITE_CODE
( 0, 4, "rwp_reserved_zero_4bits" );

1226 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_rwpTønsf‹mTy≥
[
i
], 3, "rwp_tTransform_type" );

1227 
	`WRITE_FLAG
–
£i
.
m_rwpGu¨dB™dFœg
[
i
], "rwp_guard_band_flag" );

1228 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_¥ojRegi⁄Width
[
i
], 32, "proj_region_width" );

1229 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_¥ojRegi⁄Height
[
i
], 32, "proj_region_height" );

1230 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_rwpProjRegi⁄T›
[
i
], 32, "rwp_proj_regionTop" );

1231 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_¥ojRegi⁄Le·
[
i
], 32, "proj_region_left" );

1232 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_∑ckedRegi⁄Width
[
i
], 16, "packed_region_width" );

1233 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_∑ckedRegi⁄Height
[
i
], 16, "packed_region_height" );

1234 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_∑ckedRegi⁄T›
[
i
], 16, "packed_region_top" );

1235 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_∑ckedRegi⁄Le·
[
i
], 16, "packed_region_left" );

1236 if–
£i
.
m_rwpGu¨dB™dFœg
[
i
] )

1238 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_rwpLe·Gu¨dB™dWidth
[
i
], 8, "rwp_left_guard_band_width");

1239 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_rwpRightGu¨dB™dWidth
[
i
], 8, "rwp_right_guard_band_width");

1240 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_rwpT›Gu¨dB™dHeight
[
i
], 8, "rwp_top_guard_band_height");

1241 
	`WRITE_CODE
–(
UI¡
)
£i
. 
m_rwpBŸtomGu¨dB™dHeight
[
i
], 8, "rwp_bottom_guard_band_height");

1242 
	`WRITE_FLAG
–
£i
.
m_rwpGu¨dB™dNŸU£dF‹PªdFœg
[
i
], "rwp_guard_band_not_used_forPred_flag" );

1243  
I¡
 
j
=0; j < 4; j++ )

1245 
	`WRITE_CODE
–(
UI¡
)
£i
.
m_rwpGu¨dB™dTy≥
[
i
*4 + 
j
], 3, "rwp_guard_band_type");

1247 
	`WRITE_CODE
( 0, 3, "rwp_guard_band_reserved_zero_3bits" );

1251 
	}
}

1253 
Void
 
	gSEIWrôî
::
	$xWrôeSEIFisheyeVideoInfo
(c⁄° 
SEIFisheyeVideoInfo
 &
£i
)

1255 c⁄° 
TComSEIFisheyeVideoInfo
 &
öfo
=
£i
.
vÆues
;

1256 
	`WRITE_FLAG
(
öfo
.
m_fisheyeC™˚lFœg
, "fisheye_cancel_flag");

1257 i‡(!
öfo
.
m_fisheyeC™˚lFœg
)

1259 
	`WRITE_FLAG
(
öfo
.
m_fisheyePîsi°í˚Fœg
, "fisheye_persistence_flag");

1260 
	`WRITE_CODE
((
UI¡
)
öfo
.
m_fisheyeVõwDimísi⁄Idc
, 3, "fisheye_view_dimension_idc");

1261 
	`WRITE_CODE
(0, 3, "fisheye_reserved_zero_3bits");

1262 
	`as£π
(
öfo
.
m_fisheyeA˘iveAªas
.
	`size
());

1263 
	`WRITE_CODE
((
UI¡
)
öfo
.
m_fisheyeA˘iveAªas
.
	`size
()-1, 8, "fisheye_num_active_area_minus1");

1265 
°d
::
size_t
 
i
 = 0; i < 
öfo
.
m_fisheyeA˘iveAªas
.
	`size
(); i++)

1267 c⁄° 
TComSEIFisheyeVideoInfo
::
A˘iveAªaInfo
 &
¨ó
=
öfo
.
m_fisheyeA˘iveAªas
[
i
];

1269 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeCúcuœrRegi⁄CíåeX
, 32, "fisheye_circular_region_centre_x[i]");

1270 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeCúcuœrRegi⁄CíåeY
, 32, "fisheye_circular_region_centre_y[i]");

1271 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeRe˘Regi⁄T›
, 32, "fisheye_rect_region_top[i]");

1272 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeRe˘Regi⁄Le·
, 32, "fisheye_rect_region_left[i]");

1273 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeRe˘Regi⁄Width
, 32, "fisheye_rect_region_width[i]");

1274 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeRe˘Regi⁄Height
, 32, "fisheye_rect_region_Height[i]");

1275 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeCúcuœrRegi⁄Radius
, 32, "fisheye_circular_region_radius[i]");

1276 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeS˚√Radius
, 32, "fisheye_scene_radius[i]");

1278 
	`WRITE_SCODE
((
I¡
)
¨ó
.
m_fisheyeCamîaCíåeAzimuth
, 32, "fisheye_camera_centre_azimuth[i]");

1279 
	`WRITE_SCODE
((
I¡
)
¨ó
.
m_fisheyeCamîaCíåeEÀv©i⁄
, 32, "fisheye_camera_centre_elevation[i]");

1280 
	`WRITE_SCODE
((
I¡
)
¨ó
.
m_fisheyeCamîaCíåeTût
, 32, "fisheye_camera_centre_tilt[i]");

1282 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeCamîaCíåeOff£tX
, 32, "fisheye_camera_centre_offset_x[i]");

1283 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeCamîaCíåeOff£tY
, 32, "fisheye_camera_centre_offset_x[i]");

1284 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeCamîaCíåeOff£tZ
, 32, "fisheye_camera_centre_offset_z[i]");

1285 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyeFõldOfVõw
, 32, "fisheye_field_of_view[i]");

1286 
	`WRITE_CODE
((
UI¡
)
¨ó
.
m_fisheyePﬁynomülC€ff
.
	`size
(), 16, "fisheye_num_polynomial_coeffs[i]");

1288 
°d
::
size_t
 
j
 = 0; j < 
¨ó
.
m_fisheyePﬁynomülC€ff
.
	`size
(); j++)

1290 
	`WRITE_SCODE
((
I¡
)
¨ó
.
m_fisheyePﬁynomülC€ff
[
j
], 32, "fisheye_polynomial_coeff[i][j]");

1294 
	}
}

1296 
Void
 
	gSEIWrôî
::
	$xWrôeSEICﬁourRem≠pögInfo
(c⁄° 
SEICﬁourRem≠pögInfo
& 
£i
)

1298 
	`WRITE_UVLC
–
£i
.
m_cﬁourRem≠Id
, "colour_remap_id" );

1299 
	`WRITE_FLAG
–
£i
.
m_cﬁourRem≠C™˚lFœg
, "colour_remap_cancel_flag" );

1300 if–!
£i
.
m_cﬁourRem≠C™˚lFœg
 )

1302 
	`WRITE_FLAG
–
£i
.
m_cﬁourRem≠Pîsi°í˚Fœg
, "colour_remap_persistence_flag" );

1303 
	`WRITE_FLAG
–
£i
.
m_cﬁourRem≠VideoSig«lInfoPª£¡Fœg
, "colour_remap_video_signal_info_present_flag" );

1304 i‡–
£i
.
m_cﬁourRem≠VideoSig«lInfoPª£¡Fœg
 )

1306 
	`WRITE_FLAG
–
£i
.
m_cﬁourRem≠FuŒR™geFœg
, "colour_remap_full_range_flag" );

1307 
	`WRITE_CODE
–
£i
.
m_cﬁourRem≠Prim¨õs
, 8, "colour_remap_primaries" );

1308 
	`WRITE_CODE
–
£i
.
m_cﬁourRem≠Tøns„rFun˘i⁄
, 8, "colour_remap_transfer_function" );

1309 
	`WRITE_CODE
–
£i
.
m_cﬁourRem≠M©rixC€fficõ¡s
, 8, "colour_remap_matrix_coefficients" );

1311 
	`WRITE_CODE
–
£i
.
m_cﬁourRem≠I≈utBôDïth
, 8, "colour_remap_input_bit_depth" );

1312 
	`WRITE_CODE
–
£i
.
m_cﬁourRem≠BôDïth
, 8, "colour_remap_bit_depth" );

1313  
I¡
 
c
=0 ; c<3 ; c++ )

1315 
	`WRITE_CODE
–
£i
.
m_¥eLutNumVÆMöus1
[
c
], 8, "pre_lut_num_val_minus1[c]" );

1316 if–
£i
.
m_¥eLutNumVÆMöus1
[
c
]>0 )

1318  
I¡
 
i
=0 ; i<=
£i
.
m_¥eLutNumVÆMöus1
[
c
] ; i++ )

1320 
	`WRITE_CODE
–
£i
.
m_¥eLut
[
c
][
i
].
codedVÆue
, (–£i.
m_cﬁourRem≠I≈utBôDïth
 + 7 ) >> 3 ) << 3, "pre_lut_coded_value[c][i]" );

1321 
	`WRITE_CODE
–
£i
.
m_¥eLut
[
c
][
i
].
èrgëVÆue
, (–£i.
m_cﬁourRem≠BôDïth
 + 7 ) >> 3 ) << 3, "pre_lut_target_value[c][i]" );

1325 
	`WRITE_FLAG
–
£i
.
m_cﬁourRem≠M©rixPª£¡Fœg
, "colour_remap_matrix_present_flag" );

1326 if–
£i
.
m_cﬁourRem≠M©rixPª£¡Fœg
 )

1328 
	`WRITE_CODE
–
£i
.
m_log2M©rixDíom
, 4, "log2_matrix_denom" );

1329  
I¡
 
c
=0 ; c<3 ; c++ )

1331  
I¡
 
i
=0 ; i<3 ; i++ )

1333 
	`WRITE_SVLC
–
£i
.
m_cﬁourRem≠C€ffs
[
c
][
i
], "colour_remap_coeffs[c][i]" );

1338  
I¡
 
c
=0 ; c<3 ; c++ )

1340 
	`WRITE_CODE
–
£i
.
m_po°LutNumVÆMöus1
[
c
], 8, "m_postLutNumValMinus1[c]" );

1341 if–
£i
.
m_po°LutNumVÆMöus1
[
c
]>0 )

1343  
I¡
 
i
=0 ; i<=
£i
.
m_po°LutNumVÆMöus1
[
c
] ; i++ )

1345 
	`WRITE_CODE
–
£i
.
m_po°Lut
[
c
][
i
].
codedVÆue
, (–£i.
m_cﬁourRem≠BôDïth
 + 7 ) >> 3 ) << 3, "post_lut_coded_value[c][i]" );

1346 
	`WRITE_CODE
–
£i
.
m_po°Lut
[
c
][
i
].
èrgëVÆue
, (–£i.
m_cﬁourRem≠BôDïth
 + 7 ) >> 3 ) << 3, "post_lut_target_value[c][i]" );

1351 
	}
}

1354 
Void
 
	gSEIWrôî
::
	$xWrôeSEIDeöãæa˚FõldIdítifiˇti⁄
(c⁄° 
SEIDeöãæa˚FõldIdítifiˇti⁄
& 
£i
)

1356 
	`WRITE_FLAG
–
£i
.
m_deöãæa˚dPi˘uªSour˚P¨ôyFœg
, "deinterlaced_picture_source_parity_flag" );

1357 
	}
}

1360 
Void
 
	gSEIWrôî
::
	$xWrôeSEIC⁄ã¡LightLevñInfo
(c⁄° 
SEIC⁄ã¡LightLevñInfo
& 
£i
)

1362 
	`WRITE_CODE
–
£i
.
m_maxC⁄ã¡LightLevñ
, 16, "max_content_light_level" );

1363 
	`WRITE_CODE
–
£i
.
m_maxPicAvîageLightLevñ
, 16, "max_pic_average_light_level" );

1364 
	}
}

1367 
Void
 
	gSEIWrôî
::
	$xWrôeSEIDïídítRAPIndiˇti⁄
(c⁄° 
SEIDïídítRAPIndiˇti⁄
& )

1370 
	}
}

1373 
Void
 
SEIWrôî
::
	$xWrôeSEICodedRegi⁄Com∂ëi⁄
(c⁄° 
SEICodedRegi⁄Com∂ëi⁄
& 
£i
)

1375 
	`WRITE_UVLC
–
£i
.
m_√xtSegmítAddªss
, "next_segment_address" );

1376 i‡(
£i
.
m_√xtSegmítAddªss
)

1378 
	`WRITE_FLAG
–
£i
.
m_ödïídítSli˚SegmítFœg
, "independent_slice_segment_flag" );

1380 
	}
}

1383 
Void
 
	gSEIWrôî
::
	$xWrôeSEIA…î«tiveTøns„rCh¨a˘îi°ics
(c⁄° 
SEIA…î«tiveTøns„rCh¨a˘îi°ics
& 
£i
)

1385 
	`WRITE_CODE
(
£i
.
m_¥e„ºedTøns„rCh¨a˘îi°ics
, 8, "preferred_transfer_characteristics");

1386 
	}
}

1389 
Void
 
	gSEIWrôî
::
	$xWrôeSEIAmbõ¡VõwögEnvú⁄mít
(c⁄° 
SEIAmbõ¡VõwögEnvú⁄mít
& 
£i
)

1391 
	`WRITE_CODE
(
£i
.
m_ambõ¡IŒumö™˚
, 32, "ambient_illuminance" );

1392 
	`WRITE_CODE
(
£i
.
m_ambõ¡LightX
, 16, "ambient_light_x" );

1393 
	`WRITE_CODE
(
£i
.
m_ambõ¡LightY
, 16, "ambient_light_y" );

1394 
	}
}

1396 
Void
 
	gSEIWrôî
::
	$xWrôeSEIRegi⁄ÆNe°ög
(
TComBôIf
& 
bs
, c⁄° 
SEIRegi⁄ÆNe°ög
& 
£i
, c⁄° 
TComSPS
 *
•s
)

1398 
	`WRITE_CODE
(
£i
.
	`gëRNId
(), 16, "regional_nesting_id");

1399 
	`WRITE_CODE
(
£i
.
	`gëNumRe˘Regi⁄s
(), 8, "regional_nesting_num_rect_regions");

1400 c⁄° 
RNSEIWödowVec
 
ªgi⁄s
 = 
£i
.
	`gëRegi⁄s
();

1401 
RNSEIWödowVec
::
c⁄°_ôî©‹
 
ô
 = 
ªgi⁄s
.
	`begö
(); ià!ªgi⁄s.
	`íd
(); it++)

1403 
	`as£π
((*
ô
).
	`gëWödowE«bÀdFœg
());

1404 
	`WRITE_CODE
((*
ô
).
	`gëRegi⁄Id
(), 8, "regional_nesting_rect_region_id[i]");

1405 
	`WRITE_CODE
((*
ô
).
	`gëWödowLe·Off£t
(), 16, "regional_nesting_rect_left_offset[i]");

1406 
	`WRITE_CODE
((*
ô
).
	`gëWödowRightOff£t
(), 16, "regional_nesting_rect_right_offset[i]");

1407 
	`WRITE_CODE
((*
ô
).
	`gëWödowT›Off£t
(), 16, "regional_nesting_rect_top_offset[i]");

1408 
	`WRITE_CODE
((*
ô
).
	`gëWödowBŸtomOff£t
(), 16, "regional_nesting_rect_bottom_offset[i]");

1410 
	`as£π
(
£i
.
	`gëNumRnSEIMesßge
() >= 1);

1411 
	`WRITE_CODE
(
£i
.
	`gëNumRnSEIMesßge
()-1, 8, "num_sei_messages_in_regional_nesting_minus1");

1412 c⁄° 
°d
::
ve˘‹
<
SEIRegi⁄ÆNe°ög
::
SEILi°OfIndi˚s
> 
£iMesßges
 = 
£i
.
	`gëRnSEIMesßges
();

1413 
°d
::
ve˘‹
<
SEIRegi⁄ÆNe°ög
::
SEILi°OfIndi˚s
>::
c⁄°_ôî©‹
 
ô
;

1414 
ô
 = 
£iMesßges
.
	`begö
(); ià!£iMesßges.
	`íd
(); it++)

1416 
°d
::
ve˘‹
<
UI¡
> 
li°OfRegi⁄s
 = (*
ô
).
m_li°OfIndi˚s
;

1417 
SEI
 *
√°edSEI
 = (*
ô
).
m_£iMesßge
;

1418 
	`WRITE_CODE
((
UI¡
)
li°OfRegi⁄s
.
	`size
(), 8, "num_regions_for_sei_message[i]");

1419 
I¡
 
j
 = 0; j < 
li°OfRegi⁄s
.
	`size
(); j++)

1421 
	`WRITE_CODE
(
li°OfRegi⁄s
[
j
], 8, "regional_nesting_sei_region_idx[i][j]");

1423 
	`xWrôeSEImesßge
(
bs
, 
√°edSEI
, 
•s
);

1425 
	}
}

1427 
Void
 
	gSEIWrôî
::
	$xWrôeSEIA¬Ÿ©edRegi⁄s
(c⁄° 
SEIA¬Ÿ©edRegi⁄s
 &
£i
, c⁄° 
TComSPS
 *
•s
)

1429 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_ˇn˚lFœg
, "ar_cancel_flag");

1430 i‡(!
£i
.
m_hdr
.
m_ˇn˚lFœg
)

1432 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_nŸO±imizedF‹VõwögFœg
, "ar_not_optimized_for_viewing_flag");

1433 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_åueMŸi⁄Fœg
, "ar_true_motion_flag");

1434 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_oc˛udedObje˘Fœg
, "ar_occluded_object_flag");

1435 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_∑πülObje˘FœgPª£¡Fœg
, "ar_partial_object_flag_present_flag");

1436 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_obje˘LabñPª£¡Fœg
, "ar_object_label_present_flag");

1437 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
, "ar_object_confidence_info_present_flag");

1438 i‡(
£i
.
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
)

1440 
	`as£π
(
£i
.
m_hdr
.
m_obje˘C⁄fidí˚Lígth
 <= 16 && sei.m_hdr.m_objectConfidenceLength>0);

1441 
	`WRITE_CODE
((
£i
.
m_hdr
.
m_obje˘C⁄fidí˚Lígth
 - 1), 4, "ar_object_confidence_length_minus_1");

1443 i‡(
£i
.
m_hdr
.
m_obje˘LabñPª£¡Fœg
)

1445 
	`WRITE_FLAG
(
£i
.
m_hdr
.
m_obje˘LabñL™guagePª£¡Fœg
, "ar_object_label_language_present_flag");

1446 i‡(
£i
.
m_hdr
.
m_obje˘LabñL™guagePª£¡Fœg
)

1448 
	`xWrôeByãAlign
();

1449 
	`as£π
(
£i
.
m_hdr
.
m_™nŸ©edRegi⁄sObje˘LabñL™g
.
	`size
()<256);

1450 
UI¡
 
j
 = 0; j < 
£i
.
m_hdr
.
m_™nŸ©edRegi⁄sObje˘LabñL™g
.
	`size
(); j++)

1452 
UCh¨
 
ch
 = 
£i
.
m_hdr
.
m_™nŸ©edRegi⁄sObje˘LabñL™g
[
j
];

1453 
	`WRITE_CODE
(
ch
, 8, "ar_object_label_language");

1455 
	`WRITE_CODE
('\0', 8, "ar_label_language");

1458 
	`WRITE_UVLC
((
UI¡
)
£i
.
m_™nŸ©edLabñs
.
	`size
(), "ar_num_label_updates");

1459 
	`as£π
(
£i
.
m_™nŸ©edLabñs
.
	`size
()<256);

1460 autÿ
ô
=
£i
.
m_™nŸ©edLabñs
.
	`begö
(); it!=£i.m_™nŸ©edLabñs.
	`íd
(); it++)

1462 
	`as£π
(
ô
->
fú°
 < 256);

1463 
	`WRITE_UVLC
(
ô
->
fú°
, "ar_label_idx[]");

1464 c⁄° 
SEIA¬Ÿ©edRegi⁄s
::
A¬Ÿ©edRegi⁄Labñ
 &
¨
=
ô
->
£c⁄d
;

1465 
	`WRITE_FLAG
(!
¨
.
œbñVÆid
, "ar_label_cancel_flag");

1466 i‡(
¨
.
œbñVÆid
)

1468 
	`xWrôeByãAlign
();

1469 
	`as£π
(
¨
.
œbñ
.
	`size
()<256);

1470 
UI¡
 
j
 = 0; j < 
¨
.
œbñ
.
	`size
(); j++)

1472 
UCh¨
 
ch
 = 
¨
.
œbñ
[
j
];

1473 
	`WRITE_CODE
(
ch
, 8, "ar_label[]");

1475 
	`WRITE_CODE
('\0', 8, "ar_label[]");

1478 
	`WRITE_UVLC
((
UI¡
)
£i
.
m_™nŸ©edRegi⁄s
.
	`size
(), "ar_num_object_updates");

1479 
	`as£π
(
£i
.
m_™nŸ©edRegi⁄s
.
	`size
()<256);

1480 autÿ
ô
=
£i
.
m_™nŸ©edRegi⁄s
.
	`begö
(); it!=£i.m_™nŸ©edRegi⁄s.
	`íd
(); it++)

1482 c⁄° 
SEIA¬Ÿ©edRegi⁄s
::
A¬Ÿ©edRegi⁄Obje˘
 &
¨
 = 
ô
->
£c⁄d
;

1483 
	`WRITE_UVLC
(
ô
->
fú°
, "ar_object_idx");

1484 
	`WRITE_FLAG
(
¨
.
obje˘C™˚lFœg
, "ar_object_cancel_flag");

1485 i‡(!
¨
.
obje˘C™˚lFœg
)

1487 i‡(
£i
.
m_hdr
.
m_obje˘LabñPª£¡Fœg
)

1489 
	`WRITE_FLAG
(
¨
.
obje˘LabñVÆid
, "ar_object_label_update_flag");

1490 i‡(
¨
.
obje˘LabñVÆid
)

1492 
	`as£π
(
¨
.
objLabñIdx
<256);

1493 
	`WRITE_UVLC
(
¨
.
objLabñIdx
, "ar_object_label_idx");

1496 
	`WRITE_FLAG
(
¨
.
boundögBoxVÆid
, "ar_object_bounding_box_update_flag");

1497 i‡(
¨
.
boundögBoxVÆid
)

1499 
	`WRITE_CODE
(
¨
.
boundögBoxT›
, 16, "ar_bounding_box_top");

1500 
	`WRITE_CODE
(
¨
.
boundögBoxLe·
, 16, "ar_bounding_box_left");

1501 
	`WRITE_CODE
(
¨
.
boundögBoxWidth
, 16, "ar_bounding_box_width");

1502 
	`WRITE_CODE
(
¨
.
boundögBoxHeight
,16, "ar_bounding_box_height");

1503 i‡(
£i
.
m_hdr
.
m_∑πülObje˘FœgPª£¡Fœg
)

1505 
	`WRITE_UVLC
(
¨
.
∑πülObje˘Fœg
, "ar_partial_object_flag");

1507 i‡(
£i
.
m_hdr
.
m_obje˘C⁄fidí˚InfoPª£¡Fœg
)

1509 
	`as£π
(
¨
.
obje˘C⁄fidí˚
 < (1<<
£i
.
m_hdr
.
m_obje˘C⁄fidí˚Lígth
));

1510 
	`WRITE_CODE
(
¨
.
obje˘C⁄fidí˚
, 
£i
.
m_hdr
.
m_obje˘C⁄fidí˚Lígth
, "ar_object_confidence");

1516 
	}
}

1517 
Void
 
	gSEIWrôî
::
	$xWrôeByãAlign
()

1519 if–
m_pcBôIf
->
	`gëNumbîOfWrôãnBôs
() % 8 != 0)

1521 
	`WRITE_FLAG
( 1, "payload_bit_equal_to_one" );

1522  
m_pcBôIf
->
	`gëNumbîOfWrôãnBôs
() % 8 != 0 )

1524 
	`WRITE_FLAG
( 0, "payload_bit_equal_to_zero" );

1527 
	}
}

	@TLibEncoder/SEIwrite.h

34 #¥agm®
⁄˚


36 #i‚de‡
__SEIWRITE__


37 
	#__SEIWRITE__


	)

39 
	~"Sy¡axEÀmítWrôî.h
"

40 
	~"TLibComm⁄/SEI.h
"

42 
˛ass
 
	gTComBôIf
;

46 ˛as†
	cSEIWrôî
:
public
 
Sy¡axEÀmítWrôî


48 
public
:

49 
	$SEIWrôî
() {};

50 
vútuÆ
 ~
	$SEIWrôî
(Ë{
	}
};

52 
Void
 
wrôeSEImesßges
(
TComBôIf
& 
bs
, c⁄° 
SEIMesßges
 &
£iLi°
, c⁄° 
TComSPS
 *
•s
, 
Boﬁ
 
isNe°ed
);

54 
	g¥Ÿe˘ed
:

55 
Void
 
xWrôeSEImesßge
 (
TComBôIf
& 
bs
, c⁄° 
SEI
 *
£i
, c⁄° 
TComSPS
 *
•s
);

57 
Void
 
xWrôeSEIBuf„rögPîiod
 (c⁄° 
SEIBuf„rögPîiod
& 
£i
, c⁄° 
TComSPS
 *
•s
);

58 
Void
 
xWrôeSEIPi˘uªTimög
 (c⁄° 
SEIPi˘uªTimög
& 
£i
, c⁄° 
TComSPS
 *
•s
);

59 
Void
 
xWrôeSEIP™SˇnRe˘
 (c⁄° 
SEIP™SˇnRe˘
& 
£i
);

60 
Void
 
xWrôeSEIFûÀrPaylﬂd
 (c⁄° 
SEIFûÀrPaylﬂd
& 
£i
);

61 
Void
 
xWrôeSEIU£rD©aRegi°îed
 (c⁄° 
SEIU£rD©aRegi°îed
& 
£i
);

62 
Void
 
xWrôeSEIU£rD©aUƒegi°îed
 (c⁄° 
SEIU£rD©aUƒegi°îed
 &
£i
);

63 
Void
 
xWrôeSEIRecovîyPoöt
 (c⁄° 
SEIRecovîyPoöt
& 
£i
);

64 
Void
 
xWrôeSEIS˚√Info
 (c⁄° 
SEIS˚√Info
& 
£i
);

65 
Void
 
xWrôeSEIPi˘uªS«pshŸ
 (c⁄° 
SEIPi˘uªS«pshŸ
& 
£i
);

66 
Void
 
xWrôeSEIProgªssiveReföemítSegmítSèπ
 (c⁄° 
SEIProgªssiveReföemítSegmítSèπ
& 
£i
);

67 
Void
 
xWrôeSEIProgªssiveReföemítSegmítEnd
 (c⁄° 
SEIProgªssiveReföemítSegmítEnd
& 
£i
);

68 
Void
 
xWrôeSEIFûmGøöCh¨a˘îi°ics
 (c⁄° 
SEIFûmGøöCh¨a˘îi°ics
& 
£i
);

69 
Void
 
xWrôeSEIPo°FûãrHöt
 (c⁄° 
SEIPo°FûãrHöt
& 
£i
, c⁄° 
TComSPS
 *
•s
);

70 
Void
 
xWrôeSEIT⁄eM≠pögInfo
 (c⁄° 
SEIT⁄eM≠pögInfo
& 
£i
);

71 
Void
 
xWrôeSEIFømePackög
 (c⁄° 
SEIFømePackög
& 
£i
);

72 
Void
 
xWrôeSEIDi•œyOrõ¡©i⁄
 (c⁄° 
SEIDi•œyOrõ¡©i⁄
 &
£i
);

73 
Void
 
xWrôeSEIGªíMëad©aInfo
 (c⁄° 
SEIGªíMëad©aInfo
 &
£i
);

74 
Void
 
xWrôeSEISOPDes¸ùti⁄
 (c⁄° 
SEISOPDes¸ùti⁄
& 
£i
);

75 
Void
 
xWrôeSEIA˘iveP¨amëîSës
 (c⁄° 
SEIA˘iveP¨amëîSës
& 
£i
);

76 
Void
 
xWrôeSEIDecodögUnôInfo
 (c⁄° 
SEIDecodögUnôInfo
& 
£i
, c⁄° 
TComSPS
 *
•s
);

77 
Void
 
xWrôeSEITemp‹ÆLevñ0Index
 (c⁄° 
SEITemp‹ÆLevñ0Index
 &
£i
);

78 
Void
 
xWrôeSEIDecodedPi˘uªHash
 (c⁄° 
SEIDecodedPi˘uªHash
& 
£i
);

79 
Void
 
xWrôeSEISˇœbÀNe°ög
 (
TComBôIf
& 
bs
, c⁄° 
SEISˇœbÀNe°ög
& 
£i
, c⁄° 
TComSPS
 *
•s
);

80 
Void
 
xWrôeSEIRegi⁄Re‰eshInfo
 (c⁄° 
SEIRegi⁄Re‰eshInfo
 &
£i
);

81 
Void
 
xWrôeSEINoDi•œy
 (c⁄° 
SEINoDi•œy
 &
£i
);

82 
Void
 
xWrôeSEITimeCode
 (c⁄° 
SEITimeCode
& 
£i
);

83 
Void
 
xWrôeSEIMa°îögDi•œyCﬁourVﬁume
 (c⁄° 
SEIMa°îögDi•œyCﬁourVﬁume
& 
£i
);

84 
Void
 
xWrôeSEISegmíãdRe˘FømePackög
 (c⁄° 
SEISegmíãdRe˘FømePackög
& 
£i
);

85 
Void
 
xWrôeSEITempMŸi⁄C⁄°øöedTûeSës
 (c⁄° 
SEITempMŸi⁄C⁄°øöedTûeSës
& 
£i
);

86 #i‡
MCTS_EXTRACTION


87 
Void
 
xWrôeSEIMCTSExåa˘i⁄InfoSë
 (c⁄° 
SEIMCTSExåa˘i⁄InfoSë
& 
£i
);

89 
Void
 
xWrôeSEIChromaReßm∂ögFûãrHöt
 (c⁄° 
SEIChromaReßm∂ögFûãrHöt
& 
£i
);

90 
Void
 
xWrôeSEIK√eFun˘i⁄Info
 (c⁄° 
SEIK√eFun˘i⁄Info
 &
£i
);

91 
Void
 
xWrôeSEIC⁄ã¡CﬁourVﬁume
 (c⁄° 
SEIC⁄ã¡CﬁourVﬁume
 &
£i
);

92 
Void
 
xWrôeSEIEquúe˘™guœrProje˘i⁄
 (c⁄° 
SEIEquúe˘™guœrProje˘i⁄
 &
£i
);

93 
Void
 
xWrôeSEISphîeRŸ©i⁄
 (c⁄° 
SEISphîeRŸ©i⁄
 &
£i
);

94 
Void
 
xWrôeSEIOmniVõwp‹t
 (c⁄° 
SEIOmniVõwp‹t
& 
£i
);

95 
Void
 
xWrôeSEICubem≠Proje˘i⁄
 (c⁄° 
SEICubem≠Proje˘i⁄
 &
£i
);

96 
Void
 
xWrôeSEIRegi⁄Wi£Packög
 (c⁄° 
SEIRegi⁄Wi£Packög
 &
£i
);

97 
Void
 
xWrôeSEIFisheyeVideoInfo
 (c⁄° 
SEIFisheyeVideoInfo
 &
£i
);

98 
Void
 
xWrôeSEICﬁourRem≠pögInfo
 (c⁄° 
SEICﬁourRem≠pögInfo
& 
£i
);

99 
Void
 
xWrôeSEIDeöãæa˚FõldIdítifiˇti⁄
 (c⁄° 
SEIDeöãæa˚FõldIdítifiˇti⁄
& 
£i
);

100 
Void
 
xWrôeSEIC⁄ã¡LightLevñInfo
 (c⁄° 
SEIC⁄ã¡LightLevñInfo
& 
£i
);

101 
Void
 
xWrôeSEIDïídítRAPIndiˇti⁄
 (c⁄° 
SEIDïídítRAPIndiˇti⁄
& 
£i
);

102 
Void
 
xWrôeSEICodedRegi⁄Com∂ëi⁄
 (c⁄° 
SEICodedRegi⁄Com∂ëi⁄
& 
£i
);

103 
Void
 
xWrôeSEIA…î«tiveTøns„rCh¨a˘îi°ics
(c⁄° 
SEIA…î«tiveTøns„rCh¨a˘îi°ics
& 
£i
);

104 
Void
 
xWrôeSEIAmbõ¡VõwögEnvú⁄mít
 (c⁄° 
SEIAmbõ¡VõwögEnvú⁄mít
& 
£i
);

105 
Void
 
xWrôeSEIRegi⁄ÆNe°ög
 (
TComBôIf
& 
bs
, c⁄° 
SEIRegi⁄ÆNe°ög
& 
£i
, c⁄° 
TComSPS
 *
•s
);

107 
Void
 
xWrôeSEIA¬Ÿ©edRegi⁄s
 (c⁄° 
SEIA¬Ÿ©edRegi⁄s
& 
£i
, c⁄° 
TComSPS
 *
•s
);

108 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


109 
Void
 
xWrôeSEIShuâîI¡îvÆ
 (c⁄° 
SEIShuâîI¡îvÆInfo
& 
£i
);

111 
Void
 
xWrôeSEI∑ylﬂdD©a
(
TComBôIf
& 
bs
, c⁄° 
SEI
& 
£i
, c⁄° 
TComSPS
 *
•s
);

112 
Void
 
xWrôeByãAlign
();

	@TLibEncoder/SyntaxElementWriter.cpp

38 
	~"TLibComm⁄/Comm⁄Def.h
"

39 
	~"Sy¡axEÀmítWrôî.h
"

44 #i‡
ENC_DEC_TRACE


46 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeSCodeTr
 (
I¡
 
vÆue
, 
UI¡
 
Àngth
, c⁄° 
TCh¨
 *
pSymbﬁName
)

48 
	`xWrôeSCode
 (
vÆue
,
Àngth
);

49 if–
g_HLSTø˚E«bÀ
 )

51 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

52 if–
Àngth
<10 )

54 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË : %d\n", 
pSymbﬁName
, 
Àngth
, 
vÆue
 );

58 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË: %d\n", 
pSymbﬁName
, 
Àngth
, 
vÆue
 );

61 
	}
}

63 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeCodeTr
 (
UI¡
 
vÆue
, UI¡ 
Àngth
, c⁄° 
TCh¨
 *
pSymbﬁName
)

65 
	`xWrôeCode
 (
vÆue
,
Àngth
);

66 if–
g_HLSTø˚E«bÀ
 )

68 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

69 if–
Àngth
<10 )

71 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË : %d\n", 
pSymbﬁName
, 
Àngth
, 
vÆue
 );

75 
	`Ârötf
–
g_hTø˚
, "%-50†u(%dË: %d\n", 
pSymbﬁName
, 
Àngth
, 
vÆue
 );

78 
	}
}

80 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeUvlcTr
 (
UI¡
 
vÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

82 
	`xWrôeUvlc
 (
vÆue
);

83 if–
g_HLSTø˚E«bÀ
 )

85 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

86 
	`Ârötf
–
g_hTø˚
, "%-50†ue(vË: %d\n", 
pSymbﬁName
, 
vÆue
 );

88 
	}
}

90 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeSvlcTr
 (
I¡
 
vÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

92 
	`xWrôeSvlc
(
vÆue
);

93 if–
g_HLSTø˚E«bÀ
 )

95 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

96 
	`Ârötf
–
g_hTø˚
, "%-50†£(vË: %d\n", 
pSymbﬁName
, 
vÆue
 );

98 
	}
}

100 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeFœgTr
(
UI¡
 
vÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
)

102 
	`xWrôeFœg
(
vÆue
);

103 if–
g_HLSTø˚E«bÀ
 )

105 
	`Ârötf
–
g_hTø˚
, "%8Œd ", 
g_nSymbﬁCou¡î
++ );

106 
	`Ârötf
–
g_hTø˚
, "%-50†u(1Ë : %d\n", 
pSymbﬁName
, 
vÆue
 );

108 
	}
}

112 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeSCode
 ( 
I¡
 
iCode
, 
UI¡
 
uiLígth
 )

114 
	`as£π
 ( 
uiLígth
 > 0 && uiLength<=32 );

115 
	`as£π
–
uiLígth
==32 || (
iCode
>=-(1<<(uiLength-1)) && iCode<(1<<(uiLength-1))) );

116 
m_pcBôIf
->
	`wrôe
–
uiLígth
==32 ? 
	`UI¡
(
iCode
) : ( UInt(iCode)&((1<<uiLength)-1) ), uiLength );

117 
	}
}

119 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeCode
 ( 
UI¡
 
uiCode
, UI¡ 
uiLígth
 )

121 
	`as£π
 ( 
uiLígth
 > 0 );

122 
m_pcBôIf
->
	`wrôe
–
uiCode
, 
uiLígth
 );

123 
	}
}

125 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeUvlc
 ( 
UI¡
 
uiCode
 )

127 
UI¡
 
uiLígth
 = 1;

128 
UI¡
 
uiTemp
 = ++
uiCode
;

130 
	`as£π
 ( 
uiTemp
 );

132  1 !
uiTemp
 )

134 
uiTemp
 >>= 1;

135 
uiLígth
 += 2;

138 
m_pcBôIf
->
	`wrôe
–0, 
uiLígth
 >> 1);

139 
m_pcBôIf
->
	`wrôe
–
uiCode
, (
uiLígth
+1) >> 1);

140 
	}
}

142 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeSvlc
 ( 
I¡
 
iCode
 )

144 
UI¡
 
uiCode
;

146 
uiCode
 = 
	`xC⁄vîtToUI¡
–
iCode
 );

147 
	`xWrôeUvlc
–
uiCode
 );

148 
	}
}

150 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeFœg
–
UI¡
 
uiCode
 )

152 
m_pcBôIf
->
	`wrôe
–
uiCode
, 1 );

153 
	}
}

155 
Void
 
	gSy¡axEÀmítWrôî
::
	$xWrôeRb•TøûögBôs
()

157 
	`WRITE_FLAG
( 1, "rbsp_stop_one_bit");

158 
I¡
 
˙t
 = 0;

159 
m_pcBôIf
->
	`gëNumBôsU¡ûByãAlig√d
())

161 
	`WRITE_FLAG
( 0, "rbsp_alignment_zero_bit");

162 
˙t
++;

164 
	`as£π
(
˙t
<8);

165 
	}
}

	@TLibEncoder/SyntaxElementWriter.h

38 #i‚de‡
__SYNTAXELEMENTWRITER__


39 
	#__SYNTAXELEMENTWRITER__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/Comm⁄Def.h
"

46 
	~"TLibComm⁄/TComBôSåóm.h
"

47 
	~"TLibComm⁄/TComRom.h
"

52 #i‡
ENC_DEC_TRACE


53 
	#WRITE_SCODE
–
vÆue
, 
Àngth
, 
«me
Ë
	`xWrôeSCodeTr
 ( vÆue,Üígth,Çamê)

	)

54 
	#WRITE_CODE
–
vÆue
, 
Àngth
, 
«me
Ë
	`xWrôeCodeTr
 ( vÆue,Üígth,Çamê)

	)

55 
	#WRITE_UVLC
–
vÆue
, 
«me
Ë
	`xWrôeUvlcTr
 ( vÆue,Çamê)

	)

56 
	#WRITE_SVLC
–
vÆue
, 
«me
Ë
	`xWrôeSvlcTr
 ( vÆue,Çamê)

	)

57 
	#WRITE_FLAG
–
vÆue
, 
«me
Ë
	`xWrôeFœgTr
 ( vÆue,Çamê)

	)

60 
	#WRITE_SCODE
–
vÆue
, 
Àngth
, 
«me
Ë
	`xWrôeSCode
 ( vÆue,Üígth )

	)

61 
	#WRITE_CODE
–
vÆue
, 
Àngth
, 
«me
Ë
	`xWrôeCode
 ( vÆue,Üígth )

	)

62 
	#WRITE_UVLC
–
vÆue
, 
«me
Ë
	`xWrôeUvlc
 ( vÆuê)

	)

63 
	#WRITE_SVLC
–
vÆue
, 
«me
Ë
	`xWrôeSvlc
 ( vÆuê)

	)

64 
	#WRITE_FLAG
–
vÆue
, 
«me
Ë
	`xWrôeFœg
 ( vÆuê)

	)

68 ˛as†
	cSy¡axEÀmítWrôî


70 
	m¥Ÿe˘ed
:

71 
TComBôIf
* 
m_pcBôIf
;

73 
	$Sy¡axEÀmítWrôî
()

74 :
	$m_pcBôIf
(
NULL
)

76 
vútuÆ
 ~
	$Sy¡axEÀmítWrôî
(Ë{
	}
};

78 
Void
 
	$£tBô°ªam
 ( 
TComBôIf
* 
p
 ) { 
m_pcBôIf
 =Ö; 
	}
}

80 
Void
 
xWrôeSCode
 ( 
I¡
 
iCode
, 
UI¡
 
uiLígth
 );

81 
Void
 
xWrôeCode
 ( 
UI¡
 
uiCode
, UI¡ 
uiLígth
 );

82 
Void
 
xWrôeUvlc
 ( 
UI¡
 
uiCode
 );

83 
Void
 
xWrôeSvlc
 ( 
I¡
 
iCode
 );

84 
Void
 
xWrôeFœg
 ( 
UI¡
 
uiCode
 );

85 #i‡
ENC_DEC_TRACE


86 
Void
 
xWrôeSCodeTr
 ( 
I¡
 
vÆue
, 
UI¡
 
Àngth
, c⁄° 
TCh¨
 *
pSymbﬁName
);

87 
Void
 
xWrôeCodeTr
 ( 
UI¡
 
vÆue
, UI¡ 
Àngth
, c⁄° 
TCh¨
 *
pSymbﬁName
);

88 
Void
 
xWrôeUvlcTr
 ( 
UI¡
 
vÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
);

89 
Void
 
xWrôeSvlcTr
 ( 
I¡
 
vÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
);

90 
Void
 
xWrôeFœgTr
 ( 
UI¡
 
vÆue
, c⁄° 
TCh¨
 *
pSymbﬁName
);

92 
Void
 
xWrôeRb•TøûögBôs
();

94 
UI¡
 
	$xC⁄vîtToUI¡
 ( 
I¡
 
iVÆue
 ) {  ( iVÆuê<0Ë? -iVÆue<<1 : (iVÆue<<1)-1; 
	}
}

	@TLibEncoder/TEncAnalyze.h

38 #i‚de‡
__TENCANALYZE__


39 
	#__TENCANALYZE__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~<°dio.h
>

46 
	~<mem‹y.h
>

47 
	~<as£π.h
>

48 
	~"TLibComm⁄/Comm⁄Def.h
"

49 
	~"TLibComm⁄/TComChromaF‹m©.h
"

50 
	~"m©h.h
"

51 #i‡
EXTENSION_360_VIDEO


52 
	~"TAµEncHñ≥r360/TExt360EncA«lyze.h
"

63 ˛as†
	cTEncA«lyze


65 
	mpublic
:

66 
	sOuçutLogC⁄åﬁ


68 
Boﬁ
 
¥ötMSEBa£dSNR
;

69 
Boﬁ
 
	m¥ötSequí˚MSE
;

70 
Boﬁ
 
	m¥ötFømeMSE
;

71 
Boﬁ
 
	m¥ötMSSSIM
;

72 
Boﬁ
 
	m¥ötXPSNR
;

73 
Boﬁ
 
	m¥ötHexPîPOCPSNRs
;

76 
	sResu…D©a


78 
Resu…D©a
 (Ë: 
bôs
(0)

79 , 
xp¢r
(0)

81 
I¡
 
	gi
=0; i<
	gMAX_NUM_COMPONENT
; i++)

83 
	gp¢r
[
i
]=0;

84 
	gMSEyuv‰ame
[
i
]=0;

85 
	gMSSSIM
[
i
]=0;

88 
DoubÀ
 
	gp¢r
[
MAX_NUM_COMPONENT
];

89 
DoubÀ
 
	gbôs
;

90 
DoubÀ
 
	gMSEyuv‰ame
[
MAX_NUM_COMPONENT
];

91 
DoubÀ
 
	gMSSSIM
[
MAX_NUM_COMPONENT
];

92 
DoubÀ
 
	gxp¢r
;

95 
	g¥iv©e
:

96 
Resu…D©a
 
m_ru¬ögTŸÆ
;

97 
UI¡
 
	gm_uiNumPic
;

98 
DoubÀ
 
	gm_dFrmR©e
;

100 #i‡
EXTENSION_360_VIDEO


101 
TExt360EncA«lyze
 
	gm_ext360
;

104 
	gpublic
:

105 
vútuÆ
 ~
	$TEncA«lyze
(Ë{
	}
}

106 
	$TEncA«lyze
(Ë{ 
	`˛ór
(); 
	}
}

108 
Void
 
	$addResu…
–c⁄° 
Resu…D©a
 &
ªsu…
)

110 
m_ru¬ögTŸÆ
.
bôs
 +
ªsu…
.bits;

111 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
; i++)

113 
m_ru¬ögTŸÆ
.
p¢r
[
i
] +
ªsu…
.psnr[i];

114 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
i
] +
ªsu…
.MSEyuvframe[i];

115 
m_ru¬ögTŸÆ
.
MSSSIM
[
i
] +
ªsu…
.MSSSIM[i];

118 
m_ru¬ögTŸÆ
.
xp¢r
 +
ªsu…
.xpsnr;

119 
m_uiNumPic
++;

120 
	}
}

122 
DoubÀ
 
	$gëP¢r
(
Comp⁄ítID
 
compID
Ëc⁄° {  
m_ru¬ögTŸÆ
.
p¢r
[compID]; 
	}
}

123 
DoubÀ
 
	$gëMsssim
(
Comp⁄ítID
 
compID
Ëc⁄° {  
m_ru¬ögTŸÆ
.
MSSSIM
[compID]; 
	}
}

124 
DoubÀ
 
	$gëxPSNR
(Ëc⁄° {  
m_ru¬ögTŸÆ
.
xp¢r
;
	}
}

125 
DoubÀ
 
	$gëBôs
(Ëc⁄° {  
m_ru¬ögTŸÆ
.
bôs
; 
	}
}

126 
Void
 
	$£tBôs
(
DoubÀ
 
numBôs
Ë{ 
m_ru¬ögTŸÆ
.
bôs
ÚumBôs; 
	}
}

127 
UI¡
 
	$gëNumPic
(Ëc⁄° {  
m_uiNumPic
; 
	}
}

128 #i‡
EXTENSION_360_VIDEO


129 
	gTExt360EncA«lyze
& 
	$gëExt360Info
(Ë{  
m_ext360
; 
	}
}

132 
Void
 
	$£tFrmR©e
 (
DoubÀ
 
dFømeR©e
Ë{ 
m_dFrmR©e
 = dFømeR©e; 
	}
}

133 
Void
 
	$˛ór
()

135 
m_ru¬ögTŸÆ
=
	`Resu…D©a
();

136 
m_uiNumPic
 = 0;

137 #i‡
EXTENSION_360_VIDEO


138 
m_ext360
.
	`˛ór
();

140 
	}
}

143 
Void
 
	$ˇlcuœãComböedVÆues
(c⁄° 
ChromaF‹m©
 
chFmt
, 
DoubÀ
 &
PSNRyuv
, DoubÀ &
MSEyuv
, c⁄° 
BôDïths
 &
bôDïths
)

145 
MSEyuv
 = 0;

146 
I¡
 
sˇÀ
 = 0;

148 
I¡
 
maximumBôDïth
 = 
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_LUMA
];

149 
UI¡
 
ch™√lTy≥Index
 = 1; ch™√lTy≥Index < 
MAX_NUM_CHANNEL_TYPE
; channelTypeIndex++)

151 i‡(
bôDïths
.
ªc⁄
[
ch™√lTy≥Index
] > 
maximumBôDïth
)

153 
maximumBôDïth
 = 
bôDïths
.
ªc⁄
[
ch™√lTy≥Index
];

157 c⁄° 
UI¡
 
maxvÆ
 = 255 << (
maximumBôDïth
 - 8);

158 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
chFmt
);

160 
UI¡
 
comp
=0; comp<
numbîVÆidComp⁄íts
; comp++)

162 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp
);

163 c⁄° 
UI¡
 
csx
 = 
	`gëComp⁄ítSˇÀX
(
compID
, 
chFmt
);

164 c⁄° 
UI¡
 
csy
 = 
	`gëComp⁄ítSˇÀY
(
compID
, 
chFmt
);

165 c⁄° 
I¡
 
sˇÀCh™
 = (4>>(
csx
+
csy
));

166 c⁄° 
UI¡
 
bôDïthShi·
 = 2 * (
maximumBôDïth
 - 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)]);

168 c⁄° 
DoubÀ
 
ch™√lMSE
 = (
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
compID
] * 
	`DoubÀ
(1 << 
bôDïthShi·
)Ë/ DoubÀ(
	`gëNumPic
());

170 
sˇÀ
 +
sˇÀCh™
;

171 
MSEyuv
 +
sˇÀCh™
 * 
ch™√lMSE
;

174 
MSEyuv
 /
	`DoubÀ
(
sˇÀ
);

175 
PSNRyuv
 = (
MSEyuv
==0 ? 999.99 : 10*
	`log10
((
maxvÆ
*maxval)/MSEyuv));

176 
	}
}

178 
Void
 
	$¥ötOut
 ( 
TCh¨
 
cDñim
, c⁄° 
ChromaF‹m©
 
chFmt
, c⁄° 
OuçutLogC⁄åﬁ
 &
log˘æ
, c⁄° 
BôDïths
 &
bôDïths
 )

180 
DoubÀ
 
dFps
 = 
m_dFrmR©e
;

181 
DoubÀ
 
dSˇÀ
 = 
dFps
 / 1000 / (DoubÀ)
m_uiNumPic
;

183 
DoubÀ
 
MSEBa£dSNR
[
MAX_NUM_COMPONENT
];

184 i‡(
log˘æ
.
¥ötMSEBa£dSNR
)

186 
UI¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
MAX_NUM_COMPONENT
; componentIndex++)

188 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

190 i‡(
	`gëNumPic
() == 0)

192 
MSEBa£dSNR
[
compID
] = 0 * 
dSˇÀ
;

197 c⁄° 
UI¡
 
maxvÆ
 = 255 << (
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
compID
)] - 8);

198 c⁄° 
DoubÀ
 
MSE
 = 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
compID
];

200 
MSEBa£dSNR
[
compID
] = (
MSE
 =0Ë? 999.99 : (10 * 
	`log10
((
maxvÆ
 * maxvÆË/ (MSE / (
DoubÀ
)
	`gëNumPic
())));

205 
chFmt
)

207 
CHROMA_400
:

208 i‡(
log˘æ
.
¥ötMSEBa£dSNR
)

210 
	`¥ötf
( " " );

213 
	`¥ötf
( "\tTotal Frames | " "Bitrate " "Y-PSNR " );

215 i‡(
log˘æ
.
¥ötMSSSIM
)

217 
	`¥ötf
( " Y-MS-SSIM ");

220 i‡(
log˘æ
.
¥ötXPSNR
)

222 
	`¥ötf
( " xPSNR ");

225 i‡(
log˘æ
.
¥ötSequí˚MSE
)

227 
	`¥ötf
( " Y-MSE \n" );

231 
	`¥ötf
("\n");

235 i‡(
log˘æ
.
¥ötMSEBa£dSNR
)

237 
	`¥ötf
( "Average: ");

240 
	`¥ötf
( "\t %8d %c " "%12.4lf " "%8.4lf ",

241 
	`gëNumPic
(), 
cDñim
,

242 
	`gëBôs
(Ë* 
dSˇÀ
,

243 
	`gëP¢r
(
COMPONENT_Y
Ë/ (
DoubÀ
)
	`gëNumPic
() );

245 i‡(
log˘æ
.
¥ötMSSSIM
)

247 
	`¥ötf
(" %8.6l‡ ", 
	`gëMsssim
(
COMPONENT_Y
Ë/ (
DoubÀ
)
	`gëNumPic
());

249 if(
log˘æ
.
¥ötXPSNR
)

251 
	`¥ötf
(" %8.4lf ",

252 
	`gëxPSNR
(Ë/ (
DoubÀ
)
	`gëNumPic
());

255 i‡(
log˘æ
.
¥ötSequí˚MSE
)

257 
	`¥ötf
–" %8.4l‡ \n", 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
COMPONENT_Y
 ] / (
DoubÀ
)
	`gëNumPic
() );

261 
	`¥ötf
("\n");

264 i‡(
log˘æ
.
¥ötMSEBa£dSNR
)

266 
	`¥ötf
( "From MSE:\t %8d %c " "%12.4lf " "%8.4lf\n",

267 
	`gëNumPic
(), 
cDñim
,

268 
	`gëBôs
(Ë* 
dSˇÀ
,

269 
MSEBa£dSNR
[
COMPONENT_Y
] );

273 
CHROMA_420
:

274 
CHROMA_422
:

275 
CHROMA_444
:

277 
DoubÀ
 
PSNRyuv
 = 
MAX_DOUBLE
;

278 
DoubÀ
 
MSEyuv
 = 
MAX_DOUBLE
;

280 
	`ˇlcuœãComböedVÆues
(
chFmt
, 
PSNRyuv
, 
MSEyuv
, 
bôDïths
);

282 i‡(
log˘æ
.
¥ötMSEBa£dSNR
)

284 
	`¥ötf
( " " );

287 
	`¥ötf
( "\tTotal Frames | " "Bitrate " "Y-PSNR " "U-PSNR " "V-PSNR " "YUV-PSNR " );

289 i‡(
log˘æ
.
¥ötMSSSIM
)

291 
	`¥ötf
(" Y-MS-SSIM " "U-MS-SSIM " "V-MS-SSIM ");

293 i‡(
log˘æ
.
¥ötXPSNR
)

295 
	`¥ötf
( " xPSNR ");

298 #i‡
EXTENSION_360_VIDEO


299 
m_ext360
.
	`¥ötHódî
();

301 i‡(
log˘æ
.
¥ötSequí˚MSE
)

303 
	`¥ötf
( " Y-MSE " "U-MSE " "V-MSE " "YUV-MSE \n" );

307 
	`¥ötf
("\n");

310 i‡(
log˘æ
.
¥ötMSEBa£dSNR
)

312 
	`¥ötf
( "Average: ");

315 
	`¥ötf
( "\t %8d %c " "%12.4lf " "%8.4lf " "%8.4lf " "%8.4lf " "%8.4lf ",

316 
	`gëNumPic
(), 
cDñim
,

317 
	`gëBôs
(Ë* 
dSˇÀ
,

318 
	`gëP¢r
(
COMPONENT_Y
Ë/ (
DoubÀ
)
	`gëNumPic
(),

319 
	`gëP¢r
(
COMPONENT_Cb
Ë/ (
DoubÀ
)
	`gëNumPic
(),

320 
	`gëP¢r
(
COMPONENT_Cr
Ë/ (
DoubÀ
)
	`gëNumPic
(),

321 
PSNRyuv
 );

323 i‡(
log˘æ
.
¥ötMSSSIM
)

325 
	`¥ötf
(" %8.6lf " "%8.6lf " "%8.6lf ",

326 
	`gëMsssim
(
COMPONENT_Y
Ë/ (
DoubÀ
)
	`gëNumPic
(),

327 
	`gëMsssim
(
COMPONENT_Cb
Ë/ (
DoubÀ
)
	`gëNumPic
(),

328 
	`gëMsssim
(
COMPONENT_Cr
Ë/ (
DoubÀ
)
	`gëNumPic
());

331 if(
log˘æ
.
¥ötXPSNR
)

333 
	`¥ötf
(" %8.4lf ",

334 
	`gëxPSNR
(Ë/ (
DoubÀ
)
	`gëNumPic
());

337 #i‡
EXTENSION_360_VIDEO


338 
m_ext360
.
	`¥ötPSNRs
(
	`gëNumPic
());

341 i‡(
log˘æ
.
¥ötSequí˚MSE
)

343 
	`¥ötf
( " %8.4lf " "%8.4lf " "%8.4lf " "%8.4lf \n",

344 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
COMPONENT_Y
 ] / (
DoubÀ
)
	`gëNumPic
(),

345 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
COMPONENT_Cb
] / (
DoubÀ
)
	`gëNumPic
(),

346 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
COMPONENT_Cr
] / (
DoubÀ
)
	`gëNumPic
(),

347 
MSEyuv
 );

351 
	`¥ötf
("\n");

354 i‡(
log˘æ
.
¥ötMSEBa£dSNR
)

356 
	`¥ötf
( "From MSE:\t %8d %c " "%12.4lf " "%8.4lf " "%8.4lf " "%8.4lf " "%8.4lf\n",

357 
	`gëNumPic
(), 
cDñim
,

358 
	`gëBôs
(Ë* 
dSˇÀ
,

359 
MSEBa£dSNR
[
COMPONENT_Y
],

360 
MSEBa£dSNR
[
COMPONENT_Cb
],

361 
MSEBa£dSNR
[
COMPONENT_Cr
],

362 
PSNRyuv
 );

367 
	`Ârötf
(
°dîr
, "Unknown format duringÖrint out\n");

368 
	`exô
(1);

371 
	}
}

374 
Void
 
	$¥ötSumm¨y
(c⁄° 
ChromaF‹m©
 
chFmt
, c⁄° 
OuçutLogC⁄åﬁ
 &
log˘æ
, c⁄° 
BôDïths
 &
bôDïths
, c⁄° 
°d
::
°rög
 &
sFûíame
)

376 
FILE
* 
pFûe
 = 
	`f›í
 (
sFûíame
.
	`c_°r
(), "at");

378 
DoubÀ
 
dFps
 = 
m_dFrmR©e
;

379 
DoubÀ
 
dSˇÀ
 = 
dFps
 / 1000 / (DoubÀ)
m_uiNumPic
;

380 
chFmt
)

382 
CHROMA_400
:

383 
	`Ârötf
(
pFûe
, "%f\t %f\n",

384 
	`gëBôs
(Ë* 
dSˇÀ
,

385 
	`gëP¢r
(
COMPONENT_Y
Ë/ (
DoubÀ
)
	`gëNumPic
() );

387 
CHROMA_420
:

388 
CHROMA_422
:

389 
CHROMA_444
:

391 
DoubÀ
 
PSNRyuv
 = 
MAX_DOUBLE
;

392 
DoubÀ
 
MSEyuv
 = 
MAX_DOUBLE
;

394 
	`ˇlcuœãComböedVÆues
(
chFmt
, 
PSNRyuv
, 
MSEyuv
, 
bôDïths
);

396 
	`Ârötf
(
pFûe
, "%f\t %f\t %f\t %f\t %f",

397 
	`gëBôs
(Ë* 
dSˇÀ
,

398 
	`gëP¢r
(
COMPONENT_Y
Ë/ (
DoubÀ
)
	`gëNumPic
(),

399 
	`gëP¢r
(
COMPONENT_Cb
Ë/ (
DoubÀ
)
	`gëNumPic
(),

400 
	`gëP¢r
(
COMPONENT_Cr
Ë/ (
DoubÀ
)
	`gëNumPic
(),

401 
PSNRyuv
 );

403 i‡(
log˘æ
.
¥ötSequí˚MSE
)

405 
	`Ârötf
(
pFûe
, "\t %f\t %f\t %f\t %f\n",

406 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
COMPONENT_Y
 ] / (
DoubÀ
)
	`gëNumPic
(),

407 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
COMPONENT_Cb
] / (
DoubÀ
)
	`gëNumPic
(),

408 
m_ru¬ögTŸÆ
.
MSEyuv‰ame
[
COMPONENT_Cr
] / (
DoubÀ
)
	`gëNumPic
(),

409 
MSEyuv
 );

413 
	`Ârötf
(
pFûe
, "\n");

420 
	`Ârötf
(
°dîr
, "Unknown format duringÖrint out\n");

421 
	`exô
(1);

425 
	`f˛o£
(
pFûe
);

426 
	}
}

429 
TEncA«lyze
 
m_gcA«lyzeAŒ
;

430 
TEncA«lyze
 
m_gcA«lyzeI
;

431 
TEncA«lyze
 
m_gcA«lyzeP
;

432 
TEncA«lyze
 
m_gcA«lyzeB
;

434 
TEncA«lyze
 
m_gcA«lyzeAŒ_ö
;

	@TLibEncoder/TEncBinCoder.h

38 #i‚de‡
__TENCBINCODER__


39 
	#__TENCBINCODER__


	)

41 
	~"TLibComm⁄/C⁄ãxtModñ.h
"

42 
	~"TLibComm⁄/TComBôSåóm.h
"

47 
˛ass
 
	gTEncBöCABAC
;

49 ˛as†
	cTEncBöIf


51 
	mpublic
:

52 
vútuÆ
 
Void
 
öô
 ( 
TComBôIf
* 
pcTComBôIf
 ) = 0;

53 
vútuÆ
 
Void
 
unöô
 () = 0;

55 
vútuÆ
 
Void
 
°¨t
 () = 0;

56 
vútuÆ
 
Void
 
föish
 () = 0;

57 
vútuÆ
 
Void
 
c›ySèã
 ( c⁄° 
TEncBöIf
* 
pcTEncBöIf
 ) = 0;

58 
vútuÆ
 
Void
 
Êush
 () = 0;

60 
vútuÆ
 
Void
 
ª£tBac
 () = 0;

61 
vútuÆ
 
Void
 
ícodePCMAlignBôs
() = 0;

62 
vútuÆ
 
Void
 
xWrôePCMCode
 ( 
UI¡
 
uiCode
, UI¡ 
uiLígth
 ) = 0;

64 
vútuÆ
 
Void
 
ª£tBôs
 () = 0;

65 
vútuÆ
 
UI¡
 
gëNumWrôãnBôs
 () = 0;

67 
vútuÆ
 
Void
 
ícodeBö
 ( 
UI¡
 
uiBö
, 
C⁄ãxtModñ
& 
rcCtxModñ
 ) = 0;

68 
vútuÆ
 
Void
 
ícodeBöEP
 ( 
UI¡
 
uiBö
 ) = 0;

69 
vútuÆ
 
Void
 
ícodeBösEP
 ( 
UI¡
 
uiBös
, 
I¡
 
numBös
 ) = 0;

70 
vútuÆ
 
Void
 
ícodeBöTrm
 ( 
UI¡
 
uiBö
 ) = 0;

72 
vútuÆ
 
Void
 
Æign
 () = 0;

74 
vútuÆ
 
TEncBöCABAC
* 
	$gëTEncBöCABAC
 () {  0; }

75 
vútuÆ
 c⁄° 
TEncBöCABAC
* 
	$gëTEncBöCABAC
 (Ëc⁄° {  0; 
	}
}

77 
	gvútuÆ
 ~
	$TEncBöIf
(Ë{
	}
}

	@TLibEncoder/TEncBinCoderCABAC.cpp

38 
	~"TEncBöCodîCABAC.h
"

39 
	~"TLibComm⁄/TComRom.h
"

40 
	~"TLibComm⁄/Debug.h
"

46 
	gTEncBöCABAC
::
	$TEncBöCABAC
()

47 : 
	`m_pcTComBôIf
( 0 )

48 , 
	$m_böCou¡In¸emít
( 0 )

49 #i‡
FAST_BIT_EST


50 , 
	$m_‰acBôs
( 0 )

53 
	}
}

55 
	gTEncBöCABAC
::~
	$TEncBöCABAC
()

57 
	}
}

59 
Void
 
TEncBöCABAC
::
	$öô
–
TComBôIf
* 
pcTComBôIf
 )

61 
m_pcTComBôIf
 = 
pcTComBôIf
;

62 
	}
}

64 
Void
 
	gTEncBöCABAC
::
	$unöô
()

66 
m_pcTComBôIf
 = 0;

67 
	}
}

69 
Void
 
	gTEncBöCABAC
::
	$°¨t
()

71 
m_uiLow
 = 0;

72 
m_uiR™ge
 = 510;

73 
m_bôsLe·
 = 23;

74 
m_numBuf„ªdByãs
 = 0;

75 
m_buf„ªdByã
 = 0xff;

76 #i‡
FAST_BIT_EST


77 
m_‰acBôs
 = 0;

79 
	}
}

81 
Void
 
	gTEncBöCABAC
::
	$föish
()

83 i‡–
m_uiLow
 >> ( 32 - 
m_bôsLe·
 ) )

87 
m_pcTComBôIf
->
	`wrôe
–
m_buf„ªdByã
 + 1, 8 );

88  
m_numBuf„ªdByãs
 > 1 )

90 
m_pcTComBôIf
->
	`wrôe
( 0x00, 8 );

91 
m_numBuf„ªdByãs
--;

93 
m_uiLow
 -1 << ( 32 - 
m_bôsLe·
 );

97 i‡–
m_numBuf„ªdByãs
 > 0 )

99 
m_pcTComBôIf
->
	`wrôe
–
m_buf„ªdByã
, 8 );

101  
m_numBuf„ªdByãs
 > 1 )

103 
m_pcTComBôIf
->
	`wrôe
( 0xff, 8 );

104 
m_numBuf„ªdByãs
--;

107 
m_pcTComBôIf
->
	`wrôe
–
m_uiLow
 >> 8, 24 - 
m_bôsLe·
 );

108 
	}
}

110 
Void
 
	gTEncBöCABAC
::
	$Êush
()

112 
	`ícodeBöTrm
(1);

113 
	`föish
();

114 
m_pcTComBôIf
->
	`wrôe
(1, 1);

115 
m_pcTComBôIf
->
	`wrôeAlignZîo
();

117 
	`°¨t
();

118 
	}
}

123 
Void
 
	gTEncBöCABAC
::
	$ª£tBac
()

125 
	`°¨t
();

126 
	}
}

131 
Void
 
	gTEncBöCABAC
::
	$ícodePCMAlignBôs
()

133 
	`föish
();

134 
m_pcTComBôIf
->
	`wrôe
(1, 1);

135 
m_pcTComBôIf
->
	`wrôeAlignZîo
();

136 
	}
}

143 
Void
 
	gTEncBöCABAC
::
	$xWrôePCMCode
(
UI¡
 
uiCode
, UI¡ 
uiLígth
)

145 
m_pcTComBôIf
->
	`wrôe
(
uiCode
, 
uiLígth
);

146 
	}
}

148 
Void
 
	gTEncBöCABAC
::
	$c›ySèã
–c⁄° 
TEncBöIf
* 
pcTEncBöIf
 )

150 c⁄° 
TEncBöCABAC
* 
pcTEncBöCABAC
 = 
pcTEncBöIf
->
	`gëTEncBöCABAC
();

151 
m_uiLow
 = 
pcTEncBöCABAC
->m_uiLow;

152 
m_uiR™ge
 = 
pcTEncBöCABAC
->m_uiRange;

153 
m_bôsLe·
 = 
pcTEncBöCABAC
->m_bitsLeft;

154 
m_buf„ªdByã
 = 
pcTEncBöCABAC
->m_bufferedByte;

155 
m_numBuf„ªdByãs
 = 
pcTEncBöCABAC
->m_numBufferedBytes;

156 #i‡
FAST_BIT_EST


157 
m_‰acBôs
 = 
pcTEncBöCABAC
->m_fracBits;

159 
	}
}

161 
Void
 
	gTEncBöCABAC
::
	$ª£tBôs
()

163 
m_uiLow
 = 0;

164 
m_bôsLe·
 = 23;

165 
m_numBuf„ªdByãs
 = 0;

166 
m_buf„ªdByã
 = 0xff;

167 i‡–
m_böCou¡In¸emít
 )

169 
m_uiBösCoded
 = 0;

171 #i‡
FAST_BIT_EST


172 
m_‰acBôs
 &= 32767;

174 
	}
}

176 
UI¡
 
	gTEncBöCABAC
::
	$gëNumWrôãnBôs
()

178  
m_pcTComBôIf
->
	`gëNumbîOfWrôãnBôs
(Ë+ 8 * 
m_numBuf„ªdByãs
 + 23 - 
m_bôsLe·
;

179 
	}
}

187 
Void
 
	gTEncBöCABAC
::
	$ícodeBö
–
UI¡
 
böVÆue
, 
C⁄ãxtModñ
 &
rcCtxModñ
 )

198 #i‡
DEBUG_CABAC_BINS


199 c⁄° 
UI¡
 
°¨tögR™ge
 = 
m_uiR™ge
;

202 
m_uiBösCoded
 +
m_böCou¡In¸emít
;

203 
rcCtxModñ
.
	`£tBösCoded
( 1 );

205 
UI¡
 
uiLPS
 = 
TComCABACTabÀs
::
sm_aucLPSTabÀ
[ 
rcCtxModñ
.
	`gëSèã
(Ë][ ( 
m_uiR™ge
 >> 6 ) & 3 ];

206 
m_uiR™ge
 -
uiLPS
;

208 if–
böVÆue
 !
rcCtxModñ
.
	`gëMps
() )

210 
I¡
 
numBôs
 = 
TComCABACTabÀs
::
sm_aucRí‹mTabÀ
[ 
uiLPS
 >> 3 ];

211 
m_uiLow
 = ( m_uiLow + 
m_uiR™ge
 ) << 
numBôs
;

212 
m_uiR™ge
 = 
uiLPS
 << 
numBôs
;

213 
rcCtxModñ
.
	`upd©eLPS
();

214 
m_bôsLe·
 -
numBôs
;

215 
	`ã°AndWrôeOut
();

219 
rcCtxModñ
.
	`upd©eMPS
();

221 i‡–
m_uiR™ge
 < 256 )

223 
m_uiLow
 <<= 1;

224 
m_uiR™ge
 <<= 1;

225 
m_bôsLe·
--;

226 
	`ã°AndWrôeOut
();

230 #i‡
DEBUG_CABAC_BINS


231 i‡((
g_debugCou¡î
 + 
debugCabacBöWödow
Ë>
debugCabacBöT¨gëLöe
)

233 
°d
::
cout
 << 
g_debugCou¡î
 << ": codög bö vÆuê" << 
böVÆue
 << ",Ñ™gê[" << 
°¨tögR™ge
 << "->" << 
m_uiR™ge
 << "]\n";

236 i‡(
g_debugCou¡î
 >
debugCabacBöT¨gëLöe
)

238 
UCh¨
 
bªakPoötThis
;

239 
bªakPoötThis
 = 7;

241 i‡(
g_debugCou¡î
 >(
debugCabacBöT¨gëLöe
 + 
debugCabacBöWödow
))

243 
	`exô
(0);

246 
g_debugCou¡î
++;

248 
	}
}

255 
Void
 
	gTEncBöCABAC
::
	$ícodeBöEP
–
UI¡
 
böVÆue
 )

257 i‡(
Ál£
)

259 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

260 
	`DTRACE_CABAC_T
( "\tEPsymbol=" )

261 
	`DTRACE_CABAC_V
–
böVÆue
 )

262 
	`DTRACE_CABAC_T
( "\n" )

265 
m_uiBösCoded
 +
m_böCou¡In¸emít
;

267 i‡(
m_uiR™ge
 == 256)

269 
	`ícodeAlig√dBösEP
(
böVÆue
, 1);

273 
m_uiLow
 <<= 1;

274 if–
böVÆue
 )

276 
m_uiLow
 +
m_uiR™ge
;

278 
m_bôsLe·
--;

280 
	`ã°AndWrôeOut
();

281 
	}
}

289 
Void
 
	gTEncBöCABAC
::
	$ícodeBösEP
–
UI¡
 
böVÆues
, 
I¡
 
numBös
 )

291 
m_uiBösCoded
 +
numBös
 & -
m_böCou¡In¸emít
;

293 i‡(
Ál£
)

295  
I¡
 
i
 = 0; i < 
numBös
; i++ )

297 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

298 
	`DTRACE_CABAC_T
( "\tEPsymbol=" )

299 
	`DTRACE_CABAC_V
––
böVÆues
 >> ( 
numBös
 - 1 - 
i
 ) ) & 1 )

300 
	`DTRACE_CABAC_T
( "\n" )

304 i‡(
m_uiR™ge
 == 256)

306 
	`ícodeAlig√dBösEP
(
böVÆues
, 
numBös
);

310  
numBös
 > 8 )

312 
numBös
 -= 8;

313 
UI¡
 
∑âîn
 = 
böVÆues
 >> 
numBös
;

314 
m_uiLow
 <<= 8;

315 
m_uiLow
 +
m_uiR™ge
 * 
∑âîn
;

316 
böVÆues
 -
∑âîn
 << 
numBös
;

317 
m_bôsLe·
 -= 8;

319 
	`ã°AndWrôeOut
();

322 
m_uiLow
 <<
numBös
;

323 
m_uiLow
 +
m_uiR™ge
 * 
böVÆues
;

324 
m_bôsLe·
 -
numBös
;

326 
	`ã°AndWrôeOut
();

327 
	}
}

329 
Void
 
	gTEncBöCABAC
::
	$Æign
()

331 
m_uiR™ge
 = 256;

332 
	}
}

334 
Void
 
	gTEncBöCABAC
::
	$ícodeAlig√dBösEP
–
UI¡
 
böVÆues
, 
I¡
 
numBös
 )

336 
I¡
 
bösRemaöög
 = 
numBös
;

338 
	`as£π
(
m_uiR™ge
 == 256);

340 
bösRemaöög
 > 0)

342 c⁄° 
UI¡
 
bösToCode
 = 
°d
::
mö
<UI¡>(
bösRemaöög
, 8);

343 c⁄° 
UI¡
 
böMask
 = (1 << 
bösToCode
) - 1;

345 c⁄° 
UI¡
 
√wBös
 = (
böVÆues
 >> (
bösRemaöög
 - 
bösToCode
)Ë& 
böMask
;

362 
m_uiLow
 = (m_uiLow << 
bösToCode
Ë+ (
√wBös
 << 8);

364 
bösRemaöög
 -
bösToCode
;

365 
m_bôsLe·
 -
bösToCode
;

367 
	`ã°AndWrôeOut
();

369 
	}
}

376 
Void
 
	gTEncBöCABAC
::
	$ícodeBöTrm
–
UI¡
 
böVÆue
 )

378 
m_uiBösCoded
 +
m_böCou¡In¸emít
;

379 
m_uiR™ge
 -= 2;

380 if–
böVÆue
 )

382 
m_uiLow
 +
m_uiR™ge
;

383 
m_uiLow
 <<= 7;

384 
m_uiR™ge
 = 2 << 7;

385 
m_bôsLe·
 -= 7;

387 i‡–
m_uiR™ge
 >= 256 )

393 
m_uiLow
 <<= 1;

394 
m_uiR™ge
 <<= 1;

395 
m_bôsLe·
--;

398 
	`ã°AndWrôeOut
();

399 
	}
}

401 
Void
 
	gTEncBöCABAC
::
	$ã°AndWrôeOut
()

403 i‡–
m_bôsLe·
 < 12 )

405 
	`wrôeOut
();

407 
	}
}

412 
Void
 
	gTEncBöCABAC
::
	$wrôeOut
()

414 
UI¡
 
ÀadByã
 = 
m_uiLow
 >> (24 - 
m_bôsLe·
);

415 
m_bôsLe·
 += 8;

416 
m_uiLow
 &0xffffffffu >> 
m_bôsLe·
;

418 i‡–
ÀadByã
 == 0xff )

420 
m_numBuf„ªdByãs
++;

424 i‡–
m_numBuf„ªdByãs
 > 0 )

426 
UI¡
 
ˇºy
 = 
ÀadByã
 >> 8;

427 
UI¡
 
byã
 = 
m_buf„ªdByã
 + 
ˇºy
;

428 
m_buf„ªdByã
 = 
ÀadByã
 & 0xff;

429 
m_pcTComBôIf
->
	`wrôe
–
byã
, 8 );

431 
byã
 = ( 0xf‡+ 
ˇºy
 ) & 0xff;

432  
m_numBuf„ªdByãs
 > 1 )

434 
m_pcTComBôIf
->
	`wrôe
–
byã
, 8 );

435 
m_numBuf„ªdByãs
--;

440 
m_numBuf„ªdByãs
 = 1;

441 
m_buf„ªdByã
 = 
ÀadByã
;

444 
	}
}

	@TLibEncoder/TEncBinCoderCABAC.h

38 #i‚de‡
__TENCBINCODERCABAC__


39 
	#__TENCBINCODERCABAC__


	)

41 
	~"TLibComm⁄/TComCABACTabÀs.h
"

42 
	~"TEncBöCodî.h
"

47 ˛as†
	cTEncBöCABAC
 : 
public
 
TEncBöIf


49 
public
:

50 
TEncBöCABAC
 ();

51 
	mvútuÆ
 ~
TEncBöCABAC
();

53 
Void
 
öô
 ( 
TComBôIf
* 
pcTComBôIf
 );

54 
Void
 
unöô
 ();

56 
Void
 
°¨t
 ();

57 
Void
 
föish
 ();

58 
Void
 
c›ySèã
 ( c⁄° 
TEncBöIf
* 
pcTEncBöIf
 );

59 
Void
 
Êush
 ();

61 
Void
 
ª£tBac
 ();

62 
Void
 
ícodePCMAlignBôs
();

63 
Void
 
xWrôePCMCode
 ( 
UI¡
 
uiCode
, UI¡ 
uiLígth
 );

65 
Void
 
ª£tBôs
 ();

66 
UI¡
 
gëNumWrôãnBôs
 ();

68 
Void
 
ícodeBö
 ( 
UI¡
 
böVÆue
, 
C⁄ãxtModñ
& 
rcCtxModñ
 );

69 
Void
 
ícodeBöEP
 ( 
UI¡
 
böVÆue
 );

70 
Void
 
ícodeBösEP
 ( 
UI¡
 
böVÆues
, 
I¡
 
numBös
 );

71 
Void
 
ícodeBöTrm
 ( 
UI¡
 
böVÆue
 );

73 
Void
 
Æign
 ();

74 
Void
 
ícodeAlig√dBösEP
–
UI¡
 
böVÆues
, 
I¡
 
numBös
 );

76 
TEncBöCABAC
* 
	$gëTEncBöCABAC
(Ë{  
this
; }

77 c⁄° 
TEncBöCABAC
* 
	$gëTEncBöCABAC
(Ëc⁄° {  
this
; 
	}
}

79 
Void
 
	$£tBösCoded
 ( 
UI¡
 
uiVÆ
 ) { 
m_uiBösCoded
 = uiVÆ; 
	}
}

80 
UI¡
 
	$gëBösCoded
 (Ë{  
m_uiBösCoded
; 
	}
}

81 
Void
 
	$£tBöCou¡ögE«bÀFœg
 ( 
Boﬁ
 
bFœg
 ) { 
m_böCou¡In¸emít
 = bFœg ? 1 : 0; 
	}
}

82 
Boﬁ
 
	$gëBöCou¡ögE«bÀFœg
 (Ë{  
m_böCou¡In¸emít
 !0; 
	}
}

84 #i‡
FAST_BIT_EST


85 
	g¥Ÿe˘ed
:

87 
¥iv©e
:

89 
Void
 
ã°AndWrôeOut
();

90 
Void
 
wrôeOut
();

92 
TComBôIf
* 
	gm_pcTComBôIf
;

93 
UI¡
 
	gm_uiLow
;

94 
UI¡
 
	gm_uiR™ge
;

95 
UI¡
 
	gm_buf„ªdByã
;

96 
I¡
 
	gm_numBuf„ªdByãs
;

97 
I¡
 
	gm_bôsLe·
;

98 
UI¡
 
	gm_uiBösCoded
;

99 
I¡
 
	gm_böCou¡In¸emít
;

100 #i‡
FAST_BIT_EST


101 
UI¡64
 
	gm_‰acBôs
;

	@TLibEncoder/TEncBinCoderCABACCounter.cpp

38 
	~"TEncBöCodîCABACCou¡î.h
"

39 
	~"TLibComm⁄/TComRom.h
"

40 
	~"TLibComm⁄/Debug.h
"

43 #i‡
FAST_BIT_EST


49 
	gTEncBöCABACCou¡î
::
	$TEncBöCABACCou¡î
()

51 
	}
}

53 
TEncBöCABACCou¡î
::~
	$TEncBöCABACCou¡î
()

55 
	}
}

57 
Void
 
TEncBöCABACCou¡î
::
	$föish
()

59 
m_pcTComBôIf
->
	`wrôe
(0, 
	`UI¡
(
m_‰acBôs
 >> 15) );

60 
m_‰acBôs
 &= 32767;

61 
	}
}

63 
UI¡
 
	gTEncBöCABACCou¡î
::
	$gëNumWrôãnBôs
()

65  
m_pcTComBôIf
->
	`gëNumbîOfWrôãnBôs
(Ë+ 
	`UI¡
–
m_‰acBôs
 >> 15 );

66 
	}
}

74 
Void
 
	gTEncBöCABACCou¡î
::
	$ícodeBö
–
UI¡
 
böVÆue
, 
C⁄ãxtModñ
 &
rcCtxModñ
 )

76 #i‡
DEBUG_ENCODER_SEARCH_BINS


77 c⁄° 
UI¡64
 
°¨tögFøcBôs
 = 
m_‰acBôs
;

80 
m_uiBösCoded
 +
m_böCou¡In¸emít
;

81 
m_‰acBôs
 +
rcCtxModñ
.
	`gëE¡r›yBôs
–
böVÆue
 );

82 
rcCtxModñ
.
	`upd©e
–
böVÆue
 );

84 #i‡
DEBUG_ENCODER_SEARCH_BINS


85 i‡((
g_debugCou¡î
 + 
debugEncodîSórchBöWödow
Ë>
debugEncodîSórchBöT¨gëLöe
)

87 
°d
::
cout
 << 
g_debugCou¡î
 << ": codög bö vÆuê" << 
böVÆue
 << ", føcBô†[" << 
°¨tögFøcBôs
 << "->" << 
m_‰acBôs
 << "]\n";

90 i‡(
g_debugCou¡î
 >
debugEncodîSórchBöT¨gëLöe
)

92 
UCh¨
 
bªakPoötThis
;

93 
bªakPoötThis
 = 7;

95 i‡(
g_debugCou¡î
 >(
debugEncodîSórchBöT¨gëLöe
 + 
debugEncodîSórchBöWödow
))

97 
	`exô
(0);

99 
g_debugCou¡î
++;

101 
	}
}

108 
Void
 
	gTEncBöCABACCou¡î
::
	$ícodeBöEP
–
UI¡
 )

110 
m_uiBösCoded
 +
m_böCou¡In¸emít
;

111 
m_‰acBôs
 += 32768;

112 
	}
}

120 
Void
 
	gTEncBöCABACCou¡î
::
	$ícodeBösEP
–
UI¡
 , 
I¡
 
numBös
 )

122 
m_uiBösCoded
 +
numBös
 & -
m_böCou¡In¸emít
;

123 
m_‰acBôs
 +32768 * 
numBös
;

124 
	}
}

131 
Void
 
	gTEncBöCABACCou¡î
::
	$ícodeBöTrm
–
UI¡
 
böVÆue
 )

133 
m_uiBösCoded
 +
m_böCou¡In¸emít
;

134 
m_‰acBôs
 +
C⁄ãxtModñ
::
	`gëE¡r›yBôsTrm
–
böVÆue
 );

135 
	}
}

137 
Void
 
	gTEncBöCABACCou¡î
::
	$Æign
()

139 
m_‰acBôs
 = (m_fracBits + 32767) & (~32767);

140 
	}
}

	@TLibEncoder/TEncBinCoderCABACCounter.h

38 #i‚de‡
__TENCBINCODERCABACCOUNTER__


39 
	#__TENCBINCODERCABACCOUNTER__


	)

42 
	~"TEncBöCodîCABAC.h
"

44 #i‡
FAST_BIT_EST


50 ˛as†
	cTEncBöCABACCou¡î
 : 
public
 
TEncBöCABAC


52 
public
:

53 
TEncBöCABACCou¡î
 ();

54 
	mvútuÆ
 ~
TEncBöCABACCou¡î
();

56 
Void
 
föish
 ();

57 
UI¡
 
gëNumWrôãnBôs
 ();

59 
Void
 
ícodeBö
 ( 
UI¡
 
böVÆue
, 
C⁄ãxtModñ
& 
rcCtxModñ
 );

60 
Void
 
ícodeBöEP
 ( 
UI¡
 
böVÆue
 );

61 
Void
 
ícodeBösEP
 ( 
UI¡
 
böVÆues
, 
I¡
 
numBös
 );

62 
Void
 
ícodeBöTrm
 ( 
UI¡
 
böVÆue
 );

64 
Void
 
Æign
 ();

66 
	m¥iv©e
:

	@TLibEncoder/TEncCavlc.cpp

38 
	~"../TLibComm⁄/Comm⁄Def.h
"

39 
	~"TEncCavlc.h
"

40 
	~"SEIwrôe.h
"

45 #i‡
ENC_DEC_TRACE


46 #i‡
MCTS_EXTRACTION


47 
Void
 
	$xTø˚VPSHódîEnc
()

49 
Void
 
	$xTø˚VPSHódî
()

52 
	`Ârötf
–
g_hTø˚
, "=========== Video Parameter Set ===========\n" );

53 
	}
}

55 #i‡
MCTS_EXTRACTION


56 
Void
 
	$xTø˚SPSHódîEnc
()

58 
Void
 
	$xTø˚SPSHódî
()

61 
	`Ârötf
–
g_hTø˚
, "=========== Sequence Parameter Set ===========\n" );

62 
	}
}

64 #i‡
MCTS_EXTRACTION


65 
Void
 
	$xTø˚PPSHódîEnc
()

67 
Void
 
	$xTø˚PPSHódî
()

70 
	`Ârötf
–
g_hTø˚
, "=========== Picture Parameter Set ===========\n");

71 
	}
}

73 #i‡
MCTS_EXTRACTION


74 
Void
 
	$xTø˚Sli˚HódîEnc
()

76 
Void
 
	$xTø˚Sli˚Hódî
()

79 
	`Ârötf
–
g_hTø˚
, "=========== Slice ===========\n");

80 
	}
}

82 #i‡
MCTS_EXTRACTION


83 
Void
 
	$xTø˚Ac˚ssUnôDñimôîEnc
()

85 
Void
 
	$xTø˚Ac˚ssUnôDñimôî
()

88 
	`Ârötf
–
g_hTø˚
, "=========== Access Unit Delimiter ===========\n");

89 
	}
}

93 
Void
 
	gAUDWrôî
::
	$codeAUD
(
TComBôIf
& 
bs
, c⁄° 
I¡
 
pi˘uªTy≥
)

95 #i‡
ENC_DEC_TRACE


96 #i‡
MCTS_EXTRACTION


97 
	`xTø˚Ac˚ssUnôDñimôîEnc
();

99 
	`xTø˚Ac˚ssUnôDñimôî
();

103 
	`as£π
 (
pi˘uªTy≥
 < 3);

104 
	`£tBô°ªam
(&
bs
);

105 
	`WRITE_CODE
(
pi˘uªTy≥
, 3, "pic_type");

106 
	`xWrôeRb•TøûögBôs
();

107 
	}
}

113 
	gTEncCavlc
::
	$TEncCavlc
()

115 
m_pcBôIf
 = 
NULL
;

116 
	}
}

118 
	gTEncCavlc
::~
	$TEncCavlc
()

120 
	}
}

127 
Void
 
TEncCavlc
::
	$ª£tE¡r›y
(c⁄° 
TComSli˚
* )

129 
	}
}

132 
Void
 
TEncCavlc
::
	$codeSh‹tTîmRefPicSë
–c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
Ωs
, 
Boﬁ
 
ˇŒedFromSli˚Hódî
, 
I¡
 
idx
)

134 #i‡
PRINT_RPS_INFO


135 
I¡
 
œ°Bôs
 = 
	`gëNumbîOfWrôãnBôs
();

137 i‡(
idx
 > 0)

139 
	`WRITE_FLAG
–
Ωs
->
	`gëI¡îRPSPªdi˘i⁄
(), "inter_ref_pic_set_prediction_flag" );

141 i‡(
Ωs
->
	`gëI¡îRPSPªdi˘i⁄
())

143 
I¡
 
dñèRPS
 = 
Ωs
->
	`gëDñèRPS
();

144 if(
ˇŒedFromSli˚Hódî
)

146 
	`WRITE_UVLC
–
Ωs
->
	`gëDñèRIdxMöus1
(), "delta_idx_minus1" );

149 
	`WRITE_CODE
–(
dñèRPS
 >=0 ? 0: 1), 1, "delta_rps_sign" );

150 
	`WRITE_UVLC
–
	`abs
(
dñèRPS
) - 1, "abs_delta_rps_minus1");

152 
I¡
 
j
=0; j < 
Ωs
->
	`gëNumRefIdc
(); j++)

154 
I¡
 
ªfIdc
 = 
Ωs
->
	`gëRefIdc
(
j
);

155 
	`WRITE_CODE
–(
ªfIdc
==1? 1: 0), 1, "used_by_curr_pic_flag" );

156 i‡(
ªfIdc
 != 1)

158 
	`WRITE_CODE
–
ªfIdc
>>1, 1, "use_delta_flag" );

164 
	`WRITE_UVLC
–
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
(), "num_negative_pics" );

165 
	`WRITE_UVLC
–
Ωs
->
	`gëNumbîOfPosôivePi˘uªs
(), "num_positive_pics" );

166 
I¡
 
¥ev
 = 0;

167 
I¡
 
j
=0 ; j < 
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
(); j++)

169 
	`WRITE_UVLC
–
¥ev
-
Ωs
->
	`gëDñèPOC
(
j
)-1, "delta_poc_s0_minus1" );

170 
¥ev
 = 
Ωs
->
	`gëDñèPOC
(
j
);

171 
	`WRITE_FLAG
–
Ωs
->
	`gëU£d
(
j
), "used_by_curr_pic_s0_flag");

173 
¥ev
 = 0;

174 
I¡
 
j
=
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
(); j <Ñps->gëNumbîOfNeg©ivePi˘uªs()+Ωs->
	`gëNumbîOfPosôivePi˘uªs
(); j++)

176 
	`WRITE_UVLC
–
Ωs
->
	`gëDñèPOC
(
j
)-
¥ev
-1, "delta_poc_s1_minus1" );

177 
¥ev
 = 
Ωs
->
	`gëDñèPOC
(
j
);

178 
	`WRITE_FLAG
–
Ωs
->
	`gëU£d
(
j
), "used_by_curr_pic_s1_flag" );

182 #i‡
PRINT_RPS_INFO


183 
	`¥ötf
("úps=%d (%2d bôsË", 
Ωs
->
	`gëI¡îRPSPªdi˘i⁄
(), 
	`gëNumbîOfWrôãnBôs
(Ë- 
œ°Bôs
);

184 
Ωs
->
	`¥ötDñèPOC
();

186 
	}
}

189 
Void
 
	gTEncCavlc
::
	$codePPS
–c⁄° 
TComPPS
* 
pcPPS
 )

191 #i‡
ENC_DEC_TRACE


192 #i‡
MCTS_EXTRACTION


193 
	`xTø˚PPSHódîEnc
();

195 
	`xTø˚PPSHódî
();

199 
	`WRITE_UVLC
–
pcPPS
->
	`gëPPSId
(), "pps_pic_parameter_set_id" );

200 
	`WRITE_UVLC
–
pcPPS
->
	`gëSPSId
(), "pps_seq_parameter_set_id" );

201 
	`WRITE_FLAG
–
pcPPS
->
	`gëDïídítSli˚SegmítsE«bÀdFœg
() ? 1 : 0, "dependent_slice_segments_enabled_flag" );

202 
	`WRITE_FLAG
–
pcPPS
->
	`gëOuçutFœgPª£¡Fœg
() ? 1 : 0, "output_flag_present_flag" );

203 
	`WRITE_CODE
–
pcPPS
->
	`gëNumExåaSli˚HódîBôs
(), 3, "num_extra_slice_header_bits");

204 
	`WRITE_FLAG
–
pcPPS
->
	`gëSignD©aHidögE«bÀdFœg
(), "sign_data_hiding_enabled_flag" );

205 
	`WRITE_FLAG
–
pcPPS
->
	`gëCabacInôPª£¡Fœg
() ? 1 : 0, "cabac_init_present_flag" );

206 
	`WRITE_UVLC
–
pcPPS
->
	`gëNumRefIdxL0DeÁu…A˘ive
()-1, "num_ref_idx_l0_default_active_minus1");

207 
	`WRITE_UVLC
–
pcPPS
->
	`gëNumRefIdxL1DeÁu…A˘ive
()-1, "num_ref_idx_l1_default_active_minus1");

209 
	`WRITE_SVLC
–
pcPPS
->
	`gëPicInôQPMöus26
(), "init_qp_minus26");

210 
	`WRITE_FLAG
–
pcPPS
->
	`gëC⁄°øöedI¡øPªd
() ? 1 : 0, "constrained_intra_pred_flag" );

211 
	`WRITE_FLAG
–
pcPPS
->
	`gëU£Tønsf‹mSkù
() ? 1 : 0, "transform_skip_enabled_flag" );

212 
	`WRITE_FLAG
–
pcPPS
->
	`gëU£DQP
() ? 1 : 0, "cu_qp_delta_enabled_flag" );

213 i‡–
pcPPS
->
	`gëU£DQP
() )

215 
	`WRITE_UVLC
–
pcPPS
->
	`gëMaxCuDQPDïth
(), "diff_cu_qp_delta_depth" );

218 
	`WRITE_SVLC
–
pcPPS
->
	`gëQpOff£t
(
COMPONENT_Cb
), "pps_cb_qp_offset" );

219 
	`WRITE_SVLC
–
pcPPS
->
	`gëQpOff£t
(
COMPONENT_Cr
), "pps_cr_qp_offset" );

221 
	`WRITE_FLAG
–
pcPPS
->
	`gëSli˚ChromaQpFœg
() ? 1 : 0, "pps_slice_chroma_qp_offsets_present_flag" );

223 
	`WRITE_FLAG
–
pcPPS
->
	`gëU£WP
() ? 1 : 0, "weighted_pred_flag" );

224 
	`WRITE_FLAG
–
pcPPS
->
	`gëWPBiPªd
() ? 1 : 0, "weighted_bipred_flag" );

225 
	`WRITE_FLAG
–
pcPPS
->
	`gëTønsqu™tBy∑ssE«bÀdFœg
() ? 1 : 0, "transquant_bypass_enabled_flag" );

226 
	`WRITE_FLAG
–
pcPPS
->
	`gëTûesE«bÀdFœg
() ? 1 : 0, "tiles_enabled_flag" );

227 
	`WRITE_FLAG
–
pcPPS
->
	`gëE¡r›yCodögSyncE«bÀdFœg
() ? 1 : 0, "entropy_coding_sync_enabled_flag" );

228 if–
pcPPS
->
	`gëTûesE«bÀdFœg
() )

230 
	`WRITE_UVLC
–
pcPPS
->
	`gëNumTûeCﬁumnsMöus1
(), "num_tile_columns_minus1" );

231 
	`WRITE_UVLC
–
pcPPS
->
	`gëNumTûeRowsMöus1
(), "num_tile_rows_minus1" );

232 
	`WRITE_FLAG
–
pcPPS
->
	`gëTûeUnif‹mS∑cögFœg
(), "uniform_spacing_flag" );

233 if–!
pcPPS
->
	`gëTûeUnif‹mS∑cögFœg
() )

235 
UI¡
 
i
=0; i<
pcPPS
->
	`gëNumTûeCﬁumnsMöus1
(); i++)

237 
	`WRITE_UVLC
–
pcPPS
->
	`gëTûeCﬁumnWidth
(
i
)-1, "column_width_minus1" );

239 
UI¡
 
i
=0; i<
pcPPS
->
	`gëNumTûeRowsMöus1
(); i++)

241 
	`WRITE_UVLC
–
pcPPS
->
	`gëTûeRowHeight
(
i
)-1, "row_height_minus1" );

244 
	`as£π
 ((
pcPPS
->
	`gëNumTûeCﬁumnsMöus1
(Ë+ÖcPPS->
	`gëNumTûeRowsMöus1
()) != 0);

245 
	`WRITE_FLAG
–
pcPPS
->
	`gëLo›FûãrA¸ossTûesE«bÀdFœg
()?1 : 0, "loop_filter_across_tiles_enabled_flag");

247 
	`WRITE_FLAG
–
pcPPS
->
	`gëLo›FûãrA¸ossSli˚sE«bÀdFœg
()?1 : 0, "pps_loop_filter_across_slices_enabled_flag");

248 
	`WRITE_FLAG
–
pcPPS
->
	`gëDeblockögFûãrC⁄åﬁPª£¡Fœg
()?1 : 0, "deblocking_filter_control_present_flag");

249 if(
pcPPS
->
	`gëDeblockögFûãrC⁄åﬁPª£¡Fœg
())

251 
	`WRITE_FLAG
–
pcPPS
->
	`gëDeblockögFûãrOvîrideE«bÀdFœg
() ? 1 : 0, "deblocking_filter_override_enabled_flag" );

252 
	`WRITE_FLAG
–
pcPPS
->
	`gëPPSDeblockögFûãrDißbÀdFœg
() ? 1 : 0, "pps_deblocking_filter_disabled_flag" );

253 if(!
pcPPS
->
	`gëPPSDeblockögFûãrDißbÀdFœg
())

255 
	`WRITE_SVLC
–
pcPPS
->
	`gëDeblockögFûãrBëaOff£tDiv2
(), "pps_beta_offset_div2" );

256 
	`WRITE_SVLC
–
pcPPS
->
	`gëDeblockögFûãrTcOff£tDiv2
(), "pps_tc_offset_div2" );

259 
	`WRITE_FLAG
–
pcPPS
->
	`gëSˇlögLi°Pª£¡Fœg
() ? 1 : 0, "pps_scaling_list_data_present_flag" );

260 if–
pcPPS
->
	`gëSˇlögLi°Pª£¡Fœg
() )

262 
	`codeSˇlögLi°
–
pcPPS
->
	`gëSˇlögLi°
() );

264 
	`WRITE_FLAG
–
pcPPS
->
	`gëLi°sModifiˇti⁄Pª£¡Fœg
(), "lists_modification_present_flag");

265 
	`WRITE_UVLC
–
pcPPS
->
	`gëLog2P¨ÆÀlMîgeLevñMöus2
(), "log2_parallel_merge_level_minus2");

266 
	`WRITE_FLAG
–
pcPPS
->
	`gëSli˚HódîExãnsi⁄Pª£¡Fœg
() ? 1 : 0, "slice_segment_header_extension_present_flag");

268 
Boﬁ
 
µs_exãnsi⁄_¥e£¡_Êag
=
Ál£
;

269 
Boﬁ
 
µs_exãnsi⁄_Êags
[
NUM_PPS_EXTENSION_FLAGS
]={
Ál£
};

271 
µs_exãnsi⁄_Êags
[
PPS_EXT__REXT
] = 
pcPPS
->
	`gëPpsR™geExãnsi⁄
().
	`£âögsDif„rFromDeÁu…s
’cPPS->
	`gëU£Tønsf‹mSkù
());

275 
I¡
 
i
=0; i<
NUM_PPS_EXTENSION_FLAGS
; i++)

277 
µs_exãnsi⁄_¥e£¡_Êag
|=
µs_exãnsi⁄_Êags
[
i
];

280 
	`WRITE_FLAG
–(
µs_exãnsi⁄_¥e£¡_Êag
?1:0), "pps_extension_present_flag" );

282 i‡(
µs_exãnsi⁄_¥e£¡_Êag
)

284 #i‡
ENC_DEC_TRACE
 || 
RExt__DECODER_DEBUG_BIT_STATISTICS


285 c⁄° 
TCh¨
 *
sy¡axSåögs
[]={ "pps_range_extension_flag",

295 
I¡
 
i
=0; i<
NUM_PPS_EXTENSION_FLAGS
; i++)

297 
	`WRITE_FLAG
–
µs_exãnsi⁄_Êags
[
i
]?1:0, 
sy¡axSåögs
[i] );

300 
I¡
 
i
=0; i<
NUM_PPS_EXTENSION_FLAGS
; i++)

302 i‡(
µs_exãnsi⁄_Êags
[
i
])

304 
	`PPSExãnsi⁄FœgIndex
(
i
))

306 
PPS_EXT__REXT
:

308 c⁄° 
TComPPSRExt
 &
µsR™geExãnsi⁄
 = 
pcPPS
->
	`gëPpsR™geExãnsi⁄
();

309 i‡(
pcPPS
->
	`gëU£Tønsf‹mSkù
())

311 
	`WRITE_UVLC
–
µsR™geExãnsi⁄
.
	`gëLog2MaxTønsf‹mSkùBlockSize
()-2, "log2_max_transform_skip_block_size_minus2");

314 
	`WRITE_FLAG
((
µsR™geExãnsi⁄
.
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
() ? 1 : 0), "cross_component_prediction_enabled_flag" );

316 
	`WRITE_FLAG
(
	`UI¡
(
µsR™geExãnsi⁄
.
	`gëChromaQpOff£tLi°E«bÀdFœg
()), "chroma_qp_offset_list_enabled_flag" );

317 i‡(
µsR™geExãnsi⁄
.
	`gëChromaQpOff£tLi°E«bÀdFœg
())

319 
	`WRITE_UVLC
(
µsR™geExãnsi⁄
.
	`gëDiffCuChromaQpOff£tDïth
(), "diff_cu_chroma_qp_offset_depth");

320 
	`WRITE_UVLC
(
µsR™geExãnsi⁄
.
	`gëChromaQpOff£tLi°Lí
() - 1, "chroma_qp_offset_list_len_minus1");

322 
I¡
 
cuChromaQpOff£tIdx
 = 0; cuChromaQpOff£tIdx < 
µsR™geExãnsi⁄
.
	`gëChromaQpOff£tLi°Lí
(); cuChromaQpOffsetIdx++)

324 
	`WRITE_SVLC
(
µsR™geExãnsi⁄
.
	`gëChromaQpOff£tLi°E¡ry
(
cuChromaQpOff£tIdx
+1).
u
.
comp
.
CbOff£t
, "cb_qp_offset_list[i]");

325 
	`WRITE_SVLC
(
µsR™geExãnsi⁄
.
	`gëChromaQpOff£tLi°E¡ry
(
cuChromaQpOff£tIdx
+1).
u
.
comp
.
CrOff£t
, "cr_qp_offset_list[i]");

329 
	`WRITE_UVLC
–
µsR™geExãnsi⁄
.
	`gëLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_LUMA
), "log2_sao_offset_scale_luma" );

330 
	`WRITE_UVLC
–
µsR™geExãnsi⁄
.
	`gëLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_CHROMA
), "log2_sao_offset_scale_chroma" );

334 
	`as£π
(
µs_exãnsi⁄_Êags
[
i
]==
Ál£
);

340 
	`xWrôeRb•TøûögBôs
();

341 
	}
}

343 
Void
 
	gTEncCavlc
::
	$codeVUI
–c⁄° 
TComVUI
 *
pcVUI
, c⁄° 
TComSPS
* 
pcSPS
 )

345 #i‡
ENC_DEC_TRACE


346 
	`Ârötf
–
g_hTø˚
, "----------- vui_parameters -----------\n");

348 
	`WRITE_FLAG
(
pcVUI
->
	`gëA•e˘R©ioInfoPª£¡Fœg
(), "aspect_ratio_info_present_flag");

349 i‡(
pcVUI
->
	`gëA•e˘R©ioInfoPª£¡Fœg
())

351 
	`WRITE_CODE
(
pcVUI
->
	`gëA•e˘R©ioIdc
(), 8, "aspect_ratio_idc" );

352 i‡(
pcVUI
->
	`gëA•e˘R©ioIdc
() == 255)

354 
	`WRITE_CODE
(
pcVUI
->
	`gëS¨Width
(), 16, "sar_width");

355 
	`WRITE_CODE
(
pcVUI
->
	`gëS¨Height
(), 16, "sar_height");

358 
	`WRITE_FLAG
(
pcVUI
->
	`gëOvîsˇnInfoPª£¡Fœg
(), "overscan_info_present_flag");

359 i‡(
pcVUI
->
	`gëOvîsˇnInfoPª£¡Fœg
())

361 
	`WRITE_FLAG
(
pcVUI
->
	`gëOvîsˇnAµr›rüãFœg
(), "overscan_appropriate_flag");

363 
	`WRITE_FLAG
(
pcVUI
->
	`gëVideoSig«lTy≥Pª£¡Fœg
(), "video_signal_type_present_flag");

364 i‡(
pcVUI
->
	`gëVideoSig«lTy≥Pª£¡Fœg
())

366 
	`WRITE_CODE
(
pcVUI
->
	`gëVideoF‹m©
(), 3, "video_format");

367 
	`WRITE_FLAG
(
pcVUI
->
	`gëVideoFuŒR™geFœg
(), "video_full_range_flag");

368 
	`WRITE_FLAG
(
pcVUI
->
	`gëCﬁourDes¸ùti⁄Pª£¡Fœg
(), "colour_description_present_flag");

369 i‡(
pcVUI
->
	`gëCﬁourDes¸ùti⁄Pª£¡Fœg
())

371 
	`WRITE_CODE
(
pcVUI
->
	`gëCﬁourPrim¨õs
(), 8, "colour_primaries");

372 
	`WRITE_CODE
(
pcVUI
->
	`gëTøns„rCh¨a˘îi°ics
(), 8, "transfer_characteristics");

373 
	`WRITE_CODE
(
pcVUI
->
	`gëM©rixC€fficõ¡s
(), 8, "matrix_coeffs");

377 
	`WRITE_FLAG
(
pcVUI
->
	`gëChromaLocInfoPª£¡Fœg
(), "chroma_loc_info_present_flag");

378 i‡(
pcVUI
->
	`gëChromaLocInfoPª£¡Fœg
())

380 
	`WRITE_UVLC
(
pcVUI
->
	`gëChromaSam∂eLocTy≥T›Fõld
(), "chroma_sample_loc_type_top_field");

381 
	`WRITE_UVLC
(
pcVUI
->
	`gëChromaSam∂eLocTy≥BŸtomFõld
(), "chroma_sample_loc_type_bottom_field");

384 
	`WRITE_FLAG
(
pcVUI
->
	`gëNeuåÆChromaIndiˇti⁄Fœg
(), "neutral_chroma_indication_flag");

385 
	`WRITE_FLAG
(
pcVUI
->
	`gëFõldSeqFœg
(), "field_seq_flag");

386 
	`WRITE_FLAG
(
pcVUI
->
	`gëFømeFõldInfoPª£¡Fœg
(), "frame_field_info_present_flag");

388 
Wödow
 
deÁu…Di•œyWödow
 = 
pcVUI
->
	`gëDeÁu…Di•œyWödow
();

389 
	`WRITE_FLAG
(
deÁu…Di•œyWödow
.
	`gëWödowE«bÀdFœg
(), "default_display_window_flag");

390 if–
deÁu…Di•œyWödow
.
	`gëWödowE«bÀdFœg
() )

392 
	`WRITE_UVLC
(
deÁu…Di•œyWödow
.
	`gëWödowLe·Off£t
(Ë/ 
TComSPS
::
	`gëWöUnôX
(
pcSPS
->
	`gëChromaF‹m©Idc
()), "def_disp_win_left_offset");

393 
	`WRITE_UVLC
(
deÁu…Di•œyWödow
.
	`gëWödowRightOff£t
(Ë/ 
TComSPS
::
	`gëWöUnôX
(
pcSPS
->
	`gëChromaF‹m©Idc
()), "def_disp_win_right_offset");

394 
	`WRITE_UVLC
(
deÁu…Di•œyWödow
.
	`gëWödowT›Off£t
(Ë/ 
TComSPS
::
	`gëWöUnôY
(
pcSPS
->
	`gëChromaF‹m©Idc
()), "def_disp_win_top_offset");

395 
	`WRITE_UVLC
(
deÁu…Di•œyWödow
.
	`gëWödowBŸtomOff£t
()/ 
TComSPS
::
	`gëWöUnôY
(
pcSPS
->
	`gëChromaF‹m©Idc
()), "def_disp_win_bottom_offset");

397 c⁄° 
TimögInfo
 *
timögInfo
 = 
pcVUI
->
	`gëTimögInfo
();

398 
	`WRITE_FLAG
(
timögInfo
->
	`gëTimögInfoPª£¡Fœg
(), "vui_timing_info_present_flag");

399 if(
timögInfo
->
	`gëTimögInfoPª£¡Fœg
())

401 
	`WRITE_CODE
(
timögInfo
->
	`gëNumUnôsInTick
(), 32, "vui_num_units_in_tick");

402 
	`WRITE_CODE
(
timögInfo
->
	`gëTimeSˇÀ
(), 32, "vui_time_scale");

403 
	`WRITE_FLAG
(
timögInfo
->
	`gëPocPr›‹ti⁄ÆToTimögFœg
(), "vui_poc_proportional_to_timing_flag");

404 if(
timögInfo
->
	`gëPocPr›‹ti⁄ÆToTimögFœg
())

406 
	`WRITE_UVLC
(
timögInfo
->
	`gëNumTicksPocDiffO√Möus1
(), "vui_num_ticks_poc_diff_one_minus1");

408 
	`WRITE_FLAG
(
pcVUI
->
	`gëHrdP¨amëîsPª£¡Fœg
(), "vui_hrd_parameters_present_flag");

409 if–
pcVUI
->
	`gëHrdP¨amëîsPª£¡Fœg
() )

411 
	`codeHrdP¨amëîs
(
pcVUI
->
	`gëHrdP¨amëîs
(), 1, 
pcSPS
->
	`gëMaxTLayîs
() - 1 );

415 
	`WRITE_FLAG
(
pcVUI
->
	`gëBô°ªamRe°ri˘i⁄Fœg
(), "bitstream_restriction_flag");

416 i‡(
pcVUI
->
	`gëBô°ªamRe°ri˘i⁄Fœg
())

418 
	`WRITE_FLAG
(
pcVUI
->
	`gëTûesFixedSåu˘uªFœg
(), "tiles_fixed_structure_flag");

419 
	`WRITE_FLAG
(
pcVUI
->
	`gëMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(), "motion_vectors_over_pic_boundaries_flag");

420 
	`WRITE_FLAG
(
pcVUI
->
	`gëRe°ri˘edRefPicLi°sFœg
(), "restricted_ref_pic_lists_flag");

421 
	`WRITE_UVLC
(
pcVUI
->
	`gëMöS∑tülSegmíèti⁄Idc
(), "min_spatial_segmentation_idc");

422 
	`WRITE_UVLC
(
pcVUI
->
	`gëMaxByãsPîPicDíom
(), "max_bytes_per_pic_denom");

423 
	`WRITE_UVLC
(
pcVUI
->
	`gëMaxBôsPîMöCuDíom
(), "max_bits_per_min_cu_denom");

424 
	`WRITE_UVLC
(
pcVUI
->
	`gëLog2MaxMvLígthH‹iz⁄èl
(), "log2_max_mv_length_horizontal");

425 
	`WRITE_UVLC
(
pcVUI
->
	`gëLog2MaxMvLígthVîtiˇl
(), "log2_max_mv_length_vertical");

427 
	}
}

429 
Void
 
	gTEncCavlc
::
	$codeHrdP¨amëîs
–c⁄° 
TComHRD
 *
hrd
, 
Boﬁ
 
comm⁄InfPª£¡Fœg
, 
UI¡
 
maxNumSubLayîsMöus1
 )

431 if–
comm⁄InfPª£¡Fœg
 )

433 
	`WRITE_FLAG
–
hrd
->
	`gëNÆHrdP¨amëîsPª£¡Fœg
() ? 1 : 0 , "nal_hrd_parameters_present_flag" );

434 
	`WRITE_FLAG
–
hrd
->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() ? 1 : 0 , "vcl_hrd_parameters_present_flag" );

435 if–
hrd
->
	`gëNÆHrdP¨amëîsPª£¡Fœg
(Ë|| hrd->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() )

437 
	`WRITE_FLAG
–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() ? 1 : 0, "sub_pic_hrd_params_present_flag" );

438 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

440 
	`WRITE_CODE
–
hrd
->
	`gëTickDivis‹Möus2
(), 8, "tick_divisor_minus2" );

441 
	`WRITE_CODE
–
hrd
->
	`gëDuCpbRemovÆDñayLígthMöus1
(), 5, "du_cpb_removal_delay_increment_length_minus1" );

442 
	`WRITE_FLAG
–
hrd
->
	`gëSubPicCpbP¨amsInPicTimögSEIFœg
() ? 1 : 0, "sub_pic_cpb_params_in_pic_timing_sei_flag" );

443 
	`WRITE_CODE
–
hrd
->
	`gëDpbOuçutDñayDuLígthMöus1
(), 5, "dpb_output_delay_du_length_minus1" );

445 
	`WRITE_CODE
–
hrd
->
	`gëBôR©eSˇÀ
(), 4, "bit_rate_scale" );

446 
	`WRITE_CODE
–
hrd
->
	`gëCpbSizeSˇÀ
(), 4, "cpb_size_scale" );

447 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

449 
	`WRITE_CODE
–
hrd
->
	`gëDuCpbSizeSˇÀ
(), 4, "du_cpb_size_scale" );

451 
	`WRITE_CODE
–
hrd
->
	`gëInôülCpbRemovÆDñayLígthMöus1
(), 5, "initial_cpb_removal_delay_length_minus1" );

452 
	`WRITE_CODE
–
hrd
->
	`gëCpbRemovÆDñayLígthMöus1
(), 5, "au_cpb_removal_delay_length_minus1" );

453 
	`WRITE_CODE
–
hrd
->
	`gëDpbOuçutDñayLígthMöus1
(), 5, "dpb_output_delay_length_minus1" );

456 
I¡
 
i
, 
j
, 
«lOrV˛
;

457  
i
 = 0; i <
maxNumSubLayîsMöus1
; i ++ )

459 
	`WRITE_FLAG
–
hrd
->
	`gëFixedPicR©eFœg
–
i
 ) ? 1 : 0, "fixed_pic_rate_general_flag");

460 
Boﬁ
 
fixedPixR©eWôhöCvsFœg
 = 
åue
;

461 if–!
hrd
->
	`gëFixedPicR©eFœg
–
i
 ) )

463 
fixedPixR©eWôhöCvsFœg
 = 
hrd
->
	`gëFixedPicR©eWôhöCvsFœg
–
i
 );

464 
	`WRITE_FLAG
–
hrd
->
	`gëFixedPicR©eWôhöCvsFœg
–
i
 ) ? 1 : 0, "fixed_pic_rate_within_cvs_flag");

466 if–
fixedPixR©eWôhöCvsFœg
 )

468 
	`WRITE_UVLC
–
hrd
->
	`gëPicDuøti⁄InTcMöus1
–
i
 ), "elemental_duration_in_tc_minus1");

472 
	`WRITE_FLAG
–
hrd
->
	`gëLowDñayHrdFœg
–
i
 ) ? 1 : 0, "low_delay_hrd_flag");

474 i‡(!
hrd
->
	`gëLowDñayHrdFœg
–
i
 ))

476 
	`WRITE_UVLC
–
hrd
->
	`gëCpbC¡Möus1
–
i
 ), "cpb_cnt_minus1");

479  
«lOrV˛
 = 0;ÇalOrVcl < 2;ÇalOrVcl ++ )

481 if–––
«lOrV˛
 =0 ) && ( 
hrd
->
	`gëNÆHrdP¨amëîsPª£¡Fœg
() ) ) ||

482 ––
«lOrV˛
 =1 ) && ( 
hrd
->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() ) ) )

484  
j
 = 0; j <–
hrd
->
	`gëCpbC¡Möus1
–
i
 ) ); j ++ )

486 
	`WRITE_UVLC
–
hrd
->
	`gëBôR©eVÆueMöus1
–
i
, 
j
, 
«lOrV˛
 ), "bit_rate_value_minus1");

487 
	`WRITE_UVLC
–
hrd
->
	`gëCpbSizeVÆueMöus1
–
i
, 
j
, 
«lOrV˛
 ), "cpb_size_value_minus1");

488 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

490 
	`WRITE_UVLC
–
hrd
->
	`gëDuCpbSizeVÆueMöus1
–
i
, 
j
, 
«lOrV˛
 ), "cpb_size_du_value_minus1");

491 
	`WRITE_UVLC
–
hrd
->
	`gëDuBôR©eVÆueMöus1
–
i
, 
j
, 
«lOrV˛
 ), "bit_rate_du_value_minus1");

493 
	`WRITE_FLAG
–
hrd
->
	`gëCbrFœg
–
i
, 
j
, 
«lOrV˛
 ) ? 1 : 0, "cbr_flag");

498 
	}
}

500 
Void
 
	gTEncCavlc
::
	$codeSPS
–c⁄° 
TComSPS
* 
pcSPS
 )

503 c⁄° 
ChromaF‹m©
 
f‹m©
 = 
pcSPS
->
	`gëChromaF‹m©Idc
();

504 c⁄° 
Boﬁ
 
chromaE«bÀd
 = 
	`isChromaE«bÀd
(
f‹m©
);

506 #i‡
ENC_DEC_TRACE


507 #i‡
MCTS_EXTRACTION


508 
	`xTø˚SPSHódîEnc
();

510 
	`xTø˚SPSHódî
();

513 
	`WRITE_CODE
–
pcSPS
->
	`gëVPSId
 (), 4, "sps_video_parameter_set_id" );

514 
	`WRITE_CODE
–
pcSPS
->
	`gëMaxTLayîs
() - 1, 3, "sps_max_sub_layers_minus1" );

515 
	`WRITE_FLAG
–
pcSPS
->
	`gëTemp‹ÆIdNe°ögFœg
() ? 1 : 0, "sps_temporal_id_nesting_flag" );

516 
	`codePTL
(
pcSPS
->
	`gëPTL
(), 1,ÖcSPS->
	`gëMaxTLayîs
() - 1);

517 
	`WRITE_UVLC
–
pcSPS
->
	`gëSPSId
 (), "sps_seq_parameter_set_id" );

518 
	`WRITE_UVLC
–
	`I¡
(
pcSPS
->
	`gëChromaF‹m©Idc
 ()), "chroma_format_idc" );

519 if–
f‹m©
 =
CHROMA_444
 )

521 
	`WRITE_FLAG
( 0, "separate_colour_plane_flag");

524 
	`WRITE_UVLC
–
pcSPS
->
	`gëPicWidthInLumaSam∂es
 (), "pic_width_in_luma_samples" );

525 
	`WRITE_UVLC
–
pcSPS
->
	`gëPicHeightInLumaSam∂es
(), "pic_height_in_luma_samples" );

526 
Wödow
 
c⁄f
 = 
pcSPS
->
	`gëC⁄f‹m™˚Wödow
();

528 
	`WRITE_FLAG
–
c⁄f
.
	`gëWödowE«bÀdFœg
(), "conformance_window_flag" );

529 i‡(
c⁄f
.
	`gëWödowE«bÀdFœg
())

531 
	`WRITE_UVLC
–
c⁄f
.
	`gëWödowLe·Off£t
(Ë/ 
TComSPS
::
	`gëWöUnôX
(
pcSPS
->
	`gëChromaF‹m©Idc
() ), "conf_win_left_offset" );

532 
	`WRITE_UVLC
–
c⁄f
.
	`gëWödowRightOff£t
(Ë/ 
TComSPS
::
	`gëWöUnôX
(
pcSPS
->
	`gëChromaF‹m©Idc
() ), "conf_win_right_offset" );

533 
	`WRITE_UVLC
–
c⁄f
.
	`gëWödowT›Off£t
(Ë/ 
TComSPS
::
	`gëWöUnôY
(
pcSPS
->
	`gëChromaF‹m©Idc
() ), "conf_win_top_offset" );

534 
	`WRITE_UVLC
–
c⁄f
.
	`gëWödowBŸtomOff£t
(Ë/ 
TComSPS
::
	`gëWöUnôY
(
pcSPS
->
	`gëChromaF‹m©Idc
() ), "conf_win_bottom_offset" );

537 
	`WRITE_UVLC
–
pcSPS
->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
) - 8, "bit_depth_luma_minus8" );

539 
	`WRITE_UVLC
–
chromaE«bÀd
 ? (
pcSPS
->
	`gëBôDïth
(
CHANNEL_TYPE_CHROMA
) - 8):0, "bit_depth_chroma_minus8" );

541 
	`WRITE_UVLC
–
pcSPS
->
	`gëBôsF‹POC
()-4, "log2_max_pic_order_cnt_lsb_minus4" );

543 c⁄° 
Boﬁ
 
subLayîOrdîögInfoPª£¡Fœg
 = 1;

544 
	`WRITE_FLAG
(
subLayîOrdîögInfoPª£¡Fœg
, "sps_sub_layer_ordering_info_present_flag");

545 
UI¡
 
i
=0; i <
pcSPS
->
	`gëMaxTLayîs
()-1; i++)

547 
	`WRITE_UVLC
–
pcSPS
->
	`gëMaxDecPicBuf„rög
(
i
) - 1, "sps_max_dec_pic_buffering_minus1[i]" );

548 
	`WRITE_UVLC
–
pcSPS
->
	`gëNumRe‹dîPics
(
i
), "sps_max_num_reorder_pics[i]" );

549 
	`WRITE_UVLC
–
pcSPS
->
	`gëMaxL©ícyIn¸ó£Plus1
(
i
), "sps_max_latency_increase_plus1[i]" );

550 i‡(!
subLayîOrdîögInfoPª£¡Fœg
)

555 
	`as£π
–
pcSPS
->
	`gëMaxCUWidth
(Ë=pcSPS->
	`gëMaxCUHeight
() );

556 
	`WRITE_UVLC
–
pcSPS
->
	`gëLog2MöCodögBlockSize
() - 3, "log2_min_luma_coding_block_size_minus3" );

557 
	`WRITE_UVLC
–
pcSPS
->
	`gëLog2DiffMaxMöCodögBlockSize
(), "log2_diff_max_min_luma_coding_block_size" );

558 
	`WRITE_UVLC
–
pcSPS
->
	`gëQuadåìTULog2MöSize
() - 2, "log2_min_luma_transform_block_size_minus2" );

559 
	`WRITE_UVLC
–
pcSPS
->
	`gëQuadåìTULog2MaxSize
(Ë-ÖcSPS->
	`gëQuadåìTULog2MöSize
(), "log2_diff_max_min_luma_transform_block_size" );

560 
	`WRITE_UVLC
–
pcSPS
->
	`gëQuadåìTUMaxDïthI¡î
() - 1, "max_transform_hierarchy_depth_inter" );

561 
	`WRITE_UVLC
–
pcSPS
->
	`gëQuadåìTUMaxDïthI¡ø
() - 1, "max_transform_hierarchy_depth_intra" );

562 
	`WRITE_FLAG
–
pcSPS
->
	`gëSˇlögLi°Fœg
() ? 1 : 0, "scaling_list_enabled_flag" );

563 if(
pcSPS
->
	`gëSˇlögLi°Fœg
())

565 
	`WRITE_FLAG
–
pcSPS
->
	`gëSˇlögLi°Pª£¡Fœg
() ? 1 : 0, "sps_scaling_list_data_present_flag" );

566 if(
pcSPS
->
	`gëSˇlögLi°Pª£¡Fœg
())

568 
	`codeSˇlögLi°
–
pcSPS
->
	`gëSˇlögLi°
() );

571 
	`WRITE_FLAG
–
pcSPS
->
	`gëU£AMP
() ? 1 : 0, "amp_enabled_flag" );

572 
	`WRITE_FLAG
–
pcSPS
->
	`gëU£SAO
() ? 1 : 0, "sample_adaptive_offset_enabled_flag");

574 
	`WRITE_FLAG
–
pcSPS
->
	`gëU£PCM
() ? 1 : 0, "pcm_enabled_flag");

575 if–
pcSPS
->
	`gëU£PCM
() )

577 
	`WRITE_CODE
–
pcSPS
->
	`gëPCMBôDïth
(
CHANNEL_TYPE_LUMA
) - 1, 4, "pcm_sample_bit_depth_luma_minus1" );

578 
	`WRITE_CODE
–
chromaE«bÀd
 ? (
pcSPS
->
	`gëPCMBôDïth
(
CHANNEL_TYPE_CHROMA
) - 1) : 0, 4, "pcm_sample_bit_depth_chroma_minus1" );

579 
	`WRITE_UVLC
–
pcSPS
->
	`gëPCMLog2MöSize
() - 3, "log2_min_pcm_luma_coding_block_size_minus3" );

580 
	`WRITE_UVLC
–
pcSPS
->
	`gëPCMLog2MaxSize
(Ë-ÖcSPS->
	`gëPCMLog2MöSize
(), "log2_diff_max_min_pcm_luma_coding_block_size" );

581 
	`WRITE_FLAG
–
pcSPS
->
	`gëPCMFûãrDißbÀFœg
()?1 : 0, "pcm_loop_filter_disable_flag");

584 
	`as£π
–
pcSPS
->
	`gëMaxTLayîs
() > 0 );

586 c⁄° 
TComRPSLi°
* 
ΩsLi°
 = 
pcSPS
->
	`gëRPSLi°
();

588 
	`WRITE_UVLC
(
ΩsLi°
->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
(), "num_short_term_ref_pic_sets" );

589 
I¡
 
i
=0; i < 
ΩsLi°
->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
(); i++)

591 c⁄° 
TComRe„ªn˚Pi˘uªSë
*
Ωs
 = 
ΩsLi°
->
	`gëRe„ªn˚Pi˘uªSë
(
i
);

592 
	`codeSh‹tTîmRefPicSë
–
Ωs
,
Ál£
, 
i
);

594 
	`WRITE_FLAG
–
pcSPS
->
	`gëL⁄gTîmRefsPª£¡
() ? 1 : 0, "long_term_ref_pics_present_flag" );

595 i‡(
pcSPS
->
	`gëL⁄gTîmRefsPª£¡
())

597 
	`WRITE_UVLC
(
pcSPS
->
	`gëNumL⁄gTîmRefPicSPS
(), "num_long_term_ref_pics_sps" );

598 
UI¡
 
k
 = 0; k < 
pcSPS
->
	`gëNumL⁄gTîmRefPicSPS
(); k++)

600 
	`WRITE_CODE
–
pcSPS
->
	`gëLtRefPicPocLsbSps
(
k
),ÖcSPS->
	`gëBôsF‹POC
(), "lt_ref_pic_poc_lsb_sps");

601 
	`WRITE_FLAG
–
pcSPS
->
	`gëU£dByCuºPicLtSPSFœg
(
k
), "used_by_curr_pic_lt_sps_flag[i]");

604 
	`WRITE_FLAG
–
pcSPS
->
	`gëSPSTemp‹ÆMVPE«bÀdFœg
() ? 1 : 0, "sps_temporal_mvp_enabled_flag" );

606 
	`WRITE_FLAG
–
pcSPS
->
	`gëU£Så⁄gI¡øSmoŸhög
(), "strong_intra_smoothing_enable_flag" );

608 
	`WRITE_FLAG
–
pcSPS
->
	`gëVuiP¨amëîsPª£¡Fœg
(), "vui_parameters_present_flag" );

609 i‡(
pcSPS
->
	`gëVuiP¨amëîsPª£¡Fœg
())

611 
	`codeVUI
(
pcSPS
->
	`gëVuiP¨amëîs
(),ÖcSPS);

614 
Boﬁ
 
•s_exãnsi⁄_¥e£¡_Êag
=
Ál£
;

615 
Boﬁ
 
•s_exãnsi⁄_Êags
[
NUM_SPS_EXTENSION_FLAGS
]={
Ál£
};

617 
•s_exãnsi⁄_Êags
[
SPS_EXT__REXT
] = 
pcSPS
->
	`gëSpsR™geExãnsi⁄
().
	`£âögsDif„rFromDeÁu…s
();

621 
I¡
 
i
=0; i<
NUM_SPS_EXTENSION_FLAGS
; i++)

623 
•s_exãnsi⁄_¥e£¡_Êag
|=
•s_exãnsi⁄_Êags
[
i
];

626 
	`WRITE_FLAG
–(
•s_exãnsi⁄_¥e£¡_Êag
?1:0), "sps_extension_present_flag" );

628 i‡(
•s_exãnsi⁄_¥e£¡_Êag
)

630 #i‡
ENC_DEC_TRACE
 || 
RExt__DECODER_DEBUG_BIT_STATISTICS


631 c⁄° 
TCh¨
 *
sy¡axSåögs
[]={ "sps_range_extension_flag",

641 
I¡
 
i
=0; i<
NUM_SPS_EXTENSION_FLAGS
; i++)

643 
	`WRITE_FLAG
–
•s_exãnsi⁄_Êags
[
i
]?1:0, 
sy¡axSåögs
[i] );

646 
I¡
 
i
=0; i<
NUM_SPS_EXTENSION_FLAGS
; i++)

648 i‡(
•s_exãnsi⁄_Êags
[
i
])

650 
	`SPSExãnsi⁄FœgIndex
(
i
))

652 
SPS_EXT__REXT
:

654 c⁄° 
TComSPSRExt
 &
•sR™geExãnsi⁄
=
pcSPS
->
	`gëSpsR™geExãnsi⁄
();

656 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëTønsf‹mSkùRŸ©i⁄E«bÀdFœg
() ? 1 : 0), "transform_skip_rotation_enabled_flag");

657 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëTønsf‹mSkùC⁄ãxtE«bÀdFœg
() ? 1 : 0), "transform_skip_context_enabled_flag");

658 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_IMPLICIT
) ? 1 : 0), "implicit_rdpcm_enabled_flag" );

659 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëRdpcmE«bÀdFœg
(
RDPCM_SIGNAL_EXPLICIT
) ? 1 : 0), "explicit_rdpcm_enabled_flag" );

660 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëExãndedPªcisi⁄Pro˚ssögFœg
() ? 1 : 0), "extended_precision_processing_flag" );

661 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëI¡øSmoŸhögDißbÀdFœg
() ? 1 : 0), "intra_smoothing_disabled_flag" );

662 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
() ? 1 : 0), "high_precision_offsets_enabled_flag" );

663 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
() ? 1 : 0), "persistent_rice_adaptation_enabled_flag" );

664 
	`WRITE_FLAG
–(
•sR™geExãnsi⁄
.
	`gëCabacBy∑ssAlignmítE«bÀdFœg
() ? 1 : 0), "cabac_bypass_alignment_enabled_flag" );

668 
	`as£π
(
•s_exãnsi⁄_Êags
[
i
]==
Ál£
);

674 
	`xWrôeRb•TøûögBôs
();

675 
	}
}

677 
Void
 
	gTEncCavlc
::
	$codeVPS
–c⁄° 
TComVPS
* 
pcVPS
 )

679 #i‡
ENC_DEC_TRACE


680 #i‡
MCTS_EXTRACTION


681 
	`xTø˚VPSHódîEnc
();

683 
	`xTø˚VPSHódî
();

686 
	`WRITE_CODE
–
pcVPS
->
	`gëVPSId
(), 4, "vps_video_parameter_set_id" );

687 
	`WRITE_FLAG
( 1, "vps_base_layer_internal_flag" );

688 
	`WRITE_FLAG
( 1, "vps_base_layer_available_flag" );

689 
	`WRITE_CODE
( 0, 6, "vps_max_layers_minus1" );

690 
	`WRITE_CODE
–
pcVPS
->
	`gëMaxTLayîs
() - 1, 3, "vps_max_sub_layers_minus1" );

691 
	`WRITE_FLAG
–
pcVPS
->
	`gëTemp‹ÆNe°ögFœg
(), "vps_temporal_id_nesting_flag" );

692 
	`as£π
 (
pcVPS
->
	`gëMaxTLayîs
()>1||pcVPS->
	`gëTemp‹ÆNe°ögFœg
());

693 
	`WRITE_CODE
( 0xffff, 16, "vps_reserved_0xffff_16bits" );

694 
	`codePTL
–
pcVPS
->
	`gëPTL
(), 
åue
,ÖcVPS->
	`gëMaxTLayîs
() - 1 );

695 c⁄° 
Boﬁ
 
subLayîOrdîögInfoPª£¡Fœg
 = 1;

696 
	`WRITE_FLAG
(
subLayîOrdîögInfoPª£¡Fœg
, "vps_sub_layer_ordering_info_present_flag");

697 
UI¡
 
i
=0; i <
pcVPS
->
	`gëMaxTLayîs
()-1; i++)

699 
	`WRITE_UVLC
–
pcVPS
->
	`gëMaxDecPicBuf„rög
(
i
) - 1, "vps_max_dec_pic_buffering_minus1[i]" );

700 
	`WRITE_UVLC
–
pcVPS
->
	`gëNumRe‹dîPics
(
i
), "vps_max_num_reorder_pics[i]" );

701 
	`WRITE_UVLC
–
pcVPS
->
	`gëMaxL©ícyIn¸ó£
(
i
), "vps_max_latency_increase_plus1[i]" );

702 i‡(!
subLayîOrdîögInfoPª£¡Fœg
)

708 
	`as£π
–
pcVPS
->
	`gëNumHrdP¨amëîs
(Ë<
MAX_VPS_NUM_HRD_PARAMETERS
 );

709 
	`as£π
–
pcVPS
->
	`gëMaxNuhRe£rvedZîoLayîId
(Ë< 
MAX_VPS_NUH_RESERVED_ZERO_LAYER_ID_PLUS1
 );

710 
	`WRITE_CODE
–
pcVPS
->
	`gëMaxNuhRe£rvedZîoLayîId
(), 6, "vps_max_layer_id" );

711 
	`WRITE_UVLC
–
pcVPS
->
	`gëMaxOpSës
() - 1, "vps_num_layer_sets_minus1" );

712  
UI¡
 
›sIdx
 = 1; opsIdx <–
pcVPS
->
	`gëMaxOpSës
() - 1 ); opsIdx ++ )

715  
UI¡
 
i
 = 0; i <
pcVPS
->
	`gëMaxNuhRe£rvedZîoLayîId
(); i ++ )

719 
	`WRITE_FLAG
–
pcVPS
->
	`gëLayîIdIn˛udedFœg
–
›sIdx
, 
i
 ) ? 1 : 0, "layer_id_included_flag[opsIdx][i]" );

722 c⁄° 
TimögInfo
 *
timögInfo
 = 
pcVPS
->
	`gëTimögInfo
();

723 
	`WRITE_FLAG
(
timögInfo
->
	`gëTimögInfoPª£¡Fœg
(), "vps_timing_info_present_flag");

724 if(
timögInfo
->
	`gëTimögInfoPª£¡Fœg
())

726 
	`WRITE_CODE
(
timögInfo
->
	`gëNumUnôsInTick
(), 32, "vps_num_units_in_tick");

727 
	`WRITE_CODE
(
timögInfo
->
	`gëTimeSˇÀ
(), 32, "vps_time_scale");

728 
	`WRITE_FLAG
(
timögInfo
->
	`gëPocPr›‹ti⁄ÆToTimögFœg
(), "vps_poc_proportional_to_timing_flag");

729 if(
timögInfo
->
	`gëPocPr›‹ti⁄ÆToTimögFœg
())

731 
	`WRITE_UVLC
(
timögInfo
->
	`gëNumTicksPocDiffO√Möus1
(), "vps_num_ticks_poc_diff_one_minus1");

733 
	`WRITE_UVLC
–
pcVPS
->
	`gëNumHrdP¨amëîs
(), "vps_num_hrd_parameters" );

735 if–
pcVPS
->
	`gëNumHrdP¨amëîs
() > 0 )

737  
UI¡
 
i
 = 0; i < 
pcVPS
->
	`gëNumHrdP¨amëîs
(); i ++ )

740 
	`WRITE_UVLC
–
pcVPS
->
	`gëHrdOpSëIdx
–
i
 ), "hrd_layer_set_idx" );

741 if–
i
 > 0 )

743 
	`WRITE_FLAG
–
pcVPS
->
	`gëC¥msPª£¡Fœg
–
i
 ) ? 1 : 0, "cprms_present_flag[i]" );

745 
	`codeHrdP¨amëîs
(
pcVPS
->
	`gëHrdP¨amëîs
(
i
),ÖcVPS->
	`gëC¥msPª£¡Fœg
–ò),ÖcVPS->
	`gëMaxTLayîs
() - 1);

749 
	`WRITE_FLAG
( 0, "vps_extension_flag" );

752 
	`xWrôeRb•TøûögBôs
();

753 
	}
}

755 
Void
 
	gTEncCavlc
::
	$codeSli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
 )

757 #i‡
ENC_DEC_TRACE


758 #i‡
MCTS_EXTRACTION


759 
	`xTø˚Sli˚HódîEnc
();

761 
	`xTø˚Sli˚Hódî
();

765 c⁄° 
ChromaF‹m©
 
f‹m©
 = 
pcSli˚
->
	`gëSPS
()->
	`gëChromaF‹m©Idc
();

766 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
f‹m©
);

767 c⁄° 
Boﬁ
 
chromaE«bÀd
 = 
	`isChromaE«bÀd
(
f‹m©
);

770 
I¡
 
maxSli˚SegmítAddªss
 = 
pcSli˚
->
	`gëPic
()->
	`gëNumbîOfCtusInFøme
();

771 
I¡
 
bôsSli˚SegmítAddªss
 = 0;

772 
maxSli˚SegmítAddªss
>(1<<
bôsSli˚SegmítAddªss
))

774 
bôsSli˚SegmítAddªss
++;

776 c⁄° 
I¡
 
˘uTsAddªss
 = 
pcSli˚
->
	`gëSli˚SegmítCurSèπCtuTsAddr
();

779 c⁄° 
I¡
 
¶i˚SegmítRsAddªss
 = 
pcSli˚
->
	`gëPic
()->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
˘uTsAddªss
);

781 
	`WRITE_FLAG
–
¶i˚SegmítRsAddªss
==0, "first_slice_segment_in_pic_flag" );

782 i‡–
pcSli˚
->
	`gëR≠PicFœg
() )

784 
	`WRITE_FLAG
–
pcSli˚
->
	`gëNoOuçutPri‹PicsFœg
() ? 1 : 0, "no_output_of_prior_pics_flag" );

786 
	`WRITE_UVLC
–
pcSli˚
->
	`gëPPS
()->
	`gëPPSId
(), "slice_pic_parameter_set_id" );

787 i‡–
pcSli˚
->
	`gëPPS
()->
	`gëDïídítSli˚SegmítsE«bÀdFœg
(Ë&& (
¶i˚SegmítRsAddªss
!=0) )

789 
	`WRITE_FLAG
–
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
() ? 1 : 0, "dependent_slice_segment_flag" );

791 if(
¶i˚SegmítRsAddªss
>0)

793 
	`WRITE_CODE
–
¶i˚SegmítRsAddªss
, 
bôsSli˚SegmítAddªss
, "slice_segment_address" );

795 i‡–!
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
() )

797 
I¡
 
i
 = 0; i < 
pcSli˚
->
	`gëPPS
()->
	`gëNumExåaSli˚HódîBôs
(); i++)

799 
	`WRITE_FLAG
(0, "slice_reserved_flag[]");

802 
	`WRITE_UVLC
–
pcSli˚
->
	`gëSli˚Ty≥
(), "slice_type" );

804 if–
pcSli˚
->
	`gëPPS
()->
	`gëOuçutFœgPª£¡Fœg
() )

806 
	`WRITE_FLAG
–
pcSli˚
->
	`gëPicOuçutFœg
() ? 1 : 0, "pic_output_flag" );

809 if–!
pcSli˚
->
	`gëIdrPicFœg
() )

811 
I¡
 
picOrdîC¡LSB
 = (
pcSli˚
->
	`gëPOC
()-pcSli˚->
	`gëLa°IDR
()+(1<<pcSli˚->
	`gëSPS
()->
	`gëBôsF‹POC
())) & ((1<<pcSlice->getSPS()->getBitsForPOC())-1);

812 
	`WRITE_CODE
–
picOrdîC¡LSB
, 
pcSli˚
->
	`gëSPS
()->
	`gëBôsF‹POC
(), "slice_pic_order_cnt_lsb");

813 c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
Ωs
 = 
pcSli˚
->
	`gëRPS
();

818 i‡(
pcSli˚
->
	`isIRAP
())

820 
I¡
 
picIdx
 = 0;ÖicIdx < 
Ωs
->
	`gëNumbîOfPi˘uªs
();ÖicIdx++)

822 
	`as£π
 (!
Ωs
->
	`gëU£d
(
picIdx
));

826 if(
pcSli˚
->
	`gëRPSidx
() < 0)

828 
	`WRITE_FLAG
( 0, "short_term_ref_pic_set_sps_flag");

829 
	`codeSh‹tTîmRefPicSë
–
Ωs
, 
åue
, 
pcSli˚
->
	`gëSPS
()->
	`gëRPSLi°
()->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
());

833 
	`WRITE_FLAG
( 1, "short_term_ref_pic_set_sps_flag");

834 
I¡
 
numBôs
 = 0;

835 (1 << 
numBôs
Ë< 
pcSli˚
->
	`gëSPS
()->
	`gëRPSLi°
()->
	`gëNumbîOfRe„ªn˚Pi˘uªSës
())

837 
numBôs
++;

839 i‡(
numBôs
 > 0)

841 
	`WRITE_CODE
–
pcSli˚
->
	`gëRPSidx
(), 
numBôs
, "short_term_ref_pic_set_idx" );

844 if(
pcSli˚
->
	`gëSPS
()->
	`gëL⁄gTîmRefsPª£¡
())

846 
I¡
 
numLåpInSH
 = 
Ωs
->
	`gëNumbîOfL⁄gãrmPi˘uªs
();

847 
I¡
 
…ΩInSPS
[
MAX_NUM_REF_PICS
];

848 
I¡
 
numLåpInSPS
 = 0;

849 
UI¡
 
…ΩIndex
;

850 
I¡
 
cou¡î
 = 0;

857 
I¡
 
k
 = 
Ωs
->
	`gëNumbîOfPi˘uªs
()-1; k >Ñps->gëNumbîOfPi˘uªs()-Ωs->
	`gëNumbîOfL⁄gãrmPi˘uªs
()-1; k--)

859 i‡(
	`födM©chögLTRP
(
pcSli˚
, &
…ΩIndex
, 
Ωs
->
	`gëPOC
(
k
),Ñps->
	`gëU£d
(k)))

861 
…ΩInSPS
[
numLåpInSPS
] = 
…ΩIndex
;

862 
numLåpInSPS
++;

866 
cou¡î
++;

869 
numLåpInSH
 -
numLåpInSPS
;

871 
	`as£π
 (
numLåpInSH
==0 || 
numLåpInSPS
==0);

873 
I¡
 
bôsF‹LåpInSPS
 = 0;

874 
pcSli˚
->
	`gëSPS
()->
	`gëNumL⁄gTîmRefPicSPS
(Ë> (1 << 
bôsF‹LåpInSPS
))

876 
bôsF‹LåpInSPS
++;

878 i‡(
pcSli˚
->
	`gëSPS
()->
	`gëNumL⁄gTîmRefPicSPS
() > 0)

880 
	`WRITE_UVLC
–
numLåpInSPS
, "num_long_term_sps");

882 
	`WRITE_UVLC
–
numLåpInSH
, "num_long_term_pics");

885 
I¡
 
¥evDñèMSB
 = 0, 
¥evLSB
 = 0;

886 
I¡
 
off£t
 = 
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
(Ë+Ñps->
	`gëNumbîOfPosôivePi˘uªs
();

887 
cou¡î
 = 0;

890 
I¡
 
i
=
Ωs
->
	`gëNumbîOfPi˘uªs
()-1 ; i > 
off£t
-1; i--, 
cou¡î
++)

892 i‡(
cou¡î
 < 
numLåpInSPS
)

894 i‡(
bôsF‹LåpInSPS
 > 0)

896 
	`WRITE_CODE
–
…ΩInSPS
[
cou¡î
], 
bôsF‹LåpInSPS
, "lt_idx_sps[i]");

901 
	`WRITE_CODE
–
Ωs
->
	`gëPocLSBLT
(
i
), 
pcSli˚
->
	`gëSPS
()->
	`gëBôsF‹POC
(), "poc_lsb_lt");

902 
	`WRITE_FLAG
–
Ωs
->
	`gëU£d
(
i
), "used_by_curr_pic_lt_flag");

904 
	`WRITE_FLAG
–
Ωs
->
	`gëDñèPocMSBPª£¡Fœg
(
i
), "delta_poc_msb_present_flag");

906 if(
Ωs
->
	`gëDñèPocMSBPª£¡Fœg
(
i
))

908 
Boﬁ
 
dñèFœg
 = 
Ál£
;

910 if–(
i
 =
Ωs
->
	`gëNumbîOfPi˘uªs
()-1Ë|| (ò=Ωs->gëNumbîOfPi˘uªs()-1-
numLåpInSPS
Ë|| (Ωs->
	`gëPocLSBLT
(iË!
¥evLSB
) )

912 
dñèFœg
 = 
åue
;

914 if(
dñèFœg
)

916 
	`WRITE_UVLC
–
Ωs
->
	`gëDñèPocMSBCy˛eLT
(
i
), "delta_poc_msb_cycle_lt[i]" );

920 
I¡
 
dif„ªn˚InDñèMSB
 = 
Ωs
->
	`gëDñèPocMSBCy˛eLT
(
i
Ë- 
¥evDñèMSB
;

921 
	`as£π
(
dif„ªn˚InDñèMSB
 >= 0);

922 
	`WRITE_UVLC
–
dif„ªn˚InDñèMSB
, "delta_poc_msb_cycle_lt[i]" );

924 
¥evLSB
 = 
Ωs
->
	`gëPocLSBLT
(
i
);

925 
¥evDñèMSB
 = 
Ωs
->
	`gëDñèPocMSBCy˛eLT
(
i
);

929 i‡(
pcSli˚
->
	`gëSPS
()->
	`gëSPSTemp‹ÆMVPE«bÀdFœg
())

931 
	`WRITE_FLAG
–
pcSli˚
->
	`gëE«bÀTMVPFœg
() ? 1 : 0, "slice_temporal_mvp_enabled_flag" );

934 if(
pcSli˚
->
	`gëSPS
()->
	`gëU£SAO
())

936 
	`WRITE_FLAG
–
pcSli˚
->
	`gëSaoE«bÀdFœg
(
CHANNEL_TYPE_LUMA
), "slice_sao_luma_flag" );

937 i‡(
chromaE«bÀd
)

939 
	`WRITE_FLAG
–
pcSli˚
->
	`gëSaoE«bÀdFœg
(
CHANNEL_TYPE_CHROMA
), "slice_sao_chroma_flag" );

945 i‡(!
pcSli˚
->
	`isI¡ø
())

947 
Boﬁ
 
ovîrideFœg
 = (
pcSli˚
->
	`gëNumRefIdx
–
REF_PIC_LIST_0
 )!ıcSli˚->
	`gëPPS
()->
	`gëNumRefIdxL0DeÁu…A˘ive
()||’cSli˚->
	`isI¡îB
()&&pcSli˚->gëNumRefIdx–
REF_PIC_LIST_1
 )!ıcSli˚->gëPPS()->
	`gëNumRefIdxL1DeÁu…A˘ive
()));

948 
	`WRITE_FLAG
–
ovîrideFœg
 ? 1 : 0, "num_ref_idx_active_override_flag");

949 i‡(
ovîrideFœg
)

951 
	`WRITE_UVLC
–
pcSli˚
->
	`gëNumRefIdx
–
REF_PIC_LIST_0
 ) - 1, "num_ref_idx_l0_active_minus1" );

952 i‡(
pcSli˚
->
	`isI¡îB
())

954 
	`WRITE_UVLC
–
pcSli˚
->
	`gëNumRefIdx
–
REF_PIC_LIST_1
 ) - 1, "num_ref_idx_l1_active_minus1" );

958 
pcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_1
, 0);

964 
pcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_0
, 0);

965 
pcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_1
, 0);

968 if–
pcSli˚
->
	`gëPPS
()->
	`gëLi°sModifiˇti⁄Pª£¡Fœg
(Ë&&ÖcSli˚->
	`gëNumRpsCuºTempLi°
() > 1)

970 
TComRefPicLi°Modifiˇti⁄
* 
ªfPicLi°Modifiˇti⁄
 = 
pcSli˚
->
	`gëRefPicLi°Modifiˇti⁄
();

971 if(!
pcSli˚
->
	`isI¡ø
())

973 
	`WRITE_FLAG
(
pcSli˚
->
	`gëRefPicLi°Modifiˇti⁄
()->
	`gëRefPicLi°Modifiˇti⁄FœgL0
() ? 1 : 0, "ref_pic_list_modification_flag_l0" );

974 i‡(
pcSli˚
->
	`gëRefPicLi°Modifiˇti⁄
()->
	`gëRefPicLi°Modifiˇti⁄FœgL0
())

976 
I¡
 
numRpsCuºTempLi°0
 = 
pcSli˚
->
	`gëNumRpsCuºTempLi°
();

977 i‡(
numRpsCuºTempLi°0
 > 1)

979 
I¡
 
Àngth
 = 1;

980 
numRpsCuºTempLi°0
 --;

981  
numRpsCuºTempLi°0
 >>= 1)

983 
Àngth
 ++;

985 
I¡
 
i
 = 0; i < 
pcSli˚
->
	`gëNumRefIdx
–
REF_PIC_LIST_0
 ); i++)

987 
	`WRITE_CODE
–
ªfPicLi°Modifiˇti⁄
->
	`gëRefPicSëIdxL0
(
i
), 
Àngth
, "list_entry_l0");

992 if(
pcSli˚
->
	`isI¡îB
())

994 
	`WRITE_FLAG
(
pcSli˚
->
	`gëRefPicLi°Modifiˇti⁄
()->
	`gëRefPicLi°Modifiˇti⁄FœgL1
() ? 1 : 0, "ref_pic_list_modification_flag_l1" );

995 i‡(
pcSli˚
->
	`gëRefPicLi°Modifiˇti⁄
()->
	`gëRefPicLi°Modifiˇti⁄FœgL1
())

997 
I¡
 
numRpsCuºTempLi°1
 = 
pcSli˚
->
	`gëNumRpsCuºTempLi°
();

998 i‡–
numRpsCuºTempLi°1
 > 1 )

1000 
I¡
 
Àngth
 = 1;

1001 
numRpsCuºTempLi°1
 --;

1002  
numRpsCuºTempLi°1
 >>= 1)

1004 
Àngth
 ++;

1006 
I¡
 
i
 = 0; i < 
pcSli˚
->
	`gëNumRefIdx
–
REF_PIC_LIST_1
 ); i++)

1008 
	`WRITE_CODE
–
ªfPicLi°Modifiˇti⁄
->
	`gëRefPicSëIdxL1
(
i
), 
Àngth
, "list_entry_l1");

1015 i‡(
pcSli˚
->
	`isI¡îB
())

1017 
	`WRITE_FLAG
–
pcSli˚
->
	`gëMvdL1ZîoFœg
() ? 1 : 0, "mvd_l1_zero_flag");

1020 if(!
pcSli˚
->
	`isI¡ø
())

1022 i‡(!
pcSli˚
->
	`isI¡ø
(Ë&&ÖcSli˚->
	`gëPPS
()->
	`gëCabacInôPª£¡Fœg
())

1024 #i‡
MCTS_EXTRACTION


1025 
Boﬁ
 
ícCabacInôFœg
 = 
pcSli˚
->
	`gëCabacInôFœg
();

1027 
Sli˚Ty≥
 
¶i˚Ty≥
 = 
pcSli˚
->
	`gëSli˚Ty≥
();

1028 
Sli˚Ty≥
 
ícCABACTabÀIdx
 = 
pcSli˚
->
	`gëEncCABACTabÀIdx
();

1029 
Boﬁ
 
ícCabacInôFœg
 = (
¶i˚Ty≥
!=
ícCABACTabÀIdx
 &&ÉncCABACTabÀIdx!=
I_SLICE
Ë? 
åue
 : 
Ál£
;

1030 
pcSli˚
->
	`£tCabacInôFœg
–
ícCabacInôFœg
 );

1033 
	`WRITE_FLAG
–
ícCabacInôFœg
?1:0, "cabac_init_flag" );

1037 i‡–
pcSli˚
->
	`gëE«bÀTMVPFœg
() )

1039 i‡–
pcSli˚
->
	`gëSli˚Ty≥
(Ë=
B_SLICE
 )

1041 
	`WRITE_FLAG
–
pcSli˚
->
	`gëCﬁFromL0Fœg
(), "collocated_from_l0_flag" );

1044 i‡–
pcSli˚
->
	`gëSli˚Ty≥
(Ë!
I_SLICE
 &&

1045 ((
pcSli˚
->
	`gëCﬁFromL0Fœg
()==1 &&ÖcSli˚->
	`gëNumRefIdx
(
REF_PIC_LIST_0
)>1)||

1046 (
pcSli˚
->
	`gëCﬁFromL0Fœg
()==0 &&ÖcSli˚->
	`gëNumRefIdx
(
REF_PIC_LIST_1
)>1)))

1048 
	`WRITE_UVLC
–
pcSli˚
->
	`gëCﬁRefIdx
(), "collocated_ref_idx" );

1051 i‡–(
pcSli˚
->
	`gëPPS
()->
	`gëU£WP
(Ë&&ÖcSli˚->
	`gëSli˚Ty≥
()==
P_SLICE
Ë|| (pcSli˚->gëPPS()->
	`gëWPBiPªd
(Ë&&ÖcSli˚->gëSli˚Ty≥()==
B_SLICE
) )

1053 
	`xCodePªdWeightTabÀ
–
pcSli˚
 );

1055 
	`as£π
(
pcSli˚
->
	`gëMaxNumMîgeC™d
()<=
MRG_MAX_NUM_CANDS
);

1056 i‡(!
pcSli˚
->
	`isI¡ø
())

1058 
	`WRITE_UVLC
(
MRG_MAX_NUM_CANDS
 - 
pcSli˚
->
	`gëMaxNumMîgeC™d
(), "five_minus_max_num_merge_cand");

1060 
I¡
 
iCode
 = 
pcSli˚
->
	`gëSli˚Qp
(Ë- (ÖcSli˚->
	`gëPPS
()->
	`gëPicInôQPMöus26
() + 26 );

1061 
	`WRITE_SVLC
–
iCode
, "slice_qp_delta" );

1062 i‡(
pcSli˚
->
	`gëPPS
()->
	`gëSli˚ChromaQpFœg
())

1064 i‡(
numbîVÆidComp⁄íts
 > 
COMPONENT_Cb
)

1066 
	`WRITE_SVLC
–
pcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cb
), "slice_cb_qp_offset" );

1068 i‡(
numbîVÆidComp⁄íts
 > 
COMPONENT_Cr
)

1070 
	`WRITE_SVLC
–
pcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cr
), "slice_cr_qp_offset" );

1072 
	`as£π
(
numbîVÆidComp⁄íts
 <
COMPONENT_Cr
+1);

1075 i‡(
pcSli˚
->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°E«bÀdFœg
())

1077 
	`WRITE_FLAG
(
pcSli˚
->
	`gëU£ChromaQpAdj
(), "cu_chroma_qp_offset_enabled_flag");

1080 i‡(
pcSli˚
->
	`gëPPS
()->
	`gëDeblockögFûãrC⁄åﬁPª£¡Fœg
())

1082 i‡(
pcSli˚
->
	`gëPPS
()->
	`gëDeblockögFûãrOvîrideE«bÀdFœg
() )

1084 
	`WRITE_FLAG
(
pcSli˚
->
	`gëDeblockögFûãrOvîrideFœg
(), "deblocking_filter_override_flag");

1086 i‡(
pcSli˚
->
	`gëDeblockögFûãrOvîrideFœg
())

1088 
	`WRITE_FLAG
(
pcSli˚
->
	`gëDeblockögFûãrDißbÀ
(), "slice_deblocking_filter_disabled_flag");

1089 if(!
pcSli˚
->
	`gëDeblockögFûãrDißbÀ
())

1091 
	`WRITE_SVLC
 (
pcSli˚
->
	`gëDeblockögFûãrBëaOff£tDiv2
(), "slice_beta_offset_div2");

1092 
	`WRITE_SVLC
 (
pcSli˚
->
	`gëDeblockögFûãrTcOff£tDiv2
(), "slice_tc_offset_div2");

1097 
Boﬁ
 
isSAOE«bÀd
 = 
pcSli˚
->
	`gëSPS
()->
	`gëU£SAO
(Ë&& (pcSli˚->
	`gëSaoE«bÀdFœg
(
CHANNEL_TYPE_LUMA
Ë|| (
chromaE«bÀd
 &&ÖcSli˚->gëSaoE«bÀdFœg(
CHANNEL_TYPE_CHROMA
)));

1098 
Boﬁ
 
isDBFE«bÀd
 = (!
pcSli˚
->
	`gëDeblockögFûãrDißbÀ
());

1100 if(
pcSli˚
->
	`gëPPS
()->
	`gëLo›FûãrA¸ossSli˚sE«bÀdFœg
(Ë&& ( 
isSAOE«bÀd
 || 
isDBFE«bÀd
 ))

1102 
	`WRITE_FLAG
(
pcSli˚
->
	`gëLFCrossSli˚Bound¨yFœg
()?1:0, "slice_loop_filter_across_slices_enabled_flag");

1105 if(
pcSli˚
->
	`gëPPS
()->
	`gëSli˚HódîExãnsi⁄Pª£¡Fœg
())

1107 
	`WRITE_UVLC
(0,"slice_segment_header_extension_length");

1109 
	}
}

1111 
Void
 
	gTEncCavlc
::
	$codePTL
–c⁄° 
TComPTL
* 
pcPTL
, 
Boﬁ
 
¥ofûePª£¡Fœg
, 
I¡
 
maxNumSubLayîsMöus1
)

1113 if(
¥ofûePª£¡Fœg
)

1115 
	`codeProfûeTõr
(
pcPTL
->
	`gëGíîÆPTL
(), 
Ál£
);

1117 
	`WRITE_CODE
–
	`I¡
(
pcPTL
->
	`gëGíîÆPTL
()->
	`gëLevñIdc
()), 8, "general_level_idc" );

1119 
I¡
 
i
 = 0; i < 
maxNumSubLayîsMöus1
; i++)

1121 
	`WRITE_FLAG
–
pcPTL
->
	`gëSubLayîProfûePª£¡Fœg
(
i
), "sub_layer_profile_present_flag[i]" );

1122 
	`WRITE_FLAG
–
pcPTL
->
	`gëSubLayîLevñPª£¡Fœg
(
i
), "sub_layer_level_present_flag[i]" );

1125 i‡(
maxNumSubLayîsMöus1
 > 0)

1127 
I¡
 
i
 = 
maxNumSubLayîsMöus1
; i < 8; i++)

1129 
	`WRITE_CODE
(0, 2, "reserved_zero_2bits");

1133 
I¡
 
i
 = 0; i < 
maxNumSubLayîsMöus1
; i++)

1135 if–
pcPTL
->
	`gëSubLayîProfûePª£¡Fœg
(
i
) )

1137 
	`codeProfûeTõr
(
pcPTL
->
	`gëSubLayîPTL
(
i
), 
åue
);

1139 if–
pcPTL
->
	`gëSubLayîLevñPª£¡Fœg
(
i
) )

1141 
	`WRITE_CODE
–
	`I¡
(
pcPTL
->
	`gëSubLayîPTL
(
i
)->
	`gëLevñIdc
()), 8, "sub_layer_level_idc[i]" );

1144 
	}
}

1146 #i‡
ENC_DEC_TRACE
 || 
RExt__DECODER_DEBUG_BIT_STATISTICS


1147 
Void
 
	gTEncCavlc
::
	$codeProfûeTõr
–c⁄° 
ProfûeTõrLevñ
* 
±l
, c⁄° 
Boﬁ
 
bIsSubLayî
 )

1148 
	#PTL_TRACE_TEXT
(
txt
Ë
bIsSubLayî
?("sub_œyî_"ÅxtË: ("gíîÆ_"Åxt)

	)

1150 
Void
 
TEncCavlc
::
	$codeProfûeTõr
–c⁄° 
ProfûeTõrLevñ
* 
±l
, c⁄° 
Boﬁ
 )

1151 
	#PTL_TRACE_TEXT
(
txt
Ë
	)
txt

1154 
	`WRITE_CODE
–
±l
->
	`gëProfûeS∑˚
(), 2 , 
	`PTL_TRACE_TEXT
("profile_space" ));

1155 
	`WRITE_FLAG
–
±l
->
	`gëTõrFœg
()==
Levñ
::
HIGH
, 
	`PTL_TRACE_TEXT
("tier_flag" ));

1156 
	`WRITE_CODE
–
	`I¡
(
±l
->
	`gëProfûeIdc
()), 5 , 
	`PTL_TRACE_TEXT
("profile_idc" ));

1157 
I¡
 
j
 = 0; j < 32; j++)

1159 
	`WRITE_FLAG
–
±l
->
	`gëProfûeCom∑tibûôyFœg
(
j
), 
	`PTL_TRACE_TEXT
("profile_compatibility_flag[][j]" ));

1162 
	`WRITE_FLAG
(
±l
->
	`gëProgªssiveSour˚Fœg
(), 
	`PTL_TRACE_TEXT
("progressive_source_flag" ));

1163 
	`WRITE_FLAG
(
±l
->
	`gëI¡îœ˚dSour˚Fœg
(), 
	`PTL_TRACE_TEXT
("interlaced_source_flag" ));

1164 
	`WRITE_FLAG
(
±l
->
	`gëN⁄PackedC⁄°øötFœg
(), 
	`PTL_TRACE_TEXT
("non_packed_constraint_flag" ));

1165 
	`WRITE_FLAG
(
±l
->
	`gëFømeO∆yC⁄°øötFœg
(), 
	`PTL_TRACE_TEXT
("frame_only_constraint_flag" ));

1167 i‡(
±l
->
	`gëProfûeIdc
(Ë=
Profûe
::
MAINREXT
 ||Öé->gëProfûeIdc(Ë=Profûe::
HIGHTHROUGHPUTREXT
 )

1169 c⁄° 
UI¡
 
bôDïthC⁄°øöt
=
±l
->
	`gëBôDïthC⁄°øöt
();

1170 
	`WRITE_FLAG
(
bôDïthC⁄°øöt
<=12, 
	`PTL_TRACE_TEXT
("max_12bit_constraint_flag" ));

1171 
	`WRITE_FLAG
(
bôDïthC⁄°øöt
<=10, 
	`PTL_TRACE_TEXT
("max_10bit_constraint_flag" ));

1172 
	`WRITE_FLAG
(
bôDïthC⁄°øöt
<8, 
	`PTL_TRACE_TEXT
("max_8bit_constraint_flag" ));

1173 c⁄° 
ChromaF‹m©
 
chromaFmtC⁄°øöt
=
±l
->
	`gëChromaF‹m©C⁄°øöt
();

1174 
	`WRITE_FLAG
(
chromaFmtC⁄°øöt
==
CHROMA_422
||chromaFmtC⁄°øöt==
CHROMA_420
||chromaFmtC⁄°øöt==
CHROMA_400
, 
	`PTL_TRACE_TEXT
("max_422chroma_constraint_flag" ));

1175 
	`WRITE_FLAG
(
chromaFmtC⁄°øöt
==
CHROMA_420
||chromaFmtC⁄°øöt==
CHROMA_400
, 
	`PTL_TRACE_TEXT
("max_420chroma_constraint_flag" ));

1176 
	`WRITE_FLAG
(
chromaFmtC⁄°øöt
==
CHROMA_400
, 
	`PTL_TRACE_TEXT
("max_monochrome_constraint_flag"));

1177 
	`WRITE_FLAG
(
±l
->
	`gëI¡øC⁄°øötFœg
(), 
	`PTL_TRACE_TEXT
("intra_constraint_flag" ));

1178 
	`WRITE_FLAG
(
±l
->
	`gëO√Pi˘uªO∆yC⁄°øötFœg
(), 
	`PTL_TRACE_TEXT
("one_picture_only_constraint_flag"));

1179 
	`WRITE_FLAG
(
±l
->
	`gëLowîBôR©eC⁄°øötFœg
(), 
	`PTL_TRACE_TEXT
("lower_bit_rate_constraint_flag" ));

1180 
	`WRITE_CODE
(0 , 16, 
	`PTL_TRACE_TEXT
("reserved_zero_34bits[0..15]" ));

1181 
	`WRITE_CODE
(0 , 16, 
	`PTL_TRACE_TEXT
("reserved_zero_34bits[16..31]" ));

1182 
	`WRITE_CODE
(0 , 2, 
	`PTL_TRACE_TEXT
("reserved_zero_34bits[32..33]" ));

1184 i‡(
±l
->
	`gëProfûeIdc
(Ë=
Profûe
::
MAIN10
)

1186 
	`WRITE_CODE
(0x00 , 7, 
	`PTL_TRACE_TEXT
("reserved_zero_7bits" ));

1187 
	`WRITE_FLAG
(
±l
->
	`gëO√Pi˘uªO∆yC⁄°øötFœg
(), 
	`PTL_TRACE_TEXT
("one_picture_only_constraint_flag"));

1188 
	`WRITE_CODE
(0x0000 , 16, 
	`PTL_TRACE_TEXT
("reserved_zero_35bits[0..15]" ));

1189 
	`WRITE_CODE
(0x0000 , 16, 
	`PTL_TRACE_TEXT
("reserved_zero_35bits[16..31]" ));

1190 
	`WRITE_CODE
(0x0 , 3, 
	`PTL_TRACE_TEXT
("reserved_zero_35bits[32..34]" ));

1194 
	`WRITE_CODE
(0x0000 , 16, 
	`PTL_TRACE_TEXT
("reserved_zero_43bits[0..15]" ));

1195 
	`WRITE_CODE
(0x0000 , 16, 
	`PTL_TRACE_TEXT
("reserved_zero_43bits[16..31]" ));

1196 
	`WRITE_CODE
(0x000 , 11, 
	`PTL_TRACE_TEXT
("reserved_zero_43bits[32..42]" ));

1198 
	`WRITE_FLAG
(
Ál£
, 
	`PTL_TRACE_TEXT
("inbld_flag" ));

1199 #unde‡
PTL_TRACE_TEXT


1200 
	}
}

1207 
Void
 
	gTEncCavlc
::
	$codeTûesWPPE¡ryPoöt
–
TComSli˚
* 
pSli˚
 )

1209 i‡(!
pSli˚
->
	`gëPPS
()->
	`gëTûesE«bÀdFœg
(Ë&& !pSli˚->gëPPS()->
	`gëE¡r›yCodögSyncE«bÀdFœg
())

1213 
UI¡
 
maxOff£t
 = 0;

1214 
I¡
 
idx
=0; idx<
pSli˚
->
	`gëNumbîOfSub°ªamSizes
(); idx++)

1216 
UI¡
 
off£t
=
pSli˚
->
	`gëSub°ªamSize
(
idx
);

1217 i‡–
off£t
 > 
maxOff£t
 )

1219 
maxOff£t
 = 
off£t
;

1224 
UI¡
 
off£tLíMöus1
 = 0;

1225 
maxOff£t
 >(1u << (
off£tLíMöus1
 + 1)))

1227 
off£tLíMöus1
++;

1228 
	`as£π
(
off£tLíMöus1
 + 1 < 32);

1231 
	`WRITE_UVLC
(
pSli˚
->
	`gëNumbîOfSub°ªamSizes
(), "num_entry_point_offsets");

1232 i‡(
pSli˚
->
	`gëNumbîOfSub°ªamSizes
()>0)

1234 
	`WRITE_UVLC
(
off£tLíMöus1
, "offset_len_minus1");

1236 
UI¡
 
idx
=0; idx<
pSli˚
->
	`gëNumbîOfSub°ªamSizes
(); idx++)

1238 
	`WRITE_CODE
(
pSli˚
->
	`gëSub°ªamSize
(
idx
)-1, 
off£tLíMöus1
+1, "entry_point_offset_minus1");

1241 
	}
}

1243 
Void
 
	gTEncCavlc
::
	$codeTîmö©ögBô
 ( 
UI¡
 )

1245 
	}
}

1247 
Void
 
TEncCavlc
::
	$codeSli˚Föish
 ()

1249 
	}
}

1251 
Void
 
TEncCavlc
::
	$codeMVPIdx
 ( 
TComD©aCU
* , 
UI¡
 , 
RefPicLi°
 )

1253 
	`as£π
(0);

1254 
	}
}

1256 
Void
 
	gTEncCavlc
::
	$codeP¨tSize
–
TComD©aCU
* , 
UI¡
 , UInt )

1258 
	`as£π
(0);

1259 
	}
}

1261 
Void
 
	gTEncCavlc
::
	$codePªdMode
–
TComD©aCU
* , 
UI¡
 )

1263 
	`as£π
(0);

1264 
	}
}

1266 
Void
 
	gTEncCavlc
::
	$codeMîgeFœg
 ( 
TComD©aCU
* , 
UI¡
 )

1268 
	`as£π
(0);

1269 
	}
}

1271 
Void
 
	gTEncCavlc
::
	$codeMîgeIndex
 ( 
TComD©aCU
* , 
UI¡
 )

1273 
	`as£π
(0);

1274 
	}
}

1276 
Void
 
	gTEncCavlc
::
	$codeI¡îModeFœg
–
TComD©aCU
* , 
UI¡
 , UInt , UInt )

1278 
	`as£π
(0);

1279 
	}
}

1281 
Void
 
	gTEncCavlc
::
	$codeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* , 
UI¡
 )

1283 
	`as£π
(0);

1284 
	}
}

1286 
Void
 
	gTEncCavlc
::
	$codeSkùFœg
–
TComD©aCU
* , 
UI¡
 )

1288 
	`as£π
(0);

1289 
	}
}

1291 
Void
 
	gTEncCavlc
::
	$codeS∂ôFœg
 ( 
TComD©aCU
* , 
UI¡
 , UInt )

1293 
	`as£π
(0);

1294 
	}
}

1296 
Void
 
	gTEncCavlc
::
	$codeTønsf‹mSubdivFœg
–
UI¡
 , UInt )

1298 
	`as£π
(0);

1299 
	}
}

1301 
Void
 
	gTEncCavlc
::
	$codeQtCbf
–
TComTU
& , c⁄° 
Comp⁄ítID
 , c⁄° 
Boﬁ
 )

1303 
	`as£π
(0);

1304 
	}
}

1306 
Void
 
	gTEncCavlc
::
	$codeQtRoŸCbf
–
TComD©aCU
* , 
UI¡
 )

1308 
	`as£π
(0);

1309 
	}
}

1311 
Void
 
	gTEncCavlc
::
	$codeQtCbfZîo
–
TComTU
& , c⁄° 
Ch™√lTy≥
 )

1313 
	`as£π
(0);

1314 
	}
}

1315 
Void
 
	gTEncCavlc
::
	$codeQtRoŸCbfZîo
( )

1317 
	`as£π
(0);

1318 
	}
}

1320 
Void
 
	gTEncCavlc
::
	$codeTønsf‹mSkùFœgs
 (
TComTU
& , 
Comp⁄ítID
 )

1322 
	`as£π
(0);

1323 
	}
}

1330 
Void
 
	gTEncCavlc
::
	$codeIPCMInfo
–
TComD©aCU
* , 
UI¡
 )

1332 
	`as£π
(0);

1333 
	}
}

1335 
Void
 
	gTEncCavlc
::
	$codeI¡øDúLumaAng
–
TComD©aCU
* , 
UI¡
 , 
Boﬁ
 )

1337 
	`as£π
(0);

1338 
	}
}

1340 
Void
 
	gTEncCavlc
::
	$codeI¡øDúChroma
–
TComD©aCU
* , 
UI¡
 )

1342 
	`as£π
(0);

1343 
	}
}

1345 
Void
 
	gTEncCavlc
::
	$codeI¡îDú
–
TComD©aCU
* , 
UI¡
 )

1347 
	`as£π
(0);

1348 
	}
}

1350 
Void
 
	gTEncCavlc
::
	$codeRefFrmIdx
–
TComD©aCU
* , 
UI¡
 , 
RefPicLi°
 )

1352 
	`as£π
(0);

1353 
	}
}

1355 
Void
 
	gTEncCavlc
::
	$codeMvd
–
TComD©aCU
* , 
UI¡
 , 
RefPicLi°
 )

1357 
	`as£π
(0);

1358 
	}
}

1360 
Void
 
	gTEncCavlc
::
	$codeCrossComp⁄ítPªdi˘i⁄
–
TComTU
& , 
Comp⁄ítID
 )

1362 
	`as£π
(0);

1363 
	}
}

1365 
Void
 
	gTEncCavlc
::
	$codeDñèQP
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

1367 
I¡
 
iDQp
 = 
pcCU
->
	`gëQP
–
uiAbsP¨tIdx
 ) -ÖcCU->
	`gëRefQP
( uiAbsPartIdx );

1369 
I¡
 
qpBdOff£tY
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
);

1370 
iDQp
 = (iDQ∞+ 78 + 
qpBdOff£tY
 + (qpBdOffsetY/2)) % (52 + qpBdOffsetY) - 26 - (qpBdOffsetY/2);

1372 
	`xWrôeSvlc
–
iDQp
 );

1375 
	}
}

1377 
Void
 
	gTEncCavlc
::
	$codeChromaQpAdju°mít
–
TComD©aCU
* , 
UI¡
 )

1379 
	`as£π
(0);

1380 
	}
}

1382 
Void
 
	gTEncCavlc
::
	$codeC€ffNxN
 ( 
TComTU
& , 
TC€ff
* , c⁄° 
Comp⁄ítID
 )

1384 
	`as£π
(0);

1385 
	}
}

1387 
Void
 
	gTEncCavlc
::
	$e°Bô
–
e°BôsSbacSåu˘
* , 
I¡
 , I¡ , 
Ch™√lTy≥
 , 
COEFF_SCAN_TYPE
 )

1391 
	}
}

1398 
Void
 
	gTEncCavlc
::
	$xCodePªdWeightTabÀ
–
TComSli˚
* 
pcSli˚
 )

1400 
WPSˇlögP¨am
 *
wp
;

1401 c⁄° 
ChromaF‹m©
 
f‹m©
 = 
pcSli˚
->
	`gëPic
()->
	`gëChromaF‹m©
();

1402 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
f‹m©
);

1403 c⁄° 
Boﬁ
 
bChroma
 = 
	`isChromaE«bÀd
(
f‹m©
);

1404 c⁄° 
I¡
 
iNbRef
 = (
pcSli˚
->
	`gëSli˚Ty≥
(Ë=
B_SLICE
 ) ? (2) : (1);

1405 
Boﬁ
 
bDíomCoded
 = 
Ál£
;

1406 
UI¡
 
uiTŸÆSig«ŒedWeightFœgs
 = 0;

1408 i‡–(
pcSli˚
->
	`gëSli˚Ty≥
()==
P_SLICE
 &&ÖcSli˚->
	`gëPPS
()->
	`gëU£WP
()Ë|| (pcSli˚->gëSli˚Ty≥()==
B_SLICE
 &&ÖcSli˚->gëPPS()->
	`gëWPBiPªd
()) )

1410  
I¡
 
iNumRef
=0 ; iNumRef<
iNbRef
 ; iNumRef++ )

1412 
RefPicLi°
 
eRefPicLi°
 = ( 
iNumRef
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

1416  
I¡
 
iRefIdx
=0 ; iRefIdx<
pcSli˚
->
	`gëNumRefIdx
(
eRefPicLi°
) ; iRefIdx++ )

1418 
pcSli˚
->
	`gëWpSˇlög
(
eRefPicLi°
, 
iRefIdx
, 
wp
);

1419 i‡–!
bDíomCoded
 )

1421 
I¡
 
iDñèDíom
;

1422 
	`WRITE_UVLC
–
wp
[
COMPONENT_Y
].
uiLog2WeightDíom
, "luma_log2_weight_denom" );

1424 if–
bChroma
 )

1426 
	`as£π
(
wp
[
COMPONENT_Cb
].
uiLog2WeightDíom
 =wp[
COMPONENT_Cr
].uiLog2WeightDenom);

1427 
iDñèDíom
 = (
wp
[
COMPONENT_Cb
].
uiLog2WeightDíom
 - wp[
COMPONENT_Y
].uiLog2WeightDenom);

1428 
	`WRITE_SVLC
–
iDñèDíom
, "delta_chroma_log2_weight_denom" );

1430 
bDíomCoded
 = 
åue
;

1432 
	`WRITE_FLAG
–
wp
[
COMPONENT_Y
].
bPª£¡Fœg
, 
iNumRef
==0?"luma_weight_l0_flag[i]":"luma_weight_l1_flag[i]" );

1433 
uiTŸÆSig«ŒedWeightFœgs
 +
wp
[
COMPONENT_Y
].
bPª£¡Fœg
;

1435 i‡(
bChroma
)

1437  
I¡
 
iRefIdx
=0 ; iRefIdx<
pcSli˚
->
	`gëNumRefIdx
(
eRefPicLi°
) ; iRefIdx++ )

1439 
pcSli˚
->
	`gëWpSˇlög
(
eRefPicLi°
, 
iRefIdx
, 
wp
);

1440 
	`as£π
(
wp
[
COMPONENT_Cb
].
bPª£¡Fœg
 =wp[
COMPONENT_Cr
].bPresentFlag);

1441 
	`WRITE_FLAG
–
wp
[
COMPONENT_Cb
].
bPª£¡Fœg
, 
iNumRef
==0?"chroma_weight_l0_flag[i]":"chroma_weight_l1_flag[i]" );

1442 
uiTŸÆSig«ŒedWeightFœgs
 +2*
wp
[
COMPONENT_Cb
].
bPª£¡Fœg
;

1446  
I¡
 
iRefIdx
=0 ; iRefIdx<
pcSli˚
->
	`gëNumRefIdx
(
eRefPicLi°
) ; iRefIdx++ )

1448 
pcSli˚
->
	`gëWpSˇlög
(
eRefPicLi°
, 
iRefIdx
, 
wp
);

1449 i‡–
wp
[
COMPONENT_Y
].
bPª£¡Fœg
 )

1451 
I¡
 
iDñèWeight
 = (
wp
[
COMPONENT_Y
].
iWeight
 - (1<<wp[COMPONENT_Y].
uiLog2WeightDíom
));

1452 
	`WRITE_SVLC
–
iDñèWeight
, 
iNumRef
==0?"delta_luma_weight_l0[i]":"delta_luma_weight_l1[i]" );

1453 
	`WRITE_SVLC
–
wp
[
COMPONENT_Y
].
iOff£t
, 
iNumRef
==0?"luma_offset_l0[i]":"luma_offset_l1[i]" );

1456 i‡–
bChroma
 )

1458 i‡–
wp
[
COMPONENT_Cb
].
bPª£¡Fœg
 )

1460  
I¡
 
j
 = 
COMPONENT_Cb
 ; j < 
numbîVÆidComp⁄íts
 ; j++ )

1462 
	`as£π
(
wp
[
COMPONENT_Cb
].
uiLog2WeightDíom
 =wp[
COMPONENT_Cr
].uiLog2WeightDenom);

1463 
I¡
 
iDñèWeight
 = (
wp
[
j
].
iWeight
 - (1<<wp[
COMPONENT_Cb
].
uiLog2WeightDíom
));

1464 
	`WRITE_SVLC
–
iDñèWeight
, 
iNumRef
==0?"delta_chroma_weight_l0[i]":"delta_chroma_weight_l1[i]" );

1466 
I¡
 
ønge
=
pcSli˚
->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
(Ë? (1<<pcSli˚->gëSPS()->
	`gëBôDïth
(
CHANNEL_TYPE_CHROMA
))/2 : 128;

1467 
I¡
 
¥ed
 = ( 
ønge
 - ( (Ñ™ge*
wp
[
j
].
iWeight
)>>(wp[j].
uiLog2WeightDíom
) ) );

1468 
I¡
 
iDñèChroma
 = (
wp
[
j
].
iOff£t
 - 
¥ed
);

1469 
	`WRITE_SVLC
–
iDñèChroma
, 
iNumRef
==0?"delta_chroma_offset_l0[i]":"delta_chroma_offset_l1[i]" );

1475 
	`as£π
(
uiTŸÆSig«ŒedWeightFœgs
<=24);

1477 
	}
}

1482 
Void
 
	gTEncCavlc
::
	$codeSˇlögLi°
–c⁄° 
TComSˇlögLi°
 &
sˇlögLi°
 )

1485 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

1487 c⁄° 
I¡
 
¥edLi°Sãp
 = (
sizeId
 =
SCALING_LIST_32x32
? (
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
) : 1);

1489 
UI¡
 
li°Id
 = 0;Üi°Id < 
SCALING_LIST_NUM
;Üi°Id+=
¥edLi°Sãp
)

1491 
Boﬁ
 
sˇlögLi°PªdModeFœg
 = 
sˇlögLi°
.
	`gëSˇlögLi°PªdModeFœg
(
sizeId
, 
li°Id
);

1492 
	`WRITE_FLAG
–
sˇlögLi°PªdModeFœg
, "scaling_list_pred_mode_flag" );

1493 if(!
sˇlögLi°PªdModeFœg
)

1495 i‡(
sizeId
 =
SCALING_LIST_32x32
)

1498 
	`WRITE_UVLC
–((
I¡
)
li°Id
 - (I¡)
sˇlögLi°
.
	`gëRefM©rixId
 (
sizeId
,li°Id)Ë/ (
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
), "scaling_list_pred_matrix_id_delta");

1502 
	`WRITE_UVLC
–(
I¡
)
li°Id
 - (I¡)
sˇlögLi°
.
	`gëRefM©rixId
 (
sizeId
,listId), "scaling_list_pred_matrix_id_delta");

1507 
	`xCodeSˇlögLi°
(&
sˇlögLi°
, 
sizeId
, 
li°Id
);

1512 
	}
}

1518 
Void
 
	gTEncCavlc
::
	$xCodeSˇlögLi°
(c⁄° 
TComSˇlögLi°
* 
sˇlögLi°
, 
UI¡
 
sizeId
, UI¡ 
li°Id
)

1520 
I¡
 
c€fNum
 = 
	`mö
(
MAX_MATRIX_COEF_NUM
,(I¡)
g_sˇlögLi°Size
[
sizeId
]);

1521 
UI¡
* 
sˇn
 = 
g_sˇnOrdî
[
SCAN_UNGROUPED
][
SCAN_DIAG
][
sizeId
==0 ? 2 : 3][sizeId==0 ? 2 : 3];

1522 
I¡
 
√xtC€f
 = 
SCALING_LIST_START_VALUE
;

1523 
I¡
 
d©a
;

1524 c⁄° 
I¡
 *
§c
 = 
sˇlögLi°
->
	`gëSˇlögLi°Addªss
(
sizeId
, 
li°Id
);

1525 if–
sizeId
 > 
SCALING_LIST_8x8
 )

1527 
	`WRITE_SVLC
–
sˇlögLi°
->
	`gëSˇlögLi°DC
(
sizeId
,
li°Id
) - 8, "scaling_list_dc_coef_minus8");

1528 
√xtC€f
 = 
sˇlögLi°
->
	`gëSˇlögLi°DC
(
sizeId
,
li°Id
);

1530 
I¡
 
i
=0;i<
c€fNum
;i++)

1532 
d©a
 = 
§c
[
sˇn
[
i
]] - 
√xtC€f
;

1533 
√xtC€f
 = 
§c
[
sˇn
[
i
]];

1534 if(
d©a
 > 127)

1536 
d©a
 = data - 256;

1538 if(
d©a
 < -128)

1540 
d©a
 = data + 256;

1543 
	`WRITE_SVLC
–
d©a
, "scaling_list_delta_coef");

1545 
	}
}

1547 
Boﬁ
 
	gTEncCavlc
::
	$födM©chögLTRP
 ( 
TComSli˚
* 
pcSli˚
, 
UI¡
 *
…ΩsIndex
, 
I¡
 
…ΩPOC
, 
Boﬁ
 
u£dFœg
 )

1550 
I¡
 
lsb
 = 
…ΩPOC
 & ((1<<
pcSli˚
->
	`gëSPS
()->
	`gëBôsF‹POC
())-1);

1551 
I¡
 
k
 = 0; k < 
pcSli˚
->
	`gëSPS
()->
	`gëNumL⁄gTîmRefPicSPS
(); k++)

1553 i‡–(
lsb
 =
pcSli˚
->
	`gëSPS
()->
	`gëLtRefPicPocLsbSps
(
k
)Ë&& (
u£dFœg
 =pcSli˚->gëSPS()->
	`gëU£dByCuºPicLtSPSFœg
(k)) )

1555 *
…ΩsIndex
 = 
k
;

1556  
åue
;

1559  
Ál£
;

1560 
	}
}

1562 
Void
 
	gTEncCavlc
::
	$codeEx∂icôRdpcmMode
–
TComTU
& , c⁄° 
Comp⁄ítID
 )

1564 
	`as£π
(0);

1565 
	}
}

	@TLibEncoder/TEncCavlc.h

38 #i‚de‡
__TENCCAVLC__


39 
	#__TENCCAVLC__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/Comm⁄Def.h
"

46 
	~"TLibComm⁄/TComBôSåóm.h
"

47 
	~"TLibComm⁄/TComRom.h
"

48 
	~"TEncE¡r›y.h
"

49 
	~"Sy¡axEÀmítWrôî.h
"

54 
˛ass
 
	gTEncT›
;

60 ˛as†
	cAUDWrôî
 : 
public
 
Sy¡axEÀmítWrôî


62 
public
:

63 
	$AUDWrôî
() {};

64 
vútuÆ
 ~
	$AUDWrôî
(Ë{
	}
};

66 
Void
 
codeAUD
(
TComBôIf
& 
bs
, c⁄° 
I¡
 
pi˘uªTy≥
);

70 
˛ass
 
	gTEncCavlc
 : 
public
 
Sy¡axEÀmítWrôî
,Öubli¯
	gTEncE¡r›yIf


72 
	gpublic
:

73 
TEncCavlc
();

74 
	gvútuÆ
 ~
TEncCavlc
();

76 
	g¥Ÿe˘ed
:

77 
Void
 
codeSh‹tTîmRefPicSë
 ( c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
pcRPS
, 
Boﬁ
 
ˇŒedFromSli˚Hódî
, 
I¡
 
idx
 );

78 
Boﬁ
 
födM©chögLTRP
 ( 
TComSli˚
* 
pcSli˚
, 
UI¡
 *
…ΩsIndex
, 
I¡
 
…ΩPOC
, Boﬁ 
u£dFœg
 );

80 
	gpublic
:

82 
Void
 
ª£tE¡r›y
 (c⁄° 
TComSli˚
 *
pSli˚
);

83 
Sli˚Ty≥
 
dëîmöeCabacInôIdx
 (c⁄° 
TComSli˚
* ) { 
as£π
(0);  
	gI_SLICE
; };

85 
Void
 
£tBô°ªam
 ( 
TComBôIf
* 
p
 ) { 
	gm_pcBôIf
 =Ö; }

86 
Void
 
ª£tBôs
 (Ë{ 
	gm_pcBôIf
->resetBits(); }

87 
UI¡
 
gëNumbîOfWrôãnBôs
(Ë{  
	gm_pcBôIf
->getNumberOfWrittenBits(); }

88 
Void
 
codeVPS
 ( c⁄° 
TComVPS
* 
pcVPS
 );

89 
Void
 
codeVUI
 ( c⁄° 
TComVUI
 *
pcVUI
, c⁄° 
TComSPS
* 
pcSPS
 );

90 
Void
 
codeSPS
 ( c⁄° 
TComSPS
* 
pcSPS
 );

91 
Void
 
codePPS
 ( c⁄° 
TComPPS
* 
pcPPS
 );

92 
Void
 
codeSli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
 );

93 
Void
 
codePTL
 ( c⁄° 
TComPTL
* 
pcPTL
, 
Boﬁ
 
¥ofûePª£¡Fœg
, 
I¡
 
maxNumSubLayîsMöus1
);

94 
Void
 
codeProfûeTõr
 ( c⁄° 
ProfûeTõrLevñ
* 
±l
, c⁄° 
Boﬁ
 
bIsSubLayî
 );

95 
Void
 
codeHrdP¨amëîs
 ( c⁄° 
TComHRD
 *
hrd
, 
Boﬁ
 
comm⁄InfPª£¡Fœg
, 
UI¡
 
maxNumSubLayîsMöus1
 );

96 
Void
 
codeTûesWPPE¡ryPoöt
–
TComSli˚
* 
pSli˚
 );

97 
Void
 
codeTîmö©ögBô
 ( 
UI¡
 
uûsLa°
 );

98 
Void
 
codeSli˚Föish
 ();

100 
Void
 
codeMVPIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

101 
Void
 
codeSAOBlkP¨am
(
SAOBlkP¨am
& , c⁄° 
BôDïths
& , 
Boﬁ
* , Boﬁ , Boﬁ , Boﬁ = 
Ál£
){
¥ötf
("⁄ly suµ‹ãd i¿CABAC"); 
as£π
(0); 
exô
(-1);}

102 
Void
 
codeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

103 
Void
 
codeSkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

104 
Void
 
codeMîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

105 
Void
 
codeMîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

107 
Void
 
codeAlfCålFœg
 ( 
Comp⁄ítID
 , 
UI¡
 ) {
¥ötf
("NŸ suµ‹ãd\n"); 
as£π
(0);}

108 
Void
 
codeI¡îModeFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiEncMode
 );

109 
Void
 
codeS∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

111 
Void
 
codeP¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

112 
Void
 
codePªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

114 
Void
 
codeIPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

116 
Void
 
codeTønsf‹mSubdivFœg
–
UI¡
 
uiSymbﬁ
, UI¡ 
uiCtx
 );

117 
Void
 
codeQtCbf
 ( 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 );

118 
Void
 
codeQtRoŸCbf
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

119 
Void
 
codeQtCbfZîo
 ( 
TComTU
 &
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 );

120 
Void
 
codeQtRoŸCbfZîo
 ( );

121 
Void
 
codeI¡øDúLumaAng
–
TComD©aCU
* 
pcCU
, 
UI¡
 
absP¨tIdx
, 
Boﬁ
 
isMu…ùÀ
);

122 
Void
 
codeI¡øDúChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

123 
Void
 
codeI¡îDú
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

124 
Void
 
codeRefFrmIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

125 
Void
 
codeMvd
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

127 
Void
 
codeCrossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

129 
Void
 
codeDñèQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

130 
Void
 
codeChromaQpAdju°mít
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

132 
Void
 
codeC€ffNxN
 ( 
TComTU
 &
rTu
, 
TC€ff
* 
pcC€f
, c⁄° 
Comp⁄ítID
 
compID
 );

133 
Void
 
codeTønsf‹mSkùFœgs
 ( 
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
 );

135 
Void
 
e°Bô
 ( 
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
 );

137 
Void
 
xCodePªdWeightTabÀ
 ( 
TComSli˚
* 
pcSli˚
 );

139 
Void
 
codeSˇlögLi°
 ( c⁄° 
TComSˇlögLi°
 &
sˇlögLi°
 );

140 
Void
 
xCodeSˇlögLi°
 ( c⁄° 
TComSˇlögLi°
* 
sˇlögLi°
, 
UI¡
 
sizeId
, UI¡ 
li°Id
);

142 
Void
 
codeEx∂icôRdpcmMode
–
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
 );

	@TLibEncoder/TEncCfg.h

38 #i‚de‡
__TENCCFG__


39 
	#__TENCCFG__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/Comm⁄Def.h
"

46 
	~"TLibComm⁄/TComSli˚.h
"

47 
	~<as£π.h
>

49 
	sGOPE¡ry


51 
I¡
 
	mm_POC
;

52 
I¡
 
	mm_QPOff£t
;

53 
DoubÀ
 
	mm_QPOff£tModñOff£t
;

54 
DoubÀ
 
	mm_QPOff£tModñSˇÀ
;

55 
I¡
 
	mm_CbQPoff£t
;

56 
I¡
 
	mm_CrQPoff£t
;

57 
DoubÀ
 
	mm_QPFa˘‹
;

58 
I¡
 
	mm_tcOff£tDiv2
;

59 
I¡
 
	mm_bëaOff£tDiv2
;

60 
I¡
 
	mm_ãmp‹ÆId
;

61 
Boﬁ
 
	mm_ªfPic
;

62 
I¡
 
	mm_numRefPicsA˘ive
;

63 
SCh¨
 
	mm_¶i˚Ty≥
;

64 
I¡
 
	mm_numRefPics
;

65 
I¡
 
	mm_ª„ªn˚Pics
[
MAX_NUM_REF_PICS
];

66 
I¡
 
	mm_u£dByCuºPic
[
MAX_NUM_REF_PICS
];

67 
I¡
 
	mm_öãrRPSPªdi˘i⁄
;

68 
I¡
 
	mm_dñèRPS
;

69 
I¡
 
	mm_numRefIdc
;

70 
I¡
 
	mm_ªfIdc
[
MAX_NUM_REF_PICS
+1];

71 
Boﬁ
 
	mm_isEncoded
;

72 
GOPE¡ry
()

73 : 
m_POC
(-1)

74 , 
m_QPOff£t
(0)

75 , 
m_QPOff£tModñOff£t
(0)

76 , 
m_QPOff£tModñSˇÀ
(0)

77 , 
m_CbQPoff£t
(0)

78 , 
m_CrQPoff£t
(0)

79 , 
m_QPFa˘‹
(0)

80 , 
m_tcOff£tDiv2
(0)

81 , 
m_bëaOff£tDiv2
(0)

82 , 
m_ãmp‹ÆId
(0)

83 , 
m_ªfPic
(
Ál£
)

84 , 
m_numRefPicsA˘ive
(0)

85 , 
m_¶i˚Ty≥
('P')

86 , 
m_numRefPics
(0)

87 , 
m_öãrRPSPªdi˘i⁄
(
Ál£
)

88 , 
m_dñèRPS
(0)

89 , 
m_numRefIdc
(0)

90 , 
m_isEncoded
(
Ál£
)

92 ::
mem£t
–
m_ª„ªn˚Pics
, 0, (m_referencePics) );

93 ::
mem£t
–
m_u£dByCuºPic
, 0, (m_usedByCurrPic) );

94 ::
mem£t
–
m_ªfIdc
, 0, (m_refIdc) );

98 
	g°d
::
i°rög°ªam
 &
›î©‹
>>(
°d
::i°rög°ªam &
ö
, 
	gGOPE¡ry
 &
	gíåy
);

107 ˛as†
	cTEncCfg


109 
	mpublic
:

111 
	sTEncSEIK√eFun˘i⁄Inf‹m©i⁄


113 
	sK√ePoötPaú


115 
I¡
 
öputK√ePoöt
;

116 
I¡
 
	mouçutK√ePoöt
;

119 
I¡
 
	mm_k√eFun˘i⁄Id
;

120 
Boﬁ
 
	mm_k√eFun˘i⁄C™˚lFœg
;

121 
Boﬁ
 
	mm_k√eFun˘i⁄Pîsi°í˚Fœg
;

122 
I¡
 
	mm_öputDR™ge
;

123 
I¡
 
	mm_öputDi•Lumö™˚
;

124 
I¡
 
	mm_ouçutDR™ge
;

125 
I¡
 
	mm_ouçutDi•Lumö™˚
;

126 
	m°d
::
ve˘‹
<
K√ePoötPaú
> 
m_k√eSEIK√ePoötPaús
;

129 
	g¥Ÿe˘ed
:

131 
I¡
 
m_iFømeR©e
;

132 
I¡
 
	gm_FømeSkù
;

133 
UI¡
 
	gm_ãmp‹ÆSubßm∂eR©io
;

134 
I¡
 
	gm_iSour˚Width
;

135 
I¡
 
	gm_iSour˚Height
;

136 
Wödow
 
	gm_c⁄f‹m™˚Wödow
;

137 
I¡
 
	gm_‰amesToBeEncoded
;

138 
DoubÀ
 
	gm_adLambdaModifõr
[ 
MAX_TLAYER
 ];

139 
	g°d
::
ve˘‹
<
DoubÀ
> 
m_adI¡øLambdaModifõr
;

140 
DoubÀ
 
	gm_dI¡øQpFa˘‹
;

142 
Boﬁ
 
	gm_¥ötMSEBa£dSequí˚PSNR
;

143 
Boﬁ
 
	gm_¥ötHexP¢r
;

144 
Boﬁ
 
	gm_¥ötFømeMSE
;

145 
Boﬁ
 
	gm_¥ötSequí˚MSE
;

146 
Boﬁ
 
	gm_¥ötMSSSIM
;

147 
Boﬁ
 
	gm_bXPSNRE«bÀFœg
;

148 
DoubÀ
 
	gm_dXPSNRWeight
[
MAX_NUM_COMPONENT
];

149 
Boﬁ
 
	gm_ˇbacZîoW‹dPaddögE«bÀd
;

152 
	gProfûe
::
Name
 
m_¥ofûe
;

153 
	gLevñ
::
Tõr
 
m_ÀvñTõr
;

154 
	gLevñ
::
Name
 
m_Àvñ
;

155 
Boﬁ
 
	gm_¥ogªssiveSour˚Fœg
;

156 
Boﬁ
 
	gm_öãæa˚dSour˚Fœg
;

157 
Boﬁ
 
	gm_n⁄PackedC⁄°øötFœg
;

158 
Boﬁ
 
	gm_‰ameO∆yC⁄°øötFœg
;

159 
UI¡
 
	gm_bôDïthC⁄°øötVÆue
;

160 
ChromaF‹m©
 
	gm_chromaF‹m©C⁄°øötVÆue
;

161 
Boﬁ
 
	gm_öåaC⁄°øötFœg
;

162 
Boﬁ
 
	gm_⁄ePi˘uªO∆yC⁄°øötFœg
;

163 
Boﬁ
 
	gm_lowîBôR©eC⁄°øötFœg
;

166 
UI¡
 
	gm_uiI¡øPîiod
;

167 
UI¡
 
	gm_uiDecodögRe‰eshTy≥
;

168 
Boﬁ
 
	gm_bReWrôeP¨amSësFœg
;

169 
I¡
 
	gm_iGOPSize
;

170 
GOPE¡ry
 
	gm_GOPLi°
[
MAX_GOP
];

171 
I¡
 
	gm_exåaRPSs
;

172 
I¡
 
	gm_maxDecPicBuf„rög
[
MAX_TLAYER
];

173 
I¡
 
	gm_numRe‹dîPics
[
MAX_TLAYER
];

175 
I¡
 
	gm_iQP
;

176 
I¡
 
	gm_öåaQPOff£t
;

177 
I¡
 
	gm_œmbdaFromQPE«bÀ
;

178 
I¡
 
	gm_aiPad
[2];

180 
Boﬁ
 
	gm_Ac˚ssUnôDñimôî
;

182 
I¡
 
	gm_iMaxRefPicNum
;

185 
I¡
 
	gm_maxTempLayî
;

186 
Boﬁ
 
	gm_u£AMP
;

187 
UI¡
 
	gm_maxCUWidth
;

188 
UI¡
 
	gm_maxCUHeight
;

189 
UI¡
 
	gm_maxTŸÆCUDïth
;

190 
UI¡
 
	gm_log2DiffMaxMöCodögBlockSize
;

193 
UI¡
 
	gm_uiQuadåìTULog2MaxSize
;

194 
UI¡
 
	gm_uiQuadåìTULog2MöSize
;

195 
UI¡
 
	gm_uiQuadåìTUMaxDïthI¡î
;

196 
UI¡
 
	gm_uiQuadåìTUMaxDïthI¡ø
;

199 
Boﬁ
 
	gm_bLo›FûãrDißbÀ
;

200 
Boﬁ
 
	gm_lo›FûãrOff£tInPPS
;

201 
I¡
 
	gm_lo›FûãrBëaOff£tDiv2
;

202 
I¡
 
	gm_lo›FûãrTcOff£tDiv2
;

203 
I¡
 
	gm_deblockögFûãrMëric
;

204 
Boﬁ
 
	gm_bU£SAO
;

205 
Boﬁ
 
	gm_bTe°SAODißbÀAtPi˘uªLevñ
;

206 
DoubÀ
 
	gm_ßoEncodögR©e
;

207 
DoubÀ
 
	gm_ßoEncodögR©eChroma
;

208 
I¡
 
	gm_maxNumOff£tsPîPic
;

209 
Boﬁ
 
	gm_ßoCtuBound¨y
;

210 
Boﬁ
 
	gm_ª£tEncodîSèãA·îIRAP
;

213 
Boﬁ
 
	gm_bDißbÀI¡øPUsInI¡îSli˚s
;

214 
MESórchMëhod
 
	gm_mŸi⁄E°im©i⁄SórchMëhod
;

215 
I¡
 
	gm_iSórchR™ge
;

216 
I¡
 
	gm_bùªdSórchR™ge
;

217 
Boﬁ
 
	gm_bClùF‹BiPªdMeE«bÀd
;

218 
Boﬁ
 
	gm_bFa°MEAssumögSmoŸhîMVE«bÀd
;

219 
I¡
 
	gm_möSórchWödow
;

220 
Boﬁ
 
	gm_bRe°ri˘MESam∂ög
;

223 
I¡
 
	gm_iMaxDñèQP
;

224 
I¡
 
	gm_iMaxCuDQPDïth
;

225 
I¡
 
	gm_diffCuChromaQpOff£tDïth
;

227 
I¡
 
	gm_chromaCbQpOff£t
;

228 
I¡
 
	gm_chromaCrQpOff£t
;

229 
WCGChromaQPC⁄åﬁ
 
	gm_wcgChromaQpC⁄åﬁ
;

230 
UI¡
 
	gm_¶i˚ChromaQpOff£tPîiodicôy
;

231 
I¡
 
	gm_¶i˚ChromaQpOff£tI¡øOrPîiodic
[2 ];

233 
ChromaF‹m©
 
	gm_chromaF‹m©IDC
;

235 #i‡
ADAPTIVE_QP_SELECTION


236 
Boﬁ
 
	gm_bU£Ad≠tQpSñe˘
;

238 
Boﬁ
 
	gm_exãndedPªcisi⁄Pro˚ssögFœg
;

239 
Boﬁ
 
	gm_highPªcisi⁄Off£tsE«bÀdFœg
;

240 
Boﬁ
 
	gm_bU£Ad≠tiveQP
;

241 
I¡
 
	gm_iQPAd≠èti⁄R™ge
;

244 
I¡
 
	gm_bôDïth
[
MAX_NUM_CHANNEL_TYPE
];

245 
Boﬁ
 
	gm_bU£ASR
;

246 
Boﬁ
 
	gm_bU£HADME
;

247 
Boﬁ
 
	gm_u£RDOQ
;

248 
Boﬁ
 
	gm_u£RDOQTS
;

249 
Boﬁ
 
	gm_u£Sñe˘iveRDOQ
;

250 
UI¡
 
	gm_rdPíÆty
;

251 
Fa°I¡îSórchMode
 
	gm_Á°I¡îSórchMode
;

252 
Boﬁ
 
	gm_bU£E¨lyCU
;

253 
Boﬁ
 
	gm_u£Fa°Decisi⁄F‹Mîge
;

254 
Boﬁ
 
	gm_bU£CbfFa°Mode
;

255 
Boﬁ
 
	gm_u£E¨lySkùDëe˘i⁄
;

256 
Boﬁ
 
	gm_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
;

257 
Boﬁ
 
	gm_ªc⁄Ba£dCrossCPªdi˘i⁄E°im©e
;

258 
UI¡
 
	gm_log2SaoOff£tSˇÀ
[
MAX_NUM_CHANNEL_TYPE
];

259 
Boﬁ
 
	gm_u£Tønsf‹mSkù
;

260 
Boﬁ
 
	gm_u£Tønsf‹mSkùFa°
;

261 
UI¡
 
	gm_log2MaxTønsf‹mSkùBlockSize
;

262 
Boﬁ
 
	gm_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
;

263 
Boﬁ
 
	gm_å™sf‹mSkùC⁄ãxtE«bÀdFœg
;

264 
Boﬁ
 
	gm_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
;

265 
Boﬁ
 
	gm_ˇbacBy∑ssAlignmítE«bÀdFœg
;

266 
Boﬁ
 
	gm_rdpcmE«bÀdFœg
[
NUMBER_OF_RDPCM_SIGNALLING_MODES
];

267 
LumaLevñToDñèQPM≠pög
 
	gm_lumaLevñToDñèQPM≠pög
;

268 
I¡
* 
	gm_aidQP
;

269 
UI¡
 
	gm_uiDñèQpRD
;

270 
Boﬁ
 
	gm_bFa°DñèQP
;

272 
Boﬁ
 
	gm_bU£C⁄°øöedI¡øPªd
;

273 
Boﬁ
 
	gm_bFa°UDIU£MPME«bÀd
;

274 
Boﬁ
 
	gm_bFa°MEF‹GíBLowDñayE«bÀd
;

275 
Boﬁ
 
	gm_bU£BLambdaF‹N⁄KeyLowDñayPi˘uªs
;

276 
Boﬁ
 
	gm_u£PCM
;

277 
I¡
 
	gm_PCMBôDïth
[
MAX_NUM_CHANNEL_TYPE
];

278 
UI¡
 
	gm_pcmLog2MaxSize
;

279 
UI¡
 
	gm_uiPCMLog2MöSize
;

281 
Sli˚C⁄°øöt
 
	gm_¶i˚Mode
;

282 
I¡
 
	gm_¶i˚Argumít
;

284 
Sli˚C⁄°øöt
 
	gm_¶i˚SegmítMode
;

285 
I¡
 
	gm_¶i˚SegmítArgumít
;

286 
Boﬁ
 
	gm_bLFCrossSli˚Bound¨yFœg
;

288 
Boﬁ
 
	gm_bPCMI≈utBôDïthFœg
;

289 
Boﬁ
 
	gm_bPCMFûãrDißbÀFœg
;

290 
Boﬁ
 
	gm_öåaSmoŸhögDißbÀdFœg
;

291 
Boﬁ
 
	gm_lo›FûãrA¸ossTûesE«bÀdFœg
;

292 
Boﬁ
 
	gm_tûeUnif‹mS∑cögFœg
;

293 
I¡
 
	gm_iNumCﬁumnsMöus1
;

294 
I¡
 
	gm_iNumRowsMöus1
;

295 
	g°d
::
ve˘‹
<
I¡
> 
m_tûeCﬁumnWidth
;

296 
	g°d
::
ve˘‹
<
I¡
> 
m_tûeRowHeight
;

298 
Boﬁ
 
	gm_íå›yCodögSyncE«bÀdFœg
;

300 
HashTy≥
 
	gm_decodedPi˘uªHashSEITy≥
;

301 
Boﬁ
 
	gm_buf„rögPîiodSEIE«bÀd
;

302 
Boﬁ
 
	gm_pi˘uªTimögSEIE«bÀd
;

303 
Boﬁ
 
	gm_ªcovîyPoötSEIE«bÀd
;

304 
Boﬁ
 
	gm_t⁄eM≠pögInfoSEIE«bÀd
;

305 
I¡
 
	gm_t⁄eM≠Id
;

306 
Boﬁ
 
	gm_t⁄eM≠C™˚lFœg
;

307 
Boﬁ
 
	gm_t⁄eM≠Pîsi°í˚Fœg
;

308 
I¡
 
	gm_codedD©aBôDïth
;

309 
I¡
 
	gm_èrgëBôDïth
;

310 
I¡
 
	gm_modñId
;

311 
I¡
 
	gm_möVÆue
;

312 
I¡
 
	gm_maxVÆue
;

313 
I¡
 
	gm_sigmoidMidpoöt
;

314 
I¡
 
	gm_sigmoidWidth
;

315 
I¡
 
	gm_numPivŸs
;

316 
I¡
 
	gm_ˇmîaIsoS≥edIdc
;

317 
I¡
 
	gm_ˇmîaIsoS≥edVÆue
;

318 
I¡
 
	gm_exposuªIndexIdc
;

319 
I¡
 
	gm_exposuªIndexVÆue
;

320 
Boﬁ
 
	gm_exposuªCom≥nßti⁄VÆueSignFœg
;

321 
I¡
 
	gm_exposuªCom≥nßti⁄VÆueNumî©‹
;

322 
I¡
 
	gm_exposuªCom≥nßti⁄VÆueDíomIdc
;

323 
I¡
 
	gm_ªfS¸ìnLumö™˚Whôe
;

324 
I¡
 
	gm_exãndedR™geWhôeLevñ
;

325 
I¡
 
	gm_nomöÆBœckLevñLumaCodeVÆue
;

326 
I¡
 
	gm_nomöÆWhôeLevñLumaCodeVÆue
;

327 
I¡
 
	gm_exãndedWhôeLevñLumaCodeVÆue
;

328 
I¡
* 
	gm_°¨tOfCodedI¡îvÆ
;

329 
I¡
* 
	gm_codedPivŸVÆue
;

330 
I¡
* 
	gm_èrgëPivŸVÆue
;

331 
Boﬁ
 
	gm_‰amePackögSEIE«bÀd
;

332 
I¡
 
	gm_‰amePackögSEITy≥
;

333 
I¡
 
	gm_‰amePackögSEIId
;

334 
I¡
 
	gm_‰amePackögSEIQuöcunx
;

335 
I¡
 
	gm_‰amePackögSEII¡î¥ë©i⁄
;

336 
Boﬁ
 
	gm_£gmíãdRe˘FømePackögSEIE«bÀd
;

337 
Boﬁ
 
	gm_£gmíãdRe˘FømePackögSEIC™˚l
;

338 
I¡
 
	gm_£gmíãdRe˘FømePackögSEITy≥
;

339 
Boﬁ
 
	gm_£gmíãdRe˘FømePackögSEIPîsi°í˚
;

340 
I¡
 
	gm_di•œyOrõ¡©i⁄SEIAngÀ
;

341 
Boﬁ
 
	gm_ãmp‹ÆLevñ0IndexSEIE«bÀd
;

342 
Boﬁ
 
	gm_gøduÆDecodögRe‰eshInfoE«bÀd
;

343 
I¡
 
	gm_noDi•œySEITLayî
;

344 
Boﬁ
 
	gm_decodögUnôInfoSEIE«bÀd
;

345 
Boﬁ
 
	gm_SOPDes¸ùti⁄SEIE«bÀd
;

346 
Boﬁ
 
	gm_sˇœbÀNe°ögSEIE«bÀd
;

347 
Boﬁ
 
	gm_tm˘sSEIE«bÀd
;

348 #i‡
MCTS_ENC_CHECK


349 
Boﬁ
 
	gm_tm˘sSEITûeC⁄°øöt
;

351 #i‡
MCTS_EXTRACTION


352 
Boﬁ
 
	gm_tm˘sExåa˘i⁄SEIE«bÀd
;

354 
Boﬁ
 
	gm_timeCodeSEIE«bÀd
;

355 
I¡
 
	gm_timeCodeSEINumTs
;

356 
TComSEITimeSë
 
	gm_timeSëAºay
[
MAX_TIMECODE_SEI_SETS
];

357 
Boﬁ
 
	gm_k√eSEIE«bÀd
;

358 
TEncSEIK√eFun˘i⁄Inf‹m©i⁄
 
	gm_k√eFun˘i⁄Inf‹m©i⁄SEI
;

359 
	g°d
::
°rög
 
m_cﬁourRem≠SEIFûeRoŸ
;

360 
TComSEIMa°îögDi•œy
 
	gm_ma°îögDi•œy
;

361 
Boﬁ
 
	gm_Æã∫©iveTøns„rCh¨a˘îi°icsSEIE«bÀd
;

362 
UCh¨
 
	gm_¥e„ºedTøns„rCh¨a˘îi°ics
;

363 
Boﬁ
 
	gm_gªíMëad©aInfoSEIE«bÀd
;

364 
UCh¨
 
	gm_gªíMëad©aTy≥
;

365 
UCh¨
 
	gm_xsdMëricTy≥
;

366 
Boﬁ
 
	gm_ccvSEIE«bÀd
;

367 
Boﬁ
 
	gm_ccvSEIC™˚lFœg
;

368 
Boﬁ
 
	gm_ccvSEIPîsi°í˚Fœg
;

369 
Boﬁ
 
	gm_ccvSEIPrim¨õsPª£¡Fœg
;

370 
Boﬁ
 
	gm_ccvSEIMöLumö™˚VÆuePª£¡Fœg
;

371 
Boﬁ
 
	gm_ccvSEIMaxLumö™˚VÆuePª£¡Fœg
;

372 
Boﬁ
 
	gm_ccvSEIAvgLumö™˚VÆuePª£¡Fœg
;

373 
DoubÀ
 
	gm_ccvSEIPrim¨õsX
[
MAX_NUM_COMPONENT
];

374 
DoubÀ
 
	gm_ccvSEIPrim¨õsY
[
MAX_NUM_COMPONENT
];

375 
DoubÀ
 
	gm_ccvSEIMöLumö™˚VÆue
;

376 
DoubÀ
 
	gm_ccvSEIMaxLumö™˚VÆue
;

377 
DoubÀ
 
	gm_ccvSEIAvgLumö™˚VÆue
;

378 
Boﬁ
 
	gm_îpSEIE«bÀd
;

379 
Boﬁ
 
	gm_îpSEIC™˚lFœg
;

380 
Boﬁ
 
	gm_îpSEIPîsi°í˚Fœg
;

381 
Boﬁ
 
	gm_îpSEIGu¨dB™dFœg
;

382 
UI¡
 
	gm_îpSEIGu¨dB™dTy≥
;

383 
UI¡
 
	gm_îpSEILe·Gu¨dB™dWidth
;

384 
UI¡
 
	gm_îpSEIRightGu¨dB™dWidth
;

385 
Boﬁ
 
	gm_•hîeRŸ©i⁄SEIE«bÀd
;

386 
Boﬁ
 
	gm_•hîeRŸ©i⁄SEIC™˚lFœg
;

387 
Boﬁ
 
	gm_•hîeRŸ©i⁄SEIPîsi°í˚Fœg
;

388 
I¡
 
	gm_•hîeRŸ©i⁄SEIYaw
;

389 
I¡
 
	gm_•hîeRŸ©i⁄SEIPôch
;

390 
I¡
 
	gm_•hîeRŸ©i⁄SEIRﬁl
;

391 
Boﬁ
 
	gm_omniVõwp‹tSEIE«bÀd
;

392 
UI¡
 
	gm_omniVõwp‹tSEIId
;

393 
Boﬁ
 
	gm_omniVõwp‹tSEIC™˚lFœg
;

394 
Boﬁ
 
	gm_omniVõwp‹tSEIPîsi°í˚Fœg
;

395 
UI¡
 
	gm_omniVõwp‹tSEIC¡Möus1
;

396 
	g°d
::
ve˘‹
<
I¡
> 
m_omniVõwp‹tSEIAzimuthCíåe
;

397 
	g°d
::
ve˘‹
<
I¡
> 
m_omniVõwp‹tSEIEÀv©i⁄Cíåe
;

398 
	g°d
::
ve˘‹
<
I¡
> 
m_omniVõwp‹tSEITûtCíåe
;

399 
	g°d
::
ve˘‹
<
UI¡
> 
m_omniVõwp‹tSEIH‹R™ge
;

400 
	g°d
::
ve˘‹
<
UI¡
> 
m_omniVõwp‹tSEIVîR™ge
;

401 
Boﬁ
 
	gm_g›Ba£dTemp‹ÆFûãrE«bÀd
;

402 
Boﬁ
 
	gm_cmpSEIE«bÀd
;

403 
Boﬁ
 
	gm_cmpSEICmpC™˚lFœg
;

404 
Boﬁ
 
	gm_cmpSEICmpPîsi°í˚Fœg
;

405 
Boﬁ
 
	gm_rwpSEIE«bÀd
;

406 
Boﬁ
 
	gm_rwpSEIRwpC™˚lFœg
;

407 
Boﬁ
 
	gm_rwpSEIRwpPîsi°í˚Fœg
;

408 
Boﬁ
 
	gm_rwpSEIC⁄°ôuítPi˘uªM©chögFœg
;

409 
I¡
 
	gm_rwpSEINumPackedRegi⁄s
;

410 
I¡
 
	gm_rwpSEIProjPi˘uªWidth
;

411 
I¡
 
	gm_rwpSEIProjPi˘uªHeight
;

412 
I¡
 
	gm_rwpSEIPackedPi˘uªWidth
;

413 
I¡
 
	gm_rwpSEIPackedPi˘uªHeight
;

414 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpSEIRwpTønsf‹mTy≥
;

415 
	g°d
::
ve˘‹
<
Boﬁ
> 
m_rwpSEIRwpGu¨dB™dFœg
;

416 
	g°d
::
ve˘‹
<
UI¡
> 
m_rwpSEIProjRegi⁄Width
;

417 
	g°d
::
ve˘‹
<
UI¡
> 
m_rwpSEIProjRegi⁄Height
;

418 
	g°d
::
ve˘‹
<
UI¡
> 
m_rwpSEIRwpSEIProjRegi⁄T›
;

419 
	g°d
::
ve˘‹
<
UI¡
> 
m_rwpSEIProjRegi⁄Le·
;

420 
	g°d
::
ve˘‹
<
USh‹t
> 
m_rwpSEIPackedRegi⁄Width
;

421 
	g°d
::
ve˘‹
<
USh‹t
> 
m_rwpSEIPackedRegi⁄Height
;

422 
	g°d
::
ve˘‹
<
USh‹t
> 
m_rwpSEIPackedRegi⁄T›
;

423 
	g°d
::
ve˘‹
<
USh‹t
> 
m_rwpSEIPackedRegi⁄Le·
;

424 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpSEIRwpLe·Gu¨dB™dWidth
;

425 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpSEIRwpRightGu¨dB™dWidth
;

426 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpSEIRwpT›Gu¨dB™dHeight
;

427 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpSEIRwpBŸtomGu¨dB™dHeight
;

428 
	g°d
::
ve˘‹
<
Boﬁ
> 
m_rwpSEIRwpGu¨dB™dNŸU£dF‹PªdFœg
;

429 
	g°d
::
ve˘‹
<
UCh¨
> 
m_rwpSEIRwpGu¨dB™dTy≥
;

430 
	g°d
::
°rög
 
m_¨SEIFûeRoŸ
;

431 
Boﬁ
 
	gm_fviSEIE«bÀd
;

432 
TComSEIFisheyeVideoInfo
 
	gm_fisheyeVideoInfo
;

433 
	g°d
::
°rög
 
m_ªgi⁄ÆNe°ögSEIFûeRoŸ
;

434 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


435 
Boﬁ
 
	gm_siiSEIE«bÀd
;

436 
UI¡
 
	gm_siiSEINumUnôsInShuâîI¡îvÆ
;

437 
UI¡
 
	gm_siiSEITimeSˇÀ
;

438 
	g°d
::
ve˘‹
<
UI¡
> 
m_siiSEISubLayîNumUnôsInSI
;

440 #i‡
SEI_ENCODER_CONTROL


442 
Boﬁ
 
	gm_fgcSEIE«bÀd
;

443 
Boﬁ
 
	gm_fgcSEIC™˚lFœg
;

444 
Boﬁ
 
	gm_fgcSEIPîsi°í˚Fœg
;

445 
UCh¨
 
	gm_fgcSEIModñID
;

446 
Boﬁ
 
	gm_fgcSEISïCﬁourDescPª£¡Fœg
;

447 
UCh¨
 
	gm_fgcSEIBÀndögModeID
;

448 
UCh¨
 
	gm_fgcSEILog2SˇÀFa˘‹
;

449 
Boﬁ
 
	gm_fgcSEICompModñPª£¡
[
MAX_NUM_COMPONENT
];

450 #i‡
FGS_RDD5_ENABLE


451 
UCh¨
 
	gm_fgcSEINumI¡ísôyI¡îvÆMöus1
[
MAX_NUM_COMPONENT
];

452 
UCh¨
 
	gm_fgcSEINumModñVÆuesMöus1
[
MAX_NUM_COMPONENT
];

453 
UCh¨
 
	gm_fgcSEII¡ísôyI¡îvÆLowîBound
[
MAX_NUM_COMPONENT
][
MAX_NUM_INTENSITIES
];

454 
UCh¨
 
	gm_fgcSEII¡ísôyI¡îvÆUµîBound
[
MAX_NUM_COMPONENT
][
MAX_NUM_INTENSITIES
];

455 
UI¡
 
	gm_fgcSEICompModñVÆue
[
MAX_NUM_COMPONENT
][
MAX_NUM_INTENSITIES
][
MAX_NUM_MODEL_VALUES
];

458 
Boﬁ
 
	gm_˛lSEIE«bÀd
;

459 
USh‹t
 
	gm_˛lSEIMaxC⁄ã¡Levñ
;

460 
USh‹t
 
	gm_˛lSEIMaxPicAvgLevñ
;

462 
Boﬁ
 
	gm_aveSEIE«bÀd
;

463 
UI¡
 
	gm_aveSEIAmbõ¡IŒumö™˚
;

464 
USh‹t
 
	gm_aveSEIAmbõ¡LightX
;

465 
USh‹t
 
	gm_aveSEIAmbõ¡LightY
;

468 
Boﬁ
 
	gm_u£WeighãdPªd
;

469 
Boﬁ
 
	gm_u£WeighãdBiPªd
;

470 
WeighãdPªdi˘i⁄Mëhod
 
	gm_weighãdPªdi˘i⁄Mëhod
;

471 
UI¡
 
	gm_log2P¨ÆÀlMîgeLevñMöus2
;

472 
UI¡
 
	gm_maxNumMîgeC™d
;

473 
SˇlögLi°Mode
 
	gm_u£SˇlögLi°Id
;

474 
	g°d
::
°rög
 
m_sˇlögLi°FûeName
;

475 
I¡
 
	gm_TMVPModeId
;

476 
Boﬁ
 
	gm_SignD©aHidögE«bÀdFœg
;

477 
Boﬁ
 
	gm_RCE«bÀR©eC⁄åﬁ
;

478 
I¡
 
	gm_RCT¨gëBôøã
;

479 
I¡
 
	gm_RCKìpHõørchiˇlBô
;

480 
Boﬁ
 
	gm_RCLCULevñRC
;

481 
Boﬁ
 
	gm_RCU£LCUSï¨©eModñ
;

482 
I¡
 
	gm_RCInôülQP
;

483 
Boﬁ
 
	gm_RCF‹˚I¡øQP
;

484 
Boﬁ
 
	gm_RCCpbS©uøti⁄E«bÀd
;

485 
UI¡
 
	gm_RCCpbSize
;

486 
DoubÀ
 
	gm_RCInôülCpbFuŒ√ss
;

487 
Boﬁ
 
	gm_Tønsqu™tBy∑ssE«bÀdFœg
;

488 
Boﬁ
 
	gm_CUTønsqu™tBy∑ssFœgF‹˚
;

490 
Co°Mode
 
	gm_co°Mode
;

492 
TComVPS
 
	gm_cVPS
;

493 
Boﬁ
 
	gm_ªˇlcuœãQPAcc‹dögToLambda
;

494 
I¡
 
	gm_a˘iveP¨amëîSësSEIE«bÀd
;

495 
Boﬁ
 
	gm_vuiP¨amëîsPª£¡Fœg
;

496 
Boﬁ
 
	gm_a•e˘R©ioInfoPª£¡Fœg
;

497 
Boﬁ
 
	gm_chromaReßm∂ögFûãrHötE«bÀd
;

498 
I¡
 
	gm_chromaReßm∂ögH‹FûãrIdc
;

499 
I¡
 
	gm_chromaReßm∂ögVîFûãrIdc
;

500 
I¡
 
	gm_a•e˘R©ioIdc
;

501 
I¡
 
	gm_ßrWidth
;

502 
I¡
 
	gm_ßrHeight
;

503 
Boﬁ
 
	gm_ovîsˇnInfoPª£¡Fœg
;

504 
Boﬁ
 
	gm_ovîsˇnAµr›rüãFœg
;

505 
Boﬁ
 
	gm_videoSig«lTy≥Pª£¡Fœg
;

506 
I¡
 
	gm_videoF‹m©
;

507 
Boﬁ
 
	gm_videoFuŒR™geFœg
;

508 
Boﬁ
 
	gm_cﬁourDes¸ùti⁄Pª£¡Fœg
;

509 
I¡
 
	gm_cﬁourPrim¨õs
;

510 
I¡
 
	gm_å™s„rCh¨a˘îi°ics
;

511 
I¡
 
	gm_m©rixC€fficõ¡s
;

512 
Boﬁ
 
	gm_chromaLocInfoPª£¡Fœg
;

513 
I¡
 
	gm_chromaSam∂eLocTy≥T›Fõld
;

514 
I¡
 
	gm_chromaSam∂eLocTy≥BŸtomFõld
;

515 
Boﬁ
 
	gm_√uåÆChromaIndiˇti⁄Fœg
;

516 
Wödow
 
	gm_deÁu…Di•œyWödow
;

517 
Boﬁ
 
	gm_‰ameFõldInfoPª£¡Fœg
;

518 
Boﬁ
 
	gm_pocPr›‹ti⁄ÆToTimögFœg
;

519 
I¡
 
	gm_numTicksPocDiffO√Möus1
;

520 
Boﬁ
 
	gm_bô°ªamRe°ri˘i⁄Fœg
;

521 
Boﬁ
 
	gm_tûesFixedSåu˘uªFœg
;

522 
Boﬁ
 
	gm_mŸi⁄Ve˘‹sOvîPicBound¨õsFœg
;

523 
I¡
 
	gm_möS∑tülSegmíèti⁄Idc
;

524 
I¡
 
	gm_maxByãsPîPicDíom
;

525 
I¡
 
	gm_maxBôsPîMöCuDíom
;

526 
I¡
 
	gm_log2MaxMvLígthH‹iz⁄èl
;

527 
I¡
 
	gm_log2MaxMvLígthVîtiˇl
;

529 
Boﬁ
 
	gm_u£Så⁄gI¡øSmoŸhög
;

530 
Boﬁ
 
	gm_bEfficõ¡FõldIRAPE«bÀd
;

531 
Boﬁ
 
	gm_bH¨m⁄izeG›Fú°FõldCou∂eE«bÀd
;

533 
	g°d
::
°rög
 
m_summ¨yOutFûíame
;

534 
	g°d
::
°rög
 
m_summ¨yPicFûíameBa£
;

535 
UI¡
 
	gm_summ¨yVîbo£√ss
;

537 
	gpublic
:

538 
	$TEncCfg
()

539 : 
	`m_tûeCﬁumnWidth
()

540 , 
	$m_tûeRowHeight
()

542 
m_PCMBôDïth
[
CHANNEL_TYPE_LUMA
]=8;

543 
m_PCMBôDïth
[
CHANNEL_TYPE_CHROMA
]=8;

544 
	}
}

546 
	gvútuÆ
 ~
	$TEncCfg
()

547 {
	}
}

549 
Void
 
	$£tProfûe
(
Profûe
::
Name
 
¥ofûe
Ë{ 
m_¥ofûe
 =Örofûe; 
	}
}

550 
Void
 
	$£tLevñ
(
Levñ
::
Tõr
 
tõr
, Levñ::
Name
 
Àvñ
Ë{ 
m_ÀvñTõr
 =Åõr; 
m_Àvñ
 =Üevñ; 
	}
}

552 
Void
 
	$£tFømeR©e
 ( 
I¡
 
i
 ) { 
m_iFømeR©e
 = i; 
	}
}

553 
Void
 
	$£tFømeSkù
 ( 
UI¡
 
i
 ) { 
m_FømeSkù
 = i; 
	}
}

554 
Void
 
	$£tTemp‹ÆSubßm∂eR©io
 ( 
UI¡
 
i
 ) { 
m_ãmp‹ÆSubßm∂eR©io
 = i; 
	}
}

555 
Void
 
	$£tSour˚Width
 ( 
I¡
 
i
 ) { 
m_iSour˚Width
 = i; 
	}
}

556 
Void
 
	$£tSour˚Height
 ( 
I¡
 
i
 ) { 
m_iSour˚Height
 = i; 
	}
}

558 
	gWödow
 &
	$gëC⁄f‹m™˚Wödow
(Ë{  
m_c⁄f‹m™˚Wödow
; 
	}
}

559 
Void
 
	$£tC⁄f‹m™˚Wödow
 (
I¡
 
c⁄fLe·
, I¡ 
c⁄fRight
, I¡ 
c⁄fT›
, I¡ 
c⁄fBŸtom
 ) { 
m_c⁄f‹m™˚Wödow
.
	`£tWödow
 (c⁄fLe·, c⁄fRight, c⁄fT›, c⁄fBŸtom); 
	}
}

561 
Void
 
	$£tFømesToBeEncoded
 ( 
I¡
 
i
 ) { 
m_‰amesToBeEncoded
 = i; 
	}
}

563 
Boﬁ
 
	$gëPrötMSEBa£dSequí˚PSNR
 (Ëc⁄° {  
m_¥ötMSEBa£dSequí˚PSNR
; 
	}
}

564 
Void
 
	$£tPrötMSEBa£dSequí˚PSNR
 (
Boﬁ
 
vÆue
Ë{ 
m_¥ötMSEBa£dSequí˚PSNR
 = vÆue; 
	}
}

566 
Boﬁ
 
	$gëPrötHexP¢r
 (Ëc⁄° {  
m_¥ötHexP¢r
; 
	}
}

567 
Void
 
	$£tPrötHexP¢r
 (
Boﬁ
 
vÆue
Ë{ 
m_¥ötHexP¢r
 = vÆue; 
	}
}

569 
Boﬁ
 
	$gëPrötFømeMSE
 (Ëc⁄° {  
m_¥ötFømeMSE
; 
	}
}

570 
Void
 
	$£tPrötFømeMSE
 (
Boﬁ
 
vÆue
Ë{ 
m_¥ötFømeMSE
 = vÆue; 
	}
}

572 
Boﬁ
 
	$gëPrötSequí˚MSE
 (Ëc⁄° {  
m_¥ötSequí˚MSE
; 
	}
}

573 
Void
 
	$£tPrötSequí˚MSE
 (
Boﬁ
 
vÆue
Ë{ 
m_¥ötSequí˚MSE
 = vÆue; 
	}
}

575 
Boﬁ
 
	$gëPrötMSSSIM
 (Ëc⁄° {  
m_¥ötMSSSIM
; 
	}
}

576 
Void
 
	$£tPrötMSSSIM
 (
Boﬁ
 
vÆue
Ë{ 
m_¥ötMSSSIM
 = vÆue; 
	}
}

578 
Boﬁ
 
	$gëXPSNRE«bÀFœg
 (Ëc⁄° {  
m_bXPSNRE«bÀFœg
;
	}
}

579 
DoubÀ
 
	$gëXPSNRWeight
 (c⁄° 
Comp⁄ítID
 
id
Ëc⁄° {  
m_dXPSNRWeight
[id];
	}
}

581 
Void
 
	$£tXPSNRE«bÀFœg
 ( 
Boﬁ
 
i
 ) { 
m_bXPSNRE«bÀFœg
 = i; 
	}
}

582 
Void
 
	$£tXPSNRWeight
 ( 
DoubÀ
 
dVÆue
, 
Comp⁄ítID
 
id
Ë{ 
m_dXPSNRWeight
[id] = dVÆue;
	}
}

584 
Boﬁ
 
	$gëCabacZîoW‹dPaddögE«bÀd
(Ëc⁄° {  
m_ˇbacZîoW‹dPaddögE«bÀd
; 
	}
}

585 
Void
 
	$£tCabacZîoW‹dPaddögE«bÀd
(
Boﬁ
 
vÆue
Ë{ 
m_ˇbacZîoW‹dPaddögE«bÀd
 = vÆue; 
	}
}

588 
Void
 
	$£tI¡øPîiod
 ( 
I¡
 
i
 ) { 
m_uiI¡øPîiod
 = (
UI¡
)i; 
	}
}

589 
Void
 
	$£tDecodögRe‰eshTy≥
 ( 
I¡
 
i
 ) { 
m_uiDecodögRe‰eshTy≥
 = (
UI¡
)i; 
	}
}

590 
Void
 
	$£tReWrôeP¨amSësFœg
 ( 
Boﬁ
 
b
 ) { 
m_bReWrôeP¨amSësFœg
 = b; 
	}
}

591 
Void
 
	$£tGOPSize
 ( 
I¡
 
i
 ) { 
m_iGOPSize
 = i; 
	}
}

592 
Void
 
	$£tG›Li°
 ( c⁄° 
GOPE¡ry
 
GOPLi°
[
MAX_GOP
] ) {  
I¡
 
i
 = 0; i < MAX_GOP; i++ ) 
m_GOPLi°
[i] = GOPLi°[i]; 
	}
}

593 
Void
 
	$£tExåaRPSs
 ( 
I¡
 
i
 ) { 
m_exåaRPSs
 = i; 
	}
}

594 c⁄° 
	gGOPE¡ry
 &
	$gëGOPE¡ry
 ( 
I¡
 
i
 ) c⁄° {  
m_GOPLi°
[i]; 
	}
}

595 
Void
 
	$£tEncodedFœg
 ( 
I¡
 
i
, 
Boﬁ
 
vÆue
 ) { 
m_GOPLi°
[i].
m_isEncoded
 = vÆue; 
	}
}

596 
Void
 
	$£tMaxDecPicBuf„rög
 ( 
UI¡
 
u
, UI¡ 
éayî
 ) { 
m_maxDecPicBuf„rög
[éayî] = u; 
	}
}

597 
Void
 
	$£tNumRe‹dîPics
 ( 
I¡
 
i
, 
UI¡
 
éayî
 ) { 
m_numRe‹dîPics
[éayî] = i; 
	}
}

599 
Void
 
	$£tQP
 ( 
I¡
 
i
 ) { 
m_iQP
 = i; 
	}
}

600 
Void
 
	$£tI¡øQPOff£t
 ( 
I¡
 
i
 ) { 
m_öåaQPOff£t
 = i; 
	}
}

601 
Void
 
	$£tLambdaFromQPE«bÀ
 ( 
Boﬁ
 
b
 ) { 
m_œmbdaFromQPE«bÀ
 = b; 
	}
}

602 
Void
 
	$£tPad
 ( 
I¡
* 
iPad
 ) {  I¡ 
i
 = 0; i < 2; i++ ) 
m_aiPad
[i] = iPad[i]; 
	}
}

604 
I¡
 
	$gëMaxRefPicNum
 (Ë{  
m_iMaxRefPicNum
; 
	}
}

605 
Void
 
	$£tMaxRefPicNum
 ( 
I¡
 
iMaxRefPicNum
 ) { 
m_iMaxRefPicNum
 = iMaxRefPicNum; 
	}
}

607 
I¡
 
	$gëMaxTempLayî
 (Ë{  
m_maxTempLayî
; 
	}
}

608 
Void
 
	$£tMaxTempLayî
 ( 
I¡
 
maxTempLayî
 ) { 
m_maxTempLayî
 = maxTempLayî; 
	}
}

609 
Void
 
	$£tMaxCUWidth
 ( 
UI¡
 
u
 ) { 
m_maxCUWidth
 = u; 
	}
}

610 
Void
 
	$£tMaxCUHeight
 ( 
UI¡
 
u
 ) { 
m_maxCUHeight
 = u; 
	}
}

611 
Void
 
	$£tMaxTŸÆCUDïth
 ( 
UI¡
 
u
 ) { 
m_maxTŸÆCUDïth
 = u; 
	}
}

612 
Void
 
	$£tLog2DiffMaxMöCodögBlockSize
–
UI¡
 
u
 ) { 
m_log2DiffMaxMöCodögBlockSize
 = u; 
	}
}

615 
Void
 
	$£tQuadåìTULog2MaxSize
 ( 
UI¡
 
u
 ) { 
m_uiQuadåìTULog2MaxSize
 = u; 
	}
}

616 
Void
 
	$£tQuadåìTULog2MöSize
 ( 
UI¡
 
u
 ) { 
m_uiQuadåìTULog2MöSize
 = u; 
	}
}

617 
Void
 
	$£tQuadåìTUMaxDïthI¡î
 ( 
UI¡
 
u
 ) { 
m_uiQuadåìTUMaxDïthI¡î
 = u; 
	}
}

618 
Void
 
	$£tQuadåìTUMaxDïthI¡ø
 ( 
UI¡
 
u
 ) { 
m_uiQuadåìTUMaxDïthI¡ø
 = u; 
	}
}

620 
Void
 
	$£tU£AMP
–
Boﬁ
 
b
 ) { 
m_u£AMP
 = b; 
	}
}

623 
Void
 
	$£tLo›FûãrDißbÀ
 ( 
Boﬁ
 
b
 ) { 
m_bLo›FûãrDißbÀ
 = b; 
	}
}

624 
Void
 
	$£tLo›FûãrOff£tInPPS
 ( 
Boﬁ
 
b
 ) { 
m_lo›FûãrOff£tInPPS
 = b; 
	}
}

625 
Void
 
	$£tLo›FûãrBëaOff£t
 ( 
I¡
 
i
 ) { 
m_lo›FûãrBëaOff£tDiv2
 = i; 
	}
}

626 
Void
 
	$£tLo›FûãrTcOff£t
 ( 
I¡
 
i
 ) { 
m_lo›FûãrTcOff£tDiv2
 = i; 
	}
}

627 
Void
 
	$£tDeblockögFûãrMëric
 ( 
I¡
 
i
 ) { 
m_deblockögFûãrMëric
 = i; 
	}
}

630 
Void
 
	$£tDißbÀI¡øPUsInI¡îSli˚s
 ( 
Boﬁ
 
b
 ) { 
m_bDißbÀI¡øPUsInI¡îSli˚s
 = b; 
	}
}

631 
Void
 
	$£tMŸi⁄E°im©i⁄SórchMëhod
 ( 
MESórchMëhod
 
e
 ) { 
m_mŸi⁄E°im©i⁄SórchMëhod
 =É; 
	}
}

632 
Void
 
	$£tSórchR™ge
 ( 
I¡
 
i
 ) { 
m_iSórchR™ge
 = i; 
	}
}

633 
Void
 
	$£tBùªdSórchR™ge
 ( 
I¡
 
i
 ) { 
m_bùªdSórchR™ge
 = i; 
	}
}

634 
Void
 
	$£tClùF‹BiPªdMeE«bÀd
 ( 
Boﬁ
 
b
 ) { 
m_bClùF‹BiPªdMeE«bÀd
 = b; 
	}
}

635 
Void
 
	$£tFa°MEAssumögSmoŸhîMVE«bÀd
 ( 
Boﬁ
 
b
 ) { 
m_bFa°MEAssumögSmoŸhîMVE«bÀd
 = b; 
	}
}

636 
Void
 
	$£tMöSórchWödow
 ( 
I¡
 
i
 ) { 
m_möSórchWödow
 = i; 
	}
}

637 
Void
 
	$£tRe°ri˘MESam∂ög
 ( 
Boﬁ
 
b
 ) { 
m_bRe°ri˘MESam∂ög
 = b; 
	}
}

640 
Void
 
	$£tMaxDñèQP
 ( 
I¡
 
i
 ) { 
m_iMaxDñèQP
 = i; 
	}
}

641 
Void
 
	$£tMaxCuDQPDïth
 ( 
I¡
 
i
 ) { 
m_iMaxCuDQPDïth
 = i; 
	}
}

643 
I¡
 
	$gëDiffCuChromaQpOff£tDïth
 (Ëc⁄° {  
m_diffCuChromaQpOff£tDïth
; 
	}
}

644 
Void
 
	$£tDiffCuChromaQpOff£tDïth
 (
I¡
 
vÆue
Ë{ 
m_diffCuChromaQpOff£tDïth
 = vÆue; 
	}
}

646 
Void
 
	$£tChromaCbQpOff£t
 ( 
I¡
 
i
 ) { 
m_chromaCbQpOff£t
 = i; 
	}
}

647 
Void
 
	$£tChromaCrQpOff£t
 ( 
I¡
 
i
 ) { 
m_chromaCrQpOff£t
 = i; 
	}
}

648 
Void
 
	$£tWCGChromaQpC⁄åﬁ
 ( c⁄° 
WCGChromaQPC⁄åﬁ
 &
˘æ
 ) { 
m_wcgChromaQpC⁄åﬁ
 = cål; 
	}
}

649 c⁄° 
	gWCGChromaQPC⁄åﬁ
 &
	$gëWCGChromaQPC⁄åﬁ
 (Ëc⁄° {  
m_wcgChromaQpC⁄åﬁ
; 
	}
}

650 
Void
 
	$£tSli˚ChromaOff£tQpI¡øOrPîiodic
–
UI¡
 
≥riodicôy
, 
I¡
 
¶i˚ChromaQpOff£tI¡øOrPîiodic
[2]Ë{ 
m_¶i˚ChromaQpOff£tPîiodicôy
 =Öîiodicôy; 
	`mem˝y
(
m_¶i˚ChromaQpOff£tI¡øOrPîiodic
, sli˚ChromaQpOff£tI¡øOrPîiodic, (m_¶i˚ChromaQpOff£tI¡øOrPîiodic)); 
	}
}

651 
I¡
 
	$gëSli˚ChromaOff£tQpI¡øOrPîiodic
–
Boﬁ
 
bIsCr
Ëc⁄° {  
m_¶i˚ChromaQpOff£tI¡øOrPîiodic
[bIsCr?1:0]; 
	}
}

652 
UI¡
 
	$gëSli˚ChromaOff£tQpPîiodicôy
(Ëc⁄° {  
m_¶i˚ChromaQpOff£tPîiodicôy
; 
	}
}

654 
Void
 
	$£tChromaF‹m©Idc
 ( 
ChromaF‹m©
 
cf
 ) { 
m_chromaF‹m©IDC
 = cf; 
	}
}

655 
ChromaF‹m©
 
	$gëChromaF‹m©Idc
 ( ) {  
m_chromaF‹m©IDC
; 
	}
}

657 
Void
 
	$£tLumaLevñToDñèQPC⁄åﬁs
–c⁄° 
LumaLevñToDñèQPM≠pög
 &
lumaLevñToDñèQPM≠pög
 ) { 
m_lumaLevñToDñèQPM≠pög
ˆumaLevñToDñèQPM≠pög; 
	}
}

658 c⁄° 
	gLumaLevñToDñèQPM≠pög
& 
	$gëLumaLevñToDñèQPM≠pög
(Ëc⁄° {  
m_lumaLevñToDñèQPM≠pög
; 
	}
}

660 #i‡
ADAPTIVE_QP_SELECTION


661 
Void
 
	$£tU£Ad≠tQpSñe˘
 ( 
Boﬁ
 
i
 ) { 
m_bU£Ad≠tQpSñe˘
 = i; 
	}
}

662 
Boﬁ
 
	$gëU£Ad≠tQpSñe˘
 (Ë{  
m_bU£Ad≠tQpSñe˘
; 
	}
}

665 
Boﬁ
 
	$gëExãndedPªcisi⁄Pro˚ssögFœg
 (Ëc⁄° {  
m_exãndedPªcisi⁄Pro˚ssögFœg
; 
	}
}

666 
Void
 
	$£tExãndedPªcisi⁄Pro˚ssögFœg
 (
Boﬁ
 
vÆue
Ë{ 
m_exãndedPªcisi⁄Pro˚ssögFœg
 = vÆue; 
	}
}

668 
Boﬁ
 
	$gëHighPªcisi⁄Off£tsE«bÀdFœg
(Ëc⁄° {  
m_highPªcisi⁄Off£tsE«bÀdFœg
; 
	}
}

669 
Void
 
	$£tHighPªcisi⁄Off£tsE«bÀdFœg
(
Boﬁ
 
vÆue
Ë{ 
m_highPªcisi⁄Off£tsE«bÀdFœg
 = vÆue; 
	}
}

671 
Void
 
	$£tU£Ad≠tiveQP
 ( 
Boﬁ
 
b
 ) { 
m_bU£Ad≠tiveQP
 = b; 
	}
}

672 
Void
 
	$£tQPAd≠èti⁄R™ge
 ( 
I¡
 
i
 ) { 
m_iQPAd≠èti⁄R™ge
 = i; 
	}
}

675 
I¡
 
	$gëFømeR©e
 (Ë{  
m_iFømeR©e
; 
	}
}

676 
UI¡
 
	$gëFømeSkù
 (Ë{  
m_FømeSkù
; 
	}
}

677 
UI¡
 
	$gëTemp‹ÆSubßm∂eR©io
 (Ë{  
m_ãmp‹ÆSubßm∂eR©io
; 
	}
}

678 
I¡
 
	$gëSour˚Width
 (Ë{  
m_iSour˚Width
; 
	}
}

679 
I¡
 
	$gëSour˚Height
 (Ë{  
m_iSour˚Height
; 
	}
}

680 
I¡
 
	$gëFømesToBeEncoded
 (Ë{  
m_‰amesToBeEncoded
; 
	}
}

683 
Void
 
	$£tLambdaModifõr
 ( 
UI¡
 
uiIndex
, 
DoubÀ
 
dVÆue
 ) { 
m_adLambdaModifõr
[ uiIndex ] = dVÆue; 
	}
}

684 
DoubÀ
 
	$gëLambdaModifõr
 ( 
UI¡
 
uiIndex
 ) c⁄° {  
m_adLambdaModifõr
[ uiIndex ]; 
	}
}

685 
Void
 
£tI¡øLambdaModifõr
 ( c⁄° 
°d
::
ve˘‹
<
DoubÀ
> &
dVÆue
 ) { 
m_adI¡øLambdaModifõr
 = dValue; }

686 c⁄° 
	g°d
::
ve˘‹
<
DoubÀ
>& 
	$gëI¡øLambdaModifõr
(Ëc⁄° {  
m_adI¡øLambdaModifõr
; 
	}
}

687 
Void
 
	$£tI¡øQpFa˘‹
 ( 
DoubÀ
 
dVÆue
 ) { 
m_dI¡øQpFa˘‹
 = dVÆue; 
	}
}

688 
DoubÀ
 
	$gëI¡øQpFa˘‹
 (Ëc⁄° {  
m_dI¡øQpFa˘‹
; 
	}
}

691 
UI¡
 
	$gëI¡øPîiod
 (Ë{  
m_uiI¡øPîiod
; 
	}
}

692 
UI¡
 
	$gëDecodögRe‰eshTy≥
 (Ë{  
m_uiDecodögRe‰eshTy≥
; 
	}
}

693 
Boﬁ
 
	$gëReWrôeP¨amSësFœg
 (Ë{  
m_bReWrôeP¨amSësFœg
; 
	}
}

694 
I¡
 
	$gëGOPSize
 (Ë{  
m_iGOPSize
; 
	}
}

695 
I¡
 
	$gëMaxDecPicBuf„rög
 (
UI¡
 
éayî
Ë{  
m_maxDecPicBuf„rög
[éayî]; 
	}
}

696 
I¡
 
	$gëNumRe‹dîPics
 (
UI¡
 
éayî
Ë{  
m_numRe‹dîPics
[éayî]; 
	}
}

697 
I¡
 
	$gëI¡øQPOff£t
 (Ëc⁄° {  
m_öåaQPOff£t
; 
	}
}

698 
I¡
 
	$gëLambdaFromQPE«bÀ
 (Ëc⁄° {  
m_œmbdaFromQPE«bÀ
; 
	}
}

699 
	g¥Ÿe˘ed
:

700 
I¡
 
	$gëBa£QP
 (Ëc⁄° {  
m_iQP
; 
	}
}

701 
	gpublic
:

702 
I¡
 
	$gëQPF‹Pi˘uª
 (c⁄° 
UI¡
 
g›Index
, c⁄° 
TComSli˚
 *
pSli˚
) const;

703 
I¡
 
	$gëPad
 ( 
I¡
 
i
 ) { 
	`as£π
 (ò< 2 );  
m_aiPad
[i]; 
	}
}

705 
Boﬁ
 
	$gëAc˚ssUnôDñimôî
(Ëc⁄° {  
m_Ac˚ssUnôDñimôî
; 
	}
}

706 
Void
 
	$£tAc˚ssUnôDñimôî
(
Boﬁ
 
vÆ
){ 
m_Ac˚ssUnôDñimôî
 = vÆ; 
	}
}

709 
UI¡
 
	$gëQuadåìTULog2MaxSize
 (Ëc⁄° {  
m_uiQuadåìTULog2MaxSize
; 
	}
}

710 
UI¡
 
	$gëQuadåìTULog2MöSize
 (Ëc⁄° {  
m_uiQuadåìTULog2MöSize
; 
	}
}

711 
UI¡
 
	$gëQuadåìTUMaxDïthI¡î
 (Ëc⁄° {  
m_uiQuadåìTUMaxDïthI¡î
; 
	}
}

712 
UI¡
 
	$gëQuadåìTUMaxDïthI¡ø
 (Ëc⁄° {  
m_uiQuadåìTUMaxDïthI¡ø
; 
	}
}

715 
Boﬁ
 
	$gëLo›FûãrDißbÀ
 (Ë{  
m_bLo›FûãrDißbÀ
; 
	}
}

716 
Boﬁ
 
	$gëLo›FûãrOff£tInPPS
 (Ë{  
m_lo›FûãrOff£tInPPS
; 
	}
}

717 
I¡
 
	$gëLo›FûãrBëaOff£t
 (Ë{  
m_lo›FûãrBëaOff£tDiv2
; 
	}
}

718 
I¡
 
	$gëLo›FûãrTcOff£t
 (Ë{  
m_lo›FûãrTcOff£tDiv2
; 
	}
}

719 
I¡
 
	$gëDeblockögFûãrMëric
 (Ë{  
m_deblockögFûãrMëric
; 
	}
}

722 
Boﬁ
 
	$gëDißbÀI¡øPUsInI¡îSli˚s
 (Ëc⁄° {  
m_bDißbÀI¡øPUsInI¡îSli˚s
; 
	}
}

723 
MESórchMëhod
 
	$gëMŸi⁄E°im©i⁄SórchMëhod
 ( ) c⁄° {  
m_mŸi⁄E°im©i⁄SórchMëhod
; 
	}
}

724 
I¡
 
	$gëSórchR™ge
 (Ëc⁄° {  
m_iSórchR™ge
; 
	}
}

725 
Boﬁ
 
	$gëClùF‹BiPªdMeE«bÀd
 (Ëc⁄° {  
m_bClùF‹BiPªdMeE«bÀd
; 
	}
}

726 
Boﬁ
 
	$gëFa°MEAssumögSmoŸhîMVE«bÀd
 (Ëc⁄° {  
m_bFa°MEAssumögSmoŸhîMVE«bÀd
; 
	}
}

727 
I¡
 
	$gëMöSórchWödow
 (Ëc⁄° {  
m_möSórchWödow
; 
	}
}

728 
Boﬁ
 
	$gëRe°ri˘MESam∂ög
 (Ëc⁄° {  
m_bRe°ri˘MESam∂ög
; 
	}
}

731 
I¡
 
	$gëMaxDñèQP
 (Ëc⁄° {  
m_iMaxDñèQP
; 
	}
}

732 
I¡
 
	$gëMaxCuDQPDïth
 (Ëc⁄° {  
m_iMaxCuDQPDïth
; 
	}
}

733 
Boﬁ
 
	$gëU£Ad≠tiveQP
 (Ëc⁄° {  
m_bU£Ad≠tiveQP
; 
	}
}

734 
I¡
 
	$gëQPAd≠èti⁄R™ge
 (Ëc⁄° {  
m_iQPAd≠èti⁄R™ge
; 
	}
}

737 
Void
 
	$£tBôDïth
–c⁄° 
Ch™√lTy≥
 
chTy≥
, 
I¡
 
öã∫ÆBôDïthF‹Ch™√l
 ) { 
m_bôDïth
[chTy≥] = i¡î«lBôDïthF‹Ch™√l; 
	}
}

738 
Void
 
	$£tU£ASR
 ( 
Boﬁ
 
b
 ) { 
m_bU£ASR
 = b; 
	}
}

739 
Void
 
	$£tU£HADME
 ( 
Boﬁ
 
b
 ) { 
m_bU£HADME
 = b; 
	}
}

740 
Void
 
	$£tU£RDOQ
 ( 
Boﬁ
 
b
 ) { 
m_u£RDOQ
 = b; 
	}
}

741 
Void
 
	$£tU£RDOQTS
 ( 
Boﬁ
 
b
 ) { 
m_u£RDOQTS
 = b; 
	}
}

742 
Void
 
	$£tU£Sñe˘iveRDOQ
 ( 
Boﬁ
 
b
 ) { 
m_u£Sñe˘iveRDOQ
 = b; 
	}
}

743 
Void
 
	$£tRD≥«…y
 ( 
UI¡
 
u
 ) { 
m_rdPíÆty
 = u; 
	}
}

744 
Void
 
	$£tFa°I¡îSórchMode
 ( 
Fa°I¡îSórchMode
 
m
 ) { 
m_Á°I¡îSórchMode
 = m; 
	}
}

745 
Void
 
	$£tU£E¨lyCU
 ( 
Boﬁ
 
b
 ) { 
m_bU£E¨lyCU
 = b; 
	}
}

746 
Void
 
	$£tU£Fa°Decisi⁄F‹Mîge
 ( 
Boﬁ
 
b
 ) { 
m_u£Fa°Decisi⁄F‹Mîge
 = b; 
	}
}

747 
Void
 
	$£tU£CbfFa°Mode
 ( 
Boﬁ
 
b
 ) { 
m_bU£CbfFa°Mode
 = b; 
	}
}

748 
Void
 
	$£tU£E¨lySkùDëe˘i⁄
 ( 
Boﬁ
 
b
 ) { 
m_u£E¨lySkùDëe˘i⁄
 = b; 
	}
}

749 
Void
 
	$£tU£C⁄°øöedI¡øPªd
 ( 
Boﬁ
 
b
 ) { 
m_bU£C⁄°øöedI¡øPªd
 = b; 
	}
}

750 
Void
 
	$£tFa°UDIU£MPME«bÀd
 ( 
Boﬁ
 
b
 ) { 
m_bFa°UDIU£MPME«bÀd
 = b; 
	}
}

751 
Void
 
	$£tFa°MEF‹GíBLowDñayE«bÀd
 ( 
Boﬁ
 
b
 ) { 
m_bFa°MEF‹GíBLowDñayE«bÀd
 = b; 
	}
}

752 
Void
 
	$£tU£BLambdaF‹N⁄KeyLowDñayPi˘uªs
 ( 
Boﬁ
 
b
 ) { 
m_bU£BLambdaF‹N⁄KeyLowDñayPi˘uªs
 = b; 
	}
}

754 
Void
 
	$£tPCMI≈utBôDïthFœg
 ( 
Boﬁ
 
b
 ) { 
m_bPCMI≈utBôDïthFœg
 = b; 
	}
}

755 
Void
 
	$£tPCMFûãrDißbÀFœg
 ( 
Boﬁ
 
b
 ) { 
m_bPCMFûãrDißbÀFœg
 = b; 
	}
}

756 
Void
 
	$£tU£PCM
 ( 
Boﬁ
 
b
 ) { 
m_u£PCM
 = b; 
	}
}

757 
Void
 
	$£tPCMBôDïth
–c⁄° 
Ch™√lTy≥
 
chTy≥
, 
I¡
 
pcmBôDïthF‹Ch™√l
 ) { 
m_PCMBôDïth
[chTy≥] =ÖcmBôDïthF‹Ch™√l; 
	}
}

758 
Void
 
	$£tPCMLog2MaxSize
 ( 
UI¡
 
u
 ) { 
m_pcmLog2MaxSize
 = u; 
	}
}

759 
Void
 
	$£tPCMLog2MöSize
 ( 
UI¡
 
u
 ) { 
m_uiPCMLog2MöSize
 = u; 
	}
}

760 
Void
 
	$£tdQPs
 ( 
I¡
* 
p
 ) { 
m_aidQP
 =Ö; 
	}
}

761 
Void
 
	$£tDñèQpRD
 ( 
UI¡
 
u
 ) {
m_uiDñèQpRD
 = u; 
	}
}

762 
Void
 
	$£tFa°DñèQp
 ( 
Boﬁ
 
b
 ) {
m_bFa°DñèQP
 = b; 
	}
}

763 
Boﬁ
 
	$gëU£ASR
 (Ë{  
m_bU£ASR
; 
	}
}

764 
Boﬁ
 
	$gëU£HADME
 (Ë{  
m_bU£HADME
; 
	}
}

765 
Boﬁ
 
	$gëU£RDOQ
 (Ë{  
m_u£RDOQ
; 
	}
}

766 
Boﬁ
 
	$gëU£RDOQTS
 (Ë{  
m_u£RDOQTS
; 
	}
}

767 
Boﬁ
 
	$gëU£Sñe˘iveRDOQ
 (Ë{  
m_u£Sñe˘iveRDOQ
; 
	}
}

768 
I¡
 
	$gëRD≥«…y
 (Ë{  
m_rdPíÆty
; 
	}
}

769 
Fa°I¡îSórchMode
 
	$gëFa°I¡îSórchMode
(Ëc⁄°{  
m_Á°I¡îSórchMode
; 
	}
}

770 
Boﬁ
 
	$gëU£E¨lyCU
 (Ë{  
m_bU£E¨lyCU
; 
	}
}

771 
Boﬁ
 
	$gëU£Fa°Decisi⁄F‹Mîge
 (Ë{  
m_u£Fa°Decisi⁄F‹Mîge
; 
	}
}

772 
Boﬁ
 
	$gëU£CbfFa°Mode
 (Ë{  
m_bU£CbfFa°Mode
; 
	}
}

773 
Boﬁ
 
	$gëU£E¨lySkùDëe˘i⁄
 (Ë{  
m_u£E¨lySkùDëe˘i⁄
; 
	}
}

774 
Boﬁ
 
	$gëU£C⁄°øöedI¡øPªd
 (Ë{  
m_bU£C⁄°øöedI¡øPªd
; 
	}
}

775 
Boﬁ
 
	$gëFa°UDIU£MPME«bÀd
 (Ë{  
m_bFa°UDIU£MPME«bÀd
; 
	}
}

776 
Boﬁ
 
	$gëFa°MEF‹GíBLowDñayE«bÀd
 (Ë{  
m_bFa°MEF‹GíBLowDñayE«bÀd
; 
	}
}

777 
Boﬁ
 
	$gëU£BLambdaF‹N⁄KeyLowDñayPi˘uªs
 (Ë{  
m_bU£BLambdaF‹N⁄KeyLowDñayPi˘uªs
; 
	}
}

778 
Boﬁ
 
	$gëPCMI≈utBôDïthFœg
 (Ë{  
m_bPCMI≈utBôDïthFœg
; 
	}
}

779 
Boﬁ
 
	$gëPCMFûãrDißbÀFœg
 (Ë{  
m_bPCMFûãrDißbÀFœg
; 
	}
}

780 
Boﬁ
 
	$gëU£PCM
 (Ë{  
m_u£PCM
; 
	}
}

781 
UI¡
 
	$gëPCMLog2MaxSize
 (Ë{  
m_pcmLog2MaxSize
; 
	}
}

782 
UI¡
 
	$gëPCMLog2MöSize
 (Ë{  
m_uiPCMLog2MöSize
; 
	}
}

784 
Boﬁ
 
	$gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
 (Ëc⁄° {  
m_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
; 
	}
}

785 
Void
 
	$£tCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
 (c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
 = vÆue; 
	}
}

786 
Boﬁ
 
	$gëU£Rec⁄Ba£dCrossCPªdi˘i⁄E°im©e
 (Ëc⁄° {  
m_ªc⁄Ba£dCrossCPªdi˘i⁄E°im©e
; 
	}
}

787 
Void
 
	$£tU£Rec⁄Ba£dCrossCPªdi˘i⁄E°im©e
 (c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_ªc⁄Ba£dCrossCPªdi˘i⁄E°im©e
 = vÆue; 
	}
}

788 
Void
 
	$£tLog2SaoOff£tSˇÀ
(
Ch™√lTy≥
 
ty≥
, 
UI¡
 
uiBôShi·
Ë{ 
m_log2SaoOff£tSˇÀ
[ty≥] = uiBôShi·; 
	}
}

790 
Boﬁ
 
	$gëU£Tønsf‹mSkù
 (Ë{  
m_u£Tønsf‹mSkù
; 
	}
}

791 
Void
 
	$£tU£Tønsf‹mSkù
 ( 
Boﬁ
 
b
 ) { 
m_u£Tønsf‹mSkù
 = b; 
	}
}

792 
Boﬁ
 
	$gëTønsf‹mSkùRŸ©i⁄E«bÀdFœg
 (Ëc⁄° {  
m_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
; 
	}
}

793 
Void
 
	$£tTønsf‹mSkùRŸ©i⁄E«bÀdFœg
 (c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
 = vÆue; 
	}
}

794 
Boﬁ
 
	$gëTønsf‹mSkùC⁄ãxtE«bÀdFœg
 (Ëc⁄° {  
m_å™sf‹mSkùC⁄ãxtE«bÀdFœg
; 
	}
}

795 
Void
 
	$£tTønsf‹mSkùC⁄ãxtE«bÀdFœg
 (c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_å™sf‹mSkùC⁄ãxtE«bÀdFœg
 = vÆue; 
	}
}

796 
Boﬁ
 
	$gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
 (Ëc⁄° {  
m_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
; 
	}
}

797 
Void
 
	$£tPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
 (c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
 = vÆue; 
	}
}

798 
Boﬁ
 
	$gëCabacBy∑ssAlignmítE«bÀdFœg
 (Ëc⁄° {  
m_ˇbacBy∑ssAlignmítE«bÀdFœg
; 
	}
}

799 
Void
 
	$£tCabacBy∑ssAlignmítE«bÀdFœg
 (c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_ˇbacBy∑ssAlignmítE«bÀdFœg
 = vÆue; 
	}
}

800 
Boﬁ
 
	$gëRdpcmE«bÀdFœg
 (c⁄° 
RDPCMSig«ŒögMode
 
sig«ŒögMode
Ëc⁄° {  
m_rdpcmE«bÀdFœg
[sig«ŒögMode]; 
	}
}

801 
Void
 
	$£tRdpcmE«bÀdFœg
 (c⁄° 
RDPCMSig«ŒögMode
 
sig«ŒögMode
, c⁄° 
Boﬁ
 
vÆue
Ë{ 
m_rdpcmE«bÀdFœg
[sig«ŒögMode] = vÆue; 
	}
}

802 
Boﬁ
 
	$gëU£Tønsf‹mSkùFa°
 (Ë{  
m_u£Tønsf‹mSkùFa°
; 
	}
}

803 
Void
 
	$£tU£Tønsf‹mSkùFa°
 ( 
Boﬁ
 
b
 ) { 
m_u£Tønsf‹mSkùFa°
 = b; 
	}
}

804 
UI¡
 
	$gëLog2MaxTønsf‹mSkùBlockSize
 (Ëc⁄° {  
m_log2MaxTønsf‹mSkùBlockSize
; 
	}
}

805 
Void
 
	$£tLog2MaxTønsf‹mSkùBlockSize
 ( 
UI¡
 
u
 ) { 
m_log2MaxTønsf‹mSkùBlockSize
 = u; 
	}
}

806 
Boﬁ
 
	$gëI¡øSmoŸhögDißbÀdFœg
 (Ëc⁄° {  
m_öåaSmoŸhögDißbÀdFœg
; 
	}
}

807 
Void
 
	$£tI¡øSmoŸhögDißbÀdFœg
 (
Boﬁ
 
bVÆue
Ë{ 
m_öåaSmoŸhögDißbÀdFœg
=bVÆue; 
	}
}

809 c⁄° 
I¡
* 
	$gëdQPs
 (Ëc⁄° {  
m_aidQP
; 
	}
}

810 
UI¡
 
	$gëDñèQpRD
 (Ëc⁄° {  
m_uiDñèQpRD
; 
	}
}

811 
Boﬁ
 
	$gëFa°DñèQp
 (Ëc⁄° {  
m_bFa°DñèQP
; 
	}
}

814 
Void
 
	$£tSli˚Mode
 ( 
Sli˚C⁄°øöt
 
i
 ) { 
m_¶i˚Mode
 = i; 
	}
}

815 
Void
 
	$£tSli˚Argumít
 ( 
I¡
 
i
 ) { 
m_¶i˚Argumít
 = i; 
	}
}

816 
Sli˚C⁄°øöt
 
	$gëSli˚Mode
 (Ëc⁄° {  
m_¶i˚Mode
; 
	}
}

817 
I¡
 
	$gëSli˚Argumít
 (Ë{  
m_¶i˚Argumít
; 
	}
}

819 
Void
 
	$£tSli˚SegmítMode
 ( 
Sli˚C⁄°øöt
 
i
 ) { 
m_¶i˚SegmítMode
 = i; 
	}
}

820 
Void
 
	$£tSli˚SegmítArgumít
 ( 
I¡
 
i
 ) { 
m_¶i˚SegmítArgumít
 = i; 
	}
}

821 
Sli˚C⁄°øöt
 
	$gëSli˚SegmítMode
 (Ëc⁄° {  
m_¶i˚SegmítMode
; 
	}
}

822 
I¡
 
	$gëSli˚SegmítArgumít
 (Ë{  
m_¶i˚SegmítArgumít
;
	}
}

823 
Void
 
	$£tLFCrossSli˚Bound¨yFœg
 ( 
Boﬁ
 
bVÆue
 ) { 
m_bLFCrossSli˚Bound¨yFœg
 = bVÆue; 
	}
}

824 
Boﬁ
 
	$gëLFCrossSli˚Bound¨yFœg
 (Ë{  
m_bLFCrossSli˚Bound¨yFœg
; 
	}
}

826 
Void
 
	$£tU£SAO
 (
Boﬁ
 
bVÆ
Ë{ 
m_bU£SAO
 = bVÆ; 
	}
}

827 
Boﬁ
 
	$gëU£SAO
 (Ë{  
m_bU£SAO
; 
	}
}

828 
Void
 
	$£tTe°SAODißbÀAtPi˘uªLevñ
 (
Boﬁ
 
bVÆ
Ë{ 
m_bTe°SAODißbÀAtPi˘uªLevñ
 = bVÆ; 
	}
}

829 
Boﬁ
 
	$gëTe°SAODißbÀAtPi˘uªLevñ
 ( ) c⁄° {  
m_bTe°SAODißbÀAtPi˘uªLevñ
; 
	}
}

831 
Void
 
	$£tSaoEncodögR©e
(
DoubÀ
 
v
Ë{ 
m_ßoEncodögR©e
 = v; 
	}
}

832 
DoubÀ
 
	$gëSaoEncodögR©e
(Ëc⁄° {  
m_ßoEncodögR©e
; 
	}
}

833 
Void
 
	$£tSaoEncodögR©eChroma
(
DoubÀ
 
v
Ë{ 
m_ßoEncodögR©eChroma
 = v; 
	}
}

834 
DoubÀ
 
	$gëSaoEncodögR©eChroma
(Ëc⁄° {  
m_ßoEncodögR©eChroma
; 
	}
}

835 
Void
 
	$£tMaxNumOff£tsPîPic
 (
I¡
 
iVÆ
Ë{ 
m_maxNumOff£tsPîPic
 = iVÆ; 
	}
}

836 
I¡
 
	$gëMaxNumOff£tsPîPic
 (Ë{  
m_maxNumOff£tsPîPic
; 
	}
}

837 
Void
 
	$£tSaoCtuBound¨y
 (
Boﬁ
 
vÆ
Ë{ 
m_ßoCtuBound¨y
 = vÆ; 
	}
}

838 
Boﬁ
 
	$gëSaoCtuBound¨y
 (Ë{  
m_ßoCtuBound¨y
; 
	}
}

839 
Void
 
	$£tRe£tEncodîSèãA·îIRAP
(
Boﬁ
 
b
Ë{ 
m_ª£tEncodîSèãA·îIRAP
 = b; 
	}
}

840 
Boﬁ
 
	$gëRe£tEncodîSèãA·îIRAP
(Ëc⁄° {  
m_ª£tEncodîSèãA·îIRAP
; 
	}
}

841 
Void
 
	$£tLFCrossTûeBound¨yFœg
 ( 
Boﬁ
 
vÆ
 ) { 
m_lo›FûãrA¸ossTûesE«bÀdFœg
 = vÆ; 
	}
}

842 
Boﬁ
 
	$gëLFCrossTûeBound¨yFœg
 (Ë{  
m_lo›FûãrA¸ossTûesE«bÀdFœg
; 
	}
}

843 
Void
 
	$£tTûeUnif‹mS∑cögFœg
 ( 
Boﬁ
 
b
 ) { 
m_tûeUnif‹mS∑cögFœg
 = b; 
	}
}

844 
Boﬁ
 
	$gëTûeUnif‹mS∑cögFœg
 (Ë{  
m_tûeUnif‹mS∑cögFœg
; 
	}
}

845 
Void
 
	$£tNumCﬁumnsMöus1
 ( 
I¡
 
i
 ) { 
m_iNumCﬁumnsMöus1
 = i; 
	}
}

846 
I¡
 
	$gëNumCﬁumnsMöus1
 (Ë{  
m_iNumCﬁumnsMöus1
; 
	}
}

847 
Void
 
£tCﬁumnWidth
 ( c⁄° 
°d
::
ve˘‹
<
I¡
>& 
cﬁumnWidth
 ) { 
m_tûeCﬁumnWidth
 = columnWidth; }

848 
UI¡
 
	$gëCﬁumnWidth
 ( 
UI¡
 
cﬁumnIdx
 ) {  
m_tûeCﬁumnWidth
[cﬁumnIdx]; 
	}
}

849 
Void
 
	$£tNumRowsMöus1
 ( 
I¡
 
i
 ) { 
m_iNumRowsMöus1
 = i; 
	}
}

850 
I¡
 
	$gëNumRowsMöus1
 (Ë{  
m_iNumRowsMöus1
; 
	}
}

851 
Void
 
£tRowHeight
 ( c⁄° 
°d
::
ve˘‹
<
I¡
>& 
rowHeight
Ë{ 
m_tûeRowHeight
 =ÑowHeight; }

852 
UI¡
 
	$gëRowHeight
 ( 
UI¡
 
rowIdx
 ) {  
m_tûeRowHeight
[rowIdx]; 
	}
}

853 
Void
 
xCheckGSP¨amëîs
();

854 
Void
 
	$£tE¡r›yCodögSyncE«bÀdFœg
(
Boﬁ
 
b
Ë{ 
m_íå›yCodögSyncE«bÀdFœg
 = b; 
	}
}

855 
Boﬁ
 
	$gëE¡r›yCodögSyncE«bÀdFœg
(Ëc⁄° {  
m_íå›yCodögSyncE«bÀdFœg
; 
	}
}

856 
Void
 
	$£tDecodedPi˘uªHashSEITy≥
(
HashTy≥
 
m
Ë{ 
m_decodedPi˘uªHashSEITy≥
 = m; 
	}
}

857 
HashTy≥
 
	$gëDecodedPi˘uªHashSEITy≥
(Ëc⁄° {  
m_decodedPi˘uªHashSEITy≥
; 
	}
}

858 
Void
 
	$£tBuf„rögPîiodSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_buf„rögPîiodSEIE«bÀd
 = b; 
	}
}

859 
Boﬁ
 
	$gëBuf„rögPîiodSEIE«bÀd
(Ëc⁄° {  
m_buf„rögPîiodSEIE«bÀd
; 
	}
}

860 
Void
 
	$£tPi˘uªTimögSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_pi˘uªTimögSEIE«bÀd
 = b; 
	}
}

861 
Boﬁ
 
	$gëPi˘uªTimögSEIE«bÀd
(Ëc⁄° {  
m_pi˘uªTimögSEIE«bÀd
; 
	}
}

862 
Void
 
	$£tRecovîyPoötSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_ªcovîyPoötSEIE«bÀd
 = b; 
	}
}

863 
Boﬁ
 
	$gëRecovîyPoötSEIE«bÀd
(Ëc⁄° {  
m_ªcovîyPoötSEIE«bÀd
; 
	}
}

864 
Void
 
	$£tT⁄eM≠pögInfoSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_t⁄eM≠pögInfoSEIE«bÀd
 = b; 
	}
}

865 
Boﬁ
 
	$gëT⁄eM≠pögInfoSEIE«bÀd
(Ë{  
m_t⁄eM≠pögInfoSEIE«bÀd
; 
	}
}

866 
Void
 
	$£tTMISEIT⁄eM≠Id
(
I¡
 
b
Ë{ 
m_t⁄eM≠Id
 = b; 
	}
}

867 
I¡
 
	$gëTMISEIT⁄eM≠Id
(Ë{  
m_t⁄eM≠Id
; 
	}
}

868 
Void
 
	$£tTMISEIT⁄eM≠C™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_t⁄eM≠C™˚lFœg
=b; 
	}
}

869 
Boﬁ
 
	$gëTMISEIT⁄eM≠C™˚lFœg
(Ë{  
m_t⁄eM≠C™˚lFœg
; 
	}
}

870 
Void
 
	$£tTMISEIT⁄eM≠Pîsi°í˚Fœg
(
Boﬁ
 
b
Ë{ 
m_t⁄eM≠Pîsi°í˚Fœg
 = b; 
	}
}

871 
Boﬁ
 
	$gëTMISEIT⁄eM≠Pîsi°í˚Fœg
(Ë{  
m_t⁄eM≠Pîsi°í˚Fœg
; 
	}
}

872 
Void
 
	$£tTMISEICodedD©aBôDïth
(
I¡
 
b
Ë{ 
m_codedD©aBôDïth
 = b; 
	}
}

873 
I¡
 
	$gëTMISEICodedD©aBôDïth
(Ë{  
m_codedD©aBôDïth
; 
	}
}

874 
Void
 
	$£tTMISEIT¨gëBôDïth
(
I¡
 
b
Ë{ 
m_èrgëBôDïth
 = b; 
	}
}

875 
I¡
 
	$gëTMISEIT¨gëBôDïth
(Ë{  
m_èrgëBôDïth
; 
	}
}

876 
Void
 
	$£tTMISEIModñID
(
I¡
 
b
Ë{ 
m_modñId
 = b; 
	}
}

877 
I¡
 
	$gëTMISEIModñID
(Ë{  
m_modñId
; 
	}
}

878 
Void
 
	$£tTMISEIMöVÆue
(
I¡
 
b
Ë{ 
m_möVÆue
 = b; 
	}
}

879 
I¡
 
	$gëTMISEIMöVÆue
(Ë{  
m_möVÆue
; 
	}
}

880 
Void
 
	$£tTMISEIMaxVÆue
(
I¡
 
b
Ë{ 
m_maxVÆue
 = b; 
	}
}

881 
I¡
 
	$gëTMISEIMaxVÆue
(Ë{  
m_maxVÆue
; 
	}
}

882 
Void
 
	$£tTMISEISigmoidMidpoöt
(
I¡
 
b
Ë{ 
m_sigmoidMidpoöt
 = b; 
	}
}

883 
I¡
 
	$gëTMISEISigmoidMidpoöt
(Ë{  
m_sigmoidMidpoöt
; 
	}
}

884 
Void
 
	$£tTMISEISigmoidWidth
(
I¡
 
b
Ë{ 
m_sigmoidWidth
 = b; 
	}
}

885 
I¡
 
	$gëTMISEISigmoidWidth
(Ë{  
m_sigmoidWidth
; 
	}
}

886 
Void
 
	$£tTMISEISèπOfCodedI¡îva
–
I¡
* 
p
 ) { 
m_°¨tOfCodedI¡îvÆ
 =Ö; 
	}
}

887 
I¡
* 
	$gëTMISEISèπOfCodedI¡îva
(Ë{  
m_°¨tOfCodedI¡îvÆ
; 
	}
}

888 
Void
 
	$£tTMISEINumPivŸs
(
I¡
 
b
Ë{ 
m_numPivŸs
 = b; 
	}
}

889 
I¡
 
	$gëTMISEINumPivŸs
(Ë{  
m_numPivŸs
; 
	}
}

890 
Void
 
	$£tTMISEICodedPivŸVÆue
–
I¡
* 
p
 ) { 
m_codedPivŸVÆue
 =Ö; 
	}
}

891 
I¡
* 
	$gëTMISEICodedPivŸVÆue
(Ë{  
m_codedPivŸVÆue
; 
	}
}

892 
Void
 
	$£tTMISEIT¨gëPivŸVÆue
–
I¡
* 
p
 ) { 
m_èrgëPivŸVÆue
 =Ö; 
	}
}

893 
I¡
* 
	$gëTMISEIT¨gëPivŸVÆue
(Ë{  
m_èrgëPivŸVÆue
; 
	}
}

894 
Void
 
	$£tTMISEICamîaIsoS≥edIdc
(
I¡
 
b
Ë{ 
m_ˇmîaIsoS≥edIdc
 = b; 
	}
}

895 
I¡
 
	$gëTMISEICamîaIsoS≥edIdc
(Ë{  
m_ˇmîaIsoS≥edIdc
; 
	}
}

896 
Void
 
	$£tTMISEICamîaIsoS≥edVÆue
(
I¡
 
b
Ë{ 
m_ˇmîaIsoS≥edVÆue
 = b; 
	}
}

897 
I¡
 
	$gëTMISEICamîaIsoS≥edVÆue
(Ë{  
m_ˇmîaIsoS≥edVÆue
; 
	}
}

898 
Void
 
	$£tTMISEIExposuªIndexIdc
(
I¡
 
b
Ë{ 
m_exposuªIndexIdc
 = b; 
	}
}

899 
I¡
 
	$gëTMISEIExposurIndexIdc
(Ë{  
m_exposuªIndexIdc
; 
	}
}

900 
Void
 
	$£tTMISEIExposuªIndexVÆue
(
I¡
 
b
Ë{ 
m_exposuªIndexVÆue
 = b; 
	}
}

901 
I¡
 
	$gëTMISEIExposurIndexVÆue
(Ë{  
m_exposuªIndexVÆue
; 
	}
}

902 
Void
 
	$£tTMISEIExposuªCom≥nßti⁄VÆueSignFœg
(
Boﬁ
 
b
Ë{ 
m_exposuªCom≥nßti⁄VÆueSignFœg
 = b; 
	}
}

903 
Boﬁ
 
	$gëTMISEIExposuªCom≥nßti⁄VÆueSignFœg
(Ë{  
m_exposuªCom≥nßti⁄VÆueSignFœg
; 
	}
}

904 
Void
 
	$£tTMISEIExposuªCom≥nßti⁄VÆueNumî©‹
(
I¡
 
b
Ë{ 
m_exposuªCom≥nßti⁄VÆueNumî©‹
 = b; 
	}
}

905 
I¡
 
	$gëTMISEIExposuªCom≥nßti⁄VÆueNumî©‹
(Ë{  
m_exposuªCom≥nßti⁄VÆueNumî©‹
; 
	}
}

906 
Void
 
	$£tTMISEIExposuªCom≥nßti⁄VÆueDíomIdc
(
I¡
 
b
Ë{ 
m_exposuªCom≥nßti⁄VÆueDíomIdc
 =b; 
	}
}

907 
I¡
 
	$gëTMISEIExposuªCom≥nßti⁄VÆueDíomIdc
(Ë{  
m_exposuªCom≥nßti⁄VÆueDíomIdc
; 
	}
}

908 
Void
 
	$£tTMISEIRefS¸ìnLumö™˚Whôe
(
I¡
 
b
Ë{ 
m_ªfS¸ìnLumö™˚Whôe
 = b; 
	}
}

909 
I¡
 
	$gëTMISEIRefS¸ìnLumö™˚Whôe
(Ë{  
m_ªfS¸ìnLumö™˚Whôe
; 
	}
}

910 
Void
 
	$£tTMISEIExãndedR™geWhôeLevñ
(
I¡
 
b
Ë{ 
m_exãndedR™geWhôeLevñ
 = b; 
	}
}

911 
I¡
 
	$gëTMISEIExãndedR™geWhôeLevñ
(Ë{  
m_exãndedR™geWhôeLevñ
; 
	}
}

912 
Void
 
	$£tTMISEINomöÆBœckLevñLumaCodeVÆue
(
I¡
 
b
Ë{ 
m_nomöÆBœckLevñLumaCodeVÆue
 = b; 
	}
}

913 
I¡
 
	$gëTMISEINomöÆBœckLevñLumaCodeVÆue
(Ë{  
m_nomöÆBœckLevñLumaCodeVÆue
; 
	}
}

914 
Void
 
	$£tTMISEINomöÆWhôeLevñLumaCodeVÆue
(
I¡
 
b
Ë{ 
m_nomöÆWhôeLevñLumaCodeVÆue
 = b; 
	}
}

915 
I¡
 
	$gëTMISEINomöÆWhôeLevñLumaCodeVÆue
(Ë{  
m_nomöÆWhôeLevñLumaCodeVÆue
; 
	}
}

916 
Void
 
	$£tTMISEIExãndedWhôeLevñLumaCodeVÆue
(
I¡
 
b
Ë{ 
m_exãndedWhôeLevñLumaCodeVÆue
 =b; 
	}
}

917 
I¡
 
	$gëTMISEIExãndedWhôeLevñLumaCodeVÆue
(Ë{  
m_exãndedWhôeLevñLumaCodeVÆue
; 
	}
}

918 
Void
 
	$£tFømePackögAº™gemítSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_‰amePackögSEIE«bÀd
 = b; 
	}
}

919 
Boﬁ
 
	$gëFømePackögAº™gemítSEIE«bÀd
(Ëc⁄° {  
m_‰amePackögSEIE«bÀd
; 
	}
}

920 
Void
 
	$£tFømePackögAº™gemítSEITy≥
(
I¡
 
b
Ë{ 
m_‰amePackögSEITy≥
 = b; 
	}
}

921 
I¡
 
	$gëFømePackögAº™gemítSEITy≥
(Ë{  
m_‰amePackögSEITy≥
; 
	}
}

922 
Void
 
	$£tFømePackögAº™gemítSEIId
(
I¡
 
b
Ë{ 
m_‰amePackögSEIId
 = b; 
	}
}

923 
I¡
 
	$gëFømePackögAº™gemítSEIId
(Ë{  
m_‰amePackögSEIId
; 
	}
}

924 
Void
 
	$£tFømePackögAº™gemítSEIQuöcunx
(
I¡
 
b
Ë{ 
m_‰amePackögSEIQuöcunx
 = b; 
	}
}

925 
I¡
 
	$gëFømePackögAº™gemítSEIQuöcunx
(Ë{  
m_‰amePackögSEIQuöcunx
; 
	}
}

926 
Void
 
	$£tFømePackögAº™gemítSEII¡î¥ë©i⁄
(
I¡
 
b
Ë{ 
m_‰amePackögSEII¡î¥ë©i⁄
 = b; 
	}
}

927 
I¡
 
	$gëFømePackögAº™gemítSEII¡î¥ë©i⁄
(Ë{  
m_‰amePackögSEII¡î¥ë©i⁄
; 
	}
}

928 
Void
 
	$£tSegmíãdRe˘FømePackögAº™gemítSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_£gmíãdRe˘FømePackögSEIE«bÀd
 = b; 
	}
}

929 
Boﬁ
 
	$gëSegmíãdRe˘FømePackögAº™gemítSEIE«bÀd
(Ëc⁄° {  
m_£gmíãdRe˘FømePackögSEIE«bÀd
; 
	}
}

930 
Void
 
	$£tSegmíãdRe˘FømePackögAº™gemítSEIC™˚l
(
I¡
 
b
Ë{ 
m_£gmíãdRe˘FømePackögSEIC™˚l
 = b; 
	}
}

931 
I¡
 
	$gëSegmíãdRe˘FømePackögAº™gemítSEIC™˚l
(Ë{  
m_£gmíãdRe˘FømePackögSEIC™˚l
; 
	}
}

932 
Void
 
	$£tSegmíãdRe˘FømePackögAº™gemítSEITy≥
(
I¡
 
b
Ë{ 
m_£gmíãdRe˘FømePackögSEITy≥
 = b; 
	}
}

933 
I¡
 
	$gëSegmíãdRe˘FømePackögAº™gemítSEITy≥
(Ë{  
m_£gmíãdRe˘FømePackögSEITy≥
; 
	}
}

934 
Void
 
	$£tSegmíãdRe˘FømePackögAº™gemítSEIPîsi°í˚
(
I¡
 
b
Ë{ 
m_£gmíãdRe˘FømePackögSEIPîsi°í˚
 = b; 
	}
}

935 
I¡
 
	$gëSegmíãdRe˘FømePackögAº™gemítSEIPîsi°í˚
(Ë{  
m_£gmíãdRe˘FømePackögSEIPîsi°í˚
; 
	}
}

936 
Void
 
	$£tDi•œyOrõ¡©i⁄SEIAngÀ
(
I¡
 
b
Ë{ 
m_di•œyOrõ¡©i⁄SEIAngÀ
 = b; 
	}
}

937 
I¡
 
	$gëDi•œyOrõ¡©i⁄SEIAngÀ
(Ë{  
m_di•œyOrõ¡©i⁄SEIAngÀ
; 
	}
}

938 
Void
 
	$£tTemp‹ÆLevñ0IndexSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_ãmp‹ÆLevñ0IndexSEIE«bÀd
 = b; 
	}
}

939 
Boﬁ
 
	$gëTemp‹ÆLevñ0IndexSEIE«bÀd
(Ëc⁄° {  
m_ãmp‹ÆLevñ0IndexSEIE«bÀd
; 
	}
}

940 
Void
 
	$£tGøduÆDecodögRe‰eshInfoE«bÀd
(
Boﬁ
 
b
Ë{ 
m_gøduÆDecodögRe‰eshInfoE«bÀd
 = b; 
	}
}

941 
Boﬁ
 
	$gëGøduÆDecodögRe‰eshInfoE«bÀd
(Ëc⁄° {  
m_gøduÆDecodögRe‰eshInfoE«bÀd
; 
	}
}

942 
Void
 
	$£tNoDi•œySEITLayî
(
I¡
 
b
Ë{ 
m_noDi•œySEITLayî
 = b; 
	}
}

943 
I¡
 
	$gëNoDi•œySEITLayî
(Ë{  
m_noDi•œySEITLayî
; 
	}
}

944 
Void
 
	$£tDecodögUnôInfoSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_decodögUnôInfoSEIE«bÀd
 = b; 
	}
}

945 
Boﬁ
 
	$gëDecodögUnôInfoSEIE«bÀd
(Ëc⁄° {  
m_decodögUnôInfoSEIE«bÀd
; 
	}
}

946 
Void
 
	$£tSOPDes¸ùti⁄SEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_SOPDes¸ùti⁄SEIE«bÀd
 = b; 
	}
}

947 
Boﬁ
 
	$gëSOPDes¸ùti⁄SEIE«bÀd
(Ëc⁄° {  
m_SOPDes¸ùti⁄SEIE«bÀd
; 
	}
}

948 
Void
 
	$£tSˇœbÀNe°ögSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_sˇœbÀNe°ögSEIE«bÀd
 = b; 
	}
}

949 
Boﬁ
 
	$gëSˇœbÀNe°ögSEIE«bÀd
(Ëc⁄° {  
m_sˇœbÀNe°ögSEIE«bÀd
; 
	}
}

950 
Void
 
	$£tTMCTSSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_tm˘sSEIE«bÀd
 = b; 
	}
}

951 
Boﬁ
 
	$gëTMCTSSEIE«bÀd
(Ë{  
m_tm˘sSEIE«bÀd
; 
	}
}

952 #i‡
MCTS_ENC_CHECK


953 
Void
 
	$£tTMCTSSEITûeC⁄°øöt
(
Boﬁ
 
b
Ë{ 
m_tm˘sSEITûeC⁄°øöt
 = b; 
	}
}

954 
Boﬁ
 
	$gëTMCTSSEITûeC⁄°øöt
(Ë{  
m_tm˘sSEITûeC⁄°øöt
; 
	}
}

956 #i‡
MCTS_EXTRACTION


957 
Void
 
	$£tTMCTSExåa˘i⁄SEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_tm˘sExåa˘i⁄SEIE«bÀd
 = b; 
	}
}

958 
Boﬁ
 
	$gëTMCTSExåa˘i⁄SEIE«bÀd
(Ëc⁄° {  
m_tm˘sExåa˘i⁄SEIE«bÀd
; 
	}
}

960 
Void
 
	$£tTimeCodeSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_timeCodeSEIE«bÀd
 = b; 
	}
}

961 
Boﬁ
 
	$gëTimeCodeSEIE«bÀd
(Ë{  
m_timeCodeSEIE«bÀd
; 
	}
}

962 
Void
 
	$£tNumbîOfTimeSës
(
I¡
 
vÆue
Ë{ 
m_timeCodeSEINumTs
 = vÆue; 
	}
}

963 
I¡
 
	$gëNumbîOfTime£ts
(Ë{  
m_timeCodeSEINumTs
; 
	}
}

964 
Void
 
	$£tTimeSë
(
TComSEITimeSë
 
ñemít
, 
I¡
 
ödex
Ë{ 
m_timeSëAºay
[ödex] =ÉÀmít; 
	}
}

965 
	gTComSEITimeSë
 &
	$gëTimeSë
(
I¡
 
ödex
Ë{  
m_timeSëAºay
[ödex]; 
	}
}

966 c⁄° 
	gTComSEITimeSë
 &
	$gëTimeSë
(
I¡
 
ödex
Ëc⁄° {  
m_timeSëAºay
[ödex]; 
	}
}

967 
Void
 
	$£tK√eSEIE«bÀd
(
I¡
 
b
Ë{ 
m_k√eSEIE«bÀd
 = b; 
	}
}

968 
Boﬁ
 
	$gëK√eSEIE«bÀd
(Ë{  
m_k√eSEIE«bÀd
; 
	}
}

969 
Void
 
	$£tK√eFun˘i⁄Inf‹m©i⁄SEI
(c⁄° 
TEncSEIK√eFun˘i⁄Inf‹m©i⁄
 &
£ik√e
Ë{ 
m_k√eFun˘i⁄Inf‹m©i⁄SEI
 = seik√e; 
	}
}

970 c⁄° 
	gTEncSEIK√eFun˘i⁄Inf‹m©i⁄
 &
	$gëK√eFun˘i⁄Inf‹m©i⁄SEI
(Ëc⁄° {  
m_k√eFun˘i⁄Inf‹m©i⁄SEI
; 
	}
}

972 
Void
 
	$£tCcvSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_ccvSEIE«bÀd
 = b; 
	}
}

973 
Boﬁ
 
	$gëCcvSEIE«bÀd
(Ë{  
m_ccvSEIE«bÀd
; 
	}
}

974 
Void
 
	$£tCcvSEIC™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_ccvSEIC™˚lFœg
 = b; 
	}
}

975 
Boﬁ
 
	$gëCcvSEIC™˚lFœg
(Ë{  
m_ccvSEIC™˚lFœg
; 
	}
}

976 
Void
 
	$£tCcvSEIPîsi°í˚Fœg
(
Boﬁ
 
b
Ë{ 
m_ccvSEIPîsi°í˚Fœg
 = b; 
	}
}

977 
Boﬁ
 
	$gëCcvSEIPîsi°í˚Fœg
(Ë{  
m_ccvSEIPîsi°í˚Fœg
; 
	}
}

978 
Void
 
	$£tCcvSEIPrim¨õsPª£¡Fœg
(
Boﬁ
 
b
Ë{ 
m_ccvSEIPrim¨õsPª£¡Fœg
 = b; 
	}
}

979 
Boﬁ
 
	$gëCcvSEIPrim¨õsPª£¡Fœg
(Ë{  
m_ccvSEIPrim¨õsPª£¡Fœg
; 
	}
}

980 
Void
 
	$£tCcvSEIMöLumö™˚VÆuePª£¡Fœg
(
Boﬁ
 
b
Ë{ 
m_ccvSEIMöLumö™˚VÆuePª£¡Fœg
 = b; 
	}
}

981 
Boﬁ
 
	$gëCcvSEIMöLumö™˚VÆuePª£¡Fœg
(Ë{  
m_ccvSEIMöLumö™˚VÆuePª£¡Fœg
; 
	}
}

982 
Void
 
	$£tCcvSEIMaxLumö™˚VÆuePª£¡Fœg
(
Boﬁ
 
b
Ë{ 
m_ccvSEIMaxLumö™˚VÆuePª£¡Fœg
 = b; 
	}
}

983 
Boﬁ
 
	$gëCcvSEIMaxLumö™˚VÆuePª£¡Fœg
(Ë{  
m_ccvSEIMaxLumö™˚VÆuePª£¡Fœg
; 
	}
}

984 
Void
 
	$£tCcvSEIAvgLumö™˚VÆuePª£¡Fœg
(
Boﬁ
 
b
Ë{ 
m_ccvSEIAvgLumö™˚VÆuePª£¡Fœg
 = b; 
	}
}

985 
Boﬁ
 
	$gëCcvSEIAvgLumö™˚VÆuePª£¡Fœg
(Ë{  
m_ccvSEIAvgLumö™˚VÆuePª£¡Fœg
; 
	}
}

986 
Void
 
	$£tCcvSEIPrim¨õsX
(
DoubÀ
 
dVÆue
, 
I¡
 
ödex
Ë{ 
m_ccvSEIPrim¨õsX
[ödex] = dVÆue; 
	}
}

987 
DoubÀ
 
	$gëCcvSEIPrim¨õsX
(
I¡
 
ödex
Ë{  
m_ccvSEIPrim¨õsX
[ödex]; 
	}
}

988 
Void
 
	$£tCcvSEIPrim¨õsY
(
DoubÀ
 
dVÆue
, 
I¡
 
ödex
Ë{ 
m_ccvSEIPrim¨õsY
[ödex] = dVÆue; 
	}
}

989 
DoubÀ
 
	$gëCcvSEIPrim¨õsY
(
I¡
 
ödex
Ë{  
m_ccvSEIPrim¨õsY
[ödex]; 
	}
}

990 
Void
 
	$£tCcvSEIMöLumö™˚VÆue
 (
DoubÀ
 
dVÆue
Ë{ 
m_ccvSEIMöLumö™˚VÆue
 = dVÆue; 
	}
}

991 
DoubÀ
 
	$gëCcvSEIMöLumö™˚VÆue
 (Ë{  
m_ccvSEIMöLumö™˚VÆue
; 
	}
}

992 
Void
 
	$£tCcvSEIMaxLumö™˚VÆue
 (
DoubÀ
 
dVÆue
Ë{ 
m_ccvSEIMaxLumö™˚VÆue
 = dVÆue; 
	}
}

993 
DoubÀ
 
	$gëCcvSEIMaxLumö™˚VÆue
 (Ë{  
m_ccvSEIMaxLumö™˚VÆue
; 
	}
}

994 
Void
 
	$£tCcvSEIAvgLumö™˚VÆue
 (
DoubÀ
 
dVÆue
Ë{ 
m_ccvSEIAvgLumö™˚VÆue
 = dVÆue; 
	}
}

995 
DoubÀ
 
	$gëCcvSEIAvgLumö™˚VÆue
 (Ë{  
m_ccvSEIAvgLumö™˚VÆue
; 
	}
}

997 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


998 
Void
 
	$£tSiiSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_siiSEIE«bÀd
 = b; 
	}
}

999 
Boﬁ
 
	$gëSiiSEIE«bÀd
(Ë{  
m_siiSEIE«bÀd
; 
	}
}

1000 
Void
 
	$£tSiiSEINumUnôsInShuâîI¡îvÆ
(
UI¡
 
vÆue
Ë{ 
m_siiSEINumUnôsInShuâîI¡îvÆ
 = vÆue; 
	}
}

1001 
UI¡
 
	$gëSiiSEINumUnôsInShuâîI¡îvÆ
(Ë{  
m_siiSEINumUnôsInShuâîI¡îvÆ
; 
	}
}

1002 
Void
 
	$£tSiiSEITimeSˇÀ
(
UI¡
 
vÆue
Ë{ 
m_siiSEITimeSˇÀ
 = vÆue; 
	}
}

1003 
UI¡
 
	$gëSiiSEITimeSˇÀ
(Ë{  
m_siiSEITimeSˇÀ
; 
	}
}

1004 
UI¡
 
	$gëSiiSEIMaxSubLayîsMöus1
(Ë{  
	`UI¡
(
°d
::
	`max
(1u, UI¡(
m_siiSEISubLayîNumUnôsInSI
.
	`size
()))-1 ); 
	}
}

1005 
Boﬁ
 
	$gëSiiSEIFixedSIwôhöCLVS
(Ë{  
m_siiSEISubLayîNumUnôsInSI
.
	`em±y
(); 
	}
}

1006 
Void
 
£tSiiSEISubLayîNumUnôsInSI
(c⁄° 
°d
::
ve˘‹
<
UI¡
>& 
b
Ë{ 
m_siiSEISubLayîNumUnôsInSI
 = b; }

1007 
UI¡
 
	$gëSiiSEISubLayîNumUnôsInSI
(
UI¡
 
idx
Ëc⁄° {  
m_siiSEISubLayîNumUnôsInSI
[idx]; 
	}
}

1009 #i‡
SEI_ENCODER_CONTROL


1011 
Void
 
	$£tFûmGøöCh¨a˘î°icsSEIE«bÀd
 (
Boﬁ
 
b
Ë{ 
m_fgcSEIE«bÀd
 = b; 
	}
}

1012 
Boﬁ
 
	$gëFûmGøöCh¨a˘î°icsSEIE«bÀd
(Ë{  
m_fgcSEIE«bÀd
; 
	}
}

1013 
Void
 
	$£tFûmGøöCh¨a˘î°icsSEIC™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_fgcSEIC™˚lFœg
 = b; 
	}
}

1014 
Boﬁ
 
	$gëFûmGøöCh¨a˘î°icsSEIC™˚lFœg
(Ë{  
m_fgcSEIC™˚lFœg
; 
	}
}

1015 
Void
 
	$£tFûmGøöCh¨a˘î°icsSEIPîsi°í˚Fœg
(
Boﬁ
 
b
Ë{ 
m_fgcSEIPîsi°í˚Fœg
 = b; 
	}
}

1016 
Boﬁ
 
	$gëFûmGøöCh¨a˘î°icsSEIPîsi°í˚Fœg
(Ë{  
m_fgcSEIPîsi°í˚Fœg
; 
	}
}

1017 
Void
 
	$£tFûmGøöCh¨a˘î°icsSEIModñID
(
UCh¨
 
v
 ) { 
m_fgcSEIModñID
 = v; 
	}
}

1018 
UCh¨
 
	$gëFûmGøöCh¨a˘î°icsSEIModñID
(Ë{  
m_fgcSEIModñID
; 
	}
}

1019 
Void
 
	$£tFûmGøöCh¨a˘î°icsSEISïCﬁourDescPª£¡
(
Boﬁ
 
b
Ë{ 
m_fgcSEISïCﬁourDescPª£¡Fœg
 = b; 
	}
}

1020 
Boﬁ
 
	$gëFûmGøöCh¨a˘î°icsSEISïCﬁourDescPª£¡
(Ë{  
m_fgcSEISïCﬁourDescPª£¡Fœg
; 
	}
}

1021 
Void
 
	$£tFûmGøöCh¨a˘î°icsSEIBÀndögModeID
(
UCh¨
 
v
 ) { 
m_fgcSEIBÀndögModeID
 = v; 
	}
}

1022 
UCh¨
 
	$gëFûmGøöCh¨a˘î°icsSEIBÀndögModeID
(Ë{  
m_fgcSEIBÀndögModeID
; 
	}
}

1023 
Void
 
	$£tFûmGøöCh¨a˘î°icsSEILog2SˇÀFa˘‹
(
UCh¨
 
v
 ) { 
m_fgcSEILog2SˇÀFa˘‹
 = v; 
	}
}

1024 
UCh¨
 
	$gëFûmGøöCh¨a˘î°icsSEILog2SˇÀFa˘‹
(Ë{  
m_fgcSEILog2SˇÀFa˘‹
; 
	}
}

1025 
Void
 
	$£tFGCSEICompModñPª£¡
(
Boﬁ
 
b
, 
I¡
 
ödex
Ë{ 
m_fgcSEICompModñPª£¡
[ödex] = b; 
	}
}

1026 
Boﬁ
 
	$gëFGCSEICompModñPª£¡
(
I¡
 
ödex
Ë{  
m_fgcSEICompModñPª£¡
[ödex]; 
	}
}

1027 #i‡
FGS_RDD5_ENABLE


1028 
Void
 
	$£tFGCSEINumI¡ísôyI¡îvÆMöus1
(
UCh¨
 
v
, 
I¡
 
ödex
Ë{ 
m_fgcSEINumI¡ísôyI¡îvÆMöus1
[ödex] = v; 
	}
}

1029 
UCh¨
 
	$gëFGCSEINumI¡ísôyI¡îvÆMöus1
(
I¡
 
ödex
Ë{  
m_fgcSEINumI¡ísôyI¡îvÆMöus1
[ödex]; 
	}
}

1030 
Void
 
	$£tFGCSEINumModñVÆuesMöus1
(
UCh¨
 
v
, 
I¡
 
ödex
Ë{ 
m_fgcSEINumModñVÆuesMöus1
[ödex] = v; 
	}
}

1031 
UCh¨
 
	$gëFGCSEINumModñVÆuesMöus1
(
I¡
 
ödex
Ë{  
m_fgcSEINumModñVÆuesMöus1
[ödex]; 
	}
}

1032 
Void
 
	$£tFGCSEII¡ísôyI¡îvÆLowîBound
(
UCh¨
 
v
, 
I¡
 
ödex
, I¡ 
˘r
Ë{ 
m_fgcSEII¡ísôyI¡îvÆLowîBound
[ödex][˘r] = v; 
	}
}

1033 
UCh¨
 
	$gëFGCSEII¡ísôyI¡îvÆLowîBound
(
I¡
 
ödex
, I¡ 
˘r
Ë{  
m_fgcSEII¡ísôyI¡îvÆLowîBound
[ödex][˘r]; 
	}
}

1034 
Void
 
	$£tFGCSEII¡ísôyI¡îvÆUµîBound
(
UCh¨
 
v
, 
I¡
 
ödex
, I¡ 
˘r
Ë{ 
m_fgcSEII¡ísôyI¡îvÆUµîBound
[ödex][˘r] = v; 
	}
}

1035 
UCh¨
 
	$gëFGCSEII¡ísôyI¡îvÆUµîBound
(
I¡
 
ödex
, I¡ 
˘r
Ë{  
m_fgcSEII¡ísôyI¡îvÆUµîBound
[ödex][˘r]; 
	}
}

1036 
Void
 
	$£tFGCSEICompModñVÆue
(
UI¡
 
v
, 
I¡
 
ödex
, I¡ 
˘r
, I¡ 
modñCå
Ë{ 
m_fgcSEICompModñVÆue
[ödex][˘r][modñCå] = v; 
	}
}

1037 
UI¡
 
	$gëFGCSEICompModñVÆue
(
I¡
 
ödex
, I¡ 
˘r
, I¡ 
modñCå
Ë{  
m_fgcSEICompModñVÆue
[ödex][˘r][modñCå]; 
	}
}

1040 
Void
 
	$£tCLLSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_˛lSEIE«bÀd
 = b; 
	}
}

1041 
Boﬁ
 
	$gëCLLSEIE«bÀd
(Ë{  
m_˛lSEIE«bÀd
; 
	}
}

1042 
Void
 
	$£tCLLSEIMaxC⁄ã¡LightLevñ
 (
USh‹t
 
v
Ë{ 
m_˛lSEIMaxC⁄ã¡Levñ
 = v; 
	}
}

1043 
USh‹t
 
	$gëCLLSEIMaxC⁄ã¡LightLevñ
(Ë{  
m_˛lSEIMaxC⁄ã¡Levñ
; 
	}
}

1044 
Void
 
	$£tCLLSEIMaxPicAvgLightLevñ
(
USh‹t
 
v
Ë{ 
m_˛lSEIMaxPicAvgLevñ
 = v; 
	}
}

1045 
USh‹t
 
	$gëCLLSEIMaxPicAvgLightLevñ
(Ë{  
m_˛lSEIMaxPicAvgLevñ
; 
	}
}

1047 
Void
 
	$£tAmbõ¡VõwögEnvú⁄mítSEIE«bÀd
 (
Boﬁ
 
b
Ë{ 
m_aveSEIE«bÀd
 = b; 
	}
}

1048 
Boﬁ
 
	$gëAmbõ¡VõwögEnvú⁄mítSEIE«bÀd
 (Ë{  
m_aveSEIE«bÀd
; 
	}
}

1049 
Void
 
	$£tAmbõ¡VõwögEnvú⁄mítSEIIŒumö™˚
(
UI¡
 
v
 ) { 
m_aveSEIAmbõ¡IŒumö™˚
 = v; 
	}
}

1050 
UI¡
 
	$gëAmbõ¡VõwögEnvú⁄mítSEIIŒumö™˚
(Ë{  
m_aveSEIAmbõ¡IŒumö™˚
; 
	}
}

1051 
Void
 
	$£tAmbõ¡VõwögEnvú⁄mítSEIAmbõ¡LightX
(
USh‹t
 
v
 ) { 
m_aveSEIAmbõ¡LightX
 = v; 
	}
}

1052 
USh‹t
 
	$gëAmbõ¡VõwögEnvú⁄mítSEIAmbõ¡LightX
(Ë{  
m_aveSEIAmbõ¡LightX
; 
	}
}

1053 
Void
 
	$£tAmbõ¡VõwögEnvú⁄mítSEIAmbõ¡LightY
(
USh‹t
 
v
 ) { 
m_aveSEIAmbõ¡LightY
 = v; 
	}
}

1054 
USh‹t
 
	$gëAmbõ¡VõwögEnvú⁄mítSEIAmbõ¡LightY
(Ë{  
m_aveSEIAmbõ¡LightY
; 
	}
}

1056 
Void
 
	$£tEΩSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_îpSEIE«bÀd
 = b; 
	}
}

1057 
Boﬁ
 
	$gëEΩSEIE«bÀd
(Ë{  
m_îpSEIE«bÀd
; 
	}
}

1058 
Void
 
	$£tEΩSEIC™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_îpSEIC™˚lFœg
 = b; 
	}
}

1059 
Boﬁ
 
	$gëEΩSEIC™˚lFœg
(Ë{  
m_îpSEIC™˚lFœg
; 
	}
}

1060 
Void
 
	$£tEΩSEIPîsi°í˚Fœg
(
Boﬁ
 
b
Ë{ 
m_îpSEIPîsi°í˚Fœg
 = b; 
	}
}

1061 
Boﬁ
 
	$gëEΩSEIPîsi°í˚Fœg
(Ë{  
m_îpSEIPîsi°í˚Fœg
; 
	}
}

1062 
Void
 
	$£tEΩSEIGu¨dB™dFœg
(
Boﬁ
 
b
Ë{ 
m_îpSEIGu¨dB™dFœg
 = b; 
	}
}

1063 
Boﬁ
 
	$gëEΩSEIGu¨dB™dFœg
(Ë{  
m_îpSEIGu¨dB™dFœg
; 
	}
}

1064 
Void
 
	$£tEΩSEIGu¨dB™dTy≥
(
UI¡
 
b
Ë{ 
m_îpSEIGu¨dB™dTy≥
 = b; 
	}
}

1065 
UI¡
 
	$gëEΩSEIGu¨dB™dTy≥
(Ë{  
m_îpSEIGu¨dB™dTy≥
; 
	}
}

1066 
Void
 
	$£tEΩSEILe·Gu¨dB™dWidth
(
UI¡
 
b
Ë{ 
m_îpSEILe·Gu¨dB™dWidth
 = b; 
	}
}

1067 
UI¡
 
	$gëEΩSEILe·Gu¨dB™dWidth
(Ë{  
m_îpSEILe·Gu¨dB™dWidth
; 
	}
}

1068 
Void
 
	$£tEΩSEIRightGu¨dB™dWidth
(
UI¡
 
b
Ë{ 
m_îpSEIRightGu¨dB™dWidth
 = b; 
	}
}

1069 
UI¡
 
	$gëEΩSEIRightGu¨dB™dWidth
(Ë{  
m_îpSEIRightGu¨dB™dWidth
; 
	}
}

1070 
Void
 
	$£tSphîeRŸ©i⁄SEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_•hîeRŸ©i⁄SEIE«bÀd
 = b; 
	}
}

1071 
Boﬁ
 
	$gëSphîeRŸ©i⁄SEIE«bÀd
(Ë{  
m_•hîeRŸ©i⁄SEIE«bÀd
; 
	}
}

1072 
Void
 
	$£tSphîeRŸ©i⁄SEIC™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_•hîeRŸ©i⁄SEIC™˚lFœg
 = b; 
	}
}

1073 
Boﬁ
 
	$gëSphîeRŸ©i⁄SEIC™˚lFœg
(Ë{  
m_•hîeRŸ©i⁄SEIC™˚lFœg
; 
	}
}

1074 
Void
 
	$£tSphîeRŸ©i⁄SEIPîsi°í˚Fœg
(
Boﬁ
 
b
Ë{ 
m_•hîeRŸ©i⁄SEIPîsi°í˚Fœg
 = b; 
	}
}

1075 
Boﬁ
 
	$gëSphîeRŸ©i⁄SEIPîsi°í˚Fœg
(Ë{  
m_•hîeRŸ©i⁄SEIPîsi°í˚Fœg
; 
	}
}

1076 
Void
 
	$£tSphîeRŸ©i⁄SEIYaw
(
I¡
 
b
Ë{ 
m_•hîeRŸ©i⁄SEIYaw
 = b; 
	}
}

1077 
I¡
 
	$gëSphîeRŸ©i⁄SEIYaw
(Ë{  
m_•hîeRŸ©i⁄SEIYaw
; 
	}
}

1078 
Void
 
	$£tSphîeRŸ©i⁄SEIPôch
(
I¡
 
b
Ë{ 
m_•hîeRŸ©i⁄SEIPôch
 = b; 
	}
}

1079 
I¡
 
	$gëSphîeRŸ©i⁄SEIPôch
(Ë{  
m_•hîeRŸ©i⁄SEIPôch
; 
	}
}

1080 
Void
 
	$£tSphîeRŸ©i⁄SEIRﬁl
(
I¡
 
b
Ë{ 
m_•hîeRŸ©i⁄SEIRﬁl
 = b; 
	}
}

1081 
I¡
 
	$gëSphîeRŸ©i⁄SEIRﬁl
(Ë{  
m_•hîeRŸ©i⁄SEIRﬁl
; 
	}
}

1082 
Void
 
	$£tOmniVõwp‹tSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_omniVõwp‹tSEIE«bÀd
 = b; 
	}
}

1083 
Boﬁ
 
	$gëOmniVõwp‹tSEIE«bÀd
(Ë{  
m_omniVõwp‹tSEIE«bÀd
; 
	}
}

1084 
Void
 
	$£tOmniVõwp‹tSEIId
(
UI¡
 
b
Ë{ 
m_omniVõwp‹tSEIId
 = b; 
	}
}

1085 
UI¡
 
	$gëOmniVõwp‹tSEIId
(Ë{  
m_omniVõwp‹tSEIId
; 
	}
}

1086 
Void
 
	$£tOmniVõwp‹tSEIC™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_omniVõwp‹tSEIC™˚lFœg
 = b; 
	}
}

1087 
Boﬁ
 
	$gëOmniVõwp‹tSEIC™˚lFœg
(Ë{  
m_omniVõwp‹tSEIC™˚lFœg
; 
	}
}

1088 
Void
 
	$£tOmniVõwp‹tSEIPîsi°í˚Fœg
(
Boﬁ
 
b
Ë{ 
m_omniVõwp‹tSEIPîsi°í˚Fœg
 = b; 
	}
}

1089 
Boﬁ
 
	$gëOmniVõwp‹tSEIPîsi°í˚Fœg
(Ë{  
m_omniVõwp‹tSEIPîsi°í˚Fœg
; 
	}
}

1090 
Void
 
	$£tOmniVõwp‹tSEIC¡Möus1
(
UI¡
 
b
Ë{ 
m_omniVõwp‹tSEIC¡Möus1
 = b; 
	}
}

1091 
UI¡
 
	$gëOmniVõwp‹tSEIC¡Möus1
(Ë{  
m_omniVõwp‹tSEIC¡Möus1
; 
	}
}

1092 
Void
 
£tOmniVõwp‹tSEIAzimuthCíåe
(c⁄° 
°d
::
ve˘‹
<
I¡
>& 
vi
Ë{ 
m_omniVõwp‹tSEIAzimuthCíåe
 = vi; }

1093 
I¡
 
	$gëOmniVõwp‹tSEIAzimuthCíåe
(
I¡
 
idx
Ë{  
m_omniVõwp‹tSEIAzimuthCíåe
[idx]; 
	}
}

1094 
Void
 
£tOmniVõwp‹tSEIEÀv©i⁄Cíåe
(c⁄° 
°d
::
ve˘‹
<
I¡
>& 
vi
){ 
m_omniVõwp‹tSEIEÀv©i⁄Cíåe
 = vi; }

1095 
I¡
 
	$gëOmniVõwp‹tSEIEÀv©i⁄Cíåe
(
I¡
 
idx
Ë{  
m_omniVõwp‹tSEIEÀv©i⁄Cíåe
[idx]; 
	}
}

1096 
Void
 
£tOmniVõwp‹tSEITûtCíåe
(c⁄° 
°d
::
ve˘‹
<
I¡
>& 
vi
Ë{ 
m_omniVõwp‹tSEITûtCíåe
 = vi; }

1097 
I¡
 
	$gëOmniVõwp‹tSEITûtCíåe
(
I¡
 
idx
Ë{  
m_omniVõwp‹tSEITûtCíåe
[idx]; 
	}
}

1098 
Void
 
£tOmniVõwp‹tSEIH‹R™ge
(c⁄° 
°d
::
ve˘‹
<
UI¡
>& 
vi
Ë{ 
m_omniVõwp‹tSEIH‹R™ge
 = vi; }

1099 
UI¡
 
	$gëOmniVõwp‹tSEIH‹R™ge
(
I¡
 
idx
Ë{  
m_omniVõwp‹tSEIH‹R™ge
[idx]; 
	}
}

1100 
Void
 
£tOmniVõwp‹tSEIVîR™ge
(c⁄° 
°d
::
ve˘‹
<
UI¡
>& 
vi
Ë{ 
m_omniVõwp‹tSEIVîR™ge
 = vi; }

1101 
UI¡
 
	$gëOmniVõwp‹tSEIVîR™ge
(
I¡
 
idx
Ë{  
m_omniVõwp‹tSEIVîR™ge
[idx]; 
	}
}

1102 
Void
 
	$£tG›Ba£dTemp‹ÆFûãrE«bÀd
(
Boﬁ
 
Êag
Ë{ 
m_g›Ba£dTemp‹ÆFûãrE«bÀd
 = fœg; 
	}
}

1103 
Boﬁ
 
	$gëG›Ba£dTemp‹ÆFûãrE«bÀd
(Ëc⁄° {  
m_g›Ba£dTemp‹ÆFûãrE«bÀd
; 
	}
}

1104 
Void
 
	$£tCmpSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_cmpSEIE«bÀd
 = b; 
	}
}

1105 
Boﬁ
 
	$gëCmpSEIE«bÀd
(Ë{  
m_cmpSEIE«bÀd
; 
	}
}

1106 
Void
 
	$£tCmpSEICmpC™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_cmpSEICmpC™˚lFœg
 = b; 
	}
}

1107 
Boﬁ
 
	$gëCmpSEICmpC™˚lFœg
(Ë{  
m_cmpSEICmpC™˚lFœg
; 
	}
}

1108 
Void
 
	$£tCmpSEICmpPîsi°í˚Fœg
(
Boﬁ
 
b
Ë{ 
m_cmpSEICmpPîsi°í˚Fœg
 = b; 
	}
}

1109 
Boﬁ
 
	$gëCmpSEICmpPîsi°í˚Fœg
(Ë{  
m_cmpSEICmpPîsi°í˚Fœg
; 
	}
}

1110 
Void
 
	$£tRwpSEIE«bÀd
(
Boﬁ
 
b
Ë{ 
m_rwpSEIE«bÀd
 = b; 
	}
}

1111 
Boﬁ
 
	$gëRwpSEIE«bÀd
(Ë{  
m_rwpSEIE«bÀd
; 
	}
}

1112 
Void
 
	$£tRwpSEIRwpC™˚lFœg
(
Boﬁ
 
b
Ë{ 
m_rwpSEIRwpC™˚lFœg
 = b; 
	}
}

1113 
Boﬁ
 
	$gëRwpSEIRwpC™˚lFœg
(Ë{  
m_rwpSEIRwpC™˚lFœg
; 
	}
}

1114 
Void
 
	$£tRwpSEIRwpPîsi°í˚Fœg
 (
Boﬁ
 
b
Ë{ 
m_rwpSEIRwpPîsi°í˚Fœg
 = b; 
	}
}

1115 
Boﬁ
 
	$gëRwpSEIRwpPîsi°í˚Fœg
 (Ë{  
m_rwpSEIRwpPîsi°í˚Fœg
; 
	}
}

1116 
Void
 
	$£tRwpSEIC⁄°ôuítPi˘uªM©chögFœg
 (
Boﬁ
 
b
Ë{ 
m_rwpSEIC⁄°ôuítPi˘uªM©chögFœg
 = b; 
	}
}

1117 
Boﬁ
 
	$gëRwpSEIC⁄°ôuítPi˘uªM©chögFœg
 (Ë{  
m_rwpSEIC⁄°ôuítPi˘uªM©chögFœg
; 
	}
}

1118 
Void
 
	$£tRwpSEINumPackedRegi⁄s
 (
I¡
 
vÆue
Ë{ 
m_rwpSEINumPackedRegi⁄s
 = vÆue; 
	}
}

1119 
I¡
 
	$gëRwpSEINumPackedRegi⁄s
 (Ë{  
m_rwpSEINumPackedRegi⁄s
; 
	}
}

1120 
Void
 
	$£tRwpSEIProjPi˘uªWidth
 (
I¡
 
vÆue
Ë{ 
m_rwpSEIProjPi˘uªWidth
 = vÆue; 
	}
}

1121 
I¡
 
	$gëRwpSEIProjPi˘uªWidth
 (Ë{  
m_rwpSEIProjPi˘uªWidth
; 
	}
}

1122 
Void
 
	$£tRwpSEIProjPi˘uªHeight
 (
I¡
 
vÆue
Ë{ 
m_rwpSEIProjPi˘uªHeight
 = vÆue; 
	}
}

1123 
I¡
 
	$gëRwpSEIProjPi˘uªHeight
 (Ë{  
m_rwpSEIProjPi˘uªHeight
; 
	}
}

1124 
Void
 
	$£tRwpSEIPackedPi˘uªWidth
 (
I¡
 
vÆue
Ë{ 
m_rwpSEIPackedPi˘uªWidth
 = vÆue; 
	}
}

1125 
I¡
 
	$gëRwpSEIPackedPi˘uªWidth
 (Ë{  
m_rwpSEIPackedPi˘uªWidth
; 
	}
}

1126 
Void
 
	$£tRwpSEIPackedPi˘uªHeight
 (
I¡
 
vÆue
Ë{ 
m_rwpSEIPackedPi˘uªHeight
 = vÆue; 
	}
}

1127 
I¡
 
	$gëRwpSEIPackedPi˘uªHeight
 (Ë{  
m_rwpSEIPackedPi˘uªHeight
; 
	}
}

1128 
Void
 
£tRwpSEIRwpTønsf‹mTy≥
(c⁄° 
°d
::
ve˘‹
<
UCh¨
>& 
rwpTønsf‹mTy≥
Ë{ 
m_rwpSEIRwpTønsf‹mTy≥
 =rwpTransformType; }

1129 
UCh¨
 
	$gëRwpSEIRwpTønsf‹mTy≥
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpTønsf‹mTy≥
[idx]; 
	}
}

1130 
Void
 
£tRwpSEIRwpGu¨dB™dFœg
(c⁄° 
°d
::
ve˘‹
<
Boﬁ
>& 
rwpGu¨dB™dFœg
Ë{ 
m_rwpSEIRwpGu¨dB™dFœg
 =ÑwpGuardBandFlag; }

1131 
Boﬁ
 
	$gëRwpSEIRwpGu¨dB™dFœg
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpGu¨dB™dFœg
[idx]; 
	}
}

1132 
Void
 
£tRwpSEIProjRegi⁄Width
(c⁄° 
°d
::
ve˘‹
<
UI¡
>& 
¥ojRegi⁄Width
Ë{ 
m_rwpSEIProjRegi⁄Width
 =ÖrojRegionWidth; }

1133 
UI¡
 
	$gëRwpSEIProjRegi⁄Width
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIProjRegi⁄Width
[idx]; 
	}
}

1134 
Void
 
£tRwpSEIProjRegi⁄Height
(c⁄° 
°d
::
ve˘‹
<
UI¡
>& 
¥ojRegi⁄Height
Ë{ 
m_rwpSEIProjRegi⁄Height
 =ÖrojRegionHeight; }

1135 
UI¡
 
	$gëRwpSEIProjRegi⁄Height
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIProjRegi⁄Height
[idx]; 
	}
}

1136 
Void
 
£tRwpSEIRwpSEIProjRegi⁄T›
(c⁄° 
°d
::
ve˘‹
<
UI¡
>& 
¥ojRegi⁄T›
Ë{ 
m_rwpSEIRwpSEIProjRegi⁄T›
 =ÖrojRegionTop; }

1137 
UI¡
 
	$gëRwpSEIRwpSEIProjRegi⁄T›
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpSEIProjRegi⁄T›
[idx]; 
	}
}

1138 
Void
 
£tRwpSEIProjRegi⁄Le·
(c⁄° 
°d
::
ve˘‹
<
UI¡
>& 
¥ojRegi⁄Le·
Ë{ 
m_rwpSEIProjRegi⁄Le·
 =ÖrojRegionLeft; }

1139 
UI¡
 
	$gëRwpSEIProjRegi⁄Le·
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIProjRegi⁄Le·
[idx]; 
	}
}

1140 
Void
 
£tRwpSEIPackedRegi⁄Width
(c⁄° 
°d
::
ve˘‹
<
USh‹t
>& 
∑ckedRegi⁄Width
Ë{ 
m_rwpSEIPackedRegi⁄Width
 =ÖackedRegionWidth; }

1141 
USh‹t
 
	$gëRwpSEIPackedRegi⁄Width
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIPackedRegi⁄Width
[idx]; 
	}
}

1142 
Void
 
£tRwpSEIPackedRegi⁄Height
(c⁄° 
°d
::
ve˘‹
<
USh‹t
>& 
∑ckedRegi⁄Height
Ë{ 
m_rwpSEIPackedRegi⁄Height
 =ÖackedRegionHeight; }

1143 
USh‹t
 
	$gëRwpSEIPackedRegi⁄Height
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIPackedRegi⁄Height
[idx]; 
	}
}

1144 
Void
 
£tRwpSEIPackedRegi⁄T›
(c⁄° 
°d
::
ve˘‹
<
USh‹t
>& 
∑ckedRegi⁄T›
Ë{ 
m_rwpSEIPackedRegi⁄T›
 =ÖackedRegionTop; }

1145 
USh‹t
 
	$gëRwpSEIPackedRegi⁄T›
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIPackedRegi⁄T›
[idx]; 
	}
}

1146 
Void
 
£tRwpSEIPackedRegi⁄Le·
(c⁄° 
°d
::
ve˘‹
<
USh‹t
>& 
∑ckedRegi⁄Le·
Ë{ 
m_rwpSEIPackedRegi⁄Le·
 =ÖackedRegionLeft; }

1147 
USh‹t
 
	$gëRwpSEIPackedRegi⁄Le·
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIPackedRegi⁄Le·
[idx]; 
	}
}

1148 
Void
 
£tRwpSEIRwpLe·Gu¨dB™dWidth
(c⁄° 
°d
::
ve˘‹
<
UCh¨
>& 
rwpLe·Gu¨dB™dWidth
Ë{ 
m_rwpSEIRwpLe·Gu¨dB™dWidth
 =ÑwpLeftGuardBandWidth; }

1149 
UCh¨
 
	$gëRwpSEIRwpLe·Gu¨dB™dWidth
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpLe·Gu¨dB™dWidth
[idx]; 
	}
}

1150 
Void
 
£tRwpSEIRwpRightGu¨dB™dWidth
(c⁄° 
°d
::
ve˘‹
<
UCh¨
>& 
rwpRightGu¨dB™dWidth
Ë{ 
m_rwpSEIRwpRightGu¨dB™dWidth
 =ÑwpRightGuardBandWidth; }

1151 
UCh¨
 
	$gëRwpSEIRwpRightGu¨dB™dWidth
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpRightGu¨dB™dWidth
[idx]; 
	}
}

1152 
Void
 
£tRwpSEIRwpT›Gu¨dB™dHeight
(c⁄° 
°d
::
ve˘‹
<
UCh¨
>& 
rwpT›Gu¨dB™dHeight
Ë{ 
m_rwpSEIRwpT›Gu¨dB™dHeight
 =ÑwpTopGuardBandHeight; }

1153 
UCh¨
 
	$gëRwpSEIRwpT›Gu¨dB™dHeight
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpT›Gu¨dB™dHeight
[idx]; 
	}
}

1154 
Void
 
£tRwpSEIRwpBŸtomGu¨dB™dHeight
(c⁄° 
°d
::
ve˘‹
<
UCh¨
>& 
rwpBŸtomGu¨dB™dHeight
Ë{ 
m_rwpSEIRwpBŸtomGu¨dB™dHeight
 =ÑwpBottomGuardBandHeight; }

1155 
UCh¨
 
	$gëRwpSEIRwpBŸtomGu¨dB™dHeight
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpBŸtomGu¨dB™dHeight
[idx]; 
	}
}

1156 
Void
 
£tRwpSEIRwpGu¨dB™dNŸU£dF‹PªdFœg
(c⁄° 
°d
::
ve˘‹
<
Boﬁ
>& 
rwpGu¨dB™dNŸU£dF‹PªdFœg
){ 
m_rwpSEIRwpGu¨dB™dNŸU£dF‹PªdFœg
 =ÑwpGuardBandNotUsedForPredFlag; }

1157 
Boﬁ
 
	$gëRwpSEIRwpGu¨dB™dNŸU£dF‹PªdFœg
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpGu¨dB™dNŸU£dF‹PªdFœg
[idx]; 
	}
}

1158 
Void
 
£tRwpSEIRwpGu¨dB™dTy≥
(c⁄° 
°d
::
ve˘‹
<
UCh¨
>& 
rwpGu¨dB™dTy≥
Ë{ 
m_rwpSEIRwpGu¨dB™dTy≥
 =ÑwpGuardBandType; }

1159 
UCh¨
 
	$gëRwpSEIRwpGu¨dB™dTy≥
(
UI¡
 
idx
Ëc⁄° {  
m_rwpSEIRwpGu¨dB™dTy≥
[idx]; 
	}
}

1160 
Void
 
	$£tFviSEIDißbÀd
(Ë{ 
m_fviSEIE«bÀd
 = 
Ál£
; 
	}
}

1161 
Void
 
	$£tFviSEIE«bÀd
(c⁄° 
TComSEIFisheyeVideoInfo
& 
fvi
Ë{ 
m_fisheyeVideoInfo
=fvi; 
m_fviSEIE«bÀd
=
åue
; 
	}
}

1162 
Boﬁ
 
	$gëFviSEIE«bÀd
(Ëc⁄° {  
m_fviSEIE«bÀd
; 
	}
}

1163 c⁄° 
	gTComSEIFisheyeVideoInfo
& 
	$gëFviSEID©a
(Ëc⁄° {  
m_fisheyeVideoInfo
; 
	}
}

1164 
Void
 
	$£tCﬁourRem≠InfoSEIFûeRoŸ
–c⁄° 
°d
::
°rög
 &
s
 ) { 
m_cﬁourRem≠SEIFûeRoŸ
 = s; 
	}
}

1165 c⁄° 
	g°d
::
°rög
 &
	$gëCﬁourRem≠InfoSEIFûeRoŸ
(Ëc⁄° {  
m_cﬁourRem≠SEIFûeRoŸ
; 
	}
}

1166 
Void
 
	$£tMa°îögDi•œySEI
(c⁄° 
TComSEIMa°îögDi•œy
 &
§c
Ë{ 
m_ma°îögDi•œy
 = src; 
	}
}

1167 
Void
 
	$£tSEIA…î«tiveTøns„rCh¨a˘îi°icsSEIE«bÀ
–
Boﬁ
 
b
Ë{ 
m_Æã∫©iveTøns„rCh¨a˘îi°icsSEIE«bÀd
 = b; 
	}
}

1168 
Boﬁ
 
	$gëSEIA…î«tiveTøns„rCh¨a˘îi°icsSEIE«bÀ
–Ëc⁄° {  
m_Æã∫©iveTøns„rCh¨a˘îi°icsSEIE«bÀd
; 
	}
}

1169 
Void
 
	$£tSEIPª„ºedTøns„rCh¨a˘îi°ics
(
UCh¨
 
v
Ë{ 
m_¥e„ºedTøns„rCh¨a˘îi°ics
 = v; 
	}
}

1170 
UCh¨
 
	$gëSEIPª„ºedTøns„rCh¨a˘îi°ics
(Ëc⁄° {  
m_¥e„ºedTøns„rCh¨a˘îi°ics
; 
	}
}

1171 
Void
 
	$£tSEIGªíMëad©aInfoSEIE«bÀ
–
Boﬁ
 
b
Ë{ 
m_gªíMëad©aInfoSEIE«bÀd
 = b; 
	}
}

1172 
Boﬁ
 
	$gëSEIGªíMëad©aInfoSEIE«bÀ
–Ëc⁄° {  
m_gªíMëad©aInfoSEIE«bÀd
; 
	}
}

1173 
Void
 
	$£tSEIGªíMëad©aTy≥
(
UCh¨
 
v
Ë{ 
m_gªíMëad©aTy≥
 = v; 
	}
}

1174 
UCh¨
 
	$gëSEIGªíMëad©aTy≥
(Ëc⁄° {  
m_gªíMëad©aTy≥
; 
	}
}

1175 
Void
 
	$£tSEIXSDMëricTy≥
(
UCh¨
 
v
Ë{ 
m_xsdMëricTy≥
 = v; 
	}
}

1176 
UCh¨
 
	$gëSEIXSDMëricTy≥
(Ëc⁄° {  
m_xsdMëricTy≥
; 
	}
}

1177 
Void
 
	$£tRegi⁄ÆNe°ögSEIFûeRoŸ
–c⁄° 
°d
::
°rög
 &
s
 ) { 
m_ªgi⁄ÆNe°ögSEIFûeRoŸ
 = s; 
	}
}

1178 c⁄° 
	g°d
::
°rög
 &
	$gëRegi⁄ÆNe°ögSEIFûeRoŸ
(Ëc⁄° {  
m_ªgi⁄ÆNe°ögSEIFûeRoŸ
; 
	}
}

1180 
Void
 
	$£tA¬Ÿ©edRegi⁄SEIFûeRoŸ
(c⁄° 
°d
::
°rög
 &
s
Ë{ 
m_¨SEIFûeRoŸ
 = s; 
	}
}

1181 c⁄° 
	g°d
::
°rög
 &
	$gëA¬Ÿ©edRegi⁄SEIFûeRoŸ
(Ëc⁄° {  
m_¨SEIFûeRoŸ
; 
	}
}

1183 c⁄° 
	gTComSEIMa°îögDi•œy
 &
	$gëMa°îögDi•œySEI
(Ëc⁄° {  
m_ma°îögDi•œy
; 
	}
}

1184 
Void
 
	$£tU£WP
 ( 
Boﬁ
 
b
 ) { 
m_u£WeighãdPªd
 = b; 
	}
}

1185 
Void
 
	$£tWPBiPªd
 ( 
Boﬁ
 
b
 ) { 
m_u£WeighãdBiPªd
 = b; 
	}
}

1186 
Boﬁ
 
	$gëU£WP
 (Ë{  
m_u£WeighãdPªd
; 
	}
}

1187 
Boﬁ
 
	$gëWPBiPªd
 (Ë{  
m_u£WeighãdBiPªd
; 
	}
}

1188 
Void
 
	$£tLog2P¨ÆÀlMîgeLevñMöus2
 ( 
UI¡
 
u
 ) { 
m_log2P¨ÆÀlMîgeLevñMöus2
 = u; 
	}
}

1189 
UI¡
 
	$gëLog2P¨ÆÀlMîgeLevñMöus2
 (Ë{  
m_log2P¨ÆÀlMîgeLevñMöus2
; 
	}
}

1190 
Void
 
	$£tMaxNumMîgeC™d
 ( 
UI¡
 
u
 ) { 
m_maxNumMîgeC™d
 = u; 
	}
}

1191 
UI¡
 
	$gëMaxNumMîgeC™d
 (Ë{  
m_maxNumMîgeC™d
; 
	}
}

1192 
Void
 
	$£tU£SˇlögLi°Id
 ( 
SˇlögLi°Mode
 
u
 ) { 
m_u£SˇlögLi°Id
 = u; 
	}
}

1193 
SˇlögLi°Mode
 
	$gëU£SˇlögLi°Id
 (Ë{  
m_u£SˇlögLi°Id
; 
	}
}

1194 
Void
 
	$£tSˇlögLi°FûeName
 ( c⁄° 
°d
::
°rög
 &
s
 ) { 
m_sˇlögLi°FûeName
 = s; 
	}
}

1195 c⁄° 
	g°d
::
°rög
& 
	$gëSˇlögLi°FûeName
 (Ëc⁄° {  
m_sˇlögLi°FûeName
; 
	}
}

1196 
Void
 
	$£tTMVPModeId
 ( 
I¡
 
u
 ) { 
m_TMVPModeId
 = u; 
	}
}

1197 
I¡
 
	$gëTMVPModeId
 (Ë{  
m_TMVPModeId
; 
	}
}

1198 
WeighãdPªdi˘i⁄Mëhod
 
	$gëWeighãdPªdi˘i⁄Mëhod
(Ëc⁄° {  
m_weighãdPªdi˘i⁄Mëhod
; 
	}
}

1199 
Void
 
	$£tWeighãdPªdi˘i⁄Mëhod
–
WeighãdPªdi˘i⁄Mëhod
 
m
 ) { 
m_weighãdPªdi˘i⁄Mëhod
 = m; 
	}
}

1200 
Void
 
	$£tSignD©aHidögE«bÀdFœg
–
Boﬁ
 
b
 ) { 
m_SignD©aHidögE«bÀdFœg
 = b; 
	}
}

1201 
Boﬁ
 
	$gëSignD©aHidögE«bÀdFœg
(Ë{  
m_SignD©aHidögE«bÀdFœg
; 
	}
}

1202 
Boﬁ
 
	$gëU£R©eCål
 (Ë{  
m_RCE«bÀR©eC⁄åﬁ
; 
	}
}

1203 
Void
 
	$£tU£R©eCål
 ( 
Boﬁ
 
b
 ) { 
m_RCE«bÀR©eC⁄åﬁ
 = b; 
	}
}

1204 
I¡
 
	$gëT¨gëBôøã
 (Ë{  
m_RCT¨gëBôøã
; 
	}
}

1205 
Void
 
	$£tT¨gëBôøã
 ( 
I¡
 
bôøã
 ) { 
m_RCT¨gëBôøã
 = bôøã; 
	}
}

1206 
I¡
 
	$gëKìpHõrBô
 (Ë{  
m_RCKìpHõørchiˇlBô
; 
	}
}

1207 
Void
 
	$£tKìpHõrBô
 ( 
I¡
 
i
 ) { 
m_RCKìpHõørchiˇlBô
 = i; 
	}
}

1208 
Boﬁ
 
	$gëLCULevñRC
 (Ë{  
m_RCLCULevñRC
; 
	}
}

1209 
Void
 
	$£tLCULevñRC
 ( 
Boﬁ
 
b
 ) { 
m_RCLCULevñRC
 = b; 
	}
}

1210 
Boﬁ
 
	$gëU£LCUSï¨©eModñ
 (Ë{  
m_RCU£LCUSï¨©eModñ
; 
	}
}

1211 
Void
 
	$£tU£LCUSï¨©eModñ
 ( 
Boﬁ
 
b
 ) { 
m_RCU£LCUSï¨©eModñ
 = b; 
	}
}

1212 
I¡
 
	$gëInôülQP
 (Ë{  
m_RCInôülQP
; 
	}
}

1213 
Void
 
	$£tInôülQP
 ( 
I¡
 
QP
 ) { 
m_RCInôülQP
 = QP; 
	}
}

1214 
Boﬁ
 
	$gëF‹˚I¡øQP
 (Ë{  
m_RCF‹˚I¡øQP
; 
	}
}

1215 
Void
 
	$£tF‹˚I¡øQP
 ( 
Boﬁ
 
b
 ) { 
m_RCF‹˚I¡øQP
 = b; 
	}
}

1216 
Boﬁ
 
	$gëCpbS©uøti⁄E«bÀd
(Ë{  
m_RCCpbS©uøti⁄E«bÀd
;
	}
}

1217 
Void
 
	$£tCpbS©uøti⁄E«bÀd
–
Boﬁ
 
b
 ) { 
m_RCCpbS©uøti⁄E«bÀd
 = b; 
	}
}

1218 
UI¡
 
	$gëCpbSize
 (Ë{  
m_RCCpbSize
;
	}
}

1219 
Void
 
	$£tCpbSize
 ( 
UI¡
 
ui
 ) { 
m_RCCpbSize
 = ui; 
	}
}

1220 
DoubÀ
 
	$gëInôülCpbFuŒ√ss
 (Ë{  
m_RCInôülCpbFuŒ√ss
; 
	}
}

1221 
Void
 
	$£tInôülCpbFuŒ√ss
 (
DoubÀ
 
f
Ë{ 
m_RCInôülCpbFuŒ√ss
 = f; 
	}
}

1222 
Boﬁ
 
	$gëTønsqu™tBy∑ssE«bÀdFœg
(Ë{  
m_Tønsqu™tBy∑ssE«bÀdFœg
; 
	}
}

1223 
Void
 
	$£tTønsqu™tBy∑ssE«bÀdFœg
(
Boﬁ
 
Êag
Ë{ 
m_Tønsqu™tBy∑ssE«bÀdFœg
 = fœg; 
	}
}

1224 
Boﬁ
 
	$gëCUTønsqu™tBy∑ssFœgF‹˚VÆue
(Ë{  
m_CUTønsqu™tBy∑ssFœgF‹˚
; 
	}
}

1225 
Void
 
	$£tCUTønsqu™tBy∑ssFœgF‹˚VÆue
(
Boﬁ
 
Êag
Ë{ 
m_CUTønsqu™tBy∑ssFœgF‹˚
 = fœg; 
	}
}

1226 
Co°Mode
 
	$gëCo°Mode
–Ëc⁄° {  
m_co°Mode
; 
	}
}

1227 
Void
 
	$£tCo°Mode
(
Co°Mode
 
m
 ) { 
m_co°Mode
 = m; 
	}
}

1229 
Void
 
	$£tVPS
(
TComVPS
 *
p
Ë{ 
m_cVPS
 = *p; 
	}
}

1230 
TComVPS
 * 
	$gëVPS
(Ë{  &
m_cVPS
; 
	}
}

1231 
Void
 
	$£tU£ReˇlcuœãQPAcc‹dögToLambda
 (
Boﬁ
 
b
Ë{ 
m_ªˇlcuœãQPAcc‹dögToLambda
 = b; 
	}
}

1232 
Boﬁ
 
	$gëU£ReˇlcuœãQPAcc‹dögToLambda
 (Ë{  
m_ªˇlcuœãQPAcc‹dögToLambda
; 
	}
}

1234 
Void
 
	$£tU£Så⁄gI¡øSmoŸhög
 ( 
Boﬁ
 
b
 ) { 
m_u£Så⁄gI¡øSmoŸhög
 = b; 
	}
}

1235 
Boﬁ
 
	$gëU£Så⁄gI¡øSmoŸhög
 (Ë{  
m_u£Så⁄gI¡øSmoŸhög
; 
	}
}

1237 
Void
 
	$£tEfficõ¡FõldIRAPE«bÀd
–
Boﬁ
 
b
 ) { 
m_bEfficõ¡FõldIRAPE«bÀd
 = b; 
	}
}

1238 
Boﬁ
 
	$gëEfficõ¡FõldIRAPE«bÀd
–Ëc⁄° {  
m_bEfficõ¡FõldIRAPE«bÀd
; 
	}
}

1240 
Void
 
	$£tH¨m⁄izeG›Fú°FõldCou∂eE«bÀd
–
Boﬁ
 
b
 ) { 
m_bH¨m⁄izeG›Fú°FõldCou∂eE«bÀd
 = b; 
	}
}

1241 
Boﬁ
 
	$gëH¨m⁄izeG›Fú°FõldCou∂eE«bÀd
–Ëc⁄° {  
m_bH¨m⁄izeG›Fú°FõldCou∂eE«bÀd
; 
	}
}

1243 
Void
 
	$£tA˘iveP¨amëîSësSEIE«bÀd
 ( 
I¡
 
b
 ) { 
m_a˘iveP¨amëîSësSEIE«bÀd
 = b; 
	}
}

1244 
I¡
 
	$gëA˘iveP¨amëîSësSEIE«bÀd
 (Ë{  
m_a˘iveP¨amëîSësSEIE«bÀd
; 
	}
}

1245 
Boﬁ
 
	$gëVuiP¨amëîsPª£¡Fœg
(Ë{  
m_vuiP¨amëîsPª£¡Fœg
; 
	}
}

1246 
Void
 
	$£tVuiP¨amëîsPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_vuiP¨amëîsPª£¡Fœg
 = i; 
	}
}

1247 
Boﬁ
 
	$gëA•e˘R©ioInfoPª£¡Fœg
(Ë{  
m_a•e˘R©ioInfoPª£¡Fœg
; 
	}
}

1248 
Void
 
	$£tA•e˘R©ioInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_a•e˘R©ioInfoPª£¡Fœg
 = i; 
	}
}

1249 
I¡
 
	$gëA•e˘R©ioIdc
(Ë{  
m_a•e˘R©ioIdc
; 
	}
}

1250 
Void
 
	$£tA•e˘R©ioIdc
(
I¡
 
i
Ë{ 
m_a•e˘R©ioIdc
 = i; 
	}
}

1251 
I¡
 
	$gëS¨Width
(Ë{  
m_ßrWidth
; 
	}
}

1252 
Void
 
	$£tS¨Width
(
I¡
 
i
Ë{ 
m_ßrWidth
 = i; 
	}
}

1253 
I¡
 
	$gëS¨Height
(Ë{  
m_ßrHeight
; 
	}
}

1254 
Void
 
	$£tS¨Height
(
I¡
 
i
Ë{ 
m_ßrHeight
 = i; 
	}
}

1255 
Boﬁ
 
	$gëOvîsˇnInfoPª£¡Fœg
(Ë{  
m_ovîsˇnInfoPª£¡Fœg
; 
	}
}

1256 
Void
 
	$£tOvîsˇnInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_ovîsˇnInfoPª£¡Fœg
 = i; 
	}
}

1257 
Boﬁ
 
	$gëOvîsˇnAµr›rüãFœg
(Ë{  
m_ovîsˇnAµr›rüãFœg
; 
	}
}

1258 
Void
 
	$£tOvîsˇnAµr›rüãFœg
(
Boﬁ
 
i
Ë{ 
m_ovîsˇnAµr›rüãFœg
 = i; 
	}
}

1259 
Boﬁ
 
	$gëVideoSig«lTy≥Pª£¡Fœg
(Ë{  
m_videoSig«lTy≥Pª£¡Fœg
; 
	}
}

1260 
Void
 
	$£tVideoSig«lTy≥Pª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_videoSig«lTy≥Pª£¡Fœg
 = i; 
	}
}

1261 
I¡
 
	$gëVideoF‹m©
(Ë{  
m_videoF‹m©
; 
	}
}

1262 
Void
 
	$£tVideoF‹m©
(
I¡
 
i
Ë{ 
m_videoF‹m©
 = i; 
	}
}

1263 
Boﬁ
 
	$gëVideoFuŒR™geFœg
(Ë{  
m_videoFuŒR™geFœg
; 
	}
}

1264 
Void
 
	$£tVideoFuŒR™geFœg
(
Boﬁ
 
i
Ë{ 
m_videoFuŒR™geFœg
 = i; 
	}
}

1265 
Boﬁ
 
	$gëCﬁourDes¸ùti⁄Pª£¡Fœg
(Ë{  
m_cﬁourDes¸ùti⁄Pª£¡Fœg
; 
	}
}

1266 
Void
 
	$£tCﬁourDes¸ùti⁄Pª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_cﬁourDes¸ùti⁄Pª£¡Fœg
 = i; 
	}
}

1267 
I¡
 
	$gëCﬁourPrim¨õs
(Ë{  
m_cﬁourPrim¨õs
; 
	}
}

1268 
Void
 
	$£tCﬁourPrim¨õs
(
I¡
 
i
Ë{ 
m_cﬁourPrim¨õs
 = i; 
	}
}

1269 
I¡
 
	$gëTøns„rCh¨a˘îi°ics
(Ë{  
m_å™s„rCh¨a˘îi°ics
; 
	}
}

1270 
Void
 
	$£tTøns„rCh¨a˘îi°ics
(
I¡
 
i
Ë{ 
m_å™s„rCh¨a˘îi°ics
 = i; 
	}
}

1271 
I¡
 
	$gëM©rixC€fficõ¡s
(Ë{  
m_m©rixC€fficõ¡s
; 
	}
}

1272 
Void
 
	$£tM©rixC€fficõ¡s
(
I¡
 
i
Ë{ 
m_m©rixC€fficõ¡s
 = i; 
	}
}

1273 
Boﬁ
 
	$gëChromaLocInfoPª£¡Fœg
(Ë{  
m_chromaLocInfoPª£¡Fœg
; 
	}
}

1274 
Void
 
	$£tChromaLocInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_chromaLocInfoPª£¡Fœg
 = i; 
	}
}

1275 
I¡
 
	$gëChromaSam∂eLocTy≥T›Fõld
(Ë{  
m_chromaSam∂eLocTy≥T›Fõld
; 
	}
}

1276 
Void
 
	$£tChromaSam∂eLocTy≥T›Fõld
(
I¡
 
i
Ë{ 
m_chromaSam∂eLocTy≥T›Fõld
 = i; 
	}
}

1277 
I¡
 
	$gëChromaSam∂eLocTy≥BŸtomFõld
(Ë{  
m_chromaSam∂eLocTy≥BŸtomFõld
; 
	}
}

1278 
Void
 
	$£tChromaSam∂eLocTy≥BŸtomFõld
(
I¡
 
i
Ë{ 
m_chromaSam∂eLocTy≥BŸtomFõld
 = i; 
	}
}

1279 
Boﬁ
 
	$gëNeuåÆChromaIndiˇti⁄Fœg
(Ë{  
m_√uåÆChromaIndiˇti⁄Fœg
; 
	}
}

1280 
Void
 
	$£tNeuåÆChromaIndiˇti⁄Fœg
(
Boﬁ
 
i
Ë{ 
m_√uåÆChromaIndiˇti⁄Fœg
 = i; 
	}
}

1281 
	gWödow
 &
	$gëDeÁu…Di•œyWödow
(Ë{  
m_deÁu…Di•œyWödow
; 
	}
}

1282 
Void
 
	$£tDeÁu…Di•œyWödow
 (
I¡
 
off£tLe·
, I¡ 
off£tRight
, I¡ 
off£tT›
, I¡ 
off£tBŸtom
 ) { 
m_deÁu…Di•œyWödow
.
	`£tWödow
 (off£tLe·, off£tRight, off£tT›, off£tBŸtom); 
	}
}

1283 
Boﬁ
 
	$gëFømeFõldInfoPª£¡Fœg
(Ë{  
m_‰ameFõldInfoPª£¡Fœg
; 
	}
}

1284 
Void
 
	$£tFømeFõldInfoPª£¡Fœg
(
Boﬁ
 
i
Ë{ 
m_‰ameFõldInfoPª£¡Fœg
 = i; 
	}
}

1285 
Boﬁ
 
	$gëPocPr›‹ti⁄ÆToTimögFœg
(Ë{  
m_pocPr›‹ti⁄ÆToTimögFœg
; 
	}
}

1286 
Void
 
	$£tPocPr›‹ti⁄ÆToTimögFœg
(
Boﬁ
 
x
Ë{ 
m_pocPr›‹ti⁄ÆToTimögFœg
 = x; 
	}
}

1287 
I¡
 
	$gëNumTicksPocDiffO√Möus1
(Ë{  
m_numTicksPocDiffO√Möus1
; 
	}
}

1288 
Void
 
	$£tNumTicksPocDiffO√Möus1
(
I¡
 
x
Ë{ 
m_numTicksPocDiffO√Möus1
 = x; 
	}
}

1289 
Boﬁ
 
	$gëBô°ªamRe°ri˘i⁄Fœg
(Ë{  
m_bô°ªamRe°ri˘i⁄Fœg
; 
	}
}

1290 
Void
 
	$£tBô°ªamRe°ri˘i⁄Fœg
(
Boﬁ
 
i
Ë{ 
m_bô°ªamRe°ri˘i⁄Fœg
 = i; 
	}
}

1291 
Boﬁ
 
	$gëTûesFixedSåu˘uªFœg
(Ë{  
m_tûesFixedSåu˘uªFœg
; 
	}
}

1292 
Void
 
	$£tTûesFixedSåu˘uªFœg
(
Boﬁ
 
i
Ë{ 
m_tûesFixedSåu˘uªFœg
 = i; 
	}
}

1293 
Boﬁ
 
	$gëMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(Ë{  
m_mŸi⁄Ve˘‹sOvîPicBound¨õsFœg
; 
	}
}

1294 
Void
 
	$£tMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(
Boﬁ
 
i
Ë{ 
m_mŸi⁄Ve˘‹sOvîPicBound¨õsFœg
 = i; 
	}
}

1295 
I¡
 
	$gëMöS∑tülSegmíèti⁄Idc
(Ë{  
m_möS∑tülSegmíèti⁄Idc
; 
	}
}

1296 
Void
 
	$£tMöS∑tülSegmíèti⁄Idc
(
I¡
 
i
Ë{ 
m_möS∑tülSegmíèti⁄Idc
 = i; 
	}
}

1297 
I¡
 
	$gëMaxByãsPîPicDíom
(Ë{  
m_maxByãsPîPicDíom
; 
	}
}

1298 
Void
 
	$£tMaxByãsPîPicDíom
(
I¡
 
i
Ë{ 
m_maxByãsPîPicDíom
 = i; 
	}
}

1299 
I¡
 
	$gëMaxBôsPîMöCuDíom
(Ë{  
m_maxBôsPîMöCuDíom
; 
	}
}

1300 
Void
 
	$£tMaxBôsPîMöCuDíom
(
I¡
 
i
Ë{ 
m_maxBôsPîMöCuDíom
 = i; 
	}
}

1301 
I¡
 
	$gëLog2MaxMvLígthH‹iz⁄èl
(Ë{  
m_log2MaxMvLígthH‹iz⁄èl
; 
	}
}

1302 
Void
 
	$£tLog2MaxMvLígthH‹iz⁄èl
(
I¡
 
i
Ë{ 
m_log2MaxMvLígthH‹iz⁄èl
 = i; 
	}
}

1303 
I¡
 
	$gëLog2MaxMvLígthVîtiˇl
(Ë{  
m_log2MaxMvLígthVîtiˇl
; 
	}
}

1304 
Void
 
	$£tLog2MaxMvLígthVîtiˇl
(
I¡
 
i
Ë{ 
m_log2MaxMvLígthVîtiˇl
 = i; 
	}
}

1306 
Boﬁ
 
	$gëProgªssiveSour˚Fœg
(Ëc⁄° {  
m_¥ogªssiveSour˚Fœg
; 
	}
}

1307 
Void
 
	$£tProgªssiveSour˚Fœg
(
Boﬁ
 
b
Ë{ 
m_¥ogªssiveSour˚Fœg
 = b; 
	}
}

1309 
Boﬁ
 
	$gëI¡îœ˚dSour˚Fœg
(Ëc⁄° {  
m_öãæa˚dSour˚Fœg
; 
	}
}

1310 
Void
 
	$£tI¡îœ˚dSour˚Fœg
(
Boﬁ
 
b
Ë{ 
m_öãæa˚dSour˚Fœg
 = b; 
	}
}

1312 
Boﬁ
 
	$gëN⁄PackedC⁄°øötFœg
(Ëc⁄° {  
m_n⁄PackedC⁄°øötFœg
; 
	}
}

1313 
Void
 
	$£tN⁄PackedC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_n⁄PackedC⁄°øötFœg
 = b; 
	}
}

1315 
Boﬁ
 
	$gëFømeO∆yC⁄°øötFœg
(Ëc⁄° {  
m_‰ameO∆yC⁄°øötFœg
; 
	}
}

1316 
Void
 
	$£tFømeO∆yC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_‰ameO∆yC⁄°øötFœg
 = b; 
	}
}

1318 
UI¡
 
	$gëBôDïthC⁄°øötVÆue
(Ëc⁄° {  
m_bôDïthC⁄°øötVÆue
; 
	}
}

1319 
Void
 
	$£tBôDïthC⁄°øötVÆue
(
UI¡
 
v
Ë{ 
m_bôDïthC⁄°øötVÆue
=v; 
	}
}

1321 
ChromaF‹m©
 
	$gëChromaF‹m©C⁄°øötVÆue
(Ëc⁄° {  
m_chromaF‹m©C⁄°øötVÆue
; 
	}
}

1322 
Void
 
	$£tChromaF‹m©C⁄°øötVÆue
(
ChromaF‹m©
 
v
Ë{ 
m_chromaF‹m©C⁄°øötVÆue
=v; 
	}
}

1324 
Boﬁ
 
	$gëI¡øC⁄°øötFœg
(Ëc⁄° {  
m_öåaC⁄°øötFœg
; 
	}
}

1325 
Void
 
	$£tI¡øC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_öåaC⁄°øötFœg
=b; 
	}
}

1327 
Boﬁ
 
	$gëO√Pi˘uªO∆yC⁄°øötFœg
(Ëc⁄° {  
m_⁄ePi˘uªO∆yC⁄°øötFœg
; 
	}
}

1328 
Void
 
	$£tO√Pi˘uªO∆yC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_⁄ePi˘uªO∆yC⁄°øötFœg
=b; 
	}
}

1330 
Boﬁ
 
	$gëLowîBôR©eC⁄°øötFœg
(Ëc⁄° {  
m_lowîBôR©eC⁄°øötFœg
; 
	}
}

1331 
Void
 
	$£tLowîBôR©eC⁄°øötFœg
(
Boﬁ
 
b
Ë{ 
m_lowîBôR©eC⁄°øötFœg
=b; 
	}
}

1333 
Boﬁ
 
	$gëChromaReßm∂ögFûãrHötE«bÀd
(Ë{  
m_chromaReßm∂ögFûãrHötE«bÀd
;
	}
}

1334 
Void
 
	$£tChromaReßm∂ögFûãrHötE«bÀd
(
Boﬁ
 
i
Ë{ 
m_chromaReßm∂ögFûãrHötE«bÀd
 = i;
	}
}

1335 
I¡
 
	$gëChromaReßm∂ögH‹FûãrIdc
(Ë{  
m_chromaReßm∂ögH‹FûãrIdc
;
	}
}

1336 
Void
 
	$£tChromaReßm∂ögH‹FûãrIdc
(
I¡
 
i
Ë{ 
m_chromaReßm∂ögH‹FûãrIdc
 = i;
	}
}

1337 
I¡
 
	$gëChromaReßm∂ögVîFûãrIdc
(Ë{  
m_chromaReßm∂ögVîFûãrIdc
;
	}
}

1338 
Void
 
	$£tChromaReßm∂ögVîFûãrIdc
(
I¡
 
i
Ë{ 
m_chromaReßm∂ögVîFûãrIdc
 = i;
	}
}

1340 
Void
 
	$£tSumm¨yOutFûíame
(c⁄° 
°d
::
°rög
 &
s
Ë{ 
m_summ¨yOutFûíame
 = s; 
	}
}

1341 c⁄° 
	g°d
::
°rög
& 
	$gëSumm¨yOutFûíame
(Ëc⁄° {  
m_summ¨yOutFûíame
; 
	}
}

1342 
Void
 
	$£tSumm¨yPicFûíameBa£
(c⁄° 
°d
::
°rög
 &
s
Ë{ 
m_summ¨yPicFûíameBa£
 = s; 
	}
}

1343 c⁄° 
	g°d
::
°rög
& 
	$gëSumm¨yPicFûíameBa£
(Ëc⁄° {  
m_summ¨yPicFûíameBa£
; 
	}
}

1345 
Void
 
	$£tSumm¨yVîbo£√ss
(
UI¡
 
v
Ë{ 
m_summ¨yVîbo£√ss
 = v; 
	}
}

1346 
UI¡
 
	$gëSumm¨yVîbo£√ss
–Ëc⁄° {  
m_summ¨yVîbo£√ss
; 
	}
}

	@TLibEncoder/TEncCu.cpp

38 
	~<°dio.h
>

39 
	~"TEncT›.h
"

40 
	~"TEncCu.h
"

41 
	~"TEncA«lyze.h
"

42 
	~"TLibComm⁄/Debug.h
"

44 
	~<cm©h
>

45 
	~<Æg‹ôhm
>

46 
usög
 
«me•a˚
 
	g°d
;

62 
Void
 
	gTEncCu
::
	$¸óã
(
UCh¨
 
uhTŸÆDïth
, 
UI¡
 
uiMaxWidth
, UI¡ 
uiMaxHeight
, 
ChromaF‹m©
 
chromaF‹m©
)

64 
I¡
 
i
;

66 
m_uhTŸÆDïth
 = 
uhTŸÆDïth
 + 1;

67 
m_µcBe°CU
 = 
√w
 
TComD©aCU
*[
m_uhTŸÆDïth
-1];

68 
m_µcTempCU
 = 
√w
 
TComD©aCU
*[
m_uhTŸÆDïth
-1];

70 
m_µcPªdYuvBe°
 = 
√w
 
TComYuv
*[
m_uhTŸÆDïth
-1];

71 
m_µcResiYuvBe°
 = 
√w
 
TComYuv
*[
m_uhTŸÆDïth
-1];

72 
m_µcRecoYuvBe°
 = 
√w
 
TComYuv
*[
m_uhTŸÆDïth
-1];

73 
m_µcPªdYuvTemp
 = 
√w
 
TComYuv
*[
m_uhTŸÆDïth
-1];

74 
m_µcResiYuvTemp
 = 
√w
 
TComYuv
*[
m_uhTŸÆDïth
-1];

75 
m_µcRecoYuvTemp
 = 
√w
 
TComYuv
*[
m_uhTŸÆDïth
-1];

76 
m_µcOrigYuv
 = 
√w
 
TComYuv
*[
m_uhTŸÆDïth
-1];

78 
UI¡
 
uiNumP¨tôi⁄s
;

79  
i
=0 ; i<
m_uhTŸÆDïth
-1 ; i++)

81 
uiNumP¨tôi⁄s
 = 1<<––
m_uhTŸÆDïth
 - 
i
 - 1 )<<1 );

82 
UI¡
 
uiWidth
 = 
uiMaxWidth
 >> 
i
;

83 
UI¡
 
uiHeight
 = 
uiMaxHeight
 >> 
i
;

85 
m_µcBe°CU
[
i
] = 
√w
 
TComD©aCU
; m_µcBe°CU[i]->
	`¸óã
–
chromaF‹m©
, 
uiNumP¨tôi⁄s
, 
uiWidth
, 
uiHeight
, 
Ál£
, 
uiMaxWidth
 >> (
m_uhTŸÆDïth
 - 1) );

86 
m_µcTempCU
[
i
] = 
√w
 
TComD©aCU
; m_µcTempCU[i]->
	`¸óã
–
chromaF‹m©
, 
uiNumP¨tôi⁄s
, 
uiWidth
, 
uiHeight
, 
Ál£
, 
uiMaxWidth
 >> (
m_uhTŸÆDïth
 - 1) );

88 
m_µcPªdYuvBe°
[
i
] = 
√w
 
TComYuv
; m_µcPªdYuvBe°[i]->
	`¸óã
(
uiWidth
, 
uiHeight
, 
chromaF‹m©
);

89 
m_µcResiYuvBe°
[
i
] = 
√w
 
TComYuv
; m_µcResiYuvBe°[i]->
	`¸óã
(
uiWidth
, 
uiHeight
, 
chromaF‹m©
);

90 
m_µcRecoYuvBe°
[
i
] = 
√w
 
TComYuv
; m_µcRecoYuvBe°[i]->
	`¸óã
(
uiWidth
, 
uiHeight
, 
chromaF‹m©
);

92 
m_µcPªdYuvTemp
[
i
] = 
√w
 
TComYuv
; m_µcPªdYuvTemp[i]->
	`¸óã
(
uiWidth
, 
uiHeight
, 
chromaF‹m©
);

93 
m_µcResiYuvTemp
[
i
] = 
√w
 
TComYuv
; m_µcResiYuvTemp[i]->
	`¸óã
(
uiWidth
, 
uiHeight
, 
chromaF‹m©
);

94 
m_µcRecoYuvTemp
[
i
] = 
√w
 
TComYuv
; m_µcRecoYuvTemp[i]->
	`¸óã
(
uiWidth
, 
uiHeight
, 
chromaF‹m©
);

96 
m_µcOrigYuv
 [
i
] = 
√w
 
TComYuv
; m_µcOrigYuv [i]->
	`¸óã
(
uiWidth
, 
uiHeight
, 
chromaF‹m©
);

99 
m_bEncodeDQP
 = 
Ál£
;

100 
m_°ûlToCodeChromaQpOff£tFœg
 = 
Ál£
;

101 
m_cuChromaQpOff£tIdxPlus1
 = 0;

102 
m_bFa°DñèQP
 = 
Ál£
;

105 
UI¡
* 
piTmp
 = &
g_auiZsˇnToRa°î
[0];

106 
	`öôZsˇnToRa°î
–
m_uhTŸÆDïth
, 1, 0, 
piTmp
);

107 
	`öôRa°îToZsˇn
–
uiMaxWidth
, 
uiMaxHeight
, 
m_uhTŸÆDïth
 );

110 
	`öôRa°îToPñXY
–
uiMaxWidth
, 
uiMaxHeight
, 
m_uhTŸÆDïth
 );

111 
	}
}

113 
Void
 
	gTEncCu
::
	$de°roy
()

115 
I¡
 
i
;

117  
i
=0 ; i<
m_uhTŸÆDïth
-1 ; i++)

119 if(
m_µcBe°CU
[
i
])

121 
m_µcBe°CU
[
i
]->
	`de°roy
(); 
dñëe
 m_µcBe°CU[i]; m_µcBe°CU[i] = 
NULL
;

123 if(
m_µcTempCU
[
i
])

125 
m_µcTempCU
[
i
]->
	`de°roy
(); 
dñëe
 m_µcTempCU[i]; m_µcTempCU[i] = 
NULL
;

127 if(
m_µcPªdYuvBe°
[
i
])

129 
m_µcPªdYuvBe°
[
i
]->
	`de°roy
(); 
dñëe
 m_µcPªdYuvBe°[i]; m_µcPªdYuvBe°[i] = 
NULL
;

131 if(
m_µcResiYuvBe°
[
i
])

133 
m_µcResiYuvBe°
[
i
]->
	`de°roy
(); 
dñëe
 m_µcResiYuvBe°[i]; m_µcResiYuvBe°[i] = 
NULL
;

135 if(
m_µcRecoYuvBe°
[
i
])

137 
m_µcRecoYuvBe°
[
i
]->
	`de°roy
(); 
dñëe
 m_µcRecoYuvBe°[i]; m_µcRecoYuvBe°[i] = 
NULL
;

139 if(
m_µcPªdYuvTemp
[
i
])

141 
m_µcPªdYuvTemp
[
i
]->
	`de°roy
(); 
dñëe
 m_µcPªdYuvTemp[i]; m_µcPªdYuvTemp[i] = 
NULL
;

143 if(
m_µcResiYuvTemp
[
i
])

145 
m_µcResiYuvTemp
[
i
]->
	`de°roy
(); 
dñëe
 m_µcResiYuvTemp[i]; m_µcResiYuvTemp[i] = 
NULL
;

147 if(
m_µcRecoYuvTemp
[
i
])

149 
m_µcRecoYuvTemp
[
i
]->
	`de°roy
(); 
dñëe
 m_µcRecoYuvTemp[i]; m_µcRecoYuvTemp[i] = 
NULL
;

151 if(
m_µcOrigYuv
[
i
])

153 
m_µcOrigYuv
[
i
]->
	`de°roy
(); 
dñëe
 m_µcOrigYuv[i]; m_µcOrigYuv[i] = 
NULL
;

156 if(
m_µcBe°CU
)

158 
dñëe
 [] 
m_µcBe°CU
;

159 
m_µcBe°CU
 = 
NULL
;

161 if(
m_µcTempCU
)

163 
dñëe
 [] 
m_µcTempCU
;

164 
m_µcTempCU
 = 
NULL
;

167 if(
m_µcPªdYuvBe°
)

169 
dñëe
 [] 
m_µcPªdYuvBe°
;

170 
m_µcPªdYuvBe°
 = 
NULL
;

172 if(
m_µcResiYuvBe°
)

174 
dñëe
 [] 
m_µcResiYuvBe°
;

175 
m_µcResiYuvBe°
 = 
NULL
;

177 if(
m_µcRecoYuvBe°
)

179 
dñëe
 [] 
m_µcRecoYuvBe°
;

180 
m_µcRecoYuvBe°
 = 
NULL
;

182 if(
m_µcPªdYuvTemp
)

184 
dñëe
 [] 
m_µcPªdYuvTemp
;

185 
m_µcPªdYuvTemp
 = 
NULL
;

187 if(
m_µcResiYuvTemp
)

189 
dñëe
 [] 
m_µcResiYuvTemp
;

190 
m_µcResiYuvTemp
 = 
NULL
;

192 if(
m_µcRecoYuvTemp
)

194 
dñëe
 [] 
m_µcRecoYuvTemp
;

195 
m_µcRecoYuvTemp
 = 
NULL
;

197 if(
m_µcOrigYuv
)

199 
dñëe
 [] 
m_µcOrigYuv
;

200 
m_µcOrigYuv
 = 
NULL
;

202 
	}
}

206 
Void
 
	gTEncCu
::
	$öô
–
TEncT›
* 
pcEncT›
 )

208 
m_pcEncCfg
 = 
pcEncT›
;

209 
m_pcPªdSórch
 = 
pcEncT›
->
	`gëPªdSórch
();

210 
m_pcTrQu™t
 = 
pcEncT›
->
	`gëTrQu™t
();

211 
m_pcRdCo°
 = 
pcEncT›
->
	`gëRdCo°
();

213 
m_pcE¡r›yCodî
 = 
pcEncT›
->
	`gëE¡r›yCodî
();

214 
m_pcBöCABAC
 = 
pcEncT›
->
	`gëBöCABAC
();

216 
m_µpcRDSbacCodî
 = 
pcEncT›
->
	`gëRDSbacCodî
();

217 
m_pcRDGoOnSbacCodî
 = 
pcEncT›
->
	`gëRDGoOnSbacCodî
();

219 
m_pcR©eCål
 = 
pcEncT›
->
	`gëR©eCål
();

220 
m_lumaQPOff£t
 = 0;

221 
	`öôLumaDñèQpLUT
();

222 
	}
}

231 
Void
 
	gTEncCu
::
	$com¥essCtu
–
TComD©aCU
* 
pCtu
 )

234 
m_µcBe°CU
[0]->
	`öôCtu
–
pCtu
->
	`gëPic
(),ÖCtu->
	`gëCtuRsAddr
() );

235 
m_µcTempCU
[0]->
	`öôCtu
–
pCtu
->
	`gëPic
(),ÖCtu->
	`gëCtuRsAddr
() );

236 
m_bEncodeDQP
 = 
Ál£
;

239 
	`DEBUG_STRING_NEW
(
sDebug
)

241 
	`xCom¥essCU
–
m_µcBe°CU
[0], 
m_µcTempCU
[0], 0 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

242 
	`DEBUG_STRING_OUTPUT
(
°d
::
cout
, 
sDebug
)

244 #i‡
ADAPTIVE_QP_SELECTION


245 if–
m_pcEncCfg
->
	`gëU£Ad≠tQpSñe˘
() )

247 if(
pCtu
->
	`gëSli˚
()->
	`gëSli˚Ty≥
()!=
I_SLICE
)

249 
	`xCtuCﬁÀ˘ARLSèts
–
pCtu
 );

253 
	}
}

256 
Void
 
	gTEncCu
::
	$ícodeCtu
 ( 
TComD©aCU
* 
pCtu
 )

258 i‡–
pCtu
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£DQP
() )

260 
	`£tdQPFœg
(
åue
);

263 i‡–
pCtu
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
() )

265 
	`£tCodeChromaQpAdjFœg
(
åue
);

269 
	`xEncodeCU
–
pCtu
, 0, 0 );

270 
	}
}

276 
Void
 
	gTEncCu
::
	$öôLumaDñèQpLUT
()

278 c⁄° 
LumaLevñToDñèQPM≠pög
 &
m≠pög
=
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
();

280 i‡–!
m≠pög
.
	`isE«bÀd
() )

287 
I¡
 
œ°DñèQPVÆue
=0;

288 
°d
::
size_t
 
√xtS∑r£Index
=0;

289 
I¡
 
ödex
=0; index<
LUMA_LEVEL_TO_DQP_LUT_MAXSIZE
; index++)

291 
√xtS∑r£Index
 < 
m≠pög
.m≠pög.
	`size
(Ë&& 
ödex
>=m≠pög.m≠pög[√xtS∑r£Index].
fú°
)

293 
œ°DñèQPVÆue
=
m≠pög
.m≠pög[
√xtS∑r£Index
].
£c⁄d
;

294 
√xtS∑r£Index
++;

296 
m_lumaLevñToDñèQPLUT
[
ödex
]=
œ°DñèQPVÆue
;

298 
	}
}

300 
I¡
 
	gTEncCu
::
	$ˇlcuœãLumaDQP
(
TComD©aCU
 *
pCU
, c⁄° 
UI¡
 
absP¨tIdx
, c⁄° 
TComYuv
 * 
pOrgYuv
)

302 c⁄° 
Pñ
 *
pY
 = 
pOrgYuv
->
	`gëAddr
(
COMPONENT_Y
, 
absP¨tIdx
);

303 c⁄° 
I¡
 
°ride
 = 
pOrgYuv
->
	`gëSåide
(
COMPONENT_Y
);

304 
I¡
 
width
 = 
pCU
->
	`gëWidth
(
absP¨tIdx
);

305 
I¡
 
height
 = 
pCU
->
	`gëHeight
(
absP¨tIdx
);

306 
DoubÀ
 
avg
 = 0;

309 c⁄° 
TComSPS
* 
pSPS
 = 
pCU
->
	`gëSli˚
()->
	`gëSPS
();

310 i‡–
pCU
->
	`gëCUPñX
(Ë+ 
width
 > 
pSPS
->
	`gëPicWidthInLumaSam∂es
() )

312 
width
 = 
pSPS
->
	`gëPicWidthInLumaSam∂es
(Ë- 
pCU
->
	`gëCUPñX
();

314 i‡–
pCU
->
	`gëCUPñY
(Ë+ 
height
 > 
pSPS
->
	`gëPicHeightInLumaSam∂es
() )

316 
height
 = 
pSPS
->
	`gëPicHeightInLumaSam∂es
(Ë- 
pCU
->
	`gëCUPñY
();

320 i‡–
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
mode
 =
LUMALVL_TO_DQP_AVG_METHOD
 )

323 
I¡
 
sum
 = 0;

324 
I¡
 
y
 = 0; y < 
height
; y++)

326 
I¡
 
x
 = 0; x < 
width
; x++)

328 
sum
 +
pY
[
x
];

330 
pY
 +
°ride
;

332 
avg
 = (
DoubÀ
)
sum
/(
width
*
height
);

337 
I¡
 
maxVÆ
 = 0;

338 
I¡
 
y
 = 0; y < 
height
; y++)

340 
I¡
 
x
 = 0; x < 
width
; x++)

342 i‡(
pY
[
x
] > 
maxVÆ
)

344 
maxVÆ
 = 
pY
[
x
];

347 
pY
 +
°ride
;

350 
avg
 = (
DoubÀ
)
maxVÆ
 * 
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
maxMëhodWeight
;

353 
I¡
 
lumaIdx
 = 
Clù3
<I¡>(0, 
	`I¡
(
LUMA_LEVEL_TO_DQP_LUT_MAXSIZE
)-1, I¡(
avg
+0.5) );

354 
I¡
 
QP
 = 
m_lumaLevñToDñèQPLUT
[
lumaIdx
];

355  
QP
;

356 
	}
}

359 #i‡
AMP_ENC_SPEEDUP


360 #i‡
AMP_MRG


361 
Void
 
	gTEncCu
::
	$dîiveTe°ModeAMP
 (
TComD©aCU
 *
pcBe°CU
, 
P¨tSize
 
eP¨ítP¨tSize
, 
Boﬁ
 &
bTe°AMP_H‹
, Boﬁ &
bTe°AMP_Vî
, Boﬁ &
bTe°MîgeAMP_H‹
, Boﬁ &
bTe°MîgeAMP_Vî
)

363 
Void
 
TEncCu
::
	$dîiveTe°ModeAMP
 (
TComD©aCU
 *
pcBe°CU
, 
P¨tSize
 
eP¨ítP¨tSize
, 
Boﬁ
 &
bTe°AMP_H‹
, Boﬁ &
bTe°AMP_Vî
)

366 i‡–
pcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2NxN
 )

368 
bTe°AMP_H‹
 = 
åue
;

370 i‡–
pcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_Nx2N
 )

372 
bTe°AMP_Vî
 = 
åue
;

374 i‡–
pcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2Nx2N
 &&ÖcBe°CU->
	`gëMîgeFœg
(0Ë=
Ál£
 &&ÖcBe°CU->
	`isSkù≥d
(0) == false )

376 
bTe°AMP_H‹
 = 
åue
;

377 
bTe°AMP_Vî
 = 
åue
;

380 #i‡
AMP_MRG


382 i‡–
eP¨ítP¨tSize
 >
SIZE_2NxnU
 &&ÉP¨ítP¨tSizê<
SIZE_nRx2N
 )

384 
bTe°MîgeAMP_H‹
 = 
åue
;

385 
bTe°MîgeAMP_Vî
 = 
åue
;

388 i‡–
eP¨ítP¨tSize
 =
NUMBER_OF_PART_SIZES
 )

390 i‡–
pcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2NxN
 )

392 
bTe°MîgeAMP_H‹
 = 
åue
;

394 i‡–
pcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_Nx2N
 )

396 
bTe°MîgeAMP_Vî
 = 
åue
;

400 i‡–
pcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2Nx2N
 &&ÖcBe°CU->
	`isSkù≥d
(0Ë=
Ál£
 )

402 
bTe°MîgeAMP_H‹
 = 
åue
;

403 
bTe°MîgeAMP_Vî
 = 
åue
;

406 i‡–
pcBe°CU
->
	`gëWidth
(0) == 64 )

408 
bTe°AMP_H‹
 = 
Ál£
;

409 
bTe°AMP_Vî
 = 
Ál£
;

413 i‡–
eP¨ítP¨tSize
 >
SIZE_2NxnU
 &&ÉP¨ítP¨tSizê<
SIZE_nRx2N
 )

415 
bTe°AMP_H‹
 = 
åue
;

416 
bTe°AMP_Vî
 = 
åue
;

419 i‡–
eP¨ítP¨tSize
 =
SIZE_2Nx2N
 )

421 
bTe°AMP_H‹
 = 
Ál£
;

422 
bTe°AMP_Vî
 = 
Ál£
;

425 
	}
}

435 #i‡
AMP_ENC_SPEEDUP


436 
Void
 
	gTEncCu
::
xCom¥essCU
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, c⁄° 
UI¡
 
uiDïth
 
DEBUG_STRING_FN_DECLARE
(
sDebug_
), 
P¨tSize
 
eP¨ítP¨tSize
 )

438 
Void
 
	gTEncCu
::
	$xCom¥essCU
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, c⁄° 
UI¡
 
uiDïth
 )

441 
TComPic
* 
pcPic
 = 
ΩcBe°CU
->
	`gëPic
();

442 
	`DEBUG_STRING_NEW
(
sDebug
)

443 c⁄° 
TComPPS
 &
µs
=*(
ΩcTempCU
->
	`gëSli˚
()->
	`gëPPS
());

444 c⁄° 
TComSPS
 &
•s
=*(
ΩcTempCU
->
	`gëSli˚
()->
	`gëSPS
());

447 c⁄° 
UI¡
 
Á°DñèQPCuMaxSize
 = 
	`Clù3
(
•s
.
	`gëMaxCUHeight
()>>•s.
	`gëLog2DiffMaxMöCodögBlockSize
(), sps.getMaxCUHeight(), 32u);

450 
m_µcOrigYuv
[
uiDïth
]->
	`c›yFromPicYuv
–
pcPic
->
	`gëPicYuvOrg
(), 
ΩcBe°CU
->
	`gëCtuRsAddr
(),ÑpcBe°CU->
	`gëZ‹dîIdxInCtu
() );

453 
Boﬁ
 
doNŸBlockPu
 = 
åue
;

454 
Boﬁ
 
óæyDëe˘i⁄SkùMode
 = 
Ál£
;

456 c⁄° 
UI¡
 
uiLPñX
 = 
ΩcBe°CU
->
	`gëCUPñX
();

457 c⁄° 
UI¡
 
uiRPñX
 = 
uiLPñX
 + 
ΩcBe°CU
->
	`gëWidth
(0) - 1;

458 c⁄° 
UI¡
 
uiTPñY
 = 
ΩcBe°CU
->
	`gëCUPñY
();

459 c⁄° 
UI¡
 
uiBPñY
 = 
uiTPñY
 + 
ΩcBe°CU
->
	`gëHeight
(0) - 1;

460 c⁄° 
UI¡
 
uiWidth
 = 
ΩcBe°CU
->
	`gëWidth
(0);

462 
I¡
 
iBa£QP
 = 
	`xCompuãQP
–
ΩcBe°CU
, 
uiDïth
 );

463 
I¡
 
iMöQP
;

464 
I¡
 
iMaxQP
;

465 
Boﬁ
 
isAddLowe°QP
 = 
Ál£
;

467 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
ΩcBe°CU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

469 if–
uiDïth
 <
µs
.
	`gëMaxCuDQPDïth
() )

471 
I¡
 
idQP
 = 
m_pcEncCfg
->
	`gëMaxDñèQP
();

472 
iMöQP
 = 
	`Clù3
–-
•s
.
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
iBa£QP
-
idQP
 );

473 
iMaxQP
 = 
	`Clù3
–-
•s
.
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
iBa£QP
+
idQP
 );

477 
iMöQP
 = 
ΩcTempCU
->
	`gëQP
(0);

478 
iMaxQP
 = 
ΩcTempCU
->
	`gëQP
(0);

481 i‡–
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
() )

483 i‡–
uiDïth
 <
µs
.
	`gëMaxCuDQPDïth
() )

486 
m_lumaQPOff£t
 = 
	`ˇlcuœãLumaDQP
(
ΩcTempCU
, 0, 
m_µcOrigYuv
[
uiDïth
]);

488 
iMöQP
 = 
	`Clù3
(-
•s
.
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
iBa£QP
 - 
m_lumaQPOff£t
);

489 
iMaxQP
 = 
iMöQP
;

492 i‡–
m_pcEncCfg
->
	`gëU£R©eCål
() )

494 
iMöQP
 = 
m_pcR©eCål
->
	`gëRCQP
();

495 
iMaxQP
 = 
m_pcR©eCål
->
	`gëRCQP
();

500 c⁄° 
I¡
 
lowe°QP
 = 
iMöQP
;

502 i‡–(
µs
.
	`gëTønsqu™tBy∑ssE«bÀdFœg
()) )

504 
isAddLowe°QP
 = 
åue
;

505 
iMöQP
 = iMinQP - 1;

506 i‡–
m_pcEncCfg
->
	`gëCUTønsqu™tBy∑ssFœgF‹˚VÆue
() )

508 
iMaxQP
 = 
iMöQP
;

512 
TComSli˚
 * 
pcSli˚
 = 
ΩcTempCU
->
	`gëPic
()->
	`gëSli˚
‘pcTempCU->gëPic()->
	`gëCuºSli˚Idx
());

514 c⁄° 
Boﬁ
 
bBound¨y
 = !–
uiRPñX
 < 
•s
.
	`gëPicWidthInLumaSam∂es
(Ë&& 
uiBPñY
 < sps.
	`gëPicHeightInLumaSam∂es
() );

516 i‡–!
bBound¨y
 )

518 
I¡
 
iQP
=
iMöQP
; iQP<=
iMaxQP
; iQP++)

520 c⁄° 
Boﬁ
 
bIsLos¶essMode
 = 
isAddLowe°QP
 && (
iQP
 =
iMöQP
);

522 i‡(
bIsLos¶essMode
)

524 
iQP
 = 
lowe°QP
;

526 i‡–
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
(Ë&& 
uiDïth
 <
µs
.
	`gëMaxCuDQPDïth
() )

528 
	`gëSli˚Encodî
()->
	`upd©eLambda
(
pcSli˚
, 
iQP
);

531 
m_cuChromaQpOff£tIdxPlus1
 = 0;

532 i‡(
pcSli˚
->
	`gëU£ChromaQpAdj
())

539 
I¡
 
lgMöCuSize
 = 
•s
.
	`gëLog2MöCodögBlockSize
() +

540 
°d
::
max
<
I¡
>(0, 
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
()-
	`I¡
(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëDiffCuChromaQpOff£tDïth
()));

541 
m_cuChromaQpOff£tIdxPlus1
 = ((
uiLPñX
 >> 
lgMöCuSize
Ë+ (
uiTPñY
 >>ÜgMöCuSize)Ë% (
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°Lí
() + 1);

544 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

547 if–
ΩcBe°CU
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë!
I_SLICE
 )

550 if(
m_pcEncCfg
->
	`gëU£E¨lySkùDëe˘i⁄
())

552 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2Nx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

553 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

556 
	`xCheckRDCo°Mîge2Nx2N
–
ΩcBe°CU
, 
ΩcTempCU
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
), &
óæyDëe˘i⁄SkùMode
 );

557 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

559 if(!
m_pcEncCfg
->
	`gëU£E¨lySkùDëe˘i⁄
())

562 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2Nx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

563 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

564 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
())

566 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

571 i‡(
bIsLos¶essMode
)

573 
iQP
 = 
iMöQP
;

577 if(!
óæyDëe˘i⁄SkùMode
)

579 
I¡
 
iQP
=
iMöQP
; iQP<=
iMaxQP
; iQP++)

581 c⁄° 
Boﬁ
 
bIsLos¶essMode
 = 
isAddLowe°QP
 && (
iQP
 =
iMöQP
);

583 i‡(
bIsLos¶essMode
)

585 
iQP
 = 
lowe°QP
;

588 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

591 if–
ΩcBe°CU
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë!
I_SLICE
 )

595 if(!–(
ΩcBe°CU
->
	`gëWidth
(0)==8Ë&& (ΩcBe°CU->
	`gëHeight
(0)==8) ))

597 if–
uiDïth
 =
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
(Ë&& 
doNŸBlockPu
)

599 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_NxN
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

600 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

604 if(
doNŸBlockPu
)

606 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_Nx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

607 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

608 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_Nx2N
 )

610 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

613 if(
doNŸBlockPu
)

615 
	`xCheckRDCo°I¡î
 ( 
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2NxN
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

616 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

617 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2NxN
)

619 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

624 if(
•s
.
	`gëU£AMP
(Ë&& 
uiDïth
 < sps.
	`gëLog2DiffMaxMöCodögBlockSize
() )

626 #i‡
AMP_ENC_SPEEDUP


627 
Boﬁ
 
bTe°AMP_H‹
 = 
Ál£
, 
bTe°AMP_Vî
 = false;

629 #i‡
AMP_MRG


630 
Boﬁ
 
bTe°MîgeAMP_H‹
 = 
Ál£
, 
bTe°MîgeAMP_Vî
 = false;

632 
	`dîiveTe°ModeAMP
 (
ΩcBe°CU
, 
eP¨ítP¨tSize
, 
bTe°AMP_H‹
, 
bTe°AMP_Vî
, 
bTe°MîgeAMP_H‹
, 
bTe°MîgeAMP_Vî
);

634 
	`dîiveTe°ModeAMP
 (
ΩcBe°CU
, 
eP¨ítP¨tSize
, 
bTe°AMP_H‹
, 
bTe°AMP_Vî
);

638 i‡–
bTe°AMP_H‹
 )

640 if(
doNŸBlockPu
)

642 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2NxnU
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

643 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

644 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2NxnU
 )

646 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

649 if(
doNŸBlockPu
)

651 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2NxnD
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

652 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

653 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2NxnD
 )

655 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

659 #i‡
AMP_MRG


660 i‡–
bTe°MîgeAMP_H‹
 )

662 if(
doNŸBlockPu
)

664 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2NxnU
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
), 
åue
 );

665 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

666 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2NxnU
 )

668 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

671 if(
doNŸBlockPu
)

673 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2NxnD
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
), 
åue
 );

674 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

675 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2NxnD
 )

677 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

684 i‡–
bTe°AMP_Vî
 )

686 if(
doNŸBlockPu
)

688 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_nLx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

689 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

690 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_nLx2N
 )

692 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

695 if(
doNŸBlockPu
)

697 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_nRx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

698 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

701 #i‡
AMP_MRG


702 i‡–
bTe°MîgeAMP_Vî
 )

704 if(
doNŸBlockPu
)

706 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_nLx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
), 
åue
 );

707 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

708 if(
m_pcEncCfg
->
	`gëU£CbfFa°Mode
(Ë&& 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_nLx2N
 )

710 
doNŸBlockPu
 = 
ΩcBe°CU
->
	`gëQtRoŸCbf
( 0 ) != 0;

713 if(
doNŸBlockPu
)

715 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_nRx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
), 
åue
 );

716 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

722 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2NxnU
 );

723 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

724 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2NxnD
 );

725 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

726 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_nLx2N
 );

727 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

729 
	`xCheckRDCo°I¡î
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_nRx2N
 );

730 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

738 #i‡
MCTS_ENC_CHECK


739 i‡–
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
(Ë|| (
ΩcBe°CU
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë=
I_SLICE
) ||

740 ((!
m_pcEncCfg
->
	`gëDißbÀI¡øPUsInI¡îSli˚s
()) && (

741 (
ΩcBe°CU
->
	`gëCbf
(0, 
COMPONENT_Y
) != 0) ||

742 ((
ΩcBe°CU
->
	`gëCbf
(0, 
COMPONENT_Cb
Ë!0Ë&& (
numbîVÆidComp⁄íts
 > COMPONENT_Cb)) ||

743 ((
ΩcBe°CU
->
	`gëCbf
(0, 
COMPONENT_Cr
Ë!0Ë&& (
numbîVÆidComp⁄íts
 > COMPONENT_Cr))

747 if((
ΩcBe°CU
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë=
I_SLICE
) ||

748 ((!
m_pcEncCfg
->
	`gëDißbÀI¡øPUsInI¡îSli˚s
()) && (

749 (
ΩcBe°CU
->
	`gëCbf
–0, 
COMPONENT_Y
 ) != 0) ||

750 ((
ΩcBe°CU
->
	`gëCbf
–0, 
COMPONENT_Cb
 ) !0Ë&& (
numbîVÆidComp⁄íts
 > COMPONENT_Cb)) ||

751 ((
ΩcBe°CU
->
	`gëCbf
–0, 
COMPONENT_Cr
 ) !0Ë&& (
numbîVÆidComp⁄íts
 > COMPONENT_Cr))

755 
	`xCheckRDCo°I¡ø
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_2Nx2N
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

756 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

757 if–
uiDïth
 =
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
() )

759 if–
ΩcTempCU
->
	`gëWidth
(0Ë> ( 1 << 
•s
.
	`gëQuadåìTULog2MöSize
() ) )

761 
	`xCheckRDCo°I¡ø
–
ΩcBe°CU
, 
ΩcTempCU
, 
SIZE_NxN
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

762 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

768 if(
•s
.
	`gëU£PCM
()

769 && 
ΩcTempCU
->
	`gëWidth
(0Ë<(1<<
•s
.
	`gëPCMLog2MaxSize
())

770 && 
ΩcTempCU
->
	`gëWidth
(0Ë>(1<<
•s
.
	`gëPCMLog2MöSize
()) )

772 
UI¡
 
uiRawBôs
 = 
	`gëTŸÆBôs
(
ΩcBe°CU
->
	`gëWidth
(0),ÑpcBe°CU->
	`gëHeight
(0),ÑpcBe°CU->
	`gëPic
()->
	`gëChromaF‹m©
(), 
•s
.
	`gëBôDïths
().
ªc⁄
);

773 
UI¡
 
uiBe°Bôs
 = 
ΩcBe°CU
->
	`gëTŸÆBôs
();

774 if((
uiBe°Bôs
 > 
uiRawBôs
Ë|| (
ΩcBe°CU
->
	`gëTŸÆCo°
(Ë> 
m_pcRdCo°
->
	`ˇlcRdCo°
(uiRawBits, 0)))

776 
	`xCheckI¡øPCM
 (
ΩcBe°CU
, 
ΩcTempCU
);

777 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

781 i‡(
bIsLos¶essMode
)

783 
iQP
 = 
iMöQP
;

788 if–
ΩcBe°CU
->
	`gëTŸÆCo°
()!=
MAX_DOUBLE
 )

790 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_NEXT_BEST
]);

791 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

792 
m_pcE¡r›yCodî
->
	`ícodeS∂ôFœg
–
ΩcBe°CU
, 0, 
uiDïth
, 
åue
 );

793 
ΩcBe°CU
->
	`gëTŸÆBôs
(Ë+
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

794 
ΩcBe°CU
->
	`gëTŸÆBös
(Ë+((
TEncBöCABAC
 *)((
TEncSbac
*)
m_pcE¡r›yCodî
->
m_pcE¡r›yCodîIf
)->
	`gëEncBöIf
())->
	`gëBösCoded
();

795 
ΩcBe°CU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–ΩcBe°CU->
	`gëTŸÆBôs
(),ÑpcBe°CU->
	`gëTŸÆDi°‹ti⁄
() );

796 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_NEXT_BEST
]);

801 if–
ΩcBe°CU
->
	`gëTŸÆCo°
()!=
MAX_DOUBLE
 &&ÑpcBe°CU->
	`isLos¶essCoded
(0Ë&& (ΩcBe°CU->
	`gëIPCMFœg
(0Ë=
Ál£
))

803 
	`xFûlPCMBuf„r
(
ΩcBe°CU
, 
m_µcOrigYuv
[
uiDïth
]);

806 if–
uiDïth
 =
µs
.
	`gëMaxCuDQPDïth
() )

808 
I¡
 
idQP
 = 
m_pcEncCfg
->
	`gëMaxDñèQP
();

809 
iMöQP
 = 
	`Clù3
–-
•s
.
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
iBa£QP
-
idQP
 );

810 
iMaxQP
 = 
	`Clù3
–-
•s
.
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
iBa£QP
+
idQP
 );

812 if–
uiDïth
 < 
µs
.
	`gëMaxCuDQPDïth
() )

814 
iMöQP
 = 
iBa£QP
;

815 
iMaxQP
 = 
iBa£QP
;

819 c⁄° 
I¡
 
iSèπQP
 = 
ΩcTempCU
->
	`gëQP
(0);

820 
iMöQP
 = 
iSèπQP
;

821 
iMaxQP
 = 
iSèπQP
;

824 i‡–
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
() )

826 
iMöQP
 = 
	`Clù3
(-
•s
.
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
iBa£QP
 - 
m_lumaQPOff£t
);

827 
iMaxQP
 = 
iMöQP
;

830 i‡–
m_pcEncCfg
->
	`gëU£R©eCål
() )

832 
iMöQP
 = 
m_pcR©eCål
->
	`gëRCQP
();

833 
iMaxQP
 = 
m_pcR©eCål
->
	`gëRCQP
();

836 i‡–
m_pcEncCfg
->
	`gëCUTønsqu™tBy∑ssFœgF‹˚VÆue
() )

838 
iMaxQP
 = 
iMöQP
;

841 c⁄° 
Boﬁ
 
bSubBønch
 = 
bBound¨y
 || !–
m_pcEncCfg
->
	`gëU£E¨lyCU
(Ë&& 
ΩcBe°CU
->
	`gëTŸÆCo°
()!=
MAX_DOUBLE
 &&ÑpcBe°CU->
	`isSkù≥d
(0) );

843 if–
bSubBønch
 && 
uiDïth
 < 
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
(Ë&& (!
	`gëFa°DñèQp
(Ë|| 
uiWidth
 > 
Á°DñèQPCuMaxSize
 || 
bBound¨y
))

846 
DoubÀ
 
•lôTŸÆCo°
 = 0;

848 
I¡
 
iQP
=
iMöQP
; iQP<=
iMaxQP
; iQP++)

850 c⁄° 
Boﬁ
 
bIsLos¶essMode
 = 
Ál£
;

852 
ΩcTempCU
->
	`öôE°D©a
–
uiDïth
, 
iQP
, 
bIsLos¶essMode
 );

854 
UCh¨
 
uhNextDïth
 = 
uiDïth
+1;

855 
TComD©aCU
* 
pcSubBe°P¨tCU
 = 
m_µcBe°CU
[
uhNextDïth
];

856 
TComD©aCU
* 
pcSubTempP¨tCU
 = 
m_µcTempCU
[
uhNextDïth
];

857 
	`DEBUG_STRING_NEW
(
sTempDebug
)

859  
UI¡
 
uiP¨tUnôIdx
 = 0; uiPartUnitIdx < 4; uiPartUnitIdx++ )

861 
pcSubBe°P¨tCU
->
	`öôSubCU
–
ΩcTempCU
, 
uiP¨tUnôIdx
, 
uhNextDïth
, 
iQP
 );

862 
pcSubTempP¨tCU
->
	`öôSubCU
–
ΩcTempCU
, 
uiP¨tUnôIdx
, 
uhNextDïth
, 
iQP
 );

864 if––
pcSubBe°P¨tCU
->
	`gëCUPñX
(Ë< 
•s
.
	`gëPicWidthInLumaSam∂es
(ËË&& (ÖcSubBe°P¨tCU->
	`gëCUPñY
(Ë< sps.
	`gëPicHeightInLumaSam∂es
() ) )

866 i‡–0 =
uiP¨tUnôIdx
)

868 
m_µpcRDSbacCodî
[
uhNextDïth
][
CI_CURR_BEST
]->
	`lﬂd
(m_µpcRDSbacCodî[
uiDïth
][CI_CURR_BEST]);

872 
m_µpcRDSbacCodî
[
uhNextDïth
][
CI_CURR_BEST
]->
	`lﬂd
(m_µpcRDSbacCodî[uhNextDïth][
CI_NEXT_BEST
]);

875 #i‡
AMP_ENC_SPEEDUP


876 
	`DEBUG_STRING_NEW
(
sChûd
)

877 i‡–!(
ΩcBe°CU
->
	`gëTŸÆCo°
()!=
MAX_DOUBLE
 &&ÑpcBe°CU->
	`isI¡î
(0)) )

879 
	`xCom¥essCU
–
pcSubBe°P¨tCU
, 
pcSubTempP¨tCU
, 
uhNextDïth
 
	`DEBUG_STRING_PASS_INTO
(
sChûd
), 
NUMBER_OF_PART_SIZES
 );

884 
	`xCom¥essCU
–
pcSubBe°P¨tCU
, 
pcSubTempP¨tCU
, 
uhNextDïth
 
	`DEBUG_STRING_PASS_INTO
(
sChûd
), 
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0) );

886 
	`DEBUG_STRING_APPEND
(
sTempDebug
, 
sChûd
)

888 
	`xCom¥essCU
–
pcSubBe°P¨tCU
, 
pcSubTempP¨tCU
, 
uhNextDïth
 );

891 
ΩcTempCU
->
	`c›yP¨tFrom
–
pcSubBe°P¨tCU
, 
uiP¨tUnôIdx
, 
uhNextDïth
 );

892 
	`xC›yYuv2Tmp
–
pcSubBe°P¨tCU
->
	`gëTŸÆNumP¨t
()*
uiP¨tUnôIdx
, 
uhNextDïth
 );

893 i‡–
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
(Ë&& 
µs
.
	`gëMaxCuDQPDïth
() >= 1 )

895 
•lôTŸÆCo°
 +
pcSubBe°P¨tCU
->
	`gëTŸÆCo°
();

900 
pcSubBe°P¨tCU
->
	`c›yToPic
–
uhNextDïth
 );

901 
ΩcTempCU
->
	`c›yP¨tFrom
–
pcSubBe°P¨tCU
, 
uiP¨tUnôIdx
, 
uhNextDïth
 );

905 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[
uhNextDïth
][
CI_NEXT_BEST
]);

906 if–!
bBound¨y
 )

908 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

909 
m_pcE¡r›yCodî
->
	`ícodeS∂ôFœg
–
ΩcTempCU
, 0, 
uiDïth
, 
åue
 );

910 i‡–
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
(Ë&& 
µs
.
	`gëMaxCuDQPDïth
() >= 1 )

912 
I¡
 
•lôBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

913 
DoubÀ
 
•lôBôCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
•lôBôs
, 0 );

914 
•lôTŸÆCo°
 +
•lôBôCo°
;

917 
ΩcTempCU
->
	`gëTŸÆBôs
(Ë+
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

918 
ΩcTempCU
->
	`gëTŸÆBös
(Ë+((
TEncBöCABAC
 *)((
TEncSbac
*)
m_pcE¡r›yCodî
->
m_pcE¡r›yCodîIf
)->
	`gëEncBöIf
())->
	`gëBösCoded
();

921 i‡–
m_pcEncCfg
->
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
(Ë&& 
µs
.
	`gëMaxCuDQPDïth
() >= 1 )

923 
ΩcTempCU
->
	`gëTŸÆCo°
(Ë
•lôTŸÆCo°
;

927 
ΩcTempCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–ΩcTempCU->
	`gëTŸÆBôs
(),ÑpcTempCU->
	`gëTŸÆDi°‹ti⁄
() );

930 if–
uiDïth
 =
µs
.
	`gëMaxCuDQPDïth
(Ë&&Öps.
	`gëU£DQP
())

932 
Boﬁ
 
hasResiduÆ
 = 
Ál£
;

933  
UI¡
 
uiBlkIdx
 = 0; uiBlkIdx < 
ΩcTempCU
->
	`gëTŸÆNumP¨t
(); uiBlkIdx ++)

935 if––
ΩcTempCU
->
	`gëCbf
(
uiBlkIdx
, 
COMPONENT_Y
)

936 || (
ΩcTempCU
->
	`gëCbf
(
uiBlkIdx
, 
COMPONENT_Cb
Ë&& (
numbîVÆidComp⁄íts
 > COMPONENT_Cb))

937 || (
ΩcTempCU
->
	`gëCbf
(
uiBlkIdx
, 
COMPONENT_Cr
Ë&& (
numbîVÆidComp⁄íts
 > COMPONENT_Cr)) ) )

939 
hasResiduÆ
 = 
åue
;

944 i‡–
hasResiduÆ
 )

946 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

947 
m_pcE¡r›yCodî
->
	`ícodeQP
–
ΩcTempCU
, 0, 
Ál£
 );

948 
ΩcTempCU
->
	`gëTŸÆBôs
(Ë+
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

949 
ΩcTempCU
->
	`gëTŸÆBös
(Ë+((
TEncBöCABAC
 *)((
TEncSbac
*)
m_pcE¡r›yCodî
->
m_pcE¡r›yCodîIf
)->
	`gëEncBöIf
())->
	`gëBösCoded
();

950 
ΩcTempCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–ΩcTempCU->
	`gëTŸÆBôs
(),ÑpcTempCU->
	`gëTŸÆDi°‹ti⁄
() );

952 
Boﬁ
 
foundN⁄ZîoCbf
 = 
Ál£
;

953 
ΩcTempCU
->
	`£tQPSubCUs
–ΩcTempCU->
	`gëRefQP
–0 ), 0, 
uiDïth
, 
foundN⁄ZîoCbf
 );

954 
	`as£π
–
foundN⁄ZîoCbf
 );

958 
ΩcTempCU
->
	`£tQPSubP¨ts
–ΩcTempCU->
	`gëRefQP
–0 ), 0, 
uiDïth
 );

962 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_TEMP_BEST
]);

969 i‡(
ΩcBe°CU
->
	`gëTŸÆCo°
()!=
MAX_DOUBLE
)

971 c⁄° 
Boﬁ
 
isEndOfSli˚
 = 
pcSli˚
->
	`gëSli˚Mode
()==
FIXED_NUMBER_OF_BYTES


972 && ((
pcSli˚
->
	`gëSli˚Bôs
()+
ΩcBe°CU
->
	`gëTŸÆBôs
())>pcSli˚->
	`gëSli˚Argumít
()<<3)

973 && 
ΩcBe°CU
->
	`gëCtuRsAddr
(Ë!
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
pcSli˚
->
	`gëSli˚CurSèπCtuTsAddr
())

974 && 
ΩcBe°CU
->
	`gëCtuRsAddr
(Ë!
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
pcSli˚
->
	`gëSli˚SegmítCurSèπCtuTsAddr
());

975 c⁄° 
Boﬁ
 
isEndOfSli˚Segmít
 = 
pcSli˚
->
	`gëSli˚SegmítMode
()==
FIXED_NUMBER_OF_BYTES


976 && ((
pcSli˚
->
	`gëSli˚SegmítBôs
()+
ΩcBe°CU
->
	`gëTŸÆBôs
()Ë>ÖcSli˚->
	`gëSli˚SegmítArgumít
()<<3)

977 && 
ΩcBe°CU
->
	`gëCtuRsAddr
(Ë!
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
pcSli˚
->
	`gëSli˚SegmítCurSèπCtuTsAddr
());

979 if(
isEndOfSli˚
||
isEndOfSli˚Segmít
)

981 
ΩcBe°CU
->
	`gëTŸÆCo°
()=
MAX_DOUBLE
;

985 
	`xCheckBe°Mode
–
ΩcBe°CU
, 
ΩcTempCU
, 
uiDïth
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
ËDEBUG_STRING_PASS_INTO(
sTempDebug
ËDEBUG_STRING_PASS_INTO(
Ál£
) );

990 
	`DEBUG_STRING_APPEND
(
sDebug_
, 
sDebug
);

992 
ΩcBe°CU
->
	`c›yToPic
(
uiDïth
);

994 
	`xC›yYuv2Pic
–
ΩcBe°CU
->
	`gëPic
(),ÑpcBe°CU->
	`gëCtuRsAddr
(),ÑpcBe°CU->
	`gëZ‹dîIdxInCtu
(), 
uiDïth
, uiDepth );

995 i‡(
bBound¨y
)

1002 
	`as£π
–
ΩcBe°CU
->
	`gëP¨tôi⁄Size
 ( 0 ) !
NUMBER_OF_PART_SIZES
 );

1003 
	`as£π
–
ΩcBe°CU
->
	`gëPªdi˘i⁄Mode
–0 ) !
NUMBER_OF_PREDICTION_MODES
 );

1004 
	`as£π
–
ΩcBe°CU
->
	`gëTŸÆCo°
 ( ) !
MAX_DOUBLE
 );

1005 
	}
}

1013 
Void
 
	gTEncCu
::
	$föishCU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

1015 
TComPic
* 
pcPic
 = 
pcCU
->
	`gëPic
();

1016 
TComSli˚
 * 
pcSli˚
 = 
pcCU
->
	`gëPic
()->
	`gëSli˚
’cCU->gëPic()->
	`gëCuºSli˚Idx
());

1019 c⁄° 
I¡
 
cuºítCTUTsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuRsToTsAddrM≠
(
pcCU
->
	`gëCtuRsAddr
());

1020 c⁄° 
Boﬁ
 
isLa°SubCUOfCtu
 = 
pcCU
->
	`isLa°SubCUOfCtu
(
uiAbsP¨tIdx
);

1021 i‡–
isLa°SubCUOfCtu
 )

1025 i‡(
pcSli˚
->
	`gëSli˚SegmítCurEndCtuTsAddr
(Ë!
cuºítCTUTsAddr
+1)

1027 
m_pcE¡r›yCodî
->
	`ícodeTîmö©ögBô
( 0 );

1030 
	}
}

1037 
I¡
 
	gTEncCu
::
	$xCompuãQP
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 )

1039 
I¡
 
iBa£Qp
 = 
pcCU
->
	`gëSli˚
()->
	`gëSli˚Qp
();

1040 
I¡
 
iQpOff£t
 = 0;

1041 i‡–
m_pcEncCfg
->
	`gëU£Ad≠tiveQP
() )

1043 
TEncPic
* 
pcEPic
 = 
dy«mic_ˇ°
<TEncPic*>–
pcCU
->
	`gëPic
() );

1044 
UI¡
 
uiAQDïth
 = 
	`mö
–
uiDïth
, 
pcEPic
->
	`gëMaxAQDïth
()-1 );

1045 
TEncPicQPAd≠èti⁄Layî
* 
pcAQLayî
 = 
pcEPic
->
	`gëAQLayî
–
uiAQDïth
 );

1046 
UI¡
 
uiAQUPosX
 = 
pcCU
->
	`gëCUPñX
(Ë/ 
pcAQLayî
->
	`gëAQP¨tWidth
();

1047 
UI¡
 
uiAQUPosY
 = 
pcCU
->
	`gëCUPñY
(Ë/ 
pcAQLayî
->
	`gëAQP¨tHeight
();

1048 
UI¡
 
uiAQUSåide
 = 
pcAQLayî
->
	`gëAQP¨tSåide
();

1049 
TEncQPAd≠èti⁄Unô
* 
acAQU
 = 
pcAQLayî
->
	`gëQPAd≠èti⁄Unô
();

1051 
DoubÀ
 
dMaxQSˇÀ
 = 
	`pow
(2.0, 
m_pcEncCfg
->
	`gëQPAd≠èti⁄R™ge
()/6.0);

1052 
DoubÀ
 
dAvgA˘
 = 
pcAQLayî
->
	`gëAvgA˘ivôy
();

1053 
DoubÀ
 
dCUA˘
 = 
acAQU
[
uiAQUPosY
 * 
uiAQUSåide
 + 
uiAQUPosX
].
	`gëA˘ivôy
();

1054 
DoubÀ
 
dN‹mA˘
 = (
dMaxQSˇÀ
*
dCUA˘
 + 
dAvgA˘
) / (dCUAct + dMaxQScale*dAvgAct);

1055 
DoubÀ
 
dQpOff£t
 = 
	`log
(
dN‹mA˘
) /Üog(2.0) * 6.0;

1056 
iQpOff£t
 = 
	`I¡
(
	`Êo‹
–
dQpOff£t
 + 0.49999 ));

1059  
	`Clù3
(-
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
iBa£Qp
+
iQpOff£t
 );

1060 
	}
}

1068 
Void
 
	gTEncCu
::
	$xEncodeCU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

1070 
TComPic
 *c⁄° 
pcPic
 = 
pcCU
->
	`gëPic
();

1071 
TComSli˚
 *c⁄° 
pcSli˚
 = 
pcCU
->
	`gëSli˚
();

1072 c⁄° 
TComSPS
 &
•s
 =*(
pcSli˚
->
	`gëSPS
());

1073 c⁄° 
TComPPS
 &
µs
 =*(
pcSli˚
->
	`gëPPS
());

1075 c⁄° 
UI¡
 
maxCUWidth
 = 
•s
.
	`gëMaxCUWidth
();

1076 c⁄° 
UI¡
 
maxCUHeight
 = 
•s
.
	`gëMaxCUHeight
();

1078 
Boﬁ
 
bBound¨y
 = 
Ál£
;

1079 
UI¡
 
uiLPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

1080 c⁄° 
UI¡
 
uiRPñX
 = 
uiLPñX
 + (
maxCUWidth
>>
uiDïth
) - 1;

1081 
UI¡
 
uiTPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

1082 c⁄° 
UI¡
 
uiBPñY
 = 
uiTPñY
 + (
maxCUHeight
>>
uiDïth
) - 1;

1084 if––
uiRPñX
 < 
•s
.
	`gëPicWidthInLumaSam∂es
(ËË&& ( 
uiBPñY
 < sps.
	`gëPicHeightInLumaSam∂es
() ) )

1086 
m_pcE¡r›yCodî
->
	`ícodeS∂ôFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

1090 
bBound¨y
 = 
åue
;

1093 if–––
uiDïth
 < 
pcCU
->
	`gëDïth
–
uiAbsP¨tIdx
 ) ) && ( uiDïth < 
•s
.
	`gëLog2DiffMaxMöCodögBlockSize
(ËËË|| 
bBound¨y
 )

1095 
UI¡
 
uiQNumP¨ts
 = ( 
pcPic
->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (
uiDïth
<<1) )>>2;

1096 if–
uiDïth
 =
µs
.
	`gëMaxCuDQPDïth
(Ë&&Öps.
	`gëU£DQP
())

1098 
	`£tdQPFœg
(
åue
);

1101 if–
uiDïth
 =
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëDiffCuChromaQpOff£tDïth
(Ë&& 
pcSli˚
->
	`gëU£ChromaQpAdj
())

1103 
	`£tCodeChromaQpAdjFœg
(
åue
);

1106  
UI¡
 
uiP¨tUnôIdx
 = 0; uiP¨tUnôIdx < 4; uiP¨tUnôIdx++, 
uiAbsP¨tIdx
+=
uiQNumP¨ts
 )

1108 
uiLPñX
 = 
pcCU
->
	`gëCUPñX
(Ë+ 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

1109 
uiTPñY
 = 
pcCU
->
	`gëCUPñY
(Ë+ 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
] ];

1110 if––
uiLPñX
 < 
•s
.
	`gëPicWidthInLumaSam∂es
(ËË&& ( 
uiTPñY
 < sps.
	`gëPicHeightInLumaSam∂es
() ) )

1112 
	`xEncodeCU
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
+1 );

1118 if–
uiDïth
 <
µs
.
	`gëMaxCuDQPDïth
(Ë&&Öps.
	`gëU£DQP
())

1120 
	`£tdQPFœg
(
åue
);

1123 if–
uiDïth
 <
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëDiffCuChromaQpOff£tDïth
(Ë&& 
pcSli˚
->
	`gëU£ChromaQpAdj
())

1125 
	`£tCodeChromaQpAdjFœg
(
åue
);

1128 i‡(
µs
.
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

1130 
m_pcE¡r›yCodî
->
	`ícodeCUTønsqu™tBy∑ssFœg
–
pcCU
, 
uiAbsP¨tIdx
 );

1133 if–!
pcSli˚
->
	`isI¡ø
() )

1135 
m_pcE¡r›yCodî
->
	`ícodeSkùFœg
–
pcCU
, 
uiAbsP¨tIdx
 );

1138 if–
pcCU
->
	`isSkù≥d
–
uiAbsP¨tIdx
 ) )

1140 
m_pcE¡r›yCodî
->
	`ícodeMîgeIndex
–
pcCU
, 
uiAbsP¨tIdx
 );

1141 
	`föishCU
(
pcCU
,
uiAbsP¨tIdx
);

1145 
m_pcE¡r›yCodî
->
	`ícodePªdMode
–
pcCU
, 
uiAbsP¨tIdx
 );

1146 
m_pcE¡r›yCodî
->
	`ícodeP¨tSize
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

1148 i‡(
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) &&ÖcCU->
	`gëP¨tôi⁄Size
–uiAbsP¨tIdx ) =
SIZE_2Nx2N
 )

1150 
m_pcE¡r›yCodî
->
	`ícodeIPCMInfo
–
pcCU
, 
uiAbsP¨tIdx
 );

1152 if(
pcCU
->
	`gëIPCMFœg
(
uiAbsP¨tIdx
))

1155 
	`föishCU
(
pcCU
,
uiAbsP¨tIdx
);

1161 
m_pcE¡r›yCodî
->
	`ícodePªdInfo
–
pcCU
, 
uiAbsP¨tIdx
 );

1164 
Boﬁ
 
bCodeDQP
 = 
	`gëdQPFœg
();

1165 
Boﬁ
 
codeChromaQpAdj
 = 
	`gëCodeChromaQpAdjFœg
();

1166 
m_pcE¡r›yCodî
->
	`ícodeC€ff
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
, 
bCodeDQP
, 
codeChromaQpAdj
 );

1167 
	`£tCodeChromaQpAdjFœg
–
codeChromaQpAdj
 );

1168 
	`£tdQPFœg
–
bCodeDQP
 );

1171 
	`föishCU
(
pcCU
,
uiAbsP¨tIdx
);

1172 
	}
}

1174 
I¡
 
	$xCÆcHADs8x8_ISli˚
(
Pñ
 *
piOrg
, 
I¡
 
iSåideOrg
)

1176 
I¡
 
k
, 
i
, 
j
, 
jj
;

1177 
I¡
 
diff
[64], 
m1
[8][8], 
m2
[8][8], 
m3
[8][8], 
iSumHad
 = 0;

1179  
k
 = 0; k < 64; k += 8 )

1181 
diff
[
k
+0] = 
piOrg
[0] ;

1182 
diff
[
k
+1] = 
piOrg
[1] ;

1183 
diff
[
k
+2] = 
piOrg
[2] ;

1184 
diff
[
k
+3] = 
piOrg
[3] ;

1185 
diff
[
k
+4] = 
piOrg
[4] ;

1186 
diff
[
k
+5] = 
piOrg
[5] ;

1187 
diff
[
k
+6] = 
piOrg
[6] ;

1188 
diff
[
k
+7] = 
piOrg
[7] ;

1190 
piOrg
 +
iSåideOrg
;

1194 
j
=0; j < 8; j++)

1196 
jj
 = 
j
 << 3;

1197 
m2
[
j
][0] = 
diff
[
jj
 ] + diff[jj+4];

1198 
m2
[
j
][1] = 
diff
[
jj
+1] + diff[jj+5];

1199 
m2
[
j
][2] = 
diff
[
jj
+2] + diff[jj+6];

1200 
m2
[
j
][3] = 
diff
[
jj
+3] + diff[jj+7];

1201 
m2
[
j
][4] = 
diff
[
jj
 ] - diff[jj+4];

1202 
m2
[
j
][5] = 
diff
[
jj
+1] - diff[jj+5];

1203 
m2
[
j
][6] = 
diff
[
jj
+2] - diff[jj+6];

1204 
m2
[
j
][7] = 
diff
[
jj
+3] - diff[jj+7];

1206 
m1
[
j
][0] = 
m2
[j][0] + m2[j][2];

1207 
m1
[
j
][1] = 
m2
[j][1] + m2[j][3];

1208 
m1
[
j
][2] = 
m2
[j][0] - m2[j][2];

1209 
m1
[
j
][3] = 
m2
[j][1] - m2[j][3];

1210 
m1
[
j
][4] = 
m2
[j][4] + m2[j][6];

1211 
m1
[
j
][5] = 
m2
[j][5] + m2[j][7];

1212 
m1
[
j
][6] = 
m2
[j][4] - m2[j][6];

1213 
m1
[
j
][7] = 
m2
[j][5] - m2[j][7];

1215 
m2
[
j
][0] = 
m1
[j][0] + m1[j][1];

1216 
m2
[
j
][1] = 
m1
[j][0] - m1[j][1];

1217 
m2
[
j
][2] = 
m1
[j][2] + m1[j][3];

1218 
m2
[
j
][3] = 
m1
[j][2] - m1[j][3];

1219 
m2
[
j
][4] = 
m1
[j][4] + m1[j][5];

1220 
m2
[
j
][5] = 
m1
[j][4] - m1[j][5];

1221 
m2
[
j
][6] = 
m1
[j][6] + m1[j][7];

1222 
m2
[
j
][7] = 
m1
[j][6] - m1[j][7];

1226 
i
=0; i < 8; i++)

1228 
m3
[0][
i
] = 
m2
[0][i] + m2[4][i];

1229 
m3
[1][
i
] = 
m2
[1][i] + m2[5][i];

1230 
m3
[2][
i
] = 
m2
[2][i] + m2[6][i];

1231 
m3
[3][
i
] = 
m2
[3][i] + m2[7][i];

1232 
m3
[4][
i
] = 
m2
[0][i] - m2[4][i];

1233 
m3
[5][
i
] = 
m2
[1][i] - m2[5][i];

1234 
m3
[6][
i
] = 
m2
[2][i] - m2[6][i];

1235 
m3
[7][
i
] = 
m2
[3][i] - m2[7][i];

1237 
m1
[0][
i
] = 
m3
[0][i] + m3[2][i];

1238 
m1
[1][
i
] = 
m3
[1][i] + m3[3][i];

1239 
m1
[2][
i
] = 
m3
[0][i] - m3[2][i];

1240 
m1
[3][
i
] = 
m3
[1][i] - m3[3][i];

1241 
m1
[4][
i
] = 
m3
[4][i] + m3[6][i];

1242 
m1
[5][
i
] = 
m3
[5][i] + m3[7][i];

1243 
m1
[6][
i
] = 
m3
[4][i] - m3[6][i];

1244 
m1
[7][
i
] = 
m3
[5][i] - m3[7][i];

1246 
m2
[0][
i
] = 
m1
[0][i] + m1[1][i];

1247 
m2
[1][
i
] = 
m1
[0][i] - m1[1][i];

1248 
m2
[2][
i
] = 
m1
[2][i] + m1[3][i];

1249 
m2
[3][
i
] = 
m1
[2][i] - m1[3][i];

1250 
m2
[4][
i
] = 
m1
[4][i] + m1[5][i];

1251 
m2
[5][
i
] = 
m1
[4][i] - m1[5][i];

1252 
m2
[6][
i
] = 
m1
[6][i] + m1[7][i];

1253 
m2
[7][
i
] = 
m1
[6][i] - m1[7][i];

1256 
i
 = 0; i < 8; i++)

1258 
j
 = 0; j < 8; j++)

1260 
iSumHad
 +
	`abs
(
m2
[
i
][
j
]);

1263 
iSumHad
 -
	`abs
(
m2
[0][0]);

1264 
iSumHad
 =(iSumHad+2)>>2;

1265 (
iSumHad
);

1266 
	}
}

1268 
I¡
 
	gTEncCu
::
	$upd©eCtuD©aISli˚
(
TComD©aCU
* 
pCtu
, 
I¡
 
width
, I¡ 
height
)

1270 
I¡
 
xBl
, 
yBl
;

1271 c⁄° 
I¡
 
iBlkSize
 = 8;

1273 
Pñ
* 
pOrgInô
 = 
pCtu
->
	`gëPic
()->
	`gëPicYuvOrg
()->
	`gëAddr
(
COMPONENT_Y
,ÖCtu->
	`gëCtuRsAddr
(), 0);

1274 
I¡
 
iSåideOrig
 = 
pCtu
->
	`gëPic
()->
	`gëPicYuvOrg
()->
	`gëSåide
(
COMPONENT_Y
);

1275 
Pñ
 *
pOrg
;

1277 
I¡
 
iSumHad
 = 0;

1278  
yBl
=0; (yBl+
iBlkSize
)<=
height
; yBl+= iBlkSize)

1280  
xBl
=0; (xBl+
iBlkSize
)<=
width
; xBl+= iBlkSize)

1282 
pOrg
 = 
pOrgInô
 + 
iSåideOrig
*
yBl
 + 
xBl
;

1283 
iSumHad
 +
	`xCÆcHADs8x8_ISli˚
(
pOrg
, 
iSåideOrig
);

1286 (
iSumHad
);

1287 
	}
}

1294 
Void
 
	gTEncCu
::
xCheckRDCo°Mîge2Nx2N
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
 
DEBUG_STRING_FN_DECLARE
(
sDebug
), 
Boﬁ
 *
óæyDëe˘i⁄SkùMode
 )

1296 
as£π
–
ΩcTempCU
->
gëSli˚
()->
gëSli˚Ty≥
(Ë!
I_SLICE
 );

1297 if(
gëFa°DñèQp
())

1301 
TComMvFõld
 
	gcMvFõldNeighbours
[2 * 
MRG_MAX_NUM_CANDS
];

1302 
UCh¨
 
	guhI¡îDúNeighbours
[
MRG_MAX_NUM_CANDS
];

1303 
I¡
 
	gnumVÆidMîgeC™d
 = 0;

1304 c⁄° 
Boﬁ
 
	gbTønsqu™tBy∑ssFœg
 = 
ΩcTempCU
->
gëCUTønsqu™tBy∑ss
(0);

1306  
UI¡
 
	gui
 = 0; uò< 
	gΩcTempCU
->
gëSli˚
()->
gëMaxNumMîgeC™d
(); ++ui )

1308 
	guhI¡îDúNeighbours
[
ui
] = 0;

1310 
UCh¨
 
	guhDïth
 = 
ΩcTempCU
->
gëDïth
( 0 );

1311 
	gΩcTempCU
->
£tP¨tSizeSubP¨ts
–
SIZE_2Nx2N
, 0, 
uhDïth
 );

1312 #i‡
MCTS_ENC_CHECK


1313 
UI¡
 
	gnumS∑tülMîgeC™did©es
 = 0;

1314 
	gΩcTempCU
->
gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
numS∑tülMîgeC™did©es
 );

1316 
	gΩcTempCU
->
gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
,
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
 );

1319 
I¡
 
	gmîgeC™dBuf„r
[
MRG_MAX_NUM_CANDS
];

1320  
UI¡
 
	gui
 = 0; uò< 
	gnumVÆidMîgeC™d
; ++ui )

1322 
	gmîgeC™dBuf„r
[
ui
] = 0;

1324 #i‡
MCTS_ENC_CHECK


1325 i‡(
	gm_pcEncCfg
->
gëTMCTSSEITûeC⁄°øöt
(Ë&& 
	gΩcTempCU
->
isLa°CﬁumnCTUInTûe
())

1327 
	gnumVÆidMîgeC™d
 = 
numS∑tülMîgeC™did©es
;

1331 
Boﬁ
 
	gbe°IsSkù
 = 
Ál£
;

1333 
UI¡
 
	gôî©i⁄
;

1334 i‡–
	gΩcTempCU
->
isLos¶essCoded
(0))

1336 
	gôî©i⁄
 = 1;

1340 
	gôî©i⁄
 = 2;

1342 
DEBUG_STRING_NEW
(
be°Så
)

1344  
UI¡
 
	guiNoResiduÆ
 = 0; uiNoResiduÆ < 
	gôî©i⁄
; ++uiNoResidual )

1346  
UI¡
 
	guiMîgeC™d
 = 0; uiMîgeC™d < 
	gnumVÆidMîgeC™d
; ++uiMergeCand )

1348 if(!(
	guiNoResiduÆ
==1 && 
mîgeC™dBuf„r
[
uiMîgeC™d
]==1))

1350 if–!(
be°IsSkù
 && 
uiNoResiduÆ
 == 0) )

1352 
DEBUG_STRING_NEW
(
tmpSå
)

1354 
ΩcTempCU
->
£tPªdModeSubP¨ts
–
MODE_INTER
, 0, 
uhDïth
 );

1355 
	gΩcTempCU
->
£tCUTønsqu™tBy∑ssSubP¨ts
–
bTønsqu™tBy∑ssFœg
, 0, 
uhDïth
 );

1356 
	gΩcTempCU
->
£tChromaQpAdjSubP¨ts
–
bTønsqu™tBy∑ssFœg
 ? 0 : 
m_cuChromaQpOff£tIdxPlus1
, 0, 
uhDïth
 );

1357 
	gΩcTempCU
->
£tP¨tSizeSubP¨ts
–
SIZE_2Nx2N
, 0, 
uhDïth
 );

1358 
	gΩcTempCU
->
£tMîgeFœgSubP¨ts
–
åue
, 0, 0, 
uhDïth
 );

1359 
	gΩcTempCU
->
£tMîgeIndexSubP¨ts
–
uiMîgeC™d
, 0, 0, 
uhDïth
 );

1360 
	gΩcTempCU
->
£tI¡îDúSubP¨ts
–
uhI¡îDúNeighbours
[
uiMîgeC™d
], 0, 0, 
uhDïth
 );

1361 
	gΩcTempCU
->
gëCUMvFõld
–
REF_PIC_LIST_0
 )->
£tAŒMvFõld
–
cMvFõldNeighbours
[0 + 2*
uiMîgeC™d
], 
SIZE_2Nx2N
, 0, 0 );

1362 
	gΩcTempCU
->
gëCUMvFõld
–
REF_PIC_LIST_1
 )->
£tAŒMvFõld
–
cMvFõldNeighbours
[1 + 2*
uiMîgeC™d
], 
SIZE_2Nx2N
, 0, 0 );

1364 #i‡
MCTS_ENC_CHECK


1365 i‡–
	gm_pcEncCfg
->
gëTMCTSSEITûeC⁄°øöt
 (Ë&& (!(
	gm_pcPªdSórch
->
checkTM˘sMvp
(
ΩcTempCU
))))

1372 
	gm_pcPªdSórch
->
mŸi⁄Com≥nßti⁄
 ( 
ΩcTempCU
, 
m_µcPªdYuvTemp
[
uhDïth
] );

1374 
	gm_pcPªdSórch
->
ícodeResAndCÆcRdI¡îCU
–
ΩcTempCU
,

1375 
m_µcOrigYuv
 [
uhDïth
],

1376 
m_µcPªdYuvTemp
[
uhDïth
],

1377 
m_µcResiYuvTemp
[
uhDïth
],

1378 
m_µcResiYuvBe°
[
uhDïth
],

1379 
m_µcRecoYuvTemp
[
uhDïth
],

1380 (
uiNoResiduÆ
 !0Ë
DEBUG_STRING_PASS_INTO
(
tmpSå
) );

1382 #i‡
DEBUG_STRING


1383 
DebugI¡îPªdResiReco
(
tmpSå
, *(
m_µcPªdYuvTemp
[
uhDïth
]), *(
m_µcResiYuvBe°
[uhDïth]), *(
m_µcRecoYuvTemp
[uhDïth]), 
DebugSåögGëPªdModeMask
(
ΩcTempCU
->
gëPªdi˘i⁄Mode
(0)));

1386 i‡((
	guiNoResiduÆ
 =0Ë&& (
ΩcTempCU
->
gëQtRoŸCbf
(0) == 0))

1389 
mîgeC™dBuf„r
[
uiMîgeC™d
] = 1;

1392 
I¡
 
	g‹gQP
 = 
ΩcTempCU
->
gëQP
( 0 );

1393 
xCheckDQP
–
ΩcTempCU
 );

1394 
xCheckBe°Mode
(
ΩcBe°CU
, 
ΩcTempCU
, 
uhDïth
 
DEBUG_STRING_PASS_INTO
(
be°Så
ËDEBUG_STRING_PASS_INTO(
tmpSå
));

1396 
	gΩcTempCU
->
öôE°D©a
–
uhDïth
, 
‹gQP
, 
bTønsqu™tBy∑ssFœg
 );

1398 if–
	gm_pcEncCfg
->
gëU£Fa°Decisi⁄F‹Mîge
(Ë&& !
	gbe°IsSkù
 )

1400 
	gbe°IsSkù
 = 
ΩcBe°CU
->
gëQtRoŸCbf
(0) == 0;

1406 if(
	guiNoResiduÆ
 =0 && 
m_pcEncCfg
->
gëU£E¨lySkùDëe˘i⁄
())

1408 if(
ΩcBe°CU
->
gëQtRoŸCbf
( 0 ) == 0)

1410 if–
ΩcBe°CU
->
gëMîgeFœg
( 0 ))

1412 *
óæyDëe˘i⁄SkùMode
 = 
åue
;

1414 if(
	gm_pcEncCfg
->
gëMŸi⁄E°im©i⁄SórchMëhod
(Ë!
MESEARCH_SELECTIVE
)

1416 
I¡
 
absou…e_MV
=0;

1417  
UI¡
 
	guiRefLi°Idx
 = 0; uiRefListIdx < 2; uiRefListIdx++ )

1419 i‡–
	gΩcBe°CU
->
gëSli˚
()->
gëNumRefIdx
–
RefPicLi°
–
uiRefLi°Idx
 ) ) > 0 )

1421 
TComCUMvFõld
* 
	gpcCUMvFõld
 = 
ΩcBe°CU
->
gëCUMvFõld
(
RefPicLi°
–
uiRefLi°Idx
 ));

1422 
I¡
 
	giH‹
 = 
pcCUMvFõld
->
gëMvd
–0 ).
gëAbsH‹
();

1423 
I¡
 
	giVî
 = 
pcCUMvFõld
->
gëMvd
–0 ).
gëAbsVî
();

1424 
	gabsou…e_MV
+=
iH‹
+
iVî
;

1428 if(
	gabsou…e_MV
 == 0)

1430 *
óæyDëe˘i⁄SkùMode
 = 
åue
;

1436 
DEBUG_STRING_APPEND
(
sDebug
, 
be°Så
)

1440 #i‡
AMP_MRG


1441 
Void
 
	gTEncCu
::
xCheckRDCo°I¡î
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, 
P¨tSize
 
eP¨tSize
 
DEBUG_STRING_FN_DECLARE
(
sDebug
), 
Boﬁ
 
bU£MRG
)

1443 
Void
 
	gTEncCu
::
	$xCheckRDCo°I¡î
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, 
P¨tSize
 
eP¨tSize
 )

1446 
	`DEBUG_STRING_NEW
(
sTe°
)

1448 if(
	`gëFa°DñèQp
())

1450 c⁄° 
TComSPS
 &
•s
=*(
ΩcTempCU
->
	`gëSli˚
()->
	`gëSPS
());

1451 c⁄° 
UI¡
 
Á°DñèQPCuMaxSize
 = 
	`Clù3
(
•s
.
	`gëMaxCUHeight
()>>(•s.
	`gëLog2DiffMaxMöCodögBlockSize
()), sps.getMaxCUHeight(), 32u);

1452 if(
eP¨tSize
 !
SIZE_2Nx2N
 || 
ΩcTempCU
->
	`gëWidth
–0 ) > 
Á°DñèQPCuMaxSize
)

1459 
UCh¨
 
uhDïth
 = 
ΩcTempCU
->
	`gëDïth
( 0 );

1461 
ΩcTempCU
->
	`£tP¨tSizeSubP¨ts
 ( 
eP¨tSize
, 0, 
uhDïth
 );

1462 
ΩcTempCU
->
	`£tPªdModeSubP¨ts
 ( 
MODE_INTER
, 0, 
uhDïth
 );

1463 
ΩcTempCU
->
	`£tChromaQpAdjSubP¨ts
–ΩcTempCU->
	`gëCUTønsqu™tBy∑ss
(0Ë? 0 : 
m_cuChromaQpOff£tIdxPlus1
, 0, 
uhDïth
 );

1465 #i‡
MCTS_ENC_CHECK


1466 
ΩcTempCU
->
	`£tTM˘sMvpIsVÆid
(
åue
);

1469 #i‡
AMP_MRG


1470 
ΩcTempCU
->
	`£tMîgeAMP
 (
åue
);

1471 
m_pcPªdSórch
->
	`¥edI¡îSórch
 ( 
ΩcTempCU
, 
m_µcOrigYuv
[
uhDïth
], 
m_µcPªdYuvTemp
[uhDïth], 
m_µcResiYuvTemp
[uhDïth], 
m_µcRecoYuvTemp
[uhDïth] 
	`DEBUG_STRING_PASS_INTO
(
sTe°
), 
Ál£
, 
bU£MRG
 );

1473 
m_pcPªdSórch
->
	`¥edI¡îSórch
 ( 
ΩcTempCU
, 
m_µcOrigYuv
[
uhDïth
], 
m_µcPªdYuvTemp
[uhDïth], 
m_µcResiYuvTemp
[uhDïth], 
m_µcRecoYuvTemp
[uhDepth] );

1476 #i‡
AMP_MRG


1477 i‡–!
ΩcTempCU
->
	`gëMîgeAMP
() )

1483 #i‡
MCTS_ENC_CHECK


1484 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
(Ë&& (!
ΩcTempCU
->
	`gëTM˘sMvpIsVÆid
()))

1490 
m_pcPªdSórch
->
	`ícodeResAndCÆcRdI¡îCU
–
ΩcTempCU
, 
m_µcOrigYuv
[
uhDïth
], 
m_µcPªdYuvTemp
[uhDïth], 
m_µcResiYuvTemp
[uhDïth], 
m_µcResiYuvBe°
[uhDïth], 
m_µcRecoYuvTemp
[uhDïth], 
Ál£
 
	`DEBUG_STRING_PASS_INTO
(
sTe°
) );

1491 
ΩcTempCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–ΩcTempCU->
	`gëTŸÆBôs
(),ÑpcTempCU->
	`gëTŸÆDi°‹ti⁄
() );

1493 #i‡
DEBUG_STRING


1494 
	`DebugI¡îPªdResiReco
(
sTe°
, *(
m_µcPªdYuvTemp
[
uhDïth
]), *(
m_µcResiYuvBe°
[uhDïth]), *(
m_µcRecoYuvTemp
[uhDïth]), 
	`DebugSåögGëPªdModeMask
(
ΩcTempCU
->
	`gëPªdi˘i⁄Mode
(0)));

1497 
	`xCheckDQP
–
ΩcTempCU
 );

1498 
	`xCheckBe°Mode
(
ΩcBe°CU
, 
ΩcTempCU
, 
uhDïth
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
ËDEBUG_STRING_PASS_INTO(
sTe°
));

1499 
	}
}

1501 
Void
 
	gTEncCu
::
xCheckRDCo°I¡ø
–
TComD©aCU
 *&
ΩcBe°CU
,

1502 
TComD©aCU
 *&
ΩcTempCU
,

1503 
P¨tSize
 
eSize


1504 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
) )

1506 
	`DEBUG_STRING_NEW
(
sTe°
)

1508 if(
	`gëFa°DñèQp
())

1510 c⁄° 
TComSPS
 &
•s
=*(
ΩcTempCU
->
	`gëSli˚
()->
	`gëSPS
());

1511 c⁄° 
UI¡
 
Á°DñèQPCuMaxSize
 = 
	`Clù3
(
•s
.
	`gëMaxCUHeight
()>>(•s.
	`gëLog2DiffMaxMöCodögBlockSize
()), sps.getMaxCUHeight(), 32u);

1512 if(
ΩcTempCU
->
	`gëWidth
–0 ) > 
Á°DñèQPCuMaxSize
)

1518 
UI¡
 
uiDïth
 = 
ΩcTempCU
->
	`gëDïth
( 0 );

1520 
ΩcTempCU
->
	`£tSkùFœgSubP¨ts
–
Ál£
, 0, 
uiDïth
 );

1522 
ΩcTempCU
->
	`£tP¨tSizeSubP¨ts
–
eSize
, 0, 
uiDïth
 );

1523 
ΩcTempCU
->
	`£tPªdModeSubP¨ts
–
MODE_INTRA
, 0, 
uiDïth
 );

1524 
ΩcTempCU
->
	`£tChromaQpAdjSubP¨ts
–ΩcTempCU->
	`gëCUTønsqu™tBy∑ss
(0Ë? 0 : 
m_cuChromaQpOff£tIdxPlus1
, 0, 
uiDïth
 );

1526 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE];

1528 
m_pcPªdSórch
->
	`e°I¡øPªdLumaQT
–
ΩcTempCU
, 
m_µcOrigYuv
[
uiDïth
], 
m_µcPªdYuvTemp
[uiDïth], 
m_µcResiYuvTemp
[uiDïth], 
m_µcRecoYuvTemp
[uiDïth], 
ªsiLuma
 
	`DEBUG_STRING_PASS_INTO
(
sTe°
) );

1530 
m_µcRecoYuvTemp
[
uiDïth
]->
	`c›yToPicComp⁄ít
(
COMPONENT_Y
, 
ΩcTempCU
->
	`gëPic
()->
	`gëPicYuvRec
(),ÑpcTempCU->
	`gëCtuRsAddr
(),ÑpcTempCU->
	`gëZ‹dîIdxInCtu
() );

1532 i‡(
ΩcBe°CU
->
	`gëPic
()->
	`gëChromaF‹m©
()!=
CHROMA_400
)

1534 
m_pcPªdSórch
->
	`e°I¡øPªdChromaQT
–
ΩcTempCU
, 
m_µcOrigYuv
[
uiDïth
], 
m_µcPªdYuvTemp
[uiDïth], 
m_µcResiYuvTemp
[uiDïth], 
m_µcRecoYuvTemp
[uiDïth], 
ªsiLuma
 
	`DEBUG_STRING_PASS_INTO
(
sTe°
) );

1537 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

1539 i‡–
ΩcTempCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

1541 
m_pcE¡r›yCodî
->
	`ícodeCUTønsqu™tBy∑ssFœg
–
ΩcTempCU
, 0, 
åue
 );

1544 
m_pcE¡r›yCodî
->
	`ícodeSkùFœg
 ( 
ΩcTempCU
, 0, 
åue
 );

1545 
m_pcE¡r›yCodî
->
	`ícodePªdMode
–
ΩcTempCU
, 0, 
åue
 );

1546 
m_pcE¡r›yCodî
->
	`ícodeP¨tSize
–
ΩcTempCU
, 0, 
uiDïth
, 
åue
 );

1547 
m_pcE¡r›yCodî
->
	`ícodePªdInfo
–
ΩcTempCU
, 0 );

1548 
m_pcE¡r›yCodî
->
	`ícodeIPCMInfo
(
ΩcTempCU
, 0, 
åue
 );

1551 
Boﬁ
 
bCodeDQP
 = 
	`gëdQPFœg
();

1552 
Boﬁ
 
codeChromaQpAdjFœg
 = 
	`gëCodeChromaQpAdjFœg
();

1553 
m_pcE¡r›yCodî
->
	`ícodeC€ff
–
ΩcTempCU
, 0, 
uiDïth
, 
bCodeDQP
, 
codeChromaQpAdjFœg
 );

1554 
	`£tCodeChromaQpAdjFœg
–
codeChromaQpAdjFœg
 );

1555 
	`£tdQPFœg
–
bCodeDQP
 );

1557 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_TEMP_BEST
]);

1559 
ΩcTempCU
->
	`gëTŸÆBôs
(Ë
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

1560 
ΩcTempCU
->
	`gëTŸÆBös
(Ë((
TEncBöCABAC
 *)((
TEncSbac
*)
m_pcE¡r›yCodî
->
m_pcE¡r›yCodîIf
)->
	`gëEncBöIf
())->
	`gëBösCoded
();

1561 
ΩcTempCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–ΩcTempCU->
	`gëTŸÆBôs
(),ÑpcTempCU->
	`gëTŸÆDi°‹ti⁄
() );

1563 
	`xCheckDQP
–
ΩcTempCU
 );

1565 
	`xCheckBe°Mode
(
ΩcBe°CU
, 
ΩcTempCU
, 
uiDïth
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
ËDEBUG_STRING_PASS_INTO(
sTe°
));

1566 
	}
}

1576 
Void
 
	gTEncCu
::
	$xCheckI¡øPCM
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
 )

1578 if(
	`gëFa°DñèQp
())

1580 c⁄° 
TComSPS
 &
•s
=*(
ΩcTempCU
->
	`gëSli˚
()->
	`gëSPS
());

1581 c⁄° 
UI¡
 
Á°DñèQPCuMaxPCMSize
 = 
	`Clù3
((UI¡)1<<
•s
.
	`gëPCMLog2MöSize
(), (UI¡)1<<•s.
	`gëPCMLog2MaxSize
(), 32u);

1582 i‡(
ΩcTempCU
->
	`gëWidth
–0 ) > 
Á°DñèQPCuMaxPCMSize
)

1588 
UI¡
 
uiDïth
 = 
ΩcTempCU
->
	`gëDïth
( 0 );

1590 
ΩcTempCU
->
	`£tSkùFœgSubP¨ts
–
Ál£
, 0, 
uiDïth
 );

1592 
ΩcTempCU
->
	`£tIPCMFœg
(0, 
åue
);

1593 
ΩcTempCU
->
	`£tIPCMFœgSubP¨ts
 (
åue
, 0,ÑpcTempCU->
	`gëDïth
(0));

1594 
ΩcTempCU
->
	`£tP¨tSizeSubP¨ts
–
SIZE_2Nx2N
, 0, 
uiDïth
 );

1595 
ΩcTempCU
->
	`£tPªdModeSubP¨ts
–
MODE_INTRA
, 0, 
uiDïth
 );

1596 
ΩcTempCU
->
	`£tTrIdxSubP¨ts
 ( 0, 0, 
uiDïth
 );

1597 
ΩcTempCU
->
	`£tChromaQpAdjSubP¨ts
–ΩcTempCU->
	`gëCUTønsqu™tBy∑ss
(0Ë? 0 : 
m_cuChromaQpOff£tIdxPlus1
, 0, 
uiDïth
 );

1599 
m_pcPªdSórch
->
	`IPCMSórch
–
ΩcTempCU
, 
m_µcOrigYuv
[
uiDïth
], 
m_µcPªdYuvTemp
[uiDïth], 
m_µcResiYuvTemp
[uiDïth], 
m_µcRecoYuvTemp
[uiDepth]);

1601 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_CURR_BEST
]);

1603 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

1605 i‡–
ΩcTempCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

1607 
m_pcE¡r›yCodî
->
	`ícodeCUTønsqu™tBy∑ssFœg
–
ΩcTempCU
, 0, 
åue
 );

1610 
m_pcE¡r›yCodî
->
	`ícodeSkùFœg
 ( 
ΩcTempCU
, 0, 
åue
 );

1611 
m_pcE¡r›yCodî
->
	`ícodePªdMode
 ( 
ΩcTempCU
, 0, 
åue
 );

1612 
m_pcE¡r›yCodî
->
	`ícodeP¨tSize
 ( 
ΩcTempCU
, 0, 
uiDïth
, 
åue
 );

1613 
m_pcE¡r›yCodî
->
	`ícodeIPCMInfo
 ( 
ΩcTempCU
, 0, 
åue
 );

1615 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_TEMP_BEST
]);

1617 
ΩcTempCU
->
	`gëTŸÆBôs
(Ë
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

1618 
ΩcTempCU
->
	`gëTŸÆBös
(Ë((
TEncBöCABAC
 *)((
TEncSbac
*)
m_pcE¡r›yCodî
->
m_pcE¡r›yCodîIf
)->
	`gëEncBöIf
())->
	`gëBösCoded
();

1619 
ΩcTempCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–ΩcTempCU->
	`gëTŸÆBôs
(),ÑpcTempCU->
	`gëTŸÆDi°‹ti⁄
() );

1621 
	`xCheckDQP
–
ΩcTempCU
 );

1622 
	`DEBUG_STRING_NEW
(
a
)

1623 
	`DEBUG_STRING_NEW
(
b
)

1624 
	`xCheckBe°Mode
(
ΩcBe°CU
, 
ΩcTempCU
, 
uiDïth
 
	`DEBUG_STRING_PASS_INTO
(
a
ËDEBUG_STRING_PASS_INTO(
b
));

1625 
	}
}

1632 
Void
 
	gTEncCu
::
xCheckBe°Mode
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, 
UI¡
 
uiDïth
 
	$DEBUG_STRING_FN_DECLARE
(
sP¨ít
Ë
	$DEBUG_STRING_FN_DECLARE
(
sTe°
Ë
	$DEBUG_STRING_PASS_INTO
(
Boﬁ
 
bAddSizeInfo
) )

1634 if–
ΩcTempCU
->
	`gëTŸÆCo°
(Ë< 
ΩcBe°CU
->getTotalCost() )

1636 
TComYuv
* 
pcYuv
;

1638 
TComD©aCU
* 
pcCU
 = 
ΩcBe°CU
;

1639 
ΩcBe°CU
 = 
ΩcTempCU
;

1640 
ΩcTempCU
 = 
pcCU
;

1643 
pcYuv
 = 
m_µcPªdYuvBe°
[
uiDïth
];

1644 
m_µcPªdYuvBe°
[
uiDïth
] = 
m_µcPªdYuvTemp
[uiDepth];

1645 
m_µcPªdYuvTemp
[
uiDïth
] = 
pcYuv
;

1648 
pcYuv
 = 
m_µcRecoYuvBe°
[
uiDïth
];

1649 
m_µcRecoYuvBe°
[
uiDïth
] = 
m_µcRecoYuvTemp
[uiDepth];

1650 
m_µcRecoYuvTemp
[
uiDïth
] = 
pcYuv
;

1652 
pcYuv
 = 
NULL
;

1653 
pcCU
 = 
NULL
;

1656 
m_µpcRDSbacCodî
[
uiDïth
][
CI_TEMP_BEST
]->
	`°‹e
(m_µpcRDSbacCodî[uiDïth][
CI_NEXT_BEST
]);

1659 #i‡
DEBUG_STRING


1660 
	`DEBUG_STRING_SWAP
(
sP¨ít
, 
sTe°
)

1661 c⁄° 
PªdMode
 
¥edMode
=
ΩcBe°CU
->
	`gëPªdi˘i⁄Mode
(0);

1662 i‡((
DebugO±i⁄Li°
::
DebugSåög_Såu˘uª
.
	`gëI¡
()&
	`DebugSåögGëPªdModeMask
(
¥edMode
)Ë&& 
bAddSizeInfo
)

1664 
°d
::
°rög°ªam
 
	`ss
(°rög°ªam::
out
);

1665 
ss
 <<"###: " << (
¥edMode
==
MODE_INTRA
?"I¡ø ":"I¡î "Ë<< 
∑πSizeToSåög
[
ΩcBe°CU
->
	`gëP¨tôi⁄Size
(0)] << " CUáà" <<ÑpcBe°CU->
	`gëCUPñX
(Ë<< ", " <<ÑpcBe°CU->
	`gëCUPñY
(Ë<< " width=" << 
	`UI¡
‘pcBe°CU->
	`gëWidth
(0)Ë<< 
°d
::
ídl
;

1666 
sP¨ít
+=
ss
.
	`°r
();

1670 
	}
}

1672 
Void
 
	gTEncCu
::
	$xCheckDQP
–
TComD©aCU
* 
pcCU
 )

1674 
UI¡
 
uiDïth
 = 
pcCU
->
	`gëDïth
( 0 );

1676 c⁄° 
TComPPS
 &
µs
 = *(
pcCU
->
	`gëSli˚
()->
	`gëPPS
());

1677 i‡–
µs
.
	`gëU£DQP
(Ë&& 
uiDïth
 <µs.
	`gëMaxCuDQPDïth
() )

1679 i‡–
pcCU
->
	`gëQtRoŸCbf
( 0) )

1681 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

1682 
m_pcE¡r›yCodî
->
	`ícodeQP
–
pcCU
, 0, 
Ál£
 );

1683 
pcCU
->
	`gëTŸÆBôs
(Ë+
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

1684 
pcCU
->
	`gëTŸÆBös
(Ë+((
TEncBöCABAC
 *)((
TEncSbac
*)
m_pcE¡r›yCodî
->
m_pcE¡r›yCodîIf
)->
	`gëEncBöIf
())->
	`gëBösCoded
();

1685 
pcCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–pcCU->
	`gëTŸÆBôs
(),ÖcCU->
	`gëTŸÆDi°‹ti⁄
() );

1689 
pcCU
->
	`£tQPSubP¨ts
–pcCU->
	`gëRefQP
–0 ), 0, 
uiDïth
 );

1692 
	}
}

1694 
Void
 
	gTEncCu
::
	$xC›yAMVPInfo
 (
AMVPInfo
* 
pSrc
, AMVPInfo* 
pD°
)

1696 
pD°
->
iN
 = 
pSrc
->iN;

1697 
I¡
 
i
 = 0; i < 
pSrc
->
iN
; i++)

1699 
pD°
->
m_acMvC™d
[
i
] = 
pSrc
->m_acMvCand[i];

1701 
	}
}

1702 
Void
 
	gTEncCu
::
	$xC›yYuv2Pic
(
TComPic
* 
ΩcPic
, 
UI¡
 
uiCUAddr
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiSrcDïth
 )

1704 
UI¡
 
uiAbsP¨tIdxInRa°î
 = 
g_auiZsˇnToRa°î
[
uiAbsP¨tIdx
];

1705 
UI¡
 
uiSrcBlkWidth
 = 
ΩcPic
->
	`gëNumP¨tInCtuWidth
(Ë>> (
uiSrcDïth
);

1706 
UI¡
 
uiBlkWidth
 = 
ΩcPic
->
	`gëNumP¨tInCtuWidth
(Ë>> (
uiDïth
);

1707 
UI¡
 
uiP¨tIdxX
 = ( ( 
uiAbsP¨tIdxInRa°î
 % 
ΩcPic
->
	`gëNumP¨tInCtuWidth
(ËË% 
uiSrcBlkWidth
Ë/ 
uiBlkWidth
;

1708 
UI¡
 
uiP¨tIdxY
 = ( ( 
uiAbsP¨tIdxInRa°î
 / 
ΩcPic
->
	`gëNumP¨tInCtuWidth
(ËË% 
uiSrcBlkWidth
Ë/ 
uiBlkWidth
;

1709 
UI¡
 
uiP¨tIdx
 = 
uiP¨tIdxY
 * ( 
uiSrcBlkWidth
 / 
uiBlkWidth
 ) + 
uiP¨tIdxX
;

1710 
m_µcRecoYuvBe°
[
uiSrcDïth
]->
	`c›yToPicYuv
–
ΩcPic
->
	`gëPicYuvRec
 (), 
uiCUAddr
, 
uiAbsP¨tIdx
, 
uiDïth
 - uiSrcDïth, 
uiP¨tIdx
);

1712 
m_µcPªdYuvBe°
[
uiSrcDïth
]->
	`c›yToPicYuv
–
ΩcPic
->
	`gëPicYuvPªd
 (), 
uiCUAddr
, 
uiAbsP¨tIdx
, 
uiDïth
 - uiSrcDïth, 
uiP¨tIdx
);

1713 
	}
}

1715 
Void
 
	gTEncCu
::
	$xC›yYuv2Tmp
–
UI¡
 
uiP¨tUnôIdx
, UI¡ 
uiNextDïth
 )

1717 
UI¡
 
uiCuºDïth
 = 
uiNextDïth
 - 1;

1718 
m_µcRecoYuvBe°
[
uiNextDïth
]->
	`c›yToP¨tYuv
–
m_µcRecoYuvTemp
[
uiCuºDïth
], 
uiP¨tUnôIdx
 );

1719 
m_µcPªdYuvBe°
[
uiNextDïth
]->
	`c›yToP¨tYuv
–m_µcPªdYuvBe°[
uiCuºDïth
], 
uiP¨tUnôIdx
);

1720 
	}
}

1726 
Void
 
	gTEncCu
::
	$xFûlPCMBuf„r
 ( 
TComD©aCU
* 
pCU
, 
TComYuv
* 
pOrgYuv
 )

1728 c⁄° 
ChromaF‹m©
 
f‹m©
 = 
pCU
->
	`gëPic
()->
	`gëChromaF‹m©
();

1729 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
f‹m©
);

1730 
UI¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
numbîVÆidComp⁄íts
; componentIndex++)

1732 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

1734 c⁄° 
UI¡
 
width
 = 
pCU
->
	`gëWidth
(0Ë>> 
	`gëComp⁄ítSˇÀX
(
comp⁄ít
, 
f‹m©
);

1735 c⁄° 
UI¡
 
height
 = 
pCU
->
	`gëHeight
(0Ë>> 
	`gëComp⁄ítSˇÀY
(
comp⁄ít
, 
f‹m©
);

1737 
Pñ
 *
sour˚
 = 
pOrgYuv
->
	`gëAddr
(
comp⁄ít
, 0, 
width
);

1738 
Pñ
 *
de°ö©i⁄
 = 
pCU
->
	`gëPCMSam∂e
(
comp⁄ít
);

1740 c⁄° 
UI¡
 
sour˚Såide
 = 
pOrgYuv
->
	`gëSåide
(
comp⁄ít
);

1742 
I¡
 
löe
 = 0;Üöê< 
height
;Üine++)

1744 
I¡
 
cﬁumn
 = 0; cﬁum¿< 
width
; column++)

1746 
de°ö©i⁄
[
cﬁumn
] = 
sour˚
[column];

1749 
sour˚
 +
sour˚Såide
;

1750 
de°ö©i⁄
 +
width
;

1753 
	}
}

1755 #i‡
ADAPTIVE_QP_SELECTION


1758 
I¡
 
	gTEncCu
::
	$xTuCﬁÀ˘ARLSèts
(
TC€ff
* 
ΩcC€ff
, TC€ff* 
ΩcAæC€ff
, 
I¡
 
NumC€ffInCU
, 
DoubÀ
* 
cSum
, 
UI¡
* 
numSam∂es
 )

1760  
I¡
 
n
 = 0;Ç < 
NumC€ffInCU
;Ç++ )

1762 
TC€ff
 
u
 = 
	`abs
–
ΩcC€ff
[ 
n
 ] );

1763 
TC€ff
 
absc
 = 
ΩcAæC€ff
[ 
n
 ];

1765 if–
u
 != 0 )

1767 if–
u
 < 
LEVEL_RANGE
 )

1769 
cSum
[ 
u
 ] +–
DoubÀ
 )
absc
;

1770 
numSam∂es
[ 
u
 ]++;

1774 
cSum
[ 
LEVEL_RANGE
 ] +–
DoubÀ
 )
absc
 - ( DoubÀ )–
u
 << 
ARL_C_PRECISION
 );

1775 
numSam∂es
[ 
LEVEL_RANGE
 ]++;

1781 
	}
}

1784 
Void
 
	gTEncCu
::
	$xCtuCﬁÀ˘ARLSèts
(
TComD©aCU
* 
pCtu
 )

1786 
DoubÀ
 
cSum
[ 
LEVEL_RANGE
 + 1 ];

1787 
UI¡
 
numSam∂es
[ 
LEVEL_RANGE
 + 1 ];

1789 
TC€ff
* 
pC€ffY
 = 
pCtu
->
	`gëC€ff
(
COMPONENT_Y
);

1790 
TC€ff
* 
pAæC€ffY
 = 
pCtu
->
	`gëAæC€ff
(
COMPONENT_Y
);

1791 c⁄° 
TComSPS
 &
•s
 = *(
pCtu
->
	`gëSli˚
()->
	`gëSPS
());

1793 c⁄° 
UI¡
 
uiMöCUWidth
 = 
•s
.
	`gëMaxCUWidth
(Ë>> sps.
	`gëMaxTŸÆCUDïth
();

1794 c⁄° 
UI¡
 
uiMöNumC€ffInCU
 = 1 << 
uiMöCUWidth
;

1796 
	`mem£t
–
cSum
, 0, –
DoubÀ
 )*(
LEVEL_RANGE
+1) );

1797 
	`mem£t
–
numSam∂es
, 0, –
UI¡
 )*(
LEVEL_RANGE
+1) );

1800 
I¡
 
i
 = 0; i < 
pCtu
->
	`gëTŸÆNumP¨t
(); i ++ )

1802 
UI¡
 
uiTrIdx
 = 
pCtu
->
	`gëTønsf‹mIdx
(
i
);

1804 if(
pCtu
->
	`isI¡î
(
i
Ë&&ÖCtu->
	`gëCbf
–i, 
COMPONENT_Y
, 
uiTrIdx
 ) )

1806 
	`xTuCﬁÀ˘ARLSèts
(
pC€ffY
, 
pAæC€ffY
, 
uiMöNumC€ffInCU
, 
cSum
, 
numSam∂es
);

1809 
pC€ffY
 +
uiMöNumC€ffInCU
;

1810 
pAæC€ffY
 +
uiMöNumC€ffInCU
;

1813 
I¡
 
u
=1; u<
LEVEL_RANGE
;u++)

1815 
m_pcTrQu™t
->
	`gëSli˚SumC
()[
u
] +
cSum
[ u ] ;

1816 
m_pcTrQu™t
->
	`gëSli˚NSam∂es
()[
u
] +
numSam∂es
[ u ] ;

1818 
m_pcTrQu™t
->
	`gëSli˚SumC
()[
LEVEL_RANGE
] +
cSum
[ LEVEL_RANGE ] ;

1819 
m_pcTrQu™t
->
	`gëSli˚NSam∂es
()[
LEVEL_RANGE
] +
numSam∂es
[ LEVEL_RANGE ] ;

1820 
	}
}

	@TLibEncoder/TEncCu.h

38 #i‚de‡
__TENCCU__


39 
	#__TENCCU__


	)

42 
	~"TLibComm⁄/Comm⁄Def.h
"

43 
	~"TLibComm⁄/TComYuv.h
"

44 
	~"TLibComm⁄/TComPªdi˘i⁄.h
"

45 
	~"TLibComm⁄/TComTrQu™t.h
"

46 
	~"TLibComm⁄/TComBôCou¡î.h
"

47 
	~"TLibComm⁄/TComD©aCU.h
"

49 
	~"TEncE¡r›y.h
"

50 
	~"TEncSórch.h
"

51 
	~"TEncR©eCål.h
"

55 
˛ass
 
	gTEncT›
;

56 
˛ass
 
	gTEncSbac
;

57 
˛ass
 
	gTEncCavlc
;

58 
˛ass
 
	gTEncSli˚
;

65 ˛as†
	cTEncCu


67 
	m¥iv©e
:

69 
TComD©aCU
** 
m_µcBe°CU
;

70 
TComD©aCU
** 
	mm_µcTempCU
;

71 
UCh¨
 
	mm_uhTŸÆDïth
;

73 
TComYuv
** 
	mm_µcPªdYuvBe°
;

74 
TComYuv
** 
	mm_µcResiYuvBe°
;

75 
TComYuv
** 
	mm_µcRecoYuvBe°
;

76 
TComYuv
** 
	mm_µcPªdYuvTemp
;

77 
TComYuv
** 
	mm_µcResiYuvTemp
;

78 
TComYuv
** 
	mm_µcRecoYuvTemp
;

79 
TComYuv
** 
	mm_µcOrigYuv
;

82 
Boﬁ
 
	mm_bEncodeDQP
;

83 
Boﬁ
 
	mm_bFa°DñèQP
;

84 
Boﬁ
 
	mm_°ûlToCodeChromaQpOff£tFœg
;

85 
I¡
 
	mm_cuChromaQpOff£tIdxPlus1
;

86 
I¡
 
	mm_lumaLevñToDñèQPLUT
[
LUMA_LEVEL_TO_DQP_LUT_MAXSIZE
];

87 
I¡
 
	mm_lumaQPOff£t
;

88 
TEncSli˚
* 
	mm_pcSli˚Encodî
;

91 
TEncCfg
* 
	mm_pcEncCfg
;

92 
TEncSórch
* 
	mm_pcPªdSórch
;

93 
TComTrQu™t
* 
	mm_pcTrQu™t
;

94 
TComRdCo°
* 
	mm_pcRdCo°
;

96 
TEncE¡r›y
* 
	mm_pcE¡r›yCodî
;

97 
TEncBöCABAC
* 
	mm_pcBöCABAC
;

100 
TEncSbac
*** 
	mm_µpcRDSbacCodî
;

101 
TEncSbac
* 
	mm_pcRDGoOnSbacCodî
;

102 
TEncR©eCål
* 
	mm_pcR©eCål
;

104 
	mpublic
:

106 
Void
 
öô
 ( 
TEncT›
* 
pcEncT›
 );

108 
Void
 
	$£tSli˚Encodî
–
TEncSli˚
* 
pSli˚Encodî
 ) { 
m_pcSli˚Encodî
 =ÖSliceEncoder; }

109 
TEncSli˚
* 
	$gëSli˚Encodî
(Ë{  
m_pcSli˚Encodî
; 
	}
}

110 
Void
 
öôLumaDñèQpLUT
();

111 
I¡
 
ˇlcuœãLumaDQP
–
TComD©aCU
 *
pCU
, c⁄° 
UI¡
 
absP¨tIdx
, c⁄° 
TComYuv
 * 
pOrgYuv
 );

114 
Void
 
¸óã
 ( 
UCh¨
 
uhTŸÆDïth
, 
UI¡
 
iMaxWidth
, UI¡ 
iMaxHeight
, 
ChromaF‹m©
 
chromaF‹m©
 );

117 
Void
 
de°roy
 ();

120 
Void
 
com¥essCtu
 ( 
TComD©aCU
* 
pCtu
 );

123 
Void
 
ícodeCtu
 ( 
TComD©aCU
* 
pCtu
 );

125 
I¡
 
upd©eCtuD©aISli˚
 ( 
TComD©aCU
* 
pCtu
, I¡ 
width
, I¡ 
height
 );

127 
Void
 
	$£tFa°DñèQp
 ( 
Boﬁ
 
b
Ë{ 
m_bFa°DñèQP
 = b; 
	}
}

129 
	g¥Ÿe˘ed
:

130 
Void
 
föishCU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

131 #i‡
AMP_ENC_SPEEDUP


132 
Void
 
xCom¥essCU
 ( 
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, c⁄° 
UI¡
 
uiDïth
 
DEBUG_STRING_FN_DECLARE
(
sDebug
), 
P¨tSize
 
eP¨ítP¨tSize
 = 
NUMBER_OF_PART_SIZES
 );

134 
Void
 
xCom¥essCU
 ( 
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, c⁄° 
UI¡
 
uiDïth
 );

136 
Void
 
xEncodeCU
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

138 
I¡
 
xCompuãQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiDïth
 );

139 
Void
 
xCheckBe°Mode
 ( 
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, 
UI¡
 
uiDïth
 
	$DEBUG_STRING_FN_DECLARE
(
sP¨ít
Ë
	$DEBUG_STRING_FN_DECLARE
(
sTe°
Ë
	`DEBUG_STRING_PASS_INTO
(
Boﬁ
 
bAddSizeInfo
=
åue
));

141 
Void
 
	`xCheckRDCo°Mîge2Nx2N
–
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
 
	`DEBUG_STRING_FN_DECLARE
(
sDebug
), 
Boﬁ
 *
óæyDëe˘i⁄SkùMode
 );

143 #i‡
AMP_MRG


144 
Void
 
	`xCheckRDCo°I¡î
 ( 
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, 
P¨tSize
 
eP¨tSize
 
	`DEBUG_STRING_FN_DECLARE
(
sDebug
), 
Boﬁ
 
bU£MRG
 = 
Ál£
 );

146 
Void
 
	`xCheckRDCo°I¡î
 ( 
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
, 
P¨tSize
 
eP¨tSize
 );

149 
Void
 
	`xCheckRDCo°I¡ø
 ( 
TComD©aCU
 *&
ΩcBe°CU
,

150 
TComD©aCU
 *&
ΩcTempCU
,

151 
P¨tSize
 
eP¨tSize


152 
	`DEBUG_STRING_FN_DECLARE
(
sDebug
)

155 
Void
 
	`xCheckDQP
 ( 
TComD©aCU
* 
pcCU
 );

157 
Void
 
	`xCheckI¡øPCM
 ( 
TComD©aCU
*& 
ΩcBe°CU
, TComD©aCU*& 
ΩcTempCU
 );

158 
Void
 
	`xC›yAMVPInfo
 ( 
AMVPInfo
* 
pSrc
, AMVPInfo* 
pD°
 );

159 
Void
 
	`xC›yYuv2Pic
 (
TComPic
* 
ΩcPic
, 
UI¡
 
uiCUAddr
, UI¡ 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, UI¡ 
uiSrcDïth
 );

160 
Void
 
	`xC›yYuv2Tmp
 ( 
UI¡
 
uhP¨tUnôIdx
, UI¡ 
uiDïth
 );

162 
Boﬁ
 
	$gëdQPFœg
 (Ë{  
m_bEncodeDQP
; 
	}
}

163 
Void
 
	$£tdQPFœg
 ( 
Boﬁ
 
b
 ) { 
m_bEncodeDQP
 = b; 
	}
}

165 
Boﬁ
 
	$gëFa°DñèQp
 (Ëc⁄° {  
m_bFa°DñèQP
; 
	}
}

167 
Boﬁ
 
	$gëCodeChromaQpAdjFœg
(Ë{  
m_°ûlToCodeChromaQpOff£tFœg
; 
	}
}

168 
Void
 
	$£tCodeChromaQpAdjFœg
–
Boﬁ
 
b
 ) { 
m_°ûlToCodeChromaQpOff£tFœg
 = b; 
	}
}

170 #i‡
ADAPTIVE_QP_SELECTION


172 
Void
 
xCtuCﬁÀ˘ARLSèts
(
TComD©aCU
* 
pCtu
);

173 
I¡
 
xTuCﬁÀ˘ARLSèts
(
TC€ff
* 
ΩcC€ff
, TC€ff* 
ΩcAæC€ff
, I¡ 
NumC€ffInCU
, 
DoubÀ
* 
cSum
, 
UI¡
* 
numSam∂es
 );

176 #i‡
AMP_ENC_SPEEDUP


177 #i‡
AMP_MRG


178 
Void
 
dîiveTe°ModeAMP
 (
TComD©aCU
 *
pcBe°CU
, 
P¨tSize
 
eP¨ítP¨tSize
, 
Boﬁ
 &
bTe°AMP_H‹
, Boﬁ &
bTe°AMP_Vî
, Boﬁ &
bTe°MîgeAMP_H‹
, Boﬁ &
bTe°MîgeAMP_Vî
);

180 
Void
 
dîiveTe°ModeAMP
 (
TComD©aCU
 *
pcBe°CU
, 
P¨tSize
 
eP¨ítP¨tSize
, 
Boﬁ
 &
bTe°AMP_H‹
, Boﬁ &
bTe°AMP_Vî
);

184 
Void
 
xFûlPCMBuf„r
 ( 
TComD©aCU
* 
pCU
, 
TComYuv
* 
pOrgYuv
 );

	@TLibEncoder/TEncEntropy.cpp

38 
	~"TEncE¡r›y.h
"

39 
	~"TLibComm⁄/Comm⁄Def.h
"

40 
	~"TLibComm⁄/TComSam∂eAd≠tiveOff£t.h
"

41 
	~"TLibComm⁄/TComTU.h
"

43 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


44 
	~"../TLibComm⁄/Debug.h
"

45 c⁄° 
Boﬁ
 
	gbDebugPªdE«bÀd
 = 
DebugO±i⁄Li°
::
DebugPªd
.
gëI¡
()!=0;

51 
Void
 
	gTEncE¡r›y
::
	$£tE¡r›yCodî
 ( 
TEncE¡r›yIf
* 
e
 )

53 
m_pcE¡r›yCodîIf
 = 
e
;

54 
	}
}

56 
Void
 
	gTEncE¡r›y
::
	$ícodeSli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
 )

58 
m_pcE¡r›yCodîIf
->
	`codeSli˚Hódî
–
pcSli˚
 );

60 
	}
}

62 
Void
 
	gTEncE¡r›y
::
	$ícodeTûesWPPE¡ryPoöt
–
TComSli˚
* 
pSli˚
 )

64 
m_pcE¡r›yCodîIf
->
	`codeTûesWPPE¡ryPoöt
–
pSli˚
 );

65 
	}
}

67 
Void
 
	gTEncE¡r›y
::
	$ícodeTîmö©ögBô
 ( 
UI¡
 
uiIsLa°
 )

69 
m_pcE¡r›yCodîIf
->
	`codeTîmö©ögBô
–
uiIsLa°
 );

72 
	}
}

74 
Void
 
	gTEncE¡r›y
::
	$ícodeSli˚Föish
()

76 
m_pcE¡r›yCodîIf
->
	`codeSli˚Föish
();

77 
	}
}

79 
Void
 
	gTEncE¡r›y
::
	$ícodePPS
–c⁄° 
TComPPS
* 
pcPPS
 )

81 
m_pcE¡r›yCodîIf
->
	`codePPS
–
pcPPS
 );

83 
	}
}

85 
Void
 
	gTEncE¡r›y
::
	$ícodeSPS
–c⁄° 
TComSPS
* 
pcSPS
 )

87 
m_pcE¡r›yCodîIf
->
	`codeSPS
–
pcSPS
 );

89 
	}
}

91 
Void
 
	gTEncE¡r›y
::
	$ícodeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 )

93 if–
bRD
 )

95 
uiAbsP¨tIdx
 = 0;

97 
m_pcE¡r›yCodîIf
->
	`codeCUTønsqu™tBy∑ssFœg
–
pcCU
, 
uiAbsP¨tIdx
 );

98 
	}
}

100 
Void
 
	gTEncE¡r›y
::
	$ícodeVPS
–c⁄° 
TComVPS
* 
pcVPS
 )

102 
m_pcE¡r›yCodîIf
->
	`codeVPS
–
pcVPS
 );

104 
	}
}

106 
Void
 
	gTEncE¡r›y
::
	$ícodeSkùFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 )

108 i‡–
pcCU
->
	`gëSli˚
()->
	`isI¡ø
() )

112 if–
bRD
 )

114 
uiAbsP¨tIdx
 = 0;

116 
m_pcE¡r›yCodîIf
->
	`codeSkùFœg
–
pcCU
, 
uiAbsP¨tIdx
 );

117 
	}
}

120 
Void
 
	gTEncE¡r›y
::
	$ícodeMîgeFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

123 
m_pcE¡r›yCodîIf
->
	`codeMîgeFœg
–
pcCU
, 
uiAbsP¨tIdx
 );

124 
	}
}

127 
Void
 
	gTEncE¡r›y
::
	$ícodeMîgeIndex
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 )

129 if–
bRD
 )

131 
uiAbsP¨tIdx
 = 0;

132 
	`as£π
–
pcCU
->
	`gëP¨tôi⁄Size
(
uiAbsP¨tIdx
Ë=
SIZE_2Nx2N
 );

134 
m_pcE¡r›yCodîIf
->
	`codeMîgeIndex
–
pcCU
, 
uiAbsP¨tIdx
 );

135 
	}
}

139 
Void
 
	gTEncE¡r›y
::
	$ícodePªdMode
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 )

141 if–
bRD
 )

143 
uiAbsP¨tIdx
 = 0;

146 i‡–
pcCU
->
	`gëSli˚
()->
	`isI¡ø
() )

151 
m_pcE¡r›yCodîIf
->
	`codePªdMode
–
pcCU
, 
uiAbsP¨tIdx
 );

152 
	}
}

155 
Void
 
	gTEncE¡r›y
::
	$ícodeS∂ôFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
 
bRD
 )

157 if–
bRD
 )

159 
uiAbsP¨tIdx
 = 0;

162 
m_pcE¡r›yCodîIf
->
	`codeS∂ôFœg
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

163 
	}
}

166 
Void
 
	gTEncE¡r›y
::
	$ícodeP¨tSize
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
 
bRD
 )

168 if–
bRD
 )

170 
uiAbsP¨tIdx
 = 0;

173 
m_pcE¡r›yCodîIf
->
	`codeP¨tSize
–
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
 );

174 
	}
}

182 
Void
 
	gTEncE¡r›y
::
	$ícodeIPCMInfo
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 )

184 if(!
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëU£PCM
()

185 || 
pcCU
->
	`gëWidth
(
uiAbsP¨tIdx
Ë> (1<<pcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPCMLog2MaxSize
())

186 || 
pcCU
->
	`gëWidth
(
uiAbsP¨tIdx
Ë< (1<<pcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPCMLog2MöSize
()))

191 if–
bRD
 )

193 
uiAbsP¨tIdx
 = 0;

196 
m_pcE¡r›yCodîIf
->
	`codeIPCMInfo
 ( 
pcCU
, 
uiAbsP¨tIdx
 );

198 
	}
}

200 
Void
 
	gTEncE¡r›y
::
	$xEncodeTønsf‹m
–
Boﬁ
& 
bCodeDQP
, Boﬁ& 
codeChromaQpAdj
, 
TComTU
 &
rTu
 )

203 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

204 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

205 c⁄° 
UI¡
 
numVÆidComp⁄ít
 = 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

206 c⁄° 
Boﬁ
 
bChroma
 = 
	`isChromaE«bÀd
(
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
());

207 c⁄° 
UI¡
 
uiTrIdx
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

208 c⁄° 
UI¡
 
uiDïth
 = 
rTu
.
	`GëTønsf‹mDïthTŸÆ
();

209 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


210 c⁄° 
Boﬁ
 
bDebugRQT
=
pcCU
->
	`gëSli˚
()->
	`gëFöÆized
(Ë&& 
DebugO±i⁄Li°
::
DebugRQT
.
	`gëI¡
()!=0;

211 i‡(
bDebugRQT
)

213 
	`¥ötf
("x..codeTransform: offsetLuma=%d offsetChroma=%dábsPartIdx=%d, uiDepth=%d\n width=%d, height=%d, uiTrIdx=%d, uiInnerQuadIdx=%d\n",

214 
rTu
.
	`gëC€fficõ¡Off£t
(
COMPONENT_Y
),ÑTu.gëC€fficõ¡Off£t(
COMPONENT_Cb
), 
uiAbsP¨tIdx
, 
uiDïth
,ÑTu.
	`gëRe˘
(COMPONENT_Y).
width
,ÑTu.gëRe˘(COMPONENT_Y).
height
,ÑTu.
	`GëTønsf‹mDïthRñ
(),ÑTu.
	`GëSe˘i⁄Numbî
());

217 c⁄° 
UI¡
 
uiSubdiv
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 ) > 
uiTrIdx
;

218 c⁄° 
UI¡
 
uiLog2TøfoSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

221 
UI¡
 
cbf
[
MAX_NUM_COMPONENT
] = {0,0,0};

222 
Boﬁ
 
bHaveACodedBlock
 = 
Ál£
;

223 
Boﬁ
 
bHaveACodedChromaBlock
 = 
Ál£
;

225 
UI¡
 
ch
=0; ch<
numVÆidComp⁄ít
; ch++)

227 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

229 
cbf
[
compID
] = 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, compID , 
uiTrIdx
 );

231 i‡(
cbf
[
ch
] != 0)

233 
bHaveACodedBlock
 = 
åue
;

234 i‡(
	`isChroma
(
compID
))

236 
bHaveACodedChromaBlock
 = 
åue
;

241 if–
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
Ë&&ÖcCU->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdxË=
SIZE_NxN
 && 
uiDïth
 =pcCU->
	`gëDïth
(uiAbsPartIdx) )

243 
	`as£π
–
uiSubdiv
 );

245 if–
pcCU
->
	`isI¡î
(
uiAbsP¨tIdx
Ë&& (pcCU->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdxË!
SIZE_2Nx2N
Ë&& 
uiDïth
 =pcCU->
	`gëDïth
(uiAbsP¨tIdxË&& (pcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTUMaxDïthI¡î
() == 1) )

247 i‡–
uiLog2TøfoSize
 > 
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) )

249 
	`as£π
–
uiSubdiv
 );

253 
	`as£π
(!
uiSubdiv
 );

256 if–
uiLog2TøfoSize
 > 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
() )

258 
	`as£π
–
uiSubdiv
 );

260 if–
uiLog2TøfoSize
 =
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MöSize
() )

262 
	`as£π
–!
uiSubdiv
 );

264 if–
uiLog2TøfoSize
 =
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) )

266 
	`as£π
–!
uiSubdiv
 );

270 
	`as£π
–
uiLog2TøfoSize
 > 
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) );

271 
m_pcE¡r›yCodîIf
->
	`codeTønsf‹mSubdivFœg
–
uiSubdiv
, 5 - 
uiLog2TøfoSize
 );

274 c⁄° 
UI¡
 
uiTrDïthCuº
 = 
uiDïth
 - 
pcCU
->
	`gëDïth
–
uiAbsP¨tIdx
 );

275 c⁄° 
Boﬁ
 
bFú°CbfOfCU
 = 
uiTrDïthCuº
 == 0;

277 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
numVÆidComp⁄ít
; ch++)

279 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

280 if–
bFú°CbfOfCU
 || 
rTu
.
	`Pro˚ssögAŒQuadø¡s
(
compID
) )

282 if–
bFú°CbfOfCU
 || 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
compID
, 
uiTrDïthCuº
 - 1 ) )

284 
m_pcE¡r›yCodîIf
->
	`codeQtCbf
–
rTu
, 
compID
, (
uiSubdiv
 == 0) );

289 
	`as£π
–
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
compID
, 
uiTrDïthCuº
 ) ==ÖcCU->getCbf( uiAbsPartIdx, compID, uiTrDepthCurr - 1 ) );

293 if–
uiSubdiv
 )

295 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
åue
);

298 
	`xEncodeTønsf‹m
–
bCodeDQP
, 
codeChromaQpAdj
, 
tuRecur£Chûd
 );

299 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
));

304 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

305 
	`DTRACE_CABAC_T
( "\tTrIdx:ábspart=" );

306 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 );

307 
	`DTRACE_CABAC_T
( "\tdepth=" );

308 
	`DTRACE_CABAC_V
–
uiDïth
 );

309 
	`DTRACE_CABAC_T
( "\ttrdepth=" );

310 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 ) );

311 
	`DTRACE_CABAC_T
( "\n" );

314 if–!
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
Ë&& 
uiDïth
 =pcCU->
	`gëDïth
–uiAbsP¨tIdx ) && (!
bChroma
 || (!pcCU->
	`gëCbf
–uiAbsP¨tIdx, 
COMPONENT_Cb
, 0 ) && !pcCU->gëCbf–uiAbsP¨tIdx, 
COMPONENT_Cr
, 0 ) ) ) )

316 
	`as£π
–
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
COMPONENT_Y
, 0 ) );

321 
m_pcE¡r›yCodîIf
->
	`codeQtCbf
–
rTu
, 
COMPONENT_Y
, 
åue
 );

324 i‡–
bHaveACodedBlock
 )

327 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£DQP
() )

329 i‡–
bCodeDQP
 )

331 
	`ícodeQP
–
pcCU
, 
rTu
.
	`GëAbsP¨tIdxCU
() );

332 
bCodeDQP
 = 
Ál£
;

336 i‡–
pcCU
->
	`gëSli˚
()->
	`gëU£ChromaQpAdj
() )

338 i‡–
bHaveACodedChromaBlock
 && 
codeChromaQpAdj
 && !
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
rTu
.
	`GëAbsP¨tIdxCU
()) )

340 
	`ícodeChromaQpAdju°mít
–
pcCU
, 
rTu
.
	`GëAbsP¨tIdxCU
() );

341 
codeChromaQpAdj
 = 
Ál£
;

345 c⁄° 
UI¡
 
numVÆidComp
=
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

347 
UI¡
 
ch
=
COMPONENT_Y
; ch<
numVÆidComp
; ch++)

349 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

351 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

353 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


354 i‡(
bDebugRQT
)

356 
	`¥ötf
("CÆ»NxN f‹ ch™ %d width=%d height=%d cbf=%d\n", 
compID
, 
rTu
.
	`gëRe˘
(compID).
width
,ÑTu.gëRe˘(compID).
height
, 1);

360 i‡(
rTu
.
	`gëRe˘
(
compID
).
width
 !rTu.gëRe˘(compID).
height
)

363 
TComTURecur£
 
	`subTUIãøt‹
(
rTu
, 
Ál£
, 
TComTU
::
VERTICAL_SPLIT
, 
åue
, 
compID
);

367 c⁄° 
UCh¨
 
subTUCBF
 = 
pcCU
->
	`gëCbf
(
subTUIãøt‹
.
	`GëAbsP¨tIdxTU
(
compID
), compID, (
uiTrIdx
 + 1));

369 i‡(
subTUCBF
 != 0)

371 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


372 i‡(
bDebugRQT
)

374 
	`¥ötf
("CÆ»NxN f‹ ch™ %d width=%d height=%d cbf=%d\n", 
compID
, 
subTUIãøt‹
.
	`gëRe˘
(compID).
width
, subTUIãøt‹.gëRe˘(compID).
height
, 1);

377 
m_pcE¡r›yCodîIf
->
	`codeC€ffNxN
–
subTUIãøt‹
, (
pcCU
->
	`gëC€ff
(
compID
Ë+ subTUIãøt‹.
	`gëC€fficõ¡Off£t
(compID)), compID );

380 
subTUIãøt‹
.
	`√xtSe˘i⁄
(
rTu
));

384 i‡(
	`isChroma
(
compID
Ë&& (
cbf
[
COMPONENT_Y
] != 0))

386 
m_pcE¡r›yCodîIf
->
	`codeCrossComp⁄ítPªdi˘i⁄
–
rTu
, 
compID
 );

389 i‡(
cbf
[
compID
] != 0)

391 
m_pcE¡r›yCodîIf
->
	`codeC€ffNxN
–
rTu
, (
pcCU
->
	`gëC€ff
(
compID
Ë+ÑTu.
	`gëC€fficõ¡Off£t
(compID)), compID );

398 
	}
}

402 
Void
 
	gTEncE¡r›y
::
	$ícodeI¡øDúModeLuma
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
absP¨tIdx
, 
Boﬁ
 
isMu…ùÀPU
 )

404 
m_pcE¡r›yCodîIf
->
	`codeI¡øDúLumaAng
–
pcCU
, 
absP¨tIdx
 , 
isMu…ùÀPU
);

405 
	}
}

409 
Void
 
	gTEncE¡r›y
::
	$ícodeI¡øDúModeChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

411 
m_pcE¡r›yCodîIf
->
	`codeI¡øDúChroma
–
pcCU
, 
uiAbsP¨tIdx
 );

413 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


414 i‡(
bDebugPªdE«bÀd
 && 
pcCU
->
	`gëSli˚
()->
	`gëFöÆized
())

416 
UI¡
 
cdú
=
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_CHROMA
, 
uiAbsP¨tIdx
);

417 i‡(
cdú
==36)

419 
cdú
=
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
uiAbsP¨tIdx
);

421 
	`¥ötf
("codög chrom®I¡ø dú: %d, uiAbsP¨tIdx: %d,Üum®dú: %d\n", 
cdú
, 
uiAbsP¨tIdx
, 
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, uiAbsPartIdx));

424 
	}
}

427 
Void
 
	gTEncE¡r›y
::
	$ícodePªdInfo
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

429 if–
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) )

431 
	`ícodeI¡øDúModeLuma
 ( 
pcCU
, 
uiAbsP¨tIdx
,
åue
 );

432 i‡(
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
()!=
CHROMA_400
)

434 
	`ícodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
 );

436 i‡(
	`íabÀ4ChromaPUsInI¡øNxNCU
(
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
()Ë&&ÖcCU->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 )==
SIZE_NxN
)

438 
UI¡
 
uiP¨tOff£t
 = ( 
pcCU
->
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (ÖcCU->
	`gëDïth
(
uiAbsP¨tIdx
) << 1 ) ) >> 2;

439 
	`ícodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
 + 
uiP¨tOff£t
 );

440 
	`ícodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
 + 
uiP¨tOff£t
*2 );

441 
	`ícodeI¡øDúModeChroma
–
pcCU
, 
uiAbsP¨tIdx
 + 
uiP¨tOff£t
*3 );

447 
	`ícodePUWi£
–
pcCU
, 
uiAbsP¨tIdx
 );

449 
	}
}

451 
Void
 
	gTEncE¡r›y
::
	$ícodeCrossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 )

453 
m_pcE¡r›yCodîIf
->
	`codeCrossComp⁄ítPªdi˘i⁄
–
rTu
, 
compID
 );

454 
	}
}

457 
Void
 
	gTEncE¡r›y
::
	$ícodePUWi£
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

459 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


460 c⁄° 
Boﬁ
 
bDebugPªd
 = 
bDebugPªdE«bÀd
 && 
pcCU
->
	`gëSli˚
()->
	`gëFöÆized
();

463 
P¨tSize
 
eP¨tSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 );

464 
UI¡
 
uiNumPU
 = ( 
eP¨tSize
 =
SIZE_2Nx2N
 ? 1 : (ÉP¨tSizê=
SIZE_NxN
 ? 4 : 2 ) );

465 
UI¡
 
uiDïth
 = 
pcCU
->
	`gëDïth
–
uiAbsP¨tIdx
 );

466 
UI¡
 
uiPUOff£t
 = ( 
g_auiPUOff£t
[
	`UI¡
–
eP¨tSize
 )] << ( ( 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëMaxTŸÆCUDïth
(Ë- 
uiDïth
 ) << 1 ) ) >> 4;

468  
UI¡
 
uiP¨tIdx
 = 0, 
uiSubP¨tIdx
 = 
uiAbsP¨tIdx
; uiP¨tIdx < 
uiNumPU
; uiP¨tIdx++, uiSubP¨tIdx +
uiPUOff£t
 )

470 
	`ícodeMîgeFœg
–
pcCU
, 
uiSubP¨tIdx
 );

471 i‡–
pcCU
->
	`gëMîgeFœg
–
uiSubP¨tIdx
 ) )

473 
	`ícodeMîgeIndex
–
pcCU
, 
uiSubP¨tIdx
 );

474 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


475 i‡(
bDebugPªd
)

477 
°d
::
cout
 << "Coded mîgêÊag, CUábsP¨tIdx: " << 
uiAbsP¨tIdx
 << " PU(" << 
uiP¨tIdx
 << "ËabsP¨tIdx: " << 
uiSubP¨tIdx
;

478 
°d
::
cout
 << " mîgêödex: " << (
UI¡
)
pcCU
->
	`gëMîgeIndex
(
uiSubP¨tIdx
Ë<< std::
ídl
;

484 
	`ícodeI¡îDúPU
–
pcCU
, 
uiSubP¨tIdx
 );

485  
UI¡
 
uiRefLi°Idx
 = 0; uiRefListIdx < 2; uiRefListIdx++ )

487 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
	`RefPicLi°
–
uiRefLi°Idx
 ) ) > 0 )

489 
	`ícodeRefFrmIdxPU
 ( 
pcCU
, 
uiSubP¨tIdx
, 
	`RefPicLi°
–
uiRefLi°Idx
 ) );

490 
	`ícodeMvdPU
 ( 
pcCU
, 
uiSubP¨tIdx
, 
	`RefPicLi°
–
uiRefLi°Idx
 ) );

491 
	`ícodeMVPIdxPU
 ( 
pcCU
, 
uiSubP¨tIdx
, 
	`RefPicLi°
–
uiRefLi°Idx
 ) );

492 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


493 i‡(
bDebugPªd
)

495 
°d
::
cout
 << "ªfLi°Idx: " << 
uiRefLi°Idx
 << std::
ídl
;

496 
°d
::
cout
 << "MVD h‹iz⁄èl: " << 
pcCU
->
	`gëCUMvFõld
(
	`RefPicLi°
(
uiRefLi°Idx
))->
	`gëMvd
–
uiAbsP¨tIdx
 ).
	`gëH‹
(Ë<< std::
ídl
;

497 
°d
::
cout
 << "MVD vîtiˇl: " << 
pcCU
->
	`gëCUMvFõld
(
	`RefPicLi°
(
uiRefLi°Idx
))->
	`gëMvd
–
uiAbsP¨tIdx
 ).
	`gëVî
(Ë<< std::
ídl
;

498 
°d
::
cout
 << "MVPIdxPU: " << 
pcCU
->
	`gëMVPIdx
(
	`RefPicLi°
–
uiRefLi°Idx
 ), 
uiSubP¨tIdx
Ë<< std::
ídl
;

499 
°d
::
cout
 << "I¡îDú: " << (
UI¡
)
pcCU
->
	`gëI¡îDú
(
uiSubP¨tIdx
Ë<< std::
ídl
;

508 
	}
}

510 
Void
 
	gTEncE¡r›y
::
	$ícodeI¡îDúPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

512 i‡–!
pcCU
->
	`gëSli˚
()->
	`isI¡îB
() )

517 
m_pcE¡r›yCodîIf
->
	`codeI¡îDú
–
pcCU
, 
uiAbsP¨tIdx
 );

520 
	}
}

523 
Void
 
	gTEncE¡r›y
::
	$ícodeRefFrmIdxPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

525 
	`as£π
–
pcCU
->
	`isI¡î
–
uiAbsP¨tIdx
 ) );

527 i‡––
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
eRefLi°
 ) == 1 ) )

532 i‡–
pcCU
->
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) & ( 1 << 
eRefLi°
 ) )

534 
m_pcE¡r›yCodîIf
->
	`codeRefFrmIdx
–
pcCU
, 
uiAbsP¨tIdx
, 
eRefLi°
 );

538 
	}
}

541 
Void
 
	gTEncE¡r›y
::
	$ícodeMvdPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

543 
	`as£π
–
pcCU
->
	`isI¡î
–
uiAbsP¨tIdx
 ) );

545 i‡–
pcCU
->
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) & ( 1 << 
eRefLi°
 ) )

547 
m_pcE¡r›yCodîIf
->
	`codeMvd
–
pcCU
, 
uiAbsP¨tIdx
, 
eRefLi°
 );

550 
	}
}

552 
Void
 
	gTEncE¡r›y
::
	$ícodeMVPIdxPU
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

554 i‡–(
pcCU
->
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) & ( 1 << 
eRefLi°
 )) )

556 
m_pcE¡r›yCodîIf
->
	`codeMVPIdx
–
pcCU
, 
uiAbsP¨tIdx
, 
eRefLi°
 );

560 
	}
}

562 
Void
 
	gTEncE¡r›y
::
	$ícodeQtCbf
–
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 )

564 
m_pcE¡r›yCodîIf
->
	`codeQtCbf
–
rTu
, 
compID
, 
lowe°Levñ
 );

565 
	}
}

567 
Void
 
	gTEncE¡r›y
::
	$ícodeTønsf‹mSubdivFœg
–
UI¡
 
uiSymbﬁ
, UI¡ 
uiCtx
 )

569 
m_pcE¡r›yCodîIf
->
	`codeTønsf‹mSubdivFœg
–
uiSymbﬁ
, 
uiCtx
 );

570 
	}
}

572 
Void
 
	gTEncE¡r›y
::
	$ícodeQtRoŸCbf
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

574 
m_pcE¡r›yCodîIf
->
	`codeQtRoŸCbf
–
pcCU
, 
uiAbsP¨tIdx
 );

575 
	}
}

577 
Void
 
	gTEncE¡r›y
::
	$ícodeQtCbfZîo
–
TComTU
 &
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 )

579 
m_pcE¡r›yCodîIf
->
	`codeQtCbfZîo
–
rTu
, 
chTy≥
 );

580 
	}
}

582 
Void
 
	gTEncE¡r›y
::
	$ícodeQtRoŸCbfZîo
( )

584 
m_pcE¡r›yCodîIf
->
	`codeQtRoŸCbfZîo
( );

585 
	}
}

588 
Void
 
	gTEncE¡r›y
::
	$ícodeQP
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 )

590 if–
bRD
 )

592 
uiAbsP¨tIdx
 = 0;

595 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£DQP
() )

597 
m_pcE¡r›yCodîIf
->
	`codeDñèQP
–
pcCU
, 
uiAbsP¨tIdx
 );

599 
	}
}

602 
Void
 
	gTEncE¡r›y
::
	$ícodeChromaQpAdju°mít
–
TComD©aCU
* 
cu
, 
UI¡
 
absP¨tIdx
, 
Boﬁ
 
öRd
 )

604 if–
öRd
 )

606 
absP¨tIdx
 = 0;

609 
m_pcE¡r›yCodîIf
->
	`codeChromaQpAdju°mít
–
cu
, 
absP¨tIdx
 );

610 
	}
}

615 
Void
 
	gTEncE¡r›y
::
	$ícodeC€ff
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
& 
bCodeDQP
, Boﬁ& 
codeChromaQpAdj
 )

617 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


618 c⁄° 
Boﬁ
 
bDebugRQT
=
pcCU
->
	`gëSli˚
()->
	`gëFöÆized
(Ë&& 
DebugO±i⁄Li°
::
DebugRQT
.
	`gëI¡
()!=0;

621 if–
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
) )

623 i‡(
Ál£
)

625 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

626 
	`DTRACE_CABAC_T
( "\tdecodeTransformIdx()\tCUDepth=" )

627 
	`DTRACE_CABAC_V
–
uiDïth
 )

628 
	`DTRACE_CABAC_T
( "\n" )

633 if–!(
pcCU
->
	`gëMîgeFœg
–
uiAbsP¨tIdx
 ) &&ÖcCU->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdxË=
SIZE_2Nx2N
 ) )

635 
m_pcE¡r›yCodîIf
->
	`codeQtRoŸCbf
–
pcCU
, 
uiAbsP¨tIdx
 );

637 i‡–!
pcCU
->
	`gëQtRoŸCbf
–
uiAbsP¨tIdx
 ) )

643 
TComTURecur£
 
	`tuRecur£
(
pcCU
, 
uiAbsP¨tIdx
, 
uiDïth
);

644 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


645 i‡(
bDebugRQT
)

647 
	`¥ötf
("..codeC€ff: uiAbsP¨tIdx=%d, PU f‹m©=%d, 2Nx2N=%d, NxN=%d\n", 
uiAbsP¨tIdx
, 
pcCU
->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdx), 
SIZE_2Nx2N
, 
SIZE_NxN
);

651 
	`xEncodeTønsf‹m
–
bCodeDQP
, 
codeChromaQpAdj
, 
tuRecur£
 );

652 
	}
}

654 
Void
 
	gTEncE¡r›y
::
	$ícodeC€ffNxN
–
TComTU
 &
rTu
, 
TC€ff
* 
pcC€f
, c⁄° 
Comp⁄ítID
 
compID
)

656 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

658 i‡(
pcCU
->
	`gëCbf
(
rTu
.
	`GëAbsP¨tIdxTU
(), 
compID
,ÑTu.
	`GëTønsf‹mDïthRñ
()) != 0)

660 i‡(
rTu
.
	`gëRe˘
(
compID
).
width
 !rTu.gëRe˘(compID).
height
)

663 
TComTURecur£
 
	`subTUIãøt‹
(
rTu
, 
Ál£
, 
TComTU
::
VERTICAL_SPLIT
, 
åue
, 
compID
);

665 c⁄° 
UI¡
 
subTUSize
 = 
subTUIãøt‹
.
	`gëRe˘
(
compID
).
width
 * subTUIãøt‹.gëRe˘(compID).
height
;

669 c⁄° 
UCh¨
 
subTUCBF
 = 
pcCU
->
	`gëCbf
(
subTUIãøt‹
.
	`GëAbsP¨tIdxTU
(
compID
), compID, (subTUIãøt‹.
	`GëTønsf‹mDïthRñ
() + 1));

671 i‡(
subTUCBF
 != 0)

673 
m_pcE¡r›yCodîIf
->
	`codeC€ffNxN
–
subTUIãøt‹
, (
pcC€f
 + (subTUIãøt‹.
	`GëSe˘i⁄Numbî
(Ë* 
subTUSize
)), 
compID
);

676 
subTUIãøt‹
.
	`√xtSe˘i⁄
(
rTu
));

680 
m_pcE¡r›yCodîIf
->
	`codeC€ffNxN
(
rTu
, 
pcC€f
, 
compID
);

683 
	}
}

685 
Void
 
	gTEncE¡r›y
::
	$e°im©eBô
 (
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, c⁄° 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
 )

687 c⁄° 
UI¡
 
heightAtE¡r›yCodög
 = (
width
 !
height
) ? (height >> 1) : height;

689 
m_pcE¡r›yCodîIf
->
	`e°Bô
 ( 
pcE°BôsSbac
, 
width
, 
heightAtE¡r›yCodög
, 
chTy≥
, 
sˇnTy≥
 );

690 
	}
}

692 
I¡
 
	gTEncE¡r›y
::
	$cou¡N⁄ZîoC€ffs
–
TC€ff
* 
pcC€f
, 
UI¡
 
uiSize
 )

694 
I¡
 
cou¡
 = 0;

696  
I¡
 
i
 = 0; i < 
uiSize
; i++ )

698 
cou¡
 +
pcC€f
[
i
] != 0;

701  
cou¡
;

702 
	}
}

	@TLibEncoder/TEncEntropy.h

38 #i‚de‡
__TENCENTROPY__


39 
	#__TENCENTROPY__


	)

41 
	~"TLibComm⁄/TComSli˚.h
"

42 
	~"TLibComm⁄/TComD©aCU.h
"

43 
	~"TLibComm⁄/TComBôSåóm.h
"

44 
	~"TLibComm⁄/C⁄ãxtModñ.h
"

45 
	~"TLibComm⁄/TComPic.h
"

46 
	~"TLibComm⁄/TComTrQu™t.h
"

47 
	~"TLibComm⁄/TComSam∂eAd≠tiveOff£t.h
"

48 
	~"TLibComm⁄/TComChromaF‹m©.h
"

50 
˛ass
 
	gTEncSbac
;

51 
˛ass
 
	gTEncCavlc
;

52 
˛ass
 
	gSEI
;

59 ˛as†
	cTEncE¡r›yIf


61 
	mpublic
:

62 
vútuÆ
 
Void
 
ª£tE¡r›y
 (c⁄° 
TComSli˚
 *
pSli˚
) = 0;

63 
vútuÆ
 
Sli˚Ty≥
 
dëîmöeCabacInôIdx
 (c⁄° 
TComSli˚
 *
pSli˚
) = 0;

64 
vútuÆ
 
Void
 
£tBô°ªam
 ( 
TComBôIf
* 
p
 ) = 0;

65 
vútuÆ
 
Void
 
ª£tBôs
 () = 0;

66 
vútuÆ
 
UI¡
 
gëNumbîOfWrôãnBôs
() = 0;

68 
vútuÆ
 
Void
 
codeVPS
 ( c⁄° 
TComVPS
* 
pcVPS
 ) = 0;

69 
vútuÆ
 
Void
 
codeSPS
 ( c⁄° 
TComSPS
* 
pcSPS
 ) = 0;

70 
vútuÆ
 
Void
 
codePPS
 ( c⁄° 
TComPPS
* 
pcPPS
 ) = 0;

71 
vútuÆ
 
Void
 
codeSli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
 ) = 0;

73 
vútuÆ
 
Void
 
codeTûesWPPE¡ryPoöt
 ( 
TComSli˚
* 
pSli˚
 ) = 0;

74 
vútuÆ
 
Void
 
codeTîmö©ögBô
 ( 
UI¡
 
uûsLa°
 ) = 0;

75 
vútuÆ
 
Void
 
codeSli˚Föish
 () = 0;

76 
vútuÆ
 
Void
 
codeMVPIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 ) = 0;

78 
	mpublic
:

79 
vútuÆ
 
Void
 
codeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

80 
vútuÆ
 
Void
 
codeSkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

81 
vútuÆ
 
Void
 
codeMîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

82 
vútuÆ
 
Void
 
codeMîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

83 
vútuÆ
 
Void
 
codeS∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

85 
vútuÆ
 
Void
 
codeP¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 ) = 0;

86 
vútuÆ
 
Void
 
codePªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

88 
vútuÆ
 
Void
 
codeIPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

90 
vútuÆ
 
Void
 
codeTønsf‹mSubdivFœg
–
UI¡
 
uiSymbﬁ
, UI¡ 
uiCtx
 ) = 0;

91 
vútuÆ
 
Void
 
codeQtCbf
 ( 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 ) = 0;

92 
vútuÆ
 
Void
 
codeQtRoŸCbf
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

93 
vútuÆ
 
Void
 
codeQtCbfZîo
 ( 
TComTU
 &
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 ) = 0;

94 
vútuÆ
 
Void
 
codeQtRoŸCbfZîo
 ( ) = 0;

95 
vútuÆ
 
Void
 
codeI¡øDúLumaAng
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
isMu…ùÀPU
 ) = 0;

97 
vútuÆ
 
Void
 
codeI¡øDúChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

98 
vútuÆ
 
Void
 
codeI¡îDú
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

99 
vútuÆ
 
Void
 
codeRefFrmIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 ) = 0;

100 
vútuÆ
 
Void
 
codeMvd
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 ) = 0;

102 
vútuÆ
 
Void
 
codeCrossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 ) = 0;

104 
vútuÆ
 
Void
 
codeDñèQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

105 
vútuÆ
 
Void
 
codeChromaQpAdju°mít
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 ) = 0;

106 
vútuÆ
 
Void
 
codeC€ffNxN
 ( 
TComTU
 &
rTu
, 
TC€ff
* 
pcC€f
, c⁄° 
Comp⁄ítID
 
compID
 ) = 0;

107 
vútuÆ
 
Void
 
codeTønsf‹mSkùFœgs
 ( 
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
 ) = 0;

108 
vútuÆ
 
Void
 
codeSAOBlkP¨am
 (
SAOBlkP¨am
& 
ßoBlkP¨am
, c⁄° 
BôDïths
 &
bôDïths
, 
Boﬁ
* 
¶i˚E«bÀd
, Boﬁ 
À·MîgeAvaû
, Boﬁ 
aboveMîgeAvaû
, Boﬁ 
⁄lyE°MîgeInfo
 = 
Ál£
) =0;

109 
vútuÆ
 
Void
 
e°Bô
 (
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
) = 0;

110 
vútuÆ
 
Void
 
codeEx∂icôRdpcmMode
 ( 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
 ) = 0;

112 
	mvútuÆ
 ~
	$TEncE¡r›yIf
() {}

113 
	}
};

116 ˛as†
	cTEncE¡r›y


118 
	mpublic
:

119 
Void
 
£tE¡r›yCodî
 ( 
TEncE¡r›yIf
* 
e
 );

120 
Void
 
	$£tBô°ªam
 ( 
TComBôIf
* 
p
 ) { 
m_pcE¡r›yCodîIf
->
	`£tBô°ªam
(p); }

121 
Void
 
	$ª£tBôs
 (Ë{ 
m_pcE¡r›yCodîIf
->
	`ª£tBôs
(); 
	}
}

122 
UI¡
 
	$gëNumbîOfWrôãnBôs
 (Ë{  
m_pcE¡r›yCodîIf
->
	`gëNumbîOfWrôãnBôs
(); 
	}
}

123 
Void
 
	$ª£tE¡r›y
 (c⁄° 
TComSli˚
 *
pSli˚
Ë{ 
m_pcE¡r›yCodîIf
->
	`ª£tE¡r›y
’Sli˚); 
	}
}

124 
Sli˚Ty≥
 
	$dëîmöeCabacInôIdx
 (c⁄° 
TComSli˚
 *
pSli˚
Ë{  
m_pcE¡r›yCodîIf
->
	`dëîmöeCabacInôIdx
’Sli˚); 
	}
}

126 
Void
 
ícodeSli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
 );

127 
Void
 
ícodeTûesWPPE¡ryPoöt
–
TComSli˚
* 
pSli˚
 );

128 
Void
 
ícodeTîmö©ögBô
 ( 
UI¡
 
uiIsLa°
 );

129 
Void
 
ícodeSli˚Föish
 ();

130 
TEncE¡r›yIf
* 
	gm_pcE¡r›yCodîIf
;

132 
	gpublic
:

133 
Void
 
ícodeVPS
 ( c⁄° 
TComVPS
* 
pcVPS
);

135 
Void
 
ícodeSPS
 ( c⁄° 
TComSPS
* 
pcSPS
 );

136 
Void
 
ícodePPS
 ( c⁄° 
TComPPS
* 
pcPPS
 );

137 
Void
 
ícodeS∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
 
bRD
 = 
Ál£
 );

138 
Void
 
ícodeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 = 
Ál£
 );

139 
Void
 
ícodeSkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 = 
Ál£
 );

140 
Void
 
ícodePUWi£
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

141 
Void
 
ícodeI¡îDúPU
 ( 
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiAbsP¨tIdx
 );

142 
Void
 
ícodeRefFrmIdxPU
 ( 
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

143 
Void
 
ícodeMvdPU
 ( 
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

144 
Void
 
ícodeMVPIdxPU
 ( 
TComD©aCU
* 
pcSubCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

145 
Void
 
ícodeMîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

146 
Void
 
ícodeMîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 = 
Ál£
 );

147 
Void
 
ícodePªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 = 
Ál£
 );

148 
Void
 
ícodeP¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
 
bRD
 = 
Ál£
 );

149 
Void
 
ícodeIPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 = 
Ál£
 );

150 
Void
 
ícodePªdInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

151 
Void
 
ícodeI¡øDúModeLuma
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
absP¨tIdx
, 
Boﬁ
 
isMu…ùÀPU
 = 
Ál£
 );

153 
Void
 
ícodeI¡øDúModeChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

155 
Void
 
ícodeTønsf‹mSubdivFœg
–
UI¡
 
uiSymbﬁ
, UI¡ 
uiCtx
 );

156 
Void
 
ícodeQtCbf
 ( 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 );

158 
Void
 
ícodeQtCbfZîo
 ( 
TComTU
 &
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 );

159 
Void
 
ícodeQtRoŸCbfZîo
 ( );

160 
Void
 
ícodeQtRoŸCbf
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

161 
Void
 
ícodeQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 = 
Ál£
 );

162 
Void
 
ícodeChromaQpAdju°mít
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Boﬁ
 
bRD
 = 
Ál£
 );

164 
Void
 
ícodeCrossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

166 
	g¥iv©e
:

167 
Void
 
xEncodeTønsf‹m
 ( 
Boﬁ
& 
bCodeDQP
, Boﬁ& 
codeChromaQpAdj
, 
TComTU
 &
rTu
 );

169 
	gpublic
:

170 
Void
 
ícodeC€ff
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
, 
Boﬁ
& 
bCodeDQP
, Boﬁ& 
codeChromaQpAdj
 );

172 
Void
 
ícodeC€ffNxN
 ( 
TComTU
 &
rTu
, 
TC€ff
* 
pcC€f
, c⁄° 
Comp⁄ítID
 
compID
 );

174 
Void
 
e°im©eBô
 ( 
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
);

176 
Void
 
	$ícodeSAOBlkP¨am
(
SAOBlkP¨am
& 
ßoBlkP¨am
, c⁄° 
BôDïths
 &
bôDïths
, 
Boﬁ
* 
¶i˚E«bÀd
, Boﬁ 
À·MîgeAvaû
, Boﬁ 
aboveMîgeAvaû
){
m_pcE¡r›yCodîIf
->
	`codeSAOBlkP¨am
(ßoBlkP¨am, bôDïths, sli˚E«bÀd,Üe·MîgeAvaû,áboveMîgeAvaû, 
Ál£
);
	}
}

178 
I¡
 
cou¡N⁄ZîoC€ffs
–
TC€ff
* 
pcC€f
, 
UI¡
 
uiSize
 );

	@TLibEncoder/TEncGOP.cpp

38 
	~<li°
>

39 
	~<Æg‹ôhm
>

40 
	~<fun˘i⁄Æ
>

41 
	~<cöây≥s
>

43 
	~"TEncT›.h
"

44 
	~"TEncGOP.h
"

45 
	~"TEncA«lyze.h
"

46 
	~"libmd5/MD5.h
"

47 
	~"TLibComm⁄/SEI.h
"

48 
	~"TLibComm⁄/NAL.h
"

49 
	~"NALwrôe.h
"

50 
	~<time.h
>

51 
	~<m©h.h
>

53 
	~<deque
>

54 
usög
 
«me•a˚
 
	g°d
;

62 
I¡
 
	$gëLSB
(
I¡
 
poc
, I¡ 
maxLSB
)

64 i‡(
poc
 >= 0)

66  
poc
 % 
maxLSB
;

70  (
maxLSB
 - ((-
poc
) % maxLSB)) % maxLSB;

72 
	}
}

74 
	gTEncGOP
::
	$TEncGOP
()

76 
m_iLa°IDR
 = 0;

77 
m_RASPOCf‹Re£tEncodî
 = 
MAX_INT
;

79 
m_iG›Size
 = 0;

80 
m_iNumPicCoded
 = 0;

81 
m_bFú°
 = 
åue
;

82 
m_iLa°RecovîyPicPOC
 = 0;

84 
m_pcCfg
 = 
NULL
;

85 
m_pcSli˚Encodî
 = 
NULL
;

86 
m_pcLi°Pic
 = 
NULL
;

88 
m_pcE¡r›yCodî
 = 
NULL
;

89 
m_pcCavlcCodî
 = 
NULL
;

90 
m_pcSbacCodî
 = 
NULL
;

91 
m_pcBöCABAC
 = 
NULL
;

93 
m_bSeqFú°
 = 
åue
;

95 
m_bRe‰eshPídög
 = 0;

96 
m_pocCRA
 = 0;

97 
m_numL⁄gTîmRefPicSPS
 = 0;

98 ::
	`mem£t
(
m_…RefPicPocLsbSps
, 0, (m_ltRefPicPocLsbSps));

99 ::
	`mem£t
(
m_…RefPicU£dByCuºPicFœg
, 0, (m_ltRefPicUsedByCurrPicFlag));

100 
m_œ°BPSEI
 = 0;

101 
m_buf„rögPîiodSEIPª£¡InAU
 = 
Ál£
;

102 
m_assocüãdIRAPTy≥
 = 
NAL_UNIT_CODED_SLICE_IDR_N_LP
;

103 
m_assocüãdIRAPPOC
 = 0;

104 
m_pcDeblockögTempPicYuv
 = 
NULL
;

105 
	}
}

107 
	gTEncGOP
::~
	$TEncGOP
()

109 
	}
}

113 
Void
 
TEncGOP
::
	$¸óã
()

115 
m_bL⁄gãrmTe°Pi˘uªHasBìnCoded
 = 0;

116 
m_bL⁄gãrmTe°Pi˘uªHasBìnCoded2
 = 0;

117 
	}
}

119 
Void
 
	gTEncGOP
::
	$de°roy
()

121 i‡(
m_pcDeblockögTempPicYuv
)

123 
m_pcDeblockögTempPicYuv
->
	`de°roy
();

124 
dñëe
 
m_pcDeblockögTempPicYuv
;

125 
m_pcDeblockögTempPicYuv
 = 
NULL
;

127 
	}
}

129 
Void
 
	gTEncGOP
::
	$öô
 ( 
TEncT›
* 
pcTEncT›
 )

131 
m_pcEncT›
 = 
pcTEncT›
;

132 
m_pcCfg
 = 
pcTEncT›
;

133 
m_£iEncodî
.
	`öô
(
m_pcCfg
, 
pcTEncT›
, 
this
);

134 
m_pcSli˚Encodî
 = 
pcTEncT›
->
	`gëSli˚Encodî
();

135 
m_pcLi°Pic
 = 
pcTEncT›
->
	`gëLi°Pic
();

137 
m_pcE¡r›yCodî
 = 
pcTEncT›
->
	`gëE¡r›yCodî
();

138 
m_pcCavlcCodî
 = 
pcTEncT›
->
	`gëCavlcCodî
();

139 
m_pcSbacCodî
 = 
pcTEncT›
->
	`gëSbacCodî
();

140 
m_pcBöCABAC
 = 
pcTEncT›
->
	`gëBöCABAC
();

141 
m_pcLo›Fûãr
 = 
pcTEncT›
->
	`gëLo›Fûãr
();

143 
m_pcSAO
 = 
pcTEncT›
->
	`gëSAO
();

144 
m_pcR©eCål
 = 
pcTEncT›
->
	`gëR©eCål
();

145 
m_œ°BPSEI
 = 0;

146 
m_tŸÆCoded
 = 0;

148 
	}
}

150 #i‡
MCTS_EXTRACTION


151 
Void
 
	gTEncGOP
::
	$gíî©eVPS_RBSP
(
TComBôIf
* 
rb•
, c⁄° 
TComVPS
 *
vps
)

153 
m_pcE¡r›yCodî
->
	`£tBô°ªam
(
rb•
);

154 
m_pcE¡r›yCodî
->
	`ícodeVPS
(
vps
);

155 
	}
}

157 
Void
 
	gTEncGOP
::
	$gíî©eSPS_RBSP
(
TComBôIf
* 
rb•
, c⁄° 
TComSPS
 *
•s
)

159 
m_pcE¡r›yCodî
->
	`£tBô°ªam
(
rb•
);

160 
m_pcE¡r›yCodî
->
	`ícodeSPS
(
•s
);

161 
	}
}

163 
Void
 
	gTEncGOP
::
	$gíî©ePPS_RBSP
(
TComBôIf
* 
rb•
, c⁄° 
TComPPS
 *
µs
)

165 
m_pcE¡r›yCodî
->
	`£tBô°ªam
(
rb•
);

166 
m_pcE¡r›yCodî
->
	`ícodePPS
(
µs
);

167 
	}
}

170 
I¡
 
	gTEncGOP
::
	$xWrôeVPS
 (
Ac˚ssUnô
 &
ac˚ssUnô
, c⁄° 
TComVPS
 *
vps
)

172 
OuçutNALUnô
 
	`«lu
(
NAL_UNIT_VPS
);

173 
m_pcE¡r›yCodî
->
	`£tBô°ªam
(&
«lu
.
m_Bô°ªam
);

174 
m_pcE¡r›yCodî
->
	`ícodeVPS
(
vps
);

175 
ac˚ssUnô
.
	`push_back
(
√w
 
	`NALUnôEBSP
(
«lu
));

176  (
I¡
)(
ac˚ssUnô
.
	`back
()->
m_«lUnôD©a
.
	`°r
().
	`size
()) * 8;

177 
	}
}

179 
I¡
 
	gTEncGOP
::
	$xWrôeSPS
 (
Ac˚ssUnô
 &
ac˚ssUnô
, c⁄° 
TComSPS
 *
•s
)

181 
OuçutNALUnô
 
	`«lu
(
NAL_UNIT_SPS
);

182 
m_pcE¡r›yCodî
->
	`£tBô°ªam
(&
«lu
.
m_Bô°ªam
);

183 
m_pcE¡r›yCodî
->
	`ícodeSPS
(
•s
);

184 
ac˚ssUnô
.
	`push_back
(
√w
 
	`NALUnôEBSP
(
«lu
));

185  (
I¡
)(
ac˚ssUnô
.
	`back
()->
m_«lUnôD©a
.
	`°r
().
	`size
()) * 8;

187 
	}
}

189 
I¡
 
	gTEncGOP
::
	$xWrôePPS
 (
Ac˚ssUnô
 &
ac˚ssUnô
, c⁄° 
TComPPS
 *
µs
)

191 
OuçutNALUnô
 
	`«lu
(
NAL_UNIT_PPS
);

192 
m_pcE¡r›yCodî
->
	`£tBô°ªam
(&
«lu
.
m_Bô°ªam
);

193 
m_pcE¡r›yCodî
->
	`ícodePPS
(
µs
);

194 
ac˚ssUnô
.
	`push_back
(
√w
 
	`NALUnôEBSP
(
«lu
));

195  (
I¡
)(
ac˚ssUnô
.
	`back
()->
m_«lUnôD©a
.
	`°r
().
	`size
()) * 8;

196 
	}
}

199 
I¡
 
	gTEncGOP
::
	$xWrôeP¨amëîSës
 (
Ac˚ssUnô
 &
ac˚ssUnô
, 
TComSli˚
 *
¶i˚
, c⁄° 
Boﬁ
 
bSeqFú°
)

201 
I¡
 
a˘uÆTŸÆBôs
 = 0;

203 i‡(
bSeqFú°
)

205 
a˘uÆTŸÆBôs
 +
	`xWrôeVPS
(
ac˚ssUnô
, 
m_pcEncT›
->
	`gëVPS
());

207 i‡(
m_pcEncT›
->
	`SPSNìdsWrôög
(
¶i˚
->
	`gëSPS
()->
	`gëSPSId
()))

209 
	`as£π
(
bSeqFú°
);

210 
a˘uÆTŸÆBôs
 +
	`xWrôeSPS
(
ac˚ssUnô
, 
¶i˚
->
	`gëSPS
());

212 i‡(
m_pcEncT›
->
	`PPSNìdsWrôög
(
¶i˚
->
	`gëPPS
()->
	`gëPPSId
()))

214 
a˘uÆTŸÆBôs
 +
	`xWrôePPS
(
ac˚ssUnô
, 
¶i˚
->
	`gëPPS
());

217  
a˘uÆTŸÆBôs
;

218 
	}
}

220 
Void
 
	gTEncGOP
::
	$xWrôeAc˚ssUnôDñimôî
 (
Ac˚ssUnô
 &
ac˚ssUnô
, 
TComSli˚
 *
¶i˚
)

222 
AUDWrôî
 
audWrôî
;

223 
OuçutNALUnô
 
	`«lu
(
NAL_UNIT_ACCESS_UNIT_DELIMITER
);

225 
I¡
 
picTy≥
 = 
¶i˚
->
	`isI¡ø
(Ë? 0 : (¶i˚->
	`isI¡îP
() ? 1 : 2);

227 
audWrôî
.
	`codeAUD
(
«lu
.
m_Bô°ªam
, 
picTy≥
);

228 
ac˚ssUnô
.
	`push_‰⁄t
(
√w
 
	`NALUnôEBSP
(
«lu
));

229 
	}
}

232 
Void
 
	gTEncGOP
::
	$xWrôeSEI
 (
NÆUnôTy≥
 
«luTy≥
, 
SEIMesßges
& 
£iMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, Ac˚ssUnô::
ôî©‹
 &
auPos
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
)

235 i‡(
£iMesßges
.
	`em±y
())

239 
OuçutNALUnô
 
	`«lu
(
«luTy≥
, 
ãmp‹ÆId
);

240 
m_£iWrôî
.
	`wrôeSEImesßges
(
«lu
.
m_Bô°ªam
, 
£iMesßges
, 
•s
, 
Ál£
);

241 
auPos
 = 
ac˚ssUnô
.
	`ö£π
◊uPos, 
√w
 
	`NALUnôEBSP
(
«lu
));

242 
auPos
++;

243 
	}
}

245 
Void
 
	gTEncGOP
::
	$xWrôeSEISï¨©ñy
 (
NÆUnôTy≥
 
«luTy≥
, 
SEIMesßges
& 
£iMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, Ac˚ssUnô::
ôî©‹
 &
auPos
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
)

248 i‡(
£iMesßges
.
	`em±y
())

252 
SEIMesßges
::
c⁄°_ôî©‹
 
£i
 = 
£iMesßges
.
	`begö
(); sei!=£iMesßges.
	`íd
(); sei++ )

254 
SEIMesßges
 
tmpMesßges
;

255 
tmpMesßges
.
	`push_back
(*
£i
);

256 
OuçutNALUnô
 
	`«lu
(
«luTy≥
, 
ãmp‹ÆId
);

257 
m_£iWrôî
.
	`wrôeSEImesßges
(
«lu
.
m_Bô°ªam
, 
tmpMesßges
, 
•s
, 
Ál£
);

258 
auPos
 = 
ac˚ssUnô
.
	`ö£π
◊uPos, 
√w
 
	`NALUnôEBSP
(
«lu
));

259 
auPos
++;

261 
	}
}

263 
Void
 
	gTEncGOP
::
	$xCÀ¨SEIs
(
SEIMesßges
& 
£iMesßges
, 
Boﬁ
 
dñëeMesßges
)

265 i‡(
dñëeMesßges
)

267 
	`dñëeSEIs
(
£iMesßges
);

271 
£iMesßges
.
	`˛ór
();

273 
	}
}

276 
Void
 
	gTEncGOP
::
	$xWrôeLódögSEIOrdîed
 (
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
duInfoSeiMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
, 
Boﬁ
 
ã°Wrôe
)

278 
Ac˚ssUnô
::
ôî©‹
 
ôNÆu
 = 
ac˚ssUnô
.
	`begö
();

280  (
ôNÆu
!=
ac˚ssUnô
.
	`íd
())&&

281 –(*
ôNÆu
)->
m_«lUnôTy≥
==
NAL_UNIT_ACCESS_UNIT_DELIMITER


282 || (*
ôNÆu
)->
m_«lUnôTy≥
==
NAL_UNIT_VPS


283 || (*
ôNÆu
)->
m_«lUnôTy≥
==
NAL_UNIT_SPS


284 || (*
ôNÆu
)->
m_«lUnôTy≥
==
NAL_UNIT_PPS


287 
ôNÆu
++;

290 
SEIMesßges
 
loˇlMesßges
 = 
£iMesßges
;

291 
SEIMesßges
 
cuºítMesßges
;

293 #i‡
ENC_DEC_TRACE


294 
g_HLSTø˚E«bÀ
 = !
ã°Wrôe
;

299 
cuºítMesßges
 = 
	`exåa˘SeisByTy≥
(
loˇlMesßges
, 
SEI
::
ACTIVE_PARAMETER_SETS
);

300 
	`as£π
 (
cuºítMesßges
.
	`size
() <= 1);

301 
	`xWrôeSEI
(
NAL_UNIT_PREFIX_SEI
, 
cuºítMesßges
, 
ac˚ssUnô
, 
ôNÆu
, 
ãmp‹ÆId
, 
•s
);

302 
	`xCÀ¨SEIs
(
cuºítMesßges
, !
ã°Wrôe
);

305 
cuºítMesßges
 = 
	`exåa˘SeisByTy≥
(
loˇlMesßges
, 
SEI
::
BUFFERING_PERIOD
);

306 
	`as£π
 (
cuºítMesßges
.
	`size
() <= 1);

307 
	`xWrôeSEI
(
NAL_UNIT_PREFIX_SEI
, 
cuºítMesßges
, 
ac˚ssUnô
, 
ôNÆu
, 
ãmp‹ÆId
, 
•s
);

308 
	`xCÀ¨SEIs
(
cuºítMesßges
, !
ã°Wrôe
);

311 
cuºítMesßges
 = 
	`exåa˘SeisByTy≥
(
loˇlMesßges
, 
SEI
::
PICTURE_TIMING
);

312 
	`as£π
 (
cuºítMesßges
.
	`size
() <= 1);

313 
	`xWrôeSEI
(
NAL_UNIT_PREFIX_SEI
, 
cuºítMesßges
, 
ac˚ssUnô
, 
ôNÆu
, 
ãmp‹ÆId
, 
•s
);

314 
	`xCÀ¨SEIs
(
cuºítMesßges
, !
ã°Wrôe
);

317 i‡(!
duInfoSeiMesßges
.
	`em±y
())

319 
cuºítMesßges
.
	`push_back
(
duInfoSeiMesßges
.
	`‰⁄t
());

320 i‡(!
ã°Wrôe
)

322 
duInfoSeiMesßges
.
	`p›_‰⁄t
();

324 
	`xWrôeSEI
(
NAL_UNIT_PREFIX_SEI
, 
cuºítMesßges
, 
ac˚ssUnô
, 
ôNÆu
, 
ãmp‹ÆId
, 
•s
);

325 
	`xCÀ¨SEIs
(
cuºítMesßges
, !
ã°Wrôe
);

329 
cuºítMesßges
 = 
	`exåa˘SeisByTy≥
(
loˇlMesßges
, 
SEI
::
SCALABLE_NESTING
);

330 
	`xWrôeSEISï¨©ñy
(
NAL_UNIT_PREFIX_SEI
, 
cuºítMesßges
, 
ac˚ssUnô
, 
ôNÆu
, 
ãmp‹ÆId
, 
•s
);

331 
	`xCÀ¨SEIs
(
cuºítMesßges
, !
ã°Wrôe
);

334 
	`xWrôeSEISï¨©ñy
(
NAL_UNIT_PREFIX_SEI
, 
loˇlMesßges
, 
ac˚ssUnô
, 
ôNÆu
, 
ãmp‹ÆId
, 
•s
);

335 
	`xCÀ¨SEIs
(
loˇlMesßges
, !
ã°Wrôe
);

337 i‡(!
ã°Wrôe
)

339 
£iMesßges
.
	`˛ór
();

341 
	}
}

344 
Void
 
	gTEncGOP
::
xWrôeLódögSEIMesßges
 (
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
duInfoSeiMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
, 
°d
::
deque
<
DUD©a
> &
duD©a
)

346 
Ac˚ssUnô
 
ã°AU
;

347 
SEIMesßges
 
	gpicTimögSEIs
 = 
gëSeisByTy≥
(
£iMesßges
, 
SEI
::
PICTURE_TIMING
);

348 
as£π
 (
picTimögSEIs
.
size
() < 2);

349 
SEIPi˘uªTimög
 * 
	gpicTimög
 = 
picTimögSEIs
.
em±y
(Ë? 
NULL
 : (SEIPi˘uªTimög*ËpicTimögSEIs.
‰⁄t
();

352 
xWrôeLódögSEIOrdîed
(
£iMesßges
, 
duInfoSeiMesßges
, 
ã°AU
, 
ãmp‹ÆId
, 
•s
, 
åue
);

354 
xUpd©eDuD©a
(
ã°AU
, 
duD©a
);

355 
xUpd©eTimögSEI
(
picTimög
, 
duD©a
, 
•s
);

356 
xUpd©eDuInfoSEI
(
duInfoSeiMesßges
, 
picTimög
);

358 
xWrôeLódögSEIOrdîed
(
£iMesßges
, 
duInfoSeiMesßges
, 
ac˚ssUnô
, 
ãmp‹ÆId
, 
•s
, 
Ál£
);

363 
Void
 
	gTEncGOP
::
	$xWrôeTøûögSEIMesßges
 (
SEIMesßges
& 
£iMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
)

366 
Ac˚ssUnô
::
ôî©‹
 
pos
 = 
ac˚ssUnô
.
	`íd
();

367 
	`xWrôeSEISï¨©ñy
(
NAL_UNIT_SUFFIX_SEI
, 
£iMesßges
, 
ac˚ssUnô
, 
pos
, 
ãmp‹ÆId
, 
•s
);

368 
	`dñëeSEIs
(
£iMesßges
);

369 
	}
}

371 
Void
 
	gTEncGOP
::
xWrôeDuSEIMesßges
 (
SEIMesßges
& 
duInfoSeiMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
, 
°d
::
deque
<
DUD©a
> &
duD©a
)

373 c⁄° 
TComHRD
 *
hrd
 = 
•s
->
gëVuiP¨amëîs
()->
gëHrdP¨amëîs
();

375 if–
	gm_pcCfg
->
gëDecodögUnôInfoSEIE«bÀd
(Ë&& 
	ghrd
->
gëSubPicCpbP¨amsPª£¡Fœg
() )

377 
I¡
 
	g«luIdx
 = 0;

378 
	gAc˚ssUnô
::
ôî©‹
 
«lu
 = 
ac˚ssUnô
.
begö
();

381 
	g«luIdx
 < 
	gduD©a
[0].
	gaccumNÆsDU
 && 
	g«lu
!=
ac˚ssUnô
.
íd
())

383 
«luIdx
++;

384 
	g«lu
++;

387 
	gSEIMesßges
::
ôî©‹
 
duSEI
 = 
duInfoSeiMesßges
.
begö
();

389 
I¡
 
	gduIdx
 = 1; duIdx < 
	gduD©a
.
size
(); duIdx++)

391 i‡(
	gduSEI
 =
duInfoSeiMesßges
.
íd
())

394 
as£π
 (
Ál£
);

398 
SEIMesßges
 
	gtmpSEI
;

399 
	gtmpSEI
.
push_back
(*
duSEI
);

400 
xWrôeSEI
(
NAL_UNIT_PREFIX_SEI
, 
tmpSEI
, 
ac˚ssUnô
, 
«lu
, 
ãmp‹ÆId
, 
•s
);

402 
	g«luIdx
++;

403 (
	g«luIdx
 < 
	gduD©a
[
duIdx
].
	gaccumNÆsDU
Ë&& 
	g«lu
!=
ac˚ssUnô
.
íd
())

405 
«luIdx
++;

406 
	g«lu
++;

408 
	gduSEI
++;

411 
dñëeSEIs
(
duInfoSeiMesßges
);

414 #i‡
MCTS_EXTRACTION


415 
Void
 
	gTEncGOP
::
	$xCª©eIRAPLódögSEIMesßges
(
SEIMesßges
& 
£iMesßges
, c⁄° 
TComVPS
 *
vps
, c⁄° 
TComSPS
 *
•s
, c⁄° 
TComPPS
 *
µs
)

417 
Void
 
TEncGOP
::
	$xCª©eIRAPLódögSEIMesßges
 (
SEIMesßges
& 
£iMesßges
, c⁄° 
TComSPS
 *
•s
, c⁄° 
TComPPS
 *
µs
)

420 
OuçutNALUnô
 
	`«lu
(
NAL_UNIT_PREFIX_SEI
);

422 if(
m_pcCfg
->
	`gëA˘iveP¨amëîSësSEIE«bÀd
())

424 
SEIA˘iveP¨amëîSës
 *
£i
 = 
√w
 SEIActiveParameterSets;

425 
m_£iEncodî
.
	`öôSEIA˘iveP¨amëîSës
 (
£i
, 
m_pcCfg
->
	`gëVPS
(), 
•s
);

426 
£iMesßges
.
	`push_back
(
£i
);

429 if(
m_pcCfg
->
	`gëFømePackögAº™gemítSEIE«bÀd
())

431 
SEIFømePackög
 *
£i
 = 
√w
 SEIFramePacking;

432 
m_£iEncodî
.
	`öôSEIFømePackög
 (
£i
, 
m_iNumPicCoded
);

433 
£iMesßges
.
	`push_back
(
£i
);

436 if(
m_pcCfg
->
	`gëSegmíãdRe˘FømePackögAº™gemítSEIE«bÀd
())

438 
SEISegmíãdRe˘FømePackög
 *
£i
 = 
√w
 SEISegmentedRectFramePacking;

439 
m_£iEncodî
.
	`öôSEISegmíãdRe˘FømePackög
(
£i
);

440 
£iMesßges
.
	`push_back
(
£i
);

443 i‡(
m_pcCfg
->
	`gëDi•œyOrõ¡©i⁄SEIAngÀ
())

445 
SEIDi•œyOrõ¡©i⁄
 *
£i
 = 
√w
 SEIDisplayOrientation;

446 
m_£iEncodî
.
	`öôSEIDi•œyOrõ¡©i⁄
(
£i
);

447 
£iMesßges
.
	`push_back
(
£i
);

450 if(
m_pcCfg
->
	`gëT⁄eM≠pögInfoSEIE«bÀd
())

452 
SEIT⁄eM≠pögInfo
 *
£i
 = 
√w
 SEIToneMappingInfo;

453 
m_£iEncodî
.
	`öôSEIT⁄eM≠pögInfo
 (
£i
);

454 
£iMesßges
.
	`push_back
(
£i
);

457 if(
m_pcCfg
->
	`gëTMCTSSEIE«bÀd
())

459 
SEITempMŸi⁄C⁄°øöedTûeSës
 *
£i
 = 
√w
 SEITempMotionConstrainedTileSets;

460 
m_£iEncodî
.
	`öôSEITempMŸi⁄C⁄°øöedTûeSës
(
£i
, 
µs
);

461 
£iMesßges
.
	`push_back
(
£i
);

463 #i‡
MCTS_EXTRACTION


464 i‡(
m_pcCfg
->
	`gëTMCTSExåa˘i⁄SEIE«bÀd
())

466 
SEIMCTSExåa˘i⁄InfoSë
 *
£i
 = 
√w
 SEIMCTSExtractionInfoSet;

467 
m_£iEncodî
.
	`öôSEIMCTSExåa˘i⁄Info
(
£i
, 
vps
, 
•s
, 
µs
);

468 
£iMesßges
.
	`push_back
(
£i
);

471 if(
m_pcCfg
->
	`gëTimeCodeSEIE«bÀd
())

473 
SEITimeCode
 *
£iTimeCode
 = 
√w
 SEITimeCode;

474 
m_£iEncodî
.
	`öôSEITimeCode
(
£iTimeCode
);

475 
£iMesßges
.
	`push_back
(
£iTimeCode
);

478 if(
m_pcCfg
->
	`gëK√eSEIE«bÀd
())

480 
SEIK√eFun˘i⁄Info
 *
£i
 = 
√w
 SEIKneeFunctionInfo;

481 
m_£iEncodî
.
	`öôSEIK√eFun˘i⁄Info
(
£i
);

482 
£iMesßges
.
	`push_back
(
£i
);

485 i‡(
m_pcCfg
->
	`gëCcvSEIE«bÀd
())

487 
SEIC⁄ã¡CﬁourVﬁume
 *
£iC⁄ã¡CﬁourVﬁume
 = 
√w
 SEIContentColourVolume;

488 
m_£iEncodî
.
	`öôSEIC⁄ã¡CﬁourVﬁume
(
£iC⁄ã¡CﬁourVﬁume
);

489 
£iMesßges
.
	`push_back
(
£iC⁄ã¡CﬁourVﬁume
);

492 #i‡
SHUTTER_INTERVAL_SEI_MESSAGE


493 i‡(
m_pcCfg
->
	`gëSiiSEIE«bÀd
())

495 
SEIShuâîI¡îvÆInfo
 *
£iShuâîI¡îvÆ
 = 
√w
 SEIShutterIntervalInfo;

496 
m_£iEncodî
.
	`öôSEIShuâîI¡îvÆInfo
(
£iShuâîI¡îvÆ
);

497 
£iMesßges
.
	`push_back
(
£iShuâîI¡îvÆ
);

501 #i‡
SEI_ENCODER_CONTROL


502 #i‡!
FGS_RDD5_ENABLE


504 i‡(
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEIE«bÀd
())

506 
SEIFûmGøöCh¨a˘îi°ics
 *
£iFGC
 = 
√w
 SEIFilmGrainCharacteristics;

507 
m_£iEncodî
.
	`öôSEIFûmGøöCh¨a˘îi°ics
(
£iFGC
);

508 
£iMesßges
.
	`push_back
(
£iFGC
);

512 i‡(
m_pcCfg
->
	`gëCLLSEIE«bÀd
())

514 
SEIC⁄ã¡LightLevñInfo
 *
£iCLL
 = 
√w
 SEIContentLightLevelInfo;

515 
m_£iEncodî
.
	`öôSEIC⁄ã¡LightLevñ
(
£iCLL
);

516 
£iMesßges
.
	`push_back
(
£iCLL
);

519 i‡(
m_pcCfg
->
	`gëAmbõ¡VõwögEnvú⁄mítSEIE«bÀd
())

521 
SEIAmbõ¡VõwögEnvú⁄mít
 *
£iAVE
 = 
√w
 SEIAmbientViewingEnvironment;

522 
m_£iEncodî
.
	`öôSEIAmbõ¡VõwögEnvú⁄mít
(
£iAVE
);

523 
£iMesßges
.
	`push_back
(
£iAVE
);

526 i‡(
m_pcCfg
->
	`gëEΩSEIE«bÀd
())

528 
SEIEquúe˘™guœrProje˘i⁄
 *
£i
 = 
√w
 SEIEquirectangularProjection;

529 
m_£iEncodî
.
	`öôSEIEΩ
(
£i
);

530 
£iMesßges
.
	`push_back
(
£i
);

533 i‡(
m_pcCfg
->
	`gëSphîeRŸ©i⁄SEIE«bÀd
())

535 
SEISphîeRŸ©i⁄
 *
£i
 = 
√w
 SEISphereRotation;

536 
m_£iEncodî
.
	`öôSEISphîeRŸ©i⁄
(
£i
);

537 
£iMesßges
.
	`push_back
(
£i
);

540 i‡(
m_pcCfg
->
	`gëOmniVõwp‹tSEIE«bÀd
())

542 
SEIOmniVõwp‹t
 *
£i
 = 
√w
 SEIOmniViewport;

543 
m_£iEncodî
.
	`öôSEIOmniVõwp‹t
(
£i
);

544 
£iMesßges
.
	`push_back
(
£i
);

546 i‡(
m_pcCfg
->
	`gëCmpSEIE«bÀd
())

548 
SEICubem≠Proje˘i⁄
 *
£iCubem≠Proje˘i⁄
 = 
√w
 SEICubemapProjection;

549 
m_£iEncodî
.
	`öôSEICubem≠Proje˘i⁄
(
£iCubem≠Proje˘i⁄
);

550 
£iMesßges
.
	`push_back
(
£iCubem≠Proje˘i⁄
);

552 i‡(
m_pcCfg
->
	`gëRwpSEIE«bÀd
())

554 
SEIRegi⁄Wi£Packög
 *
£iRegi⁄Wi£Packög
 = 
√w
 SEIRegionWisePacking;

555 
m_£iEncodî
.
	`öôSEIRegi⁄Wi£Packög
(
£iRegi⁄Wi£Packög
);

556 
£iMesßges
.
	`push_back
(
£iRegi⁄Wi£Packög
);

558 i‡(
m_pcCfg
->
	`gëFviSEIE«bÀd
())

560 
SEIFisheyeVideoInfo
 *
£i
 = 
√w
 SEIFisheyeVideoInfo;

561 
m_£iEncodî
.
	`öôSEIFisheyeVideoInfo
(
£i
);

562 
£iMesßges
.
	`push_back
(
£i
);

565 if(
m_pcCfg
->
	`gëMa°îögDi•œySEI
().
cﬁourVﬁumeSEIE«bÀd
)

567 c⁄° 
TComSEIMa°îögDi•œy
 &
£iCfg
=
m_pcCfg
->
	`gëMa°îögDi•œySEI
();

568 
SEIMa°îögDi•œyCﬁourVﬁume
 *
£i
 = 
√w
 SEIMasteringDisplayColourVolume;

569 
£i
->
vÆues
 = 
£iCfg
;

570 
£iMesßges
.
	`push_back
(
£i
);

572 if(
m_pcCfg
->
	`gëChromaReßm∂ögFûãrHötE«bÀd
())

574 
SEIChromaReßm∂ögFûãrHöt
 *
£iChromaReßm∂ögFûãrHöt
 = 
√w
 SEIChromaResamplingFilterHint;

575 
m_£iEncodî
.
	`öôSEIChromaReßm∂ögFûãrHöt
(
£iChromaReßm∂ögFûãrHöt
, 
m_pcCfg
->
	`gëChromaReßm∂ögH‹FûãrIdc
(), m_pcCfg->
	`gëChromaReßm∂ögVîFûãrIdc
());

576 
£iMesßges
.
	`push_back
(
£iChromaReßm∂ögFûãrHöt
);

578 if(
m_pcCfg
->
	`gëSEIA…î«tiveTøns„rCh¨a˘îi°icsSEIE«bÀ
())

580 
SEIA…î«tiveTøns„rCh¨a˘îi°ics
 *
£iA…î«tiveTøns„rCh¨a˘îi°ics
 = 
√w
 SEIAlternativeTransferCharacteristics;

581 
m_£iEncodî
.
	`öôSEIA…î«tiveTøns„rCh¨a˘îi°ics
(
£iA…î«tiveTøns„rCh¨a˘îi°ics
);

582 
£iMesßges
.
	`push_back
(
£iA…î«tiveTøns„rCh¨a˘îi°ics
);

584 
	}
}

586 
Void
 
	gTEncGOP
::
	$xCª©ePîPi˘uªSEIMesßges
 (
I¡
 
picInGOP
, 
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
√°edSeiMesßges
, 
TComSli˚
 *
¶i˚
)

588 if––
m_pcCfg
->
	`gëBuf„rögPîiodSEIE«bÀd
(ËË&& ( 
¶i˚
->
	`gëSli˚Ty≥
(Ë=
I_SLICE
 ) &&

589 –
¶i˚
->
	`gëSPS
()->
	`gëVuiP¨amëîsPª£¡Fœg
() ) &&

590 ––
¶i˚
->
	`gëSPS
()->
	`gëVuiP¨amëîs
()->
	`gëHrdP¨amëîs
()->
	`gëNÆHrdP¨amëîsPª£¡Fœg
() )

591 || ( 
¶i˚
->
	`gëSPS
()->
	`gëVuiP¨amëîs
()->
	`gëHrdP¨amëîs
()->
	`gëV˛HrdP¨amëîsPª£¡Fœg
() ) ) )

593 
SEIBuf„rögPîiod
 *
buf„rögPîiodSEI
 = 
√w
 
	`SEIBuf„rögPîiod
();

594 
m_£iEncodî
.
	`öôSEIBuf„rögPîiod
(
buf„rögPîiodSEI
, 
¶i˚
);

595 
£iMesßges
.
	`push_back
(
buf„rögPîiodSEI
);

596 
m_buf„rögPîiodSEIPª£¡InAU
 = 
åue
;

598 i‡(
m_pcCfg
->
	`gëSˇœbÀNe°ögSEIE«bÀd
())

600 
SEIBuf„rögPîiod
 *
buf„rögPîiodSEIc›y
 = 
√w
 
	`SEIBuf„rögPîiod
();

601 
buf„rögPîiodSEI
->
	`c›yTo
(*
buf„rögPîiodSEIc›y
);

602 
√°edSeiMesßges
.
	`push_back
(
buf„rögPîiodSEIc›y
);

606 i‡(
picInGOP
 ==0 && 
m_pcCfg
->
	`gëSOPDes¸ùti⁄SEIE«bÀd
() )

608 
SEISOPDes¸ùti⁄
* 
s›Des¸ùti⁄SEI
 = 
√w
 
	`SEISOPDes¸ùti⁄
();

609 
m_£iEncodî
.
	`öôSEISOPDes¸ùti⁄
(
s›Des¸ùti⁄SEI
, 
¶i˚
, 
picInGOP
, 
m_iLa°IDR
, 
m_iG›Size
);

610 
£iMesßges
.
	`push_back
(
s›Des¸ùti⁄SEI
);

613 if––
m_pcEncT›
->
	`gëRecovîyPoötSEIE«bÀd
(ËË&& ( 
¶i˚
->
	`gëSli˚Ty≥
(Ë=
I_SLICE
 ) )

615 if–
m_pcEncT›
->
	`gëGøduÆDecodögRe‰eshInfoE«bÀd
(Ë&& !
¶i˚
->
	`gëR≠PicFœg
() )

618 
SEIRegi⁄Re‰eshInfo
 *
gøduÆDecodögRe‰eshInfoSEI
 = 
√w
 
	`SEIRegi⁄Re‰eshInfo
();

619 
gøduÆDecodögRe‰eshInfoSEI
->
m_gdrF‹egroundFœg
 = 
åue
;

620 
£iMesßges
.
	`push_back
(
gøduÆDecodögRe‰eshInfoSEI
);

623 
SEIRecovîyPoöt
 *
ªcovîyPoötSEI
 = 
√w
 
	`SEIRecovîyPoöt
();

624 
m_£iEncodî
.
	`öôSEIRecovîyPoöt
(
ªcovîyPoötSEI
, 
¶i˚
);

625 
£iMesßges
.
	`push_back
(
ªcovîyPoötSEI
);

627 i‡(
m_pcCfg
->
	`gëTemp‹ÆLevñ0IndexSEIE«bÀd
())

629 
SEITemp‹ÆLevñ0Index
 *
ãmp‹ÆLevñ0IndexSEI
 = 
√w
 
	`SEITemp‹ÆLevñ0Index
();

630 
m_£iEncodî
.
	`öôTemp‹ÆLevñ0IndexSEI
(
ãmp‹ÆLevñ0IndexSEI
, 
¶i˚
);

631 
£iMesßges
.
	`push_back
(
ãmp‹ÆLevñ0IndexSEI
);

634 if–
m_pcEncT›
->
	`gëNoDi•œySEITLayî
(Ë&& ( 
¶i˚
->
	`gëTLayî
() >= m_pcEncTop->getNoDisplaySEITLayer() ) )

636 
SEINoDi•œy
 *
£iNoDi•œy
 = 
√w
 SEINoDisplay;

637 
£iNoDi•œy
->
m_noDi•œy
 = 
åue
;

638 
£iMesßges
.
	`push_back
(
£iNoDi•œy
);

642 i‡(!
m_pcCfg
->
	`gëCﬁourRem≠InfoSEIFûeRoŸ
().
	`em±y
())

644 
SEICﬁourRem≠pögInfo
 *
£iCﬁourRem≠pögInfo
 = 
√w
 
	`SEICﬁourRem≠pögInfo
();

645 c⁄° 
Boﬁ
 
suc˚ss
 = 
m_£iEncodî
.
	`öôSEICﬁourRem≠pögInfo
(
£iCﬁourRem≠pögInfo
, 
¶i˚
->
	`gëPOC
() );

647 if(
suc˚ss
)

649 
£iMesßges
.
	`push_back
(
£iCﬁourRem≠pögInfo
);

653 
dñëe
 
£iCﬁourRem≠pögInfo
;

658 i‡(!
m_pcCfg
->
	`gëA¬Ÿ©edRegi⁄SEIFûeRoŸ
().
	`em±y
())

660 
SEIA¬Ÿ©edRegi⁄s
 *
£iA¬Ÿ©edRegi⁄s
 = 
√w
 
	`SEIA¬Ÿ©edRegi⁄s
();

661 c⁄° 
Boﬁ
 
suc˚ss
 = 
m_£iEncodî
.
	`öôSEIA¬Ÿ©edRegi⁄s
(
£iA¬Ÿ©edRegi⁄s
, 
¶i˚
->
	`gëPOC
());

663 i‡(
suc˚ss
)

665 
£iMesßges
.
	`push_back
(
£iA¬Ÿ©edRegi⁄s
);

669 
dñëe
 
£iA¬Ÿ©edRegi⁄s
;

673 i‡(!
m_pcCfg
->
	`gëRegi⁄ÆNe°ögSEIFûeRoŸ
().
	`em±y
())

675 
SEIRegi⁄ÆNe°ög
 *
£iRegi⁄ÆNe°ög

√w
 
	`SEIRegi⁄ÆNe°ög
();

676 c⁄° 
Boﬁ
 
suc˚ss
 = 
m_£iEncodî
.
	`öôSEIRegi⁄ÆNe°ög
(
£iRegi⁄ÆNe°ög
, 
¶i˚
->
	`gëPOC
() );

678 if(
suc˚ss
)

680 
£iMesßges
.
	`push_back
(
£iRegi⁄ÆNe°ög
);

684 
dñëe
 
£iRegi⁄ÆNe°ög
;

687 #i‡
FGS_RDD5_ENABLE


689 i‡(
m_pcCfg
->
	`gëFûmGøöCh¨a˘î°icsSEIE«bÀd
())

691 
SEIFûmGøöCh¨a˘îi°ics
 *
fgcSEI
 = 
√w
 SEIFilmGrainCharacteristics;

692 
m_£iEncodî
.
	`öôSEIFûmGøöCh¨a˘îi°ics
(
fgcSEI
);

693 
£iMesßges
.
	`push_back
(
fgcSEI
);

696 
	}
}

698 
Void
 
	gTEncGOP
::
	$xCª©eSˇœbÀNe°ögSEI
 (
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
√°edSeiMesßges
)

700 
SEIMesßges
 
tmpMesßges
;

701 !
√°edSeiMesßges
.
	`em±y
())

703 
SEI
* 
£i
=
√°edSeiMesßges
.
	`‰⁄t
();

704 
√°edSeiMesßges
.
	`p›_‰⁄t
();

705 
tmpMesßges
.
	`push_back
(
£i
);

706 
SEISˇœbÀNe°ög
 *
√°ögSEI
 = 
√w
 
	`SEISˇœbÀNe°ög
();

707 
m_£iEncodî
.
	`öôSEISˇœbÀNe°ög
(
√°ögSEI
, 
tmpMesßges
);

708 
£iMesßges
.
	`push_back
(
√°ögSEI
);

709 
tmpMesßges
.
	`˛ór
();

711 
	}
}

713 
Void
 
	gTEncGOP
::
xCª©ePi˘uªTimögSEI
 (
I¡
 
IRAPGOPid
, 
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
√°edSeiMesßges
, SEIMesßges& 
duInfoSeiMesßges
, 
TComSli˚
 *
¶i˚
, 
Boﬁ
 
isFõld
, 
°d
::
deque
<
DUD©a
> &
duD©a
)

715 c⁄° 
TComVUI
 *
vui
 = 
¶i˚
->
gëSPS
()->
gëVuiP¨amëîs
();

716 c⁄° 
TComHRD
 *
	ghrd
 = 
vui
->
gëHrdP¨amëîs
();

719 if––
	gm_pcCfg
->
gëPi˘uªTimögSEIE«bÀd
(Ë|| m_pcCfg->
gëDecodögUnôInfoSEIE«bÀd
() ) &&

720 –
	g¶i˚
->
gëSPS
()->
gëVuiP¨amëîsPª£¡Fœg
() ) &&

721 –
	ghrd
->
gëNÆHrdP¨amëîsPª£¡Fœg
(Ë|| hrd->
gëV˛HrdP¨amëîsPª£¡Fœg
() ) )

723 
I¡
 
	gpicS±DpbOuçutDuDñay
 = 0;

724 
SEIPi˘uªTimög
 *
	gpi˘uªTimögSEI
 = 
√w
 SEIPictureTiming();

727 if–
	ghrd
->
gëSubPicCpbP¨amsPª£¡Fœg
() )

729 
UI¡
 
	gnumDU
 = (UI¡Ë
duD©a
.
size
();

730 
	gpi˘uªTimögSEI
->
	gm_numDecodögUnôsMöus1
 = ( 
numDU
 - 1 );

731 
	gpi˘uªTimögSEI
->
	gm_duComm⁄CpbRemovÆDñayFœg
 = 
Ál£
;

732 
	gpi˘uªTimögSEI
->
	gm_numNÆusInDuMöus1
.
ªsize
–
numDU
 );

733 
	gpi˘uªTimögSEI
->
	gm_duCpbRemovÆDñayMöus1
.
ªsize
–
numDU
 );

735 
	gpi˘uªTimögSEI
->
	gm_auCpbRemovÆDñay
 = 
°d
::
mö
<
I¡
>(°d::
max
<I¡>(1, 
	gm_tŸÆCoded
 - 
	gm_œ°BPSEI
), 
	g°©ic_ˇ°
<
	gI¡
>(
pow
(2, 
°©ic_ˇ°
<
DoubÀ
>(
hrd
->
gëCpbRemovÆDñayLígthMöus1
()+1))));

736 
	gpi˘uªTimögSEI
->
	gm_picDpbOuçutDñay
 = 
¶i˚
->
gëSPS
()->
gëNumRe‹dîPics
(¶i˚->gëSPS()->
gëMaxTLayîs
()-1Ë+ sli˚->
gëPOC
(Ë- 
m_tŸÆCoded
;

737 if(
	gm_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
(Ë&& 
	gIRAPGOPid
 > 0 && IRAPGOPid < 
	gm_iG›Size
)

740 
	gpi˘uªTimögSEI
->
	gm_picDpbOuçutDñay
 ++;

742 
I¡
 
	gÁ˘‹
 = 
hrd
->
gëTickDivis‹Möus2
() + 2;

743 
	gpi˘uªTimögSEI
->
	gm_picDpbOuçutDuDñay
 = 
Á˘‹
 * 
pi˘uªTimögSEI
->
m_picDpbOuçutDñay
;

744 if–
	gm_pcCfg
->
gëDecodögUnôInfoSEIE«bÀd
() )

746 
	gpicS±DpbOuçutDuDñay
 = 
Á˘‹
 * 
pi˘uªTimögSEI
->
m_picDpbOuçutDñay
;

748 i‡(
	gm_buf„rögPîiodSEIPª£¡InAU
)

750 
	gm_œ°BPSEI
 = 
m_tŸÆCoded
;

753 if–
	ghrd
->
gëSubPicCpbP¨amsPª£¡Fœg
() )

755 
I¡
 
	gi
;

756 
UI¡64
 
	gui64Tmp
;

757 
UI¡
 
	guiPªv
 = 0;

758 
UI¡
 
	gnumDU
 = ( 
pi˘uªTimögSEI
->
m_numDecodögUnôsMöus1
 + 1 );

759 
	g°d
::
ve˘‹
<
UI¡
> &
rDuCpbRemovÆDñayMöus1
 = 
pi˘uªTimögSEI
->
m_duCpbRemovÆDñayMöus1
;

760 
UI¡
 
	gmaxDiff
 = ( 
hrd
->
gëTickDivis‹Möus2
() + 2 ) - 1;

762  
	gi
 = 0; i < 
	gnumDU
; i ++ )

764 
	gpi˘uªTimögSEI
->
	gm_numNÆusInDuMöus1
[ 
i
 ] = ( i =0 ) ? ( 
duD©a
[i].
accumNÆsDU
 - 1 ) : ( duData[i].accumNalsDU- duData[i-1].accumNalsDU - 1 );

767 if–
	gnumDU
 == 1 )

769 
rDuCpbRemovÆDñayMöus1
[ 0 ] = 0;

773 
	grDuCpbRemovÆDñayMöus1
[ 
numDU
 - 1 ] = 0;

774 
UI¡
 
	gtmp
 = 0;

775 
UI¡
 
	gaccum
 = 0;

777  
	gi
 = ( 
numDU
 - 2 ); i >= 0; i -- )

779 
	gui64Tmp
 = ( ( ( 
duD©a
[
numDU
 - 1].
accumBôsDU
 - duD©a[
i
].accumBôsDU ) * ( 
vui
->
gëTimögInfo
()->
gëTimeSˇÀ
(Ë/ vui->gëTimögInfo()->
gëNumUnôsInTick
(ËË* ( 
hrd
->
gëTickDivis‹Möus2
(Ë+ 2 ) ) / ( 
m_pcCfg
->
gëT¨gëBôøã
() ) );

780 if–(
	gUI¡
)
	gui64Tmp
 > 
	gmaxDiff
 )

782 
	gtmp
 ++;

785 
	guiPªv
 = 0;

787 
UI¡
 
	gÊag
 = 0;

788  
	gi
 = ( 
numDU
 - 2 ); i >= 0; i -- )

790 
	gÊag
 = 0;

791 
	gui64Tmp
 = ( ( ( 
duD©a
[
numDU
 - 1].
accumBôsDU
 - duD©a[
i
].accumBôsDU ) * ( 
vui
->
gëTimögInfo
()->
gëTimeSˇÀ
(Ë/ vui->gëTimögInfo()->
gëNumUnôsInTick
(ËË* ( 
hrd
->
gëTickDivis‹Möus2
(Ë+ 2 ) ) / ( 
m_pcCfg
->
gëT¨gëBôøã
() ) );

793 if–(
	gUI¡
)
	gui64Tmp
 > 
	gmaxDiff
 )

795 if(
	guiPªv
 >
maxDiff
 - 
tmp
)

797 
ui64Tmp
 = 
uiPªv
 + 1;

798 
	gÊag
 = 1;

800 
	gui64Tmp
 = 
maxDiff
 - 
tmp
 + 1;

802 
	grDuCpbRemovÆDñayMöus1
[ 
i
 ] = (
UI¡
)
ui64Tmp
 - 
uiPªv
 - 1;

803 if–(
	gI¡
)
	grDuCpbRemovÆDñayMöus1
[ 
i
 ] < 0 )

805 
	grDuCpbRemovÆDñayMöus1
[ 
i
 ] = 0;

807 i‡(
	gtmp
 > 0 && 
	gÊag
 == 1)

809 
tmp
 --;

811 
	gaccum
 +
rDuCpbRemovÆDñayMöus1
[ 
i
 ] + 1;

812 
	guiPªv
 = 
accum
;

817 if–
	gm_pcCfg
->
gëPi˘uªTimögSEIE«bÀd
() )

819 
	gpi˘uªTimögSEI
->
	gm_picSåu˘
 = (
isFõld
 && 
¶i˚
->
gëPic
()->
isT›Fõld
())? 1 : isField? 2 : 0;

820 
	g£iMesßges
.
push_back
(
pi˘uªTimögSEI
);

822 i‡–
	gm_pcCfg
->
gëSˇœbÀNe°ögSEIE«bÀd
() )

824 
SEIPi˘uªTimög
 *
	gpi˘uªTimögSEIc›y
 = 
√w
 SEIPictureTiming();

825 
	gpi˘uªTimögSEI
->
c›yTo
(*
pi˘uªTimögSEIc›y
);

826 
	g√°edSeiMesßges
.
push_back
(
pi˘uªTimögSEIc›y
);

830 if–
	gm_pcCfg
->
gëDecodögUnôInfoSEIE«bÀd
(Ë&& 
	ghrd
->
gëSubPicCpbP¨amsPª£¡Fœg
() )

832  
I¡
 
	gi
 = 0; i < ( 
	gpi˘uªTimögSEI
->
	gm_numDecodögUnôsMöus1
 + 1 ); i ++ )

834 
SEIDecodögUnôInfo
 *
	gduInfoSEI
 = 
√w
 SEIDecodingUnitInfo();

835 
	gduInfoSEI
->
	gm_decodögUnôIdx
 = 
i
;

836 
	gduInfoSEI
->
	gm_duS±CpbRemovÆDñay
 = 
pi˘uªTimögSEI
->
m_duCpbRemovÆDñayMöus1
[
i
] + 1;

837 
	gduInfoSEI
->
	gm_dpbOuçutDuDñayPª£¡Fœg
 = 
Ál£
;

838 
	gduInfoSEI
->
	gm_picS±DpbOuçutDuDñay
 = 
picS±DpbOuçutDuDñay
;

840 
	gduInfoSeiMesßges
.
push_back
(
duInfoSEI
);

844 if–!
	gm_pcCfg
->
gëPi˘uªTimögSEIE«bÀd
(Ë&& 
	gpi˘uªTimögSEI
 )

846 
dñëe
 
	gpi˘uªTimögSEI
;

851 
Void
 
	gTEncGOP
::
xUpd©eDuD©a
(
Ac˚ssUnô
 &
ã°AU
, 
°d
::
deque
<
DUD©a
> &
duD©a
)

853 i‡(
duD©a
.
em±y
())

858 
UI¡
 
	gnumNÆUnôs
 = (UI¡)
ã°AU
.
size
();

859 
UI¡
 
	gnumRBSPByãs
 = 0;

860 
	gAc˚ssUnô
::
c⁄°_ôî©‹
 
ô
 = 
ã°AU
.
begö
(); 
	gô
 !ã°AU.
íd
(); it++)

862 
	gnumRBSPByãs
 +
UI¡
((*
ô
)->
m_«lUnôD©a
.
°r
().
size
());

864 
	gduD©a
[0].
	gaccumBôsDU
 +–
numRBSPByãs
 << 3 );

865 
	gduD©a
[0].
	gaccumNÆsDU
 +
numNÆUnôs
;

869 
I¡
 
	gi
=1; i<
	gduD©a
.
size
(); i++)

871 i‡(
	gm_pcCfg
->
gëDecodögUnôInfoSEIE«bÀd
())

873 
	gnumNÆUnôs
 += 1;

874 
	gnumRBSPByãs
 += ( 5 << 3 );

876 
	gduD©a
[
i
].
	gaccumBôsDU
 +
numRBSPByãs
;

877 
	gduD©a
[
i
].
	gaccumNÆsDU
 +
numNÆUnôs
;

881 i‡(
	gm_pcCfg
->
gëDecodedPi˘uªHashSEITy≥
()!=
HASHTYPE_NONE
)

883 
duD©a
.
back
().
accumBôsDU
 += ( 20 << 3 );

884 
	gduD©a
.
back
().
	gaccumNÆsDU
 += 1;

888 
Void
 
	gTEncGOP
::
xUpd©eTimögSEI
(
SEIPi˘uªTimög
 *
pi˘uªTimögSEI
, 
°d
::
deque
<
DUD©a
> &
duD©a
, c⁄° 
TComSPS
 *
•s
)

890 i‡(!
	gpi˘uªTimögSEI
)

894 c⁄° 
TComVUI
 *
	gvui
 = 
•s
->
gëVuiP¨amëîs
();

895 c⁄° 
TComHRD
 *
	ghrd
 = 
vui
->
gëHrdP¨amëîs
();

896 if–
	ghrd
->
gëSubPicCpbP¨amsPª£¡Fœg
() )

898 
I¡
 
	gi
;

899 
UI¡64
 
	gui64Tmp
;

900 
UI¡
 
	guiPªv
 = 0;

901 
UI¡
 
	gnumDU
 = ( 
pi˘uªTimögSEI
->
m_numDecodögUnôsMöus1
 + 1 );

902 
	g°d
::
ve˘‹
<
UI¡
> &
rDuCpbRemovÆDñayMöus1
 = 
pi˘uªTimögSEI
->
m_duCpbRemovÆDñayMöus1
;

903 
UI¡
 
	gmaxDiff
 = ( 
hrd
->
gëTickDivis‹Möus2
() + 2 ) - 1;

905  
	gi
 = 0; i < 
	gnumDU
; i ++ )

907 
	gpi˘uªTimögSEI
->
	gm_numNÆusInDuMöus1
[ 
i
 ] = ( i =0 ) ? ( 
duD©a
[i].
accumNÆsDU
 - 1 ) : ( duData[i].accumNalsDU- duData[i-1].accumNalsDU - 1 );

910 if–
	gnumDU
 == 1 )

912 
rDuCpbRemovÆDñayMöus1
[ 0 ] = 0;

916 
	grDuCpbRemovÆDñayMöus1
[ 
numDU
 - 1 ] = 0;

917 
UI¡
 
	gtmp
 = 0;

918 
UI¡
 
	gaccum
 = 0;

920  
	gi
 = ( 
numDU
 - 2 ); i >= 0; i -- )

922 
	gui64Tmp
 = ( ( ( 
duD©a
[
numDU
 - 1].
accumBôsDU
 - duD©a[
i
].accumBôsDU ) * ( 
vui
->
gëTimögInfo
()->
gëTimeSˇÀ
(Ë/ vui->gëTimögInfo()->
gëNumUnôsInTick
(ËË* ( 
hrd
->
gëTickDivis‹Möus2
(Ë+ 2 ) ) / ( 
m_pcCfg
->
gëT¨gëBôøã
() ) );

923 if–(
	gUI¡
)
	gui64Tmp
 > 
	gmaxDiff
 )

925 
	gtmp
 ++;

928 
	guiPªv
 = 0;

930 
UI¡
 
	gÊag
 = 0;

931  
	gi
 = ( 
numDU
 - 2 ); i >= 0; i -- )

933 
	gÊag
 = 0;

934 
	gui64Tmp
 = ( ( ( 
duD©a
[
numDU
 - 1].
accumBôsDU
 - duD©a[
i
].accumBôsDU ) * ( 
vui
->
gëTimögInfo
()->
gëTimeSˇÀ
(Ë/ vui->gëTimögInfo()->
gëNumUnôsInTick
(ËË* ( 
hrd
->
gëTickDivis‹Möus2
(Ë+ 2 ) ) / ( 
m_pcCfg
->
gëT¨gëBôøã
() ) );

936 if–(
	gUI¡
)
	gui64Tmp
 > 
	gmaxDiff
 )

938 if(
	guiPªv
 >
maxDiff
 - 
tmp
)

940 
ui64Tmp
 = 
uiPªv
 + 1;

941 
	gÊag
 = 1;

943 
	gui64Tmp
 = 
maxDiff
 - 
tmp
 + 1;

945 
	grDuCpbRemovÆDñayMöus1
[ 
i
 ] = (
UI¡
)
ui64Tmp
 - 
uiPªv
 - 1;

946 if–(
	gI¡
)
	grDuCpbRemovÆDñayMöus1
[ 
i
 ] < 0 )

948 
	grDuCpbRemovÆDñayMöus1
[ 
i
 ] = 0;

950 i‡(
	gtmp
 > 0 && 
	gÊag
 == 1)

952 
tmp
 --;

954 
	gaccum
 +
rDuCpbRemovÆDñayMöus1
[ 
i
 ] + 1;

955 
	guiPªv
 = 
accum
;

960 
Void
 
	gTEncGOP
::
	$xUpd©eDuInfoSEI
(
SEIMesßges
 &
duInfoSeiMesßges
, 
SEIPi˘uªTimög
 *
pi˘uªTimögSEI
)

962 i‡(
duInfoSeiMesßges
.
	`em±y
(Ë|| (
pi˘uªTimögSEI
 =
NULL
))

967 
I¡
 
i
=0;

969 
SEIMesßges
::
ôî©‹
 
du
 = 
duInfoSeiMesßges
.
	`begö
(); du!duInfoSeiMesßges.
	`íd
(); du++)

971 
SEIDecodögUnôInfo
 *
duInfoSEI
 = (SEIDecodögUnôInfo*Ë(*
du
);

972 
duInfoSEI
->
m_decodögUnôIdx
 = 
i
;

973 
duInfoSEI
->
m_duS±CpbRemovÆDñay
 = 
pi˘uªTimögSEI
->
m_duCpbRemovÆDñayMöus1
[
i
] + 1;

974 
duInfoSEI
->
m_dpbOuçutDuDñayPª£¡Fœg
 = 
Ál£
;

975 
i
++;

977 
	}
}

979 
Void


980 
	$ˇbac_zîo_w‹d_∑ddög
(
TComSli˚
 *c⁄° 
pcSli˚
, 
TComPic
 *c⁄° 
pcPic
, c⁄° 
°d
::
size_t
 
böCou¡sInNÆUnôs
, c⁄° std::size_à
numByãsInV˛NÆUnôs
, std::
o°rög°ªam
 &
«lUnôD©a
, c⁄° 
Boﬁ
 
ˇbacZîoW‹dPaddögE«bÀd
)

982 c⁄° 
TComSPS
 &
•s
=*(
pcSli˚
->
	`gëSPS
());

983 c⁄° 
I¡
 
log2subWidthCxsubHeightC
 = (
pcPic
->
	`gëComp⁄ítSˇÀX
(
COMPONENT_Cb
)+pcPic->
	`gëComp⁄ítSˇÀY
(COMPONENT_Cb));

984 c⁄° 
I¡
 
möCuWidth
 = 
pcPic
->
	`gëMöCUWidth
();

985 c⁄° 
I¡
 
möCuHeight
 = 
pcPic
->
	`gëMöCUHeight
();

986 c⁄° 
I¡
 
∑ddedWidth
 = ((
•s
.
	`gëPicWidthInLumaSam∂es
(Ë+ 
möCuWidth
 - 1) / minCuWidth) * minCuWidth;

987 c⁄° 
I¡
 
∑ddedHeight
((
•s
.
	`gëPicHeightInLumaSam∂es
(Ë+ 
möCuHeight
 - 1) / minCuHeight) * minCuHeight;

988 c⁄° 
I¡
 
øwBôs
 = 
∑ddedWidth
 * 
∑ddedHeight
 *

989 (
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
Ë+ ((2*•s.gëBôDïth(
CHANNEL_TYPE_CHROMA
))>>
log2subWidthCxsubHeightC
));

990 c⁄° 
°d
::
size_t
 
thªshﬁd
 = (32/3)*
numByãsInV˛NÆUnôs
 + (
øwBôs
/32);

991 i‡(
böCou¡sInNÆUnôs
 >
thªshﬁd
)

994 c⁄° 
°d
::
size_t
 
èrgëNumByãsInV˛NÆUnôs
 = ((
böCou¡sInNÆUnôs
 - (
øwBôs
/32))*3+31)/32;

996 i‡(
èrgëNumByãsInV˛NÆUnôs
>
numByãsInV˛NÆUnôs
)

998 c⁄° 
°d
::
size_t
 
numbîOfAddôi⁄ÆByãsNìded
=
èrgëNumByãsInV˛NÆUnôs
 - 
numByãsInV˛NÆUnôs
;

999 c⁄° 
°d
::
size_t
 
numbîOfAddôi⁄ÆCabacZîoW‹ds
=(
numbîOfAddôi⁄ÆByãsNìded
+2)/3;

1000 c⁄° 
°d
::
size_t
 
numbîOfAddôi⁄ÆCabacZîoByãs
=
numbîOfAddôi⁄ÆCabacZîoW‹ds
*3;

1001 i‡(
ˇbacZîoW‹dPaddögE«bÀd
)

1003 
°d
::
ve˘‹
<
UCh¨
> 
	`zîoByãsPaddög
(
numbîOfAddôi⁄ÆCabacZîoByãs
, 
	`UCh¨
(0));

1004 
°d
::
size_t
 
i
=0; i<
numbîOfAddôi⁄ÆCabacZîoW‹ds
; i++)

1006 
zîoByãsPaddög
[
i
*3+2]=3;

1008 
«lUnôD©a
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(&(
zîoByãsPaddög
[0])), 
numbîOfAddôi⁄ÆCabacZîoByãs
);

1009 
	`¥ötf
("Addög %d byã†o‡∑ddög\n", 
	`UI¡
(
numbîOfAddôi⁄ÆCabacZîoW‹ds
*3));

1013 
	`¥ötf
("Sènd¨d wouldÇ‹mÆlyÑequúêaddög %d byã†o‡∑ddög\n", 
	`UI¡
(
numbîOfAddôi⁄ÆCabacZîoW‹ds
*3));

1017 
	}
}

1019 ˛as†
	cEfficõ¡FõldIRAPM≠pög


1021 
	m¥iv©e
:

1022 
I¡
 
IRAPGOPid
;

1023 
Boﬁ
 
	mIRAPtoRe‹dî
;

1024 
Boﬁ
 
	msw≠IRAPF‹w¨d
;

1026 
	mpublic
:

1027 
	$Efficõ¡FõldIRAPM≠pög
() :

1028 
	`IRAPGOPid
(-1),

1029 
	`IRAPtoRe‹dî
(
Ál£
),

1030 
	$sw≠IRAPF‹w¨d
(
Ál£
)

1033 
Void
 
	`öôülize
(c⁄° 
Boﬁ
 
isFõld
, c⁄° 
I¡
 
g›Size
, c⁄° I¡ 
POCLa°
, c⁄° I¡ 
numPicRcvd
, c⁄° I¡ 
œ°IDR
, 
TEncGOP
 *
pEncG›
, 
TEncCfg
 *
pCfg
);

1035 
I¡
 
	`adju°GOPid
(c⁄° I¡ 
g›ID
);

1036 
I¡
 
	`ª°‹eGOPid
(c⁄° I¡ 
g›ID
);

1037 
I¡
 
	$GëIRAPGOPid
(Ëc⁄° {  
IRAPGOPid
; 
	}
}

1040 
Void
 
	gEfficõ¡FõldIRAPM≠pög
::
	$öôülize
(c⁄° 
Boﬁ
 
isFõld
, c⁄° 
I¡
 
g›Size
, c⁄° I¡ 
POCLa°
, c⁄° I¡ 
numPicRcvd
, c⁄° I¡ 
œ°IDR
, 
TEncGOP
 *
pEncG›
, 
TEncCfg
 *
pCfg
 )

1042 if(
isFõld
)

1044 
I¡
 
pocCuº
;

1045  
I¡
 
iGOPid
=0; iGOPid < 
g›Size
; iGOPid++ )

1048 if(
POCLa°
 == 0)

1050 
pocCuº
=0;

1052 if(
POCLa°
 =1 && 
isFõld
)

1054 
pocCuº
 = 1;

1058 
pocCuº
 = 
POCLa°
 - 
numPicRcvd
 + 
pCfg
->
	`gëGOPE¡ry
(
iGOPid
).
m_POC
 - 
isFõld
;

1062 
NÆUnôTy≥
 
tmpUnôTy≥
 = 
pEncG›
->
	`gëNÆUnôTy≥
(
pocCuº
, 
œ°IDR
, 
isFõld
);

1063 if(
tmpUnôTy≥
 >
NAL_UNIT_CODED_SLICE_BLA_W_LP
 &&ÅmpUnôTy≥ <
NAL_UNIT_CODED_SLICE_CRA
)

1065 if(
pocCuº
%2 =0 && 
iGOPid
 < 
g›Size
-1 && 
pCfg
->
	`gëGOPE¡ry
(iGOPid).
m_POC
 ==ÖCfg->getGOPEntry(iGOPid+1).m_POC-1)

1067 
IRAPGOPid
 = 
iGOPid
;

1068 
IRAPtoRe‹dî
 = 
åue
;

1069 
sw≠IRAPF‹w¨d
 = 
åue
;

1072 if(
pocCuº
%2 !0 && 
iGOPid
 > 0 && 
pCfg
->
	`gëGOPE¡ry
(iGOPid).
m_POC
 ==ÖCfg->getGOPEntry(iGOPid-1).m_POC+1)

1075 
IRAPGOPid
 = 
iGOPid
;

1076 
IRAPtoRe‹dî
 = 
åue
;

1077 
sw≠IRAPF‹w¨d
 = 
Ál£
;

1083 
	}
}

1085 
I¡
 
	gEfficõ¡FõldIRAPM≠pög
::
	$adju°GOPid
(c⁄° 
I¡
 
GOPid
)

1087 if(
IRAPtoRe‹dî
)

1089 if(
sw≠IRAPF‹w¨d
)

1091 if(
GOPid
 =
IRAPGOPid
)

1093  
IRAPGOPid
 +1;

1095 if(
GOPid
 =
IRAPGOPid
 +1)

1097  
IRAPGOPid
;

1102 if(
GOPid
 =
IRAPGOPid
 -1)

1104  
IRAPGOPid
;

1106 if(
GOPid
 =
IRAPGOPid
)

1108  
IRAPGOPid
 -1;

1112  
GOPid
;

1113 
	}
}

1115 
I¡
 
	gEfficõ¡FõldIRAPM≠pög
::
	$ª°‹eGOPid
(c⁄° 
I¡
 
GOPid
)

1117 if(
IRAPtoRe‹dî
)

1119 if(
sw≠IRAPF‹w¨d
)

1121 if(
GOPid
 =
IRAPGOPid
)

1123 
IRAPtoRe‹dî
 = 
Ál£
;

1124  
IRAPGOPid
 +1;

1126 if(
GOPid
 =
IRAPGOPid
 +1)

1128  
GOPid
 -1;

1133 if(
GOPid
 =
IRAPGOPid
)

1135  
IRAPGOPid
 -1;

1137 if(
GOPid
 =
IRAPGOPid
 -1)

1139 
IRAPtoRe‹dî
 = 
Ál£
;

1140  
IRAPGOPid
;

1144  
GOPid
;

1145 
	}
}

1148 
UI¡
 
	$ˇlcuœãCﬁloˇãdFromL0Fœg
(c⁄° 
TComSli˚
 *
pSli˚
)

1150 c⁄° 
I¡
 
ªfIdx
 = 0;

1151 c⁄° 
TComPic
 *
ªfPicL0
 = 
pSli˚
->
	`gëRefPic
(
REF_PIC_LIST_0
, 
ªfIdx
);

1152 c⁄° 
TComPic
 *
ªfPicL1
 = 
pSli˚
->
	`gëRefPic
(
REF_PIC_LIST_1
, 
ªfIdx
);

1153  
ªfPicL0
->
	`gëSli˚
(0)->
	`gëSli˚Qp
(Ë> 
ªfPicL1
->getSlice(0)->getSliceQp();

1154 
	}
}

1157 
Void


1158 
	$¥ötHash
(c⁄° 
HashTy≥
 
hashTy≥
, c⁄° 
°d
::
°rög
 &
dige°Så
)

1160 c⁄° 
TCh¨
 *
decodedPi˘uªHashModeName
;

1161 
hashTy≥
)

1163 
HASHTYPE_MD5
:

1164 
decodedPi˘uªHashModeName
 = "MD5";

1166 
HASHTYPE_CRC
:

1167 
decodedPi˘uªHashModeName
 = "CRC";

1169 
HASHTYPE_CHECKSUM
:

1170 
decodedPi˘uªHashModeName
 = "Checksum";

1173 
decodedPi˘uªHashModeName
 = 
NULL
;

1176 i‡(
decodedPi˘uªHashModeName
 !
NULL
)

1178 i‡(
dige°Så
.
	`em±y
())

1180 
	`¥ötf
(" [%s:%s]", 
decodedPi˘uªHashModeName
, "?");

1184 
	`¥ötf
(" [%s:%s]", 
decodedPi˘uªHashModeName
, 
dige°Så
.
	`c_°r
());

1187 
	}
}

1193 
Void
 
	gTEncGOP
::
com¥essGOP
–
I¡
 
iPOCLa°
, I¡ 
iNumPicRcvd
, 
TComLi°
<
TComPic
*>& 
rcLi°Pic
,

1194 
TComLi°
<
TComPicYuv
*>& 
rcLi°PicYuvRecOut
, 
°d
::
li°
<
Ac˚ssUnô
>& 
ac˚ssUnôsInGOP
,

1195 
Boﬁ
 
isFõld
, Boﬁ 
isTff
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ù_c⁄vîsi⁄
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢r_c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
 )

1199 
TComPic
* 
pcPic
 = 
NULL
;

1200 
TComPicYuv
* 
	gpcPicYuvRecOut
;

1201 
TComSli˚
* 
	gpcSli˚
;

1202 
TComOuçutBô°ªam
 *
	gpcBô°ªamRedúe˘
;

1203 
	gpcBô°ªamRedúe˘
 = 
√w
 
TComOuçutBô°ªam
;

1204 
	gAc˚ssUnô
::
ôî©‹
 
ôLoˇti⁄ToPushSli˚HódîNALU
;

1206 
xInôGOP
–
iPOCLa°
, 
iNumPicRcvd
, 
isFõld
 );

1208 
	gm_iNumPicCoded
 = 0;

1209 
SEIMesßges
 
	gÀadögSeiMesßges
;

1210 
SEIMesßges
 
	g√°edSeiMesßges
;

1211 
SEIMesßges
 
	gduInfoSeiMesßges
;

1212 
SEIMesßges
 
	gåaûögSeiMesßges
;

1213 
	g°d
::
deque
<
DUD©a
> 
duD©a
;

1214 
SEIDecodögUnôInfo
 
	gdecodögUnôInfoSEI
;

1216 
Efficõ¡FõldIRAPM≠pög
 
	geffFõldIRAPM≠
;

1217 i‡(
	gm_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
())

1219 
	geffFõldIRAPM≠
.
öôülize
(
isFõld
, 
m_iG›Size
, 
iPOCLa°
, 
iNumPicRcvd
, 
m_iLa°IDR
, 
this
, 
m_pcCfg
);

1223  
I¡
 
	giGOPid
=0; iGOPid < 
	gm_iG›Size
; iGOPid++ )

1225 
	gm_pcCfg
->
£tEncodedFœg
(
iGOPid
, 
Ál£
);

1228  
I¡
 
	giGOPid
=0; iGOPid < 
	gm_iG›Size
; iGOPid++ )

1230 i‡(
	gm_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
())

1232 
	giGOPid
=
effFõldIRAPM≠
.
adju°GOPid
(
iGOPid
);

1236 
˛ock_t
 
	giBef‹eTime
 = 
˛ock
();

1240 
I¡
 
	giTimeOff£t
;

1241 
I¡
 
	gpocCuº
;

1243 if(
	giPOCLa°
 == 0)

1245 
pocCuº
=0;

1246 
	giTimeOff£t
 = 1;

1248 if(
	giPOCLa°
 =1 && 
isFõld
)

1250 
pocCuº
 = 1;

1251 
	giTimeOff£t
 = 1;

1255 
	gpocCuº
 = 
iPOCLa°
 - 
iNumPicRcvd
 + 
m_pcCfg
->
gëGOPE¡ry
(
iGOPid
).
m_POC
 - ((
isFõld
 && 
m_iG›Size
>1) ? 1:0);

1256 
	giTimeOff£t
 = 
m_pcCfg
->
gëGOPE¡ry
(
iGOPid
).
m_POC
;

1259 if(
	gpocCuº
>=
m_pcCfg
->
gëFømesToBeEncoded
())

1261 i‡(
m_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
())

1263 
iGOPid
=
effFõldIRAPM≠
.
ª°‹eGOPid
(iGOPid);

1268 if–
gëNÆUnôTy≥
(
pocCuº
, 
m_iLa°IDR
, 
isFõld
Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL
 || gëNÆUnôTy≥’ocCuº, m_iLa°IDR, isFõldË=
NAL_UNIT_CODED_SLICE_IDR_N_LP
 )

1270 
m_iLa°IDR
 = 
pocCuº
;

1273 
	gac˚ssUnôsInGOP
.
push_back
(
Ac˚ssUnô
());

1274 
	gAc˚ssUnô
& 
	gac˚ssUnô
 = 
ac˚ssUnôsInGOP
.
back
();

1275 
xGëBuf„r
–
rcLi°Pic
, 
rcLi°PicYuvRecOut
, 
iNumPicRcvd
, 
iTimeOff£t
, 
pcPic
, 
pcPicYuvRecOut
, 
pocCuº
, 
isFõld
 );

1277 #i‡
REDUCED_ENCODER_MEMORY


1278 
	gpcPic
->
¥ï¨eF‹Rec⁄°ru˘i⁄
();

1282 
	gpcPic
->
˛órSli˚Buf„r
();

1283 
	gpcPic
->
ÆloˇãNewSli˚
();

1284 
	gm_pcSli˚Encodî
->
£tSli˚Idx
(0);

1285 
	gpcPic
->
£tCuºSli˚Idx
(0);

1287 
	gm_pcSli˚Encodî
->
öôEncSli˚
 ( 
pcPic
, 
iPOCLa°
, 
pocCuº
, 
iGOPid
, 
pcSli˚
, 
isFõld
 );

1289 
	gpcSli˚
->
£tLa°IDR
(
m_iLa°IDR
);

1290 
	gpcSli˚
->
£tSli˚Idx
(0);

1292 
	gpcSli˚
->
£tLFCrossSli˚Bound¨yFœg
–
pcSli˚
->
gëPPS
()->
gëLo›FûãrA¸ossSli˚sE«bÀdFœg
() );

1294 if(
	gpcSli˚
->
gëSli˚Ty≥
()==
B_SLICE
&&
m_pcCfg
->
gëGOPE¡ry
(
iGOPid
).
m_¶i˚Ty≥
=='P')

1296 
pcSli˚
->
£tSli˚Ty≥
(
P_SLICE
);

1298 if(
	gpcSli˚
->
gëSli˚Ty≥
()==
B_SLICE
&&
m_pcCfg
->
gëGOPE¡ry
(
iGOPid
).
m_¶i˚Ty≥
=='I')

1300 
pcSli˚
->
£tSli˚Ty≥
(
I_SLICE
);

1304 
	gpcSli˚
->
£tNÆUnôTy≥
(
gëNÆUnôTy≥
(
pocCuº
, 
m_iLa°IDR
, 
isFõld
));

1305 if(
	gpcSli˚
->
gëTemp‹ÆLayîN⁄Re„ªn˚Fœg
())

1307 i‡(
	gpcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_TRAIL_R
 &&

1308 !(
m_iG›Size
 =1 && 
pcSli˚
->
gëSli˚Ty≥
(Ë=
I_SLICE
))

1311 
pcSli˚
->
£tNÆUnôTy≥
(
NAL_UNIT_CODED_SLICE_TRAIL_N
);

1313 if(
	gpcSli˚
->
gëNÆUnôTy≥
()==
NAL_UNIT_CODED_SLICE_RADL_R
)

1315 
pcSli˚
->
£tNÆUnôTy≥
(
NAL_UNIT_CODED_SLICE_RADL_N
);

1317 if(
	gpcSli˚
->
gëNÆUnôTy≥
()==
NAL_UNIT_CODED_SLICE_RASL_R
)

1319 
pcSli˚
->
£tNÆUnôTy≥
(
NAL_UNIT_CODED_SLICE_RASL_N
);

1323 i‡(
	gm_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
())

1325 i‡–
	gpcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


1326 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


1327 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP


1328 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL


1329 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP


1330 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
 )

1332 
m_assocüãdIRAPTy≥
 = 
pcSli˚
->
gëNÆUnôTy≥
();

1333 
	gm_assocüãdIRAPPOC
 = 
pocCuº
;

1335 
	gpcSli˚
->
£tAssocüãdIRAPTy≥
(
m_assocüãdIRAPTy≥
);

1336 
	gpcSli˚
->
£tAssocüãdIRAPPOC
(
m_assocüãdIRAPPOC
);

1339 
	gpcSli˚
->
decodögRe‰eshM¨kög
(
m_pocCRA
, 
m_bRe‰eshPídög
, 
rcLi°Pic
, 
m_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
());

1340 
	gm_pcEncT›
->
£À˘Re„ªn˚Pi˘uªSë
(
pcSli˚
, 
pocCuº
, 
iGOPid
);

1341 i‡(!
	gm_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
())

1343 i‡–
	gpcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_LP


1344 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_W_RADL


1345 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_BLA_N_LP


1346 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_W_RADL


1347 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_IDR_N_LP


1348 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
 )

1350 
m_assocüãdIRAPTy≥
 = 
pcSli˚
->
gëNÆUnôTy≥
();

1351 
	gm_assocüãdIRAPPOC
 = 
pocCuº
;

1353 
	gpcSli˚
->
£tAssocüãdIRAPTy≥
(
m_assocüãdIRAPTy≥
);

1354 
	gpcSli˚
->
£tAssocüãdIRAPPOC
(
m_assocüãdIRAPPOC
);

1357 i‡((
	gpcSli˚
->
checkTh©AŒRefPicsAªAvaûabÀ
(
rcLi°Pic
, 
pcSli˚
->
gëRPS
(), 
Ál£
, 
m_iLa°RecovîyPicPOC
, 
m_pcCfg
->
gëDecodögRe‰eshTy≥
(Ë=3Ë!0Ë|| (pcSli˚->
isIRAP
())

1358 || (
m_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
(Ë&& 
isFõld
 && 
pcSli˚
->
gëAssocüãdIRAPTy≥
(Ë>
NAL_UNIT_CODED_SLICE_BLA_W_LP
 &&ÖcSli˚->gëAssocüãdIRAPTy≥(Ë<
NAL_UNIT_CODED_SLICE_CRA
 &&ÖcSli˚->
gëAssocüãdIRAPPOC
(Ë=pcSli˚->
gëPOC
()+1)

1361 
pcSli˚
->
¸óãEx∂icôRe„ªn˚Pi˘uªSëFromRe„ªn˚
(
rcLi°Pic
,ÖcSli˚->
gëRPS
(),ÖcSli˚->
isIRAP
(), 
m_iLa°RecovîyPicPOC
, 
m_pcCfg
->
gëDecodögRe‰eshTy≥
(Ë=3, m_pcCfg->
gëEfficõ¡FõldIRAPE«bÀd
());

1364 
	gpcSli˚
->
≠∂yRe„ªn˚Pi˘uªSë
(
rcLi°Pic
, 
pcSli˚
->
gëRPS
());

1366 if(
	gpcSli˚
->
gëTLayî
() > 0

1367 && !–
	gpcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RADL_N


1368 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RADL_R


1369 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RASL_N


1370 || 
pcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_RASL_R
 )

1373 if(
pcSli˚
->
isTemp‹ÆLayîSwôchögPoöt
(
rcLi°Pic
Ë||ÖcSli˚->
gëSPS
()->
gëTemp‹ÆIdNe°ögFœg
())

1375 if(
pcSli˚
->
gëTemp‹ÆLayîN⁄Re„ªn˚Fœg
())

1377 
pcSli˚
->
£tNÆUnôTy≥
(
NAL_UNIT_CODED_SLICE_TSA_N
);

1381 
	gpcSli˚
->
£tNÆUnôTy≥
(
NAL_UNIT_CODED_SLICE_TSA_R
);

1384 if(
	gpcSli˚
->
isSãpwi£Temp‹ÆLayîSwôchögPoötC™did©e
(
rcLi°Pic
))

1386 
Boﬁ
 
	gisSTSA
=
åue
;

1387 
I¡
 
	gii
=
iGOPid
+1;(ii<
	gm_pcCfg
->
gëGOPSize
(Ë&& 
	gisSTSA
==
åue
);ii++)

1389 
I¡
 
	glTid

m_pcCfg
->
gëGOPE¡ry
(
ii
).
m_ãmp‹ÆId
;

1390 if(
	glTid
==
pcSli˚
->
gëTLayî
())

1392 c⁄° 
TComRe„ªn˚Pi˘uªSë
* 
nRPS
 = 
pcSli˚
->
gëSPS
()->
gëRPSLi°
()->
gëRe„ªn˚Pi˘uªSë
(
ii
);

1393 
I¡
 
	gjj
=0;jj<
	gnRPS
->
gëNumbîOfPi˘uªs
();jj++)

1395 if(
	gnRPS
->
gëU£d
(
jj
))

1397 
I¡
 
	gtPoc
=
m_pcCfg
->
gëGOPE¡ry
(
ii
).
m_POC
+
nRPS
->
gëDñèPOC
(
jj
);

1398 
I¡
 
	gkk
=0;

1399 
	gkk
=0;kk<
	gm_pcCfg
->
gëGOPSize
();kk++)

1401 if(
	gm_pcCfg
->
gëGOPE¡ry
(
kk
).
	gm_POC
==
tPoc
)

1406 
I¡
 
	gtTid
=
m_pcCfg
->
gëGOPE¡ry
(
kk
).
m_ãmp‹ÆId
;

1407 if(
	gtTid
 >
pcSli˚
->
gëTLayî
())

1409 
isSTSA
=
Ál£
;

1416 if(
	gisSTSA
==
åue
)

1418 if(
pcSli˚
->
gëTemp‹ÆLayîN⁄Re„ªn˚Fœg
())

1420 
pcSli˚
->
£tNÆUnôTy≥
(
NAL_UNIT_CODED_SLICE_STSA_N
);

1424 
	gpcSli˚
->
£tNÆUnôTy≥
(
NAL_UNIT_CODED_SLICE_STSA_R
);

1429 
¨øngeL⁄gãrmPi˘uªsInRPS
(
pcSli˚
, 
rcLi°Pic
);

1430 
TComRefPicLi°Modifiˇti⁄
* 
	gªfPicLi°Modifiˇti⁄
 = 
pcSli˚
->
gëRefPicLi°Modifiˇti⁄
();

1431 
	gªfPicLi°Modifiˇti⁄
->
£tRefPicLi°Modifiˇti⁄FœgL0
(0);

1432 
	gªfPicLi°Modifiˇti⁄
->
£tRefPicLi°Modifiˇti⁄FœgL1
(0);

1433 
	gpcSli˚
->
£tNumRefIdx
(
REF_PIC_LIST_0
,
mö
(
m_pcCfg
->
gëGOPE¡ry
(
iGOPid
).
m_numRefPicsA˘ive
,
pcSli˚
->
gëRPS
()->
gëNumbîOfPi˘uªs
()));

1434 
	gpcSli˚
->
£tNumRefIdx
(
REF_PIC_LIST_1
,
mö
(
m_pcCfg
->
gëGOPE¡ry
(
iGOPid
).
m_numRefPicsA˘ive
,
pcSli˚
->
gëRPS
()->
gëNumbîOfPi˘uªs
()));

1437 
	gpcSli˚
->
£tRefPicLi°
 ( 
rcLi°Pic
 );

1440 i‡–(
	gpcSli˚
->
gëSli˚Ty≥
(Ë=
B_SLICE
Ë&& (
pcSli˚
->
gëNumRefIdx
(
REF_PIC_LIST_1
) == 0) )

1442 
pcSli˚
->
£tSli˚Ty≥
 ( 
P_SLICE
 );

1446 i‡(
	gpcSli˚
->
gëPOC
(Ë> 
	gm_RASPOCf‹Re£tEncodî
 && 
	gm_pcCfg
->
gëRe£tEncodîSèãA·îIRAP
())

1449 
	gm_pcSli˚Encodî
->
ª£tEncodîDecisi⁄s
();

1451 i‡(
	gpcSli˚
->
gëSPS
()->
gëU£SAO
())

1453 
	gm_pcSAO
->
ª£tEncodîDecisi⁄s
();

1455 
	gm_RASPOCf‹Re£tEncodî
=
MAX_INT
;

1457 i‡(
	gpcSli˚
->
isIRAP
())

1459 
	gm_RASPOCf‹Re£tEncodî
 = 
pcSli˚
->
gëPOC
();

1462 
	gpcSli˚
->
£tEncCABACTabÀIdx
(
m_pcSli˚Encodî
->
gëEncCABACTabÀIdx
());

1463 #i‡
MCTS_EXTRACTION


1464 
Sli˚Ty≥
 
	gícCABACTabÀIdx
 = 
pcSli˚
->
gëEncCABACTabÀIdx
();

1465 
Boﬁ
 
	gícCabacInôFœg
 = (
pcSli˚
->
gëSli˚Ty≥
(Ë!
ícCABACTabÀIdx
 &&ÉncCABACTabÀIdx !
I_SLICE
Ë? 
åue
 : 
Ál£
;

1466 
	gpcSli˚
->
£tCabacInôFœg
(
ícCabacInôFœg
);

1469 i‡(
	gpcSli˚
->
gëSli˚Ty≥
(Ë=
B_SLICE
)

1471 c⁄° 
UI¡
 
uiCﬁFromL0
 = 
ˇlcuœãCﬁloˇãdFromL0Fœg
(
pcSli˚
);

1472 
	gpcSli˚
->
£tCﬁFromL0Fœg
(
uiCﬁFromL0
);

1473 
Boﬁ
 
	gbLowDñay
 = 
åue
;

1474 
I¡
 
	giCuºPOC
 = 
pcSli˚
->
gëPOC
();

1475 
I¡
 
	giRefIdx
 = 0;

1477 
	giRefIdx
 = 0; iRefIdx < 
	gpcSli˚
->
gëNumRefIdx
(
REF_PIC_LIST_0
Ë&& 
	gbLowDñay
; iRefIdx++)

1479 i‡–
	gpcSli˚
->
gëRefPic
(
REF_PIC_LIST_0
, 
iRefIdx
)->
gëPOC
(Ë> 
	giCuºPOC
 )

1481 
	gbLowDñay
 = 
Ál£
;

1484 
	giRefIdx
 = 0; iRefIdx < 
	gpcSli˚
->
gëNumRefIdx
(
REF_PIC_LIST_1
Ë&& 
	gbLowDñay
; iRefIdx++)

1486 i‡–
	gpcSli˚
->
gëRefPic
(
REF_PIC_LIST_1
, 
iRefIdx
)->
gëPOC
(Ë> 
	giCuºPOC
 )

1488 
	gbLowDñay
 = 
Ál£
;

1492 
	gpcSli˚
->
£tCheckLDC
(
bLowDñay
);

1496 
	gpcSli˚
->
£tCheckLDC
(
åue
);

1501 
	gpcSli˚
->
£tRefPOCLi°
();

1503 
	gpcSli˚
->
£tLi°1IdxToLi°0Idx
();

1505 i‡(
	gm_pcEncT›
->
gëTMVPModeId
() == 2)

1507 i‡(
iGOPid
 == 0)

1509 
pcSli˚
->
£tE«bÀTMVPFœg
(0);

1514 
	gpcSli˚
->
£tE«bÀTMVPFœg
(1);

1517 i‡(
	gm_pcEncT›
->
gëTMVPModeId
() == 1)

1519 
pcSli˚
->
£tE«bÀTMVPFœg
(1);

1523 
	gpcSli˚
->
£tE«bÀTMVPFœg
(0);

1527 i‡(
	gm_pcCfg
->
gëU£ASR
(Ë&& 
	gpcSli˚
->
gëSli˚Ty≥
()!=
I_SLICE
)

1529 
m_pcSli˚Encodî
->
£tSórchR™ge
(
pcSli˚
);

1532 
Boﬁ
 
	gbGPBcheck
=
Ál£
;

1533 i‡–
	gpcSli˚
->
gëSli˚Ty≥
(Ë=
B_SLICE
)

1535 i‡–
pcSli˚
->
gëNumRefIdx
(
RefPicLi°
( 0 ) ) ==ÖcSlice->getNumRefIdx(RefPicList( 1 ) ) )

1537 
bGPBcheck
=
åue
;

1538 
I¡
 
	gi
;

1539  
	gi
=0; i < 
	gpcSli˚
->
gëNumRefIdx
(
RefPicLi°
( 1 ) ); i++ )

1541 i‡–
	gpcSli˚
->
gëRefPOC
(
RefPicLi°
(1), 
i
Ë!
pcSli˚
->getRefPOC(RefPicList(0), i) )

1543 
	gbGPBcheck
=
Ál£
;

1549 if(
	gbGPBcheck
)

1551 
	gpcSli˚
->
£tMvdL1ZîoFœg
(
åue
);

1555 
	gpcSli˚
->
£tMvdL1ZîoFœg
(
Ál£
);

1559 
DoubÀ
 
	gœmbda
 = 0.0;

1560 
I¡
 
	ga˘uÆHódBôs
 = 0;

1561 
I¡
 
	ga˘uÆTŸÆBôs
 = 0;

1562 
I¡
 
	ge°im©edBôs
 = 0;

1563 
I¡
 
	gtmpBôsBef‹eWrôög
 = 0;

1564 i‡–
	gm_pcCfg
->
gëU£R©eCål
() )

1566 
I¡
 
	g‰ameLevñ
 = 
m_pcR©eCål
->
gëRCSeq
()->
gëGOPID2Levñ
–
iGOPid
 );

1567 i‡–
	gpcPic
->
gëSli˚
(0)->
gëSli˚Ty≥
(Ë=
I_SLICE
 )

1569 
‰ameLevñ
 = 0;

1571 
	gm_pcR©eCål
->
öôRCPic
–
‰ameLevñ
 );

1572 
	ge°im©edBôs
 = 
m_pcR©eCål
->
gëRCPic
()->
gëT¨gëBôs
();

1574 i‡(
	gm_pcR©eCål
->
gëCpbS©uøti⁄E«bÀd
(Ë&& 
	g‰ameLevñ
 != 0)

1576 
I¡
 
e°im©edCpbFuŒ√ss
 = 
m_pcR©eCål
->
gëCpbSèã
(Ë+ m_pcR©eCål->
gëBuf„rögR©e
();

1579 i‡(
	ge°im©edCpbFuŒ√ss
 - 
	ge°im©edBôs
 > (
	gI¡
)(
	gm_pcR©eCål
->
gëCpbSize
()*0.9f))

1581 
	ge°im©edBôs
 = 
e°im©edCpbFuŒ√ss
 - (
I¡
)(
m_pcR©eCål
->
gëCpbSize
()*0.9f);

1584 
	ge°im©edCpbFuŒ√ss
 -
m_pcR©eCål
->
gëBuf„rögR©e
();

1586 i‡(
	ge°im©edCpbFuŒ√ss
 - 
	ge°im©edBôs
 < 
	gm_pcR©eCål
->
gëRCPic
()->
gëLowîBound
())

1588 
	ge°im©edBôs
 = 
max
(200, 
e°im©edCpbFuŒ√ss
 - 
m_pcR©eCål
->
gëRCPic
()->
gëLowîBound
());

1591 
	gm_pcR©eCål
->
gëRCPic
()->
£tT¨gëBôs
(
e°im©edBôs
);

1594 
I¡
 
	g¶i˚QP
 = 
m_pcCfg
->
gëInôülQP
();

1595 i‡––
	gpcSli˚
->
gëPOC
(Ë=0 && 
m_pcCfg
->
gëInôülQP
(Ë> 0 ) || ( 
‰ameLevñ
 =0 && m_pcCfg->
gëF‹˚I¡øQP
() ) )

1597 
I¡
 
NumbîBFømes
 = ( 
m_pcCfg
->
gëGOPSize
() - 1 );

1598 
DoubÀ
 
	gdLambda_sˇÀ
 = 1.0 - 
Clù3
–0.0, 0.5, 0.05*(DoubÀ)
NumbîBFømes
 );

1599 
DoubÀ
 
	gdQPFa˘‹
 = 0.57*
dLambda_sˇÀ
;

1600 
I¡
 
	gSHIFT_QP
 = 12;

1601 
I¡
 
	gbôdïth_luma_qp_sˇÀ
 = 0;

1602 
DoubÀ
 
	gqp_ãmp
 = (DoubÀË
¶i˚QP
 + 
bôdïth_luma_qp_sˇÀ
 - 
SHIFT_QP
;

1603 
	gœmbda
 = 
dQPFa˘‹
*
pow
–2.0, 
qp_ãmp
/3.0 );

1605 i‡–
	g‰ameLevñ
 == 0 )

1607 
m_pcSli˚Encodî
->
ˇlCo°Sli˚I
(
pcPic
);

1609 i‡–
	gm_pcCfg
->
gëI¡øPîiod
() != 1 )

1611 
I¡
 
bôs
 = 
m_pcR©eCål
->
gëRCSeq
()->
gëLe·AvîageBôs
();

1612 
	gbôs
 = 
m_pcR©eCål
->
gëRCPic
()->
gëReföeBôsF‹I¡ø
–
bôs
 );

1614 i‡(
	gm_pcR©eCål
->
gëCpbS©uøti⁄E«bÀd
() )

1616 
I¡
 
	ge°im©edCpbFuŒ√ss
 = 
m_pcR©eCål
->
gëCpbSèã
(Ë+ m_pcR©eCål->
gëBuf„rögR©e
();

1619 i‡(
	ge°im©edCpbFuŒ√ss
 - 
	gbôs
 > (
	gI¡
)(
	gm_pcR©eCål
->
gëCpbSize
()*0.9f))

1621 
	gbôs
 = 
e°im©edCpbFuŒ√ss
 - (
I¡
)(
m_pcR©eCål
->
gëCpbSize
()*0.9f);

1624 
	ge°im©edCpbFuŒ√ss
 -
m_pcR©eCål
->
gëBuf„rögR©e
();

1626 i‡(
	ge°im©edCpbFuŒ√ss
 - 
	gbôs
 < 
	gm_pcR©eCål
->
gëRCPic
()->
gëLowîBound
())

1628 
	gbôs
 = 
e°im©edCpbFuŒ√ss
 - 
m_pcR©eCål
->
gëRCPic
()->
gëLowîBound
();

1632 i‡–
	gbôs
 < 200 )

1634 
	gbôs
 = 200;

1636 
	gm_pcR©eCål
->
gëRCPic
()->
£tT¨gëBôs
–
bôs
 );

1639 
	gli°
<
	gTEncRCPic
*> 
	gli°PªviousPi˘uª
 = 
m_pcR©eCål
->
gëPicLi°
();

1640 
	gm_pcR©eCål
->
gëRCPic
()->
gëLCUInôT¨gëBôs
();

1641 
	gœmbda
 = 
m_pcR©eCål
->
gëRCPic
()->
e°im©ePicLambda
–
li°PªviousPi˘uª
, 
pcSli˚
->
gëSli˚Ty≥
());

1642 
	g¶i˚QP
 = 
m_pcR©eCål
->
gëRCPic
()->
e°im©ePicQP
–
œmbda
, 
li°PªviousPi˘uª
 );

1646 
	gli°
<
	gTEncRCPic
*> 
	gli°PªviousPi˘uª
 = 
m_pcR©eCål
->
gëPicLi°
();

1647 
	gœmbda
 = 
m_pcR©eCål
->
gëRCPic
()->
e°im©ePicLambda
–
li°PªviousPi˘uª
, 
pcSli˚
->
gëSli˚Ty≥
());

1648 
	g¶i˚QP
 = 
m_pcR©eCål
->
gëRCPic
()->
e°im©ePicQP
–
œmbda
, 
li°PªviousPi˘uª
 );

1651 
	g¶i˚QP
 = 
Clù3
–-
pcSli˚
->
gëSPS
()->
gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
, 
¶i˚QP
 );

1652 
	gm_pcR©eCål
->
gëRCPic
()->
£tPicE°QP
–
¶i˚QP
 );

1654 
	gm_pcSli˚Encodî
->
ª£tQP
–
pcPic
, 
¶i˚QP
, 
œmbda
 );

1657 
UI¡
 
	guiNumSli˚Segmíts
 = 1;

1660 c⁄° 
I¡
 
	gnumSub°ªamsCﬁumns
 = (
pcSli˚
->
gëPPS
()->
gëNumTûeCﬁumnsMöus1
() + 1);

1661 c⁄° 
I¡
 
	gnumSub°ªamRows
 = 
pcSli˚
->
gëPPS
()->
gëE¡r›yCodögSyncE«bÀdFœg
(Ë? 
pcPic
->
gëFømeHeightInCtus
(Ë: (pcSli˚->gëPPS()->
gëNumTûeRowsMöus1
() + 1);

1662 c⁄° 
I¡
 
	gnumSub°ªams
 = 
numSub°ªamRows
 * 
numSub°ªamsCﬁumns
;

1663 
	g°d
::
ve˘‹
<
TComOuçutBô°ªam
> 
sub°ªamsOut
(
numSub°ªams
);

1667 c⁄° 
UI¡
 
	gnumbîOfCtusInFøme
=
pcPic
->
gëPicSym
()->
gëNumbîOfCtusInFøme
();

1668 
	gpcSli˚
->
£tSli˚CurSèπCtuTsAddr
( 0 );

1669 
	gpcSli˚
->
£tSli˚SegmítCurSèπCtuTsAddr
( 0 );

1671 
UI¡
 
	g√xtCtuTsAddr
 = 0;ÇextCtuTsAdd∏< 
	gnumbîOfCtusInFøme
; )

1673 
	gm_pcSli˚Encodî
->
¥ecom¥essSli˚
–
pcPic
 );

1674 
	gm_pcSli˚Encodî
->
com¥essSli˚
 ( 
pcPic
, 
Ál£
, false );

1676 c⁄° 
UI¡
 
	gcurSli˚SegmítEnd
 = 
pcSli˚
->
gëSli˚SegmítCurEndCtuTsAddr
();

1677 i‡(
	gcurSli˚SegmítEnd
 < 
	gnumbîOfCtusInFøme
)

1679 c⁄° 
Boﬁ
 
	gbNextSegmítIsDïídítSli˚
=
curSli˚SegmítEnd
<
pcSli˚
->
gëSli˚CurEndCtuTsAddr
();

1680 c⁄° 
UI¡
 
	g¶i˚Bôs
=
pcSli˚
->
gëSli˚Bôs
();

1681 
	gpcPic
->
ÆloˇãNewSli˚
();

1683 
	gpcPic
->
£tCuºSli˚Idx
 ( 
uiNumSli˚Segmíts
 );

1684 
	gm_pcSli˚Encodî
->
£tSli˚Idx
 ( 
uiNumSli˚Segmíts
 );

1685 
	gpcSli˚
 = 
pcPic
->
gëSli˚
 ( 
uiNumSli˚Segmíts
 );

1686 
as£π
(
pcSli˚
->
gëPPS
()!=0);

1687 
	gpcSli˚
->
c›ySli˚Info
 ( 
pcPic
->
gëSli˚
(
uiNumSli˚Segmíts
-1) );

1688 
	gpcSli˚
->
£tSli˚Idx
 ( 
uiNumSli˚Segmíts
 );

1689 i‡(
	gbNextSegmítIsDïídítSli˚
)

1691 
	gpcSli˚
->
£tSli˚Bôs
(
¶i˚Bôs
);

1695 
	gpcSli˚
->
£tSli˚CurSèπCtuTsAddr
 ( 
curSli˚SegmítEnd
 );

1696 
	gpcSli˚
->
£tSli˚Bôs
(0);

1698 
	gpcSli˚
->
£tDïídítSli˚SegmítFœg
(
bNextSegmítIsDïídítSli˚
);

1699 
	gpcSli˚
->
£tSli˚SegmítCurSèπCtuTsAddr
 ( 
curSli˚SegmítEnd
 );

1702 
	guiNumSli˚Segmíts
 ++;

1704 
	g√xtCtuTsAddr
 = 
curSli˚SegmítEnd
;

1708 
	gduD©a
.
˛ór
();

1709 
	gpcSli˚
 = 
pcPic
->
gëSli˚
(0);

1712 if–
	gpcSli˚
->
gëSPS
()->
gëU£SAO
(Ë&& 
	gm_pcCfg
->
gëSaoCtuBound¨y
() )

1714 
	gm_pcSAO
->
gëPªDBFSèti°ics
(
pcPic
);

1718 
Boﬁ
 
	gbLFCrossTûeBound¨y
 = 
pcSli˚
->
gëPPS
()->
gëLo›FûãrA¸ossTûesE«bÀdFœg
();

1719 
	gm_pcLo›Fûãr
->
£tCfg
(
bLFCrossTûeBound¨y
);

1720 i‡–
	gm_pcCfg
->
gëDeblockögFûãrMëric
() )

1722 i‡–
	gm_pcCfg
->
gëDeblockögFûãrMëric
()==2 )

1724 
≠∂yDeblockögFûãrP¨amëîSñe˘i⁄
(
pcPic
, 
uiNumSli˚Segmíts
, 
iGOPid
);

1728 
≠∂yDeblockögFûãrMëric
(
pcPic
, 
uiNumSli˚Segmíts
);

1731 
	gm_pcLo›Fûãr
->
lo›FûãrPic
–
pcPic
 );

1735 
	gm_pcE¡r›yCodî
->
£tE¡r›yCodî
 ( 
m_pcCavlcCodî
 );

1739 
boﬁ
 
	gwrôePS
 = 
m_bSeqFú°
 || (
m_pcCfg
->
gëReWrôeP¨amSësFœg
(Ë&& (
pcSli˚
->
isIRAP
()));

1740 i‡(
	gwrôePS
)

1742 
	gm_pcEncT›
->
£tP¨amSëCh™ged
(
pcSli˚
->
gëSPS
()->
gëSPSId
(),ÖcSli˚->
gëPPS
()->
gëPPSId
());

1744 
	ga˘uÆTŸÆBôs
 +
xWrôeP¨amëîSës
(
ac˚ssUnô
, 
pcSli˚
, 
wrôePS
);

1746 i‡(
	gwrôePS
)

1749 
as£π
(
ÀadögSeiMesßges
.
em±y
());

1750 #i‡
MCTS_EXTRACTION


1751 
xCª©eIRAPLódögSEIMesßges
(
ÀadögSeiMesßges
, 
m_pcEncT›
->
gëVPS
(), 
pcSli˚
->
gëSPS
(),ÖcSli˚->
gëPPS
());

1753 
xCª©eIRAPLódögSEIMesßges
(
ÀadögSeiMesßges
, 
pcSli˚
->
gëSPS
(),ÖcSli˚->
gëPPS
());

1756 
	gm_bSeqFú°
 = 
Ál£
;

1758 i‡(
	gm_pcCfg
->
gëAc˚ssUnôDñimôî
())

1760 
xWrôeAc˚ssUnôDñimôî
(
ac˚ssUnô
, 
pcSli˚
);

1764 
	gm_buf„rögPîiodSEIPª£¡InAU
 = 
Ál£
;

1766 
xCª©ePîPi˘uªSEIMesßges
(
iGOPid
, 
ÀadögSeiMesßges
, 
√°edSeiMesßges
, 
pcSli˚
);

1769 
	gm_pcE¡r›yCodî
->
£tBô°ªam
(
NULL
);

1771 
	gpcSli˚
 = 
pcPic
->
gëSli˚
(0);

1773 i‡(
	gpcSli˚
->
gëSPS
()->
gëU£SAO
())

1775 
Boﬁ
 
	g¶i˚E«bÀd
[
MAX_NUM_COMPONENT
];

1776 
TComBôCou¡î
 
	gãmpBôCou¡î
;

1777 
	gãmpBôCou¡î
.
ª£tBôs
();

1778 
	gm_pcEncT›
->
gëRDGoOnSbacCodî
()->
£tBô°ªam
(&
ãmpBôCou¡î
);

1779 
	gm_pcSAO
->
öôRDOCabacCodî
(
m_pcEncT›
->
gëRDGoOnSbacCodî
(), 
pcSli˚
);

1780 
	gm_pcSAO
->
SAOPro˚ss
(
pcPic
, 
¶i˚E«bÀd
,ÖcPic->
gëSli˚
(0)->
gëLambdas
(),

1781 
m_pcCfg
->
gëTe°SAODißbÀAtPi˘uªLevñ
(),

1782 
m_pcCfg
->
gëSaoEncodögR©e
(),

1783 
m_pcCfg
->
gëSaoEncodögR©eChroma
(),

1784 
m_pcCfg
->
gëSaoCtuBound¨y
());

1785 
	gm_pcSAO
->
PCMLFDißbÀPro˚ss
(
pcPic
);

1786 
	gm_pcEncT›
->
gëRDGoOnSbacCodî
()->
£tBô°ªam
(
NULL
);

1789 
I¡
 
	gs
=0; s< 
	guiNumSli˚Segmíts
; s++)

1791 
	gpcPic
->
gëSli˚
(
s
)->
£tSaoE«bÀdFœg
(
CHANNEL_TYPE_LUMA
, 
¶i˚E«bÀd
[
COMPONENT_Y
]);

1792 
as£π
(
¶i˚E«bÀd
[
COMPONENT_Cb
] =¶i˚E«bÀd[
COMPONENT_Cr
]);

1793 
	gpcPic
->
gëSli˚
(
s
)->
£tSaoE«bÀdFœg
(
CHANNEL_TYPE_CHROMA
, 
¶i˚E«bÀd
[
COMPONENT_Cb
]);

1798 
	g°d
::
size_t
 
böCou¡sInNÆUnôs
 = 0;

1799 
	g°d
::
size_t
 
numByãsInV˛NÆUnôs
 = 0;

1801  
UI¡
 
	g¶i˚SegmítSèπCtuTsAddr
 = 0, 
	g¶i˚IdxCou¡
=0; sli˚SegmítSèπCtuTsAdd∏< 
	gpcPic
->
gëPicSym
()->
gëNumbîOfCtusInFøme
(); sli˚IdxCou¡++, sli˚SegmítSèπCtuTsAddr=
pcSli˚
->
gëSli˚SegmítCurEndCtuTsAddr
() )

1803 
pcSli˚
 = 
pcPic
->
gëSli˚
(
¶i˚IdxCou¡
);

1804 if(
	g¶i˚IdxCou¡
 > 0 && 
	gpcSli˚
->
gëSli˚Ty≥
()!
I_SLICE
)

1806 
pcSli˚
->
checkCﬁRefIdx
(
¶i˚IdxCou¡
, 
pcPic
);

1808 
	gpcPic
->
£tCuºSli˚Idx
(
¶i˚IdxCou¡
);

1809 
	gm_pcSli˚Encodî
->
£tSli˚Idx
(
¶i˚IdxCou¡
);

1811 
	gpcSli˚
->
£tRPS
(
pcPic
->
gëSli˚
(0)->
gëRPS
());

1812 
	gpcSli˚
->
£tRPSidx
(
pcPic
->
gëSli˚
(0)->
gëRPSidx
());

1814  
UI¡
 
	gui
 = 0 ; uò< 
	gnumSub°ªams
; ui++ )

1816 
	gsub°ªamsOut
[
ui
].
˛ór
();

1819 
	gm_pcE¡r›yCodî
->
£tE¡r›yCodî
 ( 
m_pcCavlcCodî
 );

1820 
	gm_pcE¡r›yCodî
->
ª£tE¡r›y
 ( 
pcSli˚
 );

1822 
OuçutNALUnô
 
«lu
–
pcSli˚
->
gëNÆUnôTy≥
(),ÖcSli˚->
gëTLayî
() );

1823 
	gm_pcE¡r›yCodî
->
£tBô°ªam
(&
«lu
.
m_Bô°ªam
);

1825 
	gpcSli˚
->
£tNoRa¶OuçutFœg
(
Ál£
);

1826 i‡(
	gpcSli˚
->
isIRAP
())

1828 i‡(
	gpcSli˚
->
gëNÆUnôTy≥
(Ë>
NAL_UNIT_CODED_SLICE_BLA_W_LP
 && 
pcSli˚
->gëNÆUnôTy≥(Ë<
NAL_UNIT_CODED_SLICE_IDR_N_LP
)

1830 
pcSli˚
->
£tNoRa¶OuçutFœg
(
åue
);

1834 i‡(!
	gm_bFú°
 && 
	gpcSli˚
->
isIRAP
(Ë&&ÖcSli˚->
gëNoRa¶OuçutFœg
())

1836 i‡(
	gpcSli˚
->
gëNÆUnôTy≥
(Ë=
NAL_UNIT_CODED_SLICE_CRA
)

1838 
pcSli˚
->
£tNoOuçutPri‹PicsFœg
(
åue
);

1843 
	gpcSli˚
->
£tEncCABACTabÀIdx
(
m_pcSli˚Encodî
->
gëEncCABACTabÀIdx
());

1844 #i‡
MCTS_EXTRACTION


1845 
	gícCABACTabÀIdx
 = 
pcSli˚
->
gëEncCABACTabÀIdx
();

1846 
	gícCabacInôFœg
 = (
pcSli˚
->
gëSli˚Ty≥
(Ë!
ícCABACTabÀIdx
 &&ÉncCABACTabÀIdx !
I_SLICE
Ë? 
åue
 : 
Ál£
;

1847 
	gpcSli˚
->
£tCabacInôFœg
(
ícCabacInôFœg
);

1849 
	gtmpBôsBef‹eWrôög
 = 
m_pcE¡r›yCodî
->
gëNumbîOfWrôãnBôs
();

1850 
	gm_pcE¡r›yCodî
->
ícodeSli˚Hódî
(
pcSli˚
);

1851 
	ga˘uÆHódBôs
 +–
m_pcE¡r›yCodî
->
gëNumbîOfWrôãnBôs
(Ë- 
tmpBôsBef‹eWrôög
 );

1853 
	gpcSli˚
->
£tFöÆized
(
åue
);

1855 
	gpcSli˚
->
˛órSub°ªamSizes
( );

1857 
UI¡
 
	gnumBösCoded
 = 0;

1858 
	gm_pcSli˚Encodî
->
ícodeSli˚
(
pcPic
, &(
sub°ªamsOut
[0]), 
numBösCoded
);

1859 
	gböCou¡sInNÆUnôs
+=
numBösCoded
;

1866 
	gm_pcE¡r›yCodî
->
£tE¡r›yCodî
 ( 
m_pcCavlcCodî
 );

1867 
	gm_pcE¡r›yCodî
->
£tBô°ªam
(&
«lu
.
m_Bô°ªam
);

1868 
	gm_pcE¡r›yCodî
->
ícodeTûesWPPE¡ryPoöt
–
pcSli˚
 );

1871 
TComOuçutBô°ªam
 *
	gpcOut
 = 
pcBô°ªamRedúe˘
;

1872 c⁄° 
I¡
 
	gnumZîoSub°ªamsAtSèπOfSli˚
 = 
pcPic
->
gëSub°ªamF‹CtuAddr
(
pcSli˚
->
gëSli˚SegmítCurSèπCtuTsAddr
(), 
Ál£
,ÖcSlice);

1873 c⁄° 
I¡
 
	gnumSub°ªamsToCode
 = 
pcSli˚
->
gëNumbîOfSub°ªamSizes
()+1;

1874  
UI¡
 
	gui
 = 0 ; uò< 
	gnumSub°ªamsToCode
; ui++ )

1876 
	gpcOut
->
addSub°ªam
(&(
sub°ªamsOut
[
ui
+
numZîoSub°ªamsAtSèπOfSli˚
]));

1882 
Boﬁ
 
	gbNALUAlig√dWrôãnToLi°
 = 
Ál£
;

1883 
xAâachSli˚D©aToNÆUnô
(
«lu
, 
pcBô°ªamRedúe˘
);

1884 
	gac˚ssUnô
.
push_back
(
√w
 
NALUnôEBSP
(
«lu
));

1885 
	ga˘uÆTŸÆBôs
 +
UI¡
(
ac˚ssUnô
.
back
()->
m_«lUnôD©a
.
°r
().
size
()) * 8;

1886 
	gnumByãsInV˛NÆUnôs
 +(
°d
::
size_t
)(
ac˚ssUnô
.
back
()->
m_«lUnôD©a
.
°r
().
size
());

1887 
	gbNALUAlig√dWrôãnToLi°
 = 
åue
;

1889 i‡(!
	gbNALUAlig√dWrôãnToLi°
)

1891 
	g«lu
.
	gm_Bô°ªam
.
wrôeAlignZîo
();

1892 
	gac˚ssUnô
.
push_back
(
√w
 
NALUnôEBSP
(
«lu
));

1895 if––
	gm_pcCfg
->
gëPi˘uªTimögSEIE«bÀd
(Ë|| m_pcCfg->
gëDecodögUnôInfoSEIE«bÀd
() ) &&

1896 –
	gpcSli˚
->
gëSPS
()->
gëVuiP¨amëîsPª£¡Fœg
() ) &&

1897 ––
	gpcSli˚
->
gëSPS
()->
gëVuiP¨amëîs
()->
gëHrdP¨amëîs
()->
gëNÆHrdP¨amëîsPª£¡Fœg
() )

1898 || ( 
	gpcSli˚
->
gëSPS
()->
gëVuiP¨amëîs
()->
gëHrdP¨amëîs
()->
gëV˛HrdP¨amëîsPª£¡Fœg
() ) ) &&

1899 –
	gpcSli˚
->
gëSPS
()->
gëVuiP¨amëîs
()->
gëHrdP¨amëîs
()->
gëSubPicCpbP¨amsPª£¡Fœg
() ) )

1901 
UI¡
 
	gnumNÆus
 = 0;

1902 
UI¡
 
	gnumRBSPByãs
 = 0;

1903 
	gAc˚ssUnô
::
c⁄°_ôî©‹
 
ô
 = 
ac˚ssUnô
.
begö
(); 
	gô
 !ac˚ssUnô.
íd
(); it++)

1905 
	gnumRBSPByãs
 +
UI¡
((*
ô
)->
m_«lUnôD©a
.
°r
().
size
());

1906 
	gnumNÆus
 ++;

1908 
	gduD©a
.
push_back
(
DUD©a
());

1909 
	gduD©a
.
back
().
	gaccumBôsDU
 = ( 
numRBSPByãs
 << 3 );

1910 
	gduD©a
.
back
().
	gaccumNÆsDU
 = 
numNÆus
;

1915 
ˇbac_zîo_w‹d_∑ddög
(
pcSli˚
, 
pcPic
, 
böCou¡sInNÆUnôs
, 
numByãsInV˛NÆUnôs
, 
ac˚ssUnô
.
back
()->
m_«lUnôD©a
, 
m_pcCfg
->
gëCabacZîoW‹dPaddögE«bÀd
());

1917 
	gpcPic
->
com¥essMŸi⁄
();

1920 
DoubÀ
 
	gdEncTime
 = (DoubÀ)(
˛ock
()-
iBef‹eTime
Ë/ 
CLOCKS_PER_SEC
;

1922 
	g°d
::
°rög
 
dige°Så
;

1923 i‡(
	gm_pcCfg
->
gëDecodedPi˘uªHashSEITy≥
()!=
HASHTYPE_NONE
)

1925 
SEIDecodedPi˘uªHash
 *
decodedPi˘uªHashSei
 = 
√w
 SEIDecodedPictureHash();

1926 
	gm_£iEncodî
.
öôDecodedPi˘uªHashSEI
(
decodedPi˘uªHashSei
, 
pcPic
, 
dige°Så
, 
pcSli˚
->
gëSPS
()->
gëBôDïths
());

1927 
	gåaûögSeiMesßges
.
push_back
(
decodedPi˘uªHashSei
);

1930 
	gm_pcCfg
->
£tEncodedFœg
(
iGOPid
, 
åue
);

1932 
DoubÀ
 
	gPSNR_Y
;

1934 
xCÆcuœãAddPSNRs
–
isFõld
, 
isTff
, 
iGOPid
, 
pcPic
, 
ac˚ssUnô
, 
rcLi°Pic
, 
dEncTime
, 
ù_c⁄vîsi⁄
, 
¢r_c⁄vîsi⁄
, 
ouçutLogCål
, &
PSNR_Y
 );

1937 if–
	gm_pcCfg
->
gëSEIGªíMëad©aInfoSEIE«bÀ
(Ë&& 
	gpcSli˚
->
gëPOC
(Ë=–
m_pcCfg
->
gëFømesToBeEncoded
() - 1 ) )

1939 
SEIGªíMëad©aInfo
 *
£iGªíMëad©aInfo
 = 
√w
 SEIGreenMetadataInfo;

1940 
	gm_£iEncodî
.
öôSEIGªíMëad©aInfo
(
£iGªíMëad©aInfo
, (
UI¡
)(
PSNR_Y
 * 100 + 0.5));

1941 
	gåaûögSeiMesßges
.
push_back
(
£iGªíMëad©aInfo
);

1944 
xWrôeTøûögSEIMesßges
(
åaûögSeiMesßges
, 
ac˚ssUnô
, 
pcSli˚
->
gëTLayî
(),ÖcSli˚->
gëSPS
());

1946 
¥ötHash
(
m_pcCfg
->
gëDecodedPi˘uªHashSEITy≥
(), 
dige°Så
);

1948 i‡–
	gm_pcCfg
->
gëU£R©eCål
() )

1950 
DoubÀ
 
	gavgQP
 = 
m_pcR©eCål
->
gëRCPic
()->
ˇlAvîageQP
();

1951 
DoubÀ
 
	gavgLambda
 = 
m_pcR©eCål
->
gëRCPic
()->
ˇlAvîageLambda
();

1952 i‡–
	gavgLambda
 < 0.0 )

1954 
	gavgLambda
 = 
œmbda
;

1957 
	gm_pcR©eCål
->
gëRCPic
()->
upd©eA·îPi˘uª
–
a˘uÆHódBôs
, 
a˘uÆTŸÆBôs
, 
avgQP
, 
avgLambda
, 
pcSli˚
->
gëSli˚Ty≥
());

1958 
	gm_pcR©eCål
->
gëRCPic
()->
addToPi˘uªLsô
–
m_pcR©eCål
->
gëPicLi°
() );

1960 
	gm_pcR©eCål
->
gëRCSeq
()->
upd©eA·îPic
–
a˘uÆTŸÆBôs
 );

1961 i‡–
	gpcSli˚
->
gëSli˚Ty≥
(Ë!
I_SLICE
 )

1963 
m_pcR©eCål
->
gëRCGOP
()->
upd©eA·îPi˘uª
–
a˘uÆTŸÆBôs
 );

1967 
	gm_pcR©eCål
->
gëRCGOP
()->
upd©eA·îPi˘uª
–
e°im©edBôs
 );

1969 i‡(
	gm_pcR©eCål
->
gëCpbS©uøti⁄E«bÀd
())

1971 
	gm_pcR©eCål
->
upd©eCpbSèã
(
a˘uÆTŸÆBôs
);

1972 
¥ötf
(" [CPB %6d bôs]", 
m_pcR©eCål
->
gëCpbSèã
());

1976 
xCª©ePi˘uªTimögSEI
(
m_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
()?
effFõldIRAPM≠
.
GëIRAPGOPid
():0, 
ÀadögSeiMesßges
, 
√°edSeiMesßges
, 
duInfoSeiMesßges
, 
pcSli˚
, 
isFõld
, 
duD©a
);

1977 i‡(
	gm_pcCfg
->
gëSˇœbÀNe°ögSEIE«bÀd
())

1979 
xCª©eSˇœbÀNe°ögSEI
 (
ÀadögSeiMesßges
, 
√°edSeiMesßges
);

1981 
xWrôeLódögSEIMesßges
(
ÀadögSeiMesßges
, 
duInfoSeiMesßges
, 
ac˚ssUnô
, 
pcSli˚
->
gëTLayî
(),ÖcSli˚->
gëSPS
(), 
duD©a
);

1982 
xWrôeDuSEIMesßges
(
duInfoSeiMesßges
, 
ac˚ssUnô
, 
pcSli˚
->
gëTLayî
(),ÖcSli˚->
gëSPS
(), 
duD©a
);

1984 
	gpcPic
->
gëPicYuvRec
()->
c›yToPic
(
pcPicYuvRecOut
);

1986 
	gpcPic
->
£tRec⁄M¨k
 ( 
åue
 );

1987 
	gm_bFú°
 = 
Ál£
;

1988 
	gm_iNumPicCoded
++;

1989 
	gm_tŸÆCoded
 ++;

1991 
¥ötf
("\n");

1992 
fÊush
(
°dout
);

1994 i‡(
	gm_pcCfg
->
gëEfficõ¡FõldIRAPE«bÀd
())

1996 
	giGOPid
=
effFõldIRAPM≠
.
ª°‹eGOPid
(
iGOPid
);

1998 #i‡
REDUCED_ENCODER_MEMORY


2000 
	gpcPic
->
ªÀa£Rec⁄°ru˘i⁄I¡îmedüãD©a
();

2001 i‡(!
	gisFõld
)

2003 
	gpcPic
->
ªÀa£EncodîSour˚ImageD©a
();

2009 
dñëe
 
	gpcBô°ªamRedúe˘
;

2011 
as£π
 ( (
m_iNumPicCoded
 =
iNumPicRcvd
) );

2014 
Void
 
	gTEncGOP
::
	$¥ötOutSumm¨y
(
UI¡
 
uiNumAŒPicCoded
, 
Boﬁ
 
isFõld
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, c⁄° 
BôDïths
 &
bôDïths
)

2016 
	`as£π
 (
uiNumAŒPicCoded
 =
m_gcA«lyzeAŒ
.
	`gëNumPic
());

2020 c⁄° 
I¡
 
øãMu…ùlõr
=(
isFõld
?2:1);

2021 
m_gcA«lyzeAŒ
.
	`£tFrmR©e
–
m_pcCfg
->
	`gëFømeR©e
()*
øãMu…ùlõr
 / (
DoubÀ
)m_pcCfg->
	`gëTemp‹ÆSubßm∂eR©io
());

2022 
m_gcA«lyzeI
.
	`£tFrmR©e
–
m_pcCfg
->
	`gëFømeR©e
()*
øãMu…ùlõr
 / (
DoubÀ
)m_pcCfg->
	`gëTemp‹ÆSubßm∂eR©io
());

2023 
m_gcA«lyzeP
.
	`£tFrmR©e
–
m_pcCfg
->
	`gëFømeR©e
()*
øãMu…ùlõr
 / (
DoubÀ
)m_pcCfg->
	`gëTemp‹ÆSubßm∂eR©io
());

2024 
m_gcA«lyzeB
.
	`£tFrmR©e
–
m_pcCfg
->
	`gëFømeR©e
()*
øãMu…ùlõr
 / (
DoubÀ
)m_pcCfg->
	`gëTemp‹ÆSubßm∂eR©io
());

2025 c⁄° 
ChromaF‹m©
 
chFmt
 = 
m_pcCfg
->
	`gëChromaF‹m©Idc
();

2028 
	`¥ötf
( "\n\nSUMMARY --------------------------------------------------------\n" );

2029 
m_gcA«lyzeAŒ
.
	`¥ötOut
('a', 
chFmt
, 
ouçutLogCål
, 
bôDïths
);

2031 
	`¥ötf
( "\n\nI Slices--------------------------------------------------------\n" );

2032 
m_gcA«lyzeI
.
	`¥ötOut
('i', 
chFmt
, 
ouçutLogCål
, 
bôDïths
);

2034 
	`¥ötf
( "\n\nP Slices--------------------------------------------------------\n" );

2035 
m_gcA«lyzeP
.
	`¥ötOut
('p', 
chFmt
, 
ouçutLogCål
, 
bôDïths
);

2037 
	`¥ötf
( "\n\nB Slices--------------------------------------------------------\n" );

2038 
m_gcA«lyzeB
.
	`¥ötOut
('b', 
chFmt
, 
ouçutLogCål
, 
bôDïths
);

2040 i‡(!
m_pcCfg
->
	`gëSumm¨yOutFûíame
().
	`em±y
())

2042 
m_gcA«lyzeAŒ
.
	`¥ötSumm¨y
(
chFmt
, 
ouçutLogCål
, 
bôDïths
, 
m_pcCfg
->
	`gëSumm¨yOutFûíame
());

2045 i‡(!
m_pcCfg
->
	`gëSumm¨yPicFûíameBa£
().
	`em±y
())

2047 
m_gcA«lyzeI
.
	`¥ötSumm¨y
(
chFmt
, 
ouçutLogCål
, 
bôDïths
, 
m_pcCfg
->
	`gëSumm¨yPicFûíameBa£
()+"I.txt");

2048 
m_gcA«lyzeP
.
	`¥ötSumm¨y
(
chFmt
, 
ouçutLogCål
, 
bôDïths
, 
m_pcCfg
->
	`gëSumm¨yPicFûíameBa£
()+"P.txt");

2049 
m_gcA«lyzeB
.
	`¥ötSumm¨y
(
chFmt
, 
ouçutLogCål
, 
bôDïths
, 
m_pcCfg
->
	`gëSumm¨yPicFûíameBa£
()+"B.txt");

2052 if(
isFõld
)

2055 
m_gcA«lyzeAŒ_ö
.
	`£tFrmR©e
–
m_pcCfg
->
	`gëFømeR©e
(Ë/ (
DoubÀ
)m_pcCfg->
	`gëTemp‹ÆSubßm∂eR©io
());

2056 
m_gcA«lyzeAŒ_ö
.
	`£tBôs
(
m_gcA«lyzeAŒ
.
	`gëBôs
());

2059 
	`¥ötf
( "\n\nSUMMARY INTERLACED ---------------------------------------------\n" );

2060 
m_gcA«lyzeAŒ_ö
.
	`¥ötOut
('a', 
chFmt
, 
ouçutLogCål
, 
bôDïths
);

2062 i‡(!
m_pcCfg
->
	`gëSumm¨yOutFûíame
().
	`em±y
())

2064 
m_gcA«lyzeAŒ_ö
.
	`¥ötSumm¨y
(
chFmt
, 
ouçutLogCål
, 
bôDïths
, 
m_pcCfg
->
	`gëSumm¨yOutFûíame
());

2068 
	`¥ötf
("\nRVM: %.3lf\n" , 
	`xCÆcuœãRVM
());

2069 
	}
}

2071 
Void
 
	gTEncGOP
::
	$¥eLo›FûãrPicAŒ
–
TComPic
* 
pcPic
, 
UI¡64
& 
ruiDi°
 )

2073 
Boﬁ
 
bCÆcDi°
 = 
Ál£
;

2074 
m_pcLo›Fûãr
->
	`£tCfg
(
m_pcCfg
->
	`gëLFCrossTûeBound¨yFœg
());

2075 
m_pcLo›Fûãr
->
	`lo›FûãrPic
–
pcPic
 );

2077 i‡(!
bCÆcDi°
)

2079 
ruiDi°
 = 
	`xFödDi°‹ti⁄Føme
(
pcPic
->
	`gëPicYuvOrg
(),ÖcPic->
	`gëPicYuvRec
(),ÖcPic->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïths
());

2081 
	}
}

2088 
Void
 
	gTEncGOP
::
	$xInôGOP
–
I¡
 
iPOCLa°
, I¡ 
iNumPicRcvd
, 
Boﬁ
 
isFõld
 )

2090 
	`as£π
–
iNumPicRcvd
 > 0 );

2092 i‡––
isFõld
 && (
iPOCLa°
 == 0 || iPOCLast == 1) ) || (!isField && (iPOCLast == 0)) )

2094 
m_iG›Size
 = 1;

2098 
m_iG›Size
 = 
m_pcCfg
->
	`gëGOPSize
();

2100 
	`as£π
 (
m_iG›Size
 > 0);

2103 
	}
}

2106 
Void
 
	gTEncGOP
::
xGëBuf„r
–
TComLi°
<
TComPic
*>& 
rcLi°Pic
,

2107 
TComLi°
<
TComPicYuv
*>& 
rcLi°PicYuvRecOut
,

2108 
I¡
 
iNumPicRcvd
,

2109 
I¡
 
iTimeOff£t
,

2110 
TComPic
*& 
ΩcPic
,

2111 
TComPicYuv
*& 
ΩcPicYuvRecOut
,

2112 
I¡
 
pocCuº
,

2113 
Boﬁ
 
isFõld
)

2115 
I¡
 
	gi
;

2117 
	gTComLi°
<
	gTComPicYuv
*>::
ôî©‹
 
ôîPicYuvRec
 = 
rcLi°PicYuvRecOut
.
íd
();

2119 i‡(
	gisFõld
 && 
	gpocCuº
 > 1 && 
	gm_iG›Size
!=1)

2121 
iTimeOff£t
--;

2124  
	gi
 = 0; i < (
	giNumPicRcvd
 - 
	giTimeOff£t
 + 1); i++ )

2126 
	gôîPicYuvRec
--;

2129 
	gΩcPicYuvRecOut
 = *(
ôîPicYuvRec
);

2132 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

2133 
	gôîPic
 !
rcLi°Pic
.
íd
())

2135 
ΩcPic
 = *(
ôîPic
);

2136 
	gΩcPic
->
£tCuºSli˚Idx
(0);

2137 i‡(
	gΩcPic
->
gëPOC
(Ë=
pocCuº
)

2141 
	gôîPic
++;

2144 
as£π
 (
ΩcPic
 !
NULL
);

2145 
as£π
 (
ΩcPic
->
gëPOC
(Ë=
pocCuº
);

2150 
UI¡64
 
	gTEncGOP
::
	$xFödDi°‹ti⁄Føme
 (
TComPicYuv
* 
pcPic0
, TComPicYuv* 
pcPic1
, c⁄° 
BôDïths
 &
bôDïths
)

2152 
UI¡64
 
uiTŸÆDiff
 = 0;

2154 
I¡
 
ch™
=0; ch™<
pcPic0
 ->
	`gëNumbîVÆidComp⁄íts
(); chan++)

2156 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2157 
Pñ
* 
pSrc0
 = 
pcPic0
 ->
	`gëAddr
(
ch
);

2158 
Pñ
* 
pSrc1
 = 
pcPic1
 ->
	`gëAddr
(
ch
);

2159 
UI¡
 
uiShi·
 = 2 * 
	`DISTORTION_PRECISION_ADJUSTMENT
(
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
ch
)]-8);

2161 c⁄° 
I¡
 
iSåide
 = 
pcPic0
->
	`gëSåide
(
ch
);

2162 c⁄° 
I¡
 
iWidth
 = 
pcPic0
->
	`gëWidth
(
ch
);

2163 c⁄° 
I¡
 
iHeight
 = 
pcPic0
->
	`gëHeight
(
ch
);

2165 
I¡
 
y
 = 0; y < 
iHeight
; y++ )

2167 
I¡
 
x
 = 0; x < 
iWidth
; x++ )

2169 
I¡îmedüã_I¡
 
iTemp
 = 
pSrc0
[
x
] - 
pSrc1
[x];

2170 
uiTŸÆDiff
 +
	`UI¡64
((
iTemp
*iTempË>> 
uiShi·
);

2172 
pSrc0
 +
iSåide
;

2173 
pSrc1
 +
iSåide
;

2177  
uiTŸÆDiff
;

2178 
	}
}

2180 
Void
 
	gTEncGOP
::
xCÆcuœãAddPSNRs
–c⁄° 
Boﬁ
 
isFõld
, c⁄° Boﬁ 
isFõldT›FõldFú°
, c⁄° 
I¡
 
iGOPid
, 
TComPic
* 
pcPic
, c⁄° 
Ac˚ssUnô
&
ac˚ssUnô
, 
TComLi°
<TComPic*> &
rcLi°Pic
, c⁄° 
DoubÀ
 
dEncTime
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ù_c⁄vîsi⁄
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢r_c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, DoubÀ* 
PSNR_Y
 )

2182 
xCÆcuœãAddPSNR
–
pcPic
,ÖcPic->
gëPicYuvRec
(), 
ac˚ssUnô
, 
dEncTime
, 
ù_c⁄vîsi⁄
, 
¢r_c⁄vîsi⁄
, 
ouçutLogCål
, 
PSNR_Y
 );

2184 if(
	gisFõld
)

2186 
Boﬁ
 
	gbŸhFõldsAªEncoded
 = 
Ál£
;

2187 
I¡
 
	gc‹ª•⁄dögFõldPOC
 = 
pcPic
->
gëPOC
();

2188 
I¡
 
	gcuºítPicGOPPoc
 = 
m_pcCfg
->
gëGOPE¡ry
(
iGOPid
).
m_POC
;

2189 if(
	gpcPic
->
gëPOC
() == 0)

2194 
bŸhFõldsAªEncoded
 = 
Ál£
;

2196 if(
	gpcPic
->
gëPOC
() == 1)

2199 
c‹ª•⁄dögFõldPOC
 = 0;

2200 
	gbŸhFõldsAªEncoded
 = 
åue
;

2204 if(
	gpcPic
->
gëPOC
()%2 == 1)

2206 
c‹ª•⁄dögFõldPOC
 -= 1;

2207 
	gcuºítPicGOPPoc
 -= 1;

2211 
	gc‹ª•⁄dögFõldPOC
 += 1;

2212 
	gcuºítPicGOPPoc
 += 1;

2214 
I¡
 
	gi
 = 0; i < 
	gm_iG›Size
; i ++)

2216 if(
	gm_pcCfg
->
gëGOPE¡ry
(
i
).
	gm_POC
 =
cuºítPicGOPPoc
)

2218 
bŸhFõldsAªEncoded
 = 
m_pcCfg
->
gëGOPE¡ry
(
i
).
m_isEncoded
;

2224 if(
	gbŸhFõldsAªEncoded
)

2227 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

2228 (*
	gôîPic
)->
gëPOC
(Ë!
c‹ª•⁄dögFõldPOC
)

2230 
ôîPic
 ++;

2232 
TComPic
* 
	gc‹ª•⁄dögFõldPic
 = *(
ôîPic
);

2234 if–(
	gpcPic
->
isT›Fõld
(Ë&& 
	gisFõldT›FõldFú°
) || (!pcPic->isTopField() && !isFieldTopFieldFirst))

2236 
xCÆcuœãI¡îœ˚dAddPSNR
(
pcPic
, 
c‹ª•⁄dögFõldPic
,ÖcPic->
gëPicYuvRec
(), c‹ª•⁄dögFõldPic->gëPicYuvRec(), 
¢r_c⁄vîsi⁄
, 
ouçutLogCål
, 
PSNR_Y
 );

2240 
xCÆcuœãI¡îœ˚dAddPSNR
(
c‹ª•⁄dögFõldPic
, 
pcPic
, c‹ª•⁄dögFõldPic->
gëPicYuvRec
(),ÖcPic->gëPicYuvRec(), 
¢r_c⁄vîsi⁄
, 
ouçutLogCål
, 
PSNR_Y
 );

2246 
Void
 
	gTEncGOP
::
	$xCÆcuœãAddPSNR
–
TComPic
* 
pcPic
, 
TComPicYuv
* 
pcPicD
, c⁄° 
Ac˚ssUnô
& 
ac˚ssUnô
, 
DoubÀ
 
dEncTime
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ù_c⁄vîsi⁄
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢r_c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, DoubÀ* 
PSNR_Y
 )

2248 
TEncA«lyze
::
Resu…D©a
 
ªsu…
;

2252 
TComPicYuv
 
cscd
;

2254 i‡(
¢r_c⁄vîsi⁄
!=
IPCOLOURSPACE_UNCHANGED
)

2256 
cscd
.
	`¸óãWôhoutCUInfo
(
pcPicD
->
	`gëWidth
(
COMPONENT_Y
),ÖcPicD->
	`gëHeight
(COMPONENT_Y),ÖcPicD->
	`gëChromaF‹m©
() );

2257 
TVideoIOYuv
::
	`CﬁourS∑˚C⁄vît
(*
pcPicD
, 
cscd
, 
¢r_c⁄vîsi⁄
, 
Ál£
);

2259 
TComPicYuv
 &
picd
=(
¢r_c⁄vîsi⁄
==
IPCOLOURSPACE_UNCHANGED
)?*
pcPicD
 : 
cscd
;

2263 
TComPicYuv
 
tmpTrueOrgInI¡î«lM≠
;

2264 c⁄° 
TComPicYuv
 *
pOrgPicYuv
=0;

2266 c⁄° 
boﬁ
 
bOrgD©aHasBìnAdju°ed
=
m_pcCfg
->
	`gëG›Ba£dTemp‹ÆFûãrE«bÀd
();

2267 i‡(
¢r_c⁄vîsi⁄
==
IPCOLOURSPACE_UNCHANGED
)

2270 i‡(
bOrgD©aHasBìnAdju°ed
)

2273 
tmpTrueOrgInI¡î«lM≠
.
	`¸óãWôhoutCUInfo
(
pcPicD
->
	`gëWidth
(
COMPONENT_Y
),ÖcPicD->
	`gëHeight
(COMPONENT_Y),ÖcPicD->
	`gëChromaF‹m©
());

2274 
TVideoIOYuv
::
	`CﬁourS∑˚C⁄vît
(*
pcPic
->
	`gëPicYuvTrueOrg
(), 
tmpTrueOrgInI¡î«lM≠
, 
ù_c⁄vîsi⁄
, 
åue
);

2275 
pOrgPicYuv
 = &
tmpTrueOrgInI¡î«lM≠
;

2280 
pOrgPicYuv
 = 
pcPic
->
	`gëPicYuvOrg
();

2286 
pOrgPicYuv
 = 
pcPic
 ->
	`gëPicYuvTrueOrg
();

2292 i‡(
ouçutLogCål
.
¥ötXPSNR
 && 
pcPicD
->
	`gëChromaF‹m©
(Ë!
CHROMA_400
)

2294 c⁄° 
Pñ
* 
pOrg
[
MAX_NUM_COMPONENT
];

2295 
DoubÀ
 
dWeightPñ
[
MAX_NUM_COMPONENT
];

2296 
I¡
 
iWeightSize
[
MAX_NUM_COMPONENT
] = {1, 1, 1};

2297 c⁄° 
Pñ
* 
pRec
[
MAX_NUM_COMPONENT
];

2298 
I¡
 
iOrgSåide
[
MAX_NUM_COMPONENT
], 
iRecSåide
[MAX_NUM_COMPONENT];

2299 
I¡
 
iWidth
[
MAX_NUM_COMPONENT
], 
iHeight
[MAX_NUM_COMPONENT], 
iSize
[MAX_NUM_COMPONENT];

2300 
UI¡64
 
uiSSDãmp
[
MAX_NUM_COMPONENT
];

2301 
UI¡
 
uiShi·Width
[
MAX_NUM_COMPONENT
], 
uiShi·Height
[MAX_NUM_COMPONENT];

2302 
I¡îmedüã_I¡
 
iDiff
;

2304 
I¡
 
ch™
=0; ch™<
pcPicD
->
	`gëNumbîVÆidComp⁄íts
(); chan++)

2306 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2308 
iOrgSåide
[
ch
] = 
pOrgPicYuv
->
	`gëSåide
(ch);

2309 
iRecSåide
[
ch
] = 
picd
.
	`gëSåide
(ch);

2310 
iWidth
[
ch
] = 
pcPicD
->
	`gëWidth
 (chË- (
m_pcEncT›
->
	`gëPad
(0Ë>> 
pcPic
->
	`gëComp⁄ítSˇÀX
(ch));

2311 
iHeight
[
ch
] = 
pcPicD
->
	`gëHeight
(chË- ((
m_pcEncT›
->
	`gëPad
(1Ë>> (
pcPic
->
	`isFõld
()?1:0)Ë>>ÖcPic->
	`gëComp⁄ítSˇÀY
(ch));

2312 
iSize
[
ch
] = 
iWidth
[ch]*
iHeight
[ch];

2313 
uiSSDãmp
[
ch
] = 0;

2314 
uiShi·Width
[
ch
] = (ch =
COMPONENT_Y
 || 
pcPicD
->
	`gëChromaF‹m©
(Ë=
CHROMA_444
) ? 0 : 1;

2315 
uiShi·Height
[
ch
] = (ch =
COMPONENT_Y
 || 
pcPicD
->
	`gëChromaF‹m©
(Ë=
CHROMA_444
 ||ÖcPicD->gëChromaF‹m©(Ë=
CHROMA_422
) ? 0 : 1;

2316 
dWeightPñ
[
ch
] = 
m_pcCfg
->
	`gëXPSNRWeight
(ch);

2317 
pOrg
[
ch
] = 
pOrgPicYuv
->
	`gëAddr
(ch);

2318 
pRec
[
ch
] = 
picd
.
	`gëAddr
(ch);

2321 
DoubÀ
 
dSSDãmp
=0;

2322 
°d
::
ve˘‹
<
DoubÀ
> 
	`vecSSEChroma
(
iSize
[
COMPONENT_Cb
], 
	`DoubÀ
(0));

2323 
I¡
 
y
 = 0, 
t
0; y < 
iHeight
[
COMPONENT_Cb
]; y++ )

2325 
I¡
 
x
 = 0; x < 
iWidth
[
COMPONENT_Cb
]; x++, 
t
++)

2327 
UI¡64
 
uiSE_cb
, 
uiSE_¸
;

2328 
iDiff
 = (
I¡îmedüã_I¡
)–(I¡îmedüã_I¡)
pOrg
[
COMPONENT_Cb
][
x
] - (I¡îmedüã_I¡)
pRec
[COMPONENT_Cb][x] );

2329 
uiSE_cb
 = 
iDiff
 * iDiff;

2330 
iDiff
 = (
I¡îmedüã_I¡
)–(I¡îmedüã_I¡)
pOrg
[
COMPONENT_Cr
][
x
] - (I¡îmedüã_I¡)
pRec
[COMPONENT_Cr][x] );

2331 
uiSE_¸
 = 
iDiff
 * iDiff;

2332 
uiSSDãmp
[
COMPONENT_Cb
] +
uiSE_cb
;

2333 
uiSSDãmp
[
COMPONENT_Cr
] +
uiSE_¸
;

2334 
vecSSEChroma
[
t
] = 
dWeightPñ
[
COMPONENT_Cb
] * (
DoubÀ
Ë
uiSE_cb
 + dWeightPñ[
COMPONENT_Cr
] * (DoubÀË
uiSE_¸
;

2336 
pOrg
[
COMPONENT_Cb
] +
iOrgSåide
[COMPONENT_Cb];

2337 
pRec
[
COMPONENT_Cb
] +
iRecSåide
[COMPONENT_Cb];

2338 
pOrg
[
COMPONENT_Cr
] +
iOrgSåide
[COMPONENT_Cr];

2339 
pRec
[
COMPONENT_Cr
] +
iRecSåide
[COMPONENT_Cr];

2342 
I¡
 
y
 = 0; y < 
iHeight
[
COMPONENT_Y
]; y++ )

2344 
UI¡
 
y_°ï_chroma
 = (
y
 >> 
uiShi·Height
[
COMPONENT_Cb
]Ë* 
iWidth
[COMPONENT_Cb];

2345 
I¡
 
x
 = 0; x < 
iWidth
[
COMPONENT_Y
]; x++)

2347 
UI¡64
 
uiSE_y
;

2348 
UI¡
 
x_°ï_chroma
 = (
x
 >> 
uiShi·Width
[
COMPONENT_Cb
]);

2349 
iDiff
 = (
I¡îmedüã_I¡
)–(I¡îmedüã_I¡)
pOrg
[
COMPONENT_Y
][
x
] - (I¡îmedüã_I¡)
pRec
[COMPONENT_Y][x] );

2350 
uiSE_y
 = 
iDiff
 * iDiff;

2351 
uiSSDãmp
[
COMPONENT_Y
] +
uiSE_y
;

2352 
dSSDãmp
 +
	`sqπ
(
dWeightPñ
[
COMPONENT_Y
] * (
DoubÀ
Ë
uiSE_y
 + 
vecSSEChroma
[
y_°ï_chroma
+
x_°ï_chroma
]);

2354 
pOrg
[
COMPONENT_Y
] +
iOrgSåide
[COMPONENT_Y];

2355 
pRec
[
COMPONENT_Y
] +
iRecSåide
[COMPONENT_Y];

2358 
DoubÀ
 
fWVÆue
 = 0;

2359  
I¡
 
ch™
 = 0; ch™<
pcPicD
->
	`gëNumbîVÆidComp⁄íts
(); chan++)

2361 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2362 c⁄° 
UI¡
 
maxvÆ
 = 255 << (
pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïth
(
	`toCh™√lTy≥
(
ch
)) - 8);

2363 c⁄° 
DoubÀ
 
fRefVÆue
 = (DoubÀË
maxvÆ
 * maxvÆ * 
iSize
[
ch
];

2364 
ªsu…
.
p¢r
[
ch
] = ( 
uiSSDãmp
[ch] ? 10.0 * 
	`log10
–
fRefVÆue
 / (
DoubÀ
)uiSSDtemp[ch] ) : 999.99 );

2365 
ªsu…
.
MSEyuv‰ame
[
ch
] = (
DoubÀ
)
uiSSDãmp
[ch]/(
iSize
[ch]);

2366 
fWVÆue
 +(
DoubÀ
Ë
iWeightSize
[
ch
] * (DoubÀË
iSize
[ch];

2368 c⁄° 
DoubÀ
 
maxvÆ
 = 255 << (
pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïth
(
	`toCh™√lTy≥
(
COMPONENT_Y
)) - 8);

2369 
fWVÆue
 = 
	`DoubÀ
–
maxvÆ
 * fWValue);

2370 
ªsu…
.
xp¢r
 = 
dSSDãmp
 ? 20.0 * 
	`log10
–
fWVÆue
 / dSSDtemp) : 999.99;

2374 
I¡
 
ch™
=0; ch™<
pcPicD
->
	`gëNumbîVÆidComp⁄íts
(); chan++)

2376 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2377 c⁄° 
Pñ
* 
pOrg
 = 
pOrgPicYuv
->
	`gëAddr
(
ch
);

2378 c⁄° 
I¡
 
iOrgSåide
 = 
pOrgPicYuv
->
	`gëSåide
(
ch
);

2379 
Pñ
* 
pRec
 = 
picd
.
	`gëAddr
(
ch
);

2380 c⁄° 
I¡
 
iRecSåide
 = 
picd
.
	`gëSåide
(
ch
);

2381 c⁄° 
I¡
 
iWidth
 = 
pcPicD
->
	`gëWidth
 (
ch
Ë- (
m_pcEncT›
->
	`gëPad
(0Ë>> 
pcPic
->
	`gëComp⁄ítSˇÀX
(ch));

2382 c⁄° 
I¡
 
iHeight
 = 
pcPicD
->
	`gëHeight
(
ch
Ë- ((
m_pcEncT›
->
	`gëPad
(1Ë>> (
pcPic
->
	`isFõld
()?1:0)Ë>>ÖcPic->
	`gëComp⁄ítSˇÀY
(ch));

2384 
I¡
 
iSize
 = 
iWidth
*
iHeight
;

2386 
UI¡64
 
uiSSDãmp
=0;

2387 
I¡
 
y
 = 0; y < 
iHeight
; y++ )

2389 
I¡
 
x
 = 0; x < 
iWidth
; x++ )

2391 
I¡îmedüã_I¡
 
iDiff
 = (I¡îmedüã_I¡)–
pOrg
[
x
] - 
pRec
[x] );

2392 
uiSSDãmp
 +
iDiff
 * iDiff;

2394 
pOrg
 +
iOrgSåide
;

2395 
pRec
 +
iRecSåide
;

2397 c⁄° 
I¡
 
maxvÆ
 = 255 << (
pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïth
(
	`toCh™√lTy≥
(
ch
)) - 8);

2398 c⁄° 
DoubÀ
 
fRefVÆue
 = (DoubÀË
maxvÆ
 * maxvÆ * 
iSize
;

2399 
ªsu…
.
p¢r
[
ch
] = ( 
uiSSDãmp
 ? 10.0 * 
	`log10
–
fRefVÆue
 / (
DoubÀ
)uiSSDtemp ) : 999.99 );

2400 
ªsu…
.
MSEyuv‰ame
[
ch
] = (
DoubÀ
)
uiSSDãmp
/(
iSize
);

2403 #i‡
EXTENSION_360_VIDEO


2404 
m_ext360
.
	`ˇlcuœãPSNRs
(
pcPic
);

2408 i‡(
ouçutLogCål
.
¥ötMSSSIM
)

2410 
I¡
 
ch™
=0; ch™<
pcPicD
->
	`gëNumbîVÆidComp⁄íts
(); chan++)

2412 c⁄° 
Comp⁄ítID
 
ch
 = 
	`Comp⁄ítID
(
ch™
);

2413 c⁄° 
Pñ
* 
pOrg
 = 
pOrgPicYuv
->
	`gëAddr
(
ch
);

2414 c⁄° 
I¡
 
‹gSåide
 = 
pOrgPicYuv
->
	`gëSåide
(
ch
);

2415 c⁄° 
Pñ
* 
pRec
 = 
picd
.
	`gëAddr
(
ch
);

2416 c⁄° 
I¡
 
ªcSåide
 = 
picd
.
	`gëSåide
(
ch
);

2417 c⁄° 
I¡
 
width
 = 
pcPicD
->
	`gëWidth
 (
ch
Ë- (
m_pcEncT›
->
	`gëPad
(0Ë>> 
pcPic
->
	`gëComp⁄ítSˇÀX
(ch));

2418 c⁄° 
I¡
 
height
 = 
pcPicD
->
	`gëHeight
(
ch
Ë- ((
m_pcEncT›
->
	`gëPad
(1Ë>> (
pcPic
->
	`isFõld
()?1:0)Ë>>ÖcPic->
	`gëComp⁄ítSˇÀY
(ch));

2419 c⁄° 
UI¡
 
bôDïth
 = 
pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïth
(
	`toCh™√lTy≥
(
ch
));

2421 
ªsu…
.
MSSSIM
[
ch
] = 
	`xCÆcuœãMSSSIM
 (
pOrg
, 
‹gSåide
, 
pRec
, 
ªcSåide
, 
width
, 
height
, 
bôDïth
);

2428 
UI¡
 
numRBSPByãs
 = 0;

2429 
Ac˚ssUnô
::
c⁄°_ôî©‹
 
ô
 = 
ac˚ssUnô
.
	`begö
(); ià!ac˚ssUnô.
	`íd
(); it++)

2431 
UI¡
 
numRBSPByãs_«l
 = 
	`UI¡
((*
ô
)->
m_«lUnôD©a
.
	`°r
().
	`size
());

2432 i‡(
m_pcCfg
->
	`gëSumm¨yVîbo£√ss
() > 0)

2434 
	`¥ötf
("*** %6†numByãsInNALunô: %u\n", 
	`«lUnôTy≥ToSåög
((*
ô
)->
m_«lUnôTy≥
), 
numRBSPByãs_«l
);

2436 i‡((*
ô
)->
m_«lUnôTy≥
 !
NAL_UNIT_PREFIX_SEI
 && (*ô)->m_«lUnôTy≥ !
NAL_UNIT_SUFFIX_SEI
)

2438 
numRBSPByãs
 +
numRBSPByãs_«l
;

2440 i‡(
ô
 =
ac˚ssUnô
.
	`begö
(Ë|| (*ô)->
m_«lUnôTy≥
 =
NAL_UNIT_VPS
 || (*ô)->m_«lUnôTy≥ =
NAL_UNIT_SPS
 || (*ô)->m_«lUnôTy≥ =
NAL_UNIT_PPS
)

2442 
numRBSPByãs
 += 4;

2446 
numRBSPByãs
 += 3;

2451 
UI¡
 
uibôs
 = 
numRBSPByãs
 * 8;

2452 
m_vRVM_RP
.
	`push_back
–
uibôs
 );

2455 
ªsu…
.
bôs
=(
DoubÀ
)
uibôs
;

2456 
m_gcA«lyzeAŒ
.
	`addResu…
 (
ªsu…
);

2458 #i‡
EXTENSION_360_VIDEO


2459 
m_ext360
.
	`addResu…
(
m_gcA«lyzeAŒ
);

2462 
TComSli˚
* 
pcSli˚
 = 
pcPic
->
	`gëSli˚
(0);

2463 i‡(
pcSli˚
->
	`isI¡ø
())

2465 
m_gcA«lyzeI
.
	`addResu…
 (
ªsu…
);

2466 #i‡
EXTENSION_360_VIDEO


2467 
m_ext360
.
	`addResu…
(
m_gcA«lyzeI
);

2469 *
PSNR_Y
 = 
ªsu…
.
p¢r
[
COMPONENT_Y
];

2471 i‡(
pcSli˚
->
	`isI¡îP
())

2473 
m_gcA«lyzeP
.
	`addResu…
 (
ªsu…
);

2474 #i‡
EXTENSION_360_VIDEO


2475 
m_ext360
.
	`addResu…
(
m_gcA«lyzeP
);

2477 *
PSNR_Y
 = 
ªsu…
.
p¢r
[
COMPONENT_Y
];

2479 i‡(
pcSli˚
->
	`isI¡îB
())

2481 
m_gcA«lyzeB
.
	`addResu…
 (
ªsu…
);

2482 #i‡
EXTENSION_360_VIDEO


2483 
m_ext360
.
	`addResu…
(
m_gcA«lyzeB
);

2485 *
PSNR_Y
 = 
ªsu…
.
p¢r
[
COMPONENT_Y
];

2488 
TCh¨
 
c
 = (
pcSli˚
->
	`isI¡ø
(Ë? 'I' :ÖcSli˚->
	`isI¡îP
() ? 'P' : 'B');

2489 i‡(!
pcSli˚
->
	`isRe„ªn˚d
())

2491 
c
 += 32;

2494 #i‡
ADAPTIVE_QP_SELECTION


2495 
	`¥ötf
("POC %4d TId: %1d ( %c-SLICE,ÇQP %d QP %d ) %10d bits",

2496 
pcSli˚
->
	`gëPOC
(),

2497 
pcSli˚
->
	`gëTLayî
(),

2498 
c
,

2499 
pcSli˚
->
	`gëSli˚QpBa£
(),

2500 
pcSli˚
->
	`gëSli˚Qp
(),

2501 
uibôs
 );

2503 
	`¥ötf
("POC %4d TId: %1d ( %c-SLICE, QP %d ) %10d bits",

2504 
pcSli˚
->
	`gëPOC
()-pcSli˚->
	`gëLa°IDR
(),

2505 
pcSli˚
->
	`gëTLayî
(),

2506 
c
,

2507 
pcSli˚
->
	`gëSli˚Qp
(),

2508 
uibôs
 );

2511 
	`¥ötf
(" [Y %6.4l‡dB U %6.4l‡dB V %6.4l‡dB]", 
ªsu…
.
p¢r
[
COMPONENT_Y
],Ñesu….p¢r[
COMPONENT_Cb
],Ñesu….p¢r[
COMPONENT_Cr
] );

2513 i‡(
ouçutLogCål
.
¥ötHexPîPOCPSNRs
)

2515 
uöt64_t
 
xP¢r
[
MAX_NUM_COMPONENT
];

2516 
i
 = 0; i < 
MAX_NUM_COMPONENT
; i++)

2518 
	`c›y
(
ªöãΩªt_ˇ°
<
uöt8_t
 *>(&
ªsu…
.
p¢r
[
i
]),

2519 
ªöãΩªt_ˇ°
<
uöt8_t
 *>(&
ªsu…
.
p¢r
[
i
]) + (result.psnr[i]),

2520 
ªöãΩªt_ˇ°
<
uöt8_t
 *>(&
xP¢r
[
i
]));

2522 
	`¥ötf
(" [xY %16" 
PRIx64
 " xU %16" PRIx64 " xv %16" PRIx64 "]", 
xP¢r
[
COMPONENT_Y
], xP¢r[
COMPONENT_Cb
], xP¢r[
COMPONENT_Cr
]);

2525 i‡(
ouçutLogCål
.
¥ötMSSSIM
)

2527 
	`¥ötf
(" [MS-SSIM Y %1.6l‡ U %1.6l‡ V %1.6lf]", 
ªsu…
.
MSSSIM
[
COMPONENT_Y
],Ñesu….MSSSIM[
COMPONENT_Cb
],Ñesu….MSSSIM[
COMPONENT_Cr
] );

2529 i‡(
ouçutLogCål
.
¥ötXPSNR
)

2531 
	`¥ötf
(" [xPSNR %6.4l‡dB]", 
ªsu…
.
xp¢r
);

2533 i‡(
ouçutLogCål
.
¥ötFømeMSE
)

2535 
	`¥ötf
(" [Y MSE %6.4l‡ U MSE %6.4l‡ V MSE %6.4lf]", 
ªsu…
.
MSEyuv‰ame
[
COMPONENT_Y
],Ñesu….MSEyuv‰ame[
COMPONENT_Cb
],Ñesu….MSEyuv‰ame[
COMPONENT_Cr
] );

2537 #i‡
EXTENSION_360_VIDEO


2538 
m_ext360
.
	`¥ötPîPOCInfo
();

2540 
	`¥ötf
(" [ET %5.0‡]", 
dEncTime
 );

2544 
I¡
 
iRefLi°
 = 0; iRefList < 2; iRefList++)

2546 
	`¥ötf
(" [L%d ", 
iRefLi°
);

2547 
I¡
 
iRefIndex
 = 0; iRefIndex < 
pcSli˚
->
	`gëNumRefIdx
(
	`RefPicLi°
(
iRefLi°
)); iRefIndex++)

2549 
	`¥ötf
 ("%d ", 
pcSli˚
->
	`gëRefPOC
(
	`RefPicLi°
(
iRefLi°
), 
iRefIndex
)-pcSli˚->
	`gëLa°IDR
());

2551 
	`¥ötf
("]");

2554 
cscd
.
	`de°roy
();

2555 
	}
}

2557 
DoubÀ
 
	gTEncGOP
::
	$xCÆcuœãMSSSIM
 (c⁄° 
Pñ
 *
pOrg
, c⁄° 
I¡
 
‹gSåide
, c⁄° Pñ* 
pRec
, c⁄° I¡ 
ªcSåide
, c⁄° I¡ 
width
, c⁄° I¡ 
height
, c⁄° 
UI¡
 
bôDïth
)

2559 c⁄° 
I¡
 
MAX_MSSSIM_SCALE
 = 5;

2560 c⁄° 
I¡
 
WEIGHTING_MID_TAP
 = 5;

2561 c⁄° 
I¡
 
WEIGHTING_SIZE
 = 
WEIGHTING_MID_TAP
*2+1;

2563 
UI¡
 
maxSˇÀ
;

2566 i‡(
width
 < 22 || 
height
 < 22)

2568 
maxSˇÀ
 = 1;

2570 i‡(
width
 < 44 || 
height
 < 44)

2572 
maxSˇÀ
 = 2;

2574 i‡(
width
 < 88 || 
height
 < 88)

2576 
maxSˇÀ
 = 3;

2578 i‡(
width
 < 176 || 
height
 < 176)

2580 
maxSˇÀ
 = 4;

2584 
maxSˇÀ
 = 5;

2587 
	`as£π
(
maxSˇÀ
>0 && maxSˇÀ<=
MAX_MSSSIM_SCALE
);

2590 
DoubÀ
 
weights
[
WEIGHTING_SIZE
][WEIGHTING_SIZE];

2592 
DoubÀ
 
c€ffSum
=0.0;

2593 
I¡
 
y
=0; y<
WEIGHTING_SIZE
; y++)

2595 
I¡
 
x
=0; x<
WEIGHTING_SIZE
; x++)

2597 
weights
[
y
][
x
]=
	`exp
(-((y-
WEIGHTING_MID_TAP
)*(y-WEIGHTING_MID_TAP)+(x-WEIGHTING_MID_TAP)*(x-WEIGHTING_MID_TAP))/(WEIGHTING_MID_TAP-0.5));

2598 
c€ffSum
 +=
weights
[
y
][
x
];

2602 
I¡
 
y
=0; y<
WEIGHTING_SIZE
; y++)

2604 
I¡
 
x
=0; x<
WEIGHTING_SIZE
; x++)

2606 
weights
[
y
][
x
] /=
c€ffSum
;

2612 c⁄° 
DoubÀ
 
exp⁄ítWeights
[
MAX_MSSSIM_SCALE
][MAX_MSSSIM_SCALE] = {{1.0, 0, 0, 0, 0 },

2619 
°d
::
ve˘‹
<
DoubÀ
> 
‹igöÆ
[
MAX_MSSSIM_SCALE
];

2620 
°d
::
ve˘‹
<
DoubÀ
> 
ªc⁄
[
MAX_MSSSIM_SCALE
];

2622 
UI¡
 
sˇÀ
=0; sˇÀ<
maxSˇÀ
; scale++)

2624 c⁄° 
I¡
 
sˇÀdHeight
 = 
height
 >> 
sˇÀ
;

2625 c⁄° 
I¡
 
sˇÀdWidth
 = 
width
 >> 
sˇÀ
;

2626 
‹igöÆ
[
sˇÀ
].
	`ªsize
(
sˇÀdHeight
*
sˇÀdWidth
, 
	`DoubÀ
(0));

2627 
ªc⁄
[
sˇÀ
].
	`ªsize
(
sˇÀdHeight
*
sˇÀdWidth
, 
	`DoubÀ
(0));

2631 
I¡
 
y
=0; y<
height
; y++)

2633 
I¡
 
x
=0; x<
width
; x++)

2635 
‹igöÆ
[0][
y
*
width
+
x
] = 
pOrg
[y*
‹gSåide
+x];

2636 
ªc⁄
[0][ 
y
*
width
+
x
] = 
pRec
[y*
ªcSåide
+x];

2641 
UI¡
 
sˇÀ
=1; sˇÀ<
maxSˇÀ
; scale++)

2643 c⁄° 
I¡
 
sˇÀdHeight
 = 
height
 >> 
sˇÀ
;

2644 c⁄° 
I¡
 
sˇÀdWidth
 = 
width
 >> 
sˇÀ
;

2645 
I¡
 
y
=0; y<
sˇÀdHeight
; y++)

2647 
I¡
 
x
=0; x<
sˇÀdWidth
; x++)

2649 
‹igöÆ
[
sˇÀ
][
y
*
sˇÀdWidth
+
x
]= (original[scale-1][ 2*y *(2*scaledWidth)+2*x ] +

2650 
‹igöÆ
[
sˇÀ
-1][ 2*
y
 *(2*
sˇÀdWidth
)+2*
x
+1] +

2651 
‹igöÆ
[
sˇÀ
-1][(2*
y
+1)*(2*
sˇÀdWidth
)+2*
x
 ] +

2652 
‹igöÆ
[
sˇÀ
-1][(2*
y
+1)*(2*
sˇÀdWidth
)+2*
x
+1]) / 4.0;

2653 
ªc⁄
[
sˇÀ
][
y
*
sˇÀdWidth
+
x
]= (Ñecon[scale-1][ 2*y *(2*scaledWidth)+2*x ] +

2654 
ªc⁄
[
sˇÀ
-1][ 2*
y
 *(2*
sˇÀdWidth
)+2*
x
+1] +

2655 
ªc⁄
[
sˇÀ
-1][(2*
y
+1)*(2*
sˇÀdWidth
)+2*
x
 ] +

2656 
ªc⁄
[
sˇÀ
-1][(2*
y
+1)*(2*
sˇÀdWidth
)+2*
x
+1]) / 4.0;

2662 c⁄° 
UI¡
 
maxVÆue
 = (1<<
bôDïth
)-1;

2663 c⁄° 
DoubÀ
 
c1
 = (0.01*
maxVÆue
)*(0.01*maxValue);

2664 c⁄° 
DoubÀ
 
c2
 = (0.03*
maxVÆue
)*(0.03*maxValue);

2666 
DoubÀ
 
föÆMSSSIM
 = 1.0;

2668 
UI¡
 
sˇÀ
=0; sˇÀ<
maxSˇÀ
; scale++)

2670 c⁄° 
I¡
 
sˇÀdHeight
 = 
height
 >> 
sˇÀ
;

2671 c⁄° 
I¡
 
sˇÀdWidth
 = 
width
 >> 
sˇÀ
;

2672 c⁄° 
I¡
 
blocksPîRow
 = 
sˇÀdWidth
-
WEIGHTING_SIZE
+1;

2673 c⁄° 
I¡
 
blocksPîCﬁumn
 = 
sˇÀdHeight
-
WEIGHTING_SIZE
+1;

2674 c⁄° 
I¡
 
tŸÆBlocks
 = 
blocksPîRow
*
blocksPîCﬁumn
;

2676 
DoubÀ
 
mónSSIM
= 0.0;

2678 
I¡
 
blockIndexY
=0; blockIndexY<
blocksPîCﬁumn
; blockIndexY++)

2680 
I¡
 
blockIndexX
=0; blockIndexX<
blocksPîRow
; blockIndexX++)

2682 
DoubÀ
 
muOrg
 =0.0;

2683 
DoubÀ
 
muRec
 =0.0;

2684 
DoubÀ
 
muOrigSqr
 =0.0;

2685 
DoubÀ
 
muRecSqr
 =0.0;

2686 
DoubÀ
 
muOrigMu…Rec
 =0.0;

2688 
I¡
 
y
=0; y<
WEIGHTING_SIZE
; y++)

2690 
I¡
 
x
=0;x<
WEIGHTING_SIZE
; x++)

2692 c⁄° 
DoubÀ
 
gaussünWeight
=
weights
[
y
][
x
];

2693 c⁄° 
I¡
 
ßm∂eOff£t
=(
blockIndexY
+
y
)*
sˇÀdWidth
+(
blockIndexX
+
x
);

2694 c⁄° 
DoubÀ
 
‹gPñ
=
‹igöÆ
[
sˇÀ
][
ßm∂eOff£t
];

2695 c⁄° 
DoubÀ
 
ªcPñ

ªc⁄
[
sˇÀ
][
ßm∂eOff£t
];

2697 
muOrg
 +=
‹gPñ
* 
gaussünWeight
;

2698 
muRec
 +=
ªcPñ
* 
gaussünWeight
;

2699 
muOrigSqr
 +=
‹gPñ
*‹gPñ*
gaussünWeight
;

2700 
muRecSqr
 +=
ªcPñ
*ªcPñ*
gaussünWeight
;

2701 
muOrigMu…Rec
+=
‹gPñ
*
ªcPñ
*
gaussünWeight
;

2705 c⁄° 
DoubÀ
 
sigmaSqrOrig
 = 
muOrigSqr
 -(
muOrg
*muOrg);

2706 c⁄° 
DoubÀ
 
sigmaSqrRec
 = 
muRecSqr
 -(
muRec
*muRec);

2707 c⁄° 
DoubÀ
 
sigmaOrigRec
 = 
muOrigMu…Rec
-(
muOrg
*
muRec
);

2709 
DoubÀ
 
blockSSIMVÆ
 = ((2.0*
sigmaOrigRec
 + 
c2
)/(
sigmaSqrOrig
+
sigmaSqrRec
 + c2));

2710 if(
sˇÀ
 =
maxSˇÀ
-1)

2712 
blockSSIMVÆ
*=(2.0*
muOrg
*
muRec
 + 
c1
)/(muOrg*muOrg+muRec*muRec + c1);

2715 
mónSSIM
 +
blockSSIMVÆ
;

2719 
mónSSIM
 /=
tŸÆBlocks
;

2721 
föÆMSSSIM
 *
	`pow
(
mónSSIM
, 
exp⁄ítWeights
[
maxSˇÀ
-1][
sˇÀ
]);

2724  
föÆMSSSIM
;

2725 
	}
}

2728 
Void
 
	gTEncGOP
::
	$xCÆcuœãI¡îœ˚dAddPSNR
–
TComPic
* 
pcPicOrgFú°Fõld
, TComPic* 
pcPicOrgSec⁄dFõld
,

2729 
TComPicYuv
* 
pcPicRecFú°Fõld
, TComPicYuv* 
pcPicRecSec⁄dFõld
,

2730 c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, 
DoubÀ
* 
PSNR_Y
 )

2732 
TEncA«lyze
::
Resu…D©a
 
ªsu…
;

2733 c⁄° 
TComSPS
 &
•s
=
pcPicOrgFú°Fõld
->
	`gëPicSym
()->
	`gëSPS
();

2734 
TComPic
 *
≠cPicOrgFõlds
[2]={
pcPicOrgFú°Fõld
, 
pcPicOrgSec⁄dFõld
};

2735 
TComPicYuv
 *
≠cPicRecFõlds
[2]={
pcPicRecFú°Fõld
, 
pcPicRecSec⁄dFõld
};

2737 
TComPicYuv
 
cscd
[2 ];

2738 i‡(
c⁄vîsi⁄
!=
IPCOLOURSPACE_UNCHANGED
)

2740 
UI¡
 
fõldNum
=0; fieldNum<2; fieldNum++)

2742 
TComPicYuv
 &
ªc⁄Fõld
=*(
≠cPicRecFõlds
[
fõldNum
]);

2743 
cscd
[
fõldNum
].
	`¸óãWôhoutCUInfo
(
ªc⁄Fõld
.
	`gëWidth
(
COMPONENT_Y
),Ñec⁄Fõld.
	`gëHeight
(COMPONENT_Y),Ñec⁄Fõld.
	`gëChromaF‹m©
() );

2744 
TVideoIOYuv
::
	`CﬁourS∑˚C⁄vît
(
ªc⁄Fõld
, 
cscd
[
fõldNum
], 
c⁄vîsi⁄
, 
Ál£
);

2745 
≠cPicRecFõlds
[
fõldNum
]=
cscd
+fieldNum;

2751 
	`as£π
(
≠cPicRecFõlds
[0]->
	`gëChromaF‹m©
()==apcPicRecFields[1]->getChromaFormat());

2752 c⁄° 
UI¡
 
numVÆidComp⁄íts
=
≠cPicRecFõlds
[0]->
	`gëNumbîVÆidComp⁄íts
();

2753 c⁄° 
Boﬁ
 
u£TrueOrg
 = 
c⁄vîsi⁄
 !
IPCOLOURSPACE_UNCHANGED
 || 
m_pcCfg
->
	`gëG›Ba£dTemp‹ÆFûãrE«bÀd
();

2755 i‡(
ouçutLogCål
.
¥ötXPSNR
 && 
≠cPicRecFõlds
[0]->
	`gëChromaF‹m©
(Ë!
CHROMA_400
 &&ápcPicRecFields[1]->getChromaFormat() != CHROMA_400)

2758 
Pñ
* 
pOrg
[
MAX_NUM_COMPONENT
];

2759 
DoubÀ
 
dWeightPñ
[
MAX_NUM_COMPONENT
];

2760 
I¡
 
iWeightSize
[
MAX_NUM_COMPONENT
] = {1, 1, 1};

2761 
Pñ
* 
pRec
[
MAX_NUM_COMPONENT
];

2762 
I¡
 
iOrgSåide
[
MAX_NUM_COMPONENT
], 
iRecSåide
[MAX_NUM_COMPONENT];

2763 
I¡
 
iWidth
[
MAX_NUM_COMPONENT
], 
iHeight
[MAX_NUM_COMPONENT], 
iSize
[MAX_NUM_COMPONENT];

2764 
UI¡64
 
uiSSDãmp
[
MAX_NUM_COMPONENT
];

2765 
UI¡
 
uiShi·Width
[
MAX_NUM_COMPONENT
], 
uiShi·Height
[MAX_NUM_COMPONENT];

2766 
I¡îmedüã_I¡
 
iDiff
;

2767 
DoubÀ
 
dSSDãmp
 = 0.0;

2768 
DoubÀ
 
fWVÆue
 = 0.0;

2769 
UI¡
 
fõldNum
=0; fieldNum<2; fieldNum++)

2771 
TComPic
 *
pcPic
=
≠cPicOrgFõlds
[
fõldNum
];

2772 
TComPicYuv
 *
pcPicD
=
≠cPicRecFõlds
[
fõldNum
];

2773 
TComPicYuv
 *
pOrgPicYuv
 = 
u£TrueOrg
 ? 
pcPic
 ->
	`gëPicYuvTrueOrg
(Ë:ÖcPi¯->
	`gëPicYuvOrg
();

2775 
I¡
 
ch™
=0; ch™<
pcPicD
->
	`gëNumbîVÆidComp⁄íts
(); chan++)

2777 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2778 
iOrgSåide
[
ch
] = 
pOrgPicYuv
->
	`gëSåide
(ch);

2779 
iRecSåide
[
ch
] = 
pcPicD
->
	`gëSåide
(ch);

2780 
iWidth
[
ch
] = 
pcPicD
->
	`gëWidth
 (chË- (
m_pcEncT›
->
	`gëPad
(0Ë>> 
pcPic
->
	`gëComp⁄ítSˇÀX
(ch));

2781 
iHeight
[
ch
] = 
pcPicD
->
	`gëHeight
(chË- ((
m_pcEncT›
->
	`gëPad
(1Ë>> 1Ë>> 
pcPic
->
	`gëComp⁄ítSˇÀY
(ch));

2782 
iSize
[
ch
] = 
iWidth
[ch]*
iHeight
[ch];

2783 
uiSSDãmp
[
ch
] = 0;

2784 
uiShi·Width
[
ch
] = (ch =
COMPONENT_Y
 || 
pcPicD
->
	`gëChromaF‹m©
(Ë=
CHROMA_444
) ? 0 : 1;

2785 
uiShi·Height
[
ch
] = (ch =
COMPONENT_Y
 || 
pcPicD
->
	`gëChromaF‹m©
(Ë=
CHROMA_444
 ||ÖcPicD->gëChromaF‹m©(Ë=
CHROMA_422
) ? 0 : 1;

2786 
dWeightPñ
[
ch
] = 
m_pcCfg
->
	`gëXPSNRWeight
(ch);

2787 
pOrg
[
ch
] = 
pOrgPicYuv
->
	`gëAddr
(ch);

2788 
pRec
[
ch
] = 
pcPicD
->
	`gëAddr
(ch);

2790 
°d
::
ve˘‹
<
DoubÀ
> 
	`vecSSEChroma
(
iSize
[
COMPONENT_Cb
], 
	`DoubÀ
(0));

2792 
I¡
 
y
 = 0, 
t
0; y < 
iHeight
[
COMPONENT_Cb
]; y++ )

2794 
I¡
 
x
 = 0; x < 
iWidth
[
COMPONENT_Cb
]; x++, 
t
++)

2796 
UI¡64
 
uiSE_cb
, 
uiSE_¸
;

2797 
iDiff
 = (
I¡îmedüã_I¡
)–(I¡îmedüã_I¡)
pOrg
[
COMPONENT_Cb
][
x
] - (I¡îmedüã_I¡)
pRec
[COMPONENT_Cb][x] );

2798 
uiSE_cb
 = 
iDiff
 * iDiff;

2799 
iDiff
 = (
I¡îmedüã_I¡
)–(I¡îmedüã_I¡)
pOrg
[
COMPONENT_Cr
][
x
] - (I¡îmedüã_I¡)
pRec
[COMPONENT_Cr][x] );

2800 
uiSE_¸
 = 
iDiff
 * iDiff;

2801 
uiSSDãmp
[
COMPONENT_Cb
] +
uiSE_cb
;

2802 
uiSSDãmp
[
COMPONENT_Cr
] +
uiSE_¸
;

2803 
vecSSEChroma
[
t
] = 
dWeightPñ
[
COMPONENT_Cb
] * (
DoubÀ
Ë
uiSE_cb
 + dWeightPñ[
COMPONENT_Cr
] * (DoubÀË
uiSE_¸
;

2805 
pOrg
[
COMPONENT_Cb
] +
iOrgSåide
[COMPONENT_Cb];

2806 
pRec
[
COMPONENT_Cb
] +
iRecSåide
[COMPONENT_Cb];

2807 
pOrg
[
COMPONENT_Cr
] +
iOrgSåide
[COMPONENT_Cr];

2808 
pRec
[
COMPONENT_Cr
] +
iRecSåide
[COMPONENT_Cr];

2811 
I¡
 
y
 = 0; y < 
iHeight
[
COMPONENT_Y
]; y++ )

2813 
UI¡
 
y_°ï_chroma
 = (
y
 >> 
uiShi·Height
[
COMPONENT_Cb
]Ë* 
iWidth
[COMPONENT_Cb];

2814 
I¡
 
x
 = 0; x < 
iWidth
[
COMPONENT_Y
]; x++)

2816 
UI¡64
 
uiSE_y
;

2817 
UI¡
 
x_°ï_chroma
 = (
x
 >> 
uiShi·Width
[
COMPONENT_Cb
]);

2818 
iDiff
 = (
I¡îmedüã_I¡
)–(I¡îmedüã_I¡)
pOrg
[
COMPONENT_Y
][
x
] - (I¡îmedüã_I¡)
pRec
[COMPONENT_Y][x] );

2819 
uiSE_y
 = 
iDiff
 * iDiff;

2820 
uiSSDãmp
[
COMPONENT_Y
] +
uiSE_y
;

2821 
dSSDãmp
 +
	`sqπ
(
dWeightPñ
[
COMPONENT_Y
] * (
DoubÀ
Ë
uiSE_y
 + 
vecSSEChroma
[
y_°ï_chroma
+
x_°ï_chroma
]);

2823 
pOrg
[
COMPONENT_Y
] +
iOrgSåide
[COMPONENT_Y];

2824 
pRec
[
COMPONENT_Y
] +
iRecSåide
[COMPONENT_Y];

2827  
I¡
 
ch™
 = 0; ch™<
pcPicD
->
	`gëNumbîVÆidComp⁄íts
(); chan++)

2829 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2830 c⁄° 
UI¡
 
maxvÆ
 = 255 << (
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
ch
)) - 8);

2831 c⁄° 
DoubÀ
 
fRefVÆue
 = (DoubÀË
maxvÆ
 * maxvÆ * 
iSize
[
ch
];

2832 
ªsu…
.
p¢r
[
ch
] = ( 
uiSSDãmp
[ch] ? 10.0 * 
	`log10
–
fRefVÆue
 / (
DoubÀ
)uiSSDtemp[ch] ) : 999.99 );

2833 
ªsu…
.
MSEyuv‰ame
[
ch
] = (
DoubÀ
)
uiSSDãmp
[ch]/(
iSize
[ch]);

2834 
fWVÆue
 +(
DoubÀ
Ë
iWeightSize
[
ch
] * (DoubÀË
iSize
[ch];

2837 c⁄° 
DoubÀ
 
maxvÆ
 = 255 << (
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
COMPONENT_Y
)) - 8);

2838 
fWVÆue
 = 
	`DoubÀ
–
maxvÆ
 * fWValue);

2839 
ªsu…
.
xp¢r
 = 
dSSDãmp
 ? 20.0 * 
	`log10
–
fWVÆue
 / dSSDtemp) : 999.99;

2843 
I¡
 
ch™
=0; ch™<
numVÆidComp⁄íts
; chan++)

2845 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2846 
	`as£π
(
≠cPicRecFõlds
[0]->
	`gëWidth
(
ch
)==apcPicRecFields[1]->getWidth(ch));

2847 
	`as£π
(
≠cPicRecFõlds
[0]->
	`gëHeight
(
ch
)==apcPicRecFields[1]->getHeight(ch));

2849 
UI¡64
 
uiSSDãmp
=0;

2850 c⁄° 
I¡
 
iWidth
 = 
≠cPicRecFõlds
[0]->
	`gëWidth
 (
ch
Ë- (
m_pcEncT›
->
	`gëPad
(0Ë>>ápcPicRecFõlds[0]->
	`gëComp⁄ítSˇÀX
(ch));

2851 c⁄° 
I¡
 
iHeight
 = 
≠cPicRecFõlds
[0]->
	`gëHeight
(
ch
Ë- ((
m_pcEncT›
->
	`gëPad
(1Ë>> 1Ë>>ápcPicRecFõlds[0]->
	`gëComp⁄ítSˇÀY
(ch));

2853 
I¡
 
iSize
 = 
iWidth
*
iHeight
;

2855 
UI¡
 
fõldNum
=0; fieldNum<2; fieldNum++)

2857 
TComPic
 *
pcPic
=
≠cPicOrgFõlds
[
fõldNum
];

2858 
TComPicYuv
 *
pcPicD
=
≠cPicRecFõlds
[
fõldNum
];

2860 c⁄° 
Pñ
* 
pOrg
 = 
u£TrueOrg
 ? 
pcPic
 ->
	`gëPicYuvTrueOrg
()->
	`gëAddr
(
ch
Ë:ÖcPi¯->
	`gëPicYuvOrg
()->getAddr(ch);

2861 
Pñ
* 
pRec
 = 
pcPicD
->
	`gëAddr
(
ch
);

2862 c⁄° 
I¡
 
iSåide
 = 
pcPicD
->
	`gëSåide
(
ch
);

2865 
I¡
 
y
 = 0; y < 
iHeight
; y++ )

2867 
I¡
 
x
 = 0; x < 
iWidth
; x++ )

2869 
I¡îmedüã_I¡
 
iDiff
 = (I¡îmedüã_I¡)–
pOrg
[
x
] - 
pRec
[x] );

2870 
uiSSDãmp
 +
iDiff
 * iDiff;

2872 
pOrg
 +
iSåide
;

2873 
pRec
 +
iSåide
;

2876 c⁄° 
I¡
 
maxvÆ
 = 255 << (
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
ch
)) - 8);

2877 c⁄° 
DoubÀ
 
fRefVÆue
 = (DoubÀË
maxvÆ
 * maxvÆ * 
iSize
*2;

2878 
ªsu…
.
p¢r
[
ch
] = ( 
uiSSDãmp
 ? 10.0 * 
	`log10
–
fRefVÆue
 / (
DoubÀ
)uiSSDtemp ) : 999.99 );

2879 
ªsu…
.
MSEyuv‰ame
[
ch
] = (
DoubÀ
)
uiSSDãmp
/(
iSize
*2);

2883 i‡(
ouçutLogCål
.
¥ötMSSSIM
)

2885 
I¡
 
ch™
=0; ch™<
numVÆidComp⁄íts
; chan++)

2887 c⁄° 
Comp⁄ítID
 
ch
=
	`Comp⁄ítID
(
ch™
);

2888 
	`as£π
(
≠cPicRecFõlds
[0]->
	`gëWidth
(
ch
) ==apcPicRecFields[1]->getWidth(ch) );

2889 
	`as£π
(
≠cPicRecFõlds
[0]->
	`gëHeight
(
ch
)==apcPicRecFields[1]->getHeight(ch));

2891 
DoubÀ
 
sumOvîFõldsMSSSIM
 = 0.0;

2892 c⁄° 
I¡
 
width
 = 
≠cPicRecFõlds
[0]->
	`gëWidth
 (
ch
Ë- ( 
m_pcEncT›
->
	`gëPad
(0Ë>>ápcPicRecFõlds[0]->
	`gëComp⁄ítSˇÀX
(ch));

2893 c⁄° 
I¡
 
height
 = 
≠cPicRecFõlds
[0]->
	`gëHeight
(
ch
Ë- ((
m_pcEncT›
->
	`gëPad
(1Ë>> 1Ë>>ápcPicRecFõlds[0]->
	`gëComp⁄ítSˇÀY
(ch));

2895 
UI¡
 
fõldNum
=0; fieldNum<2; fieldNum++)

2897 
TComPic
 *
pcPic
 = 
≠cPicOrgFõlds
[
fõldNum
];

2898 
TComPicYuv
 *
pcPicD
 = 
≠cPicRecFõlds
[
fõldNum
];

2900 c⁄° 
Pñ
* 
pOrg
 = 
u£TrueOrg
 ? 
pcPic
 ->
	`gëPicYuvTrueOrg
()->
	`gëAddr
(
ch
Ë:ÖcPi¯->
	`gëPicYuvOrg
()->getAddr(ch);

2901 c⁄° 
I¡
 
‹gSåide
 = 
u£TrueOrg
 ? 
pcPic
 ->
	`gëPicYuvTrueOrg
()->
	`gëSåide
(
ch
Ë:ÖcPi¯->
	`gëPicYuvOrg
()->getStride(ch);

2902 
Pñ
* 
pRec
 = 
pcPicD
->
	`gëAddr
(
ch
);

2903 c⁄° 
I¡
 
ªcSåide
 = 
pcPicD
->
	`gëSåide
(
ch
);

2904 c⁄° 
UI¡
 
bôDïth
 = 
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
ch
));

2906 
sumOvîFõldsMSSSIM
 +
	`xCÆcuœãMSSSIM
 (
pOrg
, 
‹gSåide
, 
pRec
, 
ªcSåide
, 
width
, 
height
, 
bôDïth
);

2909 
ªsu…
.
MSSSIM
[
ch
] = 
sumOvîFõldsMSSSIM
/2;

2913 
ªsu…
.
bôs
 = 0;

2916 
m_gcA«lyzeAŒ_ö
.
	`addResu…
 (
ªsu…
);

2918 *
PSNR_Y
 = 
ªsu…
.
p¢r
[
COMPONENT_Y
];

2920 
	`¥ötf
("\¿ I¡îœ˚d fømê%d: [Y %6.4l‡dB U %6.4l‡dB V %6.4l‡dB]", 
pcPicOrgSec⁄dFõld
->
	`gëPOC
()/2 , 
ªsu…
.
p¢r
[
COMPONENT_Y
],Ñesu….p¢r[
COMPONENT_Cb
],Ñesu….p¢r[
COMPONENT_Cr
] );

2922 i‡(
ouçutLogCål
.
¥ötHexPîPOCPSNRs
)

2924 
uöt64_t
 
xP¢r
[
MAX_NUM_COMPONENT
];

2925 
i
 = 0; i < 
MAX_NUM_COMPONENT
; i++)

2927 
	`c›y
(
ªöãΩªt_ˇ°
<
uöt8_t
 *>(&
ªsu…
.
p¢r
[
i
]),

2928 
ªöãΩªt_ˇ°
<
uöt8_t
 *>(&
ªsu…
.
p¢r
[
i
]) + (result.psnr[i]),

2929 
ªöãΩªt_ˇ°
<
uöt8_t
 *>(&
xP¢r
[
i
]));

2931 
	`¥ötf
(" [xY %16" 
PRIx64
 " xU %16" PRIx64 " xv %16" PRIx64 "]", 
xP¢r
[
COMPONENT_Y
], xP¢r[
COMPONENT_Cb
], xP¢r[
COMPONENT_Cr
]);

2934 i‡(
ouçutLogCål
.
¥ötMSSSIM
)

2936 
	`¥ötf
(" [MS-SSIM Y %1.6l‡ U %1.6l‡ V %1.6lf]", 
ªsu…
.
MSSSIM
[
COMPONENT_Y
],Ñesu….MSSSIM[
COMPONENT_Cb
],Ñesu….MSSSIM[
COMPONENT_Cr
] );

2938 i‡(
ouçutLogCål
.
¥ötFømeMSE
)

2940 
	`¥ötf
(" [Y MSE %6.4l‡ U MSE %6.4l‡ V MSE %6.4lf]", 
ªsu…
.
MSEyuv‰ame
[
COMPONENT_Y
],Ñesu….MSEyuv‰ame[
COMPONENT_Cb
],Ñesu….MSEyuv‰ame[
COMPONENT_Cr
] );

2943 
UI¡
 
fõldNum
=0; fieldNum<2; fieldNum++)

2945 
cscd
[
fõldNum
].
	`de°roy
();

2947 
	}
}

2956 
NÆUnôTy≥
 
	gTEncGOP
::
	$gëNÆUnôTy≥
(
I¡
 
pocCuº
, I¡ 
œ°IDR
, 
Boﬁ
 
isFõld
)

2958 i‡(
pocCuº
 == 0)

2960  
NAL_UNIT_CODED_SLICE_IDR_W_RADL
;

2963 if(
m_pcCfg
->
	`gëEfficõ¡FõldIRAPE«bÀd
(Ë&& 
isFõld
 && 
pocCuº
 == 1)

2966  
NAL_UNIT_CODED_SLICE_TRAIL_R
;

2969 if(
m_pcCfg
->
	`gëDecodögRe‰eshTy≥
(Ë!3 && (
pocCuº
 - 
isFõld
Ë% m_pcCfg->
	`gëI¡øPîiod
() == 0)

2971 i‡(
m_pcCfg
->
	`gëDecodögRe‰eshTy≥
() == 1)

2973  
NAL_UNIT_CODED_SLICE_CRA
;

2975 i‡(
m_pcCfg
->
	`gëDecodögRe‰eshTy≥
() == 2)

2977  
NAL_UNIT_CODED_SLICE_IDR_W_RADL
;

2980 if(
m_pocCRA
>0)

2982 if(
pocCuº
<
m_pocCRA
)

2989  
NAL_UNIT_CODED_SLICE_RASL_R
;

2992 i‡(
œ°IDR
>0)

2994 i‡(
pocCuº
 < 
œ°IDR
)

2996  
NAL_UNIT_CODED_SLICE_RADL_R
;

2999  
NAL_UNIT_CODED_SLICE_TRAIL_R
;

3000 
	}
}

3002 
DoubÀ
 
	gTEncGOP
::
	$xCÆcuœãRVM
()

3004 
DoubÀ
 
dRVM
 = 0;

3006 if–
m_pcCfg
->
	`gëGOPSize
(Ë=1 && m_pcCfg->
	`gëI¡øPîiod
(Ë!1 && m_pcCfg->
	`gëFømesToBeEncoded
(Ë> 
RVM_VCEGAM10_M
 * 2 )

3009 
°d
::
ve˘‹
<
DoubÀ
> 
vRL
 , 
vB
;

3010 
size_t
 
N
 = 
m_vRVM_RP
.
	`size
();

3011 
vRL
.
	`ªsize
–
N
 );

3012 
vB
.
	`ªsize
–
N
 );

3014 
I¡
 
i
;

3015 
DoubÀ
 
dRavg
 = 0 , 
dBavg
 = 0;

3016 
vB
[
RVM_VCEGAM10_M
] = 0;

3017  
i
 = 
RVM_VCEGAM10_M
 + 1 ; i < 
N
 - RVM_VCEGAM10_M + 1 ; i++ )

3019 
vRL
[
i
] = 0;

3020  
I¡
 
j
 = 
i
 - 
RVM_VCEGAM10_M
 ; j <= i + RVM_VCEGAM10_M - 1 ; j++ )

3022 
vRL
[
i
] +
m_vRVM_RP
[
j
];

3024 
vRL
[
i
] /–2 * 
RVM_VCEGAM10_M
 );

3025 
vB
[
i
] = vB[i-1] + 
m_vRVM_RP
[i] - 
vRL
[i];

3026 
dRavg
 +
m_vRVM_RP
[
i
];

3027 
dBavg
 +
vB
[
i
];

3030 
dRavg
 /–
N
 - 2 * 
RVM_VCEGAM10_M
 );

3031 
dBavg
 /–
N
 - 2 * 
RVM_VCEGAM10_M
 );

3033 
DoubÀ
 
dSigamB
 = 0;

3034  
i
 = 
RVM_VCEGAM10_M
 + 1 ; i < 
N
 - RVM_VCEGAM10_M + 1 ; i++ )

3036 
DoubÀ
 
tmp
 = 
vB
[
i
] - 
dBavg
;

3037 
dSigamB
 +
tmp
 *Åmp;

3039 
dSigamB
 = 
	`sqπ
–dSigamB / ( 
N
 - 2 * 
RVM_VCEGAM10_M
 ) );

3041 
DoubÀ
 
f
 = 
	`sqπ
–12.0 * ( 
RVM_VCEGAM10_M
 - 1 ) / ( RVM_VCEGAM10_M + 1 ) );

3043 
dRVM
 = 
dSigamB
 / 
dRavg
 * 
f
;

3046 –
dRVM
 );

3047 
	}
}

3054 
Void
 
	gTEncGOP
::
	$xAâachSli˚D©aToNÆUnô
 (
OuçutNALUnô
& 
rNÆu
, 
TComOuçutBô°ªam
* 
codedSli˚D©a
)

3057 
rNÆu
.
m_Bô°ªam
.
	`wrôeByãAlignmít
();

3060 i‡(
codedSli˚D©a
->
	`gëNumbîOfWrôãnBôs
() > 0)

3062 
rNÆu
.
m_Bô°ªam
.
	`addSub°ªam
(
codedSli˚D©a
);

3065 
m_pcE¡r›yCodî
->
	`£tBô°ªam
(&
rNÆu
.
m_Bô°ªam
);

3067 
codedSli˚D©a
->
	`˛ór
();

3068 
	}
}

3072 
Void
 
	gTEncGOP
::
¨øngeL⁄gãrmPi˘uªsInRPS
(
TComSli˚
 *
pcSli˚
, 
TComLi°
<
TComPic
*>& 
rcLi°Pic
)

3074 if(
	gpcSli˚
->
gëRPS
()->
gëNumbîOfL⁄gãrmPi˘uªs
() == 0)

3079 
as£π
 (
pcSli˚
->
gëRPSidx
()==-1);

3080 
TComRe„ªn˚Pi˘uªSë
 *
	gΩs
 = 
pcSli˚
->
gëLoˇlRPS
();

3084 
I¡
 
	gl⁄gãrmPicsPoc
[
MAX_NUM_REF_PICS
], 
	gl⁄gãrmPicsLSB
[MAX_NUM_REF_PICS], 
	gödi˚s
[MAX_NUM_REF_PICS];

3085 
I¡
 
	gl⁄gãrmPicsMSB
[
MAX_NUM_REF_PICS
];

3086 
Boﬁ
 
	gmSBPª£¡Fœg
[
MAX_NUM_REF_PICS
];

3087 ::
mem£t
(
l⁄gãrmPicsPoc
, 0, (longtermPicsPoc));

3088 ::
mem£t
(
l⁄gãrmPicsLSB
, 0, (longtermPicsLSB));

3089 ::
mem£t
(
l⁄gãrmPicsMSB
, 0, (longtermPicsMSB));

3090 ::
mem£t
(
ödi˚s
 , 0, (indices));

3091 ::
mem£t
(
mSBPª£¡Fœg
 , 0, (mSBPresentFlag));

3094 
I¡
 
	goff£t
 = 
Ωs
->
gëNumbîOfNeg©ivePi˘uªs
(Ë+Ñps->
gëNumbîOfPosôivePi˘uªs
();

3095 
I¡
 
	gi
, 
	g˘r
 = 0;

3096 
I¡
 
	gmaxPicOrdîC¡LSB
 = 1 << 
pcSli˚
->
gëSPS
()->
gëBôsF‹POC
();

3097 
	gi
 = 
Ωs
->
gëNumbîOfPi˘uªs
(Ë- 1; i >
off£t
; i--, 
	g˘r
++)

3099 
	gl⁄gãrmPicsPoc
[
˘r
] = 
Ωs
->
gëPOC
(
i
);

3100 
	gl⁄gãrmPicsLSB
[
˘r
] = 
gëLSB
(
l⁄gãrmPicsPoc
[˘r], 
maxPicOrdîC¡LSB
);

3101 
	gödi˚s
[
˘r
] = 
i
;

3102 
	gl⁄gãrmPicsMSB
[
˘r
] = 
l⁄gãrmPicsPoc
[˘r] - 
l⁄gãrmPicsLSB
[ctr];

3104 
I¡
 
	gnumL⁄gPics
 = 
Ωs
->
gëNumbîOfL⁄gãrmPi˘uªs
();

3105 
as£π
(
˘r
 =
numL⁄gPics
);

3108 
	gi
 = 0; i < 
	gnumL⁄gPics
; i++)

3110 
I¡
 
	gj
 = 0; j < 
	gnumL⁄gPics
 - 1; j++)

3112 if(
	gl⁄gãrmPicsMSB
[
j
] <ÜongtermPicsMSB[j+1])

3114 
	g°d
::
sw≠
(
l⁄gãrmPicsPoc
[
j
],ÜongtermPicsPoc[j+1]);

3115 
	g°d
::
sw≠
(
l⁄gãrmPicsLSB
[
j
],ÜongtermPicsLSB[j+1]);

3116 
	g°d
::
sw≠
(
l⁄gãrmPicsMSB
[
j
],ÜongtermPicsMSB[j+1]);

3117 
	g°d
::
sw≠
(
ödi˚s
[
j
] , indices[j+1] );

3122 
	gi
 = 0; i < 
	gnumL⁄gPics
; i++)

3126 
	gTComLi°
<
	gTComPic
*>::
ôî©‹
 
ôîPic
 = 
rcLi°Pic
.
begö
();

3127 
TComPic
* 
	gpcPic
;

3128  
	gôîPic
 !
rcLi°Pic
.
íd
() )

3130 
pcPic
 = *
ôîPic
;

3131 if–(
gëLSB
(
pcPic
->
gëPOC
(), 
maxPicOrdîC¡LSB
Ë=
l⁄gãrmPicsLSB
[
i
]) &&

3132 (
pcPic
->
gëSli˚
(0)->
isRe„ªn˚d
()) &&

3133 (
pcPic
->
gëPOC
(Ë!
l⁄gãrmPicsPoc
[
i
]) )

3135 
mSBPª£¡Fœg
[
i
] = 
åue
;

3138 
	gôîPic
++;

3143 
Boﬁ
 
	gãmpAºay
[
MAX_NUM_REF_PICS
]; ::
mem£t
(
ãmpAºay
, 0, (tempArray));

3144 
	gi
 = 0; i < 
	gnumL⁄gPics
; i++)

3146 
	gãmpAºay
[
i
] = 
Ωs
->
gëU£d
(
ödi˚s
[i]);

3149 
	g˘r
 = 0;

3150 
I¡
 
	gcuºMSB
 = 0, 
	gcuºLSB
 = 0;

3152 
	gcuºLSB
 = 
gëLSB
(
pcSli˚
->
gëPOC
(), 
maxPicOrdîC¡LSB
);

3153 
	gcuºMSB
 = 
pcSli˚
->
gëPOC
(Ë- 
cuºLSB
;

3155 
	gi
 = 
Ωs
->
gëNumbîOfPi˘uªs
(Ë- 1; i >
off£t
; i--, 
	g˘r
++)

3157 
	gΩs
->
£tPOC
 (
i
, 
l⁄gãrmPicsPoc
[
˘r
]);

3158 
	gΩs
->
£tDñèPOC
 (
i
, - 
pcSli˚
->
gëPOC
(Ë+ 
l⁄gãrmPicsPoc
[
˘r
]);

3159 
	gΩs
->
£tU£d
 (
i
, 
ãmpAºay
[
˘r
]);

3160 
	gΩs
->
£tPocLSBLT
 (
i
, 
l⁄gãrmPicsLSB
[
˘r
]);

3161 
	gΩs
->
£tDñèPocMSBCy˛eLT
 (
i
, (
cuºMSB
 - (
l⁄gãrmPicsPoc
[
˘r
] - 
l⁄gãrmPicsLSB
[˘r])Ë/ 
maxPicOrdîC¡LSB
);

3162 
	gΩs
->
£tDñèPocMSBPª£¡Fœg
(
i
, 
mSBPª£¡Fœg
[
˘r
]);

3164 
as£π
(
Ωs
->
gëDñèPocMSBCy˛eLT
(
i
) >= 0);

3166 
	gi
 = 
Ωs
->
gëNumbîOfPi˘uªs
(Ë- 1, 
	g˘r
 = 1; i >
off£t
; i--, ctr++)

3168 
I¡
 
	gj
 = 
Ωs
->
gëNumbîOfPi˘uªs
(Ë- 1 - 
˘r
; j >
off£t
; j--)

3172 
as£π
–
Ωs
->
gëPOC
(
i
Ë!Ωs->gëPOC(
j
) );

3177 
Void
 
	gTEncGOP
::
	$≠∂yDeblockögFûãrMëric
–
TComPic
* 
pcPic
, 
UI¡
 
uiNumSli˚s
 )

3179 
TComPicYuv
* 
pcPicYuvRec
 = 
pcPic
->
	`gëPicYuvRec
();

3180 
Pñ
* 
Rec
 = 
pcPicYuvRec
->
	`gëAddr
(
COMPONENT_Y
);

3181 
Pñ
* 
ãmpRec
 = 
Rec
;

3182 
I¡
 
°ride
 = 
pcPicYuvRec
->
	`gëSåide
(
COMPONENT_Y
);

3183 
UI¡
 
log2maxTB
 = 
pcPic
->
	`gëSli˚
(0)->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
();

3184 
UI¡
 
maxTBsize
 = (1<<
log2maxTB
);

3185 c⁄° 
UI¡
 
möBlockAπSize
 = 8;

3186 c⁄° 
UI¡
 
picWidth
 = 
pcPicYuvRec
->
	`gëWidth
(
COMPONENT_Y
);

3187 c⁄° 
UI¡
 
picHeight
 = 
pcPicYuvRec
->
	`gëHeight
(
COMPONENT_Y
);

3188 c⁄° 
UI¡
 
noCﬁ
 = (
picWidth
>>
log2maxTB
);

3189 c⁄° 
UI¡
 
noRows
 = (
picHeight
>>
log2maxTB
);

3190 
	`as£π
(
noCﬁ
 > 1);

3191 
	`as£π
(
noRows
 > 1);

3192 
°d
::
ve˘‹
<
UI¡64
> 
	`cﬁSAD
(
noCﬁ
, 
	`UI¡64
(0));

3193 
°d
::
ve˘‹
<
UI¡64
> 
	`rowSAD
(
noRows
, 
	`UI¡64
(0));

3194 
UI¡
 
cﬁIdx
 = 0;

3195 
UI¡
 
rowIdx
 = 0;

3196 
Pñ
 
p0
, 
p1
, 
p2
, 
q0
, 
q1
, 
q2
;

3198 
I¡
 
qp
 = 
pcPic
->
	`gëSli˚
(0)->
	`gëSli˚Qp
();

3199 c⁄° 
I¡
 
bôDïthLuma
=
pcPic
->
	`gëSli˚
(0)->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
);

3200 
I¡
 
bôdïthSˇÀ
 = 1 << (
bôDïthLuma
-8);

3201 
I¡
 
bëa
 = 
TComLo›Fûãr
::
	`gëBëa
–
qp
 ) * 
bôdïthSˇÀ
;

3202 c⁄° 
I¡
 
thr2
 = (
bëa
>>2);

3203 c⁄° 
I¡
 
thr1
 = 2*
bôdïthSˇÀ
;

3204 
UI¡
 
a
 = 0;

3206 i‡(
maxTBsize
 > 
möBlockAπSize
)

3209 
I¡
 
c
 = 
maxTBsize
; c < 
picWidth
; c += maxTBsize)

3211 
I¡
 
r
 = 0;Ñ < 
picHeight
;Ñ++)

3213 
p2
 = 
Rec
[
c
-3];

3214 
p1
 = 
Rec
[
c
-2];

3215 
p0
 = 
Rec
[
c
-1];

3216 
q0
 = 
Rec
[
c
];

3217 
q1
 = 
Rec
[
c
+1];

3218 
q2
 = 
Rec
[
c
+2];

3219 
a
 = ((
	`abs
(
p2
-(
p1
<<1)+
p0
)+abs(
q0
-(
q1
<<1)+
q2
))<<1);

3220 i‡–
thr1
 < 
a
 &&á < 
thr2
)

3222 
cﬁSAD
[
cﬁIdx
] +
	`abs
(
p0
 - 
q0
);

3224 
Rec
 +
°ride
;

3226 
cﬁIdx
++;

3227 
Rec
 = 
ãmpRec
;

3231 
I¡
 
r
 = 
maxTBsize
;Ñ < 
picHeight
;Ñ += maxTBsize)

3233 
I¡
 
c
 = 0; c < 
picWidth
; c++)

3235 
p2
 = 
Rec
[
c
 + (
r
-3)*
°ride
];

3236 
p1
 = 
Rec
[
c
 + (
r
-2)*
°ride
];

3237 
p0
 = 
Rec
[
c
 + (
r
-1)*
°ride
];

3238 
q0
 = 
Rec
[
c
 + 
r
*
°ride
];

3239 
q1
 = 
Rec
[
c
 + (
r
+1)*
°ride
];

3240 
q2
 = 
Rec
[
c
 + (
r
+2)*
°ride
];

3241 
a
 = ((
	`abs
(
p2
-(
p1
<<1)+
p0
)+abs(
q0
-(
q1
<<1)+
q2
))<<1);

3242 i‡(
thr1
 < 
a
 &&á < 
thr2
)

3244 
rowSAD
[
rowIdx
] +
	`abs
(
p0
 - 
q0
);

3247 
rowIdx
++;

3251 
UI¡64
 
cﬁSADsum
 = 0;

3252 
UI¡64
 
rowSADsum
 = 0;

3253 
I¡
 
c
 = 0; c < 
noCﬁ
-1; c++)

3255 
cﬁSADsum
 +
cﬁSAD
[
c
];

3257 
I¡
 
r
 = 0;Ñ < 
noRows
-1;Ñ++)

3259 
rowSADsum
 +
rowSAD
[
r
];

3262 
cﬁSADsum
 <<= 10;

3263 
rowSADsum
 <<= 10;

3264 
cﬁSADsum
 /(
noCﬁ
-1);

3265 
cﬁSADsum
 /
picHeight
;

3266 
rowSADsum
 /(
noRows
-1);

3267 
rowSADsum
 /
picWidth
;

3269 
UI¡64
 
avgSAD
 = ((
cﬁSADsum
 + 
rowSADsum
)>>1);

3270 
avgSAD
 >>(
bôDïthLuma
-8);

3272 i‡–
avgSAD
 > 2048 )

3274 
avgSAD
 >>= 9;

3275 
I¡
 
off£t
 = 
	`Clù3
(2,6,(I¡)
avgSAD
);

3276 
I¡
 
i
=0; i<
uiNumSli˚s
; i++)

3278 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrOvîrideFœg
(
åue
);

3279 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrDißbÀ
(
Ál£
);

3280 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrBëaOff£tDiv2
–
off£t
 );

3281 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrTcOff£tDiv2
–
off£t
 );

3286 
I¡
 
i
=0; i<
uiNumSli˚s
; i++)

3288 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrOvîrideFœg
(
Ál£
);

3289 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrDißbÀ
–pcPic->gëSli˚(i)->
	`gëPPS
()->
	`gëPPSDeblockögFûãrDißbÀdFœg
() );

3290 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrBëaOff£tDiv2
–pcPic->gëSli˚(i)->
	`gëPPS
()->
	`gëDeblockögFûãrBëaOff£tDiv2
() );

3291 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrTcOff£tDiv2
–pcPic->gëSli˚(i)->
	`gëPPS
()->
	`gëDeblockögFûãrTcOff£tDiv2
() );

3294 
	}
}

3296 
Void
 
	gTEncGOP
::
	$≠∂yDeblockögFûãrP¨amëîSñe˘i⁄
–
TComPic
* 
pcPic
, c⁄° 
UI¡
 
numSli˚s
, c⁄° 
I¡
 
g›ID
 )

3298 
	eDBF…P¨am


3300 
DBFLT_PARAM_AVAILABLE
 = 0,

3301 
DBFLT_DISABLE_FLAG
,

3302 
DBFLT_BETA_OFFSETD2
,

3303 
DBFLT_TC_OFFSETD2
,

3306 c⁄° 
I¡
 
MAX_BETA_OFFSET
 = 3;

3307 c⁄° 
I¡
 
MIN_BETA_OFFSET
 = -3;

3308 c⁄° 
I¡
 
MAX_TC_OFFSET
 = 3;

3309 c⁄° 
I¡
 
MIN_TC_OFFSET
 = -3;

3311 
TComPicYuv
* 
pcPicYuvRec
 = 
pcPic
->
	`gëPicYuvRec
();

3312 
TComPicYuv
* 
pcPicYuvOrg
 = 
pcPic
 ->
	`gëPicYuvOrg
();

3314 c⁄° 
I¡
 
cuºQuÆôyLayî
 = (
pcPic
->
	`gëSli˚
(0)->
	`gëSli˚Ty≥
(Ë!
I_SLICE
Ë? 
m_pcCfg
->
	`gëGOPE¡ry
(
g›ID
).
m_ãmp‹ÆId
+1 : 0;

3315 
	`as£π
(
cuºQuÆôyLayî
 <
MAX_ENCODER_DEBLOCKING_QUALITY_LAYERS
);

3317 if(!
m_pcDeblockögTempPicYuv
)

3319 
m_pcDeblockögTempPicYuv
 = 
√w
 
TComPicYuv
;

3320 
m_pcDeblockögTempPicYuv
->
	`¸óã
–
m_pcEncT›
->
	`gëSour˚Width
(), m_pcEncT›->
	`gëSour˚Height
(), m_pcEncT›->
	`gëChromaF‹m©Idc
(), 
pcPic
->
	`gëSli˚
(0)->
	`gëSPS
()->
	`gëMaxCUWidth
(),ÖcPic->gëSli˚(0)->gëSPS()->
	`gëMaxCUHeight
(),ÖcPic->gëSli˚(0)->gëSPS()->
	`gëMaxTŸÆCUDïth
(),
åue
 );

3321 
	`mem£t
(
m_DBP¨am
, 0, (m_DBParam));

3325 
pcPicYuvRec
->
	`c›yToPic
(
m_pcDeblockögTempPicYuv
);

3327 c⁄° 
Boﬁ
 
bNoFûãrög
 = 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_PARAM_AVAILABLE
] && m_DBP¨am[cuºQuÆôyLayî][
DBFLT_DISABLE_FLAG
]==
Ál£
 ;

3328 c⁄° 
I¡
 
maxBëaOff£tDiv2
 = 
bNoFûãrög
? 
	`Clù3
(
MIN_BETA_OFFSET
, 
MAX_BETA_OFFSET
, 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_BETA_OFFSETD2
]+1) : MAX_BETA_OFFSET;

3329 c⁄° 
I¡
 
möBëaOff£tDiv2
 = 
bNoFûãrög
? 
	`Clù3
(
MIN_BETA_OFFSET
, 
MAX_BETA_OFFSET
, 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_BETA_OFFSETD2
]-1) : MIN_BETA_OFFSET;

3330 c⁄° 
I¡
 
maxTcOff£tDiv2
 = 
bNoFûãrög
? 
	`Clù3
(
MIN_TC_OFFSET
, 
MAX_TC_OFFSET
, 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_TC_OFFSETD2
]+2) : MAX_TC_OFFSET;

3331 c⁄° 
I¡
 
möTcOff£tDiv2
 = 
bNoFûãrög
? 
	`Clù3
(
MIN_TC_OFFSET
, 
MAX_TC_OFFSET
, 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_TC_OFFSETD2
]-2) : MIN_TC_OFFSET;

3333 
UI¡64
 
di°BëaPªvious
 = 
°d
::
numîic_limôs
<UI¡64>::
	`max
();

3334 
UI¡64
 
di°Mö
 = 
°d
::
numîic_limôs
<UI¡64>::
	`max
();

3335 
Boﬁ
 
bDBFûãrDißbÀdBe°
 = 
åue
;

3336 
I¡
 
bëaOff£tDiv2Be°
 = 0;

3337 
I¡
 
tcOff£tDiv2Be°
 = 0;

3339 
I¡
 
bëaOff£tDiv2
=
maxBëaOff£tDiv2
; bëaOff£tDiv2>=
möBëaOff£tDiv2
; betaOffsetDiv2--)

3341 
UI¡64
 
di°TcMö
 = 
°d
::
numîic_limôs
<UI¡64>::
	`max
();

3342 
I¡
 
tcOff£tDiv2
=
maxTcOff£tDiv2
;ÅcOff£tDiv2 >
möTcOff£tDiv2
;ÅcOffsetDiv2--)

3344 
I¡
 
i
=0; i<
numSli˚s
; i++)

3346 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrOvîrideFœg
(
åue
);

3347 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrDißbÀ
(
Ál£
);

3348 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrBëaOff£tDiv2
–
bëaOff£tDiv2
 );

3349 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrTcOff£tDiv2
–
tcOff£tDiv2
 );

3351 
m_pcDeblockögTempPicYuv
->
	`c›yToPic
(
pcPicYuvRec
);

3352 
m_pcLo›Fûãr
->
	`lo›FûãrPic
–
pcPic
 );

3353 c⁄° 
UI¡64
 
di°
 = 
	`xFödDi°‹ti⁄Føme
(
pcPicYuvOrg
, 
pcPicYuvRec
, 
pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïths
());

3354 if(
di°
 < 
di°Mö
)

3356 
di°Mö
 = 
di°
;

3357 
bDBFûãrDißbÀdBe°
 = 
Ál£
;

3358 
bëaOff£tDiv2Be°
 = 
bëaOff£tDiv2
;

3359 
tcOff£tDiv2Be°
 = 
tcOff£tDiv2
;

3361 if(
di°
 < 
di°TcMö
)

3363 
di°TcMö
 = 
di°
;

3365 if(
tcOff£tDiv2
 <-2)

3370 if(
bëaOff£tDiv2
<-1 && 
di°TcMö
 >
di°BëaPªvious
)

3374 
di°BëaPªvious
 = 
di°TcMö
;

3378 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_PARAM_AVAILABLE
] = 1;

3379 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_DISABLE_FLAG
] = 
bDBFûãrDißbÀdBe°
;

3380 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_BETA_OFFSETD2
] = 
bëaOff£tDiv2Be°
;

3381 
m_DBP¨am
[
cuºQuÆôyLayî
][
DBFLT_TC_OFFSETD2
] = 
tcOff£tDiv2Be°
;

3383 
m_pcDeblockögTempPicYuv
->
	`c›yToPic
(
pcPicYuvRec
);

3385 if(
bDBFûãrDißbÀdBe°
)

3387 
I¡
 
i
=0; i<
numSli˚s
; i++)

3389 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrOvîrideFœg
(
åue
);

3390 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrDißbÀ
(
åue
);

3393 if(
bëaOff£tDiv2Be°
 ==
pcPic
->
	`gëSli˚
(0)->
	`gëPPS
()->
	`gëDeblockögFûãrBëaOff£tDiv2
(Ë&& 
tcOff£tDiv2Be°
=ıcPic->gëSli˚(0)->gëPPS()->
	`gëDeblockögFûãrTcOff£tDiv2
())

3395 
I¡
 
i
=0; i<
numSli˚s
; i++)

3397 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrOvîrideFœg
(
Ál£
);

3398 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrDißbÀ
–pcPic->gëSli˚(i)->
	`gëPPS
()->
	`gëPPSDeblockögFûãrDißbÀdFœg
() );

3399 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrBëaOff£tDiv2
–pcPic->gëSli˚(i)->
	`gëPPS
()->
	`gëDeblockögFûãrBëaOff£tDiv2
() );

3400 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrTcOff£tDiv2
–pcPic->gëSli˚(i)->
	`gëPPS
()->
	`gëDeblockögFûãrTcOff£tDiv2
() );

3405 
I¡
 
i
=0; i<
numSli˚s
; i++)

3407 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrOvîrideFœg
(
åue
);

3408 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrDißbÀ
–
Ál£
 );

3409 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrBëaOff£tDiv2
(
bëaOff£tDiv2Be°
);

3410 
pcPic
->
	`gëSli˚
(
i
)->
	`£tDeblockögFûãrTcOff£tDiv2
(
tcOff£tDiv2Be°
);

3413 
	}
}

	@TLibEncoder/TEncGOP.h

38 #i‚de‡
__TENCGOP__


39 
	#__TENCGOP__


	)

41 
	~<li°
>

43 
	~<°dlib.h
>

45 
	~"TLibComm⁄/TComLi°.h
"

46 
	~"TLibComm⁄/TComPic.h
"

47 
	~"TLibComm⁄/TComBôCou¡î.h
"

48 
	~"TLibComm⁄/TComLo›Fûãr.h
"

49 
	~"TLibComm⁄/Ac˚ssUnô.h
"

50 
	~"TEncSam∂eAd≠tiveOff£t.h
"

51 
	~"TEncSli˚.h
"

52 
	~"TEncE¡r›y.h
"

53 
	~"TEncCavlc.h
"

54 
	~"TEncSbac.h
"

55 
	~"SEIwrôe.h
"

56 
	~"SEIEncodî.h
"

57 #i‡
EXTENSION_360_VIDEO


58 
	~"TAµEncHñ≥r360/TExt360EncG›.h
"

61 
	~"TEncA«lyze.h
"

62 
	~"TEncR©eCål.h
"

63 
	~<ve˘‹
>

68 
˛ass
 
	gTEncT›
;

74 ˛as†
	cTEncGOP


76 ˛as†
	cDUD©a


78 
	mpublic
:

79 
DUD©a
()

80 :
accumBôsDU
(0)

81 ,
accumNÆsDU
(0) {};

83 
I¡
 
	maccumBôsDU
;

84 
I¡
 
	maccumNÆsDU
;

87 
	g¥iv©e
:

89 
TEncA«lyze
 
m_gcA«lyzeAŒ
;

90 
TEncA«lyze
 
	gm_gcA«lyzeI
;

91 
TEncA«lyze
 
	gm_gcA«lyzeP
;

92 
TEncA«lyze
 
	gm_gcA«lyzeB
;

94 
TEncA«lyze
 
	gm_gcA«lyzeAŒ_ö
;

96 #i‡
EXTENSION_360_VIDEO


97 
TExt360EncG›
 
	gm_ext360
;

98 
	gpublic
:

99 
TExt360EncG›
 &
	$gëExt360D©a
(Ë{  
m_ext360
; 
	}
}

100 
	g¥iv©e
:

104 
Boﬁ
 
m_bL⁄gãrmTe°Pi˘uªHasBìnCoded
;

105 
Boﬁ
 
	gm_bL⁄gãrmTe°Pi˘uªHasBìnCoded2
;

106 
UI¡
 
	gm_numL⁄gTîmRefPicSPS
;

107 
UI¡
 
	gm_…RefPicPocLsbSps
[
MAX_NUM_LONG_TERM_REF_PICS
];

108 
Boﬁ
 
	gm_…RefPicU£dByCuºPicFœg
[
MAX_NUM_LONG_TERM_REF_PICS
];

109 
I¡
 
	gm_iLa°IDR
;

110 
I¡
 
	gm_RASPOCf‹Re£tEncodî
;

111 
I¡
 
	gm_iG›Size
;

112 
I¡
 
	gm_iNumPicCoded
;

113 
Boﬁ
 
	gm_bFú°
;

114 
I¡
 
	gm_iLa°RecovîyPicPOC
;

117 
TEncT›
* 
	gm_pcEncT›
;

118 
TEncCfg
* 
	gm_pcCfg
;

119 
TEncSli˚
* 
	gm_pcSli˚Encodî
;

120 
	gTComLi°
<
	gTComPic
*>* 
	gm_pcLi°Pic
;

122 
TEncE¡r›y
* 
	gm_pcE¡r›yCodî
;

123 
TEncCavlc
* 
	gm_pcCavlcCodî
;

124 
TEncSbac
* 
	gm_pcSbacCodî
;

125 
TEncBöCABAC
* 
	gm_pcBöCABAC
;

126 
TComLo›Fûãr
* 
	gm_pcLo›Fûãr
;

128 
SEIWrôî
 
	gm_£iWrôî
;

131 
TEncSam∂eAd≠tiveOff£t
* 
	gm_pcSAO
;

132 
TEncR©eCål
* 
	gm_pcR©eCål
;

134 
Boﬁ
 
	gm_bSeqFú°
;

137 
Boﬁ
 
	gm_bRe‰eshPídög
;

138 
I¡
 
	gm_pocCRA
;

139 
NÆUnôTy≥
 
	gm_assocüãdIRAPTy≥
;

140 
I¡
 
	gm_assocüãdIRAPPOC
;

142 
	g°d
::
ve˘‹
<
I¡
> 
m_vRVM_RP
;

143 
UI¡
 
	gm_œ°BPSEI
;

144 
UI¡
 
	gm_tŸÆCoded
;

145 
Boﬁ
 
	gm_buf„rögPîiodSEIPª£¡InAU
;

146 
SEIEncodî
 
	gm_£iEncodî
;

147 
TComPicYuv
* 
	gm_pcDeblockögTempPicYuv
;

148 
I¡
 
	gm_DBP¨am
[
MAX_ENCODER_DEBLOCKING_QUALITY_LAYERS
][4];

150 
	gpublic
:

151 
TEncGOP
();

152 
	gvútuÆ
 ~
TEncGOP
();

154 
Void
 
¸óã
 ();

155 
Void
 
de°roy
 ();

157 
Void
 
öô
 ( 
TEncT›
* 
pcTEncT›
 );

158 
Void
 
com¥essGOP
 ( 
I¡
 
iPOCLa°
, I¡ 
iNumPicRcvd
, 
TComLi°
<
TComPic
*>& 
rcLi°Pic
, TComLi°<
TComPicYuv
*>& 
rcLi°PicYuvRec
,

159 
°d
::
li°
<
Ac˚ssUnô
>& 
ac˚ssUnôsInGOP
, 
Boﬁ
 
isFõld
, Boﬁ 
isTff
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ù_c⁄vîsi⁄
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢r_c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
 );

160 
Void
 
xAâachSli˚D©aToNÆUnô
 (
OuçutNALUnô
& 
rNÆu
, 
TComOuçutBô°ªam
* 
pcBô°ªamRedúe˘
);

163 
I¡
 
	$gëGOPSize
(Ë{  
m_iG›Size
; 
	}
}

165 
	gTComLi°
<
	gTComPic
*>* 
	$gëLi°Pic
(Ë{  
m_pcLi°Pic
; 
	}
}

167 
Void
 
¥ötOutSumm¨y
 ( 
UI¡
 
uiNumAŒPicCoded
, 
Boﬁ
 
isFõld
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, c⁄° 
BôDïths
 &
bôDïths
 );

169 
Void
 
¥eLo›FûãrPicAŒ
 ( 
TComPic
* 
pcPic
, 
UI¡64
& 
ruiDi°
 );

171 
TEncSli˚
* 
	$gëSli˚Encodî
(Ë{  
m_pcSli˚Encodî
; 
	}
}

172 
NÆUnôTy≥
 
gëNÆUnôTy≥
–
I¡
 
pocCuº
, I¡ 
œ°Idr
, 
Boﬁ
 
isFõld
 );

173 
Void
 
¨øngeL⁄gãrmPi˘uªsInRPS
(
TComSli˚
 *, 
TComLi°
<
TComPic
*>& );

175 
	gTEncA«lyze
& 
	$gëA«lyzeAŒD©a
(Ë{  
m_gcA«lyzeAŒ
; 
	}
}

176 
	gTEncA«lyze
& 
	$gëA«lyzeID©a
(Ë{  
m_gcA«lyzeI
; 
	}
}

177 
	gTEncA«lyze
& 
	$gëA«lyzePD©a
(Ë{  
m_gcA«lyzeP
; 
	}
}

178 
	gTEncA«lyze
& 
	$gëA«lyzeBD©a
(Ë{  
m_gcA«lyzeB
; 
	}
}

180 #i‡
MCTS_EXTRACTION


181 
Void
 
gíî©eVPS_RBSP
(
TComBôIf
* 
rb•
, c⁄° 
TComVPS
 *
vps
);

182 
Void
 
gíî©eSPS_RBSP
(
TComBôIf
* 
rb•
, c⁄° 
TComSPS
 *
•s
);

183 
Void
 
gíî©ePPS_RBSP
(
TComBôIf
* 
rb•
, c⁄° 
TComPPS
 *
µs
);

186 
	g¥Ÿe˘ed
:

187 
TEncR©eCål
* 
	$gëR©eCål
(Ë{  
m_pcR©eCål
; 
	}
}

189 
	g¥Ÿe˘ed
:

191 
Void
 
xInôGOP
 ( 
I¡
 
iPOCLa°
, I¡ 
iNumPicRcvd
, 
Boﬁ
 
isFõld
 );

192 
Void
 
xGëBuf„r
 ( 
TComLi°
<
TComPic
*>& 
rcLi°Pic
, TComLi°<
TComPicYuv
*>& 
rcLi°PicYuvRecOut
, 
I¡
 
iNumPicRcvd
, I¡ 
iTimeOff£t
, TComPic*& 
ΩcPic
, TComPicYuv*& 
ΩcPicYuvRecOut
, I¡ 
pocCuº
, 
Boﬁ
 
isFõld
 );

194 
Void
 
xCÆcuœãAddPSNRs
 ( c⁄° 
Boﬁ
 
isFõld
, c⁄° Boﬁ 
isFõldT›FõldFú°
, c⁄° 
I¡
 
iGOPid
, 
TComPic
* 
pcPic
, c⁄° 
Ac˚ssUnô
&
ac˚ssUnô
, 
TComLi°
<TComPic*> &
rcLi°Pic
, 
DoubÀ
 
dEncTime
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ù_c⁄vîsi⁄
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢r_c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, DoubÀ* 
PSNR_Y
 );

195 
Void
 
xCÆcuœãAddPSNR
 ( 
TComPic
* 
pcPic
, 
TComPicYuv
* 
pcPicD
, c⁄° 
Ac˚ssUnô
&, 
DoubÀ
 
dEncTime
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ù_c⁄vîsi⁄
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢r_c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, DoubÀ* 
PSNR_Y
 );

196 
Void
 
xCÆcuœãI¡îœ˚dAddPSNR
–
TComPic
* 
pcPicOrgFú°Fõld
, TComPic* 
pcPicOrgSec⁄dFõld
,

197 
TComPicYuv
* 
pcPicRecFú°Fõld
, TComPicYuv* 
pcPicRecSec⁄dFõld
,

198 c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
¢r_c⁄vîsi⁄
, c⁄° 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 &
ouçutLogCål
, 
DoubÀ
* 
PSNR_Y
 );

199 
DoubÀ
 
xCÆcuœãMSSSIM
 (c⁄° 
Pñ
 *
pOrg
, c⁄° 
I¡
 
‹gSåide
, c⁄° Pñ* 
pRec
, c⁄° I¡ 
ªcSåide
, c⁄° I¡ 
width
, c⁄° I¡ 
height
, c⁄° 
UI¡
 
bôDïth
);

201 
UI¡64
 
xFödDi°‹ti⁄Føme
 (
TComPicYuv
* 
pcPic0
, TComPicYuv* 
pcPic1
, c⁄° 
BôDïths
 &
bôDïths
);

203 
DoubÀ
 
xCÆcuœãRVM
();

205 
Void
 
xWrôeAc˚ssUnôDñimôî
 (
Ac˚ssUnô
 &
ac˚ssUnô
, 
TComSli˚
 *
¶i˚
);

206 #i‡
MCTS_EXTRACTION


207 
Void
 
xCª©eIRAPLódögSEIMesßges
 (
SEIMesßges
& 
£iMesßges
, c⁄° 
TComVPS
 *
vps
, c⁄° 
TComSPS
 *
•s
, c⁄° 
TComPPS
 *
µs
);

209 
Void
 
xCª©eIRAPLódögSEIMesßges
 (
SEIMesßges
& 
£iMesßges
, c⁄° 
TComSPS
 *
•s
, c⁄° 
TComPPS
 *
µs
);

211 
Void
 
xCª©ePîPi˘uªSEIMesßges
 (
I¡
 
picInGOP
, 
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
√°edSeiMesßges
, 
TComSli˚
 *
¶i˚
);

212 
Void
 
xCª©ePi˘uªTimögSEI
 (
I¡
 
IRAPGOPid
, 
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
√°edSeiMesßges
, SEIMesßges& 
duInfoSeiMesßges
, 
TComSli˚
 *
¶i˚
, 
Boﬁ
 
isFõld
, 
°d
::
deque
<
DUD©a
> &
duD©a
);

213 
Void
 
xUpd©eDuD©a
(
Ac˚ssUnô
 &
ã°AU
, 
°d
::
deque
<
DUD©a
> &
duD©a
);

214 
Void
 
xUpd©eTimögSEI
(
SEIPi˘uªTimög
 *
pi˘uªTimögSEI
, 
°d
::
deque
<
DUD©a
> &
duD©a
, c⁄° 
TComSPS
 *
•s
);

215 
Void
 
xUpd©eDuInfoSEI
(
SEIMesßges
 &
duInfoSeiMesßges
, 
SEIPi˘uªTimög
 *
pi˘uªTimögSEI
);

217 
Void
 
xCª©eSˇœbÀNe°ögSEI
 (
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
√°edSeiMesßges
);

218 
Void
 
xWrôeSEI
 (
NÆUnôTy≥
 
«luTy≥
, 
SEIMesßges
& 
£iMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, Ac˚ssUnô::
ôî©‹
 &
auPos
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
);

219 
Void
 
xWrôeSEISï¨©ñy
 (
NÆUnôTy≥
 
«luTy≥
, 
SEIMesßges
& 
£iMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, Ac˚ssUnô::
ôî©‹
 &
auPos
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
);

220 
Void
 
xCÀ¨SEIs
(
SEIMesßges
& 
£iMesßges
, 
Boﬁ
 
dñëeMesßges
);

221 
Void
 
xWrôeLódögSEIOrdîed
 (
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
duInfoSeiMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
, 
Boﬁ
 
ã°Wrôe
);

222 
Void
 
xWrôeLódögSEIMesßges
 (
SEIMesßges
& 
£iMesßges
, SEIMesßges& 
duInfoSeiMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
, 
°d
::
deque
<
DUD©a
> &
duD©a
);

223 
Void
 
xWrôeTøûögSEIMesßges
 (
SEIMesßges
& 
£iMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
);

224 
Void
 
xWrôeDuSEIMesßges
 (
SEIMesßges
& 
duInfoSeiMesßges
, 
Ac˚ssUnô
 &
ac˚ssUnô
, 
I¡
 
ãmp‹ÆId
, c⁄° 
TComSPS
 *
•s
, 
°d
::
deque
<
DUD©a
> &
duD©a
);

226 
I¡
 
xWrôeVPS
 (
Ac˚ssUnô
 &
ac˚ssUnô
, c⁄° 
TComVPS
 *
vps
);

227 
I¡
 
xWrôeSPS
 (
Ac˚ssUnô
 &
ac˚ssUnô
, c⁄° 
TComSPS
 *
•s
);

228 
I¡
 
xWrôePPS
 (
Ac˚ssUnô
 &
ac˚ssUnô
, c⁄° 
TComPPS
 *
µs
);

229 
I¡
 
xWrôeP¨amëîSës
 (
Ac˚ssUnô
 &
ac˚ssUnô
, 
TComSli˚
 *
¶i˚
, c⁄° 
Boﬁ
 
bSeqFú°
);

231 
Void
 
≠∂yDeblockögFûãrMëric
–
TComPic
* 
pcPic
, 
UI¡
 
uiNumSli˚s
 );

232 
Void
 
≠∂yDeblockögFûãrP¨amëîSñe˘i⁄
–
TComPic
* 
pcPic
, c⁄° 
UI¡
 
numSli˚s
, c⁄° 
I¡
 
g›ID
 );

	@TLibEncoder/TEncPic.cpp

38 
	~"TEncPic.h
"

45 
	gTEncQPAd≠èti⁄Unô
::
	$TEncQPAd≠èti⁄Unô
()

46 : 
	$m_dA˘ivôy
(0.0)

48 
	}
}

52 
TEncQPAd≠èti⁄Unô
::~
	$TEncQPAd≠èti⁄Unô
()

54 
	}
}

58 
TEncPicQPAd≠èti⁄Layî
::
	$TEncPicQPAd≠èti⁄Layî
()

59 : 
	`m_uiAQP¨tWidth
(0)

60 , 
	`m_uiAQP¨tHeight
(0)

61 , 
	`m_uiNumAQP¨tInWidth
(0)

62 , 
	`m_uiNumAQP¨tInHeight
(0)

63 , 
	`m_acTEncAQU
(
NULL
)

64 , 
	$m_dAvgA˘ivôy
(0.0)

66 
	}
}

70 
	gTEncPicQPAd≠èti⁄Layî
::~
	$TEncPicQPAd≠èti⁄Layî
()

72 
	`de°roy
();

73 
	}
}

82 
Void
 
	gTEncPicQPAd≠èti⁄Layî
::
	$¸óã
–
I¡
 
iWidth
, I¡ 
iHeight
, 
UI¡
 
uiAQP¨tWidth
, UI¡ 
uiAQP¨tHeight
 )

84 
m_uiAQP¨tWidth
 = 
uiAQP¨tWidth
;

85 
m_uiAQP¨tHeight
 = 
uiAQP¨tHeight
;

86 
m_uiNumAQP¨tInWidth
 = (
iWidth
 + 
m_uiAQP¨tWidth
-1) / m_uiAQPartWidth;

87 
m_uiNumAQP¨tInHeight
 = (
iHeight
 + 
m_uiAQP¨tHeight
-1) / m_uiAQPartHeight;

88 
m_acTEncAQU
 = 
√w
 
TEncQPAd≠èti⁄Unô
[ 
m_uiNumAQP¨tInWidth
 * 
m_uiNumAQP¨tInHeight
 ];

89 
	}
}

94 
Void
 
	gTEncPicQPAd≠èti⁄Layî
::
	$de°roy
()

96 i‡(
m_acTEncAQU
)

98 
dñëe
[] 
m_acTEncAQU
;

99 
m_acTEncAQU
 = 
NULL
;

101 
	}
}

105 
	gTEncPic
::
	$TEncPic
()

106 : 
	`m_acAQLayî
(
NULL
)

107 , 
	$m_uiMaxAQDïth
(0)

109 
	}
}

113 
	gTEncPic
::~
	$TEncPic
()

115 
	`de°roy
();

116 
	}
}

124 #i‡
REDUCED_ENCODER_MEMORY


125 
Void
 
	gTEncPic
::
	$¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxAd≠tiveQPDïth
 )

127 
TComPic
::
	`¸óã
–
•s
, 
µs
, 
åue
, 
Ál£
 );

129 
Void
 
TEncPic
::
	$¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxAd≠tiveQPDïth
, 
Boﬁ
 
bIsVútuÆ
 )

131 
TComPic
::
	`¸óã
–
•s
, 
µs
, 
bIsVútuÆ
 );

133 c⁄° 
I¡
 
iWidth
 = 
•s
.
	`gëPicWidthInLumaSam∂es
();

134 c⁄° 
I¡
 
iHeight
 = 
•s
.
	`gëPicHeightInLumaSam∂es
();

135 c⁄° 
UI¡
 
uiMaxWidth
 = 
•s
.
	`gëMaxCUWidth
();

136 c⁄° 
UI¡
 
uiMaxHeight
 = 
•s
.
	`gëMaxCUHeight
();

137 
m_uiMaxAQDïth
 = 
uiMaxAd≠tiveQPDïth
;

138 i‡–
uiMaxAd≠tiveQPDïth
 > 0 )

140 
m_acAQLayî
 = 
√w
 
TEncPicQPAd≠èti⁄Layî
[ 
m_uiMaxAQDïth
 ];

141 
UI¡
 
d
 = 0; d < 
m_uiMaxAQDïth
; d++)

143 
m_acAQLayî
[
d
].
	`¸óã
–
iWidth
, 
iHeight
, 
uiMaxWidth
>>d, 
uiMaxHeight
>>d );

146 
	}
}

149 
Void
 
	gTEncPic
::
	$de°roy
()

151 i‡(
m_acAQLayî
)

153 
dñëe
[] 
m_acAQLayî
;

154 
m_acAQLayî
 = 
NULL
;

156 
TComPic
::
	`de°roy
();

157 
	}
}

	@TLibEncoder/TEncPic.h

38 #i‚de‡
__TENCPIC__


39 
	#__TENCPIC__


	)

41 
	~"TLibComm⁄/Comm⁄Def.h
"

42 
	~"TLibComm⁄/TComPic.h
"

52 ˛as†
	cTEncQPAd≠èti⁄Unô


54 
	m¥iv©e
:

55 
DoubÀ
 
m_dA˘ivôy
;

57 
	mpublic
:

58 
TEncQPAd≠èti⁄Unô
();

59 ~
TEncQPAd≠èti⁄Unô
();

61 
Void
 
	$£tA˘ivôy
–
DoubÀ
 
d
 ) { 
m_dA˘ivôy
 = d; }

62 
DoubÀ
 
	$gëA˘ivôy
(Ë{  
m_dA˘ivôy
; 
	}
}

66 ˛as†
	cTEncPicQPAd≠èti⁄Layî


68 
	m¥iv©e
:

69 
UI¡
 
m_uiAQP¨tWidth
;

70 
UI¡
 
	mm_uiAQP¨tHeight
;

71 
UI¡
 
	mm_uiNumAQP¨tInWidth
;

72 
UI¡
 
	mm_uiNumAQP¨tInHeight
;

73 
TEncQPAd≠èti⁄Unô
* 
	mm_acTEncAQU
;

74 
DoubÀ
 
	mm_dAvgA˘ivôy
;

76 
	mpublic
:

77 
TEncPicQPAd≠èti⁄Layî
();

78 
	mvútuÆ
 ~
TEncPicQPAd≠èti⁄Layî
();

80 
Void
 
¸óã
–
I¡
 
iWidth
, I¡ 
iHeight
, 
UI¡
 
uiAQP¨tWidth
, UI¡ 
uiAQP¨tHeight
 );

81 
Void
 
de°roy
();

83 
UI¡
 
	$gëAQP¨tWidth
(Ë{  
m_uiAQP¨tWidth
; }

84 
UI¡
 
	$gëAQP¨tHeight
(Ë{  
m_uiAQP¨tHeight
; 
	}
}

85 
UI¡
 
	$gëNumAQP¨tInWidth
(Ë{  
m_uiNumAQP¨tInWidth
; 
	}
}

86 
UI¡
 
	$gëNumAQP¨tInHeight
(Ë{  
m_uiNumAQP¨tInHeight
; 
	}
}

87 
UI¡
 
	$gëAQP¨tSåide
(Ë{  
m_uiNumAQP¨tInWidth
; 
	}
}

88 
TEncQPAd≠èti⁄Unô
* 
	$gëQPAd≠èti⁄Unô
(Ë{  
m_acTEncAQU
; 
	}
}

89 
DoubÀ
 
	$gëAvgA˘ivôy
(Ë{  
m_dAvgA˘ivôy
; 
	}
}

91 
Void
 
	$£tAvgA˘ivôy
–
DoubÀ
 
d
 ) { 
m_dAvgA˘ivôy
 = d; 
	}
}

95 ˛as†
	cTEncPic
 : 
public
 
TComPic


97 
¥iv©e
:

98 
TEncPicQPAd≠èti⁄Layî
* 
m_acAQLayî
;

99 
UI¡
 
	mm_uiMaxAQDïth
;

101 
	mpublic
:

102 
TEncPic
();

103 
	mvútuÆ
 ~
TEncPic
();

105 #i‡
REDUCED_ENCODER_MEMORY


106 
Void
 
¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxAd≠tiveQPDïth
 );

108 
Void
 
¸óã
–c⁄° 
TComSPS
 &
•s
, c⁄° 
TComPPS
 &
µs
, 
UI¡
 
uiMaxAd≠tiveQPDïth
, 
Boﬁ
 
bIsVútuÆ
 );

110 
vútuÆ
 
Void
 
de°roy
();

112 
TEncPicQPAd≠èti⁄Layî
* 
	$gëAQLayî
–
UI¡
 
uiDïth
 ) {  &
m_acAQLayî
[uiDepth]; }

113 
UI¡
 
	$gëMaxAQDïth
(Ë{  
m_uiMaxAQDïth
; 
	}
}

	@TLibEncoder/TEncPreanalyzer.cpp

38 
	~<cÊﬂt
>

39 
	~<Æg‹ôhm
>

41 
	~"TEncPª™Æyzî.h
"

43 
usög
 
«me•a˚
 
	g°d
;

50 
	gTEncPª™Æyzî
::
	$TEncPª™Æyzî
()

52 
	}
}

56 
TEncPª™Æyzî
::~
	$TEncPª™Æyzî
()

58 
	}
}

64 
Void
 
TEncPª™Æyzî
::
	$xPª™Æyze
–
TEncPic
* 
pcEPic
 )

66 
TComPicYuv
* 
pcPicYuv
 = 
pcEPic
->
	`gëPicYuvOrg
();

67 c⁄° 
I¡
 
iWidth
 = 
pcPicYuv
->
	`gëWidth
(
COMPONENT_Y
);

68 c⁄° 
I¡
 
iHeight
 = 
pcPicYuv
->
	`gëHeight
(
COMPONENT_Y
);

69 c⁄° 
I¡
 
iSåide
 = 
pcPicYuv
->
	`gëSåide
(
COMPONENT_Y
);

71  
UI¡
 
d
 = 0; d < 
pcEPic
->
	`gëMaxAQDïth
(); d++ )

73 c⁄° 
Pñ
* 
pLöeY
 = 
pcPicYuv
->
	`gëAddr
(
COMPONENT_Y
);

74 
TEncPicQPAd≠èti⁄Layî
* 
pcAQLayî
 = 
pcEPic
->
	`gëAQLayî
(
d
);

75 c⁄° 
UI¡
 
uiAQP¨tWidth
 = 
pcAQLayî
->
	`gëAQP¨tWidth
();

76 c⁄° 
UI¡
 
uiAQP¨tHeight
 = 
pcAQLayî
->
	`gëAQP¨tHeight
();

77 
TEncQPAd≠èti⁄Unô
* 
pcAQU
 = 
pcAQLayî
->
	`gëQPAd≠èti⁄Unô
();

79 
DoubÀ
 
dSumA˘
 = 0.0;

80  
UI¡
 
y
 = 0; y < 
iHeight
; y +
uiAQP¨tHeight
 )

82 c⁄° 
UI¡
 
uiCuºAQP¨tHeight
 = 
	`mö
(
uiAQP¨tHeight
, 
iHeight
-
y
);

83  
UI¡
 
x
 = 0; x < 
iWidth
; x +
uiAQP¨tWidth
, 
pcAQU
++ )

85 c⁄° 
UI¡
 
uiCuºAQP¨tWidth
 = 
	`mö
(
uiAQP¨tWidth
, 
iWidth
-
x
);

86 c⁄° 
Pñ
* 
pBlkY
 = &
pLöeY
[
x
];

87 
UI¡64
 
uiSum
[4] = {0, 0, 0, 0};

88 
UI¡64
 
uiSumSq
[4] = {0, 0, 0, 0};

89 
UI¡
 
by
 = 0;

90  ; 
by
 < 
uiCuºAQP¨tHeight
>>1; by++ )

92 
UI¡
 
bx
 = 0;

93  ; 
bx
 < 
uiCuºAQP¨tWidth
>>1; bx++ )

95 
uiSum
 [0] +
pBlkY
[
bx
];

96 
uiSumSq
[0] +
pBlkY
[
bx
] *ÖBlkY[bx];

98  ; 
bx
 < 
uiCuºAQP¨tWidth
; bx++ )

100 
uiSum
 [1] +
pBlkY
[
bx
];

101 
uiSumSq
[1] +
pBlkY
[
bx
] *ÖBlkY[bx];

103 
pBlkY
 +
iSåide
;

105  ; 
by
 < 
uiCuºAQP¨tHeight
; by++ )

107 
UI¡
 
bx
 = 0;

108  ; 
bx
 < 
uiCuºAQP¨tWidth
>>1; bx++ )

110 
uiSum
 [2] +
pBlkY
[
bx
];

111 
uiSumSq
[2] +
pBlkY
[
bx
] *ÖBlkY[bx];

113  ; 
bx
 < 
uiCuºAQP¨tWidth
; bx++ )

115 
uiSum
 [3] +
pBlkY
[
bx
];

116 
uiSumSq
[3] +
pBlkY
[
bx
] *ÖBlkY[bx];

118 
pBlkY
 +
iSåide
;

121 
	`as£π
 ((
uiCuºAQP¨tWidth
&1)==0);

122 
	`as£π
 ((
uiCuºAQP¨tHeight
&1)==0);

123 c⁄° 
UI¡
 
pixñWidthOfQuadø¡s
 = 
uiCuºAQP¨tWidth
 >>1;

124 c⁄° 
UI¡
 
pixñHeightOfQuadø¡s
 = 
uiCuºAQP¨tHeight
>>1;

125 c⁄° 
UI¡
 
numPixInAQP¨t
 = 
pixñWidthOfQuadø¡s
 * 
pixñHeightOfQuadø¡s
;

127 
DoubÀ
 
dMöV¨
 = 
DBL_MAX
;

128 i‡(
numPixInAQP¨t
!=0)

130  
I¡
 
i
=0; i<4; i++)

132 c⁄° 
DoubÀ
 
dAvîage
 = 
	`DoubÀ
(
uiSum
[
i
]Ë/ 
numPixInAQP¨t
;

133 c⁄° 
DoubÀ
 
dV¨ün˚
 = 
	`DoubÀ
(
uiSumSq
[
i
]Ë/ 
numPixInAQP¨t
 - 
dAvîage
 * dAverage;

134 
dMöV¨
 = 
	`mö
(dMöV¨, 
dV¨ün˚
);

139 
dMöV¨
 = 0.0;

141 c⁄° 
DoubÀ
 
dA˘ivôy
 = 1.0 + 
dMöV¨
;

142 
pcAQU
->
	`£tA˘ivôy
–
dA˘ivôy
 );

143 
dSumA˘
 +
dA˘ivôy
;

145 
pLöeY
 +
iSåide
 * 
uiCuºAQP¨tHeight
;

148 c⁄° 
DoubÀ
 
dAvgA˘
 = 
dSumA˘
 / (
pcAQLayî
->
	`gëNumAQP¨tInWidth
(Ë*ÖcAQLayî->
	`gëNumAQP¨tInHeight
());

149 
pcAQLayî
->
	`£tAvgA˘ivôy
–
dAvgA˘
 );

151 
	}
}

	@TLibEncoder/TEncPreanalyzer.h

38 #i‚de‡
__TENCPREANALYZER__


39 
	#__TENCPREANALYZER__


	)

41 
	~"TEncPic.h
"

51 ˛as†
	cTEncPª™Æyzî


53 
	mpublic
:

54 
TEncPª™Æyzî
();

55 
	mvútuÆ
 ~
TEncPª™Æyzî
();

57 
Void
 
xPª™Æyze
–
TEncPic
* 
pcPic
 );

	@TLibEncoder/TEncRateCtrl.cpp

37 
	~"TEncR©eCål.h
"

38 
	~"../TLibComm⁄/TComPic.h
"

39 
	~"../TLibComm⁄/TComChromaF‹m©.h
"

41 
	~<cm©h
>

43 
usög
 
«me•a˚
 
	g°d
;

46 
	gTEncRCSeq
::
	$TEncRCSeq
()

48 
m_tŸÆFømes
 = 0;

49 
m_èrgëR©e
 = 0;

50 
m_‰ameR©e
 = 0;

51 
m_èrgëBôs
 = 0;

52 
m_GOPSize
 = 0;

53 
m_picWidth
 = 0;

54 
m_picHeight
 = 0;

55 
m_LCUWidth
 = 0;

56 
m_LCUHeight
 = 0;

57 
m_numbîOfLevñ
 = 0;

58 
m_numbîOfLCU
 = 0;

59 
m_avîageBôs
 = 0;

60 
m_bôsR©io
 = 
NULL
;

61 
m_GOPID2Levñ
 = 
NULL
;

62 
m_picP¨a
 = 
NULL
;

63 
m_LCUP¨a
 = 
NULL
;

64 
m_numbîOfPixñ
 = 0;

65 
m_‰amesLe·
 = 0;

66 
m_bôsLe·
 = 0;

67 
m_u£LCUSï¨©eModñ
 = 
Ál£
;

68 
m_ad≠tiveBô
 = 0;

69 
m_œ°Lambda
 = 0.0;

70 
	}
}

72 
	gTEncRCSeq
::~
	$TEncRCSeq
()

74 
	`de°roy
();

75 
	}
}

77 
Void
 
	gTEncRCSeq
::
	$¸óã
–
I¡
 
tŸÆFømes
, I¡ 
èrgëBôøã
, I¡ 
‰ameR©e
, I¡ 
GOPSize
, I¡ 
picWidth
, I¡ 
picHeight
, I¡ 
LCUWidth
, I¡ 
LCUHeight
, I¡ 
numbîOfLevñ
, 
Boﬁ
 
u£LCUSï¨©eModñ
, I¡ 
ad≠tiveBô
 )

79 
	`de°roy
();

80 
m_tŸÆFømes
 = 
tŸÆFømes
;

81 
m_èrgëR©e
 = 
èrgëBôøã
;

82 
m_‰ameR©e
 = 
‰ameR©e
;

83 
m_GOPSize
 = 
GOPSize
;

84 
m_picWidth
 = 
picWidth
;

85 
m_picHeight
 = 
picHeight
;

86 
m_LCUWidth
 = 
LCUWidth
;

87 
m_LCUHeight
 = 
LCUHeight
;

88 
m_numbîOfLevñ
 = 
numbîOfLevñ
;

89 
m_u£LCUSï¨©eModñ
 = 
u£LCUSï¨©eModñ
;

91 
m_numbîOfPixñ
 = 
m_picWidth
 * 
m_picHeight
;

92 
m_èrgëBôs
 = (
I¡64
)
m_tŸÆFømes
 * (I¡64)
m_èrgëR©e
 / (I¡64)
m_‰ameR©e
;

93 
m_£qT¨gëBµ
 = (
DoubÀ
)
m_èrgëR©e
 / (DoubÀ)
m_‰ameR©e
 / (DoubÀ)
m_numbîOfPixñ
;

94 i‡–
m_£qT¨gëBµ
 < 0.03 )

96 
m_ÆphaUpd©e
 = 0.01;

97 
m_bëaUpd©e
 = 0.005;

99 i‡–
m_£qT¨gëBµ
 < 0.08 )

101 
m_ÆphaUpd©e
 = 0.05;

102 
m_bëaUpd©e
 = 0.025;

104 i‡–
m_£qT¨gëBµ
 < 0.2 )

106 
m_ÆphaUpd©e
 = 0.1;

107 
m_bëaUpd©e
 = 0.05;

109 i‡–
m_£qT¨gëBµ
 < 0.5 )

111 
m_ÆphaUpd©e
 = 0.2;

112 
m_bëaUpd©e
 = 0.1;

116 
m_ÆphaUpd©e
 = 0.4;

117 
m_bëaUpd©e
 = 0.2;

120 
m_avîageBôs
 = (
I¡
)(
m_èrgëBôs
 / 
tŸÆFømes
);

121 
I¡
 
picWidthInBU
 = ( 
m_picWidth
 % 
m_LCUWidth
 ) == 0 ? m_picWidth / m_LCUWidth : m_picWidth / m_LCUWidth + 1;

122 
I¡
 
picHeightInBU
 = ( 
m_picHeight
 % 
m_LCUHeight
 ) == 0 ? m_picHeight / m_LCUHeight : m_picHeight / m_LCUHeight + 1;

123 
m_numbîOfLCU
 = 
picWidthInBU
 * 
picHeightInBU
;

125 
m_bôsR©io
 = 
√w
 
I¡
[
m_GOPSize
];

126  
I¡
 
i
=0; i<
m_GOPSize
; i++ )

128 
m_bôsR©io
[
i
] = 1;

131 
m_GOPID2Levñ
 = 
√w
 
I¡
[
m_GOPSize
];

132  
I¡
 
i
=0; i<
m_GOPSize
; i++ )

134 
m_GOPID2Levñ
[
i
] = 1;

137 
m_picP¨a
 = 
√w
 
TRCP¨amëî
[
m_numbîOfLevñ
];

138  
I¡
 
i
=0; i<
m_numbîOfLevñ
; i++ )

140 
m_picP¨a
[
i
].
m_Æpha
 = 0.0;

141 
m_picP¨a
[
i
].
m_bëa
 = 0.0;

142 #i‡
JVET_K0390_RATE_CTRL


143 
m_picP¨a
[
i
].
m_vÆidPix
 = -1;

145 #i‡
JVET_M0600_RATE_CTRL


146 
m_picP¨a
[
i
].
m_skùR©io
 = 0.0;

150 i‡–
m_u£LCUSï¨©eModñ
 )

152 
m_LCUP¨a
 = 
√w
 
TRCP¨amëî
*[
m_numbîOfLevñ
];

153  
I¡
 
i
=0; i<
m_numbîOfLevñ
; i++ )

155 
m_LCUP¨a
[
i
] = 
√w
 
TRCP¨amëî
[
m_numbîOfLCU
];

156  
I¡
 
j
=0; j<
m_numbîOfLCU
; j++)

158 
m_LCUP¨a
[
i
][
j
].
m_Æpha
 = 0.0;

159 
m_LCUP¨a
[
i
][
j
].
m_bëa
 = 0.0;

160 #i‡
JVET_K0390_RATE_CTRL


161 
m_LCUP¨a
[
i
][
j
].
m_vÆidPix
 = -1;

163 #i‡
JVET_M0600_RATE_CTRL


164 
m_LCUP¨a
[
i
][
j
].
m_skùR©io
 = 0.0;

170 
m_‰amesLe·
 = 
m_tŸÆFømes
;

171 
m_bôsLe·
 = 
m_èrgëBôs
;

172 
m_ad≠tiveBô
 = 
ad≠tiveBô
;

173 
m_œ°Lambda
 = 0.0;

174 
	}
}

176 
Void
 
	gTEncRCSeq
::
	$de°roy
()

178 i‡(
m_bôsR©io
 !
NULL
)

180 
dñëe
[] 
m_bôsR©io
;

181 
m_bôsR©io
 = 
NULL
;

184 i‡–
m_GOPID2Levñ
 !
NULL
 )

186 
dñëe
[] 
m_GOPID2Levñ
;

187 
m_GOPID2Levñ
 = 
NULL
;

190 i‡–
m_picP¨a
 !
NULL
 )

192 
dñëe
[] 
m_picP¨a
;

193 
m_picP¨a
 = 
NULL
;

196 i‡–
m_LCUP¨a
 !
NULL
 )

198  
I¡
 
i
=0; i<
m_numbîOfLevñ
; i++ )

200 
dñëe
[] 
m_LCUP¨a
[
i
];

202 
dñëe
[] 
m_LCUP¨a
;

203 
m_LCUP¨a
 = 
NULL
;

205 
	}
}

207 
Void
 
	gTEncRCSeq
::
	$öôBôsR©io
–
I¡
 
bôsR©io
[])

209 
I¡
 
i
=0; i<
m_GOPSize
; i++)

211 
m_bôsR©io
[
i
] = 
bôsR©io
[i];

213 
	}
}

215 
Void
 
	gTEncRCSeq
::
	$öôGOPID2Levñ
–
I¡
 
GOPID2Levñ
[] )

217  
I¡
 
i
=0; i<
m_GOPSize
; i++ )

219 
m_GOPID2Levñ
[
i
] = 
GOPID2Levñ
[i];

221 
	}
}

223 
Void
 
	gTEncRCSeq
::
	$öôPicP¨a
–
TRCP¨amëî
* 
picP¨a
 )

225 
	`as£π
–
m_picP¨a
 !
NULL
 );

227 i‡–
picP¨a
 =
NULL
 )

229  
I¡
 
i
=0; i<
m_numbîOfLevñ
; i++ )

231 i‡(
i
>0)

233 
m_picP¨a
[
i
].
m_Æpha
 = 3.2003;

234 
m_picP¨a
[
i
].
m_bëa
 = -1.367;

238 
m_picP¨a
[
i
].
m_Æpha
 = 
ALPHA
;

239 
m_picP¨a
[
i
].
m_bëa
 = 
BETA2
;

245  
I¡
 
i
=0; i<
m_numbîOfLevñ
; i++ )

247 
m_picP¨a
[
i
] = 
picP¨a
[i];

250 
	}
}

252 
Void
 
	gTEncRCSeq
::
	$öôLCUP¨a
–
TRCP¨amëî
** 
LCUP¨a
 )

254 i‡–
m_LCUP¨a
 =
NULL
 )

258 i‡–
LCUP¨a
 =
NULL
 )

260  
I¡
 
i
=0; i<
m_numbîOfLevñ
; i++ )

262  
I¡
 
j
=0; j<
m_numbîOfLCU
; j++)

264 
m_LCUP¨a
[
i
][
j
].
m_Æpha
 = 
m_picP¨a
[i].m_alpha;

265 
m_LCUP¨a
[
i
][
j
].
m_bëa
 = 
m_picP¨a
[i].m_beta;

271  
I¡
 
i
=0; i<
m_numbîOfLevñ
; i++ )

273  
I¡
 
j
=0; j<
m_numbîOfLCU
; j++)

275 
m_LCUP¨a
[
i
][
j
] = 
LCUP¨a
[i][j];

279 
	}
}

281 
Void
 
	gTEncRCSeq
::
	$upd©eA·îPic
 ( 
I¡
 
bôs
 )

283 
m_bôsLe·
 -
bôs
;

284 
m_‰amesLe·
--;

285 
	}
}

287 
Void
 
	gTEncRCSeq
::
	$£tAŒBôR©io
–
DoubÀ
 
basicLambda
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
 )

289 
I¡
* 
bôsR©io
 = 
√w
 I¡[
m_GOPSize
];

290  
I¡
 
i
=0; i<
m_GOPSize
; i++ )

292 #i‡
JVET_K0390_RATE_CTRL


293 
bôsR©io
[
i
] = (
I¡
)–
equaC€ffA
[i] * 
	`pow
(
basicLambda
, 
equaC€ffB
[i]Ë* (
DoubÀ
)
	`gëPicP¨a
(
	`gëGOPID2Levñ
(i)).
m_vÆidPix
);

295 
bôsR©io
[
i
] = (
I¡
)–
equaC€ffA
[i] * 
	`pow
–
basicLambda
, 
equaC€ffB
[i] ) * 
m_numbîOfPixñ
 );

298 
	`öôBôsR©io
–
bôsR©io
 );

299 
dñëe
[] 
bôsR©io
;

300 
	}
}

303 
	gTEncRCGOP
::
	$TEncRCGOP
()

305 
m_ícRCSeq
 = 
NULL
;

306 
m_picT¨gëBôInGOP
 = 
NULL
;

307 
m_numPic
 = 0;

308 
m_èrgëBôs
 = 0;

309 
m_picLe·
 = 0;

310 
m_bôsLe·
 = 0;

311 
	}
}

313 
	gTEncRCGOP
::~
	$TEncRCGOP
()

315 
	`de°roy
();

316 
	}
}

318 
Void
 
	gTEncRCGOP
::
	$¸óã
–
TEncRCSeq
* 
ícRCSeq
, 
I¡
 
numPic
 )

320 
	`de°roy
();

321 
I¡
 
èrgëBôs
 = 
	`xE°GOPT¨gëBôs
–
ícRCSeq
, 
numPic
 );

323 i‡–
ícRCSeq
->
	`gëAd≠tiveBôs
(Ë> 0 &&ÉncRCSeq->
	`gëLa°Lambda
() > 0.1 )

325 
DoubÀ
 
èrgëBµ
 = (DoubÀ)
èrgëBôs
 / 
ícRCSeq
->
	`gëNumPixñ
();

326 
DoubÀ
 
basicLambda
 = 0.0;

327 
DoubÀ
* 
œmbdaR©io
 = 
√w
 DoubÀ[
ícRCSeq
->
	`gëGOPSize
()];

328 
DoubÀ
* 
equaC€ffA
 = 
√w
 DoubÀ[
ícRCSeq
->
	`gëGOPSize
()];

329 
DoubÀ
* 
equaC€ffB
 = 
√w
 DoubÀ[
ícRCSeq
->
	`gëGOPSize
()];

331 i‡–
ícRCSeq
->
	`gëAd≠tiveBôs
() == 1 )

333 i‡–
ícRCSeq
->
	`gëLa°Lambda
() < 120.0 )

335 
œmbdaR©io
[1] = 0.725 * 
	`log
–
ícRCSeq
->
	`gëLa°Lambda
() ) + 0.5793;

336 
œmbdaR©io
[0] = 1.3 *ÜambdaRatio[1];

337 
œmbdaR©io
[2] = 1.3 *ÜambdaRatio[1];

338 
œmbdaR©io
[3] = 1.0;

342 
œmbdaR©io
[0] = 5.0;

343 
œmbdaR©io
[1] = 4.0;

344 
œmbdaR©io
[2] = 5.0;

345 
œmbdaR©io
[3] = 1.0;

348 i‡–
ícRCSeq
->
	`gëAd≠tiveBôs
() == 2 )

350 i‡–
ícRCSeq
->
	`gëLa°Lambda
() < 90.0 )

352 
œmbdaR©io
[0] = 1.0;

353 
œmbdaR©io
[1] = 0.725 * 
	`log
–
ícRCSeq
->
	`gëLa°Lambda
() ) + 0.7963;

354 
œmbdaR©io
[2] = 1.3 *ÜambdaRatio[1];

355 
œmbdaR©io
[3] = 3.25 *ÜambdaRatio[1];

356 
œmbdaR©io
[4] = 3.25 *ÜambdaRatio[1];

357 
œmbdaR©io
[5] = 1.3 *ÜambdaRatio[1];

358 
œmbdaR©io
[6] = 3.25 *ÜambdaRatio[1];

359 
œmbdaR©io
[7] = 3.25 *ÜambdaRatio[1];

363 
œmbdaR©io
[0] = 1.0;

364 
œmbdaR©io
[1] = 4.0;

365 
œmbdaR©io
[2] = 5.0;

366 
œmbdaR©io
[3] = 12.3;

367 
œmbdaR©io
[4] = 12.3;

368 
œmbdaR©io
[5] = 5.0;

369 
œmbdaR©io
[6] = 12.3;

370 
œmbdaR©io
[7] = 12.3;

373 #i‡
JVET_K0390_RATE_CTRL


374 i‡(
ícRCSeq
->
	`gëAd≠tiveBôs
() == 3)

376 
DoubÀ
 
hõørQp
 = 4.2005 * 
	`log
(
ícRCSeq
->
	`gëLa°Lambda
()) + 13.7122;

377 
DoubÀ
 
qpLev2
 = (
hõørQp
 + 0.0) + 0.2016 * (hierarQp + 0.0) - 4.8848;

378 
DoubÀ
 
qpLev3
 = (
hõørQp
 + 3.0) + 0.22286 * (hierarQp + 3.0) - 5.7476;

379 
DoubÀ
 
qpLev4
 = (
hõørQp
 + 4.0) + 0.2333 * (hierarQp + 4.0) - 5.9;

380 
DoubÀ
 
qpLev5
 = (
hõørQp
 + 5.0) + 0.3 * (hierarQp + 5.0) - 7.1444;

382 
DoubÀ
 
œmbdaLev1
 = 
	`exp
((
hõørQp
 - 13.7122) / 4.2005);

383 
DoubÀ
 
œmbdaLev2
 = 
	`exp
((
qpLev2
 - 13.7122) / 4.2005);

384 
DoubÀ
 
œmbdaLev3
 = 
	`exp
((
qpLev3
 - 13.7122) / 4.2005);

385 
DoubÀ
 
œmbdaLev4
 = 
	`exp
((
qpLev4
 - 13.7122) / 4.2005);

386 
DoubÀ
 
œmbdaLev5
 = 
	`exp
((
qpLev5
 - 13.7122) / 4.2005);

388 
œmbdaR©io
[0] = 1.0;

389 
œmbdaR©io
[1] = 
œmbdaLev2
 / 
œmbdaLev1
;

390 
œmbdaR©io
[2] = 
œmbdaLev3
 / 
œmbdaLev1
;

391 
œmbdaR©io
[3] = 
œmbdaLev4
 / 
œmbdaLev1
;

392 
œmbdaR©io
[4] = 
œmbdaLev5
 / 
œmbdaLev1
;

393 
œmbdaR©io
[5] = 
œmbdaLev5
 / 
œmbdaLev1
;

394 
œmbdaR©io
[6] = 
œmbdaLev4
 / 
œmbdaLev1
;

395 
œmbdaR©io
[7] = 
œmbdaLev5
 / 
œmbdaLev1
;

396 
œmbdaR©io
[8] = 
œmbdaLev5
 / 
œmbdaLev1
;

397 
œmbdaR©io
[9] = 
œmbdaLev3
 / 
œmbdaLev1
;

398 
œmbdaR©io
[10] = 
œmbdaLev4
 / 
œmbdaLev1
;

399 
œmbdaR©io
[11] = 
œmbdaLev5
 / 
œmbdaLev1
;

400 
œmbdaR©io
[12] = 
œmbdaLev5
 / 
œmbdaLev1
;

401 
œmbdaR©io
[13] = 
œmbdaLev4
 / 
œmbdaLev1
;

402 
œmbdaR©io
[14] = 
œmbdaLev5
 / 
œmbdaLev1
;

403 
œmbdaR©io
[15] = 
œmbdaLev5
 / 
œmbdaLev1
;

404 #i‡
JVET_M0600_RATE_CTRL


405 c⁄° 
DoubÀ
 
qdfP¨aLev2A
 = 0.5847;

406 c⁄° 
DoubÀ
 
qdfP¨aLev2B
 = -0.0782;

407 c⁄° 
DoubÀ
 
qdfP¨aLev3A
 = 0.5468;

408 c⁄° 
DoubÀ
 
qdfP¨aLev3B
 = -0.1364;

409 c⁄° 
DoubÀ
 
qdfP¨aLev4A
 = 0.6539;

410 c⁄° 
DoubÀ
 
qdfP¨aLev4B
 = -0.203;

411 c⁄° 
DoubÀ
 
qdfP¨aLev5A
 = 0.8623;

412 c⁄° 
DoubÀ
 
qdfP¨aLev5B
 = -0.4676;

413 
DoubÀ
 
qdfLev1Lev2
 = 
	`Clù3
(0.12, 0.9, 
qdfP¨aLev2A
 * 
ícRCSeq
->
	`gëPicP¨a
(2).
m_skùR©io
 + 
qdfP¨aLev2B
);

414 
DoubÀ
 
qdfLev1Lev3
 = 
	`Clù3
(0.13, 0.9, 
qdfP¨aLev3A
 * 
ícRCSeq
->
	`gëPicP¨a
(3).
m_skùR©io
 + 
qdfP¨aLev3B
);

415 
DoubÀ
 
qdfLev1Lev4
 = 
	`Clù3
(0.15, 0.9, 
qdfP¨aLev4A
 * 
ícRCSeq
->
	`gëPicP¨a
(4).
m_skùR©io
 + 
qdfP¨aLev4B
);

416 
DoubÀ
 
qdfLev1Lev5
 = 
	`Clù3
(0.20, 0.9, 
qdfP¨aLev5A
 * 
ícRCSeq
->
	`gëPicP¨a
(5).
m_skùR©io
 + 
qdfP¨aLev5B
);

417 
DoubÀ
 
qdfLev2Lev3
 = 
	`Clù3
(0.09, 0.9, 
qdfLev1Lev3
 * (1 - 
qdfLev1Lev2
));

418 
DoubÀ
 
qdfLev2Lev4
 = 
	`Clù3
(0.12, 0.9, 
qdfLev1Lev4
 * (1 - 
qdfLev1Lev2
));

419 
DoubÀ
 
qdfLev2Lev5
 = 
	`Clù3
(0.14, 0.9, 
qdfLev1Lev5
 * (1 - 
qdfLev1Lev2
));

420 
DoubÀ
 
qdfLev3Lev4
 = 
	`Clù3
(0.06, 0.9, 
qdfLev1Lev4
 * (1 - 
qdfLev1Lev3
));

421 
DoubÀ
 
qdfLev3Lev5
 = 
	`Clù3
(0.09, 0.9, 
qdfLev1Lev5
 * (1 - 
qdfLev1Lev3
));

422 
DoubÀ
 
qdfLev4Lev5
 = 
	`Clù3
(0.10, 0.9, 
qdfLev1Lev5
 * (1 - 
qdfLev1Lev4
));

424 
œmbdaLev1
 = 1 / (1 + 2 * (
qdfLev1Lev2
 + 2 * 
qdfLev1Lev3
 + 4 * 
qdfLev1Lev4
 + 8 * 
qdfLev1Lev5
));

425 
œmbdaLev2
 = 1 / (1 + (3 * 
qdfLev2Lev3
 + 5 * 
qdfLev2Lev4
 + 8 * 
qdfLev2Lev5
));

426 
œmbdaLev3
 = 1 / (1 + 2 * 
qdfLev3Lev4
 + 4 * 
qdfLev3Lev5
);

427 
œmbdaLev4
 = 1 / (1 + 2 * 
qdfLev4Lev5
);

428 
œmbdaLev5
 = 1 / (1.0);

430 
œmbdaR©io
[0] = 1.0;

431 
œmbdaR©io
[1] = 
œmbdaLev2
 / 
œmbdaLev1
;

432 
œmbdaR©io
[2] = 
œmbdaLev3
 / 
œmbdaLev1
;

433 
œmbdaR©io
[3] = 
œmbdaLev4
 / 
œmbdaLev1
;

434 
œmbdaR©io
[4] = 
œmbdaLev5
 / 
œmbdaLev1
;

435 
œmbdaR©io
[5] = 
œmbdaLev5
 / 
œmbdaLev1
;

436 
œmbdaR©io
[6] = 
œmbdaLev4
 / 
œmbdaLev1
;

437 
œmbdaR©io
[7] = 
œmbdaLev5
 / 
œmbdaLev1
;

438 
œmbdaR©io
[8] = 
œmbdaLev5
 / 
œmbdaLev1
;

439 
œmbdaR©io
[9] = 
œmbdaLev3
 / 
œmbdaLev1
;

440 
œmbdaR©io
[10] = 
œmbdaLev4
 / 
œmbdaLev1
;

441 
œmbdaR©io
[11] = 
œmbdaLev5
 / 
œmbdaLev1
;

442 
œmbdaR©io
[12] = 
œmbdaLev5
 / 
œmbdaLev1
;

443 
œmbdaR©io
[13] = 
œmbdaLev4
 / 
œmbdaLev1
;

444 
œmbdaR©io
[14] = 
œmbdaLev5
 / 
œmbdaLev1
;

445 
œmbdaR©io
[15] = 
œmbdaLev5
 / 
œmbdaLev1
;

449 
	`xCÆEquaC€ff
–
ícRCSeq
, 
œmbdaR©io
, 
equaC€ffA
, 
equaC€ffB
,ÉncRCSeq->
	`gëGOPSize
() );

450 #i‡
JVET_K0390_RATE_CTRL


451 
basicLambda
 = 
	`xSﬁveEqua
(
ícRCSeq
, 
èrgëBµ
, 
equaC€ffA
, 
equaC€ffB
,ÉncRCSeq->
	`gëGOPSize
());

453 
basicLambda
 = 
	`xSﬁveEqua
–
èrgëBµ
, 
equaC€ffA
, 
equaC€ffB
, 
ícRCSeq
->
	`gëGOPSize
() );

455 
ícRCSeq
->
	`£tAŒBôR©io
–
basicLambda
, 
equaC€ffA
, 
equaC€ffB
 );

457 
dñëe
 []
œmbdaR©io
;

458 
dñëe
 []
equaC€ffA
;

459 
dñëe
 []
equaC€ffB
;

462 
m_picT¨gëBôInGOP
 = 
√w
 
I¡
[
numPic
];

463 
I¡
 
i
;

464 
I¡
 
tŸÆPicR©io
 = 0;

465 
I¡
 
cuºPicR©io
 = 0;

466  
i
=0; i<
numPic
; i++ )

468 
tŸÆPicR©io
 +
ícRCSeq
->
	`gëBôR©io
–
i
 );

470  
i
=0; i<
numPic
; i++ )

472 
cuºPicR©io
 = 
ícRCSeq
->
	`gëBôR©io
–
i
 );

473 
m_picT¨gëBôInGOP
[
i
] = (
I¡
)–((
DoubÀ
)
èrgëBôs
Ë* 
cuºPicR©io
 / 
tŸÆPicR©io
 );

476 
m_ícRCSeq
 = 
ícRCSeq
;

477 
m_numPic
 = 
numPic
;

478 
m_èrgëBôs
 = 
èrgëBôs
;

479 
m_picLe·
 = 
m_numPic
;

480 
m_bôsLe·
 = 
m_èrgëBôs
;

481 
	}
}

483 
Void
 
	gTEncRCGOP
::
	$xCÆEquaC€ff
–
TEncRCSeq
* 
ícRCSeq
, 
DoubÀ
* 
œmbdaR©io
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
, 
I¡
 
GOPSize
 )

485  
I¡
 
i
=0; i<
GOPSize
; i++ )

487 
I¡
 
‰ameLevñ
 = 
ícRCSeq
->
	`gëGOPID2Levñ
(
i
);

488 
DoubÀ
 
Æpha
 = 
ícRCSeq
->
	`gëPicP¨a
(
‰ameLevñ
).
m_Æpha
;

489 
DoubÀ
 
bëa
 = 
ícRCSeq
->
	`gëPicP¨a
(
‰ameLevñ
).
m_bëa
;

490 
equaC€ffA
[
i
] = 
	`pow
–1.0/
Æpha
, 1.0/
bëa
 ) *Öow–
œmbdaR©io
[i], 1.0/beta );

491 
equaC€ffB
[
i
] = 1.0/
bëa
;

493 
	}
}

495 #i‡
JVET_K0390_RATE_CTRL


496 
DoubÀ
 
	gTEncRCGOP
::
	$xSﬁveEqua
(
TEncRCSeq
* 
ícRCSeq
, 
DoubÀ
 
èrgëBµ
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
, 
I¡
 
GOPSize
)

498 
DoubÀ
 
TEncRCGOP
::
	$xSﬁveEqua
–
DoubÀ
 
èrgëBµ
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
, 
I¡
 
GOPSize
 )

501 
DoubÀ
 
sﬁuti⁄
 = 100.0;

502 
DoubÀ
 
möNumbî
 = 0.1;

503 
DoubÀ
 
maxNumbî
 = 10000.0;

504  
I¡
 
i
=0; i<
g_RCIãøti⁄Num
; i++ )

506 
DoubÀ
 
fx
 = 0.0;

507  
I¡
 
j
=0; j<
GOPSize
; j++ )

509 #i‡
JVET_K0390_RATE_CTRL


510 
DoubÀ
 
tmpBµ
 = 
equaC€ffA
[
j
] * 
	`pow
(
sﬁuti⁄
, 
equaC€ffB
[j]);

511 
DoubÀ
 
a˘uÆBµ
 = 
tmpBµ
 * (DoubÀ)
ícRCSeq
->
	`gëPicP¨a
”ncRCSeq->
	`gëGOPID2Levñ
(
j
)).
m_vÆidPix
 / (DoubÀÎncRCSeq->
	`gëNumPixñ
();

512 
fx
 +
a˘uÆBµ
;

514 
fx
 +
equaC€ffA
[
j
] * 
	`pow
–
sﬁuti⁄
, 
equaC€ffB
[j] );

518 i‡–
	`Ábs
–
fx
 - 
èrgëBµ
 ) < 0.000001 )

523 i‡–
fx
 > 
èrgëBµ
 )

525 
möNumbî
 = 
sﬁuti⁄
;

526 
sﬁuti⁄
 = ( sﬁuti⁄ + 
maxNumbî
 ) / 2.0;

530 
maxNumbî
 = 
sﬁuti⁄
;

531 
sﬁuti⁄
 = ( sﬁuti⁄ + 
möNumbî
 ) / 2.0;

535 
sﬁuti⁄
 = 
	`Clù3
( 0.1, 10000.0, solution );

536  
sﬁuti⁄
;

537 
	}
}

539 
Void
 
	gTEncRCGOP
::
	$de°roy
()

541 
m_ícRCSeq
 = 
NULL
;

542 i‡–
m_picT¨gëBôInGOP
 !
NULL
 )

544 
dñëe
[] 
m_picT¨gëBôInGOP
;

545 
m_picT¨gëBôInGOP
 = 
NULL
;

547 
	}
}

549 
Void
 
	gTEncRCGOP
::
	$upd©eA·îPi˘uª
–
I¡
 
bôsCo°
 )

551 
m_bôsLe·
 -
bôsCo°
;

552 
m_picLe·
--;

553 
	}
}

555 
I¡
 
	gTEncRCGOP
::
	$xE°GOPT¨gëBôs
–
TEncRCSeq
* 
ícRCSeq
, 
I¡
 
GOPSize
 )

557 
I¡
 
ªÆInÊuí˚Pi˘uª
 = 
	`mö
–
g_RCSmoŸhWödowSize
, 
ícRCSeq
->
	`gëFømesLe·
() );

558 
I¡
 
avîageT¨gëBôsPîPic
 = (I¡)–
ícRCSeq
->
	`gëT¨gëBôs
(Ë/ÉncRCSeq->
	`gëTŸÆFømes
() );

559 
I¡
 
cuºítT¨gëBôsPîPic
 = (I¡)––
ícRCSeq
->
	`gëBôsLe·
(Ë- 
avîageT¨gëBôsPîPic
 * (ícRCSeq->
	`gëFømesLe·
(Ë- 
ªÆInÊuí˚Pi˘uª
) ) /ÑealInfluencePicture );

560 
I¡
 
èrgëBôs
 = 
cuºítT¨gëBôsPîPic
 * 
GOPSize
;

562 i‡–
èrgëBôs
 < 200 )

564 
èrgëBôs
 = 200;

567  
èrgëBôs
;

568 
	}
}

571 
	gTEncRCPic
::
	$TEncRCPic
()

573 
m_ícRCSeq
 = 
NULL
;

574 
m_ícRCGOP
 = 
NULL
;

576 
m_‰ameLevñ
 = 0;

577 
m_numbîOfPixñ
 = 0;

578 
m_numbîOfLCU
 = 0;

579 
m_èrgëBôs
 = 0;

580 
m_e°HódîBôs
 = 0;

581 
m_e°PicQP
 = 0;

582 
m_e°PicLambda
 = 0.0;

584 
m_LCULe·
 = 0;

585 
m_bôsLe·
 = 0;

586 
m_pixñsLe·
 = 0;

588 
m_LCUs
 = 
NULL
;

589 
m_picA˘uÆHódîBôs
 = 0;

590 
m_picA˘uÆBôs
 = 0;

591 
m_picQP
 = 0;

592 
m_picLambda
 = 0.0;

593 #i‡
JVET_K0390_RATE_CTRL


594 
m_picMSE
 = 0.0;

595 
m_vÆidPixñsInPic
 = 0;

597 
	}
}

599 
	gTEncRCPic
::~
	$TEncRCPic
()

601 
	`de°roy
();

602 
	}
}

604 
I¡
 
	gTEncRCPic
::
	$xE°PicT¨gëBôs
–
TEncRCSeq
* 
ícRCSeq
, 
TEncRCGOP
* 
ícRCGOP
 )

606 
I¡
 
èrgëBôs
 = 0;

607 
I¡
 
GOPbôsLe·
 = 
ícRCGOP
->
	`gëBôsLe·
();

609 
I¡
 
i
;

610 
I¡
 
cuºPicPosôi⁄
 = 
ícRCGOP
->
	`gëNumPic
()-ícRCGOP->
	`gëPicLe·
();

611 
I¡
 
cuºPicR©io
 = 
ícRCSeq
->
	`gëBôR©io
–
cuºPicPosôi⁄
 );

612 
I¡
 
tŸÆPicR©io
 = 0;

613  
i
=
cuºPicPosôi⁄
; i<
ícRCGOP
->
	`gëNumPic
(); i++ )

615 
tŸÆPicR©io
 +
ícRCSeq
->
	`gëBôR©io
–
i
 );

618 
èrgëBôs
 = 
	`I¡
–((
DoubÀ
)
GOPbôsLe·
Ë* 
cuºPicR©io
 / 
tŸÆPicR©io
 );

620 i‡–
èrgëBôs
 < 100 )

622 
èrgëBôs
 = 100;

625 i‡–
m_ícRCSeq
->
	`gëFømesLe·
() > 16 )

627 
èrgëBôs
 = 
	`I¡
–
g_RCWeightPicR¨gëBôInBuf„r
 *Å¨gëBô†+ 
g_RCWeightPicT¨gëBôInGOP
 * 
m_ícRCGOP
->
	`gëT¨gëBôInGOP
–
cuºPicPosôi⁄
 ) );

630  
èrgëBôs
;

631 
	}
}

633 
I¡
 
	gTEncRCPic
::
xE°PicHódîBôs
–
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
, I¡ 
‰ameLevñ
 )

635 
I¡
 
	gnumPªviousPics
 = 0;

636 
I¡
 
	gtŸÆPªviousBôs
 = 0;

638 
	gli°
<
	gTEncRCPic
*>::
ôî©‹
 
ô
;

639  
	gô
 = 
li°PªviousPi˘uªs
.
begö
(); ià!li°PªviousPi˘uªs.
íd
(); it++ )

641 i‡–(*
	gô
)->
gëFømeLevñ
(Ë=
‰ameLevñ
 )

643 
tŸÆPªviousBôs
 +(*
ô
)->
gëPicA˘uÆHódîBôs
();

644 
	gnumPªviousPics
++;

648 
I¡
 
	ge°HódîBôs
 = 0;

649 i‡–
	gnumPªviousPics
 > 0 )

651 
	ge°HódîBôs
 = 
tŸÆPªviousBôs
 / 
numPªviousPics
;

654  
	ge°HódîBôs
;

657 
I¡
 
	gTEncRCPic
::
	$xE°PicLowîBound
(
TEncRCSeq
* 
ícRCSeq
, 
TEncRCGOP
* 
ícRCGOP
)

659 
I¡
 
lowîBound
 = 0;

660 
I¡
 
GOPbôsLe·
 = 
ícRCGOP
->
	`gëBôsLe·
();

662 c⁄° 
I¡
 
√xtPicPosôi⁄
 = (
ícRCGOP
->
	`gëNumPic
(Ë-ÉncRCGOP->
	`gëPicLe·
() + 1) %ÉncRCGOP->getNumPic();

663 c⁄° 
I¡
 
√xtPicR©io
 = 
ícRCSeq
->
	`gëBôR©io
(
√xtPicPosôi⁄
);

665 
I¡
 
tŸÆPicR©io
 = 0;

666 
I¡
 
i
 = 
√xtPicPosôi⁄
; i < 
ícRCGOP
->
	`gëNumPic
(); i++)

668 
tŸÆPicR©io
 +
ícRCSeq
->
	`gëBôR©io
(
i
);

671 i‡(
√xtPicPosôi⁄
 == 0)

673 
GOPbôsLe·
 = 
ícRCGOP
->
	`gëT¨gëBôs
();

677 
GOPbôsLe·
 -
m_èrgëBôs
;

680 
lowîBound
 = 
	`I¡
(((
DoubÀ
)
GOPbôsLe·
Ë* 
√xtPicR©io
 / 
tŸÆPicR©io
);

682 i‡(
lowîBound
 < 100)

684 
lowîBound
 = 100;

687 i‡(
m_ícRCSeq
->
	`gëFømesLe·
() > 16)

689 
lowîBound
 = 
	`I¡
(
g_RCWeightPicR¨gëBôInBuf„r
 *ÜowîBound + 
g_RCWeightPicT¨gëBôInGOP
 * 
m_ícRCGOP
->
	`gëT¨gëBôInGOP
(
√xtPicPosôi⁄
));

692  
lowîBound
;

693 
	}
}

695 
Void
 
	gTEncRCPic
::
addToPi˘uªLsô
–
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
 )

697 i‡–
li°PªviousPi˘uªs
.
size
(Ë> 
g_RCMaxPicLi°Size
 )

699 
TEncRCPic
* 
p
 = 
li°PªviousPi˘uªs
.
‰⁄t
();

700 
	gli°PªviousPi˘uªs
.
p›_‰⁄t
();

701 
	gp
->
de°roy
();

702 
dñëe
 
	gp
;

705 
	gli°PªviousPi˘uªs
.
push_back
–
this
 );

708 
Void
 
	gTEncRCPic
::
¸óã
–
TEncRCSeq
* 
ícRCSeq
, 
TEncRCGOP
* 
ícRCGOP
, 
I¡
 
‰ameLevñ
, 
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
 )

710 
de°roy
();

711 
	gm_ícRCSeq
 = 
ícRCSeq
;

712 
	gm_ícRCGOP
 = 
ícRCGOP
;

714 
I¡
 
	gèrgëBôs
 = 
xE°PicT¨gëBôs
–
ícRCSeq
, 
ícRCGOP
 );

715 
I¡
 
	ge°HódîBôs
 = 
xE°PicHódîBôs
–
li°PªviousPi˘uªs
, 
‰ameLevñ
 );

717 i‡–
	gèrgëBôs
 < 
	ge°HódîBôs
 + 100 )

719 
	gèrgëBôs
 = 
e°HódîBôs
 + 100;

722 
	gm_‰ameLevñ
 = 
‰ameLevñ
;

723 
	gm_numbîOfPixñ
 = 
ícRCSeq
->
gëNumPixñ
();

724 
	gm_numbîOfLCU
 = 
ícRCSeq
->
gëNumbîOfLCU
();

725 
	gm_e°PicLambda
 = 100.0;

726 
	gm_èrgëBôs
 = 
èrgëBôs
;

727 
	gm_e°HódîBôs
 = 
e°HódîBôs
;

728 
	gm_bôsLe·
 = 
m_èrgëBôs
;

729 
I¡
 
	gpicWidth
 = 
ícRCSeq
->
gëPicWidth
();

730 
I¡
 
	gpicHeight
 = 
ícRCSeq
->
gëPicHeight
();

731 
I¡
 
	gLCUWidth
 = 
ícRCSeq
->
gëLCUWidth
();

732 
I¡
 
	gLCUHeight
 = 
ícRCSeq
->
gëLCUHeight
();

733 
I¡
 
	gpicWidthInLCU
 = ( 
picWidth
 % 
LCUWidth
 ) == 0 ?ÖicWidth / LCUWidth :ÖicWidth / LCUWidth + 1;

734 
I¡
 
	gpicHeightInLCU
 = ( 
picHeight
 % 
LCUHeight
 ) == 0 ?ÖicHeight / LCUHeight :ÖicHeight / LCUHeight + 1;

735 
	gm_lowîBound
 = 
xE°PicLowîBound
–
ícRCSeq
, 
ícRCGOP
 );

737 
	gm_LCULe·
 = 
m_numbîOfLCU
;

738 
	gm_bôsLe·
 -
m_e°HódîBôs
;

739 
	gm_pixñsLe·
 = 
m_numbîOfPixñ
;

741 
	gm_LCUs
 = 
√w
 
TRCLCU
[
m_numbîOfLCU
];

742 
I¡
 
	gi
, 
	gj
;

743 
I¡
 
	gLCUIdx
;

744  
	gi
=0; i<
	gpicWidthInLCU
; i++ )

746  
	gj
=0; j<
	gpicHeightInLCU
; j++ )

748 
	gLCUIdx
 = 
j
*
picWidthInLCU
 + 
i
;

749 
	gm_LCUs
[
LCUIdx
].
	gm_a˘uÆBôs
 = 0;

750 #i‡
JVET_K0390_RATE_CTRL


751 
	gm_LCUs
[
LCUIdx
].
	gm_a˘uÆSSE
 = 0.0;

752 
	gm_LCUs
[
LCUIdx
].
	gm_a˘uÆMSE
 = 0.0;

754 
	gm_LCUs
[
LCUIdx
].
	gm_QP
 = 0;

755 
	gm_LCUs
[
LCUIdx
].
	gm_œmbda
 = 0.0;

756 
	gm_LCUs
[
LCUIdx
].
	gm_èrgëBôs
 = 0;

757 
	gm_LCUs
[
LCUIdx
].
	gm_bôWeight
 = 1.0;

758 
I¡
 
	gcuºWidth
 = ( (
i
 =
picWidthInLCU
 -1Ë? 
picWidth
 - 
LCUWidth
 *(picWidthInLCU -1) : LCUWidth );

759 
I¡
 
	gcuºHeight
 = ( (
j
 =
picHeightInLCU
-1Ë? 
picHeight
 - 
LCUHeight
*(picHeightInLCU-1) : LCUHeight );

760 
	gm_LCUs
[
LCUIdx
].
	gm_numbîOfPixñ
 = 
cuºWidth
 * 
cuºHeight
;

763 
	gm_picA˘uÆHódîBôs
 = 0;

764 
	gm_picA˘uÆBôs
 = 0;

765 
	gm_picQP
 = 0;

766 
	gm_picLambda
 = 0.0;

769 
Void
 
	gTEncRCPic
::
	$de°roy
()

771 if–
m_LCUs
 !
NULL
 )

773 
dñëe
[] 
m_LCUs
;

774 
m_LCUs
 = 
NULL
;

776 
m_ícRCSeq
 = 
NULL
;

777 
m_ícRCGOP
 = 
NULL
;

778 
	}
}

781 
DoubÀ
 
	gTEncRCPic
::
e°im©ePicLambda
–
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
, 
Sli˚Ty≥
 
eSli˚Ty≥
)

783 
DoubÀ
 
	gÆpha
 = 
m_ícRCSeq
->
gëPicP¨a
–
m_‰ameLevñ
 ).
m_Æpha
;

784 
DoubÀ
 
	gbëa
 = 
m_ícRCSeq
->
gëPicP¨a
–
m_‰ameLevñ
 ).
m_bëa
;

785 
DoubÀ
 
	gbµ
 = (DoubÀ)
m_èrgëBôs
/(DoubÀ)
m_numbîOfPixñ
;

787 #i‡
JVET_K0390_RATE_CTRL


788 
I¡
 
	gœ°PicVÆPix
 = 0;

789 i‡(
	gli°PªviousPi˘uªs
.
size
() > 0)

791 
	gœ°PicVÆPix
 = 
m_ícRCSeq
->
gëPicP¨a
(
m_‰ameLevñ
).
m_vÆidPix
;

793 i‡(
	gœ°PicVÆPix
 > 0)

795 
	gbµ
 = (
DoubÀ
)
m_èrgëBôs
 / (DoubÀ)
œ°PicVÆPix
;

799 
DoubÀ
 
	ge°Lambda
;

800 i‡(
	geSli˚Ty≥
 =
I_SLICE
)

802 
e°Lambda
 = 
ˇlcuœãLambdaI¡ø
(
Æpha
, 
bëa
, 
pow
(
m_tŸÆCo°I¡ø
/(
DoubÀ
)
m_numbîOfPixñ
, 
BETA1
), 
bµ
);

806 
	ge°Lambda
 = 
Æpha
 * 
pow
–
bµ
, 
bëa
 );

809 
DoubÀ
 
	gœ°LevñLambda
 = -1.0;

810 
DoubÀ
 
	gœ°PicLambda
 = -1.0;

811 
DoubÀ
 
	gœ°VÆidLambda
 = -1.0;

812 
	gli°
<
	gTEncRCPic
*>::
ôî©‹
 
ô
;

813  
	gô
 = 
li°PªviousPi˘uªs
.
begö
(); ià!li°PªviousPi˘uªs.
íd
(); it++ )

815 i‡–(*
	gô
)->
gëFømeLevñ
(Ë=
m_‰ameLevñ
 )

817 
œ°LevñLambda
 = (*
ô
)->
gëPicA˘uÆLambda
();

819 
	gœ°PicLambda
 = (*
ô
)->
gëPicA˘uÆLambda
();

821 i‡–
	gœ°PicLambda
 > 0.0 )

823 
	gœ°VÆidLambda
 = 
œ°PicLambda
;

827 i‡–
	gœ°LevñLambda
 > 0.0 )

829 
	gœ°LevñLambda
 = 
Clù3
–0.1, 10000.0, 
œ°LevñLambda
 );

830 
	ge°Lambda
 = 
Clù3
–
œ°LevñLambda
 * 
pow
–2.0, -3.0/3.0 ),Üa°LevñLambd®*Öow–2.0, 3.0/3.0 ), 
e°Lambda
 );

833 i‡–
	gœ°PicLambda
 > 0.0 )

835 
	gœ°PicLambda
 = 
Clù3
–0.1, 2000.0, 
œ°PicLambda
 );

836 
	ge°Lambda
 = 
Clù3
–
œ°PicLambda
 * 
pow
–2.0, -10.0/3.0 ),Üa°PicLambd®*Öow–2.0, 10.0/3.0 ), 
e°Lambda
 );

838 i‡–
	gœ°VÆidLambda
 > 0.0 )

840 
	gœ°VÆidLambda
 = 
Clù3
–0.1, 2000.0, 
œ°VÆidLambda
 );

841 
	ge°Lambda
 = 
Clù3
–
œ°VÆidLambda
 * 
pow
(2.0, -10.0/3.0),Üa°VÆidLambd®*Öow(2.0, 10.0/3.0), 
e°Lambda
 );

845 
	ge°Lambda
 = 
Clù3
–0.1, 10000.0, 
e°Lambda
 );

848 i‡–
	ge°Lambda
 < 0.1 )

850 
	ge°Lambda
 = 0.1;

852 #i‡
JVET_K0390_RATE_CTRL


854 
	ge°Lambda
 = 
DoubÀ
(
öt64_t
(
e°Lambda
 * (DoubÀ)
LAMBDA_PREC
 + 0.5)) / (Double)LAMBDA_PREC;

856 
	gm_e°PicLambda
 = 
e°Lambda
;

858 
DoubÀ
 
	gtŸÆWeight
 = 0.0;

860  
I¡
 
	gi
=0; i<
	gm_numbîOfLCU
; i++ )

862 
DoubÀ
 
	gÆphaLCU
, 
	gbëaLCU
;

863 i‡–
	gm_ícRCSeq
->
gëU£LCUSï¨©eModñ
() )

865 
	gÆphaLCU
 = 
m_ícRCSeq
->
gëLCUP¨a
–
m_‰ameLevñ
, 
i
 ).
	gm_Æpha
;

866 
	gbëaLCU
 = 
m_ícRCSeq
->
gëLCUP¨a
–
m_‰ameLevñ
, 
i
 ).
	gm_bëa
;

870 
	gÆphaLCU
 = 
m_ícRCSeq
->
gëPicP¨a
–
m_‰ameLevñ
 ).
m_Æpha
;

871 
	gbëaLCU
 = 
m_ícRCSeq
->
gëPicP¨a
–
m_‰ameLevñ
 ).
m_bëa
;

874 
	gm_LCUs
[
i
].
	gm_bôWeight
 = 
m_LCUs
[i].
m_numbîOfPixñ
 * 
pow
–
e°Lambda
/
ÆphaLCU
, 1.0/
bëaLCU
 );

876 i‡–
	gm_LCUs
[
i
].
	gm_bôWeight
 < 0.01 )

878 
	gm_LCUs
[
i
].
	gm_bôWeight
 = 0.01;

880 
	gtŸÆWeight
 +
m_LCUs
[
i
].
m_bôWeight
;

882  
I¡
 
	gi
=0; i<
	gm_numbîOfLCU
; i++ )

884 
DoubÀ
 
	gBUT¨gëBôs
 = 
m_èrgëBôs
 * 
m_LCUs
[
i
].
m_bôWeight
 / 
tŸÆWeight
;

885 
	gm_LCUs
[
i
].
	gm_bôWeight
 = 
BUT¨gëBôs
;

888  
	ge°Lambda
;

891 
I¡
 
	gTEncRCPic
::
e°im©ePicQP
–
DoubÀ
 
œmbda
, 
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
 )

893 
I¡
 
	gQP
 = I¡–4.2005 * 
log
–
œmbda
 ) + 13.7122 + 0.5 );

895 
I¡
 
	gœ°LevñQP
 = 
g_RCInvÆidQPVÆue
;

896 
I¡
 
	gœ°PicQP
 = 
g_RCInvÆidQPVÆue
;

897 
I¡
 
	gœ°VÆidQP
 = 
g_RCInvÆidQPVÆue
;

898 
	gli°
<
	gTEncRCPic
*>::
ôî©‹
 
ô
;

899  
	gô
 = 
li°PªviousPi˘uªs
.
begö
(); ià!li°PªviousPi˘uªs.
íd
(); it++ )

901 i‡–(*
	gô
)->
gëFømeLevñ
(Ë=
m_‰ameLevñ
 )

903 
œ°LevñQP
 = (*
ô
)->
gëPicA˘uÆQP
();

905 
	gœ°PicQP
 = (*
ô
)->
gëPicA˘uÆQP
();

906 i‡–
	gœ°PicQP
 > 
	gg_RCInvÆidQPVÆue
 )

908 
	gœ°VÆidQP
 = 
œ°PicQP
;

912 i‡–
	gœ°LevñQP
 > 
	gg_RCInvÆidQPVÆue
 )

914 
	gQP
 = 
Clù3
–
œ°LevñQP
 - 3,Üa°LevñQP + 3, 
QP
 );

917 if–
	gœ°PicQP
 > 
	gg_RCInvÆidQPVÆue
 )

919 
	gQP
 = 
Clù3
–
œ°PicQP
 - 10,Üa°PicQP + 10, 
QP
 );

921 if–
	gœ°VÆidQP
 > 
	gg_RCInvÆidQPVÆue
 )

923 
	gQP
 = 
Clù3
–
œ°VÆidQP
 - 10,Üa°VÆidQP + 10, 
QP
 );

926  
	gQP
;

929 
DoubÀ
 
	gTEncRCPic
::
	$gëLCUT¨gëBµ
(
Sli˚Ty≥
 
eSli˚Ty≥
)

931 
I¡
 
LCUIdx
 = 
	`gëLCUCoded
();

932 
DoubÀ
 
bµ
 = -1.0;

933 
I¡
 
avgBôs
 = 0;

935 i‡(
eSli˚Ty≥
 =
I_SLICE
)

937 
I¡
 
noOfLCUsLe·
 = 
m_numbîOfLCU
 - 
LCUIdx
 + 1;

938 
I¡
 
bôøãWödow
 = 
	`mö
(4,
noOfLCUsLe·
);

939 
DoubÀ
 
MAD
 = 
	`gëLCU
(
LCUIdx
).
m_co°I¡ø
;

941 i‡(
m_ªmaöögCo°I¡ø
 > 0.1 )

943 
DoubÀ
 
weighãdBôsLe·
 = (
m_bôsLe·
*
bôøãWödow
+(m_bôsLe·-
	`gëLCU
(
LCUIdx
).
m_èrgëBôsLe·
)*
noOfLCUsLe·
)/(Double)bitrateWindow;

944 
avgBôs
 = 
	`I¡
–
MAD
*
weighãdBôsLe·
/
m_ªmaöögCo°I¡ø
 );

948 
avgBôs
 = 
	`I¡
–
m_bôsLe·
 / 
m_LCULe·
 );

950 
m_ªmaöögCo°I¡ø
 -
MAD
;

954 
DoubÀ
 
tŸÆWeight
 = 0;

955  
I¡
 
i
=
LCUIdx
; i<
m_numbîOfLCU
; i++ )

957 
tŸÆWeight
 +
m_LCUs
[
i
].
m_bôWeight
;

959 
I¡
 
ªÆInÊuí˚LCU
 = 
	`mö
–
g_RCLCUSmoŸhWödowSize
, 
	`gëLCULe·
() );

960 
avgBôs
 = (
I¡
)–
m_LCUs
[
LCUIdx
].
m_bôWeight
 - ( 
tŸÆWeight
 - 
m_bôsLe·
 ) / 
ªÆInÊuí˚LCU
 + 0.5 );

963 i‡–
avgBôs
 < 1 )

965 
avgBôs
 = 1;

968 
bµ
 = ( 
DoubÀ
 )
avgBôs
/–DoubÀ )
m_LCUs
[ 
LCUIdx
 ].
m_numbîOfPixñ
;

969 
m_LCUs
[ 
LCUIdx
 ].
m_èrgëBôs
 = 
avgBôs
;

971  
bµ
;

972 
	}
}

974 
DoubÀ
 
	gTEncRCPic
::
	$gëLCUE°Lambda
–
DoubÀ
 
bµ
 )

976 
I¡
 
LCUIdx
 = 
	`gëLCUCoded
();

977 
DoubÀ
 
Æpha
;

978 
DoubÀ
 
bëa
;

979 i‡–
m_ícRCSeq
->
	`gëU£LCUSï¨©eModñ
() )

981 
Æpha
 = 
m_ícRCSeq
->
	`gëLCUP¨a
–
m_‰ameLevñ
, 
LCUIdx
 ).
m_Æpha
;

982 
bëa
 = 
m_ícRCSeq
->
	`gëLCUP¨a
–
m_‰ameLevñ
, 
LCUIdx
 ).
m_bëa
;

986 
Æpha
 = 
m_ícRCSeq
->
	`gëPicP¨a
–
m_‰ameLevñ
 ).
m_Æpha
;

987 
bëa
 = 
m_ícRCSeq
->
	`gëPicP¨a
–
m_‰ameLevñ
 ).
m_bëa
;

990 
DoubÀ
 
e°Lambda
 = 
Æpha
 * 
	`pow
–
bµ
, 
bëa
 );

992 
DoubÀ
 
˛ùPicLambda
 = 
m_e°PicLambda
;

995 
DoubÀ
 
˛ùNeighbourLambda
 = -1.0;

996  
I¡
 
i
=
LCUIdx
 - 1; i>=0; i-- )

998 i‡–
m_LCUs
[
i
].
m_œmbda
 > 0 )

1000 
˛ùNeighbourLambda
 = 
m_LCUs
[
i
].
m_œmbda
;

1005 i‡–
˛ùNeighbourLambda
 > 0.0 )

1007 
e°Lambda
 = 
	`Clù3
–
˛ùNeighbourLambda
 * 
	`pow
( 2.0, -1.0/3.0 ), clipNeighbourLambda *Öow( 2.0, 1.0/3.0 ),ÉstLambda );

1010 i‡–
˛ùPicLambda
 > 0.0 )

1012 
e°Lambda
 = 
	`Clù3
–
˛ùPicLambda
 * 
	`pow
( 2.0, -2.0/3.0 ), clipPicLambda *Öow( 2.0, 2.0/3.0 ),ÉstLambda );

1016 
e°Lambda
 = 
	`Clù3
( 10.0, 1000.0,ÉstLambda );

1019 i‡–
e°Lambda
 < 0.1 )

1021 
e°Lambda
 = 0.1;

1023 #i‡
JVET_K0390_RATE_CTRL


1025 
e°Lambda
 = 
	`DoubÀ
(
	`öt64_t
”°Lambd®* (
DoubÀ
)
LAMBDA_PREC
 + 0.5)) / (Double)LAMBDA_PREC;

1027  
e°Lambda
;

1028 
	}
}

1030 
I¡
 
	gTEncRCPic
::
	$gëLCUE°QP
–
DoubÀ
 
œmbda
, 
I¡
 
˛ùPicQP
 )

1032 
I¡
 
LCUIdx
 = 
	`gëLCUCoded
();

1033 
I¡
 
e°QP
 = 
	`I¡
–4.2005 * 
	`log
–
œmbda
 ) + 13.7122 + 0.5 );

1036 
I¡
 
˛ùNeighbourQP
 = 
g_RCInvÆidQPVÆue
;

1037  
I¡
 
i
=
LCUIdx
 - 1; i>=0; i-- )

1039 i‡–(
	`gëLCU
(
i
)).
m_QP
 > 
g_RCInvÆidQPVÆue
 )

1041 
˛ùNeighbourQP
 = 
	`gëLCU
(
i
).
m_QP
;

1046 i‡–
˛ùNeighbourQP
 > 
g_RCInvÆidQPVÆue
 )

1048 
e°QP
 = 
	`Clù3
–
˛ùNeighbourQP
 - 1, clipNeighbourQP + 1,ÉstQP );

1051 
e°QP
 = 
	`Clù3
–
˛ùPicQP
 - 2, clipPicQP + 2,ÉstQP );

1053  
e°QP
;

1054 
	}
}

1056 #i‡
JVET_M0600_RATE_CTRL


1057 
Void
 
	gTEncRCPic
::
	$upd©eA·îCTU
(
I¡
 
LCUIdx
, I¡ 
bôs
, I¡ 
QP
, 
DoubÀ
 
œmbda
, DoubÀ 
skùR©io
, 
Boﬁ
 
upd©eLCUP¨amëî
)

1059 
Void
 
TEncRCPic
::
	$upd©eA·îCTU
–
I¡
 
LCUIdx
, I¡ 
bôs
, I¡ 
QP
, 
DoubÀ
 
œmbda
, 
Boﬁ
 
upd©eLCUP¨amëî
 )

1062 
m_LCUs
[
LCUIdx
].
m_a˘uÆBôs
 = 
bôs
;

1063 
m_LCUs
[
LCUIdx
].
m_QP
 = 
QP
;

1064 
m_LCUs
[
LCUIdx
].
m_œmbda
 = 
œmbda
;

1065 #i‡
JVET_K0390_RATE_CTRL


1066 
m_LCUs
[
LCUIdx
].
m_a˘uÆSSE
 = m_LCUs[LCUIdx].
m_a˘uÆMSE
 * m_LCUs[LCUIdx].
m_numbîOfPixñ
;

1069 
m_LCULe·
--;

1070 
m_bôsLe·
 -
bôs
;

1071 
m_pixñsLe·
 -
m_LCUs
[
LCUIdx
].
m_numbîOfPixñ
;

1073 i‡–!
upd©eLCUP¨amëî
 )

1078 i‡–!
m_ícRCSeq
->
	`gëU£LCUSï¨©eModñ
() )

1083 
DoubÀ
 
Æpha
 = 
m_ícRCSeq
->
	`gëLCUP¨a
–
m_‰ameLevñ
, 
LCUIdx
 ).
m_Æpha
;

1084 
DoubÀ
 
bëa
 = 
m_ícRCSeq
->
	`gëLCUP¨a
–
m_‰ameLevñ
, 
LCUIdx
 ).
m_bëa
;

1086 
I¡
 
LCUA˘uÆBôs
 = 
m_LCUs
[
LCUIdx
].
m_a˘uÆBôs
;

1087 
I¡
 
LCUTŸÆPixñs
 = 
m_LCUs
[
LCUIdx
].
m_numbîOfPixñ
;

1088 
DoubÀ
 
bµ
 = ( DoubÀ )
LCUA˘uÆBôs
/–DoubÀ )
LCUTŸÆPixñs
;

1089 
DoubÀ
 
ˇlLambda
 = 
Æpha
 * 
	`pow
–
bµ
, 
bëa
 );

1090 
DoubÀ
 
öputLambda
 = 
m_LCUs
[
LCUIdx
].
m_œmbda
;

1092 if–
öputLambda
 < 0.01 || 
ˇlLambda
 < 0.01 || 
bµ
 < 0.0001 )

1094 
Æpha
 *–1.0 - 
m_ícRCSeq
->
	`gëAÕhaUpd©e
() / 2.0 );

1095 
bëa
 *–1.0 - 
m_ícRCSeq
->
	`gëBëaUpd©e
() / 2.0 );

1097 
Æpha
 = 
	`Clù3
–
g_RCAÕhaMöVÆue
, 
g_RCAÕhaMaxVÆue
,álpha );

1098 
bëa
 = 
	`Clù3
–
g_RCBëaMöVÆue
, 
g_RCBëaMaxVÆue
, beta );

1100 
TRCP¨amëî
 
rcP¨a
;

1101 
rcP¨a
.
m_Æpha
 = 
Æpha
;

1102 
rcP¨a
.
m_bëa
 = 
bëa
;

1103 #i‡
JVET_M0600_RATE_CTRL


1104 
rcP¨a
.
m_skùR©io
 = 
skùR©io
;

1106 #i‡
JVET_K0390_RATE_CTRL


1107 i‡(
QP
 =
g_RCInvÆidQPVÆue
 && 
m_ícRCSeq
->
	`gëAd≠tiveBôs
() == 1)

1109 
rcP¨a
.
m_vÆidPix
 = 0;

1113 
rcP¨a
.
m_vÆidPix
 = 
LCUTŸÆPixñs
;

1116 
DoubÀ
 
MSE
 = 
m_LCUs
[
LCUIdx
].
m_a˘uÆMSE
;

1117 
DoubÀ
 
upd©edK
 = 
bµ
 * 
öputLambda
 / 
MSE
;

1118 
DoubÀ
 
upd©edC
 = 
MSE
 / 
	`pow
(
bµ
, -
upd©edK
);

1119 
rcP¨a
.
m_Æpha
 = 
upd©edC
 * 
upd©edK
;

1120 
rcP¨a
.
m_bëa
 = -
upd©edK
 - 1.0;

1122 i‡(
bµ
 > 0 && 
upd©edK
 > 0.0001)

1124 
m_ícRCSeq
->
	`£tLCUP¨a
(
m_‰ameLevñ
, 
LCUIdx
, 
rcP¨a
);

1128 
rcP¨a
.
m_Æpha
 = 
	`Clù3
(0.0001, 
g_RCAÕhaMaxVÆue
,ÑcPara.m_alpha);

1129 
m_ícRCSeq
->
	`£tLCUP¨a
(
m_‰ameLevñ
, 
LCUIdx
, 
rcP¨a
);

1132 
m_ícRCSeq
->
	`£tLCUP¨a
–
m_‰ameLevñ
, 
LCUIdx
, 
rcP¨a
 );

1137 
ˇlLambda
 = 
	`Clù3
–
öputLambda
 / 10.0, inputLambda * 10.0, calLambda );

1138 
Æpha
 +
m_ícRCSeq
->
	`gëAÕhaUpd©e
(Ë* ( 
	`log
–
öputLambda
 ) -Üog–
ˇlLambda
 ) ) *álpha;

1139 
DoubÀ
 
 bµ
 = 
	`log
–
bµ
 );

1140 
 bµ
 = 
	`Clù3
( -5.0, -0.1,Ünbpp );

1141 
bëa
 +
m_ícRCSeq
->
	`gëBëaUpd©e
(Ë* ( 
	`log
–
öputLambda
 ) -Üog–
ˇlLambda
 ) ) * 
 bµ
;

1143 
Æpha
 = 
	`Clù3
–
g_RCAÕhaMöVÆue
, 
g_RCAÕhaMaxVÆue
,álpha );

1144 
bëa
 = 
	`Clù3
–
g_RCBëaMöVÆue
, 
g_RCBëaMaxVÆue
, beta );

1146 
TRCP¨amëî
 
rcP¨a
;

1147 
rcP¨a
.
m_Æpha
 = 
Æpha
;

1148 
rcP¨a
.
m_bëa
 = 
bëa
;

1149 #i‡
JVET_M0600_RATE_CTRL


1150 
rcP¨a
.
m_skùR©io
 = 
skùR©io
;

1152 #i‡
JVET_K0390_RATE_CTRL


1153 i‡(
QP
 =
g_RCInvÆidQPVÆue
 && 
m_ícRCSeq
->
	`gëAd≠tiveBôs
() == 1)

1155 
rcP¨a
.
m_vÆidPix
 = 0;

1159 
rcP¨a
.
m_vÆidPix
 = 
LCUTŸÆPixñs
;

1162 
DoubÀ
 
MSE
 = 
m_LCUs
[
LCUIdx
].
m_a˘uÆMSE
;

1163 
DoubÀ
 
upd©edK
 = 
bµ
 * 
öputLambda
 / 
MSE
;

1164 
DoubÀ
 
upd©edC
 = 
MSE
 / 
	`pow
(
bµ
, -
upd©edK
);

1165 
rcP¨a
.
m_Æpha
 = 
upd©edC
 * 
upd©edK
;

1166 
rcP¨a
.
m_bëa
 = -
upd©edK
 - 1.0;

1168 i‡(
bµ
 > 0 && 
upd©edK
 > 0.0001)

1170 
m_ícRCSeq
->
	`£tLCUP¨a
(
m_‰ameLevñ
, 
LCUIdx
, 
rcP¨a
);

1174 
rcP¨a
.
m_Æpha
 = 
	`Clù3
(0.0001, 
g_RCAÕhaMaxVÆue
,ÑcPara.m_alpha);

1175 
m_ícRCSeq
->
	`£tLCUP¨a
(
m_‰ameLevñ
, 
LCUIdx
, 
rcP¨a
);

1178 
m_ícRCSeq
->
	`£tLCUP¨a
–
m_‰ameLevñ
, 
LCUIdx
, 
rcP¨a
 );

1180 
	}
}

1182 
DoubÀ
 
	gTEncRCPic
::
	$ˇlAvîageQP
()

1184 
I¡
 
tŸÆQPs
 = 0;

1185 
I¡
 
numTŸÆLCUs
 = 0;

1187 
I¡
 
i
;

1188  
i
=0; i<
m_numbîOfLCU
; i++ )

1190 i‡–
m_LCUs
[
i
].
m_QP
 > 0 )

1192 
tŸÆQPs
 +
m_LCUs
[
i
].
m_QP
;

1193 
numTŸÆLCUs
++;

1197 
DoubÀ
 
avgQP
 = 0.0;

1198 i‡–
numTŸÆLCUs
 == 0 )

1200 
avgQP
 = 
g_RCInvÆidQPVÆue
;

1204 
avgQP
 = ((
DoubÀ
)
tŸÆQPs
Ë/ ((DoubÀ)
numTŸÆLCUs
);

1206  
avgQP
;

1207 
	}
}

1209 
DoubÀ
 
	gTEncRCPic
::
	$ˇlAvîageLambda
()

1211 
DoubÀ
 
tŸÆLambdas
 = 0.0;

1212 
I¡
 
numTŸÆLCUs
 = 0;

1213 #i‡
JVET_K0390_RATE_CTRL


1214 
DoubÀ
 
tŸÆSSE
 = 0.0;

1215 
I¡
 
tŸÆPixñs
 = 0;

1217 
I¡
 
i
;

1218  
i
=0; i<
m_numbîOfLCU
; i++ )

1220 i‡–
m_LCUs
[
i
].
m_œmbda
 > 0.01 )

1222 #i‡
JVET_K0390_RATE_CTRL


1223 i‡(
m_LCUs
[
i
].
m_QP
 > 0 || 
m_ícRCSeq
->
	`gëAd≠tiveBôs
() != 1)

1225 
m_vÆidPixñsInPic
 +
m_LCUs
[
i
].
m_numbîOfPixñ
;

1227 
tŸÆLambdas
 +
	`log
(
m_LCUs
[
i
].
m_œmbda
);

1228 
numTŸÆLCUs
++;

1231 
tŸÆLambdas
 +
	`log
–
m_LCUs
[
i
].
m_œmbda
 );

1232 
numTŸÆLCUs
++;

1235 #i‡
JVET_K0390_RATE_CTRL


1236 i‡(
m_LCUs
[
i
].
m_QP
 > 0 || 
m_ícRCSeq
->
	`gëAd≠tiveBôs
() != 1)

1238 
tŸÆSSE
 +
m_LCUs
[
i
].
m_a˘uÆSSE
;

1239 
tŸÆPixñs
 +
m_LCUs
[
i
].
m_numbîOfPixñ
;

1244 #i‡
JVET_K0390_RATE_CTRL


1245 
	`£tPicMSE
(
tŸÆPixñs
 > 0 ? 
tŸÆSSE
 / (
DoubÀ
)totalPixels : 1.0);

1248 
DoubÀ
 
avgLambda
;

1249 if–
numTŸÆLCUs
 == 0 )

1251 
avgLambda
 = -1.0;

1255 
avgLambda
 = 
	`pow
–2.7183, 
tŸÆLambdas
 / 
numTŸÆLCUs
 );

1257  
avgLambda
;

1258 
	}
}

1261 
Void
 
	gTEncRCPic
::
	$upd©eA·îPi˘uª
–
I¡
 
a˘uÆHódîBôs
, I¡ 
a˘uÆTŸÆBôs
, 
DoubÀ
 
avîageQP
, DoubÀ 
avîageLambda
, 
Sli˚Ty≥
 
eSli˚Ty≥
)

1263 
m_picA˘uÆHódîBôs
 = 
a˘uÆHódîBôs
;

1264 
m_picA˘uÆBôs
 = 
a˘uÆTŸÆBôs
;

1265 i‡–
avîageQP
 > 0.0 )

1267 
m_picQP
 = 
	`I¡
–
avîageQP
 + 0.5 );

1271 
m_picQP
 = 
g_RCInvÆidQPVÆue
;

1273 
m_picLambda
 = 
avîageLambda
;

1275 
DoubÀ
 
Æpha
 = 
m_ícRCSeq
->
	`gëPicP¨a
–
m_‰ameLevñ
 ).
m_Æpha
;

1276 
DoubÀ
 
bëa
 = 
m_ícRCSeq
->
	`gëPicP¨a
–
m_‰ameLevñ
 ).
m_bëa
;

1277 #i‡
JVET_M0600_RATE_CTRL


1278 
DoubÀ
 
skùR©io
 = 0;

1279 
I¡
 
numOfSkùPixñ
 = 0;

1280 
I¡
 
LCUIdx
 = 0; LCUIdx < 
m_numbîOfLCU
; LCUIdx++)

1282 
numOfSkùPixñ
 +
	`I¡
(
m_ícRCSeq
->
	`gëLCUP¨a
(
m_‰ameLevñ
, 
LCUIdx
).
m_skùR©io
*
m_LCUs
[LCUIdx].
m_numbîOfPixñ
);

1284 
skùR©io
 = (
DoubÀ
)
numOfSkùPixñ
 / (DoubÀ)
m_numbîOfPixñ
;

1286 i‡(
eSli˚Ty≥
 =
I_SLICE
)

1288 
	`upd©eAÕhaBëaI¡ø
(&
Æpha
, &
bëa
);

1293 
DoubÀ
 
picA˘uÆBôs
 = ( DoubÀ )
m_picA˘uÆBôs
;

1294 #i‡
JVET_K0390_RATE_CTRL


1295 
DoubÀ
 
picA˘uÆBµ
 = 
picA˘uÆBôs
 / (DoubÀ)
m_vÆidPixñsInPic
;

1297 
DoubÀ
 
picA˘uÆBµ
 = 
picA˘uÆBôs
/(DoubÀ)
m_numbîOfPixñ
;

1299 
DoubÀ
 
ˇlLambda
 = 
Æpha
 * 
	`pow
–
picA˘uÆBµ
, 
bëa
 );

1300 
DoubÀ
 
öputLambda
 = 
m_picLambda
;

1302 i‡–
öputLambda
 < 0.01 || 
ˇlLambda
 < 0.01 || 
picA˘uÆBµ
 < 0.0001 )

1304 
Æpha
 *–1.0 - 
m_ícRCSeq
->
	`gëAÕhaUpd©e
() / 2.0 );

1305 
bëa
 *–1.0 - 
m_ícRCSeq
->
	`gëBëaUpd©e
() / 2.0 );

1307 
Æpha
 = 
	`Clù3
–
g_RCAÕhaMöVÆue
, 
g_RCAÕhaMaxVÆue
,álpha );

1308 
bëa
 = 
	`Clù3
–
g_RCBëaMöVÆue
, 
g_RCBëaMaxVÆue
, beta );

1310 
TRCP¨amëî
 
rcP¨a
;

1311 
rcP¨a
.
m_Æpha
 = 
Æpha
;

1312 
rcP¨a
.
m_bëa
 = 
bëa
;

1313 #i‡
JVET_M0600_RATE_CTRL


1314 
rcP¨a
.
m_skùR©io
 = 
skùR©io
;

1316 #i‡
JVET_K0390_RATE_CTRL


1317 
DoubÀ
 
avgMSE
 = 
	`gëPicMSE
();

1318 
DoubÀ
 
upd©edK
 = 
picA˘uÆBµ
 * 
avîageLambda
 / 
avgMSE
;

1319 
DoubÀ
 
upd©edC
 = 
avgMSE
 / 
	`pow
(
picA˘uÆBµ
, -
upd©edK
);

1321 i‡(
m_‰ameLevñ
 > 0)

1323 
rcP¨a
.
m_Æpha
 = 
upd©edC
 * 
upd©edK
;

1324 
rcP¨a
.
m_bëa
 = -
upd©edK
 - 1.0;

1327 
rcP¨a
.
m_vÆidPix
 = 
m_vÆidPixñsInPic
;

1329 i‡(
m_vÆidPixñsInPic
 > 0)

1331 
m_ícRCSeq
->
	`£tPicP¨a
(
m_‰ameLevñ
, 
rcP¨a
);

1334 
m_ícRCSeq
->
	`£tPicP¨a
–
m_‰ameLevñ
, 
rcP¨a
 );

1340 
ˇlLambda
 = 
	`Clù3
–
öputLambda
 / 10.0, inputLambda * 10.0, calLambda );

1341 
Æpha
 +
m_ícRCSeq
->
	`gëAÕhaUpd©e
(Ë* ( 
	`log
–
öputLambda
 ) -Üog–
ˇlLambda
 ) ) *álpha;

1342 
DoubÀ
 
 bµ
 = 
	`log
–
picA˘uÆBµ
 );

1343 
 bµ
 = 
	`Clù3
( -5.0, -0.1,Ünbpp );

1345 
bëa
 +
m_ícRCSeq
->
	`gëBëaUpd©e
(Ë* ( 
	`log
–
öputLambda
 ) -Üog–
ˇlLambda
 ) ) * 
 bµ
;

1347 
Æpha
 = 
	`Clù3
–
g_RCAÕhaMöVÆue
, 
g_RCAÕhaMaxVÆue
,álpha );

1348 
bëa
 = 
	`Clù3
–
g_RCBëaMöVÆue
, 
g_RCBëaMaxVÆue
, beta );

1351 
TRCP¨amëî
 
rcP¨a
;

1352 
rcP¨a
.
m_Æpha
 = 
Æpha
;

1353 
rcP¨a
.
m_bëa
 = 
bëa
;

1354 #i‡
JVET_M0600_RATE_CTRL


1355 
rcP¨a
.
m_skùR©io
 = 
skùR©io
;

1358 #i‡
JVET_K0390_RATE_CTRL


1359 
DoubÀ
 
picA˘uÆBµ
 = (DoubÀ)
m_picA˘uÆBôs
 / (DoubÀ)
m_vÆidPixñsInPic
;

1361 
DoubÀ
 
avgMSE
 = 
	`gëPicMSE
();

1362 
DoubÀ
 
upd©edK
 = 
picA˘uÆBµ
 * 
avîageLambda
 / 
avgMSE
;

1363 
DoubÀ
 
upd©edC
 = 
avgMSE
 / 
	`pow
(
picA˘uÆBµ
, -
upd©edK
);

1364 i‡(
m_‰ameLevñ
 > 0)

1366 
rcP¨a
.
m_Æpha
 = 
upd©edC
 * 
upd©edK
;

1367 
rcP¨a
.
m_bëa
 = -
upd©edK
 - 1.0;

1370 
rcP¨a
.
m_vÆidPix
 = 
m_vÆidPixñsInPic
;

1372 i‡(
m_vÆidPixñsInPic
 > 0)

1374 
m_ícRCSeq
->
	`£tPicP¨a
(
m_‰ameLevñ
, 
rcP¨a
);

1377 
m_ícRCSeq
->
	`£tPicP¨a
–
m_‰ameLevñ
, 
rcP¨a
 );

1380 i‡–
m_‰ameLevñ
 == 1 )

1382 
DoubÀ
 
cuºLambda
 = 
	`Clù3
–0.1, 10000.0, 
m_picLambda
 );

1383 
DoubÀ
 
upd©eLa°Lambda
 = 
g_RCWeightHi°‹yLambda
 * 
m_ícRCSeq
->
	`gëLa°Lambda
(Ë+ 
g_RCWeightCuºítLambda
 * 
cuºLambda
;

1384 
m_ícRCSeq
->
	`£tLa°Lambda
–
upd©eLa°Lambda
 );

1386 
	}
}

1388 
I¡
 
	gTEncRCPic
::
	$gëReföeBôsF‹I¡ø
–
I¡
 
‹gBôs
 )

1390 
DoubÀ
 
Æpha
=0.25, 
bëa
=0.5582;

1391 
I¡
 
iI¡øBôs
;

1393 i‡(
‹gBôs
*40 < 
m_numbîOfPixñ
)

1395 
Æpha
=0.25;

1399 
Æpha
=0.30;

1402 
iI¡øBôs
 = (
I¡
)(
Æpha
* 
	`pow
(
m_tŸÆCo°I¡ø
*4.0/(
DoubÀ
)
‹gBôs
, 
bëa
)*(Double)orgBits+0.5);

1404  
iI¡øBôs
;

1405 
	}
}

1407 
DoubÀ
 
	gTEncRCPic
::
	$ˇlcuœãLambdaI¡ø
(
DoubÀ
 
Æpha
, DoubÀ 
bëa
, DoubÀ 
MADPîPixñ
, DoubÀ 
bôsPîPixñ
)

1409  ( (
Æpha
/256.0Ë* 
	`pow
–
MADPîPixñ
/
bôsPîPixñ
, 
bëa
 ) );

1410 
	}
}

1412 
Void
 
	gTEncRCPic
::
	$upd©eAÕhaBëaI¡ø
(
DoubÀ
 *
Æpha
, DoubÀ *
bëa
)

1414 
DoubÀ
 
 bµ
 = 
	`log
(
	`pow
(
m_tŸÆCo°I¡ø
 / (DoubÀ)
m_numbîOfPixñ
, 
BETA1
));

1415 
DoubÀ
 
diffLambda
 = (*
bëa
)*(
	`log
((DoubÀ)
m_picA˘uÆBôs
)-log((DoubÀ)
m_èrgëBôs
));

1417 
diffLambda
 = 
	`Clù3
(-0.125, 0.125, 0.25*diffLambda);

1418 *
Æpha
 = (*ÆphaË* 
	`exp
(
diffLambda
);

1419 *
bëa
 = (*bëaË+ 
diffLambda
 / 
 bµ
;

1420 
	}
}

1423 
Void
 
	gTEncRCPic
::
	$gëLCUInôT¨gëBôs
()

1425 
I¡
 
iAvgBôs
 = 0;

1427 
m_ªmaöögCo°I¡ø
 = 
m_tŸÆCo°I¡ø
;

1428 
I¡
 
i
=
m_numbîOfLCU
-1; i>=0; i--)

1430 
iAvgBôs
 +
	`I¡
(
m_èrgëBôs
 * 
	`gëLCU
(
i
).
m_co°I¡ø
/
m_tŸÆCo°I¡ø
);

1431 
	`gëLCU
(
i
).
m_èrgëBôsLe·
 = 
iAvgBôs
;

1433 
	}
}

1436 
DoubÀ
 
	gTEncRCPic
::
	$gëLCUE°LambdaAndQP
(
DoubÀ
 
bµ
, 
I¡
 
˛ùPicQP
, I¡ *
e°QP
)

1438 
I¡
 
LCUIdx
 = 
	`gëLCUCoded
();

1440 
DoubÀ
 
Æpha
 = 
m_ícRCSeq
->
	`gëPicP¨a
–
m_‰ameLevñ
 ).
m_Æpha
;

1441 
DoubÀ
 
bëa
 = 
m_ícRCSeq
->
	`gëPicP¨a
–
m_‰ameLevñ
 ).
m_bëa
;

1443 
DoubÀ
 
co°PîPixñ
 = 
	`gëLCU
(
LCUIdx
).
m_co°I¡ø
/(DoubÀ)gëLCU(LCUIdx).
m_numbîOfPixñ
;

1444 
co°PîPixñ
 = 
	`pow
(co°PîPixñ, 
BETA1
);

1445 
DoubÀ
 
e°Lambda
 = 
	`ˇlcuœãLambdaI¡ø
(
Æpha
, 
bëa
, 
co°PîPixñ
, 
bµ
);

1447 
I¡
 
˛ùNeighbourQP
 = 
g_RCInvÆidQPVÆue
;

1448 
I¡
 
i
=
LCUIdx
-1; i>=0; i--)

1450 i‡((
	`gëLCU
(
i
)).
m_QP
 > 
g_RCInvÆidQPVÆue
)

1452 
˛ùNeighbourQP
 = 
	`gëLCU
(
i
).
m_QP
;

1457 
I¡
 
möQP
 = 
˛ùPicQP
 - 2;

1458 
I¡
 
maxQP
 = 
˛ùPicQP
 + 2;

1460 i‡–
˛ùNeighbourQP
 > 
g_RCInvÆidQPVÆue
 )

1462 
maxQP
 = 
	`mö
(
˛ùNeighbourQP
 + 1, maxQP);

1463 
möQP
 = 
	`max
(
˛ùNeighbourQP
 - 1, minQP);

1466 
DoubÀ
 
maxLambda
=
	`exp
(((DoubÀ)(
maxQP
+0.49)-13.7122)/4.2005);

1467 
DoubÀ
 
möLambda
=
	`exp
(((DoubÀ)(
möQP
-0.49)-13.7122)/4.2005);

1469 
e°Lambda
 = 
	`Clù3
(
möLambda
, 
maxLambda
,ÉstLambda);

1470 #i‡
JVET_K0390_RATE_CTRL


1472 
e°Lambda
 = 
	`DoubÀ
(
	`öt64_t
”°Lambd®* (
DoubÀ
)
LAMBDA_PREC
 + 0.5)) / (Double)LAMBDA_PREC;

1474 *
e°QP
 = 
	`I¡
–4.2005 * 
	`log
(
e°Lambda
) + 13.7122 + 0.5 );

1475 *
e°QP
 = 
	`Clù3
(
möQP
, 
maxQP
, *estQP);

1477  
e°Lambda
;

1478 
	}
}

1480 
	gTEncR©eCål
::
	$TEncR©eCål
()

1482 
m_ícRCSeq
 = 
NULL
;

1483 
m_ícRCGOP
 = 
NULL
;

1484 
m_ícRCPic
 = 
NULL
;

1485 
	}
}

1487 
	gTEncR©eCål
::~
	$TEncR©eCål
()

1489 
	`de°roy
();

1490 
	}
}

1492 
Void
 
	gTEncR©eCål
::
	$de°roy
()

1494 i‡–
m_ícRCSeq
 !
NULL
 )

1496 
dñëe
 
m_ícRCSeq
;

1497 
m_ícRCSeq
 = 
NULL
;

1499 i‡–
m_ícRCGOP
 !
NULL
 )

1501 
dñëe
 
m_ícRCGOP
;

1502 
m_ícRCGOP
 = 
NULL
;

1504  
m_li°RCPi˘uªs
.
	`size
() > 0 )

1506 
TEncRCPic
* 
p
 = 
m_li°RCPi˘uªs
.
	`‰⁄t
();

1507 
m_li°RCPi˘uªs
.
	`p›_‰⁄t
();

1508 
dñëe
 
p
;

1510 
	}
}

1512 
Void
 
	gTEncR©eCål
::
	$öô
–
I¡
 
tŸÆFømes
, I¡ 
èrgëBôøã
, I¡ 
‰ameR©e
, I¡ 
GOPSize
, I¡ 
picWidth
, I¡ 
picHeight
, I¡ 
LCUWidth
, I¡ 
LCUHeight
, I¡ 
kìpHõrBôs
, 
Boﬁ
 
u£LCUSï¨©eModñ
, 
GOPE¡ry
 
GOPLi°
[
MAX_GOP
] )

1514 
	`de°roy
();

1516 
Boﬁ
 
isLowdñay
 = 
åue
;

1517  
I¡
 
i
=0; i<
GOPSize
-1; i++ )

1519 i‡–
GOPLi°
[
i
].
m_POC
 > GOPList[i+1].m_POC )

1521 
isLowdñay
 = 
Ál£
;

1526 
I¡
 
numbîOfLevñ
 = 1;

1527 
I¡
 
ad≠tiveBô
 = 0;

1528 i‡–
kìpHõrBôs
 > 0 )

1530 
numbîOfLevñ
 = 
	`I¡
–
	`log
((
DoubÀ
)
GOPSize
)/log(2.0) + 0.5 ) + 1;

1532 #i‡
JVET_K0390_RATE_CTRL


1533 i‡(!
isLowdñay
 && (
GOPSize
 == 16 || GOPSize == 8))

1535 i‡–!
isLowdñay
 && 
GOPSize
 == 8 )

1538 
numbîOfLevñ
 = 
	`I¡
–
	`log
((
DoubÀ
)
GOPSize
)/log(2.0) + 0.5 ) + 1;

1540 
numbîOfLevñ
++;

1541 
numbîOfLevñ
++;

1544 
I¡
* 
bôsR©io
;

1545 
bôsR©io
 = 
√w
 
I¡
[ 
GOPSize
 ];

1546  
I¡
 
i
=0; i<
GOPSize
; i++ )

1548 
bôsR©io
[
i
] = 10;

1549 i‡–!
GOPLi°
[
i
].
m_ªfPic
 )

1551 
bôsR©io
[
i
] = 2;

1555 i‡–
kìpHõrBôs
 > 0 )

1557 
DoubÀ
 
bµ
 = (DoubÀ)–
èrgëBôøã
 / (DoubÀ)–
‰ameR©e
*
picWidth
*
picHeight
 ) );

1558 i‡–
GOPSize
 =4 && 
isLowdñay
 )

1560 i‡–
bµ
 > 0.2 )

1562 
bôsR©io
[0] = 2;

1563 
bôsR©io
[1] = 3;

1564 
bôsR©io
[2] = 2;

1565 
bôsR©io
[3] = 6;

1567 if–
bµ
 > 0.1 )

1569 
bôsR©io
[0] = 2;

1570 
bôsR©io
[1] = 3;

1571 
bôsR©io
[2] = 2;

1572 
bôsR©io
[3] = 10;

1574 i‡–
bµ
 > 0.05 )

1576 
bôsR©io
[0] = 2;

1577 
bôsR©io
[1] = 3;

1578 
bôsR©io
[2] = 2;

1579 
bôsR©io
[3] = 12;

1583 
bôsR©io
[0] = 2;

1584 
bôsR©io
[1] = 3;

1585 
bôsR©io
[2] = 2;

1586 
bôsR©io
[3] = 14;

1589 i‡–
kìpHõrBôs
 == 2 )

1591 
ad≠tiveBô
 = 1;

1594 i‡–
GOPSize
 =8 && !
isLowdñay
 )

1596 i‡–
bµ
 > 0.2 )

1598 
bôsR©io
[0] = 15;

1599 
bôsR©io
[1] = 5;

1600 
bôsR©io
[2] = 4;

1601 
bôsR©io
[3] = 1;

1602 
bôsR©io
[4] = 1;

1603 
bôsR©io
[5] = 4;

1604 
bôsR©io
[6] = 1;

1605 
bôsR©io
[7] = 1;

1607 i‡–
bµ
 > 0.1 )

1609 
bôsR©io
[0] = 20;

1610 
bôsR©io
[1] = 6;

1611 
bôsR©io
[2] = 4;

1612 
bôsR©io
[3] = 1;

1613 
bôsR©io
[4] = 1;

1614 
bôsR©io
[5] = 4;

1615 
bôsR©io
[6] = 1;

1616 
bôsR©io
[7] = 1;

1618 i‡–
bµ
 > 0.05 )

1620 
bôsR©io
[0] = 25;

1621 
bôsR©io
[1] = 7;

1622 
bôsR©io
[2] = 4;

1623 
bôsR©io
[3] = 1;

1624 
bôsR©io
[4] = 1;

1625 
bôsR©io
[5] = 4;

1626 
bôsR©io
[6] = 1;

1627 
bôsR©io
[7] = 1;

1631 
bôsR©io
[0] = 30;

1632 
bôsR©io
[1] = 8;

1633 
bôsR©io
[2] = 4;

1634 
bôsR©io
[3] = 1;

1635 
bôsR©io
[4] = 1;

1636 
bôsR©io
[5] = 4;

1637 
bôsR©io
[6] = 1;

1638 
bôsR©io
[7] = 1;

1641 i‡–
kìpHõrBôs
 == 2 )

1643 
ad≠tiveBô
 = 2;

1646 #i‡
JVET_K0390_RATE_CTRL


1647 i‡(
GOPSize
 =16 && !
isLowdñay
)

1649 i‡(
bµ
 > 0.2)

1651 
bôsR©io
[0] = 10;

1652 
bôsR©io
[1] = 8;

1653 
bôsR©io
[2] = 4;

1654 
bôsR©io
[3] = 2;

1655 
bôsR©io
[4] = 1;

1656 
bôsR©io
[5] = 1;

1657 
bôsR©io
[6] = 2;

1658 
bôsR©io
[7] = 1;

1659 
bôsR©io
[8] = 1;

1660 
bôsR©io
[9] = 4;

1661 
bôsR©io
[10] = 2;

1662 
bôsR©io
[11] = 1;

1663 
bôsR©io
[12] = 1;

1664 
bôsR©io
[13] = 2;

1665 
bôsR©io
[14] = 1;

1666 
bôsR©io
[15] = 1;

1668 i‡(
bµ
 > 0.1)

1670 
bôsR©io
[0] = 15;

1671 
bôsR©io
[1] = 9;

1672 
bôsR©io
[2] = 4;

1673 
bôsR©io
[3] = 2;

1674 
bôsR©io
[4] = 1;

1675 
bôsR©io
[5] = 1;

1676 
bôsR©io
[6] = 2;

1677 
bôsR©io
[7] = 1;

1678 
bôsR©io
[8] = 1;

1679 
bôsR©io
[9] = 4;

1680 
bôsR©io
[10] = 2;

1681 
bôsR©io
[11] = 1;

1682 
bôsR©io
[12] = 1;

1683 
bôsR©io
[13] = 2;

1684 
bôsR©io
[14] = 1;

1685 
bôsR©io
[15] = 1;

1687 i‡(
bµ
 > 0.05)

1689 
bôsR©io
[0] = 40;

1690 
bôsR©io
[1] = 17;

1691 
bôsR©io
[2] = 7;

1692 
bôsR©io
[3] = 2;

1693 
bôsR©io
[4] = 1;

1694 
bôsR©io
[5] = 1;

1695 
bôsR©io
[6] = 2;

1696 
bôsR©io
[7] = 1;

1697 
bôsR©io
[8] = 1;

1698 
bôsR©io
[9] = 7;

1699 
bôsR©io
[10] = 2;

1700 
bôsR©io
[11] = 1;

1701 
bôsR©io
[12] = 1;

1702 
bôsR©io
[13] = 2;

1703 
bôsR©io
[14] = 1;

1704 
bôsR©io
[15] = 1;

1708 
bôsR©io
[0] = 40;

1709 
bôsR©io
[1] = 15;

1710 
bôsR©io
[2] = 6;

1711 
bôsR©io
[3] = 3;

1712 
bôsR©io
[4] = 1;

1713 
bôsR©io
[5] = 1;

1714 
bôsR©io
[6] = 3;

1715 
bôsR©io
[7] = 1;

1716 
bôsR©io
[8] = 1;

1717 
bôsR©io
[9] = 6;

1718 
bôsR©io
[10] = 3;

1719 
bôsR©io
[11] = 1;

1720 
bôsR©io
[12] = 1;

1721 
bôsR©io
[13] = 3;

1722 
bôsR©io
[14] = 1;

1723 
bôsR©io
[15] = 1;

1726 i‡(
kìpHõrBôs
 == 2)

1728 
ad≠tiveBô
 = 3;

1734 
	`¥ötf
( "\n hierarchical bitállocation isÇot support forÅhe specified coding structure currently.\n" );

1738 
I¡
* 
GOPID2Levñ
 = 
√w
 I¡[ 
GOPSize
 ];

1739  
I¡
 
i
=0; i<
GOPSize
; i++ )

1741 
GOPID2Levñ
[
i
] = 1;

1742 i‡–!
GOPLi°
[
i
].
m_ªfPic
 )

1744 
GOPID2Levñ
[
i
] = 2;

1748 i‡–
kìpHõrBôs
 > 0 )

1750 i‡–
GOPSize
 =4 && 
isLowdñay
 )

1752 
GOPID2Levñ
[0] = 3;

1753 
GOPID2Levñ
[1] = 2;

1754 
GOPID2Levñ
[2] = 3;

1755 
GOPID2Levñ
[3] = 1;

1757 i‡–
GOPSize
 =8 && !
isLowdñay
 )

1759 
GOPID2Levñ
[0] = 1;

1760 
GOPID2Levñ
[1] = 2;

1761 
GOPID2Levñ
[2] = 3;

1762 
GOPID2Levñ
[3] = 4;

1763 
GOPID2Levñ
[4] = 4;

1764 
GOPID2Levñ
[5] = 3;

1765 
GOPID2Levñ
[6] = 4;

1766 
GOPID2Levñ
[7] = 4;

1768 #i‡
JVET_K0390_RATE_CTRL


1769 i‡(
GOPSize
 =16 && !
isLowdñay
)

1771 
GOPID2Levñ
[0] = 1;

1772 
GOPID2Levñ
[1] = 2;

1773 
GOPID2Levñ
[2] = 3;

1774 
GOPID2Levñ
[3] = 4;

1775 
GOPID2Levñ
[4] = 5;

1776 
GOPID2Levñ
[5] = 5;

1777 
GOPID2Levñ
[6] = 4;

1778 
GOPID2Levñ
[7] = 5;

1779 
GOPID2Levñ
[8] = 5;

1780 
GOPID2Levñ
[9] = 3;

1781 
GOPID2Levñ
[10] = 4;

1782 
GOPID2Levñ
[11] = 5;

1783 
GOPID2Levñ
[12] = 5;

1784 
GOPID2Levñ
[13] = 4;

1785 
GOPID2Levñ
[14] = 5;

1786 
GOPID2Levñ
[15] = 5;

1791 i‡–!
isLowdñay
 && 
GOPSize
 == 8 )

1793 
GOPID2Levñ
[0] = 1;

1794 
GOPID2Levñ
[1] = 2;

1795 
GOPID2Levñ
[2] = 3;

1796 
GOPID2Levñ
[3] = 4;

1797 
GOPID2Levñ
[4] = 4;

1798 
GOPID2Levñ
[5] = 3;

1799 
GOPID2Levñ
[6] = 4;

1800 
GOPID2Levñ
[7] = 4;

1802 #i‡
JVET_K0390_RATE_CTRL


1803 i‡(
GOPSize
 =16 && !
isLowdñay
)

1805 
GOPID2Levñ
[0] = 1;

1806 
GOPID2Levñ
[1] = 2;

1807 
GOPID2Levñ
[2] = 3;

1808 
GOPID2Levñ
[3] = 4;

1809 
GOPID2Levñ
[4] = 5;

1810 
GOPID2Levñ
[5] = 5;

1811 
GOPID2Levñ
[6] = 4;

1812 
GOPID2Levñ
[7] = 5;

1813 
GOPID2Levñ
[8] = 5;

1814 
GOPID2Levñ
[9] = 3;

1815 
GOPID2Levñ
[10] = 4;

1816 
GOPID2Levñ
[11] = 5;

1817 
GOPID2Levñ
[12] = 5;

1818 
GOPID2Levñ
[13] = 4;

1819 
GOPID2Levñ
[14] = 5;

1820 
GOPID2Levñ
[15] = 5;

1824 
m_ícRCSeq
 = 
√w
 
TEncRCSeq
;

1825 
m_ícRCSeq
->
	`¸óã
–
tŸÆFømes
, 
èrgëBôøã
, 
‰ameR©e
, 
GOPSize
, 
picWidth
, 
picHeight
, 
LCUWidth
, 
LCUHeight
, 
numbîOfLevñ
, 
u£LCUSï¨©eModñ
, 
ad≠tiveBô
 );

1826 
m_ícRCSeq
->
	`öôBôsR©io
–
bôsR©io
 );

1827 
m_ícRCSeq
->
	`öôGOPID2Levñ
–
GOPID2Levñ
 );

1828 
m_ícRCSeq
->
	`öôPicP¨a
();

1829 i‡–
u£LCUSï¨©eModñ
 )

1831 
m_ícRCSeq
->
	`öôLCUP¨a
();

1833 
m_CpbS©uøti⁄E«bÀd
 = 
Ál£
;

1834 
m_˝bSize
 = 
èrgëBôøã
;

1835 
m_˝bSèã
 = (
UI¡
)(
m_˝bSize
*0.5f);

1836 
m_buf„rögR©e
 = (
I¡
)(
èrgëBôøã
 / 
‰ameR©e
);

1838 
dñëe
[] 
bôsR©io
;

1839 
dñëe
[] 
GOPID2Levñ
;

1840 
	}
}

1842 
Void
 
	gTEncR©eCål
::
	$öôRCPic
–
I¡
 
‰ameLevñ
 )

1844 
m_ícRCPic
 = 
√w
 
TEncRCPic
;

1845 
m_ícRCPic
->
	`¸óã
–
m_ícRCSeq
, 
m_ícRCGOP
, 
‰ameLevñ
, 
m_li°RCPi˘uªs
 );

1846 
	}
}

1848 
Void
 
	gTEncR©eCål
::
	$öôRCGOP
–
I¡
 
numbîOfPi˘uªs
 )

1850 
m_ícRCGOP
 = 
√w
 
TEncRCGOP
;

1851 
m_ícRCGOP
->
	`¸óã
–
m_ícRCSeq
, 
numbîOfPi˘uªs
 );

1852 
	}
}

1854 
I¡
 
	gTEncR©eCål
::
	$upd©eCpbSèã
(
I¡
 
a˘uÆBôs
)

1856 
I¡
 
˝bSèã
 = 1;

1858 
m_˝bSèã
 -
a˘uÆBôs
;

1859 i‡(
m_˝bSèã
 < 0)

1861 
˝bSèã
 = -1;

1864 
m_˝bSèã
 +
m_buf„rögR©e
;

1865 i‡(
m_˝bSèã
 > 
m_˝bSize
)

1867 
˝bSèã
 = 0;

1870  
˝bSèã
;

1871 
	}
}

1873 
Void
 
	gTEncR©eCål
::
	$öôHrdP¨am
(c⁄° 
TComHRD
* 
pcHrd
, 
I¡
 
iFømeR©e
, 
DoubÀ
 
fInôülCpbFuŒ√ss
)

1875 
m_CpbS©uøti⁄E«bÀd
 = 
åue
;

1876 
m_˝bSize
 = (
pcHrd
->
	`gëCpbSizeVÆueMöus1
(0, 0, 0Ë+ 1Ë<< (4 +ÖcHrd->
	`gëCpbSizeSˇÀ
());

1877 
m_˝bSèã
 = (
UI¡
)(
m_˝bSize
*
fInôülCpbFuŒ√ss
);

1878 
m_buf„rögR©e
 = (
UI¡
)(((
pcHrd
->
	`gëBôR©eVÆueMöus1
(0, 0, 0Ë+ 1Ë<< (6 +ÖcHrd->
	`gëBôR©eSˇÀ
())Ë/ 
iFømeR©e
);

1879 
	`¥ötf
("\nHRD - [Inôü»CPB sèã %6d] [CPB Sizê%6d] [Buf„rög R©ê%6d]\n", 
m_˝bSèã
, 
m_˝bSize
, 
m_buf„rögR©e
);

1880 
	}
}

1882 
Void
 
	gTEncR©eCål
::
	$de°royRCGOP
()

1884 
dñëe
 
m_ícRCGOP
;

1885 
m_ícRCGOP
 = 
NULL
;

1886 
	}
}

	@TLibEncoder/TEncRateCtrl.h

38 #i‚de‡
__TENCRATECTRL__


39 
	#__TENCRATECTRL__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


46 
	~"../TLibComm⁄/Comm⁄Def.h
"

47 
	~"../TLibComm⁄/TComD©aCU.h
"

49 
	~<ve˘‹
>

50 
	~<Æg‹ôhm
>

52 
usög
 
«me•a˚
 
	g°d
;

57 
	~"../TLibEncodî/TEncCfg.h
"

58 
	~<li°
>

59 
	~<ˇs£π
>

61 c⁄° 
I¡
 
	gg_RCInvÆidQPVÆue
 = -999;

62 c⁄° 
I¡
 
	gg_RCSmoŸhWödowSize
 = 40;

63 c⁄° 
I¡
 
	gg_RCMaxPicLi°Size
 = 32;

64 c⁄° 
DoubÀ
 
	gg_RCWeightPicT¨gëBôInGOP
 = 0.9;

65 c⁄° 
DoubÀ
 
	gg_RCWeightPicR¨gëBôInBuf„r
 = 1.0 - 
g_RCWeightPicT¨gëBôInGOP
;

66 c⁄° 
I¡
 
	gg_RCIãøti⁄Num
 = 20;

67 c⁄° 
DoubÀ
 
	gg_RCWeightHi°‹yLambda
 = 0.5;

68 c⁄° 
DoubÀ
 
	gg_RCWeightCuºítLambda
 = 1.0 - 
g_RCWeightHi°‹yLambda
;

69 c⁄° 
I¡
 
	gg_RCLCUSmoŸhWödowSize
 = 4;

70 c⁄° 
DoubÀ
 
	gg_RCAÕhaMöVÆue
 = 0.05;

71 c⁄° 
DoubÀ
 
	gg_RCAÕhaMaxVÆue
 = 500.0;

72 c⁄° 
DoubÀ
 
	gg_RCBëaMöVÆue
 = -3.0;

73 c⁄° 
DoubÀ
 
	gg_RCBëaMaxVÆue
 = -0.1;

74 #i‡
JVET_K0390_RATE_CTRL


75 c⁄° 
I¡
 
	gLAMBDA_PREC
 = 1000000;

78 
	#ALPHA
 6.7542;

	)

79 
	#BETA1
 1.2517

	)

80 
	#BETA2
 1.7860

	)

82 
	sTRCLCU


84 
I¡
 
	mm_a˘uÆBôs
;

85 
I¡
 
	mm_QP
;

86 
I¡
 
	mm_èrgëBôs
;

87 
DoubÀ
 
	mm_œmbda
;

88 
DoubÀ
 
	mm_bôWeight
;

89 
I¡
 
	mm_numbîOfPixñ
;

90 
DoubÀ
 
	mm_co°I¡ø
;

91 
I¡
 
	mm_èrgëBôsLe·
;

92 #i‡
JVET_K0390_RATE_CTRL


93 
DoubÀ
 
	mm_a˘uÆSSE
;

94 
DoubÀ
 
	mm_a˘uÆMSE
;

98 
	sTRCP¨amëî


100 
DoubÀ
 
	mm_Æpha
;

101 
DoubÀ
 
	mm_bëa
;

102 #i‡
JVET_K0390_RATE_CTRL


103 
I¡
 
	mm_vÆidPix
;

105 #i‡
JVET_M0600_RATE_CTRL


106 
DoubÀ
 
	mm_skùR©io
;

110 ˛as†
	cTEncRCSeq


112 
	mpublic
:

113 
TEncRCSeq
();

114 ~
TEncRCSeq
();

116 
	mpublic
:

117 
Void
 
¸óã
–
I¡
 
tŸÆFømes
, I¡ 
èrgëBôøã
, I¡ 
‰ameR©e
, I¡ 
GOPSize
, I¡ 
picWidth
, I¡ 
picHeight
, I¡ 
LCUWidth
, I¡ 
LCUHeight
, I¡ 
numbîOfLevñ
, 
Boﬁ
 
u£LCUSï¨©eModñ
, I¡ 
ad≠tiveBô
 );

118 
Void
 
de°roy
();

119 
Void
 
öôBôsR©io
–
I¡
 
bôsR©io
[] );

120 
Void
 
öôGOPID2Levñ
–
I¡
 
GOPID2Levñ
[] );

121 
Void
 
öôPicP¨a
–
TRCP¨amëî
* 
picP¨a
 = 
NULL
 );

122 
Void
 
öôLCUP¨a
–
TRCP¨amëî
** 
LCUP¨a
 = 
NULL
 );

123 
Void
 
upd©eA·îPic
 ( 
I¡
 
bôs
 );

124 
Void
 
£tAŒBôR©io
–
DoubÀ
 
basicLambda
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
 );

126 
	mpublic
:

127 
I¡
 
	$gëTŸÆFømes
(Ë{  
m_tŸÆFømes
; }

128 
I¡
 
	$gëT¨gëR©e
(Ë{  
m_èrgëR©e
; 
	}
}

129 
I¡
 
	$gëFømeR©e
(Ë{  
m_‰ameR©e
; 
	}
}

130 
I¡
 
	$gëGOPSize
(Ë{  
m_GOPSize
; 
	}
}

131 
I¡
 
	$gëPicWidth
(Ë{  
m_picWidth
; 
	}
}

132 
I¡
 
	$gëPicHeight
(Ë{  
m_picHeight
; 
	}
}

133 
I¡
 
	$gëLCUWidth
(Ë{  
m_LCUWidth
; 
	}
}

134 
I¡
 
	$gëLCUHeight
(Ë{  
m_LCUHeight
; 
	}
}

135 
I¡
 
	$gëNumbîOfLevñ
(Ë{  
m_numbîOfLevñ
; 
	}
}

136 
I¡
 
	$gëAvîageBôs
(Ë{  
m_avîageBôs
; 
	}
}

137 
I¡
 
	$gëLe·AvîageBôs
(Ë{ 
	`as£π
–
m_‰amesLe·
 > 0 );  (
I¡
)(
m_bôsLe·
 / m_‰amesLe·); 
	}
}

138 
Boﬁ
 
	$gëU£LCUSï¨©eModñ
(Ë{  
m_u£LCUSï¨©eModñ
; 
	}
}

140 
I¡
 
	$gëNumPixñ
(Ë{  
m_numbîOfPixñ
; 
	}
}

141 
I¡64
 
	$gëT¨gëBôs
(Ë{  
m_èrgëBôs
; 
	}
}

142 
I¡
 
	$gëNumbîOfLCU
(Ë{  
m_numbîOfLCU
; 
	}
}

143 
I¡
* 
	$gëBôR©io
(Ë{  
m_bôsR©io
; 
	}
}

144 
I¡
 
	$gëBôR©io
–
I¡
 
idx
 ) { 
	`as£π
–idx<
m_GOPSize
);  
m_bôsR©io
[idx]; 
	}
}

145 
I¡
* 
	$gëGOPID2Levñ
(Ë{  
m_GOPID2Levñ
; 
	}
}

146 
I¡
 
	$gëGOPID2Levñ
–
I¡
 
ID
 ) { 
	`as£π
–ID < 
m_GOPSize
 );  
m_GOPID2Levñ
[ID]; 
	}
}

147 
TRCP¨amëî
* 
	$gëPicP¨a
(Ë{  
m_picP¨a
; 
	}
}

148 
TRCP¨amëî
 
	$gëPicP¨a
–
I¡
 
Àvñ
 ) { 
	`as£π
–Àvñ < 
m_numbîOfLevñ
 );  
m_picP¨a
[Àvñ]; 
	}
}

149 
Void
 
	$£tPicP¨a
–
I¡
 
Àvñ
, 
TRCP¨amëî
 
∑ø
 ) { 
	`as£π
–Àvñ < 
m_numbîOfLevñ
 ); 
m_picP¨a
[Àvñ] =Ö¨a; 
	}
}

150 
TRCP¨amëî
** 
	$gëLCUP¨a
(Ë{  
m_LCUP¨a
; 
	}
}

151 
TRCP¨amëî
* 
	$gëLCUP¨a
–
I¡
 
Àvñ
 ) { 
	`as£π
–Àvñ < 
m_numbîOfLevñ
 );  
m_LCUP¨a
[Àvñ]; 
	}
}

152 
TRCP¨amëî
 
	$gëLCUP¨a
–
I¡
 
Àvñ
, I¡ 
LCUIdx
 ) { 
	`as£π
–LCUIdx < 
m_numbîOfLCU
 );  
	`gëLCUP¨a
÷evñ)[LCUIdx]; 
	}
}

153 
Void
 
	$£tLCUP¨a
–
I¡
 
Àvñ
, I¡ 
LCUIdx
, 
TRCP¨amëî
 
∑ø
 ) { 
	`as£π
–Àvñ < 
m_numbîOfLevñ
 );ás£π–LCUIdx < 
m_numbîOfLCU
 ); 
m_LCUP¨a
[Àvñ][LCUIdx] =Ö¨a; 
	}
}

155 
I¡
 
	$gëFømesLe·
(Ë{  
m_‰amesLe·
; 
	}
}

156 
I¡64
 
	$gëBôsLe·
(Ë{  
m_bôsLe·
; 
	}
}

158 
DoubÀ
 
	$gëSeqBµ
(Ë{  
m_£qT¨gëBµ
; 
	}
}

159 
DoubÀ
 
	$gëAÕhaUpd©e
(Ë{  
m_ÆphaUpd©e
; 
	}
}

160 
DoubÀ
 
	$gëBëaUpd©e
(Ë{  
m_bëaUpd©e
; 
	}
}

162 
I¡
 
	$gëAd≠tiveBôs
(Ë{  
m_ad≠tiveBô
; 
	}
}

163 
DoubÀ
 
	$gëLa°Lambda
(Ë{  
m_œ°Lambda
; 
	}
}

164 
Void
 
	$£tLa°Lambda
–
DoubÀ
 
œmdba
 ) { 
m_œ°Lambda
 =Üamdba; 
	}
}

166 
	g¥iv©e
:

167 
I¡
 
m_tŸÆFømes
;

168 
I¡
 
	gm_èrgëR©e
;

169 
I¡
 
	gm_‰ameR©e
;

170 
I¡
 
	gm_GOPSize
;

171 
I¡
 
	gm_picWidth
;

172 
I¡
 
	gm_picHeight
;

173 
I¡
 
	gm_LCUWidth
;

174 
I¡
 
	gm_LCUHeight
;

175 
I¡
 
	gm_numbîOfLevñ
;

176 
I¡
 
	gm_avîageBôs
;

178 
I¡
 
	gm_numbîOfPixñ
;

179 
I¡64
 
	gm_èrgëBôs
;

180 
I¡
 
	gm_numbîOfLCU
;

181 
I¡
* 
	gm_bôsR©io
;

182 
I¡
* 
	gm_GOPID2Levñ
;

183 
TRCP¨amëî
* 
	gm_picP¨a
;

184 
TRCP¨amëî
** 
	gm_LCUP¨a
;

186 
I¡
 
	gm_‰amesLe·
;

187 
I¡64
 
	gm_bôsLe·
;

188 
DoubÀ
 
	gm_£qT¨gëBµ
;

189 
DoubÀ
 
	gm_ÆphaUpd©e
;

190 
DoubÀ
 
	gm_bëaUpd©e
;

191 
Boﬁ
 
	gm_u£LCUSï¨©eModñ
;

193 
I¡
 
	gm_ad≠tiveBô
;

194 
DoubÀ
 
	gm_œ°Lambda
;

197 ˛as†
	cTEncRCGOP


199 
	mpublic
:

200 
TEncRCGOP
();

201 ~
TEncRCGOP
();

203 
	mpublic
:

204 
Void
 
¸óã
–
TEncRCSeq
* 
ícRCSeq
, 
I¡
 
numPic
 );

205 
Void
 
de°roy
();

206 
Void
 
upd©eA·îPi˘uª
–
I¡
 
bôsCo°
 );

208 
	m¥iv©e
:

209 
I¡
 
xE°GOPT¨gëBôs
–
TEncRCSeq
* 
ícRCSeq
, I¡ 
GOPSize
 );

210 
Void
 
xCÆEquaC€ff
–
TEncRCSeq
* 
ícRCSeq
, 
DoubÀ
* 
œmbdaR©io
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
, 
I¡
 
GOPSize
 );

211 #i‡
JVET_K0390_RATE_CTRL


212 
DoubÀ
 
xSﬁveEqua
(
TEncRCSeq
* 
ícRCSeq
, DoubÀ 
èrgëBµ
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
, 
I¡
 
GOPSize
);

214 
DoubÀ
 
xSﬁveEqua
–DoubÀ 
èrgëBµ
, DoubÀ* 
equaC€ffA
, DoubÀ* 
equaC€ffB
, 
I¡
 
GOPSize
 );

216 
	mpublic
:

217 
TEncRCSeq
* 
	$gëEncRCSeq
(Ë{  
m_ícRCSeq
; }

218 
I¡
 
	$gëNumPic
(Ë{  
m_numPic
;
	}
}

219 
I¡
 
	$gëT¨gëBôs
(Ë{  
m_èrgëBôs
; 
	}
}

220 
I¡
 
	$gëPicLe·
(Ë{  
m_picLe·
; 
	}
}

221 
I¡
 
	$gëBôsLe·
(Ë{  
m_bôsLe·
; 
	}
}

222 
I¡
 
	$gëT¨gëBôInGOP
–
I¡
 
i
 ) {  
m_picT¨gëBôInGOP
[i]; 
	}
}

224 
	g¥iv©e
:

225 
TEncRCSeq
* 
m_ícRCSeq
;

226 
I¡
* 
	gm_picT¨gëBôInGOP
;

227 
I¡
 
	gm_numPic
;

228 
I¡
 
	gm_èrgëBôs
;

229 
I¡
 
	gm_picLe·
;

230 
I¡
 
	gm_bôsLe·
;

233 ˛as†
	cTEncRCPic


235 
	mpublic
:

236 
TEncRCPic
();

237 ~
TEncRCPic
();

239 
	mpublic
:

240 
Void
 
¸óã
–
TEncRCSeq
* 
ícRCSeq
, 
TEncRCGOP
* 
ícRCGOP
, 
I¡
 
‰ameLevñ
, 
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
 );

241 
Void
 
de°roy
();

243 
I¡
 
e°im©ePicQP
 ( 
DoubÀ
 
œmbda
, 
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
 );

244 
I¡
 
gëReföeBôsF‹I¡ø
(I¡ 
‹gBôs
);

245 
DoubÀ
 
ˇlcuœãLambdaI¡ø
(DoubÀ 
Æpha
, DoubÀ 
bëa
, DoubÀ 
MADPîPixñ
, DoubÀ 
bôsPîPixñ
);

246 
DoubÀ
 
e°im©ePicLambda
–
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
, 
Sli˚Ty≥
 
eSli˚Ty≥
);

248 
Void
 
upd©eAÕhaBëaI¡ø
(
DoubÀ
 *
Æpha
, DoubÀ *
bëa
);

250 
DoubÀ
 
gëLCUT¨gëBµ
(
Sli˚Ty≥
 
eSli˚Ty≥
);

251 
DoubÀ
 
gëLCUE°LambdaAndQP
(DoubÀ 
bµ
, 
I¡
 
˛ùPicQP
, I¡ *
e°QP
);

252 
DoubÀ
 
gëLCUE°Lambda
–DoubÀ 
bµ
 );

253 
I¡
 
gëLCUE°QP
–
DoubÀ
 
œmbda
, I¡ 
˛ùPicQP
 );

254 #i‡
JVET_M0600_RATE_CTRL


255 
upd©eA·îCTU
–
I¡
 
LCUIdx
, I¡ 
bôs
, I¡ 
QP
, 
DoubÀ
 
œmbda
, DoubÀ 
skùR©io
, 
Boﬁ
 
upd©eLCUP¨amëî
 = 
åue
);

257 
Void
 
upd©eA·îCTU
–
I¡
 
LCUIdx
, I¡ 
bôs
, I¡ 
QP
, 
DoubÀ
 
œmbda
, 
Boﬁ
 
upd©eLCUP¨amëî
 = 
åue
 );

259 
Void
 
upd©eA·îPi˘uª
–
I¡
 
a˘uÆHódîBôs
, I¡ 
a˘uÆTŸÆBôs
, 
DoubÀ
 
avîageQP
, DoubÀ 
avîageLambda
, 
Sli˚Ty≥
 
eSli˚Ty≥
);

261 
Void
 
addToPi˘uªLsô
–
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
 );

262 
DoubÀ
 
ˇlAvîageQP
();

263 
DoubÀ
 
ˇlAvîageLambda
();

265 
	m¥iv©e
:

266 
I¡
 
xE°PicT¨gëBôs
–
TEncRCSeq
* 
ícRCSeq
, 
TEncRCGOP
* 
ícRCGOP
 );

267 
I¡
 
xE°PicHódîBôs
–
li°
<
TEncRCPic
*>& 
li°PªviousPi˘uªs
, I¡ 
‰ameLevñ
 );

268 
I¡
 
xE°PicLowîBound
–
TEncRCSeq
* 
ícRCSeq
, 
TEncRCGOP
* 
ícRCGOP
 );

270 
	mpublic
:

271 
TEncRCSeq
* 
	$gëRCSequí˚
(Ë{  
m_ícRCSeq
; }

272 
TEncRCGOP
* 
	$gëRCGOP
(Ë{  
m_ícRCGOP
; 
	}
}

274 
I¡
 
	$gëFømeLevñ
(Ë{  
m_‰ameLevñ
; 
	}
}

275 
I¡
 
	$gëNumbîOfPixñ
(Ë{  
m_numbîOfPixñ
; 
	}
}

276 
I¡
 
	$gëNumbîOfLCU
(Ë{  
m_numbîOfLCU
; 
	}
}

277 
I¡
 
	$gëT¨gëBôs
(Ë{  
m_èrgëBôs
; 
	}
}

278 
I¡
 
	$gëE°HódîBôs
(Ë{  
m_e°HódîBôs
; 
	}
}

279 
I¡
 
	$gëLCULe·
(Ë{  
m_LCULe·
; 
	}
}

280 
I¡
 
	$gëBôsLe·
(Ë{  
m_bôsLe·
; 
	}
}

281 
I¡
 
	$gëPixñsLe·
(Ë{  
m_pixñsLe·
; 
	}
}

282 
I¡
 
	$gëBôsCoded
(Ë{  
m_èrgëBôs
 - 
m_e°HódîBôs
 - 
m_bôsLe·
; 
	}
}

283 
I¡
 
	$gëLCUCoded
(Ë{  
m_numbîOfLCU
 - 
m_LCULe·
; 
	}
}

284 
I¡
 
	$gëLowîBound
(Ë{  
m_lowîBound
; 
	}
}

285 
TRCLCU
* 
	$gëLCU
(Ë{  
m_LCUs
; 
	}
}

286 
	gTRCLCU
& 
	$gëLCU
–
I¡
 
LCUIdx
 ) {  
m_LCUs
[LCUIdx]; 
	}
}

287 
I¡
 
	$gëPicA˘uÆHódîBôs
(Ë{  
m_picA˘uÆHódîBôs
; 
	}
}

288 
Void
 
	$£tBôLe·
(
I¡
 
bôs
Ë{ 
m_bôsLe·
 = bôs; 
	}
}

289 
Void
 
	$£tT¨gëBôs
–
I¡
 
bôs
 ) { 
m_èrgëBôs
 = bôs; 
m_bôsLe·
 = bôs;
	}
}

290 
Void
 
	$£tTŸÆI¡øCo°
(
DoubÀ
 
co°
Ë{ 
m_tŸÆCo°I¡ø
 = co°; 
	}
}

291 
Void
 
gëLCUInôT¨gëBôs
();

293 
I¡
 
	$gëPicA˘uÆBôs
(Ë{  
m_picA˘uÆBôs
; 
	}
}

294 
I¡
 
	$gëPicA˘uÆQP
(Ë{  
m_picQP
; 
	}
}

295 
DoubÀ
 
	$gëPicA˘uÆLambda
(Ë{  
m_picLambda
; 
	}
}

296 
I¡
 
	$gëPicE°QP
(Ë{  
m_e°PicQP
; 
	}
}

297 
Void
 
	$£tPicE°QP
–
I¡
 
QP
 ) { 
m_e°PicQP
 = QP; 
	}
}

298 
DoubÀ
 
	$gëPicE°Lambda
(Ë{  
m_e°PicLambda
; 
	}
}

299 
Void
 
	$£tPicE°Lambda
–
DoubÀ
 
œmbda
 ) { 
m_picLambda
 =Üambda; 
	}
}

301 #i‡
JVET_K0390_RATE_CTRL


302 
DoubÀ
 
	$gëPicMSE
(Ë{  
m_picMSE
; 
	}
}

303 
	$£tPicMSE
(
DoubÀ
 
avgMSE
Ë{ 
m_picMSE
 =ávgMSE; 
	}
}

306 
	g¥iv©e
:

307 
TEncRCSeq
* 
m_ícRCSeq
;

308 
TEncRCGOP
* 
	gm_ícRCGOP
;

310 
I¡
 
	gm_‰ameLevñ
;

311 
I¡
 
	gm_numbîOfPixñ
;

312 
I¡
 
	gm_numbîOfLCU
;

313 
I¡
 
	gm_èrgëBôs
;

314 
I¡
 
	gm_e°HódîBôs
;

315 
I¡
 
	gm_e°PicQP
;

316 
I¡
 
	gm_lowîBound
;

317 
DoubÀ
 
	gm_e°PicLambda
;

319 
I¡
 
	gm_LCULe·
;

320 
I¡
 
	gm_bôsLe·
;

321 
I¡
 
	gm_pixñsLe·
;

323 
TRCLCU
* 
	gm_LCUs
;

324 
I¡
 
	gm_picA˘uÆHódîBôs
;

325 
DoubÀ
 
	gm_tŸÆCo°I¡ø
;

326 
DoubÀ
 
	gm_ªmaöögCo°I¡ø
;

327 
I¡
 
	gm_picA˘uÆBôs
;

328 
I¡
 
	gm_picQP
;

329 
DoubÀ
 
	gm_picLambda
;

330 #i‡
JVET_K0390_RATE_CTRL


331 
DoubÀ
 
	gm_picMSE
;

332 
I¡
 
	gm_vÆidPixñsInPic
;

336 ˛as†
	cTEncR©eCål


338 
	mpublic
:

339 
TEncR©eCål
();

340 ~
TEncR©eCål
();

342 
	mpublic
:

343 
Void
 
öô
–
I¡
 
tŸÆFømes
, I¡ 
èrgëBôøã
, I¡ 
‰ameR©e
, I¡ 
GOPSize
, I¡ 
picWidth
, I¡ 
picHeight
, I¡ 
LCUWidth
, I¡ 
LCUHeight
, I¡ 
kìpHõrBôs
, 
Boﬁ
 
u£LCUSï¨©eModñ
, 
GOPE¡ry
 
GOPLi°
[
MAX_GOP
] );

344 
Void
 
de°roy
();

345 
Void
 
öôRCPic
–
I¡
 
‰ameLevñ
 );

346 
Void
 
öôRCGOP
–
I¡
 
numbîOfPi˘uªs
 );

347 
Void
 
de°royRCGOP
();

349 
	mpublic
:

350 
Void
 
	$£tRCQP
 ( 
I¡
 
QP
 ) { 
m_RCQP
 = QP; }

351 
I¡
 
	$gëRCQP
 (Ë{  
m_RCQP
; 
	}
}

352 
TEncRCSeq
* 
	$gëRCSeq
(Ë{ 
	`as£π
 ( 
m_ícRCSeq
 !
NULL
 );  m_ícRCSeq; 
	}
}

353 
TEncRCGOP
* 
	$gëRCGOP
(Ë{ 
	`as£π
 ( 
m_ícRCGOP
 !
NULL
 );  m_ícRCGOP; 
	}
}

354 
TEncRCPic
* 
	$gëRCPic
(Ë{ 
	`as£π
 ( 
m_ícRCPic
 !
NULL
 );  m_ícRCPic; 
	}
}

355 
	gli°
<
	gTEncRCPic
*>& 
	$gëPicLi°
(Ë{  
m_li°RCPi˘uªs
; 
	}
}

356 
Boﬁ
 
	$gëCpbS©uøti⁄E«bÀd
(Ë{  
m_CpbS©uøti⁄E«bÀd
; 
	}
}

357 
UI¡
 
	$gëCpbSèã
(Ë{  
m_˝bSèã
; 
	}
}

358 
UI¡
 
	$gëCpbSize
(Ë{  
m_˝bSize
; 
	}
}

359 
UI¡
 
	$gëBuf„rögR©e
(Ë{  
m_buf„rögR©e
; 
	}
}

360 
I¡
 
upd©eCpbSèã
(I¡ 
a˘uÆBôs
);

361 
Void
 
öôHrdP¨am
(c⁄° 
TComHRD
* 
pcHrd
, 
I¡
 
iFømeR©e
, 
DoubÀ
 
fInôülCpbFuŒ√ss
);

363 
	g¥iv©e
:

364 
TEncRCSeq
* 
m_ícRCSeq
;

365 
TEncRCGOP
* 
	gm_ícRCGOP
;

366 
TEncRCPic
* 
	gm_ícRCPic
;

367 
	gli°
<
	gTEncRCPic
*> 
	gm_li°RCPi˘uªs
;

368 
I¡
 
	gm_RCQP
;

369 
Boﬁ
 
	gm_CpbS©uøti⁄E«bÀd
;

370 
I¡
 
	gm_˝bSèã
;

371 
UI¡
 
	gm_˝bSize
;

372 
UI¡
 
	gm_buf„rögR©e
;

	@TLibEncoder/TEncSampleAdaptiveOffset.cpp

38 
	~"TEncSam∂eAd≠tiveOff£t.h
"

39 
	~<°rög.h
>

40 
	~<°dlib.h
>

41 
	~<°dio.h
>

42 
	~<m©h.h
>

49 
ölöe
 
DoubÀ
 
	$xRoundIbdi2
(
I¡
 
bôDïth
, 
DoubÀ
 
x
)

51  ((
x
)>0Ë? (
I¡
)(((I¡)(x)+(1<<(
bôDïth
-8-1)))/(1<<(bitDepth-8))) : ((Int)(((Int)(x)-(1<<(bitDepth-8-1)))/(1<<(bitDepth-8))));

52 
	}
}

54 
ölöe
 
DoubÀ
 
	$xRoundIbdi
(
I¡
 
bôDïth
, 
DoubÀ
 
x
)

56  (
bôDïth
 > 8 ? 
	`xRoundIbdi2
(bôDïth, (
x
)Ë: ((x)>=0 ? ((
I¡
)((x)+0.5)) : ((Int)((x)-0.5)))) ;

57 
	}
}

60 
	gTEncSam∂eAd≠tiveOff£t
::
	$TEncSam∂eAd≠tiveOff£t
()

62 
m_µpcRDSbacCodî
 = 
NULL
;

63 
m_pcRDGoOnSbacCodî
 = 
NULL
;

64 
m_µpcBöCodîCABAC
 = 
NULL
;

65 
m_°©D©a
 = 
NULL
;

66 
m_¥eDBF°©D©a
 = 
NULL
;

67 
	}
}

69 
	gTEncSam∂eAd≠tiveOff£t
::~
	$TEncSam∂eAd≠tiveOff£t
()

71 
	`de°royEncD©a
();

72 
	}
}

74 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$¸óãEncD©a
(
Boﬁ
 
isPªDBFSam∂esU£d
)

78 
m_µpcRDSbacCodî
 = 
√w
 
TEncSbac
* [
NUM_SAO_CABACSTATE_LABELS
];

79 #i‡
FAST_BIT_EST


80 
m_µpcBöCodîCABAC
 = 
√w
 
TEncBöCABACCou¡î
* [
NUM_SAO_CABACSTATE_LABELS
];

82 
m_µpcBöCodîCABAC
 = 
√w
 
TEncBöCABAC
* [
NUM_SAO_CABACSTATE_LABELS
];

85 
I¡
 
cs
=0; c†< 
NUM_SAO_CABACSTATE_LABELS
; cs++)

87 
m_µpcRDSbacCodî
[
cs
] = 
√w
 
TEncSbac
;

88 #i‡
FAST_BIT_EST


89 
m_µpcBöCodîCABAC
[
cs
] = 
√w
 
TEncBöCABACCou¡î
;

91 
m_µpcBöCodîCABAC
[
cs
] = 
√w
 
TEncBöCABAC
;

93 
m_µpcRDSbacCodî
 [
cs
]->
	`öô
–
m_µpcBöCodîCABAC
 [cs] );

98 
m_°©D©a
 = 
√w
 
SAOSètD©a
**[
m_numCTUsPic
];

99 
I¡
 
i
=0; i< 
m_numCTUsPic
; i++)

101 
m_°©D©a
[
i
] = 
√w
 
SAOSètD©a
*[
MAX_NUM_COMPONENT
];

102 
I¡
 
compIdx
=0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

104 
m_°©D©a
[
i
][
compIdx
] = 
√w
 
SAOSètD©a
[
NUM_SAO_NEW_TYPES
];

107 if(
isPªDBFSam∂esU£d
)

109 
m_¥eDBF°©D©a
 = 
√w
 
SAOSètD©a
**[
m_numCTUsPic
];

110 
I¡
 
i
=0; i< 
m_numCTUsPic
; i++)

112 
m_¥eDBF°©D©a
[
i
] = 
√w
 
SAOSètD©a
*[
MAX_NUM_COMPONENT
];

113 
I¡
 
compIdx
=0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

115 
m_¥eDBF°©D©a
[
i
][
compIdx
] = 
√w
 
SAOSètD©a
[
NUM_SAO_NEW_TYPES
];

121 ::
	`mem£t
(
m_ßoDißbÀdR©e
, 0, (m_saoDisabledRate));

123 
I¡
 
ty≥Idc
=0;Åy≥Id¯< 
NUM_SAO_NEW_TYPES
;ÅypeIdc++)

125 
m_skùLöesR
[
COMPONENT_Y
 ][
ty≥Idc
]= 5;

126 
m_skùLöesR
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesR[
COMPONENT_Cr
][typeIdc]= 3;

128 
m_skùLöesB
[
COMPONENT_Y
 ][
ty≥Idc
]= 4;

129 
m_skùLöesB
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesB[
COMPONENT_Cr
][typeIdc]= 2;

131 if(
isPªDBFSam∂esU£d
)

133 
ty≥Idc
)

135 
SAO_TYPE_EO_0
:

137 
m_skùLöesR
[
COMPONENT_Y
 ][
ty≥Idc
]= 5;

138 
m_skùLöesR
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesR[
COMPONENT_Cr
][typeIdc]= 3;

140 
m_skùLöesB
[
COMPONENT_Y
 ][
ty≥Idc
]= 3;

141 
m_skùLöesB
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesB[
COMPONENT_Cr
][typeIdc]= 1;

144 
SAO_TYPE_EO_90
:

146 
m_skùLöesR
[
COMPONENT_Y
 ][
ty≥Idc
]= 4;

147 
m_skùLöesR
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesR[
COMPONENT_Cr
][typeIdc]= 2;

149 
m_skùLöesB
[
COMPONENT_Y
 ][
ty≥Idc
]= 4;

150 
m_skùLöesB
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesB[
COMPONENT_Cr
][typeIdc]= 2;

153 
SAO_TYPE_EO_135
:

154 
SAO_TYPE_EO_45
:

156 
m_skùLöesR
[
COMPONENT_Y
 ][
ty≥Idc
]= 5;

157 
m_skùLöesR
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesR[
COMPONENT_Cr
][typeIdc]= 3;

159 
m_skùLöesB
[
COMPONENT_Y
 ][
ty≥Idc
]= 4;

160 
m_skùLöesB
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesB[
COMPONENT_Cr
][typeIdc]= 2;

163 
SAO_TYPE_BO
:

165 
m_skùLöesR
[
COMPONENT_Y
 ][
ty≥Idc
]= 4;

166 
m_skùLöesR
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesR[
COMPONENT_Cr
][typeIdc]= 2;

168 
m_skùLöesB
[
COMPONENT_Y
 ][
ty≥Idc
]= 3;

169 
m_skùLöesB
[
COMPONENT_Cb
][
ty≥Idc
]m_skùLöesB[
COMPONENT_Cr
][typeIdc]= 1;

174 
	`¥ötf
("Notá supportedÅype");

175 
	`as£π
(0);

176 
	`exô
(-1);

182 
	}
}

184 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$de°royEncD©a
()

186 if(
m_µpcRDSbacCodî
 !
NULL
)

188 
I¡
 
cs
 = 0; c†< 
NUM_SAO_CABACSTATE_LABELS
; cs ++ )

190 
dñëe
 
m_µpcRDSbacCodî
[
cs
];

192 
dñëe
[] 
m_µpcRDSbacCodî
; m_µpcRDSbacCodî = 
NULL
;

195 if(
m_µpcBöCodîCABAC
 !
NULL
)

197 
I¡
 
cs
 = 0; c†< 
NUM_SAO_CABACSTATE_LABELS
; cs ++ )

199 
dñëe
 
m_µpcBöCodîCABAC
[
cs
];

201 
dñëe
[] 
m_µpcBöCodîCABAC
; m_µpcBöCodîCABAC = 
NULL
;

204 if(
m_°©D©a
 !
NULL
)

206 
I¡
 
i
=0; i< 
m_numCTUsPic
; i++)

208 
I¡
 
compIdx
=0; compIdx< 
MAX_NUM_COMPONENT
; compIdx++)

210 
dñëe
[] 
m_°©D©a
[
i
][
compIdx
];

212 
dñëe
[] 
m_°©D©a
[
i
];

214 
dñëe
[] 
m_°©D©a
; m_°©D©®
NULL
;

216 if(
m_¥eDBF°©D©a
 !
NULL
)

218 
I¡
 
i
=0; i< 
m_numCTUsPic
; i++)

220 
I¡
 
compIdx
=0; compIdx< 
MAX_NUM_COMPONENT
; compIdx++)

222 
dñëe
[] 
m_¥eDBF°©D©a
[
i
][
compIdx
];

224 
dñëe
[] 
m_¥eDBF°©D©a
[
i
];

226 
dñëe
[] 
m_¥eDBF°©D©a
; m_¥eDBF°©D©®
NULL
;

228 
	}
}

230 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$öôRDOCabacCodî
(
TEncSbac
* 
pcRDGoOnSbacCodî
, 
TComSli˚
* 
pcSli˚
)

232 
m_pcRDGoOnSbacCodî
 = 
pcRDGoOnSbacCodî
;

233 
m_pcRDGoOnSbacCodî
->
	`ª£tE¡r›y
(
pcSli˚
);

234 
m_pcRDGoOnSbacCodî
->
	`ª£tBôs
();

236 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[
SAO_CABACSTATE_PIC_INIT
]);

237 
	}
}

240 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$SAOPro˚ss
(
TComPic
* 
pPic
, 
Boﬁ
* 
¶i˚E«bÀd
, c⁄° 
DoubÀ
 *
œmbdas
, c⁄° Boﬁ 
bTe°SAODißbÀAtPi˘uªLevñ
, c⁄° DoubÀ 
ßoEncodögR©e
, c⁄° DoubÀ 
ßoEncodögR©eChroma
, c⁄° Boﬁ 
isPªDBFSam∂esU£d
 )

242 
TComPicYuv
* 
‹gYuv

pPic
->
	`gëPicYuvOrg
();

243 
TComPicYuv
* 
ªsYuv

pPic
->
	`gëPicYuvRec
();

244 
	`mem˝y
(
m_œmbda
, 
œmbdas
, (m_lambda));

245 
TComPicYuv
* 
§cYuv
 = 
m_ãmpPicYuv
;

246 
ªsYuv
->
	`c›yToPic
(
§cYuv
);

247 
§cYuv
->
	`£tB‹dîExãnsi⁄
(
Ál£
);

248 
§cYuv
->
	`exãndPicB‹dî
();

251 
	`gëSèti°ics
(
m_°©D©a
, 
‹gYuv
, 
§cYuv
, 
pPic
);

252 if(
isPªDBFSam∂esU£d
)

254 
	`addPªDBFSèti°ics
(
m_°©D©a
);

258 
	`decidePicP¨ams
(
¶i˚E«bÀd
, 
pPic
, 
ßoEncodögR©e
, 
ßoEncodögR©eChroma
);

260 
SAOBlkP¨am
* 
ªc⁄P¨ams
 = 
√w
 SAOBlkP¨am[
m_numCTUsPic
];

261 
	`decideBlkP¨ams
(
pPic
, 
¶i˚E«bÀd
, 
m_°©D©a
, 
§cYuv
, 
ªsYuv
, 
ªc⁄P¨ams
,ÖPic->
	`gëPicSym
()->
	`gëSAOBlkP¨am
(), 
bTe°SAODißbÀAtPi˘uªLevñ
, 
ßoEncodögR©e
, 
ßoEncodögR©eChroma
);

262 
dñëe
[] 
ªc⁄P¨ams
;

263 
	}
}

265 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$gëPªDBFSèti°ics
(
TComPic
* 
pPic
)

267 
	`gëSèti°ics
(
m_¥eDBF°©D©a
, 
pPic
->
	`gëPicYuvOrg
(),ÖPic->
	`gëPicYuvRec
(),ÖPic, 
åue
);

268 
	}
}

270 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$addPªDBFSèti°ics
(
SAOSètD©a
*** 
blkSèts
)

272 
I¡
 
n
=0;Ç< 
m_numCTUsPic
;Ç++)

274 
I¡
 
compIdx
=0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

276 
I¡
 
ty≥Idc
=0;Åy≥Id¯< 
NUM_SAO_NEW_TYPES
;ÅypeIdc++)

278 
blkSèts
[
n
][
compIdx
][
ty≥Idc
] +
m_¥eDBF°©D©a
[n][compIdx][typeIdc];

282 
	}
}

284 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$gëSèti°ics
(
SAOSètD©a
*** 
blkSèts
, 
TComPicYuv
* 
‹gYuv
, TComPicYuv* 
§cYuv
, 
TComPic
* 
pPic
, 
Boﬁ
 
isCÆcuœãPªDeblockSam∂es
)

286 
Boﬁ
 
isLe·Avaû
,
isRightAvaû
,
isAboveAvaû
,
isBñowAvaû
,
isAboveLe·Avaû
,
isAboveRightAvaû
,
isBñowLe·Avaû
,
isBñowRightAvaû
;

288 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

290 
I¡
 
˘uRsAddr
0; ctuRsAdd∏< 
m_numCTUsPic
; ctuRsAddr++)

292 
I¡
 
yPos
 = (
˘uRsAddr
 / 
m_numCTUInWidth
)*
m_maxCUHeight
;

293 
I¡
 
xPos
 = (
˘uRsAddr
 % 
m_numCTUInWidth
)*
m_maxCUWidth
;

294 
I¡
 
height
 = (
yPos
 + 
m_maxCUHeight
 > 
m_picHeight
)?(m_picHeight- yPos):m_maxCUHeight;

295 
I¡
 
width
 = (
xPos
 + 
m_maxCUWidth
 > 
m_picWidth
 )?(m_picWidth - xPos):m_maxCUWidth;

297 
pPic
->
	`gëPicSym
()->
	`dîiveLo›FûãrBound¨yAvaûibûôy
(
˘uRsAddr
, 
isLe·Avaû
,
isRightAvaû
,
isAboveAvaû
,
isBñowAvaû
,
isAboveLe·Avaû
,
isAboveRightAvaû
,
isBñowLe·Avaû
,
isBñowRightAvaû
);

302 
isRightAvaû
 = (
xPos
 + 
m_maxCUWidth
 < 
m_picWidth
 );

303 
isBñowAvaû
 = (
yPos
 + 
m_maxCUHeight
 < 
m_picHeight
);

304 
isBñowRightAvaû
 = (
isRightAvaû
 && 
isBñowAvaû
);

305 
isBñowLe·Avaû
 = ((
xPos
 > 0Ë&& (
isBñowAvaû
));

306 
isAboveRightAvaû
 = ((
yPos
 > 0Ë&& (
isRightAvaû
));

308 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

310 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
compIdx
);

312 c⁄° 
UI¡
 
comp⁄ítSˇÀX
 = 
	`gëComp⁄ítSˇÀX
(
comp⁄ít
, 
pPic
->
	`gëChromaF‹m©
());

313 c⁄° 
UI¡
 
comp⁄ítSˇÀY
 = 
	`gëComp⁄ítSˇÀY
(
comp⁄ít
, 
pPic
->
	`gëChromaF‹m©
());

315 
I¡
 
§cSåide
 = 
§cYuv
->
	`gëSåide
(
comp⁄ít
);

316 
Pñ
* 
§cBlk
 = 
§cYuv
->
	`gëAddr
(
comp⁄ít
Ë+ ((
yPos
 >> 
comp⁄ítSˇÀY
Ë* 
§cSåide
Ë+ (
xPos
 >> 
comp⁄ítSˇÀX
);

318 
I¡
 
‹gSåide
 = 
‹gYuv
->
	`gëSåide
(
comp⁄ít
);

319 
Pñ
* 
‹gBlk
 = 
‹gYuv
->
	`gëAddr
(
comp⁄ít
Ë+ ((
yPos
 >> 
comp⁄ítSˇÀY
Ë* 
‹gSåide
Ë+ (
xPos
 >> 
comp⁄ítSˇÀX
);

321 
	`gëBlkSèts
(
comp⁄ít
, 
pPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïth
(
	`toCh™√lTy≥
(comp⁄ít)), 
blkSèts
[
˘uRsAddr
][component]

322 , 
§cBlk
, 
‹gBlk
, 
§cSåide
, 
‹gSåide
, (
width
 >> 
comp⁄ítSˇÀX
), (
height
 >> 
comp⁄ítSˇÀY
)

323 , 
isLe·Avaû
, 
isRightAvaû
, 
isAboveAvaû
, 
isBñowAvaû
, 
isAboveLe·Avaû
, 
isAboveRightAvaû


324 , 
isCÆcuœãPªDeblockSam∂es


329 
	}
}

331 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$ª£tEncodîDecisi⁄s
()

333 
I¡
 
compIdx
 = 0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

335 
I¡
 
ãmpLayî
 = 1;ÅempLayî < 
MAX_TLAYER
;ÅempLayer++)

337 
m_ßoDißbÀdR©e
[
compIdx
][
ãmpLayî
] = 0.0;

340 
	}
}

342 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$decidePicP¨ams
(
Boﬁ
* 
¶i˚E«bÀd
, c⁄° 
TComPic
* 
pic
, c⁄° 
DoubÀ
 
ßoEncodögR©e
, c⁄° DoubÀ 
ßoEncodögR©eChroma
)

344 c⁄° 
I¡
 
picTempLayî
 = 
pic
->
	`gëSli˚
(0)->
	`gëDïth
();

347 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

348 
I¡
 
compIdx
 = 0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

350 
¶i˚E«bÀd
[
compIdx
] = 
Ál£
;

353 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

356 
¶i˚E«bÀd
[
compIdx
] = 
åue
;

358 i‡(
ßoEncodögR©e
>0.0)

360 i‡(
ßoEncodögR©eChroma
>0.0)

363 if–(
picTempLayî
 > 0)

364 && (
m_ßoDißbÀdR©e
[
compIdx
][
picTempLayî
-1] > ((compIdx==
COMPONENT_Y
Ë? 
ßoEncodögR©e
 : 
ßoEncodögR©eChroma
)) )

366 
¶i˚E«bÀd
[
compIdx
] = 
Ál£
;

372 if–(
picTempLayî
 > 0)

373 && (
m_ßoDißbÀdR©e
[
COMPONENT_Y
][0] > 
ßoEncodögR©e
) )

375 
¶i˚E«bÀd
[
compIdx
] = 
Ál£
;

380 
	}
}

382 
I¡64
 
	gTEncSam∂eAd≠tiveOff£t
::
	$gëDi°‹ti⁄
(c⁄° 
I¡
 
ch™√lBôDïth
, I¡ 
ty≥Idc
, I¡ 
ty≥AuxInfo
, I¡* 
övQu™tOff£t
, 
SAOSètD©a
& 
°©D©a
)

384 
I¡64
 
di°
 = 0;

385 
I¡
 
shi·
 = 2 * 
	`DISTORTION_PRECISION_ADJUSTMENT
(
ch™√lBôDïth
 - 8);

387 
ty≥Idc
)

389 
SAO_TYPE_EO_0
:

390 
SAO_TYPE_EO_90
:

391 
SAO_TYPE_EO_135
:

392 
SAO_TYPE_EO_45
:

394 
I¡
 
off£tIdx
=0; off£tIdx<
NUM_SAO_EO_CLASSES
; offsetIdx++)

396 
di°
 +
	`e°SaoDi°
–
°©D©a
.
cou¡
[
off£tIdx
], 
övQu™tOff£t
[off£tIdx], sètD©a.
diff
[off£tIdx], 
shi·
);

400 
SAO_TYPE_BO
:

402 
I¡
 
off£tIdx
=
ty≥AuxInfo
; offsetIdx<typeAuxInfo+4; offsetIdx++)

404 
I¡
 
b™dIdx
 = 
off£tIdx
 % 
NUM_SAO_BO_CLASSES
 ;

405 
di°
 +
	`e°SaoDi°
–
°©D©a
.
cou¡
[
b™dIdx
], 
övQu™tOff£t
[b™dIdx], sètD©a.
diff
[b™dIdx], 
shi·
);

411 
	`¥ötf
("Notá supportedÅype");

412 
	`as£π
(0);

413 
	`exô
(-1);

417  
di°
;

418 
	}
}

420 
ölöe
 
I¡64
 
	gTEncSam∂eAd≠tiveOff£t
::
	$e°SaoDi°
(
I¡64
 
cou¡
, I¡64 
off£t
, I¡64 
diffSum
, 
I¡
 
shi·
)

422  (–
cou¡
*
off£t
*off£t-
diffSum
*off£t*2 ) >> 
shi·
);

423 
	}
}

426 
ölöe
 
I¡
 
	gTEncSam∂eAd≠tiveOff£t
::
	$e°IãrOff£t
(
I¡
 
ty≥Idx
, 
DoubÀ
 
œmbda
, I¡ 
off£tI≈ut
, 
I¡64
 
cou¡
, I¡64 
diffSum
, I¡ 
shi·
, I¡ 
bôIn¸ó£
, I¡64& 
be°Di°
, DoubÀ& 
be°Co°
, I¡ 
off£tTh
 )

428 
I¡
 
ôîOff£t
, 
ãmpOff£t
;

429 
I¡64
 
ãmpDi°
, 
ãmpR©e
;

430 
DoubÀ
 
ãmpCo°
, 
ãmpMöCo°
;

431 
I¡
 
off£tOuçut
 = 0;

432 
ôîOff£t
 = 
off£tI≈ut
;

434 
ãmpMöCo°
 = 
œmbda
;

435 
ôîOff£t
 != 0)

438 
ãmpR©e
 = (
ty≥Idx
 =
SAO_TYPE_BO
Ë? (
	`abs
((
I¡
)
ôîOff£t
)+2) : (abs((Int)iterOffset)+1);

439 i‡(
	`abs
((
I¡
)
ôîOff£t
)==
off£tTh
)

441 
ãmpR©e
 --;

444 
ãmpOff£t
 = 
ôîOff£t
 << 
bôIn¸ó£
;

445 
ãmpDi°
 = 
	`e°SaoDi°
–
cou¡
, 
ãmpOff£t
, 
diffSum
, 
shi·
);

446 
ãmpCo°
 = ((
DoubÀ
)
ãmpDi°
 + 
œmbda
 * (DoubÀË
ãmpR©e
);

447 if(
ãmpCo°
 < 
ãmpMöCo°
)

449 
ãmpMöCo°
 = 
ãmpCo°
;

450 
off£tOuçut
 = 
ôîOff£t
;

451 
be°Di°
 = 
ãmpDi°
;

452 
be°Co°
 = 
ãmpCo°
;

454 
ôîOff£t
 = (iterOffset > 0) ? (iterOffset-1):(iterOffset+1);

456  
off£tOuçut
;

457 
	}
}

459 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$dîiveOff£ts
(
Comp⁄ítID
 
compIdx
, c⁄° 
I¡
 
ch™√lBôDïth
, I¡ 
ty≥Idc
, 
SAOSètD©a
& 
°©D©a
, I¡* 
qu™tOff£ts
, I¡& 
ty≥AuxInfo
)

461 
I¡
 
bôDïth
 = 
ch™√lBôDïth
;

462 
I¡
 
shi·
 = 2 * 
	`DISTORTION_PRECISION_ADJUSTMENT
(
bôDïth
-8);

463 
I¡
 
off£tTh
 = 
TComSam∂eAd≠tiveOff£t
::
	`gëMaxOff£tQVÆ
(
ch™√lBôDïth
);

465 ::
	`mem£t
(
qu™tOff£ts
, 0, (
I¡
)*
MAX_NUM_SAO_CLASSES
);

468 
I¡
 
numCœs£s
 = (
ty≥Idc
 =
SAO_TYPE_BO
)?((I¡)
NUM_SAO_BO_CLASSES
):((I¡)
NUM_SAO_EO_CLASSES
);

469 
I¡
 
˛assIdx
=0; cœssIdx< 
numCœs£s
; classIdx++)

471 if–(
ty≥Idc
 !
SAO_TYPE_BO
Ë&& (
˛assIdx
==
SAO_CLASS_EO_PLAIN
) )

476 if(
°©D©a
.
cou¡
[
˛assIdx
] == 0)

481 
qu™tOff£ts
[
˛assIdx
] = (
I¡
Ë
	`xRoundIbdi
(
bôDïth
, (
DoubÀ
)–
°©D©a
.
diff
[classIdx]<<(bitDepth-8))

483 (
DoubÀ
)–
°©D©a
.
cou¡
[
˛assIdx
]<< 
m_off£tSãpLog2
[
compIdx
])

485 
qu™tOff£ts
[
˛assIdx
] = 
	`Clù3
(-
off£tTh
, offsetTh, quantOffsets[classIdx]);

489 
ty≥Idc
)

491 
SAO_TYPE_EO_0
:

492 
SAO_TYPE_EO_90
:

493 
SAO_TYPE_EO_135
:

494 
SAO_TYPE_EO_45
:

496 
I¡64
 
˛assDi°
;

497 
DoubÀ
 
˛assCo°
;

498 
I¡
 
˛assIdx
=0; cœssIdx<
NUM_SAO_EO_CLASSES
; classIdx++)

500 if(
˛assIdx
==
SAO_CLASS_EO_FULL_VALLEY
 && 
qu™tOff£ts
[classIdx] < 0)

502 
qu™tOff£ts
[
˛assIdx
] =0;

504 if(
˛assIdx
==
SAO_CLASS_EO_HALF_VALLEY
 && 
qu™tOff£ts
[classIdx] < 0)

506 
qu™tOff£ts
[
˛assIdx
] =0;

508 if(
˛assIdx
==
SAO_CLASS_EO_HALF_PEAK
 && 
qu™tOff£ts
[classIdx] > 0)

510 
qu™tOff£ts
[
˛assIdx
] =0;

512 if(
˛assIdx
==
SAO_CLASS_EO_FULL_PEAK
 && 
qu™tOff£ts
[classIdx] > 0)

514 
qu™tOff£ts
[
˛assIdx
] =0;

517 if–
qu™tOff£ts
[
˛assIdx
] != 0 )

519 
qu™tOff£ts
[
˛assIdx
] = 
	`e°IãrOff£t
–
ty≥Idc
, 
m_œmbda
[
compIdx
], qu™tOff£ts[˛assIdx], 
°©D©a
.
cou¡
[˛assIdx], sètD©a.
diff
[˛assIdx], 
shi·
, 
m_off£tSãpLog2
[compIdx], 
˛assDi°
 , 
˛assCo°
 , 
off£tTh
 );

523 
ty≥AuxInfo
 =0;

526 
SAO_TYPE_BO
:

528 
I¡64
 
di°BOCœs£s
[
NUM_SAO_BO_CLASSES
];

529 
DoubÀ
 
co°BOCœs£s
[
NUM_SAO_BO_CLASSES
];

530 ::
	`mem£t
(
di°BOCœs£s
, 0, (
I¡64
)*
NUM_SAO_BO_CLASSES
);

531 
I¡
 
˛assIdx
=0; cœssIdx< 
NUM_SAO_BO_CLASSES
; classIdx++)

533 
co°BOCœs£s
[
˛assIdx
]
m_œmbda
[
compIdx
];

534 if–
qu™tOff£ts
[
˛assIdx
] != 0 )

536 
qu™tOff£ts
[
˛assIdx
] = 
	`e°IãrOff£t
–
ty≥Idc
, 
m_œmbda
[
compIdx
], qu™tOff£ts[˛assIdx], 
°©D©a
.
cou¡
[˛assIdx], sètD©a.
diff
[˛assIdx], 
shi·
, 
m_off£tSãpLog2
[compIdx], 
di°BOCœs£s
[˛assIdx], 
co°BOCœs£s
[˛assIdx], 
off£tTh
 );

541 
DoubÀ
 
möCo°
 = 
MAX_DOUBLE
, 
co°
;

542 
I¡
 
b™d
=0; b™d< 
NUM_SAO_BO_CLASSES
- 4+ 1; band++)

544 
co°
 = 
co°BOCœs£s
[
b™d
 ];

545 
co°
 +
co°BOCœs£s
[
b™d
+1];

546 
co°
 +
co°BOCœs£s
[
b™d
+2];

547 
co°
 +
co°BOCœs£s
[
b™d
+3];

549 if(
co°
 < 
möCo°
)

551 
möCo°
 = 
co°
;

552 
ty≥AuxInfo
 = 
b™d
;

556 
I¡
 
˛órQu™tOff£t
[
NUM_SAO_BO_CLASSES
];

557 ::
	`mem£t
(
˛órQu™tOff£t
, 0, (
I¡
)*
NUM_SAO_BO_CLASSES
);

558 
I¡
 
i
=0; i< 4; i++)

560 
I¡
 
b™d
 = (
ty≥AuxInfo
+
i
)%
NUM_SAO_BO_CLASSES
;

561 
˛órQu™tOff£t
[
b™d
] = 
qu™tOff£ts
[band];

563 ::
	`mem˝y
(
qu™tOff£ts
, 
˛órQu™tOff£t
, (
I¡
)*
NUM_SAO_BO_CLASSES
);

568 
	`¥ötf
("Notá supportedÅype");

569 
	`as£π
(0);

570 
	`exô
(-1);

576 
	}
}

578 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$dîiveModeNewRDO
(c⁄° 
BôDïths
 &
bôDïths
, 
I¡
 
˘uRsAddr
, 
SAOBlkP¨am
* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
], 
Boﬁ
* 
¶i˚E«bÀd
, 
SAOSètD©a
*** 
blkSèts
, SAOBlkP¨am& 
modeP¨am
, 
DoubÀ
& 
modeN‹mCo°
, 
TEncSbac
** 
ˇbacCodîRDO
, I¡ 
öCabacLabñ
)

580 
DoubÀ
 
möCo°
, 
co°
;

581 
UI¡
 
¥eviousWrôãnBôs
;

582 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

584 
I¡64
 
di°
[
MAX_NUM_COMPONENT
], 
modeDi°
[MAX_NUM_COMPONENT];

585 
SAOOff£t
 
ã°Off£t
[
MAX_NUM_COMPONENT
];

586 
I¡
 
övQu™tOff£t
[
MAX_NUM_SAO_CLASSES
];

587 
I¡
 
comp
=0; com∞< 
MAX_NUM_COMPONENT
; comp++)

589 
modeDi°
[
comp
] = 0;

593 
modeP¨am
[
COMPONENT_Y
].
modeIdc
 = 
SAO_MODE_OFF
;

594 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
ˇbacCodîRDO
[
öCabacLabñ
]);

595 
m_pcRDGoOnSbacCodî
->
	`codeSAOBlkP¨am
(
modeP¨am
, 
bôDïths
, 
¶i˚E«bÀd
, (
mîgeLi°
[
SAO_MERGE_LEFT
]!
NULL
), (mîgeLi°[
SAO_MERGE_ABOVE
]!NULL), 
åue
);

596 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_MID
]);

600 c⁄° 
Comp⁄ítID
 
compIdx
 = 
COMPONENT_Y
;

602 
modeP¨am
[
compIdx
].
modeIdc
 = 
SAO_MODE_OFF
;

603 
m_pcRDGoOnSbacCodî
->
	`ª£tBôs
();

604 
m_pcRDGoOnSbacCodî
->
	`codeSAOOff£tP¨am
(
compIdx
, 
modeP¨am
[compIdx], 
¶i˚E«bÀd
[compIdx], 
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_LUMA
]);

605 
modeDi°
[
compIdx
] = 0;

606 
möCo°

m_œmbda
[
compIdx
]*((
DoubÀ
)
m_pcRDGoOnSbacCodî
->
	`gëNumbîOfWrôãnBôs
());

607 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_TEMP
]);

608 if(
¶i˚E«bÀd
[
compIdx
])

610 
I¡
 
ty≥Idc
=0;Åy≥Idc< 
NUM_SAO_NEW_TYPES
;ÅypeIdc++)

612 
ã°Off£t
[
compIdx
].
modeIdc
 = 
SAO_MODE_NEW
;

613 
ã°Off£t
[
compIdx
].
ty≥Idc
 =ÅypeIdc;

616 
	`dîiveOff£ts
(
compIdx
, 
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_LUMA
], 
ty≥Idc
, 
blkSèts
[
˘uRsAddr
][compIdx][ty≥Idc], 
ã°Off£t
[compIdx].
off£t
,Åe°Off£t[compIdx].
ty≥AuxInfo
);

619 
	`övîtQu™tOff£ts
(
compIdx
, 
ty≥Idc
, 
ã°Off£t
[compIdx].
ty≥AuxInfo
, 
övQu™tOff£t
,Åe°Off£t[compIdx].
off£t
);

622 
di°
[
compIdx
] = 
	`gëDi°‹ti⁄
(
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_LUMA
], 
ã°Off£t
[compIdx].
ty≥Idc
,Åe°Off£t[compIdx].
ty≥AuxInfo
, 
övQu™tOff£t
, 
blkSèts
[
˘uRsAddr
][compIdx][typeIdc]);

625 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_MID
]);

626 
m_pcRDGoOnSbacCodî
->
	`ª£tBôs
();

627 
m_pcRDGoOnSbacCodî
->
	`codeSAOOff£tP¨am
(
compIdx
, 
ã°Off£t
[compIdx], 
¶i˚E«bÀd
[compIdx], 
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_LUMA
]);

628 
I¡
 
øã
 = 
m_pcRDGoOnSbacCodî
->
	`gëNumbîOfWrôãnBôs
();

629 
co°
 = (
DoubÀ
)
di°
[
compIdx
] + 
m_œmbda
[compIdx]*((DoubÀ)
øã
);

630 if(
co°
 < 
möCo°
)

632 
möCo°
 = 
co°
;

633 
modeDi°
[
compIdx
] = 
di°
[compIdx];

634 
modeP¨am
[
compIdx
]
ã°Off£t
[compIdx];

635 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_TEMP
]);

639 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_TEMP
]);

640 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_MID
]);

645 
co°
 = 0;

646 
¥eviousWrôãnBôs
 = 0;

647 
m_pcRDGoOnSbacCodî
->
	`ª£tBôs
();

648 
UI¡
 
comp⁄ítIndex
 = 
COMPONENT_Cb
; comp⁄ítIndex < 
numbîOfComp⁄íts
; componentIndex++)

650 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

652 
modeP¨am
[
comp⁄ít
].
modeIdc
 = 
SAO_MODE_OFF
;

653 
modeDi°
 [
comp⁄ít
] = 0;

654 
m_pcRDGoOnSbacCodî
->
	`codeSAOOff£tP¨am
(
comp⁄ít
, 
modeP¨am
[comp⁄ít], 
¶i˚E«bÀd
[comp⁄ít], 
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_CHROMA
]);

656 c⁄° 
UI¡
 
cuºítWrôãnBôs
 = 
m_pcRDGoOnSbacCodî
->
	`gëNumbîOfWrôãnBôs
();

657 
co°
 +
m_œmbda
[
comp⁄ít
] * (
cuºítWrôãnBôs
 - 
¥eviousWrôãnBôs
);

658 
¥eviousWrôãnBôs
 = 
cuºítWrôãnBôs
;

661 
möCo°
 = 
co°
;

665 
I¡
 
ty≥Idc
=0;Åy≥Idc< 
NUM_SAO_NEW_TYPES
;ÅypeIdc++)

667 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_MID
]);

668 
m_pcRDGoOnSbacCodî
->
	`ª£tBôs
();

669 
¥eviousWrôãnBôs
 = 0;

670 
co°
 = 0;

672 
UI¡
 
comp⁄ítIndex
 = 
COMPONENT_Cb
; comp⁄ítIndex < 
numbîOfComp⁄íts
; componentIndex++)

674 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

675 if(!
¶i˚E«bÀd
[
comp⁄ít
])

677 
ã°Off£t
[
comp⁄ít
].
modeIdc
 = 
SAO_MODE_OFF
;

678 
di°
[
comp⁄ít
]= 0;

681 
ã°Off£t
[
comp⁄ít
].
modeIdc
 = 
SAO_MODE_NEW
;

682 
ã°Off£t
[
comp⁄ít
].
ty≥Idc
 =ÅypeIdc;

685 
	`dîiveOff£ts
(
comp⁄ít
, 
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_CHROMA
], 
ty≥Idc
, 
blkSèts
[
˘uRsAddr
][comp⁄ít][ty≥Idc], 
ã°Off£t
[comp⁄ít].
off£t
,Åe°Off£t[comp⁄ít].
ty≥AuxInfo
);

686 
	`övîtQu™tOff£ts
(
comp⁄ít
, 
ty≥Idc
, 
ã°Off£t
[comp⁄ít].
ty≥AuxInfo
, 
övQu™tOff£t
,Åe°Off£t[comp⁄ít].
off£t
);

687 
di°
[
comp⁄ít
] = 
	`gëDi°‹ti⁄
(
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_CHROMA
], 
ty≥Idc
, 
ã°Off£t
[comp⁄ít].
ty≥AuxInfo
, 
övQu™tOff£t
, 
blkSèts
[
˘uRsAddr
][component][typeIdc]);

689 
m_pcRDGoOnSbacCodî
->
	`codeSAOOff£tP¨am
(
comp⁄ít
, 
ã°Off£t
[comp⁄ít], 
¶i˚E«bÀd
[comp⁄ít], 
bôDïths
.
ªc⁄
[
CHANNEL_TYPE_CHROMA
]);

691 c⁄° 
UI¡
 
cuºítWrôãnBôs
 = 
m_pcRDGoOnSbacCodî
->
	`gëNumbîOfWrôãnBôs
();

692 
co°
 +
di°
[
comp⁄ít
] + (
m_œmbda
[comp⁄ít] * (
cuºítWrôãnBôs
 - 
¥eviousWrôãnBôs
));

693 
¥eviousWrôãnBôs
 = 
cuºítWrôãnBôs
;

696 if(
co°
 < 
möCo°
)

698 
möCo°
 = 
co°
;

699 
UI¡
 
comp⁄ítIndex
 = 
COMPONENT_Cb
; comp⁄ítIndex < 
numbîOfComp⁄íts
; componentIndex++)

701 
modeDi°
[
comp⁄ítIndex
] = 
di°
[componentIndex];

702 
modeP¨am
[
comp⁄ítIndex
] = 
ã°Off£t
[componentIndex];

709 
modeN‹mCo°
 = 0;

710 
UI¡
 
comp⁄ítIndex
 = 
COMPONENT_Y
; comp⁄ítIndex < 
numbîOfComp⁄íts
; componentIndex++)

712 
modeN‹mCo°
 +(
DoubÀ
)
modeDi°
[
comp⁄ítIndex
] / 
m_œmbda
[componentIndex];

715 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
ˇbacCodîRDO
[
öCabacLabñ
]);

716 
m_pcRDGoOnSbacCodî
->
	`ª£tBôs
();

717 
m_pcRDGoOnSbacCodî
->
	`codeSAOBlkP¨am
(
modeP¨am
, 
bôDïths
, 
¶i˚E«bÀd
, (
mîgeLi°
[
SAO_MERGE_LEFT
]!
NULL
), (mîgeLi°[
SAO_MERGE_ABOVE
]!NULL), 
Ál£
);

718 
modeN‹mCo°
 +(
DoubÀ
)
m_pcRDGoOnSbacCodî
->
	`gëNumbîOfWrôãnBôs
();

719 
	}
}

721 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$dîiveModeMîgeRDO
(c⁄° 
BôDïths
 &
bôDïths
, 
I¡
 
˘uRsAddr
, 
SAOBlkP¨am
* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
], 
Boﬁ
* 
¶i˚E«bÀd
, 
SAOSètD©a
*** 
blkSèts
, SAOBlkP¨am& 
modeP¨am
, 
DoubÀ
& 
modeN‹mCo°
, 
TEncSbac
** 
ˇbacCodîRDO
, I¡ 
öCabacLabñ
)

723 
modeN‹mCo°
 = 
MAX_DOUBLE
;

725 
DoubÀ
 
co°
;

726 
SAOBlkP¨am
 
ã°BlkP¨am
;

727 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

729 
I¡
 
mîgeTy≥
=0; mîgeTy≥< 
NUM_SAO_MERGE_TYPES
; mergeType++)

731 if(
mîgeLi°
[
mîgeTy≥
] =
NULL
)

736 
ã°BlkP¨am
 = *(
mîgeLi°
[
mîgeTy≥
]);

738 
DoubÀ
 
n‹mDi°
=0;

739 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

741 
ã°BlkP¨am
[
compIdx
].
modeIdc
 = 
SAO_MODE_MERGE
;

742 
ã°BlkP¨am
[
compIdx
].
ty≥Idc
 = 
mîgeTy≥
;

744 
SAOOff£t
& 
mîgedOff£tP¨am
 = (*(
mîgeLi°
[
mîgeTy≥
]))[
compIdx
];

746 if–
mîgedOff£tP¨am
.
modeIdc
 !
SAO_MODE_OFF
)

749 
n‹mDi°
 +(((
DoubÀ
)
	`gëDi°‹ti⁄
(
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(
	`Comp⁄ítID
(
compIdx
))], 
mîgedOff£tP¨am
.
ty≥Idc
, mîgedOff£tP¨am.
ty≥AuxInfo
, mîgedOff£tP¨am.
off£t
, 
blkSèts
[
˘uRsAddr
][compIdx][mergedOffsetParam.typeIdc]))

750 /
m_œmbda
[
compIdx
]

757 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
ˇbacCodîRDO
[
öCabacLabñ
]);

758 
m_pcRDGoOnSbacCodî
->
	`ª£tBôs
();

759 
m_pcRDGoOnSbacCodî
->
	`codeSAOBlkP¨am
(
ã°BlkP¨am
, 
bôDïths
, 
¶i˚E«bÀd
, (
mîgeLi°
[
SAO_MERGE_LEFT
]!
NULL
), (mîgeLi°[
SAO_MERGE_ABOVE
]!NULL), 
Ál£
);

760 
I¡
 
øã
 = 
m_pcRDGoOnSbacCodî
->
	`gëNumbîOfWrôãnBôs
();

762 
co°
 = 
n‹mDi°
+(
DoubÀ
)
øã
;

764 if(
co°
 < 
modeN‹mCo°
)

766 
modeN‹mCo°
 = 
co°
;

767 
modeP¨am
 = 
ã°BlkP¨am
;

768 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_TEMP
]);

772 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
ˇbacCodîRDO
[
SAO_CABACSTATE_BLK_TEMP
]);

773 
	}
}

775 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$decideBlkP¨ams
(
TComPic
* 
pic
, 
Boﬁ
* 
¶i˚E«bÀd
, 
SAOSètD©a
*** 
blkSèts
, 
TComPicYuv
* 
§cYuv
, TComPicYuv* 
ªsYuv
,

776 
SAOBlkP¨am
* 
ªc⁄P¨ams
, SAOBlkP¨am* 
codedP¨ams
, c⁄° 
Boﬁ
 
bTe°SAODißbÀAtPi˘uªLevñ
,

777 c⁄° 
DoubÀ
 
ßoEncodögR©e
, c⁄° DoubÀ 
ßoEncodögR©eChroma
)

779 
Boﬁ
 
ÆlBlksDißbÀd
 = 
åue
;

780 c⁄° 
I¡
 
numbîOfComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
);

781 
I¡
 
compId
 = 
COMPONENT_Y
; compId < 
numbîOfComp⁄íts
; compId++)

783 i‡(
¶i˚E«bÀd
[
compId
])

785 
ÆlBlksDißbÀd
 = 
Ál£
;

789 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[ 
SAO_CABACSTATE_PIC_INIT
 ]);

791 
SAOBlkP¨am
 
modeP¨am
;

792 
DoubÀ
 
möCo°
, 
modeCo°
;

795 
DoubÀ
 
tŸÆCo°
 = 0;

797 
I¡
 
˘uRsAddr
=0; ctuRsAddr< 
m_numCTUsPic
; ctuRsAddr++)

799 if(
ÆlBlksDißbÀd
)

801 
codedP¨ams
[
˘uRsAddr
].
	`ª£t
();

805 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
m_µpcRDSbacCodî
[ 
SAO_CABACSTATE_BLK_CUR
 ]);

808 
SAOBlkP¨am
* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
] = { 
NULL
 };

809 
	`gëMîgeLi°
(
pic
, 
˘uRsAddr
, 
ªc⁄P¨ams
, 
mîgeLi°
);

811 
möCo°
 = 
MAX_DOUBLE
;

812 
I¡
 
mode
=0; modê< 
NUM_SAO_MODES
; mode++)

814 
mode
)

816 
SAO_MODE_OFF
:

821 
SAO_MODE_NEW
:

823 
	`dîiveModeNewRDO
(
pic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïths
(), 
˘uRsAddr
, 
mîgeLi°
, 
¶i˚E«bÀd
, 
blkSèts
, 
modeP¨am
, 
modeCo°
, 
m_µpcRDSbacCodî
, 
SAO_CABACSTATE_BLK_CUR
);

827 
SAO_MODE_MERGE
:

829 
	`dîiveModeMîgeRDO
(
pic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïths
(), 
˘uRsAddr
, 
mîgeLi°
, 
¶i˚E«bÀd
, 
blkSèts
 , 
modeP¨am
, 
modeCo°
, 
m_µpcRDSbacCodî
, 
SAO_CABACSTATE_BLK_CUR
);

834 
	`¥ötf
("Notá supported SAO mode\n");

835 
	`as£π
(0);

836 
	`exô
(-1);

840 if(
modeCo°
 < 
möCo°
)

842 
möCo°
 = 
modeCo°
;

843 
codedP¨ams
[
˘uRsAddr
] = 
modeP¨am
;

844 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
m_µpcRDSbacCodî
[ 
SAO_CABACSTATE_BLK_NEXT
 ]);

848 
tŸÆCo°
 +
möCo°
;

850 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[ 
SAO_CABACSTATE_BLK_NEXT
 ]);

853 
ªc⁄P¨ams
[
˘uRsAddr
] = 
codedP¨ams
[ctuRsAddr];

854 
	`ªc⁄°ru˘BlkSAOP¨am
(
ªc⁄P¨ams
[
˘uRsAddr
], 
mîgeLi°
);

855 
	`off£tCTU
(
˘uRsAddr
, 
§cYuv
, 
ªsYuv
, 
ªc⁄P¨ams
[˘uRsAddr], 
pic
);

858 i‡(!
ÆlBlksDißbÀd
 && (
tŸÆCo°
 >0Ë&& 
bTe°SAODißbÀAtPi˘uªLevñ
)

860 
I¡
 
˘uRsAddr
 = 0; ctuRsAdd∏< 
m_numCTUsPic
; ctuRsAddr++)

862 
codedP¨ams
[
˘uRsAddr
].
	`ª£t
();

865 
UI¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
MAX_NUM_COMPONENT
; componentIndex++)

867 
¶i˚E«bÀd
[
comp⁄ítIndex
] = 
Ál£
;

870 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[ 
SAO_CABACSTATE_PIC_INIT
 ]);

873 i‡(
ßoEncodögR©e
 > 0.0)

875 
I¡
 
picTempLayî
 = 
pic
->
	`gëSli˚
(0)->
	`gëDïth
();

876 
I¡
 
numCtusF‹SAOOff
[
MAX_NUM_COMPONENT
];

878 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

880 
numCtusF‹SAOOff
[
compIdx
] = 0;

881 
I¡
 
˘uRsAddr
=0; ctuRsAddr< 
m_numCTUsPic
; ctuRsAddr++)

883 if–
ªc⁄P¨ams
[
˘uRsAddr
][
compIdx
].
modeIdc
 =
SAO_MODE_OFF
)

885 
numCtusF‹SAOOff
[
compIdx
]++;

889 i‡(
ßoEncodögR©eChroma
 > 0.0)

891 
I¡
 
compIdx
 = 0; compIdx < 
numbîOfComp⁄íts
; compIdx++)

893 
m_ßoDißbÀdR©e
[
compIdx
][
picTempLayî
] = (
DoubÀ
)
numCtusF‹SAOOff
[compIdx]/(DoubÀ)
m_numCTUsPic
;

896 i‡(
picTempLayî
 == 0)

898 
m_ßoDißbÀdR©e
[
COMPONENT_Y
][0] = (
DoubÀ
)(
numCtusF‹SAOOff
[COMPONENT_Y]+numCtusF‹SAOOff[
COMPONENT_Cb
]+numCtusF‹SAOOff[
COMPONENT_Cr
])/(DoubÀ)(
m_numCTUsPic
*3);

901 
	}
}

904 
Void
 
	gTEncSam∂eAd≠tiveOff£t
::
	$gëBlkSèts
(c⁄° 
Comp⁄ítID
 
compIdx
, c⁄° 
I¡
 
ch™√lBôDïth
, 
SAOSètD©a
* 
°©sD©aTy≥s


905 , 
Pñ
* 
§cBlk
, Pñ* 
‹gBlk
, 
I¡
 
§cSåide
, I¡ 
‹gSåide
, I¡ 
width
, I¡ 
height


906 , 
Boﬁ
 
isLe·Avaû
, Boﬁ 
isRightAvaû
, Boﬁ 
isAboveAvaû
, Boﬁ 
isBñowAvaû
, Boﬁ 
isAboveLe·Avaû
, Boﬁ 
isAboveRightAvaû


907 , 
Boﬁ
 
isCÆcuœãPªDeblockSam∂es


910 if(
m_löeBufWidth
 !
m_maxCUWidth
)

912 
m_löeBufWidth
 = 
m_maxCUWidth
;

914 i‡(
m_signLöeBuf1
)

916 
dñëe
[] 
m_signLöeBuf1
;

917 
m_signLöeBuf1
 = 
NULL
;

919 
m_signLöeBuf1
 = 
√w
 
SCh¨
[
m_löeBufWidth
+1];

921 i‡(
m_signLöeBuf2
)

923 
dñëe
[] 
m_signLöeBuf2
;

924 
m_signLöeBuf2
 = 
NULL
;

926 
m_signLöeBuf2
 = 
√w
 
SCh¨
[
m_löeBufWidth
+1];

929 
I¡
 
x
,
y
, 
°¨tX
, 
°¨tY
, 
ídX
, 
ídY
, 
edgeTy≥
, 
fú°LöeSèπX
, 
fú°LöeEndX
;

930 
SCh¨
 
signLe·
, 
signRight
, 
signDown
;

931 
I¡64
 *
diff
, *
cou¡
;

932 
Pñ
 *
§cLöe
, *
‹gLöe
;

933 
I¡
* 
skùLöesR
 = 
m_skùLöesR
[
compIdx
];

934 
I¡
* 
skùLöesB
 = 
m_skùLöesB
[
compIdx
];

936 
I¡
 
ty≥Idx
=0;Åy≥Idx< 
NUM_SAO_NEW_TYPES
;ÅypeIdx++)

938 
SAOSètD©a
& 
°©sD©a

°©sD©aTy≥s
[
ty≥Idx
];

939 
°©sD©a
.
	`ª£t
();

941 
§cLöe
 = 
§cBlk
;

942 
‹gLöe
 = 
‹gBlk
;

943 
diff
 = 
°©sD©a
.diff;

944 
cou¡
 = 
°©sD©a
.count;

945 
ty≥Idx
)

947 
SAO_TYPE_EO_0
:

949 
diff
 +=2;

950 
cou¡
+=2;

951 
ídY
 = (
isBñowAvaû
Ë? (
height
 - 
skùLöesB
[
ty≥Idx
]) : height;

952 
°¨tX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isLe·Avaû
 ? 0 : 1)

953 : (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : (width - 1))

955 
ídX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : (width - 1))

956 : (
isRightAvaû
 ? 
width
 : (width - 1))

958 
y
=0; y<
ídY
; y++)

960 
signLe·
 = (
SCh¨
)
	`sgn
(
§cLöe
[
°¨tX
] - srcLine[startX-1]);

961 
x
=
°¨tX
; x<
ídX
; x++)

963 
signRight
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - srcLine[x+1]);

964 
edgeTy≥
 = 
signRight
 + 
signLe·
;

965 
signLe·
 = -
signRight
;

967 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

968 
cou¡
[
edgeTy≥
] ++;

970 
§cLöe
 +
§cSåide
;

971 
‹gLöe
 +
‹gSåide
;

973 if(
isCÆcuœãPªDeblockSam∂es
)

975 if(
isBñowAvaû
)

977 
°¨tX
 = 
isLe·Avaû
 ? 0 : 1;

978 
ídX
 = 
isRightAvaû
 ? 
width
 : (width -1);

980 
y
=0; y<
skùLöesB
[
ty≥Idx
]; y++)

982 
signLe·
 = (
SCh¨
)
	`sgn
(
§cLöe
[
°¨tX
] - srcLine[startX-1]);

983 
x
=
°¨tX
; x<
ídX
; x++)

985 
signRight
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - srcLine[x+1]);

986 
edgeTy≥
 = 
signRight
 + 
signLe·
;

987 
signLe·
 = -
signRight
;

989 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

990 
cou¡
[
edgeTy≥
] ++;

992 
§cLöe
 +
§cSåide
;

993 
‹gLöe
 +
‹gSåide
;

999 
SAO_TYPE_EO_90
:

1001 
diff
 +=2;

1002 
cou¡
+=2;

1003 
SCh¨
 *
signUpLöe
 = 
m_signLöeBuf1
;

1005 
°¨tX
 = (!
isCÆcuœãPªDeblockSam∂es
) ? 0

1006 : (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : width)

1008 
°¨tY
 = 
isAboveAvaû
 ? 0 : 1;

1009 
ídX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : width)

1010 : 
width


1012 
ídY
 = 
isBñowAvaû
 ? (
height
 - 
skùLöesB
[
ty≥Idx
]) : (height - 1);

1013 i‡(!
isAboveAvaû
)

1015 
§cLöe
 +
§cSåide
;

1016 
‹gLöe
 +
‹gSåide
;

1019 
Pñ
* 
§cLöeAbove
 = 
§cLöe
 - 
§cSåide
;

1020 
x
=
°¨tX
; x<
ídX
; x++)

1022 
signUpLöe
[
x
] = (
SCh¨
)
	`sgn
(
§cLöe
[x] - 
§cLöeAbove
[x]);

1025 
Pñ
* 
§cLöeBñow
;

1026 
y
=
°¨tY
; y<
ídY
; y++)

1028 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1030 
x
=
°¨tX
; x<
ídX
; x++)

1032 
signDown
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x]);

1033 
edgeTy≥
 = 
signDown
 + 
signUpLöe
[
x
];

1034 
signUpLöe
[
x
]-
signDown
;

1036 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1037 
cou¡
[
edgeTy≥
] ++;

1039 
§cLöe
 +
§cSåide
;

1040 
‹gLöe
 +
‹gSåide
;

1042 if(
isCÆcuœãPªDeblockSam∂es
)

1044 if(
isBñowAvaû
)

1046 
°¨tX
 = 0;

1047 
ídX
 = 
width
;

1049 
y
=0; y<
skùLöesB
[
ty≥Idx
]; y++)

1051 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1052 
§cLöeAbove
 = 
§cLöe
 - 
§cSåide
;

1054 
x
=
°¨tX
; x<
ídX
; x++)

1056 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x]Ë+ sgn(§cLöe[x] - 
§cLöeAbove
[x]);

1057 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1058 
cou¡
[
edgeTy≥
] ++;

1060 
§cLöe
 +
§cSåide
;

1061 
‹gLöe
 +
‹gSåide
;

1068 
SAO_TYPE_EO_135
:

1070 
diff
 +=2;

1071 
cou¡
+=2;

1072 
SCh¨
 *
signUpLöe
, *
signDownLöe
, *
signTmpLöe
;

1074 
signUpLöe
 = 
m_signLöeBuf1
;

1075 
signDownLöe

m_signLöeBuf2
;

1077 
°¨tX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isLe·Avaû
 ? 0 : 1)

1078 : (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : (width - 1))

1081 
ídX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]): (width - 1))

1082 : (
isRightAvaû
 ? 
width
 : (width - 1))

1084 
ídY
 = 
isBñowAvaû
 ? (
height
 - 
skùLöesB
[
ty≥Idx
]) : (height - 1);

1087 
Pñ
* 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1088 
x
=
°¨tX
; x<
ídX
+1; x++)

1090 
signUpLöe
[
x
] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[x] - 
§cLöe
[x-1]);

1094 
Pñ
* 
§cLöeAbove
 = 
§cLöe
 - 
§cSåide
;

1095 
fú°LöeSèπX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isAboveLe·Avaû
 ? 0 : 1Ë: 
°¨tX
;

1096 
fú°LöeEndX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isAboveAvaû
 ? 
ídX
 : 1) :ÉndX;

1097 
x
=
fú°LöeSèπX
; x<
fú°LöeEndX
; x++)

1099 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeAbove
[x-1]Ë- 
signUpLöe
[x+1];

1100 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1101 
cou¡
[
edgeTy≥
] ++;

1103 
§cLöe
 +
§cSåide
;

1104 
‹gLöe
 +
‹gSåide
;

1108 
y
=1; y<
ídY
; y++)

1110 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1112 
x
=
°¨tX
; x<
ídX
; x++)

1114 
signDown
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x+1]);

1115 
edgeTy≥
 = 
signDown
 + 
signUpLöe
[
x
];

1116 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1117 
cou¡
[
edgeTy≥
] ++;

1119 
signDownLöe
[
x
+1] = -
signDown
;

1121 
signDownLöe
[
°¨tX
] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[°¨tX] - 
§cLöe
[startX-1]);

1123 
signTmpLöe
 = 
signUpLöe
;

1124 
signUpLöe
 = 
signDownLöe
;

1125 
signDownLöe
 = 
signTmpLöe
;

1127 
§cLöe
 +
§cSåide
;

1128 
‹gLöe
 +
‹gSåide
;

1130 if(
isCÆcuœãPªDeblockSam∂es
)

1132 if(
isBñowAvaû
)

1134 
°¨tX
 = 
isLe·Avaû
 ? 0 : 1 ;

1135 
ídX
 = 
isRightAvaû
 ? 
width
 : (width -1);

1137 
y
=0; y<
skùLöesB
[
ty≥Idx
]; y++)

1139 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1140 
§cLöeAbove
 = 
§cLöe
 - 
§cSåide
;

1142 
x
=
°¨tX
; x< 
ídX
; x++)

1144 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x+1]Ë+ sgn(§cLöe[x] - 
§cLöeAbove
[x-1]);

1145 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1146 
cou¡
[
edgeTy≥
] ++;

1148 
§cLöe
 +
§cSåide
;

1149 
‹gLöe
 +
‹gSåide
;

1155 
SAO_TYPE_EO_45
:

1157 
diff
 +=2;

1158 
cou¡
+=2;

1159 
SCh¨
 *
signUpLöe
 = 
m_signLöeBuf1
+1;

1161 
°¨tX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isLe·Avaû
 ? 0 : 1)

1162 : (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : (width - 1))

1164 
ídX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : (width - 1))

1165 : (
isRightAvaû
 ? 
width
 : (width - 1))

1167 
ídY
 = 
isBñowAvaû
 ? (
height
 - 
skùLöesB
[
ty≥Idx
]) : (height - 1);

1170 
Pñ
* 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1171 
x
=
°¨tX
-1; x<
ídX
; x++)

1173 
signUpLöe
[
x
] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[x] - 
§cLöe
[x+1]);

1178 
Pñ
* 
§cLöeAbove
 = 
§cLöe
 - 
§cSåide
;

1179 
fú°LöeSèπX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? (
isAboveAvaû
 ? 
°¨tX
 : 
ídX
)

1180 : 
°¨tX


1182 
fú°LöeEndX
 = (!
isCÆcuœãPªDeblockSam∂es
Ë? ((!
isRightAvaû
 && 
isAboveRightAvaû
Ë? 
width
 : 
ídX
)

1183 : 
ídX


1185 
x
=
fú°LöeSèπX
; x<
fú°LöeEndX
; x++)

1187 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeAbove
[x+1]Ë- 
signUpLöe
[x-1];

1188 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1189 
cou¡
[
edgeTy≥
] ++;

1192 
§cLöe
 +
§cSåide
;

1193 
‹gLöe
 +
‹gSåide
;

1196 
y
=1; y<
ídY
; y++)

1198 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1200 
x
=
°¨tX
; x<
ídX
; x++)

1202 
signDown
 = (
SCh¨
)
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x-1]);

1203 
edgeTy≥
 = 
signDown
 + 
signUpLöe
[
x
];

1205 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1206 
cou¡
[
edgeTy≥
] ++;

1208 
signUpLöe
[
x
-1] = -
signDown
;

1210 
signUpLöe
[
ídX
-1] = (
SCh¨
)
	`sgn
(
§cLöeBñow
[ídX-1] - 
§cLöe
[endX]);

1211 
§cLöe
 +
§cSåide
;

1212 
‹gLöe
 +
‹gSåide
;

1214 if(
isCÆcuœãPªDeblockSam∂es
)

1216 if(
isBñowAvaû
)

1218 
°¨tX
 = 
isLe·Avaû
 ? 0 : 1 ;

1219 
ídX
 = 
isRightAvaû
 ? 
width
 : (width -1);

1221 
y
=0; y<
skùLöesB
[
ty≥Idx
]; y++)

1223 
§cLöeBñow
 = 
§cLöe
 + 
§cSåide
;

1224 
§cLöeAbove
 = 
§cLöe
 - 
§cSåide
;

1226 
x
=
°¨tX
; x<
ídX
; x++)

1228 
edgeTy≥
 = 
	`sgn
(
§cLöe
[
x
] - 
§cLöeBñow
[x-1]Ë+ sgn(§cLöe[x] - 
§cLöeAbove
[x+1]);

1229 
diff
 [
edgeTy≥
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1230 
cou¡
[
edgeTy≥
] ++;

1232 
§cLöe
 +
§cSåide
;

1233 
‹gLöe
 +
‹gSåide
;

1239 
SAO_TYPE_BO
:

1241 
°¨tX
 = (!
isCÆcuœãPªDeblockSam∂es
)?0

1242 :–
isRightAvaû
?(
width
- 
skùLöesR
[
ty≥Idx
]):width)

1244 
ídX
 = (!
isCÆcuœãPªDeblockSam∂es
)?(
isRightAvaû
 ? (
width
 - 
skùLöesR
[
ty≥Idx
]) : width )

1245 :
width


1247 
ídY
 = 
isBñowAvaû
 ? (
height
- 
skùLöesB
[
ty≥Idx
]) : height;

1248 
I¡
 
shi·Bôs
 = 
ch™√lBôDïth
 - 
NUM_SAO_BO_CLASSES_LOG2
;

1249 
y
=0; y< 
ídY
; y++)

1251 
x
=
°¨tX
; x< 
ídX
; x++)

1254 
I¡
 
b™dIdx

§cLöe
[
x
] >> 
shi·Bôs
;

1255 
diff
 [
b™dIdx
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1256 
cou¡
[
b™dIdx
] ++;

1258 
§cLöe
 +
§cSåide
;

1259 
‹gLöe
 +
‹gSåide
;

1261 if(
isCÆcuœãPªDeblockSam∂es
)

1263 if(
isBñowAvaû
)

1265 
°¨tX
 = 0;

1266 
ídX
 = 
width
;

1268 
y
0; y< 
skùLöesB
[
ty≥Idx
]; y++)

1270 
x
=
°¨tX
; x< 
ídX
; x++)

1272 
I¡
 
b™dIdx

§cLöe
[
x
] >> 
shi·Bôs
;

1273 
diff
 [
b™dIdx
] +(
‹gLöe
[
x
] - 
§cLöe
[x]);

1274 
cou¡
[
b™dIdx
] ++;

1276 
§cLöe
 +
§cSåide
;

1277 
‹gLöe
 +
‹gSåide
;

1287 
	`¥ötf
("Notá supported SAOÅypes\n");

1288 
	`as£π
(0);

1289 
	`exô
(-1);

1293 
	}
}

	@TLibEncoder/TEncSampleAdaptiveOffset.h

39 #i‚de‡
__TENCSAMPLEADAPTIVEOFFSET__


40 
	#__TENCSAMPLEADAPTIVEOFFSET__


	)

42 
	~"TLibComm⁄/TComSam∂eAd≠tiveOff£t.h
"

43 
	~"TLibComm⁄/TComPic.h
"

45 
	~"TEncE¡r›y.h
"

46 
	~"TEncSbac.h
"

47 
	~"TLibComm⁄/TComBôCou¡î.h
"

56 
	eSAOCabacSèãLabÀsRDO


58 
	mSAO_CABACSTATE_PIC_INIT
 =0,

59 
	mSAO_CABACSTATE_BLK_CUR
,

60 
	mSAO_CABACSTATE_BLK_NEXT
,

61 
	mSAO_CABACSTATE_BLK_MID
,

62 
	mSAO_CABACSTATE_BLK_TEMP
,

63 
	mNUM_SAO_CABACSTATE_LABELS


66 
	sSAOSètD©a


68 
I¡64
 
	mdiff
[
MAX_NUM_SAO_CLASSES
];

69 
I¡64
 
	mcou¡
[
MAX_NUM_SAO_CLASSES
];

71 
SAOSètD©a
(){}

72 ~
SAOSètD©a
(){}

73 
Void
 
ª£t
()

75 ::
mem£t
(
diff
, 0, (
I¡64
)*
MAX_NUM_SAO_CLASSES
);

76 ::
mem£t
(
cou¡
, 0, (
I¡64
)*
MAX_NUM_SAO_CLASSES
);

78 c⁄° 
	mSAOSètD©a
& 
	m›î©‹
=(c⁄° 
SAOSètD©a
& 
§c
)

80 ::
mem˝y
(
diff
, 
§c
.diff, (
I¡64
)*
MAX_NUM_SAO_CLASSES
);

81 ::
mem˝y
(
cou¡
, 
§c
.cou¡, (
I¡64
)*
MAX_NUM_SAO_CLASSES
);

82  *
	mthis
;

84 c⁄° 
	mSAOSètD©a
& 
	m›î©‹
+(c⁄° 
SAOSètD©a
& 
§c
)

86 
I¡
 
i
=0; 
	mi
< 
	mMAX_NUM_SAO_CLASSES
; i++)

88 
	mdiff
[
i
] +
§c
.
diff
[i];

89 
	mcou¡
[
i
] +
§c
.
cou¡
[i];

91  *
	mthis
;

95 ˛as†
	cTEncSam∂eAd≠tiveOff£t
 : 
public
 
TComSam∂eAd≠tiveOff£t


97 
public
:

98 
TEncSam∂eAd≠tiveOff£t
();

99 
	mvútuÆ
 ~
TEncSam∂eAd≠tiveOff£t
();

102 
Void
 
¸óãEncD©a
(
Boﬁ
 
isPªDBFSam∂esU£d
);

103 
Void
 
de°royEncD©a
();

104 
Void
 
öôRDOCabacCodî
(
TEncSbac
* 
pcRDGoOnSbacCodî
, 
TComSli˚
* 
pcSli˚
) ;

105 
Void
 
ª£tEncodîDecisi⁄s
();

106 
Void
 
SAOPro˚ss
(
TComPic
* 
pPic
, 
Boﬁ
* 
¶i˚E«bÀd
, c⁄° 
DoubÀ
 *
œmbdas
, c⁄° Boﬁ 
bTe°SAODißbÀAtPi˘uªLevñ
, c⁄° DoubÀ 
ßoEncodögR©e
, c⁄° DoubÀ 
ßoEncodögR©eChroma
, c⁄° Boﬁ 
isPªDBFSam∂esU£d
);

107 
	mpublic
:

108 
Void
 
gëPªDBFSèti°ics
(
TComPic
* 
pPic
);

109 
	m¥iv©e
:

110 
Void
 
gëSèti°ics
(
SAOSètD©a
*** 
blkSèts
, 
TComPicYuv
* 
‹gYuv
, TComPicYuv* 
§cYuv
,
TComPic
* 
pPic
, 
Boﬁ
 
isCÆcuœãPªDeblockSam∂es
 = 
Ál£
);

111 
Void
 
decidePicP¨ams
(
Boﬁ
* 
¶i˚E«bÀd
, c⁄° 
TComPic
* 
pic
, c⁄° 
DoubÀ
 
ßoEncodögR©e
, c⁄° DoubÀ 
ßoEncodögR©eChroma
);

112 
Void
 
decideBlkP¨ams
(
TComPic
* 
pic
, 
Boﬁ
* 
¶i˚E«bÀd
, 
SAOSètD©a
*** 
blkSèts
, 
TComPicYuv
* 
§cYuv
, TComPicYuv* 
ªsYuv
, 
SAOBlkP¨am
* 
ªc⁄P¨ams
, SAOBlkP¨am* 
codedP¨ams
, c⁄° Boﬁ 
bTe°SAODißbÀAtPi˘uªLevñ
, c⁄° 
DoubÀ
 
ßoEncodögR©e
, c⁄° DoubÀ 
ßoEncodögR©eChroma
);

113 
Void
 
gëBlkSèts
(c⁄° 
Comp⁄ítID
 
compIdx
, c⁄° 
I¡
 
ch™√lBôDïth
, 
SAOSètD©a
* 
°©sD©aTy≥s
, 
Pñ
* 
§cBlk
, Pñ* 
‹gBlk
, I¡ 
§cSåide
, I¡ 
‹gSåide
, I¡ 
width
, I¡ 
height
, 
Boﬁ
 
isLe·Avaû
, Boﬁ 
isRightAvaû
, Boﬁ 
isAboveAvaû
, Boﬁ 
isBñowAvaû
, Boﬁ 
isAboveLe·Avaû
, Boﬁ 
isAboveRightAvaû
, Boﬁ 
isCÆcuœãPªDeblockSam∂es
);

114 
Void
 
dîiveModeNewRDO
(c⁄° 
BôDïths
 &
bôDïths
, 
I¡
 
˘uRsAddr
, 
SAOBlkP¨am
* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
], 
Boﬁ
* 
¶i˚E«bÀd
, 
SAOSètD©a
*** 
blkSèts
, SAOBlkP¨am& 
modeP¨am
, 
DoubÀ
& 
modeN‹mCo°
, 
TEncSbac
** 
ˇbacCodîRDO
, I¡ 
öCabacLabñ
);

115 
Void
 
dîiveModeMîgeRDO
(c⁄° 
BôDïths
 &
bôDïths
, 
I¡
 
˘uRsAddr
, 
SAOBlkP¨am
* 
mîgeLi°
[
NUM_SAO_MERGE_TYPES
], 
Boﬁ
* 
¶i˚E«bÀd
, 
SAOSètD©a
*** 
blkSèts
, SAOBlkP¨am& 
modeP¨am
, 
DoubÀ
& 
modeN‹mCo°
, 
TEncSbac
** 
ˇbacCodîRDO
, I¡ 
öCabacLabñ
);

116 
I¡64
 
gëDi°‹ti⁄
(c⁄° 
I¡
 
ch™√lBôDïth
, I¡ 
ty≥Idc
, I¡ 
ty≥AuxInfo
, I¡* 
off£tVÆ
, 
SAOSètD©a
& 
°©D©a
);

117 
Void
 
dîiveOff£ts
(
Comp⁄ítID
 
compIdx
, c⁄° 
I¡
 
ch™√lBôDïth
, I¡ 
ty≥Idc
, 
SAOSètD©a
& 
°©D©a
, I¡* 
qu™tOff£ts
, I¡& 
ty≥AuxInfo
);

118 
ölöe
 
I¡64
 
e°SaoDi°
(I¡64 
cou¡
, I¡64 
off£t
, I¡64 
diffSum
, 
I¡
 
shi·
);

119 
ölöe
 
I¡
 
e°IãrOff£t
(I¡ 
ty≥Idx
, 
DoubÀ
 
œmbda
, I¡ 
off£tI≈ut
, 
I¡64
 
cou¡
, I¡64 
diffSum
, I¡ 
shi·
, I¡ 
bôIn¸ó£
, I¡64& 
be°Di°
, DoubÀ& 
be°Co°
, I¡ 
off£tTh
 );

120 
Void
 
addPªDBFSèti°ics
(
SAOSètD©a
*** 
blkSèts
);

121 
	m¥iv©e
:

123 
TEncSbac
** 
m_µpcRDSbacCodî
;

124 
TEncSbac
* 
	mm_pcRDGoOnSbacCodî
;

125 #i‡
FAST_BIT_EST


126 
TEncBöCABACCou¡î
** 
	mm_µpcBöCodîCABAC
;

128 
TEncBöCABAC
** 
	mm_µpcBöCodîCABAC
;

130 
DoubÀ
 
	mm_œmbda
[
MAX_NUM_COMPONENT
];

133 
SAOSètD©a
*** 
	mm_°©D©a
;

134 
SAOSètD©a
*** 
	mm_¥eDBF°©D©a
;

135 
DoubÀ
 
	mm_ßoDißbÀdR©e
[
MAX_NUM_COMPONENT
][
MAX_TLAYER
];

136 
I¡
 
	mm_skùLöesR
[
MAX_NUM_COMPONENT
][
NUM_SAO_NEW_TYPES
];

137 
I¡
 
	mm_skùLöesB
[
MAX_NUM_COMPONENT
][
NUM_SAO_NEW_TYPES
];

	@TLibEncoder/TEncSbac.cpp

38 
	~"TEncT›.h
"

39 
	~"TEncSbac.h
"

40 
	~"TLibComm⁄/TComTU.h
"

42 
	~<m≠
>

43 
	~<Æg‹ôhm
>

45 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


46 
	~"../TLibComm⁄/Debug.h
"

57 
	gTEncSbac
::
	$TEncSbac
()

59 : 
	`m_pcBôIf
 ( 
NULL
 )

60 , 
	`m_pcBöIf
 ( 
NULL
 )

61 , 
	`m_numC⁄ãxtModñs
 ( 0 )

62 , 
	`m_cCUS∂ôFœgSCModñ
 ( 1, 1, 
NUM_SPLIT_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

63 , 
	`m_cCUSkùFœgSCModñ
 ( 1, 1, 
NUM_SKIP_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

64 , 
	`m_cCUMîgeFœgExtSCModñ
 ( 1, 1, 
NUM_MERGE_FLAG_EXT_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

65 , 
	`m_cCUMîgeIdxExtSCModñ
 ( 1, 1, 
NUM_MERGE_IDX_EXT_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

66 , 
	`m_cCUP¨tSizeSCModñ
 ( 1, 1, 
NUM_PART_SIZE_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

67 , 
	`m_cCUPªdModeSCModñ
 ( 1, 1, 
NUM_PRED_MODE_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

68 , 
	`m_cCUI¡øPªdSCModñ
 ( 1, 1, 
NUM_INTRA_PREDICT_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

69 , 
	`m_cCUChromaPªdSCModñ
 ( 1, 1, 
NUM_CHROMA_PRED_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

70 , 
	`m_cCUDñèQpSCModñ
 ( 1, 1, 
NUM_DELTA_QP_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

71 , 
	`m_cCUI¡îDúSCModñ
 ( 1, 1, 
NUM_INTER_DIR_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

72 , 
	`m_cCURefPicSCModñ
 ( 1, 1, 
NUM_REF_NO_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

73 , 
	`m_cCUMvdSCModñ
 ( 1, 1, 
NUM_MV_RES_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

74 , 
	`m_cCUQtCbfSCModñ
 ( 1, 
NUM_QT_CBF_CTX_SETS
, 
NUM_QT_CBF_CTX_PER_SET
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

75 , 
	`m_cCUTønsSubdivFœgSCModñ
 ( 1, 1, 
NUM_TRANS_SUBDIV_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

76 , 
	`m_cCUQtRoŸCbfSCModñ
 ( 1, 1, 
NUM_QT_ROOT_CBF_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

77 , 
	`m_cCUSigC€ffGroupSCModñ
 ( 1, 2, 
NUM_SIG_CG_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

78 , 
	`m_cCUSigSCModñ
 ( 1, 1, 
NUM_SIG_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

79 , 
	`m_cCuCtxLa°X
 ( 1, 
NUM_CTX_LAST_FLAG_SETS
, 
NUM_CTX_LAST_FLAG_XY
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

80 , 
	`m_cCuCtxLa°Y
 ( 1, 
NUM_CTX_LAST_FLAG_SETS
, 
NUM_CTX_LAST_FLAG_XY
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

81 , 
	`m_cCUO√SCModñ
 ( 1, 1, 
NUM_ONE_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

82 , 
	`m_cCUAbsSCModñ
 ( 1, 1, 
NUM_ABS_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

83 , 
	`m_cMVPIdxSCModñ
 ( 1, 1, 
NUM_MVP_IDX_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

84 , 
	`m_cSaoMîgeSCModñ
 ( 1, 1, 
NUM_SAO_MERGE_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

85 , 
	`m_cSaoTy≥IdxSCModñ
 ( 1, 1, 
NUM_SAO_TYPE_IDX_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

86 , 
	`m_cTønsf‹mSkùSCModñ
 ( 1, 
MAX_NUM_CHANNEL_TYPE
, 
NUM_TRANSFORMSKIP_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

87 , 
	`m_CUTønsqu™tBy∑ssFœgSCModñ
 ( 1, 1, 
NUM_CU_TRANSQUANT_BYPASS_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

88 , 
	`m_ex∂icôRdpcmFœgSCModñ
 ( 1, 
MAX_NUM_CHANNEL_TYPE
, 
NUM_EXPLICIT_RDPCM_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

89 , 
	`m_ex∂icôRdpcmDúSCModñ
 ( 1, 
MAX_NUM_CHANNEL_TYPE
, 
NUM_EXPLICIT_RDPCM_DIR_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

90 , 
	`m_cCrossComp⁄ítPªdi˘i⁄SCModñ
 ( 1, 1, 
NUM_CROSS_COMPONENT_PREDICTION_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

91 , 
	`m_ChromaQpAdjFœgSCModñ
 ( 1, 1, 
NUM_CHROMA_QP_ADJ_FLAG_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

92 , 
	`m_ChromaQpAdjIdcSCModñ
 ( 1, 1, 
NUM_CHROMA_QP_ADJ_IDC_CTX
 , 
m_c⁄ãxtModñs
 + 
m_numC⁄ãxtModñs
, m_numContextModels)

94 
	`as£π
–
m_numC⁄ãxtModñs
 <
MAX_NUM_CTX_MOD
 );

95 
	}
}

97 
	gTEncSbac
::~
	$TEncSbac
()

99 
	}
}

105 
Void
 
TEncSbac
::
	$ª£tE¡r›y
 (c⁄° 
TComSli˚
 *
pSli˚
)

107 
I¡
 
iQp
 = 
pSli˚
->
	`gëSli˚Qp
();

108 
Sli˚Ty≥
 
eSli˚Ty≥
 = 
pSli˚
->
	`gëSli˚Ty≥
();

110 
Sli˚Ty≥
 
ícCABACTabÀIdx
 = 
pSli˚
->
	`gëEncCABACTabÀIdx
();

111 i‡(!
pSli˚
->
	`isI¡ø
(Ë&& (
ícCABACTabÀIdx
==
B_SLICE
 ||ÉncCABACTabÀIdx==
P_SLICE
Ë&&ÖSli˚->
	`gëPPS
()->
	`gëCabacInôPª£¡Fœg
())

113 
eSli˚Ty≥
 = 
ícCABACTabÀIdx
;

116 
m_cCUS∂ôFœgSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_SPLIT_FLAG
 );

117 
m_cCUSkùFœgSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_SKIP_FLAG
 );

118 
m_cCUMîgeFœgExtSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_MERGE_FLAG_EXT
);

119 
m_cCUMîgeIdxExtSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_MERGE_IDX_EXT
);

120 
m_cCUP¨tSizeSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_PART_SIZE
 );

121 
m_cCUPªdModeSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_PRED_MODE
 );

122 
m_cCUI¡øPªdSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_INTRA_PRED_MODE
 );

123 
m_cCUChromaPªdSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_CHROMA_PRED_MODE
 );

124 
m_cCUI¡îDúSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_INTER_DIR
 );

125 
m_cCUMvdSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_MVD
 );

126 
m_cCURefPicSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_REF_PIC
 );

127 
m_cCUDñèQpSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_DQP
 );

128 
m_cCUQtCbfSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_QT_CBF
 );

129 
m_cCUQtRoŸCbfSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_QT_ROOT_CBF
 );

130 
m_cCUSigC€ffGroupSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_SIG_CG_FLAG
 );

131 
m_cCUSigSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_SIG_FLAG
 );

132 
m_cCuCtxLa°X
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_LAST
 );

133 
m_cCuCtxLa°Y
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_LAST
 );

134 
m_cCUO√SCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_ONE_FLAG
 );

135 
m_cCUAbsSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_ABS_FLAG
 );

136 
m_cMVPIdxSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_MVP_IDX
 );

137 
m_cCUTønsSubdivFœgSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_TRANS_SUBDIV_FLAG
 );

138 
m_cSaoMîgeSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_SAO_MERGE_FLAG
 );

139 
m_cSaoTy≥IdxSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_SAO_TYPE_IDX
 );

140 
m_cTønsf‹mSkùSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_TRANSFORMSKIP_FLAG
 );

141 
m_CUTønsqu™tBy∑ssFœgSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_CU_TRANSQUANT_BYPASS_FLAG
 );

142 
m_ex∂icôRdpcmFœgSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_EXPLICIT_RDPCM_FLAG
);

143 
m_ex∂icôRdpcmDúSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_EXPLICIT_RDPCM_DIR
);

144 
m_cCrossComp⁄ítPªdi˘i⁄SCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_CROSS_COMPONENT_PREDICTION
 );

145 
m_ChromaQpAdjFœgSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_CHROMA_QP_ADJ_FLAG
 );

146 
m_ChromaQpAdjIdcSCModñ
.
	`öôBuf„r
 ( 
eSli˚Ty≥
, 
iQp
, (
UCh¨
*)
INIT_CHROMA_QP_ADJ_IDC
 );

148 
UI¡
 
°©i°icIndex
 = 0; sèti°icIndex < 
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
 ; statisticIndex++)

150 
m_gﬁombRi˚Ad≠èti⁄Sèti°ics
[
°©i°icIndex
] = 0;

153 
m_pcBöIf
->
	`°¨t
();

156 
	}
}

162 
Sli˚Ty≥
 
	gTEncSbac
::
	$dëîmöeCabacInôIdx
(c⁄° 
TComSli˚
 *
pSli˚
)

164 
I¡
 
qp
 = 
pSli˚
->
	`gëSli˚Qp
();

166 i‡(!
pSli˚
->
	`isI¡ø
())

168 
Sli˚Ty≥
 
aSli˚Ty≥Choi˚s
[] = {
B_SLICE
, 
P_SLICE
};

170 
UI¡
 
be°Co°
 = 
MAX_UINT
;

171 
Sli˚Ty≥
 
be°Sli˚Ty≥
 = 
aSli˚Ty≥Choi˚s
[0];

172 
UI¡
 
idx
=0; idx<2; idx++)

174 
UI¡
 
curCo°
 = 0;

175 
Sli˚Ty≥
 
curSli˚Ty≥
 = 
aSli˚Ty≥Choi˚s
[
idx
];

177 
curCo°
 = 
m_cCUS∂ôFœgSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SPLIT_FLAG
 );

178 
curCo°
 +
m_cCUSkùFœgSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SKIP_FLAG
 );

179 
curCo°
 +
m_cCUMîgeFœgExtSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MERGE_FLAG_EXT
);

180 
curCo°
 +
m_cCUMîgeIdxExtSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MERGE_IDX_EXT
);

181 
curCo°
 +
m_cCUP¨tSizeSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_PART_SIZE
 );

182 
curCo°
 +
m_cCUPªdModeSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_PRED_MODE
 );

183 
curCo°
 +
m_cCUI¡øPªdSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_INTRA_PRED_MODE
 );

184 
curCo°
 +
m_cCUChromaPªdSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CHROMA_PRED_MODE
 );

185 
curCo°
 +
m_cCUI¡îDúSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_INTER_DIR
 );

186 
curCo°
 +
m_cCUMvdSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MVD
 );

187 
curCo°
 +
m_cCURefPicSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_REF_PIC
 );

188 
curCo°
 +
m_cCUDñèQpSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_DQP
 );

189 
curCo°
 +
m_cCUQtCbfSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_QT_CBF
 );

190 
curCo°
 +
m_cCUQtRoŸCbfSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_QT_ROOT_CBF
 );

191 
curCo°
 +
m_cCUSigC€ffGroupSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SIG_CG_FLAG
 );

192 
curCo°
 +
m_cCUSigSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SIG_FLAG
 );

193 
curCo°
 +
m_cCuCtxLa°X
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_LAST
 );

194 
curCo°
 +
m_cCuCtxLa°Y
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_LAST
 );

195 
curCo°
 +
m_cCUO√SCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_ONE_FLAG
 );

196 
curCo°
 +
m_cCUAbsSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_ABS_FLAG
 );

197 
curCo°
 +
m_cMVPIdxSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_MVP_IDX
 );

198 
curCo°
 +
m_cCUTønsSubdivFœgSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_TRANS_SUBDIV_FLAG
 );

199 
curCo°
 +
m_cSaoMîgeSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SAO_MERGE_FLAG
 );

200 
curCo°
 +
m_cSaoTy≥IdxSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_SAO_TYPE_IDX
 );

201 
curCo°
 +
m_cTønsf‹mSkùSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_TRANSFORMSKIP_FLAG
 );

202 
curCo°
 +
m_CUTønsqu™tBy∑ssFœgSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CU_TRANSQUANT_BYPASS_FLAG
 );

203 
curCo°
 +
m_ex∂icôRdpcmFœgSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_EXPLICIT_RDPCM_FLAG
);

204 
curCo°
 +
m_ex∂icôRdpcmDúSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_EXPLICIT_RDPCM_DIR
);

205 
curCo°
 +
m_cCrossComp⁄ítPªdi˘i⁄SCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CROSS_COMPONENT_PREDICTION
 );

206 
curCo°
 +
m_ChromaQpAdjFœgSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CHROMA_QP_ADJ_FLAG
 );

207 
curCo°
 +
m_ChromaQpAdjIdcSCModñ
.
	`ˇlcCo°
 ( 
curSli˚Ty≥
, 
qp
, (
UCh¨
*)
INIT_CHROMA_QP_ADJ_IDC
 );

209 i‡(
curCo°
 < 
be°Co°
)

211 
be°Sli˚Ty≥
 = 
curSli˚Ty≥
;

212 
be°Co°
 = 
curCo°
;

215  
be°Sli˚Ty≥
;

219  
I_SLICE
;

221 
	}
}

223 
Void
 
	gTEncSbac
::
	$codeVPS
–c⁄° 
TComVPS
* )

225 
	`as£π
 (0);

227 
	}
}

229 
Void
 
	gTEncSbac
::
	$codeSPS
–c⁄° 
TComSPS
* )

231 
	`as£π
 (0);

233 
	}
}

235 
Void
 
	gTEncSbac
::
	$codePPS
–c⁄° 
TComPPS
* )

237 
	`as£π
 (0);

239 
	}
}

241 
Void
 
	gTEncSbac
::
	$codeSli˚Hódî
–
TComSli˚
* )

243 
	`as£π
 (0);

245 
	}
}

247 
Void
 
	gTEncSbac
::
	$codeTûesWPPE¡ryPoöt
–
TComSli˚
* )

249 
	`as£π
 (0);

251 
	}
}

253 
Void
 
	gTEncSbac
::
	$codeTîmö©ögBô
–
UI¡
 
uûsLa°
 )

255 
m_pcBöIf
->
	`ícodeBöTrm
–
uûsLa°
 );

256 
	}
}

258 
Void
 
	gTEncSbac
::
	$codeSli˚Föish
()

260 
m_pcBöIf
->
	`föish
();

261 
	}
}

263 
Void
 
	gTEncSbac
::
	$xWrôeU«rySymbﬁ
–
UI¡
 
uiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
 )

265 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
 ? 1 : 0, 
pcSCModñ
[0] );

267 if–0 =
uiSymbﬁ
)

272  
uiSymbﬁ
-- )

274 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
 ? 1 : 0, 
pcSCModñ
[ 
iOff£t
 ] );

278 
	}
}

280 
Void
 
	gTEncSbac
::
	$xWrôeU«ryMaxSymbﬁ
–
UI¡
 
uiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, UI¡ 
uiMaxSymbﬁ
 )

282 i‡(
uiMaxSymbﬁ
 == 0)

287 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
 ? 1 : 0, 
pcSCModñ
[ 0 ] );

289 i‡–
uiSymbﬁ
 == 0 )

294 
Boﬁ
 
bCodeLa°
 = ( 
uiMaxSymbﬁ
 > 
uiSymbﬁ
 );

296  --
uiSymbﬁ
 )

298 
m_pcBöIf
->
	`ícodeBö
–1, 
pcSCModñ
[ 
iOff£t
 ] );

300 if–
bCodeLa°
 )

302 
m_pcBöIf
->
	`ícodeBö
–0, 
pcSCModñ
[ 
iOff£t
 ] );

306 
	}
}

308 
Void
 
	gTEncSbac
::
	$xWrôeEpExGﬁomb
–
UI¡
 
uiSymbﬁ
, UI¡ 
uiCou¡
 )

310 
UI¡
 
bös
 = 0;

311 
I¡
 
numBös
 = 0;

313  
uiSymbﬁ
 >(
UI¡
)(1<<
uiCou¡
) )

315 
bös
 = 2 * bins + 1;

316 
numBös
++;

317 
uiSymbﬁ
 -1 << 
uiCou¡
;

318 
uiCou¡
 ++;

320 
bös
 = 2 * bins + 0;

321 
numBös
++;

323 
bös
 = (bö†<< 
uiCou¡
Ë| 
uiSymbﬁ
;

324 
numBös
 +
uiCou¡
;

326 
	`as£π
–
numBös
 <= 32 );

327 
m_pcBöIf
->
	`ícodeBösEP
–
bös
, 
numBös
 );

328 
	}
}

337 
Void
 
	gTEncSbac
::
	$xWrôeC€fRemaöExGﬁomb
 ( 
UI¡
 
symbﬁ
, UI¡ &
rP¨am
, c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 )

339 
I¡
 
codeNumbî
 = (I¡)
symbﬁ
;

340 
UI¡
 
Àngth
;

342 i‡(
codeNumbî
 < (
COEF_REMAIN_BIN_REDUCTION
 << 
rP¨am
))

344 
Àngth
 = 
codeNumbî
>>
rP¨am
;

345 
m_pcBöIf
->
	`ícodeBösEP
–(1<<(
Àngth
+1))-2 ,Üength+1);

346 
m_pcBöIf
->
	`ícodeBösEP
((
codeNumbî
%(1<<
rP¨am
)),rParam);

348 i‡(
u£LimôedPªfixLígth
)

350 c⁄° 
UI¡
 
maximumPªfixLígth
 = (32 - (
COEF_REMAIN_BIN_REDUCTION
 + 
maxLog2TrDy«micR™ge
));

352 
UI¡
 
¥efixLígth
 = 0;

353 
UI¡
 
suffixLígth
 = 
MAX_UINT
;

354 
UI¡
 
codeVÆue
 = (
symbﬁ
 >> 
rP¨am
Ë- 
COEF_REMAIN_BIN_REDUCTION
;

356 i‡(
codeVÆue
 >((1 << 
maximumPªfixLígth
) - 1))

358 
¥efixLígth
 = 
maximumPªfixLígth
;

359 
suffixLígth
 = 
maxLog2TrDy«micR™ge
 - 
rP¨am
;

363 
codeVÆue
 > ((2 << 
¥efixLígth
) - 2))

365 
¥efixLígth
++;

368 
suffixLígth
 = 
¥efixLígth
 + 1;

371 c⁄° 
UI¡
 
suffix
 = 
codeVÆue
 - ((1 << 
¥efixLígth
) - 1);

373 c⁄° 
UI¡
 
tŸÆPªfixLígth
 = 
¥efixLígth
 + 
COEF_REMAIN_BIN_REDUCTION
;

374 c⁄° 
UI¡
 
¥efix
 = (1 << 
tŸÆPªfixLígth
) - 1;

375 c⁄° 
UI¡
 
rP¨amBôMask
 = (1 << 
rP¨am
) - 1;

377 
m_pcBöIf
->
	`ícodeBösEP
–
¥efix
, 
tŸÆPªfixLígth
 );

378 
m_pcBöIf
->
	`ícodeBösEP
(((
suffix
 << 
rP¨am
Ë| (
symbﬁ
 & 
rP¨amBôMask
)), (
suffixLígth
 +ÑParam));

382 
Àngth
 = 
rP¨am
;

383 
codeNumbî
 = codeNumbî - ( 
COEF_REMAIN_BIN_REDUCTION
 << 
rP¨am
);

385 
codeNumbî
 >(1<<
Àngth
))

387 
codeNumbî
 -(1<<(
Àngth
++));

390 
m_pcBöIf
->
	`ícodeBösEP
((1<<(
COEF_REMAIN_BIN_REDUCTION
+
Àngth
+1-
rP¨am
))-2,COEF_REMAIN_BIN_REDUCTION+length+1-rParam);

391 
m_pcBöIf
->
	`ícodeBösEP
(
codeNumbî
,
Àngth
);

393 
	}
}

396 
Void
 
	gTEncSbac
::
	$lﬂd
 ( c⁄° 
TEncSbac
* 
pSrc
)

398 
this
->
	`xC›yFrom
(
pSrc
);

399 
	}
}

401 
Void
 
	gTEncSbac
::
	$lﬂdI¡øDúMode
–c⁄° 
TEncSbac
* 
pSrc
, c⁄° 
Ch™√lTy≥
 
chTy≥
 )

403 
m_pcBöIf
->
	`c›ySèã
–
pSrc
->m_pcBinIf );

404 i‡(
	`isLuma
(
chTy≥
))

406 
this
->
m_cCUI¡øPªdSCModñ
 .
	`c›yFrom
–&
pSrc
->m_cCUIntraPredSCModel );

410 
this
->
m_cCUChromaPªdSCModñ
 .
	`c›yFrom
–&
pSrc
->m_cCUChromaPredSCModel );

412 
	}
}

415 
Void
 
	gTEncSbac
::
	$°‹e
–
TEncSbac
* 
pDe°
) const

417 
pDe°
->
	`xC›yFrom
–
this
 );

418 
	}
}

421 
Void
 
	gTEncSbac
::
	$xC›yFrom
–c⁄° 
TEncSbac
* 
pSrc
 )

423 
m_pcBöIf
->
	`c›ySèã
–
pSrc
->m_pcBinIf );

424 
	`xC›yC⁄ãxtsFrom
(
pSrc
);

425 
	}
}

427 
Void
 
	gTEncSbac
::
	$codeMVPIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

429 
I¡
 
iSymbﬁ
 = 
pcCU
->
	`gëMVPIdx
(
eRefLi°
, 
uiAbsP¨tIdx
);

430 
I¡
 
iNum
 = 
AMVP_MAX_NUM_CANDS
;

432 
	`xWrôeU«ryMaxSymbﬁ
(
iSymbﬁ
, 
m_cMVPIdxSCModñ
.
	`gë
(0), 1, 
iNum
-1);

433 
	}
}

435 
Void
 
	gTEncSbac
::
	$codeP¨tSize
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

437 
P¨tSize
 
eSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
–
uiAbsP¨tIdx
 );

438 c⁄° 
UI¡
 
log2DiffMaxMöCodögBlockSize
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëLog2DiffMaxMöCodögBlockSize
();

440 i‡–
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) )

442 if–
uiDïth
 =
log2DiffMaxMöCodögBlockSize
 )

444 
m_pcBöIf
->
	`ícodeBö
–
eSize
 =
SIZE_2Nx2N
? 1 : 0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 0 ) );

449 
eSize
)

451 
SIZE_2Nx2N
:

453 
m_pcBöIf
->
	`ícodeBö
–1, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 0) );

456 
SIZE_2NxN
:

457 
SIZE_2NxnU
:

458 
SIZE_2NxnD
:

460 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 0) );

461 
m_pcBöIf
->
	`ícodeBö
–1, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 1) );

462 i‡–
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëU£AMP
(Ë&& 
uiDïth
 < 
log2DiffMaxMöCodögBlockSize
 )

464 i‡(
eSize
 =
SIZE_2NxN
)

466 
m_pcBöIf
->
	`ícodeBö
(1, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 3 ));

470 
m_pcBöIf
->
	`ícodeBö
(0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 3 ));

471 
m_pcBöIf
->
	`ícodeBöEP
((
eSize
 =
SIZE_2NxnU
? 0: 1));

476 
SIZE_Nx2N
:

477 
SIZE_nLx2N
:

478 
SIZE_nRx2N
:

480 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 0) );

481 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 1) );

483 if–
uiDïth
 =
log2DiffMaxMöCodögBlockSize
 && !–
pcCU
->
	`gëWidth
(
uiAbsP¨tIdx
Ë=8 &&ÖcCU->
	`gëHeight
(uiAbsPartIdx) == 8 ) )

485 
m_pcBöIf
->
	`ícodeBö
–1, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 2) );

488 i‡–
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëU£AMP
(Ë&& 
uiDïth
 < 
log2DiffMaxMöCodögBlockSize
 )

490 i‡(
eSize
 =
SIZE_Nx2N
)

492 
m_pcBöIf
->
	`ícodeBö
(1, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 3 ));

496 
m_pcBöIf
->
	`ícodeBö
(0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 3 ));

497 
m_pcBöIf
->
	`ícodeBöEP
((
eSize
 =
SIZE_nLx2N
? 0: 1));

502 
SIZE_NxN
:

504 if–
uiDïth
 =
log2DiffMaxMöCodögBlockSize
 && !–
pcCU
->
	`gëWidth
(
uiAbsP¨tIdx
Ë=8 &&ÖcCU->
	`gëHeight
(uiAbsPartIdx) == 8 ) )

506 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 0) );

507 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 1) );

508 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cCUP¨tSizeSCModñ
.
	`gë
( 0, 0, 2) );

514 
	`as£π
(0);

518 
	}
}

526 
Void
 
	gTEncSbac
::
	$codePªdMode
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

529 
m_pcBöIf
->
	`ícodeBö
–
pcCU
->
	`isI¡ø
–
uiAbsP¨tIdx
 ) ? 1 : 0, 
m_cCUPªdModeSCModñ
.
	`gë
( 0, 0, 0 ) );

530 
	}
}

532 
Void
 
	gTEncSbac
::
	$codeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

534 
UI¡
 
uiSymbﬁ
 = 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
);

535 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
, 
m_CUTønsqu™tBy∑ssFœgSCModñ
.
	`gë
( 0, 0, 0 ) );

536 
	}
}

543 
Void
 
	gTEncSbac
::
	$codeSkùFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

546 
UI¡
 
uiSymbﬁ
 = 
pcCU
->
	`isSkù≥d
–
uiAbsP¨tIdx
 ) ? 1 : 0;

547 
UI¡
 
uiCtxSkù
 = 
pcCU
->
	`gëCtxSkùFœg
–
uiAbsP¨tIdx
 ) ;

548 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
, 
m_cCUSkùFœgSCModñ
.
	`gë
–0, 0, 
uiCtxSkù
 ) );

549 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

550 
	`DTRACE_CABAC_T
( "\tSkipFlag" );

551 
	`DTRACE_CABAC_T
( "\tuiCtxSkip: ");

552 
	`DTRACE_CABAC_V
–
uiCtxSkù
 );

553 
	`DTRACE_CABAC_T
( "\tuiSymbol: ");

554 
	`DTRACE_CABAC_V
–
uiSymbﬁ
 );

555 
	`DTRACE_CABAC_T
( "\n");

556 
	}
}

563 
Void
 
	gTEncSbac
::
	$codeMîgeFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

565 c⁄° 
UI¡
 
uiSymbﬁ
 = 
pcCU
->
	`gëMîgeFœg
–
uiAbsP¨tIdx
 ) ? 1 : 0;

566 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
, *
m_cCUMîgeFœgExtSCModñ
.
	`gë
( 0 ) );

568 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

569 
	`DTRACE_CABAC_T
( "\tMergeFlag: " );

570 
	`DTRACE_CABAC_V
–
uiSymbﬁ
 );

571 
	`DTRACE_CABAC_T
( "\tAddress: " );

572 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCtuRsAddr
() );

573 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx: " );

574 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 );

575 
	`DTRACE_CABAC_T
( "\n" );

576 
	}
}

583 
Void
 
	gTEncSbac
::
	$codeMîgeIndex
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

585 
UI¡
 
uiU«ryIdx
 = 
pcCU
->
	`gëMîgeIndex
–
uiAbsP¨tIdx
 );

586 
UI¡
 
uiNumC™d
 = 
pcCU
->
	`gëSli˚
()->
	`gëMaxNumMîgeC™d
();

587 i‡–
uiNumC™d
 > 1 )

589  
UI¡
 
ui
 = 0; uò< 
uiNumC™d
 - 1; ++ui )

591 c⁄° 
UI¡
 
uiSymbﬁ
 = 
ui
 =
uiU«ryIdx
 ? 0 : 1;

592 i‡–
ui
==0 )

594 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
, 
m_cCUMîgeIdxExtSCModñ
.
	`gë
( 0, 0, 0 ) );

598 
m_pcBöIf
->
	`ícodeBöEP
–
uiSymbﬁ
 );

600 if–
uiSymbﬁ
 == 0 )

606 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

607 
	`DTRACE_CABAC_T
( "\tparseMergeIndex()" );

608 
	`DTRACE_CABAC_T
( "\tuiMRGIdx= " );

609 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëMîgeIndex
–
uiAbsP¨tIdx
 ) );

610 
	`DTRACE_CABAC_T
( "\n" );

611 
	}
}

613 
Void
 
	gTEncSbac
::
	$codeS∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 )

615 if–
uiDïth
 =
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëLog2DiffMaxMöCodögBlockSize
() )

620 
UI¡
 
uiCtx
 = 
pcCU
->
	`gëCtxS∂ôFœg
–
uiAbsP¨tIdx
, 
uiDïth
 );

621 
UI¡
 
uiCuºS∂ôFœg
 = ( 
pcCU
->
	`gëDïth
–
uiAbsP¨tIdx
 ) > 
uiDïth
 ) ? 1 : 0;

623 
	`as£π
–
uiCtx
 < 3 );

624 
m_pcBöIf
->
	`ícodeBö
–
uiCuºS∂ôFœg
, 
m_cCUS∂ôFœgSCModñ
.
	`gë
–0, 0, 
uiCtx
 ) );

625 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

626 
	`DTRACE_CABAC_T
( "\tSplitFlag\n" )

628 
	}
}

630 
Void
 
	gTEncSbac
::
	$codeTønsf‹mSubdivFœg
–
UI¡
 
uiSymbﬁ
, UI¡ 
uiCtx
 )

632 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
, 
m_cCUTønsSubdivFœgSCModñ
.
	`gë
–0, 0, 
uiCtx
 ) );

633 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

634 
	`DTRACE_CABAC_T
( "\tparseTransformSubdivFlag()" )

635 
	`DTRACE_CABAC_T
( "\tsymbol=" )

636 
	`DTRACE_CABAC_V
–
uiSymbﬁ
 )

637 
	`DTRACE_CABAC_T
( "\tctx=" )

638 
	`DTRACE_CABAC_V
–
uiCtx
 )

639 
	`DTRACE_CABAC_T
( "\n" )

640 
	}
}

643 
Void
 
	gTEncSbac
::
	$codeI¡øDúLumaAng
–
TComD©aCU
* 
pcCU
, 
UI¡
 
absP¨tIdx
, 
Boﬁ
 
isMu…ùÀ
)

645 
UI¡
 
dú
[4],
j
;

646 
I¡
 
¥eds
[4][
NUM_MOST_PROBABLE_MODES
] = {{-1, -1, -1},{-1, -1, -1},{-1, -1, -1},{-1, -1, -1}};

647 
I¡
 
¥edIdx
[4] ={ -1,-1,-1,-1};

648 
P¨tSize
 
mode
 = 
pcCU
->
	`gëP¨tôi⁄Size
–
absP¨tIdx
 );

649 
UI¡
 
∑πNum
 = 
isMu…ùÀ
?(
mode
==
SIZE_NxN
?4:1):1;

650 
UI¡
 
∑πOff£t
 = ( 
pcCU
->
	`gëPic
()->
	`gëNumP¨tôi⁄sInCtu
(Ë>> (ÖcCU->
	`gëDïth
(
absP¨tIdx
) << 1 ) ) >> 2;

651 
j
=0;j<
∑πNum
;j++)

653 
dú
[
j
] = 
pcCU
->
	`gëI¡øDú
–
CHANNEL_TYPE_LUMA
, 
absP¨tIdx
+
∑πOff£t
*j );

654 
pcCU
->
	`gëI¡øDúPªdi˘‹
(
absP¨tIdx
+
∑πOff£t
*
j
, 
¥eds
[j], 
COMPONENT_Y
);

655 
UI¡
 
i
 = 0; i < 
NUM_MOST_PROBABLE_MODES
; i++)

657 if(
dú
[
j
] =
¥eds
[j][
i
])

659 
¥edIdx
[
j
] = 
i
;

662 
m_pcBöIf
->
	`ícodeBö
((
¥edIdx
[
j
] !-1)? 1 : 0, 
m_cCUI¡øPªdSCModñ
.
	`gë
( 0, 0, 0 ) );

664 
j
=0;j<
∑πNum
;j++)

666 if(
¥edIdx
[
j
] != -1)

668 
m_pcBöIf
->
	`ícodeBöEP
–
¥edIdx
[
j
] ? 1 : 0 );

669 i‡(
¥edIdx
[
j
])

671 
m_pcBöIf
->
	`ícodeBöEP
–
¥edIdx
[
j
]-1 );

676 i‡(
¥eds
[
j
][0] >Öreds[j][1])

678 
°d
::
	`sw≠
(
¥eds
[
j
][0],Öreds[j][1]);

680 i‡(
¥eds
[
j
][0] >Öreds[j][2])

682 
°d
::
	`sw≠
(
¥eds
[
j
][0],Öreds[j][2]);

684 i‡(
¥eds
[
j
][1] >Öreds[j][2])

686 
°d
::
	`sw≠
(
¥eds
[
j
][1],Öreds[j][2]);

688 
I¡
 
i
 = (
	`I¡
(
NUM_MOST_PROBABLE_MODES
) - 1); i >= 0; i--)

690 
dú
[
j
] = dú[j] > 
¥eds
[j][
i
] ? dir[j] - 1 : dir[j];

692 
m_pcBöIf
->
	`ícodeBösEP
–
dú
[
j
], 5 );

696 
	}
}

698 
Void
 
	gTEncSbac
::
	$codeI¡øDúChroma
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

700 
UI¡
 
uiI¡øDúChroma
 = 
pcCU
->
	`gëI¡øDú
–
CHANNEL_TYPE_CHROMA
, 
uiAbsP¨tIdx
 );

702 if–
uiI¡øDúChroma
 =
DM_CHROMA_IDX
 )

704 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cCUChromaPªdSCModñ
.
	`gë
( 0, 0, 0 ) );

708 
m_pcBöIf
->
	`ícodeBö
–1, 
m_cCUChromaPªdSCModñ
.
	`gë
( 0, 0, 0 ) );

710 
UI¡
 
uiAŒowedChromaDú
[ 
NUM_CHROMA_MODE
 ];

711 
pcCU
->
	`gëAŒowedChromaDú
–
uiAbsP¨tIdx
, 
uiAŒowedChromaDú
 );

713  
I¡
 
i
 = 0; i < 
NUM_CHROMA_MODE
 - 1; i++ )

715 if–
uiI¡øDúChroma
 =
uiAŒowedChromaDú
[
i
] )

717 
uiI¡øDúChroma
 = 
i
;

722 
m_pcBöIf
->
	`ícodeBösEP
–
uiI¡øDúChroma
, 2 );

726 
	}
}

729 
Void
 
	gTEncSbac
::
	$codeI¡îDú
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

731 c⁄° 
UI¡
 
uiI¡îDú
 = 
pcCU
->
	`gëI¡îDú
–
uiAbsP¨tIdx
 ) - 1;

732 c⁄° 
UI¡
 
uiCtx
 = 
pcCU
->
	`gëCtxI¡îDú
–
uiAbsP¨tIdx
 );

733 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCUI¡îDúSCModñ
.
	`gë
( 0 );

735 i‡(
pcCU
->
	`gëP¨tôi⁄Size
(
uiAbsP¨tIdx
Ë=
SIZE_2Nx2N
 ||ÖcCU->
	`gëHeight
(uiAbsPartIdx) != 8 )

737 
m_pcBöIf
->
	`ícodeBö
–
uiI¡îDú
 =2 ? 1 : 0, *–
pCtx
 + 
uiCtx
 ) );

740 i‡(
uiI¡îDú
 < 2)

742 
m_pcBöIf
->
	`ícodeBö
–
uiI¡îDú
, *–
pCtx
 + 4 ) );

746 
	}
}

748 
Void
 
	gTEncSbac
::
	$codeRefFrmIdx
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

750 
I¡
 
iRefFøme
 = 
pcCU
->
	`gëCUMvFõld
–
eRefLi°
 )->
	`gëRefIdx
–
uiAbsP¨tIdx
 );

751 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCURefPicSCModñ
.
	`gë
( 0 );

752 
m_pcBöIf
->
	`ícodeBö
––
iRefFøme
 =0 ? 0 : 1 ), *
pCtx
 );

754 if–
iRefFøme
 > 0 )

756 
UI¡
 
uiRefNum
 = 
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
–
eRefLi°
 ) - 2;

757 
pCtx
++;

758 
iRefFøme
--;

759  
UI¡
 
ui
 = 0; uò< 
uiRefNum
; ++ui )

761 c⁄° 
UI¡
 
uiSymbﬁ
 = 
ui
 =
iRefFøme
 ? 0 : 1;

762 if–
ui
 == 0 )

764 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
, *
pCtx
 );

768 
m_pcBöIf
->
	`ícodeBöEP
–
uiSymbﬁ
 );

770 if–
uiSymbﬁ
 == 0 )

777 
	}
}

779 
Void
 
	gTEncSbac
::
	$codeMvd
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 )

781 if(
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
(Ë&& 
eRefLi°
 =
REF_PIC_LIST_1
 &&ÖcCU->
	`gëI¡îDú
(
uiAbsP¨tIdx
)==3)

786 c⁄° 
TComCUMvFõld
* 
pcCUMvFõld
 = 
pcCU
->
	`gëCUMvFõld
–
eRefLi°
 );

787 c⁄° 
I¡
 
iH‹
 = 
pcCUMvFõld
->
	`gëMvd
–
uiAbsP¨tIdx
 ).
	`gëH‹
();

788 c⁄° 
I¡
 
iVî
 = 
pcCUMvFõld
->
	`gëMvd
–
uiAbsP¨tIdx
 ).
	`gëVî
();

789 
C⁄ãxtModñ
* 
pCtx
 = 
m_cCUMvdSCModñ
.
	`gë
( 0 );

791 
m_pcBöIf
->
	`ícodeBö
–
iH‹
 !0 ? 1 : 0, *
pCtx
 );

792 
m_pcBöIf
->
	`ícodeBö
–
iVî
 !0 ? 1 : 0, *
pCtx
 );

794 c⁄° 
Boﬁ
 
bH‹AbsGr0
 = 
iH‹
 != 0;

795 c⁄° 
Boﬁ
 
bVîAbsGr0
 = 
iVî
 != 0;

796 c⁄° 
UI¡
 
uiH‹Abs
 = 0 > 
iH‹
 ? -iHor : iHor;

797 c⁄° 
UI¡
 
uiVîAbs
 = 0 > 
iVî
 ? -iVer : iVer;

798 
pCtx
++;

800 if–
bH‹AbsGr0
 )

802 
m_pcBöIf
->
	`ícodeBö
–
uiH‹Abs
 > 1 ? 1 : 0, *
pCtx
 );

805 if–
bVîAbsGr0
 )

807 
m_pcBöIf
->
	`ícodeBö
–
uiVîAbs
 > 1 ? 1 : 0, *
pCtx
 );

810 if–
bH‹AbsGr0
 )

812 if–
uiH‹Abs
 > 1 )

814 
	`xWrôeEpExGﬁomb
–
uiH‹Abs
-2, 1 );

817 
m_pcBöIf
->
	`ícodeBöEP
–0 > 
iH‹
 ? 1 : 0 );

820 if–
bVîAbsGr0
 )

822 if–
uiVîAbs
 > 1 )

824 
	`xWrôeEpExGﬁomb
–
uiVîAbs
-2, 1 );

827 
m_pcBöIf
->
	`ícodeBöEP
–0 > 
iVî
 ? 1 : 0 );

831 
	}
}

833 
Void
 
	gTEncSbac
::
	$codeCrossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 )

835 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

837 if–
	`isLuma
(
compID
Ë|| !
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
() )

842 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

844 i‡(!
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
Ë|| (pcCU->
	`gëI¡øDú
–
CHANNEL_TYPE_CHROMA
, uiAbsP¨tIdx ) =
DM_CHROMA_IDX
))

846 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

847 
	`DTRACE_CABAC_T
("\tparseCrossComponentPrediction()")

848 
	`DTRACE_CABAC_T
( "\tAddr=" )

849 
	`DTRACE_CABAC_V
–
compID
 )

850 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

851 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 )

853 
I¡
 
Æpha
 = 
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
–
uiAbsP¨tIdx
, 
compID
 );

854 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCrossComp⁄ítPªdi˘i⁄SCModñ
.
	`gë
(0, 0Ë+ ((
compID
 =
COMPONENT_Cr
Ë? (
NUM_CROSS_COMPONENT_PREDICTION_CTX
 >> 1) : 0);

855 
m_pcBöIf
->
	`ícodeBö
(((
Æpha
 !0Ë? 1 : 0), 
pCtx
[0]);

857 i‡(
Æpha
 != 0)

859 c⁄° 
I¡
 
log2AbsAÕhaMöus1TabÀ
[8] = { 0, 1, 1, 2, 2, 2, 3, 3 };

860 
	`as£π
(
	`abs
(
Æpha
) <= 8);

862 i‡(
	`abs
(
Æpha
)>1)

864 
m_pcBöIf
->
	`ícodeBö
(1, 
pCtx
[1]);

865 
	`xWrôeU«ryMaxSymbﬁ
–
log2AbsAÕhaMöus1TabÀ
[
	`abs
(
Æpha
Ë- 1] - 1, (
pCtx
 + 2), 1, 2 );

869 
m_pcBöIf
->
	`ícodeBö
(0, 
pCtx
[1]);

871 
m_pcBöIf
->
	`ícodeBö
–((
Æpha
 < 0Ë? 1 : 0), 
pCtx
[4] );

873 
	`DTRACE_CABAC_T
( "\tAlpha=" )

874 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
–
uiAbsP¨tIdx
, 
compID
 ) )

875 
	`DTRACE_CABAC_T
( "\n" )

877 
	}
}

879 
Void
 
	gTEncSbac
::
	$codeDñèQP
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

881 
I¡
 
iDQp
 = 
pcCU
->
	`gëQP
–
uiAbsP¨tIdx
 ) -ÖcCU->
	`gëRefQP
( uiAbsPartIdx );

883 
I¡
 
qpBdOff£tY
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
);

884 
iDQp
 = (iDQ∞+ 78 + 
qpBdOff£tY
 + (qpBdOffsetY/2)) % (52 + qpBdOffsetY) - 26 - (qpBdOffsetY/2);

886 
UI¡
 
uiAbsDQp
 = (UI¡)((
iDQp
 > 0)? iDQp : (-iDQp));

887 
UI¡
 
TUVÆue
 = 
	`mö
((
I¡
)
uiAbsDQp
, 
CU_DQP_TU_CMAX
);

888 
	`xWrôeU«ryMaxSymbﬁ
–
TUVÆue
, &
m_cCUDñèQpSCModñ
.
	`gë
–0, 0, 0 ), 1, 
CU_DQP_TU_CMAX
);

889 if–
uiAbsDQp
 >
CU_DQP_TU_CMAX
 )

891 
	`xWrôeEpExGﬁomb
–
uiAbsDQp
 - 
CU_DQP_TU_CMAX
, 
CU_DQP_EG_k
 );

894 i‡–
uiAbsDQp
 > 0)

896 
UI¡
 
uiSign
 = (
iDQp
 > 0 ? 0 : 1);

897 
m_pcBöIf
->
	`ícodeBöEP
(
uiSign
);

901 
	}
}

906 
Void
 
	gTEncSbac
::
	$codeChromaQpAdju°mít
–
TComD©aCU
* 
cu
, 
UI¡
 
absP¨tIdx
 )

908 
I¡
 
öã∫ÆIdc
 = 
cu
->
	`gëChromaQpAdj
–
absP¨tIdx
 );

909 
I¡
 
chromaQpOff£tLi°Lí
 = 
cu
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°Lí
();

912 
m_pcBöIf
->
	`ícodeBö
–
öã∫ÆIdc
 > 0, 
m_ChromaQpAdjFœgSCModñ
.
	`gë
( 0, 0, 0 ) );

914 i‡(
öã∫ÆIdc
 > 0 && 
chromaQpOff£tLi°Lí
 > 1)

916 
	`xWrôeU«ryMaxSymbﬁ
–
öã∫ÆIdc
 - 1, &
m_ChromaQpAdjIdcSCModñ
.
	`gë
–0, 0, 0 ), 0, 
chromaQpOff£tLi°Lí
 - 1 );

918 
	}
}

920 
Void
 
	gTEncSbac
::
	$codeQtCbf
–
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 )

922 
TComD©aCU
* 
pcCU
 = 
rTu
.
	`gëCU
();

924 c⁄° 
UI¡
 
absP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
(
compID
);

925 c⁄° 
UI¡
 
TUDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

926 
UI¡
 
uiCtx
 = 
pcCU
->
	`gëCtxQtCbf
–
rTu
, 
	`toCh™√lTy≥
(
compID
) );

927 c⁄° 
UI¡
 
c⁄ãxtSë
 = 
	`toCh™√lTy≥
(
compID
);

929 c⁄° 
UI¡
 
width
 = 
rTu
.
	`gëRe˘
(
compID
).width;

930 c⁄° 
UI¡
 
height
 = 
rTu
.
	`gëRe˘
(
compID
).height;

931 c⁄° 
Boﬁ
 
ˇnQuadS∂ô
 = (
width
 >(
MIN_TU_SIZE
 * 2)Ë&& (
height
 >= (MIN_TU_SIZE * 2));

947 c⁄° 
UI¡
 
lowe°TUDïth
 = 
TUDïth
 + ((!
lowe°Levñ
 && !
ˇnQuadS∂ô
) ? 1 : 0);

949 i‡((
width
 !
height
Ë&& (
lowe°Levñ
 || !
ˇnQuadS∂ô
))

951 c⁄° 
UI¡
 
subTUDïth
 = 
lowe°TUDïth
 + 1;

952 c⁄° 
UI¡
 
∑πIdxesPîSubTU
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
) >> 1;

954 
UI¡
 
subTU
 = 0; subTU < 2; subTU++)

956 c⁄° 
UI¡
 
subTUAbsP¨tIdx
 = 
absP¨tIdx
 + (
subTU
 * 
∑πIdxesPîSubTU
);

957 c⁄° 
UI¡
 
uiCbf
 = 
pcCU
->
	`gëCbf
(
subTUAbsP¨tIdx
, 
compID
, 
subTUDïth
);

959 
m_pcBöIf
->
	`ícodeBö
(
uiCbf
, 
m_cCUQtCbfSCModñ
.
	`gë
(0, 
c⁄ãxtSë
, 
uiCtx
));

961 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

962 
	`DTRACE_CABAC_T
( "\tparseQtCbf()" )

963 
	`DTRACE_CABAC_T
( "\tsub-TU=" )

964 
	`DTRACE_CABAC_V
–
subTU
 )

965 
	`DTRACE_CABAC_T
( "\tsymbol=" )

966 
	`DTRACE_CABAC_V
–
uiCbf
 )

967 
	`DTRACE_CABAC_T
( "\tctx=" )

968 
	`DTRACE_CABAC_V
–
uiCtx
 )

969 
	`DTRACE_CABAC_T
( "\tetype=" )

970 
	`DTRACE_CABAC_V
–
compID
 )

971 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

972 
	`DTRACE_CABAC_V
–
subTUAbsP¨tIdx
 )

973 
	`DTRACE_CABAC_T
( "\n" )

978 c⁄° 
UI¡
 
uiCbf
 = 
pcCU
->
	`gëCbf
–
absP¨tIdx
, 
compID
, 
lowe°TUDïth
 );

979 
m_pcBöIf
->
	`ícodeBö
–
uiCbf
 , 
m_cCUQtCbfSCModñ
.
	`gë
–0, 
c⁄ãxtSë
, 
uiCtx
 ) );

982 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

983 
	`DTRACE_CABAC_T
( "\tparseQtCbf()" )

984 
	`DTRACE_CABAC_T
( "\tsymbol=" )

985 
	`DTRACE_CABAC_V
–
uiCbf
 )

986 
	`DTRACE_CABAC_T
( "\tctx=" )

987 
	`DTRACE_CABAC_V
–
uiCtx
 )

988 
	`DTRACE_CABAC_T
( "\tetype=" )

989 
	`DTRACE_CABAC_V
–
compID
 )

990 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

991 
	`DTRACE_CABAC_V
–
rTu
.
	`GëAbsP¨tIdxTU
(
compID
) )

992 
	`DTRACE_CABAC_T
( "\n" )

994 
	}
}

997 
Void
 
	gTEncSbac
::
	$codeTønsf‹mSkùFœgs
 (
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
 )

999 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

1000 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

1002 i‡(
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
))

1007 i‡(!
	`TUCompRe˘HasAssocüãdTønsf‹mSkùFœg
(
rTu
.
	`gëRe˘
(
comp⁄ít
), 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
()))

1012 
UI¡
 
u£Tønsf‹mSkù
 = 
pcCU
->
	`gëTønsf‹mSkù
–
uiAbsP¨tIdx
,
comp⁄ít
);

1013 
m_pcBöIf
->
	`ícodeBö
–
u£Tønsf‹mSkù
, 
m_cTønsf‹mSkùSCModñ
.
	`gë
–0, 
	`toCh™√lTy≥
(
comp⁄ít
), 0 ) );

1015 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

1016 
	`DTRACE_CABAC_T
("\tparseTransformSkip()");

1017 
	`DTRACE_CABAC_T
( "\tsymbol=" )

1018 
	`DTRACE_CABAC_V
–
u£Tønsf‹mSkù
 )

1019 
	`DTRACE_CABAC_T
( "\tAddr=" )

1020 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCtuRsAddr
() )

1021 
	`DTRACE_CABAC_T
( "\tetype=" )

1022 
	`DTRACE_CABAC_V
–
comp⁄ít
 )

1023 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

1024 
	`DTRACE_CABAC_V
–
rTu
.
	`GëAbsP¨tIdxTU
() )

1025 
	`DTRACE_CABAC_T
( "\n" )

1026 
	}
}

1034 
Void
 
	gTEncSbac
::
	$codeIPCMInfo
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

1036 
UI¡
 
uiIPCM
 = (
pcCU
->
	`gëIPCMFœg
(
uiAbsP¨tIdx
Ë=
åue
)? 1 : 0;

1038 
Boﬁ
 
wrôePCMSam∂eFœg
 = 
pcCU
->
	`gëIPCMFœg
(
uiAbsP¨tIdx
);

1040 
m_pcBöIf
->
	`ícodeBöTrm
 (
uiIPCM
);

1042 i‡(
wrôePCMSam∂eFœg
)

1044 
m_pcBöIf
->
	`ícodePCMAlignBôs
();

1046 c⁄° 
UI¡
 
möC€ffSizeY
 = 
pcCU
->
	`gëPic
()->
	`gëMöCUWidth
(Ë*ÖcCU->gëPic()->
	`gëMöCUHeight
();

1047 c⁄° 
UI¡
 
off£tY
 = 
möC€ffSizeY
 * 
uiAbsP¨tIdx
;

1048 
UI¡
 
ch
=0; ch < 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
(); ch++)

1050 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

1051 c⁄° 
UI¡
 
off£t
 = 
off£tY
 >> (
pcCU
->
	`gëPic
()->
	`gëComp⁄ítSˇÀX
(
compID
Ë+ÖcCU->gëPic()->
	`gëComp⁄ítSˇÀY
(compID));

1052 
Pñ
 * 
pPCMSam∂e
 = 
pcCU
->
	`gëPCMSam∂e
(
compID
Ë+ 
off£t
;

1053 c⁄° 
UI¡
 
width
 = 
pcCU
->
	`gëWidth
 (
uiAbsP¨tIdx
Ë>>ÖcCU->
	`gëPic
()->
	`gëComp⁄ítSˇÀX
(
compID
);

1054 c⁄° 
UI¡
 
height
 = 
pcCU
->
	`gëHeight
(
uiAbsP¨tIdx
Ë>>ÖcCU->
	`gëPic
()->
	`gëComp⁄ítSˇÀY
(
compID
);

1055 c⁄° 
UI¡
 
ßm∂eBôs
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPCMBôDïth
(
	`toCh™√lTy≥
(
compID
));

1056 
UI¡
 
y
=0; y<
height
; y++)

1058 
UI¡
 
x
=0; x<
width
; x++)

1060 
UI¡
 
ßm∂e
 = 
pPCMSam∂e
[
x
];

1061 
m_pcBöIf
->
	`xWrôePCMCode
(
ßm∂e
, 
ßm∂eBôs
);

1063 
pPCMSam∂e
 +
width
;

1067 
m_pcBöIf
->
	`ª£tBac
();

1069 
	}
}

1071 
Void
 
	gTEncSbac
::
	$codeQtRoŸCbf
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 )

1073 
UI¡
 
uiCbf
 = 
pcCU
->
	`gëQtRoŸCbf
–
uiAbsP¨tIdx
 );

1074 
UI¡
 
uiCtx
 = 0;

1075 
m_pcBöIf
->
	`ícodeBö
–
uiCbf
 , 
m_cCUQtRoŸCbfSCModñ
.
	`gë
–0, 0, 
uiCtx
 ) );

1076 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

1077 
	`DTRACE_CABAC_T
( "\tparseQtRootCbf()" )

1078 
	`DTRACE_CABAC_T
( "\tsymbol=" )

1079 
	`DTRACE_CABAC_V
–
uiCbf
 )

1080 
	`DTRACE_CABAC_T
( "\tctx=" )

1081 
	`DTRACE_CABAC_V
–
uiCtx
 )

1082 
	`DTRACE_CABAC_T
( "\tuiAbsPartIdx=" )

1083 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 )

1084 
	`DTRACE_CABAC_T
( "\n" )

1085 
	}
}

1087 
Void
 
	gTEncSbac
::
	$codeQtCbfZîo
–
TComTU
 & 
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 )

1091 
UI¡
 
uiCbf
 = 0;

1092 
UI¡
 
uiCtx
 = 
rTu
.
	`gëCU
()->
	`gëCtxQtCbf
–rTu, 
chTy≥
 );

1094 
m_pcBöIf
->
	`ícodeBö
–
uiCbf
 , 
m_cCUQtCbfSCModñ
.
	`gë
–0, 
chTy≥
, 
uiCtx
 ) );

1095 
	}
}

1097 
Void
 
	gTEncSbac
::
	$codeQtRoŸCbfZîo
( )

1101 
UI¡
 
uiCbf
 = 0;

1102 
UI¡
 
uiCtx
 = 0;

1103 
m_pcBöIf
->
	`ícodeBö
–
uiCbf
 , 
m_cCUQtRoŸCbfSCModñ
.
	`gë
–0, 0, 
uiCtx
 ) );

1104 
	}
}

1115 
Void
 
	gTEncSbac
::
	$codeLa°Signifiˇ¡XY
–
UI¡
 
uiPosX
, UI¡ 
uiPosY
, 
I¡
 
width
, I¡ 
height
, 
Comp⁄ítID
 
comp⁄ít
, UI¡ 
uiSˇnIdx
 )

1118 if–
uiSˇnIdx
 =
SCAN_VER
 )

1120 
	`sw≠
–
uiPosX
, 
uiPosY
 );

1121 
	`sw≠
–
width
, 
height
 );

1124 
UI¡
 
uiCtxLa°
;

1125 
UI¡
 
uiGroupIdxX
 = 
g_uiGroupIdx
[ 
uiPosX
 ];

1126 
UI¡
 
uiGroupIdxY
 = 
g_uiGroupIdx
[ 
uiPosY
 ];

1128 
C⁄ãxtModñ
 *
pCtxX
 = 
m_cCuCtxLa°X
.
	`gë
–0, 
	`toCh™√lTy≥
(
comp⁄ít
) );

1129 
C⁄ãxtModñ
 *
pCtxY
 = 
m_cCuCtxLa°Y
.
	`gë
–0, 
	`toCh™√lTy≥
(
comp⁄ít
) );

1131 
I¡
 
blkSizeOff£tX
, 
blkSizeOff£tY
, 
shi·X
, 
shi·Y
;

1132 
	`gëLa°Signifiˇ¡C⁄ãxtP¨amëîs
(
comp⁄ít
, 
width
, 
height
, 
blkSizeOff£tX
, 
blkSizeOff£tY
, 
shi·X
, 
shi·Y
);

1138  
uiCtxLa°
 = 0; uiCtxLa° < 
uiGroupIdxX
; uiCtxLast++ )

1140 
m_pcBöIf
->
	`ícodeBö
–1, *–
pCtxX
 + 
blkSizeOff£tX
 + (
uiCtxLa°
 >>
shi·X
) ) );

1142 if–
uiGroupIdxX
 < 
g_uiGroupIdx
[ 
width
 - 1 ])

1144 
m_pcBöIf
->
	`ícodeBö
–0, *–
pCtxX
 + 
blkSizeOff£tX
 + (
uiCtxLa°
 >>
shi·X
) ) );

1149  
uiCtxLa°
 = 0; uiCtxLa° < 
uiGroupIdxY
; uiCtxLast++ )

1151 
m_pcBöIf
->
	`ícodeBö
–1, *–
pCtxY
 + 
blkSizeOff£tY
 + (
uiCtxLa°
 >>
shi·Y
) ) );

1153 if–
uiGroupIdxY
 < 
g_uiGroupIdx
[ 
height
 - 1 ])

1155 
m_pcBöIf
->
	`ícodeBö
–0, *–
pCtxY
 + 
blkSizeOff£tY
 + (
uiCtxLa°
 >>
shi·Y
) ) );

1160 i‡–
uiGroupIdxX
 > 3 )

1162 
UI¡
 
uiCou¡
 = ( 
uiGroupIdxX
 - 2 ) >> 1;

1163 
uiPosX
 = uiPosX - 
g_uiMöInGroup
[ 
uiGroupIdxX
 ];

1164 
I¡
 
i
 = 
uiCou¡
 - 1 ; i >= 0; i-- )

1166 
m_pcBöIf
->
	`ícodeBöEP
––
uiPosX
 >> 
i
 ) & 1 );

1169 i‡–
uiGroupIdxY
 > 3 )

1171 
UI¡
 
uiCou¡
 = ( 
uiGroupIdxY
 - 2 ) >> 1;

1172 
uiPosY
 = uiPosY - 
g_uiMöInGroup
[ 
uiGroupIdxY
 ];

1173  
I¡
 
i
 = 
uiCou¡
 - 1 ; i >= 0; i-- )

1175 
m_pcBöIf
->
	`ícodeBöEP
––
uiPosY
 >> 
i
 ) & 1 );

1178 
	}
}

1181 
Void
 
	gTEncSbac
::
	$codeC€ffNxN
–
TComTU
 &
rTu
, 
TC€ff
* 
pcC€f
, c⁄° 
Comp⁄ítID
 
compID
 )

1183 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

1184 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
(
compID
);

1185 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
=
rTu
.
	`gëRe˘
(
compID
);

1186 c⁄° 
UI¡
 
uiWidth
=
tuRe˘
.
width
;

1187 c⁄° 
UI¡
 
uiHeight
=
tuRe˘
.
height
;

1188 c⁄° 
TComSPS
 &
•s
=*(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

1190 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ )

1191 
	`DTRACE_CABAC_T
( "\tparseCoeffNxN()\teType=" )

1192 
	`DTRACE_CABAC_V
–
compID
 )

1193 
	`DTRACE_CABAC_T
( "\twidth=" )

1194 
	`DTRACE_CABAC_V
–
uiWidth
 )

1195 
	`DTRACE_CABAC_T
( "\theight=" )

1196 
	`DTRACE_CABAC_V
–
uiHeight
 )

1197 
	`DTRACE_CABAC_T
( "\tdepth=" )

1199 
	`DTRACE_CABAC_V
–
rTu
.
	`GëTønsf‹mDïthTŸÆ
() )

1200 
	`DTRACE_CABAC_T
( "\tabspartidx=" )

1201 
	`DTRACE_CABAC_V
–
uiAbsP¨tIdx
 )

1202 
	`DTRACE_CABAC_T
( "\ttoCU-X=" )

1203 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCUPñX
() )

1204 
	`DTRACE_CABAC_T
( "\ttoCU-Y=" )

1205 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCUPñY
() )

1206 
	`DTRACE_CABAC_T
( "\tCU-addr=" )

1207 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëCtuRsAddr
() )

1208 
	`DTRACE_CABAC_T
( "\tinCU-X=" )

1210 
	`DTRACE_CABAC_V
–
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[
rTu
.
	`GëAbsP¨tIdxTU
(
compID
)] ] )

1211 
	`DTRACE_CABAC_T
( "\tinCU-Y=" )

1213 
	`DTRACE_CABAC_V
–
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[
rTu
.
	`GëAbsP¨tIdxTU
(
compID
)] ] )

1214 
	`DTRACE_CABAC_T
( "\tpredmode=" )

1215 
	`DTRACE_CABAC_V
–
pcCU
->
	`gëPªdi˘i⁄Mode
–
uiAbsP¨tIdx
 ) )

1216 
	`DTRACE_CABAC_T
( "\n" )

1220 if–
uiWidth
 > 
•s
.
	`gëMaxTrSize
() )

1222 
°d
::
˚º
 << "ERROR: codeC€ffNxN wa†∑s£dá TU wôh dimísi⁄†œrgîÅh™ÅhêmaximumáŒowed size" << std::
ídl
;

1223 
	`as£π
(
Ál£
);

1224 
	`exô
(1);

1228 
UI¡
 
uiNumSig
 = 
TEncE¡r›y
::
	`cou¡N⁄ZîoC€ffs
(
pcC€f
, 
uiWidth
 * 
uiHeight
);

1230 i‡–
uiNumSig
 == 0 )

1232 
°d
::
˚º
 << "ERROR: codeC€ffNxN cÆÀd f‹Ém±y TU!" << std::
ídl
;

1233 
	`as£π
(
Ál£
);

1234 
	`exô
(1);

1241 c⁄° 
Ch™√lTy≥
 
chTy≥
 = 
	`toCh™√lTy≥
(
compID
);

1242 c⁄° 
UI¡
 
uiLog2BlockWidth
 = 
g_aucC⁄vîtToBô
[ 
uiWidth
 ] + 2;

1243 c⁄° 
UI¡
 
uiLog2BlockHeight
 = 
g_aucC⁄vîtToBô
[ 
uiHeight
 ] + 2;

1245 c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
 = 
	`toCh™√lTy≥
(
compID
);

1246 c⁄° 
Boﬁ
 
exãndedPªcisi⁄
 = 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëExãndedPªcisi⁄Pro˚ssögFœg
();

1248 c⁄° 
Boﬁ
 
ÆignCABACBef‹eBy∑ss
 = 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëCabacBy∑ssAlignmítE«bÀdFœg
();

1249 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 = 
•s
.
	`gëMaxLog2TrDy«micR™ge
(
ch™√lTy≥
);

1251 
Boﬁ
 
beVÆid
;

1254 
I¡
 
uiI¡øMode
 = -1;

1255 c⁄° 
Boﬁ
 
bIsLuma
 = 
	`isLuma
(
compID
);

1256 
I¡
 
isI¡ø
 = 
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
) ? 1 : 0;

1257 i‡–
isI¡ø
 )

1259 
uiI¡øMode
 = 
pcCU
->
	`gëI¡øDú
–
	`toCh™√lTy≥
(
compID
), 
uiAbsP¨tIdx
 );

1261 c⁄° 
UI¡
 
∑πsPîMöCU
 = 1<<(2*(
•s
.
	`gëMaxTŸÆCUDïth
(Ë- sps.
	`gëLog2DiffMaxMöCodögBlockSize
()));

1262 
uiI¡øMode
 = (uiI¡øMode==
DM_CHROMA_IDX
 && !
bIsLuma
Ë? 
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
	`gëChromasC‹ª•⁄dögPULumaIdx
(
uiAbsP¨tIdx
, 
rTu
.
	`GëChromaF‹m©
(), 
∑πsPîMöCU
)) : uiIntraMode;

1263 
uiI¡øMode
 = ((
rTu
.
	`GëChromaF‹m©
(Ë=
CHROMA_422
Ë&& !
bIsLuma
Ë? 
g_chroma422I¡øAngÀM≠pögTabÀ
[uiIntraMode] : uiIntraMode;

1266 
I¡
 
å™sf‹mSkù
 = 
pcCU
->
	`gëTønsf‹mSkù
–
uiAbsP¨tIdx
,
compID
) ? 1 : 0;

1267 
Boﬁ
 
rdpcm_lossy
 = ( 
å™sf‹mSkù
 && 
isI¡ø
 && ( (
uiI¡øMode
 =
HOR_IDX
Ë|| (uiI¡øModê=
VER_IDX
ËËË&& 
pcCU
->
	`isRDPCME«bÀd
(
uiAbsP¨tIdx
);

1269 i‡–(
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiAbsP¨tIdx
)Ë|| 
rdpcm_lossy
 )

1271 
beVÆid
 = 
Ál£
;

1272 i‡–(!
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
)Ë&&ÖcCU->
	`isRDPCME«bÀd
(uiAbsPartIdx))

1274 
	`codeEx∂icôRdpcmMode
–
rTu
, 
compID
);

1279 
beVÆid
 = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëSignD©aHidögE«bÀdFœg
();

1285 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£Tønsf‹mSkù
())

1287 
	`codeTønsf‹mSkùFœgs
(
rTu
, 
compID
);

1288 if(
pcCU
->
	`gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
Ë&& !pcCU->
	`isI¡ø
(uiAbsP¨tIdxË&&ÖcCU->
	`isRDPCME«bÀd
(uiAbsPartIdx))

1291 
	`codeEx∂icôRdpcmMode
–
rTu
, 
compID
);

1293 if(
pcCU
->
	`gëEx∂icôRdpcmMode
(
compID
, 
uiAbsP¨tIdx
Ë!
RDPCM_OFF
)

1296 
beVÆid
 = 
Ál£
;

1303 c⁄° 
Boﬁ
 
bU£GﬁombRi˚P¨amëîAd≠èti⁄
 = 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
();

1304 
UI¡
 &
cuºítGﬁombRi˚Sèti°ic
 = 
m_gﬁombRi˚Ad≠èti⁄Sèti°ics
[
rTu
.
	`gëGﬁombRi˚Sèti°icsIndex
(
compID
)];

1307 
TUE¡r›yCodögP¨amëîs
 
codögP¨amëîs
;

1308 
	`gëTUE¡r›yCodögP¨amëîs
(
codögP¨amëîs
, 
rTu
, 
compID
);

1313 
I¡
 
sˇnPosLa°
 = -1;

1314 
I¡
 
posLa°
;

1317 
UI¡
 
uiSigC€ffGroupFœg
[ 
MLS_GRP_NUM
 ];

1319 
	`mem£t
–
uiSigC€ffGroupFœg
, 0, (
UI¡
Ë* 
MLS_GRP_NUM
 );

1322 
posLa°
 = 
codögP¨amëîs
.
sˇn
[ ++
sˇnPosLa°
 ];

1324 if–
pcC€f
[ 
posLa°
 ] != 0 )

1327 
UI¡
 
uiPosY
 = 
posLa°
 >> 
uiLog2BlockWidth
;

1328 
UI¡
 
uiPosX
 = 
posLa°
 - ( 
uiPosY
 << 
uiLog2BlockWidth
 );

1330 
UI¡
 
uiBlkIdx
 = (
codögP¨amëîs
.
widthInGroups
 * (
uiPosY
 >> 
MLS_CG_LOG2_HEIGHT
)Ë+ (
uiPosX
 >> 
MLS_CG_LOG2_WIDTH
);

1331 
uiSigC€ffGroupFœg
[ 
uiBlkIdx
 ] = 1;

1333 
uiNumSig
--;

1335 }  
uiNumSig
 > 0 );

1338 
I¡
 
posLa°Y
 = 
posLa°
 >> 
uiLog2BlockWidth
;

1339 
I¡
 
posLa°X
 = 
posLa°
 - ( 
posLa°Y
 << 
uiLog2BlockWidth
 );

1340 
	`codeLa°Signifiˇ¡XY
(
posLa°X
, 
posLa°Y
, 
uiWidth
, 
uiHeight
, 
compID
, 
codögP¨amëîs
.
sˇnTy≥
);

1343 
C⁄ãxtModñ
 * c⁄° 
ba£C€ffGroupCtx
 = 
m_cCUSigC€ffGroupSCModñ
.
	`gë
–0, 
chTy≥
 );

1344 
C⁄ãxtModñ
 * c⁄° 
ba£Ctx
 = 
m_cCUSigSCModñ
.
	`gë
–0, 0 ) + 
	`gëSignifiˇn˚M≠C⁄ãxtOff£t
(
compID
);

1346 c⁄° 
I¡
 
iLa°SˇnSë
 = 
sˇnPosLa°
 >> 
MLS_CG_SIZE
;

1348 
UI¡
 
c1
 = 1;

1349 
UI¡
 
uiGoRi˚P¨am
 = 0;

1350 
I¡
 
iSˇnPosSig
 = 
sˇnPosLa°
;

1352  
I¡
 
iSubSë
 = 
iLa°SˇnSë
; iSubSet >= 0; iSubSet-- )

1354 
I¡
 
numN⁄Zîo
 = 0;

1355 
I¡
 
iSubPos
 = 
iSubSë
 << 
MLS_CG_SIZE
;

1356 
uiGoRi˚P¨am
 = 
cuºítGﬁombRi˚Sèti°ic
 / 
RExt__GOLOMB_RICE_INCREMENT_DIVISOR
;

1357 
Boﬁ
 
upd©eGﬁombRi˚Sèti°ics
 = 
bU£GﬁombRi˚P¨amëîAd≠èti⁄
;

1358 
UI¡
 
c€ffSigns
 = 0;

1360 
I¡
 
absC€ff
[1 << 
MLS_CG_SIZE
];

1362 
I¡
 
œ°NZPosInCG
 = -1;

1363 
I¡
 
fú°NZPosInCG
 = 1 << 
MLS_CG_SIZE
;

1365 
Boﬁ
 
esˇ≥D©aPª£¡InGroup
 = 
Ál£
;

1367 if–
iSˇnPosSig
 =
sˇnPosLa°
 )

1369 
absC€ff
[ 0 ] = 
	`I¡
(
	`abs
–
pcC€f
[ 
posLa°
 ] ));

1370 
c€ffSigns
 = ( 
pcC€f
[ 
posLa°
 ] < 0 );

1371 
numN⁄Zîo
 = 1;

1372 
œ°NZPosInCG
 = 
iSˇnPosSig
;

1373 
fú°NZPosInCG
 = 
iSˇnPosSig
;

1374 
iSˇnPosSig
--;

1378 
I¡
 
iCGBlkPos
 = 
codögP¨amëîs
.
sˇnCG
[ 
iSubSë
 ];

1379 
I¡
 
iCGPosY
 = 
iCGBlkPos
 / 
codögP¨amëîs
.
widthInGroups
;

1380 
I¡
 
iCGPosX
 = 
iCGBlkPos
 - (
iCGPosY
 * 
codögP¨amëîs
.
widthInGroups
);

1382 if–
iSubSë
 =
iLa°SˇnSë
 || iSubSet == 0)

1384 
uiSigC€ffGroupFœg
[ 
iCGBlkPos
 ] = 1;

1388 
UI¡
 
uiSigC€ffGroup
 = (
uiSigC€ffGroupFœg
[ 
iCGBlkPos
 ] != 0);

1389 
UI¡
 
uiCtxSig
 = 
TComTrQu™t
::
	`gëSigC€ffGroupCtxInc
–
uiSigC€ffGroupFœg
, 
iCGPosX
, 
iCGPosY
, 
codögP¨amëîs
.
widthInGroups
, codögP¨amëîs.
heightInGroups
 );

1390 
m_pcBöIf
->
	`ícodeBö
–
uiSigC€ffGroup
, 
ba£C€ffGroupCtx
[ 
uiCtxSig
 ] );

1394 if–
uiSigC€ffGroupFœg
[ 
iCGBlkPos
 ] )

1396 c⁄° 
I¡
 
∑âînSigCtx
 = 
TComTrQu™t
::
	`ˇlcP©ã∫SigCtx
(
uiSigC€ffGroupFœg
, 
iCGPosX
, 
iCGPosY
, 
codögP¨amëîs
.
widthInGroups
, codögP¨amëîs.
heightInGroups
);

1398 
UI¡
 
uiBlkPos
, 
uiSig
, 
uiCtxSig
;

1399  ; 
iSˇnPosSig
 >
iSubPos
; iScanPosSig-- )

1401 
uiBlkPos
 = 
codögP¨amëîs
.
sˇn
[ 
iSˇnPosSig
 ];

1402 
uiSig
 = (
pcC€f
[ 
uiBlkPos
 ] != 0);

1403 if–
iSˇnPosSig
 > 
iSubPos
 || 
iSubSë
 =0 || 
numN⁄Zîo
 )

1405 
uiCtxSig
 = 
TComTrQu™t
::
	`gëSigCtxInc
–
∑âînSigCtx
, 
codögP¨amëîs
, 
iSˇnPosSig
, 
uiLog2BlockWidth
, 
uiLog2BlockHeight
, 
chTy≥
 );

1406 
m_pcBöIf
->
	`ícodeBö
–
uiSig
, 
ba£Ctx
[ 
uiCtxSig
 ] );

1408 if–
uiSig
 )

1410 
absC€ff
[ 
numN⁄Zîo
 ] = 
	`I¡
(
	`abs
–
pcC€f
[ 
uiBlkPos
 ] ));

1411 
c€ffSigns
 = 2 * c€ffSign†+ ( 
pcC€f
[ 
uiBlkPos
 ] < 0 );

1412 
numN⁄Zîo
++;

1413 if–
œ°NZPosInCG
 == -1 )

1415 
œ°NZPosInCG
 = 
iSˇnPosSig
;

1417 
fú°NZPosInCG
 = 
iSˇnPosSig
;

1423 
iSˇnPosSig
 = 
iSubPos
 - 1;

1426 if–
numN⁄Zîo
 > 0 )

1428 
Boﬁ
 
signHiddí
 = ( 
œ°NZPosInCG
 - 
fú°NZPosInCG
 >
SBH_THRESHOLD
 );

1430 c⁄° 
UI¡
 
uiCtxSë
 = 
	`gëC⁄ãxtSëIndex
(
compID
, 
iSubSë
, (
c1
 == 0));

1431 
c1
 = 1;

1433 
C⁄ãxtModñ
 *
ba£CtxMod
 = 
m_cCUO√SCModñ
.
	`gë
–0, 0 ) + (
NUM_ONE_FLAG_CTX_PER_SET
 * 
uiCtxSë
);

1435 
I¡
 
numC1Fœg
 = 
	`mö
(
numN⁄Zîo
, 
C1FLAG_NUMBER
);

1436 
I¡
 
fú°C2FœgIdx
 = -1;

1437  
I¡
 
idx
 = 0; idx < 
numC1Fœg
; idx++ )

1439 
UI¡
 
uiSymbﬁ
 = 
absC€ff
[ 
idx
 ] > 1;

1440 
m_pcBöIf
->
	`ícodeBö
–
uiSymbﬁ
, 
ba£CtxMod
[
c1
] );

1441 if–
uiSymbﬁ
 )

1443 
c1
 = 0;

1445 i‡(
fú°C2FœgIdx
 == -1)

1447 
fú°C2FœgIdx
 = 
idx
;

1451 
esˇ≥D©aPª£¡InGroup
 = 
åue
;

1454 if–(
c1
 < 3) && (c1 > 0) )

1456 
c1
++;

1460 i‡(
c1
 == 0)

1462 
ba£CtxMod
 = 
m_cCUAbsSCModñ
.
	`gë
–0, 0 ) + (
NUM_ABS_FLAG_CTX_PER_SET
 * 
uiCtxSë
);

1463 i‡–
fú°C2FœgIdx
 != -1)

1465 
UI¡
 
symbﬁ
 = 
absC€ff
[ 
fú°C2FœgIdx
 ] > 2;

1466 
m_pcBöIf
->
	`ícodeBö
–
symbﬁ
, 
ba£CtxMod
[0] );

1467 i‡(
symbﬁ
 != 0)

1469 
esˇ≥D©aPª£¡InGroup
 = 
åue
;

1474 
esˇ≥D©aPª£¡InGroup
 =Ésˇ≥D©aPª£¡InGrou∞|| (
numN⁄Zîo
 > 
C1FLAG_NUMBER
);

1476 i‡(
esˇ≥D©aPª£¡InGroup
 && 
ÆignCABACBef‹eBy∑ss
)

1478 
m_pcBöIf
->
	`Æign
();

1481 if–
beVÆid
 && 
signHiddí
 )

1483 
m_pcBöIf
->
	`ícodeBösEP
–(
c€ffSigns
 >> 1), 
numN⁄Zîo
-1 );

1487 
m_pcBöIf
->
	`ícodeBösEP
–
c€ffSigns
, 
numN⁄Zîo
 );

1490 
I¡
 
iFú°C€ff2
 = 1;

1491 i‡(
esˇ≥D©aPª£¡InGroup
)

1493  
I¡
 
idx
 = 0; idx < 
numN⁄Zîo
; idx++ )

1495 
UI¡
 
ba£Levñ
 = (
idx
 < 
C1FLAG_NUMBER
)? (2 + 
iFú°C€ff2
 ) : 1;

1497 if–
absC€ff
[ 
idx
 ] >
ba£Levñ
)

1499 c⁄° 
UI¡
 
esˇ≥CodeVÆue
 = 
absC€ff
[
idx
] - 
ba£Levñ
;

1501 
	`xWrôeC€fRemaöExGﬁomb
–
esˇ≥CodeVÆue
, 
uiGoRi˚P¨am
, 
exãndedPªcisi⁄
, 
maxLog2TrDy«micR™ge
 );

1503 i‡(
absC€ff
[
idx
] > (3 << 
uiGoRi˚P¨am
))

1505 
uiGoRi˚P¨am
 = 
bU£GﬁombRi˚P¨amëîAd≠èti⁄
 ? (uiGoRi˚P¨am + 1Ë: (
°d
::
mö
<
UI¡
>((uiGoRiceParam + 1), 4));

1508 i‡(
upd©eGﬁombRi˚Sèti°ics
)

1510 c⁄° 
UI¡
 
öôülGﬁombRi˚P¨amëî
 = 
cuºítGﬁombRi˚Sèti°ic
 / 
RExt__GOLOMB_RICE_INCREMENT_DIVISOR
;

1512 i‡(
esˇ≥CodeVÆue
 >(3 << 
öôülGﬁombRi˚P¨amëî
))

1514 
cuºítGﬁombRi˚Sèti°ic
++;

1516 i‡(((
esˇ≥CodeVÆue
 * 2Ë< (1 << 
öôülGﬁombRi˚P¨amëî
)Ë&& (
cuºítGﬁombRi˚Sèti°ic
 > 0))

1518 
cuºítGﬁombRi˚Sèti°ic
--;

1521 
upd©eGﬁombRi˚Sèti°ics
 = 
Ál£
;

1525 if(
absC€ff
[ 
idx
 ] >= 2)

1527 
iFú°C€ff2
 = 0;

1533 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


1534 
	`¥ötSBACC€ffD©a
(
posLa°X
, 
posLa°Y
, 
uiWidth
, 
uiHeight
, 
compID
, 
uiAbsP¨tIdx
, 
codögP¨amëîs
.
sˇnTy≥
, 
pcC€f
, 
pcCU
->
	`gëSli˚
()->
	`gëFöÆized
());

1538 
	}
}

1543 
Void
 
	gTEncSbac
::
	$codeSAOSign
–
UI¡
 
code
 )

1545 
m_pcBöIf
->
	`ícodeBöEP
–
code
 );

1546 
	}
}

1548 
Void
 
	gTEncSbac
::
	$codeSaoMaxUvlc
 ( 
UI¡
 
code
, UI¡ 
maxSymbﬁ
 )

1550 i‡(
maxSymbﬁ
 == 0)

1555 
I¡
 
i
;

1556 
Boﬁ
 
bCodeLa°
 = ( 
maxSymbﬁ
 > 
code
 );

1558 i‡–
code
 == 0 )

1560 
m_pcBöIf
->
	`ícodeBöEP
( 0 );

1564 
m_pcBöIf
->
	`ícodeBöEP
( 1 );

1565  
i
=0; i<
code
-1; i++ )

1567 
m_pcBöIf
->
	`ícodeBöEP
( 1 );

1569 if–
bCodeLa°
 )

1571 
m_pcBöIf
->
	`ícodeBöEP
( 0 );

1574 
	}
}

1578 
Void
 
	gTEncSbac
::
	$codeSaoUÊc
 ( 
UI¡
 
uiLígth
, UI¡ 
uiCode
 )

1580 
m_pcBöIf
->
	`ícodeBösEP
 ( 
uiCode
, 
uiLígth
 );

1581 
	}
}

1585 
Void
 
	gTEncSbac
::
	$codeSaoMîge
 ( 
UI¡
 
uiCode
 )

1587 
m_pcBöIf
->
	`ícodeBö
(((
uiCode
 =0Ë? 0 : 1), 
m_cSaoMîgeSCModñ
.
	`gë
( 0, 0, 0 ));

1588 
	}
}

1592 
Void
 
	gTEncSbac
::
	$codeSaoTy≥Idx
 ( 
UI¡
 
uiCode
)

1594 i‡(
uiCode
 == 0)

1596 
m_pcBöIf
->
	`ícodeBö
–0, 
m_cSaoTy≥IdxSCModñ
.
	`gë
( 0, 0, 0 ) );

1600 
m_pcBöIf
->
	`ícodeBö
–1, 
m_cSaoTy≥IdxSCModñ
.
	`gë
( 0, 0, 0 ) );

1601 
m_pcBöIf
->
	`ícodeBöEP
–
uiCode
 == 1 ? 0 : 1 );

1603 
	}
}

1605 
Void
 
	gTEncSbac
::
	$codeSAOOff£tP¨am
(
Comp⁄ítID
 
compIdx
, 
SAOOff£t
& 
˘bP¨am
, 
Boﬁ
 
¶i˚E«bÀd
, c⁄° 
I¡
 
ch™√lBôDïth
)

1607 
UI¡
 
uiSymbﬁ
;

1608 if(!
¶i˚E«bÀd
)

1610 
	`as£π
(
˘bP¨am
.
modeIdc
 =
SAO_MODE_OFF
);

1613 c⁄° 
Boﬁ
 
bIsFú°CompOfChTy≥
 = (
	`gëFú°Comp⁄ítOfCh™√l
(
	`toCh™√lTy≥
(
compIdx
)) == compIdx);

1616 if(
bIsFú°CompOfChTy≥
)

1619 if(
˘bP¨am
.
modeIdc
 =
SAO_MODE_OFF
)

1621 
uiSymbﬁ
 =0;

1623 if(
˘bP¨am
.
ty≥Idc
 =
SAO_TYPE_BO
)

1625 
uiSymbﬁ
 = 1;

1629 
	`as£π
(
˘bP¨am
.
ty≥Idc
 < 
SAO_TYPE_START_BO
);

1630 
uiSymbﬁ
 = 2;

1632 
	`codeSaoTy≥Idx
(
uiSymbﬁ
);

1635 if(
˘bP¨am
.
modeIdc
 =
SAO_MODE_NEW
)

1637 
I¡
 
numCœs£s
 = (
˘bP¨am
.
ty≥Idc
 =
SAO_TYPE_BO
)?4:
NUM_SAO_EO_CLASSES
;

1638 
I¡
 
off£t
[4];

1639 
I¡
 
k
=0;

1640 
I¡
 
i
=0; i< 
numCœs£s
; i++)

1642 if(
˘bP¨am
.
ty≥Idc
 !
SAO_TYPE_BO
 && 
i
 =
SAO_CLASS_EO_PLAIN
)

1646 
I¡
 
˛assIdx
 = (
˘bP¨am
.
ty≥Idc
 =
SAO_TYPE_BO
)?–(˘bP¨am.
ty≥AuxInfo
+
i
)% 
NUM_SAO_BO_CLASSES
 ):i;

1647 
off£t
[
k
] = 
˘bP¨am
.off£t[
˛assIdx
];

1648 
k
++;

1651 c⁄° 
I¡
 
maxOff£tQVÆ
 = 
TComSam∂eAd≠tiveOff£t
::
	`gëMaxOff£tQVÆ
(
ch™√lBôDïth
);

1652 
I¡
 
i
=0; i< 4; i++)

1654 
	`codeSaoMaxUvlc
((
off£t
[
i
]<0)?(-off£t[i]):(off£t[i]), 
maxOff£tQVÆ
 );

1658 if(
˘bP¨am
.
ty≥Idc
 =
SAO_TYPE_BO
)

1660 
I¡
 
i
=0; i< 4; i++)

1662 if(
off£t
[
i
] != 0)

1664 
	`codeSAOSign
((
off£t
[
i
]< 0)?1:0);

1668 
	`codeSaoUÊc
(
NUM_SAO_BO_CLASSES_LOG2
, 
˘bP¨am
.
ty≥AuxInfo
 );

1672 if(
bIsFú°CompOfChTy≥
)

1674 
	`as£π
(
˘bP¨am
.
ty≥Idc
 - 
SAO_TYPE_START_EO
 >=0);

1675 
	`codeSaoUÊc
(
NUM_SAO_EO_TYPES_LOG2
, 
˘bP¨am
.
ty≥Idc
 - 
SAO_TYPE_START_EO
 );

1680 
	}
}

1683 
Void
 
	gTEncSbac
::
	$codeSAOBlkP¨am
(
SAOBlkP¨am
& 
ßoBlkP¨am
, c⁄° 
BôDïths
 &
bôDïths


1684 , 
Boﬁ
* 
¶i˚E«bÀd


1685 , 
Boﬁ
 
À·MîgeAvaû


1686 , 
Boﬁ
 
aboveMîgeAvaû


1687 , 
Boﬁ
 
⁄lyE°MîgeInfo


1691 
Boﬁ
 
isLe·Mîge
 = 
Ál£
;

1692 
Boﬁ
 
isAboveMîge

Ál£
;

1694 if(
À·MîgeAvaû
)

1696 
isLe·Mîge
 = ((
ßoBlkP¨am
[
COMPONENT_Y
].
modeIdc
 =
SAO_MODE_MERGE
Ë&& (ßoBlkP¨am[COMPONENT_Y].
ty≥Idc
 =
SAO_MERGE_LEFT
));

1697 
	`codeSaoMîge
–
isLe·Mîge
?1:0 );

1700 if–
aboveMîgeAvaû
 && !
isLe·Mîge
)

1702 
isAboveMîge
 = ((
ßoBlkP¨am
[
COMPONENT_Y
].
modeIdc
 =
SAO_MODE_MERGE
Ë&& (ßoBlkP¨am[COMPONENT_Y].
ty≥Idc
 =
SAO_MERGE_ABOVE
));

1703 
	`codeSaoMîge
–
isAboveMîge
?1:0 );

1706 if(
⁄lyE°MîgeInfo
)

1711 if(!
isLe·Mîge
 && !
isAboveMîge
)

1713 
I¡
 
compIdx
=0; compIdx < 
MAX_NUM_COMPONENT
; compIdx++)

1715 
	`codeSAOOff£tP¨am
(
	`Comp⁄ítID
(
compIdx
), 
ßoBlkP¨am
[compIdx], 
¶i˚E«bÀd
[compIdx], 
bôDïths
.
ªc⁄
[
	`toCh™√lTy≥
(ComponentID(compIdx))]);

1718 
	}
}

1726 
Void
 
	gTEncSbac
::
	$e°Bô
–
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
 )

1728 
	`e°CBFBô
–
pcE°BôsSbac
 );

1730 
	`e°Signifiˇ¡C€ffGroupM≠Bô
–
pcE°BôsSbac
, 
chTy≥
 );

1733 
	`e°Signifiˇ¡M≠Bô
–
pcE°BôsSbac
, 
width
, 
height
, 
chTy≥
 );

1736 
	`e°La°Signifiˇ¡Posôi⁄Bô
–
pcE°BôsSbac
, 
width
, 
height
, 
chTy≥
, 
sˇnTy≥
 );

1739 
	`e°Signifiˇ¡C€fficõ¡sBô
–
pcE°BôsSbac
, 
chTy≥
 );

1741 
	`mem˝y
(
pcE°BôsSbac
->
gﬁombRi˚Ad≠èti⁄Sèti°ics
, 
m_gﬁombRi˚Ad≠èti⁄Sèti°ics
, ((
UI¡
Ë* 
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
));

1742 
	}
}

1750 
Void
 
	gTEncSbac
::
	$e°CBFBô
–
e°BôsSbacSåu˘
* 
pcE°BôsSbac
 )

1752 
C⁄ãxtModñ
 *
pCtx
 = 
m_cCUQtCbfSCModñ
.
	`gë
( 0 );

1754  
UI¡
 
uiCtxInc
 = 0; uiCtxIn¯< (
NUM_QT_CBF_CTX_SETS
 * 
NUM_QT_CBF_CTX_PER_SET
); uiCtxInc++ )

1756 
pcE°BôsSbac
->
blockCbpBôs
[ 
uiCtxInc
 ][ 0 ] = 
pCtx
[ uiCtxIn¯].
	`gëE¡r›yBôs
( 0 );

1757 
pcE°BôsSbac
->
blockCbpBôs
[ 
uiCtxInc
 ][ 1 ] = 
pCtx
[ uiCtxIn¯].
	`gëE¡r›yBôs
( 1 );

1760 
pCtx
 = 
m_cCUQtRoŸCbfSCModñ
.
	`gë
( 0 );

1762  
UI¡
 
uiCtxInc
 = 0; uiCtxInc < 4; uiCtxInc++ )

1764 
pcE°BôsSbac
->
blockRoŸCbpBôs
[ 
uiCtxInc
 ][ 0 ] = 
pCtx
[ uiCtxIn¯].
	`gëE¡r›yBôs
( 0 );

1765 
pcE°BôsSbac
->
blockRoŸCbpBôs
[ 
uiCtxInc
 ][ 1 ] = 
pCtx
[ uiCtxIn¯].
	`gëE¡r›yBôs
( 1 );

1767 
	}
}

1776 
Void
 
	gTEncSbac
::
	$e°Signifiˇ¡C€ffGroupM≠Bô
–
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
Ch™√lTy≥
 
chTy≥
 )

1778 
I¡
 
fú°Ctx
 = 0, 
numCtx
 = 
NUM_SIG_CG_FLAG_CTX
;

1780  
I¡
 
˘xIdx
 = 
fú°Ctx
; ctxIdx < fú°Ctx + 
numCtx
; ctxIdx++ )

1782  
UI¡
 
uiBö
 = 0; uiBin < 2; uiBin++ )

1784 
pcE°BôsSbac
->
signifiˇ¡C€ffGroupBôs
[ 
˘xIdx
 ][ 
uiBö
 ] = 
m_cCUSigC€ffGroupSCModñ
.
	`gë
–0, 
chTy≥
, ctxIdx ).
	`gëE¡r›yBôs
( uiBin );

1787 
	}
}

1796 
Void
 
	gTEncSbac
::
	$e°Signifiˇ¡M≠Bô
–
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
 )

1802 c⁄° 
UI¡
 
fú°Comp⁄ít
 = ((
	`isLuma
(
chTy≥
)Ë? (
COMPONENT_Y
Ë: (
COMPONENT_Cb
));

1803 c⁄° 
UI¡
 
œ°Comp⁄ít
 = ((
	`isLuma
(
chTy≥
)Ë? (
COMPONENT_Y
Ë: (
COMPONENT_Cb
));

1807 
I¡
 
fú°Ctx
 = 
MAX_INT
;

1808 
I¡
 
numCtx
 = 
MAX_INT
;

1810 i‡((
width
 =4Ë&& (
height
 == 4))

1812 
fú°Ctx
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
chTy≥
][
CONTEXT_TYPE_4x4
];

1813 
numCtx
 = 
signifiˇn˚M≠C⁄ãxtSëSize
 [
chTy≥
][
CONTEXT_TYPE_4x4
];

1815 i‡((
width
 =8Ë&& (
height
 == 8))

1817 
fú°Ctx
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
chTy≥
][
CONTEXT_TYPE_8x8
];

1818 
numCtx
 = 
signifiˇn˚M≠C⁄ãxtSëSize
 [
chTy≥
][
CONTEXT_TYPE_8x8
];

1822 
fú°Ctx
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
chTy≥
][
CONTEXT_TYPE_NxN
];

1823 
numCtx
 = 
signifiˇn˚M≠C⁄ãxtSëSize
 [
chTy≥
][
CONTEXT_TYPE_NxN
];

1830 
UI¡
 
comp⁄ít
 = 
fú°Comp⁄ít
; comp⁄íà<
œ°Comp⁄ít
; component++)

1832 c⁄° 
UI¡
 
c⁄ãxtOff£t
 = 
	`gëSignifiˇn˚M≠C⁄ãxtOff£t
(
	`Comp⁄ítID
(
comp⁄ít
));

1834 i‡(
fú°Ctx
 > 0)

1836  
UI¡
 
bö
 = 0; bin < 2; bin++ )

1838 
pcE°BôsSbac
->
signifiˇ¡Bôs
[ 
c⁄ãxtOff£t
 ][ 
bö
 ] = 
m_cCUSigSCModñ
.
	`gë
–0, 0, c⁄ãxtOff£à).
	`gëE¡r›yBôs
( bin );

1844  
UI¡
 
bö
 = 0; bin < 2; bin++ )

1846 c⁄° 
I¡
 
˘xIdx
 = 
signifiˇn˚M≠C⁄ãxtSëSèπ
[
chTy≥
][
CONTEXT_TYPE_SINGLE
];

1847 
pcE°BôsSbac
->
signifiˇ¡Bôs
[ 
c⁄ãxtOff£t
 + 
˘xIdx
 ][ 
bö
 ] = 
m_cCUSigSCModñ
.
	`gë
–0, 0, (c⁄ãxtOff£à+ ctxIdxË).
	`gëE¡r›yBôs
( bin );

1850  
I¡
 
˘xIdx
 = 
fú°Ctx
; ctxIdx < fú°Ctx + 
numCtx
; ctxIdx++ )

1852  
UI¡
 
uiBö
 = 0; uiBin < 2; uiBin++ )

1854 
pcE°BôsSbac
->
signifiˇ¡Bôs
[ 
c⁄ãxtOff£t
 + 
˘xIdx
 ][ 
uiBö
 ] = 
m_cCUSigSCModñ
.
	`gë
–0, 0, (c⁄ãxtOff£à+ ctxIdxË).
	`gëE¡r›yBôs
( uiBin );

1860 
	}
}

1870 
Void
 
	gTEncSbac
::
	$e°La°Signifiˇ¡Posôi⁄Bô
–
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
 )

1872 i‡(
sˇnTy≥
 =
SCAN_VER
)

1874 
	`sw≠
(
width
, 
height
);

1881 c⁄° 
UI¡
 
fú°Comp⁄ít
 = ((
	`isLuma
(
chTy≥
)Ë? (
COMPONENT_Y
Ë: (
COMPONENT_Cb
));

1882 c⁄° 
UI¡
 
œ°Comp⁄ít
 = ((
	`isLuma
(
chTy≥
)Ë? (
COMPONENT_Y
Ë: (
COMPONENT_Cb
));

1888 
UI¡
 
comp⁄ítIndex
 = 
fú°Comp⁄ít
; comp⁄ítIndex <
œ°Comp⁄ít
; componentIndex++)

1890 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

1892 
I¡
 
iBôsX
 = 0, 
iBôsY
 = 0;

1894 
I¡
 
blkSizeOff£tX
, 
blkSizeOff£tY
, 
shi·X
, 
shi·Y
;

1895 
	`gëLa°Signifiˇ¡C⁄ãxtP¨amëîs
(
	`Comp⁄ítID
(
comp⁄ít
), 
width
, 
height
, 
blkSizeOff£tX
, 
blkSizeOff£tY
, 
shi·X
, 
shi·Y
);

1897 
I¡
 
˘x
;

1899 c⁄° 
Ch™√lTy≥
 
ch™√lTy≥
 = 
	`toCh™√lTy≥
(
	`Comp⁄ítID
(
comp⁄ít
));

1901 
C⁄ãxtModñ
 *c⁄° 
pCtxX
 = 
m_cCuCtxLa°X
.
	`gë
–0, 
ch™√lTy≥
 );

1902 
C⁄ãxtModñ
 *c⁄° 
pCtxY
 = 
m_cCuCtxLa°Y
.
	`gë
–0, 
ch™√lTy≥
 );

1903 
I¡
 *c⁄° 
œ°XBôsAºay
 = 
pcE°BôsSbac
->
œ°XBôs
[
ch™√lTy≥
];

1904 
I¡
 *c⁄° 
œ°YBôsAºay
 = 
pcE°BôsSbac
->
œ°YBôs
[
ch™√lTy≥
];

1910 
˘x
 = 0; ctx < 
g_uiGroupIdx
[ 
width
 - 1 ]; ctx++)

1912 
I¡
 
˘xOff£t
 = 
blkSizeOff£tX
 + (
˘x
 >>
shi·X
);

1913 
œ°XBôsAºay
[ 
˘x
 ] = 
iBôsX
 + 
pCtxX
[ 
˘xOff£t
 ].
	`gëE¡r›yBôs
( 0 );

1914 
iBôsX
 +
pCtxX
[ 
˘xOff£t
 ].
	`gëE¡r›yBôs
( 1 );

1917 
œ°XBôsAºay
[
˘x
] = 
iBôsX
;

1923 
˘x
 = 0; ctx < 
g_uiGroupIdx
[ 
height
 - 1 ]; ctx++)

1925 
I¡
 
˘xOff£t
 = 
blkSizeOff£tY
 + (
˘x
 >>
shi·Y
);

1926 
œ°YBôsAºay
[ 
˘x
 ] = 
iBôsY
 + 
pCtxY
[ 
˘xOff£t
 ].
	`gëE¡r›yBôs
( 0 );

1927 
iBôsY
 +
pCtxY
[ 
˘xOff£t
 ].
	`gëE¡r›yBôs
( 1 );

1930 
œ°YBôsAºay
[
˘x
] = 
iBôsY
;

1935 
	}
}

1944 
Void
 
	gTEncSbac
::
	$e°Signifiˇ¡C€fficõ¡sBô
–
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
Ch™√lTy≥
 
chTy≥
 )

1946 
C⁄ãxtModñ
 *
˘xO√
 = 
m_cCUO√SCModñ
.
	`gë
(0, 0);

1947 
C⁄ãxtModñ
 *
˘xAbs
 = 
m_cCUAbsSCModñ
.
	`gë
(0, 0);

1949 c⁄° 
UI¡
 
⁄eSèπIndex
 = ((
	`isLuma
(
chTy≥
)Ë? (0Ë: (
NUM_ONE_FLAG_CTX_LUMA
));

1950 c⁄° 
UI¡
 
⁄eSt›Index
 = ((
	`isLuma
(
chTy≥
)Ë? (
NUM_ONE_FLAG_CTX_LUMA
Ë: (
NUM_ONE_FLAG_CTX
));

1951 c⁄° 
UI¡
 
absSèπIndex
 = ((
	`isLuma
(
chTy≥
)Ë? (0Ë: (
NUM_ABS_FLAG_CTX_LUMA
));

1952 c⁄° 
UI¡
 
absSt›Index
 = ((
	`isLuma
(
chTy≥
)Ë? (
NUM_ABS_FLAG_CTX_LUMA
Ë: (
NUM_ABS_FLAG_CTX
));

1954 
I¡
 
˘xIdx
 = 
⁄eSèπIndex
; ctxIdx < 
⁄eSt›Index
; ctxIdx++)

1956 
pcE°BôsSbac
->
m_gª©îO√Bôs
[ 
˘xIdx
 ][ 0 ] = 
˘xO√
[ ctxIdx ].
	`gëE¡r›yBôs
( 0 );

1957 
pcE°BôsSbac
->
m_gª©îO√Bôs
[ 
˘xIdx
 ][ 1 ] = 
˘xO√
[ ctxIdx ].
	`gëE¡r›yBôs
( 1 );

1960 
I¡
 
˘xIdx
 = 
absSèπIndex
; ctxIdx < 
absSt›Index
; ctxIdx++)

1962 
pcE°BôsSbac
->
m_ÀvñAbsBôs
[ 
˘xIdx
 ][ 0 ] = 
˘xAbs
[ ctxIdx ].
	`gëE¡r›yBôs
( 0 );

1963 
pcE°BôsSbac
->
m_ÀvñAbsBôs
[ 
˘xIdx
 ][ 1 ] = 
˘xAbs
[ ctxIdx ].
	`gëE¡r›yBôs
( 1 );

1965 
	}
}

1972 
Void
 
	gTEncSbac
::
	$xC›yC⁄ãxtsFrom
–c⁄° 
TEncSbac
* 
pSrc
 )

1974 
	`mem˝y
(
m_c⁄ãxtModñs
, 
pSrc
->m_c⁄ãxtModñs, 
m_numC⁄ãxtModñs
*(m_contextModels[0]));

1975 
	`mem˝y
(
m_gﬁombRi˚Ad≠èti⁄Sèti°ics
, 
pSrc
->m_gﬁombRi˚Ad≠èti⁄Sèti°ics, ((
UI¡
Ë* 
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
));

1976 
	}
}

1978 
Void
 
	gTEncSbac
::
	$lﬂdC⁄ãxts
 ( c⁄° 
TEncSbac
* 
pSrc
)

1980 
	`xC›yC⁄ãxtsFrom
(
pSrc
);

1981 
	}
}

1987 
Void
 
	gTEncSbac
::
	$codeEx∂icôRdpcmMode
–
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
 )

1989 
TComD©aCU
 *
cu
 = 
rTu
.
	`gëCU
();

1990 c⁄° 
TComRe˘™gÀ
 &
ª˘
 = 
rTu
.
	`gëRe˘
(
compID
);

1991 c⁄° 
UI¡
 
absP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
(
compID
);

1992 c⁄° 
UI¡
 
tuHeight
 = 
g_aucC⁄vîtToBô
[
ª˘
.
height
];

1993 c⁄° 
UI¡
 
tuWidth
 = 
g_aucC⁄vîtToBô
[
ª˘
.
width
];

1995 
	`as£π
(
tuHeight
 =
tuWidth
);

1996 
	`as£π
(
tuHeight
 < 4);

1998 
UI¡
 
ex∂icôRdpcmMode
 = 
cu
->
	`gëEx∂icôRdpcmMode
(
compID
, 
absP¨tIdx
);

2000 if–
ex∂icôRdpcmMode
 =
RDPCM_OFF
 )

2002 
m_pcBöIf
->
	`ícodeBö
 (0, 
m_ex∂icôRdpcmFœgSCModñ
.
	`gë
 (0, 
	`toCh™√lTy≥
(
compID
), 0));

2004 if–
ex∂icôRdpcmMode
 =
RDPCM_HOR
 ||Éx∂icôRdpcmModê=
RDPCM_VER
 )

2006 
m_pcBöIf
->
	`ícodeBö
 (1, 
m_ex∂icôRdpcmFœgSCModñ
.
	`gë
 (0, 
	`toCh™√lTy≥
(
compID
), 0));

2007 if(
ex∂icôRdpcmMode
 =
RDPCM_HOR
)

2009 
m_pcBöIf
->
	`ícodeBö
 ( 0, 
m_ex∂icôRdpcmDúSCModñ
.
	`gë
(0, 
	`toCh™√lTy≥
(
compID
), 0));

2013 
m_pcBöIf
->
	`ícodeBö
 ( 1, 
m_ex∂icôRdpcmDúSCModñ
.
	`gë
(0, 
	`toCh™√lTy≥
(
compID
), 0));

2018 
	`as£π
(0);

2020 
	}
}

	@TLibEncoder/TEncSbac.h

38 #i‚de‡
__TENCSBAC__


39 
	#__TENCSBAC__


	)

41 #i‡
_MSC_VER
 > 1000

42 #¥agm®
⁄˚


45 
	~"TLibComm⁄/TComBôSåóm.h
"

46 
	~"TLibComm⁄/C⁄ãxtTabÀs.h
"

47 
	~"TLibComm⁄/C⁄ãxtModñ.h
"

48 
	~"TLibComm⁄/C⁄ãxtModñ3DBuf„r.h
"

49 
	~"TEncE¡r›y.h
"

50 
	~"TEncBöCodî.h
"

51 
	~"TEncBöCodîCABAC.h
"

52 #i‡
FAST_BIT_EST


53 
	~"TEncBöCodîCABACCou¡î.h
"

56 
˛ass
 
	gTEncT›
;

66 ˛as†
	cTEncSbac
 : 
public
 
TEncE¡r›yIf


68 
public
:

69 
TEncSbac
();

70 
	mvútuÆ
 ~
TEncSbac
();

72 
Void
 
	$öô
 ( 
TEncBöIf
* 
p
 ) { 
m_pcBöIf
 =Ö; }

73 
Void
 
	$unöô
 (Ë{ 
m_pcBöIf
 = 0; 
	}
}

76 
Void
 
ª£tE¡r›y
 (c⁄° 
TComSli˚
 *
pSli˚
);

77 
Sli˚Ty≥
 
dëîmöeCabacInôIdx
 (c⁄° 
TComSli˚
 *
pSli˚
);

78 
Void
 
	$£tBô°ªam
 ( 
TComBôIf
* 
p
 ) { 
m_pcBôIf
 =Ö; 
m_pcBöIf
->
	`öô
–∞); 
	}
}

80 
Void
 
lﬂd
 ( c⁄° 
TEncSbac
* 
pSrc
 );

81 
Void
 
lﬂdI¡øDúMode
 ( c⁄° 
TEncSbac
* 
pS¸
, c⁄° 
Ch™√lTy≥
 
chTy≥
 );

82 
Void
 
	$°‹e
 ( 
TEncSbac
* 
pDe°
 ) const;

83 
Void
 
	`lﬂdC⁄ãxts
 ( c⁄° 
TEncSbac
* 
pSrc
 );

84 
Void
 
	$ª£tBôs
 (Ë{ 
m_pcBöIf
->
	`ª£tBôs
(); 
m_pcBôIf
->ª£tBôs(); 
	}
}

85 
UI¡
 
	$gëNumbîOfWrôãnBôs
 (Ë{  
m_pcBöIf
->
	`gëNumWrôãnBôs
(); 
	}
}

88 
Void
 
codeVPS
 ( c⁄° 
TComVPS
* 
pcVPS
 );

89 
Void
 
codeSPS
 ( c⁄° 
TComSPS
* 
pcSPS
 );

90 
Void
 
codePPS
 ( c⁄° 
TComPPS
* 
pcPPS
 );

91 
Void
 
codeSli˚Hódî
 ( 
TComSli˚
* 
pcSli˚
 );

92 
Void
 
codeTûesWPPE¡ryPoöt
 ( 
TComSli˚
* 
pSli˚
 );

93 
Void
 
codeTîmö©ögBô
 ( 
UI¡
 
uûsLa°
 );

94 
Void
 
codeSli˚Föish
 ();

95 
Void
 
codeSaoMaxUvlc
 ( 
UI¡
 
code
, UI¡ 
maxSymbﬁ
 );

96 
Void
 
codeSaoMîge
 ( 
UI¡
 
uiCode
 );

97 
Void
 
codeSaoTy≥Idx
 ( 
UI¡
 
uiCode
);

98 
Void
 
codeSaoUÊc
 ( 
UI¡
 
uiLígth
, UI¡ 
uiCode
 );

99 
Void
 
codeSAOSign
 ( 
UI¡
 
uiCode
);

101 
Void
 
codeSAOOff£tP¨am
(
Comp⁄ítID
 
compIdx
, 
SAOOff£t
& 
˘bP¨am
, 
Boﬁ
 
¶i˚E«bÀd
, c⁄° 
I¡
 
ch™√lBôDïth
);

102 
Void
 
codeSAOBlkP¨am
(
SAOBlkP¨am
& 
ßoBlkP¨am
, c⁄° 
BôDïths
 &
bôDïths


103 , 
Boﬁ
* 
¶i˚E«bÀd


104 , 
Boﬁ
 
À·MîgeAvaû


105 , 
Boﬁ
 
aboveMîgeAvaû


106 , 
Boﬁ
 
⁄lyE°MîgeInfo
 = 
Ál£


109 
	g¥iv©e
:

110 
Void
 
xWrôeU«rySymbﬁ
 ( 
UI¡
 
uiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
 );

111 
Void
 
xWrôeU«ryMaxSymbﬁ
 ( 
UI¡
 
uiSymbﬁ
, 
C⁄ãxtModñ
* 
pcSCModñ
, 
I¡
 
iOff£t
, UI¡ 
uiMaxSymbﬁ
 );

112 
Void
 
xWrôeEpExGﬁomb
 ( 
UI¡
 
uiSymbﬁ
, UI¡ 
uiCou¡
 );

113 
Void
 
xWrôeC€fRemaöExGﬁomb
 ( 
UI¡
 
symbﬁ
, UI¡ &
rP¨am
, c⁄° 
Boﬁ
 
u£LimôedPªfixLígth
, c⁄° 
I¡
 
maxLog2TrDy«micR™ge
 );

115 
Void
 
xC›yFrom
 ( c⁄° 
TEncSbac
* 
pSrc
 );

116 
Void
 
xC›yC⁄ãxtsFrom
 ( c⁄° 
TEncSbac
* 
pSrc
 );

118 
	g¥Ÿe˘ed
:

119 
TComBôIf
* 
m_pcBôIf
;

120 
TEncBöIf
* 
	gm_pcBöIf
;

124 
	gpublic
:

125 
Void
 
codeCUTønsqu™tBy∑ssFœg
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

126 
Void
 
codeSkùFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

127 
Void
 
codeMîgeFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

128 
Void
 
codeMîgeIndex
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

129 
Void
 
codeS∂ôFœg
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

130 
Void
 
codeMVPIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

132 
Void
 
codeP¨tSize
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, UI¡ 
uiDïth
 );

133 
Void
 
codePªdMode
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

134 
Void
 
codeIPCMInfo
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

135 
Void
 
codeTønsf‹mSubdivFœg
 ( 
UI¡
 
uiSymbﬁ
, UI¡ 
uiCtx
 );

136 
Void
 
codeQtCbf
 ( 
TComTU
 & 
rTu
, c⁄° 
Comp⁄ítID
 
compID
, c⁄° 
Boﬁ
 
lowe°Levñ
 );

137 
Void
 
codeQtRoŸCbf
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

138 
Void
 
codeQtCbfZîo
 ( 
TComTU
 &
rTu
, c⁄° 
Ch™√lTy≥
 
chTy≥
 );

139 
Void
 
codeQtRoŸCbfZîo
 ( );

140 
Void
 
codeI¡øDúLumaAng
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
absP¨tIdx
, 
Boﬁ
 
isMu…ùÀ
);

142 
Void
 
codeI¡øDúChroma
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

143 
Void
 
codeI¡îDú
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

144 
Void
 
codeRefFrmIdx
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

145 
Void
 
codeMvd
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
RefPicLi°
 
eRefLi°
 );

147 
Void
 
codeCrossComp⁄ítPªdi˘i⁄
–
TComTU
 &
rTu
, 
Comp⁄ítID
 
compID
 );

149 
Void
 
codeDñèQP
 ( 
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
 );

150 
Void
 
codeChromaQpAdju°mít
 ( 
TComD©aCU
* 
cu
, 
UI¡
 
absP¨tIdx
 );

152 
Void
 
codeLa°Signifiˇ¡XY
 ( 
UI¡
 
uiPosX
, UI¡ 
uiPosY
, 
I¡
 
width
, I¡ 
height
, 
Comp⁄ítID
 
comp⁄ít
, UI¡ 
uiSˇnIdx
 );

153 
Void
 
codeC€ffNxN
 ( 
TComTU
 &
rTu
, 
TC€ff
* 
pcC€f
, c⁄° 
Comp⁄ítID
 
compID
 );

154 
Void
 
codeTønsf‹mSkùFœgs
 ( 
TComTU
 &
rTu
, 
Comp⁄ítID
 
comp⁄ít
 );

160 
Void
 
e°Bô
 (
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
);

161 
Void
 
e°CBFBô
 ( 
e°BôsSbacSåu˘
* 
pcE°BôsSbac
 );

162 
Void
 
e°Signifiˇ¡C€ffGroupM≠Bô
–
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
Ch™√lTy≥
 
chTy≥
 );

163 
Void
 
e°Signifiˇ¡M≠Bô
 ( 
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
 );

164 
Void
 
e°La°Signifiˇ¡Posôi⁄Bô
 ( 
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
I¡
 
width
, I¡ 
height
, 
Ch™√lTy≥
 
chTy≥
, 
COEFF_SCAN_TYPE
 
sˇnTy≥
 );

165 
Void
 
e°Signifiˇ¡C€fficõ¡sBô
 ( 
e°BôsSbacSåu˘
* 
pcE°BôsSbac
, 
Ch™√lTy≥
 
chTy≥
 );

167 
Void
 
codeEx∂icôRdpcmMode
 ( 
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
 );

170 
TEncBöIf
* 
	$gëEncBöIf
(Ë{  
m_pcBöIf
; 
	}
}

171 
	g¥iv©e
:

172 
C⁄ãxtModñ
 
m_c⁄ãxtModñs
[
MAX_NUM_CTX_MOD
];

173 
I¡
 
	gm_numC⁄ãxtModñs
;

174 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUS∂ôFœgSCModñ
;

175 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUSkùFœgSCModñ
;

176 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUMîgeFœgExtSCModñ
;

177 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUMîgeIdxExtSCModñ
;

178 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUP¨tSizeSCModñ
;

179 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUPªdModeSCModñ
;

180 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUI¡øPªdSCModñ
;

181 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUChromaPªdSCModñ
;

182 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUDñèQpSCModñ
;

183 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUI¡îDúSCModñ
;

184 
C⁄ãxtModñ3DBuf„r
 
	gm_cCURefPicSCModñ
;

185 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUMvdSCModñ
;

186 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUQtCbfSCModñ
;

187 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUTønsSubdivFœgSCModñ
;

188 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUQtRoŸCbfSCModñ
;

190 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUSigC€ffGroupSCModñ
;

191 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUSigSCModñ
;

192 
C⁄ãxtModñ3DBuf„r
 
	gm_cCuCtxLa°X
;

193 
C⁄ãxtModñ3DBuf„r
 
	gm_cCuCtxLa°Y
;

194 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUO√SCModñ
;

195 
C⁄ãxtModñ3DBuf„r
 
	gm_cCUAbsSCModñ
;

197 
C⁄ãxtModñ3DBuf„r
 
	gm_cMVPIdxSCModñ
;

199 
C⁄ãxtModñ3DBuf„r
 
	gm_cSaoMîgeSCModñ
;

200 
C⁄ãxtModñ3DBuf„r
 
	gm_cSaoTy≥IdxSCModñ
;

201 
C⁄ãxtModñ3DBuf„r
 
	gm_cTønsf‹mSkùSCModñ
;

202 
C⁄ãxtModñ3DBuf„r
 
	gm_CUTønsqu™tBy∑ssFœgSCModñ
;

203 
C⁄ãxtModñ3DBuf„r
 
	gm_ex∂icôRdpcmFœgSCModñ
;

204 
C⁄ãxtModñ3DBuf„r
 
	gm_ex∂icôRdpcmDúSCModñ
;

205 
C⁄ãxtModñ3DBuf„r
 
	gm_cCrossComp⁄ítPªdi˘i⁄SCModñ
;

207 
C⁄ãxtModñ3DBuf„r
 
	gm_ChromaQpAdjFœgSCModñ
;

208 
C⁄ãxtModñ3DBuf„r
 
	gm_ChromaQpAdjIdcSCModñ
;

210 
UI¡
 
	gm_gﬁombRi˚Ad≠èti⁄Sèti°ics
[
RExt__GOLOMB_RICE_ADAPTATION_STATISTICS_SETS
];

	@TLibEncoder/TEncSearch.cpp

38 
	~"TLibComm⁄/Comm⁄Def.h
"

39 
	~"TLibComm⁄/TComRom.h
"

40 
	~"TLibComm⁄/TComMŸi⁄Info.h
"

41 
	~"TEncSórch.h
"

42 
	~"TLibComm⁄/TComTU.h
"

43 
	~"TLibComm⁄/Debug.h
"

44 
	~<m©h.h
>

45 
	~<limôs
>

51 c⁄° 
TComMv
 
	gs_acMvReföeH
[9] =

53 
TComMv
( 0, 0 ),

54 
TComMv
( 0, -1 ),

55 
TComMv
( 0, 1 ),

56 
TComMv
( -1, 0 ),

57 
TComMv
( 1, 0 ),

58 
TComMv
( -1, -1 ),

59 
TComMv
( 1, -1 ),

60 
TComMv
( -1, 1 ),

61 
TComMv
( 1, 1 )

64 c⁄° 
TComMv
 
	gs_acMvReföeQ
[9] =

66 
TComMv
( 0, 0 ),

67 
TComMv
( 0, -1 ),

68 
TComMv
( 0, 1 ),

69 
TComMv
( -1, -1 ),

70 
TComMv
( 1, -1 ),

71 
TComMv
( -1, 0 ),

72 
TComMv
( 1, 0 ),

73 
TComMv
( -1, 1 ),

74 
TComMv
( 1, 1 )

77 
Void
 
	$off£tSubTUCBFs
(
TComTU
 &
rTu
, c⁄° 
Comp⁄ítID
 
compID
)

79 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

80 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

81 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
(
compID
);

82 c⁄° 
UI¡
 
∑πIdxesPîSubTU
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
) >> 1;

86 
UCh¨
 
subTUCBF
[2];

87 
UCh¨
 
comböedSubTUCBF
 = 0;

89 
UI¡
 
subTU
 = 0; subTU < 2; subTU++)

91 c⁄° 
UI¡
 
subTUAbsP¨tIdx
 = 
uiAbsP¨tIdx
 + (
subTU
 * 
∑πIdxesPîSubTU
);

93 
subTUCBF
[
subTU
] = 
pcCU
->
	`gëCbf
(
subTUAbsP¨tIdx
, 
compID
, 
uiTrDïth
);

94 
comböedSubTUCBF
 |
subTUCBF
[
subTU
];

97 
UI¡
 
subTU
 = 0; subTU < 2; subTU++)

99 c⁄° 
UI¡
 
subTUAbsP¨tIdx
 = 
uiAbsP¨tIdx
 + (
subTU
 * 
∑πIdxesPîSubTU
);

100 c⁄° 
UCh¨
 
composôeCBF
 = (
subTUCBF
[
subTU
] << 1Ë| 
comböedSubTUCBF
;

102 
pcCU
->
	`£tCbfP¨tR™ge
((
composôeCBF
 << 
uiTrDïth
), 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
);

104 
	}
}

107 
	gTEncSórch
::
	$TEncSórch
()

108 : 
	`m_puhQTTempTrIdx
(
NULL
)

109 , 
	`m_pcQTTempTComYuv
(
NULL
)

110 , 
	`m_pcEncCfg
 (
NULL
)

111 , 
	`m_pcTrQu™t
 (
NULL
)

112 , 
	`m_pcRdCo°
 (
NULL
)

113 , 
	`m_pcE¡r›yCodî
 (
NULL
)

114 , 
	`m_iSórchR™ge
 (0)

115 , 
	`m_bùªdSórchR™ge
 (0)

116 , 
	`m_mŸi⁄E°im©i⁄SórchMëhod
 (
MESEARCH_FULL
)

117 , 
	`m_µpcRDSbacCodî
 (
NULL
)

118 , 
	`m_pcRDGoOnSbacCodî
 (
NULL
)

119 , 
	`m_pTempPñ
 (
NULL
)

120 , 
	$m_isInôülized
 (
Ál£
)

122 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

124 
m_µcQTTempC€ff
[
ch
] = 
NULL
;

125 #i‡
ADAPTIVE_QP_SELECTION


126 
m_µcQTTempAæC€ff
[
ch
] = 
NULL
;

128 
m_puhQTTempCbf
[
ch
] = 
NULL
;

129 
m_phQTTempCrossComp⁄ítPªdi˘i⁄AÕha
[
ch
] = 
NULL
;

130 
m_pSh¨edPªdTønsf‹mSkù
[
ch
] = 
NULL
;

131 
m_pcQTTempTUC€ff
[
ch
] = 
NULL
;

132 #i‡
ADAPTIVE_QP_SELECTION


133 
m_µcQTTempTUAæC€ff
[
ch
] = 
NULL
;

135 
m_puhQTTempTønsf‹mSkùFœg
[
ch
] = 
NULL
;

138 
I¡
 
i
=0; i<
MAX_NUM_REF_LIST_ADAPT_SR
; i++)

140 
	`mem£t
 (
m_ØiAd≠tSR
[
i
], 0, 
MAX_IDX_ADAPT_SR
 *  (
I¡
));

142 
I¡
 
i
=0; i<
AMVP_MAX_NUM_CANDS
+1; i++)

144 
	`mem£t
 (
m_auiMVPIdxCo°
[
i
], 0, (
AMVP_MAX_NUM_CANDS
+1Ë*  (
UI¡
) );

147 
	`£tWpSˇlögDi°P¨am
–
NULL
, -1, 
REF_PIC_LIST_X
 );

148 
	}
}

151 
Void
 
	gTEncSórch
::
	$de°roy
()

153 
	`as£π
 (
m_isInôülized
);

154 i‡–
m_pTempPñ
 )

156 
dñëe
 [] 
m_pTempPñ
;

157 
m_pTempPñ
 = 
NULL
;

160 i‡–
m_pcEncCfg
 )

162 c⁄° 
UI¡
 
uiNumLayîsAŒoˇãd
 = 
m_pcEncCfg
->
	`gëQuadåìTULog2MaxSize
()-m_pcEncCfg->
	`gëQuadåìTULog2MöSize
()+1;

164 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

166 
UI¡
 
œyî
 = 0;Üayî < 
uiNumLayîsAŒoˇãd
;Üayer++)

168 
dñëe
[] 
m_µcQTTempC€ff
[
ch
][
œyî
];

169 #i‡
ADAPTIVE_QP_SELECTION


170 
dñëe
[] 
m_µcQTTempAæC€ff
[
ch
][
œyî
];

173 
dñëe
[] 
m_µcQTTempC€ff
[
ch
];

174 
dñëe
[] 
m_puhQTTempCbf
[
ch
];

175 #i‡
ADAPTIVE_QP_SELECTION


176 
dñëe
[] 
m_µcQTTempAæC€ff
[
ch
];

180  
UI¡
 
œyî
 = 0;Üayî < 
uiNumLayîsAŒoˇãd
;Üayer++ )

182 
m_pcQTTempTComYuv
[
œyî
].
	`de°roy
();

186 
dñëe
[] 
m_puhQTTempTrIdx
;

187 
dñëe
[] 
m_pcQTTempTComYuv
;

189 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

191 
dñëe
[] 
m_pSh¨edPªdTønsf‹mSkù
[
ch
];

192 
dñëe
[] 
m_pcQTTempTUC€ff
[
ch
];

193 #i‡
ADAPTIVE_QP_SELECTION


194 
dñëe
[] 
m_µcQTTempTUAæC€ff
[
ch
];

196 
dñëe
[] 
m_phQTTempCrossComp⁄ítPªdi˘i⁄AÕha
[
ch
];

197 
dñëe
[] 
m_puhQTTempTønsf‹mSkùFœg
[
ch
];

199 
m_pcQTTempTønsf‹mSkùTComYuv
.
	`de°roy
();

201 
m_tmpYuvPªd
.
	`de°roy
();

202 
m_isInôülized
 = 
Ál£
;

203 
	}
}

205 
	gTEncSórch
::~
	$TEncSórch
()

207 i‡(
m_isInôülized
)

209 
	`de°roy
();

211 
	}
}

216 
Void
 
	gTEncSórch
::
	$öô
(
TEncCfg
* 
pcEncCfg
,

217 
TComTrQu™t
* 
pcTrQu™t
,

218 
I¡
 
iSórchR™ge
,

219 
I¡
 
bùªdSórchR™ge
,

220 
MESórchMëhod
 
mŸi⁄E°im©i⁄SórchMëhod
,

221 c⁄° 
UI¡
 
maxCUWidth
,

222 c⁄° 
UI¡
 
maxCUHeight
,

223 c⁄° 
UI¡
 
maxTŸÆCUDïth
,

224 
TEncE¡r›y
* 
pcE¡r›yCodî
,

225 
TComRdCo°
* 
pcRdCo°
,

226 
TEncSbac
*** 
µpcRDSbacCodî
,

227 
TEncSbac
* 
pcRDGoOnSbacCodî


230 
	`as£π
 (!
m_isInôülized
);

231 
m_pcEncCfg
 = 
pcEncCfg
;

232 
m_pcTrQu™t
 = 
pcTrQu™t
;

233 
m_iSórchR™ge
 = 
iSórchR™ge
;

234 
m_bùªdSórchR™ge
 = 
bùªdSórchR™ge
;

235 
m_mŸi⁄E°im©i⁄SórchMëhod
 = 
mŸi⁄E°im©i⁄SórchMëhod
;

236 
m_pcE¡r›yCodî
 = 
pcE¡r›yCodî
;

237 
m_pcRdCo°
 = 
pcRdCo°
;

239 
m_µpcRDSbacCodî
 = 
µpcRDSbacCodî
;

240 
m_pcRDGoOnSbacCodî
 = 
pcRDGoOnSbacCodî
;

242 
UI¡
 
iDú
 = 0; iDú < 
MAX_NUM_REF_LIST_ADAPT_SR
; iDir++)

244 
UI¡
 
iRefIdx
 = 0; iRefIdx < 
MAX_IDX_ADAPT_SR
; iRefIdx++)

246 
m_ØiAd≠tSR
[
iDú
][
iRefIdx
] = 
iSórchR™ge
;

251  
I¡
 
iNum
 = 0; iNum < 
AMVP_MAX_NUM_CANDS
+1; iNum++)

253  
I¡
 
iIdx
 = 0; iIdx < 
AMVP_MAX_NUM_CANDS
; iIdx++)

255 i‡(
iIdx
 < 
iNum
)

257 
m_auiMVPIdxCo°
[
iIdx
][
iNum
] = 
	`xGëMvpIdxBôs
(iIdx, iNum);

261 
m_auiMVPIdxCo°
[
iIdx
][
iNum
] = 
MAX_INT
;

266 c⁄° 
ChromaF‹m©
 
cf‹m
=
pcEncCfg
->
	`gëChromaF‹m©Idc
();

267 
	`öôTempBuff
(
cf‹m
);

269 
m_pTempPñ
 = 
√w
 
Pñ
[
maxCUWidth
*
maxCUHeight
];

271 c⁄° 
UI¡
 
uiNumLayîsToAŒoˇã
 = 
pcEncCfg
->
	`gëQuadåìTULog2MaxSize
()-pcEncCfg->
	`gëQuadåìTULog2MöSize
()+1;

272 c⁄° 
UI¡
 
uiNumP¨tôi⁄s
 = 1<<(
maxTŸÆCUDïth
<<1);

273 
UI¡
 
ch
=0; ch<
MAX_NUM_COMPONENT
; ch++)

275 c⁄° 
UI¡
 
csx
=::
	`gëComp⁄ítSˇÀX
(
	`Comp⁄ítID
(
ch
), 
cf‹m
);

276 c⁄° 
UI¡
 
csy
=::
	`gëComp⁄ítSˇÀY
(
	`Comp⁄ítID
(
ch
), 
cf‹m
);

277 
m_µcQTTempC€ff
[
ch
] = 
√w
 
TC€ff
* [
uiNumLayîsToAŒoˇã
];

278 #i‡
ADAPTIVE_QP_SELECTION


279 
m_µcQTTempAæC€ff
[
ch
] = 
√w
 
TC€ff
*[
uiNumLayîsToAŒoˇã
];

281 
m_puhQTTempCbf
[
ch
] = 
√w
 
UCh¨
 [
uiNumP¨tôi⁄s
];

283 
UI¡
 
œyî
 = 0;Üayî < 
uiNumLayîsToAŒoˇã
;Üayer++)

285 
m_µcQTTempC€ff
[
ch
][
œyî
] = 
√w
 
TC€ff
[(
maxCUWidth
*
maxCUHeight
)>>(
csx
+
csy
)];

286 #i‡
ADAPTIVE_QP_SELECTION


287 
m_µcQTTempAæC€ff
[
ch
][
œyî
] = 
√w
 
TC€ff
[(
maxCUWidth
*
maxCUHeight
)>>(
csx
+
csy
) ];

291 
m_phQTTempCrossComp⁄ítPªdi˘i⁄AÕha
[
ch
] = 
√w
 
SCh¨
 [
uiNumP¨tôi⁄s
];

292 
m_pSh¨edPªdTønsf‹mSkù
[
ch
] = 
√w
 
Pñ
 [
MAX_CU_SIZE
*MAX_CU_SIZE];

293 
m_pcQTTempTUC€ff
[
ch
] = 
√w
 
TC€ff
[
MAX_CU_SIZE
*MAX_CU_SIZE];

294 #i‡
ADAPTIVE_QP_SELECTION


295 
m_µcQTTempTUAæC€ff
[
ch
] = 
√w
 
TC€ff
[
MAX_CU_SIZE
*MAX_CU_SIZE];

297 
m_puhQTTempTønsf‹mSkùFœg
[
ch
] = 
√w
 
UCh¨
 [
uiNumP¨tôi⁄s
];

299 
m_puhQTTempTrIdx
 = 
√w
 
UCh¨
 [
uiNumP¨tôi⁄s
];

300 
m_pcQTTempTComYuv
 = 
√w
 
TComYuv
[
uiNumLayîsToAŒoˇã
];

301  
UI¡
 
ui
 = 0; uò< 
uiNumLayîsToAŒoˇã
; ++ui )

303 
m_pcQTTempTComYuv
[
ui
].
	`¸óã
–
maxCUWidth
, 
maxCUHeight
, 
pcEncCfg
->
	`gëChromaF‹m©Idc
() );

305 
m_pcQTTempTønsf‹mSkùTComYuv
.
	`¸óã
–
maxCUWidth
, 
maxCUHeight
, 
pcEncCfg
->
	`gëChromaF‹m©Idc
() );

306 
m_tmpYuvPªd
.
	`¸óã
(
MAX_CU_SIZE
, MAX_CU_SIZE, 
pcEncCfg
->
	`gëChromaF‹m©Idc
());

307 
m_isInôülized
 = 
åue
;

308 
	}
}

311 
__ölöe
 
Void
 
	gTEncSórch
::
	$xTZSórchHñp
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, 
I¡TZSórchSåu˘
& 
rcSåu˘
, c⁄° 
I¡
 
iSórchX
, c⁄° I¡ 
iSórchY
, c⁄° 
UCh¨
 
ucPoötNr
, c⁄° 
UI¡
 
uiDi°™˚
 )

313 
Di°‹ti⁄
 
uiSad
 = 0;

315 c⁄° 
Pñ
* c⁄° 
piRefSrch
 = 
rcSåu˘
.
piRefY
 + 
iSórchY
 *ÑcSåu˘.
iYSåide
 + 
iSórchX
;

318 
m_pcRdCo°
->
	`£tDi°P¨am
–
pcP©ã∫Key
, 
piRefSrch
, 
rcSåu˘
.
iYSåide
, 
m_cDi°P¨am
 );

320 
	`£tDi°P¨amComp
(
COMPONENT_Y
);

323 
m_cDi°P¨am
.
bôDïth
 = 
pcP©ã∫Key
->
	`gëBôDïthY
();

324 
m_cDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
rcSåu˘
.
uiBe°Sad
;

326 if((
m_pcEncCfg
->
	`gëRe°ri˘MESam∂ög
(Ë=
Ál£
Ë&& m_pcEncCfg->
	`gëMŸi⁄E°im©i⁄SórchMëhod
(Ë=
MESEARCH_SELECTIVE
)

328 
I¡
 
isubShi·
 = 0;

330 
Di°‹ti⁄
 
uiBôCo°
 = 
m_pcRdCo°
->
	`gëCo°OfVe˘‹WôhPªdi˘‹
–
iSórchX
, 
iSórchY
 );

333 i‡(
uiBôCo°
 < 
rcSåu˘
.
uiBe°Sad
)

335 i‡–
m_cDi°P¨am
.
iRows
 > 32 )

337 
m_cDi°P¨am
.
iSubShi·
 = 4;

339 i‡–
m_cDi°P¨am
.
iRows
 > 16 )

341 
m_cDi°P¨am
.
iSubShi·
 = 3;

343 i‡–
m_cDi°P¨am
.
iRows
 > 8 )

345 
m_cDi°P¨am
.
iSubShi·
 = 2;

349 
m_cDi°P¨am
.
iSubShi·
 = 1;

352 
Di°‹ti⁄
 
uiTempSad
 = 
m_cDi°P¨am
.
	`Di°Func
( &m_cDistParam );

353 if((
uiTempSad
 + 
uiBôCo°
Ë< 
rcSåu˘
.
uiBe°Sad
)

355 
uiSad
 +
uiTempSad
 >> 
m_cDi°P¨am
.
iSubShi·
;

356 
m_cDi°P¨am
.
iSubShi·
 > 0)

358 
isubShi·
 = 
m_cDi°P¨am
.
iSubShi·
 -1;

359 
m_cDi°P¨am
.
pOrg
 = 
pcP©ã∫Key
->
	`gëROIY
(Ë+ (pcP©ã∫Key->
	`gëP©ã∫LSåide
(Ë<< 
isubShi·
);

360 
m_cDi°P¨am
.
pCur
 = 
piRefSrch
 + (
rcSåu˘
.
iYSåide
 << 
isubShi·
);

361 
uiTempSad
 = 
m_cDi°P¨am
.
	`Di°Func
( &m_cDistParam );

362 
uiSad
 +
uiTempSad
 >> 
m_cDi°P¨am
.
iSubShi·
;

363 if(((
uiSad
 << 
isubShi·
Ë+ 
uiBôCo°
Ë> 
rcSåu˘
.
uiBe°Sad
)

368 
m_cDi°P¨am
.
iSubShi·
--;

371 if(
m_cDi°P¨am
.
iSubShi·
 == 0)

373 
uiSad
 +
uiBôCo°
;

374 if–
uiSad
 < 
rcSåu˘
.
uiBe°Sad
 )

376 
rcSåu˘
.
uiBe°Sad
 = 
uiSad
;

377 
rcSåu˘
.
iBe°X
 = 
iSórchX
;

378 
rcSåu˘
.
iBe°Y
 = 
iSórchY
;

379 
rcSåu˘
.
uiBe°Di°™˚
 = 
uiDi°™˚
;

380 
rcSåu˘
.
uiBe°Round
 = 0;

381 
rcSåu˘
.
ucPoötNr
 = ucPointNr;

382 
m_cDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
uiSad
;

391 i‡–
m_pcEncCfg
->
	`gëFa°I¡îSórchMode
()==
FASTINTERSEARCH_MODE1
 || m_pcEncCfg->gëFa°I¡îSórchMode()==
FASTINTERSEARCH_MODE3
 )

393 i‡–
m_cDi°P¨am
.
iRows
 > 8 )

395 
m_cDi°P¨am
.
iSubShi·
 = 1;

399 
uiSad
 = 
m_cDi°P¨am
.
	`Di°Func
( &m_cDistParam );

403 if–
uiSad
 < 
rcSåu˘
.
uiBe°Sad
 )

406 
uiSad
 +
m_pcRdCo°
->
	`gëCo°OfVe˘‹WôhPªdi˘‹
–
iSórchX
, 
iSórchY
 );

408 if–
uiSad
 < 
rcSåu˘
.
uiBe°Sad
 )

410 
rcSåu˘
.
uiBe°Sad
 = 
uiSad
;

411 
rcSåu˘
.
iBe°X
 = 
iSórchX
;

412 
rcSåu˘
.
iBe°Y
 = 
iSórchY
;

413 
rcSåu˘
.
uiBe°Di°™˚
 = 
uiDi°™˚
;

414 
rcSåu˘
.
uiBe°Round
 = 0;

415 
rcSåu˘
.
ucPoötNr
 = ucPointNr;

416 
m_cDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
uiSad
;

420 
	}
}

422 
__ölöe
 
Void
 
	gTEncSórch
::
	$xTZ2PoötSórch
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, 
I¡TZSórchSåu˘
& 
rcSåu˘
, c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
, c⁄° TComMv* c⁄° 
pcMvSrchRngRB
 )

424 
I¡
 
iSrchRngH‹Le·
 = 
pcMvSrchRngLT
->
	`gëH‹
();

425 
I¡
 
iSrchRngH‹Right
 = 
pcMvSrchRngRB
->
	`gëH‹
();

426 
I¡
 
iSrchRngVîT›
 = 
pcMvSrchRngLT
->
	`gëVî
();

427 
I¡
 
iSrchRngVîBŸtom
 = 
pcMvSrchRngRB
->
	`gëVî
();

432 
I¡
 
iSèπX
 = 
rcSåu˘
.
iBe°X
;

433 
I¡
 
iSèπY
 = 
rcSåu˘
.
iBe°Y
;

434  
rcSåu˘
.
ucPoötNr
 )

438 i‡–(
iSèπX
 - 1Ë>
iSrchRngH‹Le·
 )

440 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 - 1, 
iSèπY
, 0, 2 );

442 i‡–(
iSèπY
 - 1Ë>
iSrchRngVîT›
 )

444 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iSèπY
 - 1, 0, 2 );

450 i‡–(
iSèπY
 - 1Ë>
iSrchRngVîT›
 )

452 i‡–(
iSèπX
 - 1Ë>
iSrchRngH‹Le·
 )

454 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 - 1, 
iSèπY
 - 1, 0, 2 );

456 i‡–(
iSèπX
 + 1Ë<
iSrchRngH‹Right
 )

458 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 + 1, 
iSèπY
 - 1, 0, 2 );

465 i‡–(
iSèπY
 - 1Ë>
iSrchRngVîT›
 )

467 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iSèπY
 - 1, 0, 2 );

469 i‡–(
iSèπX
 + 1Ë<
iSrchRngH‹Right
 )

471 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 + 1, 
iSèπY
, 0, 2 );

477 i‡–(
iSèπX
 - 1Ë>
iSrchRngH‹Le·
 )

479 i‡–(
iSèπY
 + 1Ë<
iSrchRngVîBŸtom
 )

481 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 - 1, 
iSèπY
 + 1, 0, 2 );

483 i‡–(
iSèπY
 - 1Ë>
iSrchRngVîT›
 )

485 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 - 1, 
iSèπY
 - 1, 0, 2 );

492 i‡–(
iSèπX
 + 1Ë<
iSrchRngH‹Right
 )

494 i‡–(
iSèπY
 - 1Ë>
iSrchRngVîT›
 )

496 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 + 1, 
iSèπY
 - 1, 0, 2 );

498 i‡–(
iSèπY
 + 1Ë<
iSrchRngVîBŸtom
 )

500 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 + 1, 
iSèπY
 + 1, 0, 2 );

507 i‡–(
iSèπX
 - 1Ë>
iSrchRngH‹Le·
 )

509 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 - 1, 
iSèπY
 , 0, 2 );

511 i‡–(
iSèπY
 + 1Ë<
iSrchRngVîBŸtom
 )

513 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iSèπY
 + 1, 0, 2 );

519 i‡–(
iSèπY
 + 1Ë<
iSrchRngVîBŸtom
 )

521 i‡–(
iSèπX
 - 1Ë>
iSrchRngH‹Le·
 )

523 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 - 1, 
iSèπY
 + 1, 0, 2 );

525 i‡–(
iSèπX
 + 1Ë<
iSrchRngH‹Right
 )

527 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 + 1, 
iSèπY
 + 1, 0, 2 );

534 i‡–(
iSèπX
 + 1Ë<
iSrchRngH‹Right
 )

536 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
 + 1, 
iSèπY
, 0, 2 );

538 i‡–(
iSèπY
 + 1Ë<
iSrchRngVîBŸtom
 )

540 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iSèπY
 + 1, 0, 2 );

546 
	`as£π
–
Ál£
 );

550 
	}
}

555 
__ölöe
 
Void
 
	gTEncSórch
::
	$xTZ8PoötSqu¨eSórch
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, 
I¡TZSórchSåu˘
& 
rcSåu˘
, c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
, c⁄° TComMv* c⁄° 
pcMvSrchRngRB
, c⁄° 
I¡
 
iSèπX
, c⁄° I¡ 
iSèπY
, c⁄° I¡ 
iDi°
 )

557 c⁄° 
I¡
 
iSrchRngH‹Le·
 = 
pcMvSrchRngLT
->
	`gëH‹
();

558 c⁄° 
I¡
 
iSrchRngH‹Right
 = 
pcMvSrchRngRB
->
	`gëH‹
();

559 c⁄° 
I¡
 
iSrchRngVîT›
 = 
pcMvSrchRngLT
->
	`gëVî
();

560 c⁄° 
I¡
 
iSrchRngVîBŸtom
 = 
pcMvSrchRngRB
->
	`gëVî
();

565 
	`as£π
–
iDi°
 != 0 );

566 c⁄° 
I¡
 
iT›
 = 
iSèπY
 - 
iDi°
;

567 c⁄° 
I¡
 
iBŸtom
 = 
iSèπY
 + 
iDi°
;

568 c⁄° 
I¡
 
iLe·
 = 
iSèπX
 - 
iDi°
;

569 c⁄° 
I¡
 
iRight
 = 
iSèπX
 + 
iDi°
;

570 
rcSåu˘
.
uiBe°Round
 += 1;

572 i‡–
iT›
 >
iSrchRngVîT›
 )

574 i‡–
iLe·
 >
iSrchRngH‹Le·
 )

576 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iT›
, 1, 
iDi°
 );

579 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iT›
, 2, 
iDi°
 );

581 i‡–
iRight
 <
iSrchRngH‹Right
 )

583 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iT›
, 3, 
iDi°
 );

586 i‡–
iLe·
 >
iSrchRngH‹Le·
 )

588 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iSèπY
, 4, 
iDi°
 );

590 i‡–
iRight
 <
iSrchRngH‹Right
 )

592 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iSèπY
, 5, 
iDi°
 );

594 i‡–
iBŸtom
 <
iSrchRngVîBŸtom
 )

596 i‡–
iLe·
 >
iSrchRngH‹Le·
 )

598 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iBŸtom
, 6, 
iDi°
 );

601 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iBŸtom
, 7, 
iDi°
 );

603 i‡–
iRight
 <
iSrchRngH‹Right
 )

605 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iBŸtom
, 8, 
iDi°
 );

608 
	}
}

613 
__ölöe
 
Void
 
	gTEncSórch
::
	$xTZ8PoötDüm⁄dSórch
–c⁄° 
TComP©ã∫
*c⁄° 
pcP©ã∫Key
,

614 
I¡TZSórchSåu˘
& 
rcSåu˘
,

615 c⁄° 
TComMv
*c⁄° 
pcMvSrchRngLT
,

616 c⁄° 
TComMv
*c⁄° 
pcMvSrchRngRB
,

617 c⁄° 
I¡
 
iSèπX
,

618 c⁄° 
I¡
 
iSèπY
,

619 c⁄° 
I¡
 
iDi°
,

620 c⁄° 
Boﬁ
 
bCheckC‹√rsAtDi°1
 )

622 c⁄° 
I¡
 
iSrchRngH‹Le·
 = 
pcMvSrchRngLT
->
	`gëH‹
();

623 c⁄° 
I¡
 
iSrchRngH‹Right
 = 
pcMvSrchRngRB
->
	`gëH‹
();

624 c⁄° 
I¡
 
iSrchRngVîT›
 = 
pcMvSrchRngLT
->
	`gëVî
();

625 c⁄° 
I¡
 
iSrchRngVîBŸtom
 = 
pcMvSrchRngRB
->
	`gëVî
();

630 
	`as£π
 ( 
iDi°
 != 0 );

631 c⁄° 
I¡
 
iT›
 = 
iSèπY
 - 
iDi°
;

632 c⁄° 
I¡
 
iBŸtom
 = 
iSèπY
 + 
iDi°
;

633 c⁄° 
I¡
 
iLe·
 = 
iSèπX
 - 
iDi°
;

634 c⁄° 
I¡
 
iRight
 = 
iSèπX
 + 
iDi°
;

635 
rcSåu˘
.
uiBe°Round
 += 1;

637 i‡–
iDi°
 == 1 )

639 i‡–
iT›
 >
iSrchRngVîT›
 )

641 i‡(
bCheckC‹√rsAtDi°1
)

643 i‡–
iLe·
 >
iSrchRngH‹Le·
)

645 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iT›
, 1, 
iDi°
 );

647 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iT›
, 2, 
iDi°
 );

648 i‡–
iRight
 <
iSrchRngH‹Right
 )

650 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iT›
, 3, 
iDi°
 );

655 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iT›
, 2, 
iDi°
 );

658 i‡–
iLe·
 >
iSrchRngH‹Le·
 )

660 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iSèπY
, 4, 
iDi°
 );

662 i‡–
iRight
 <
iSrchRngH‹Right
 )

664 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iSèπY
, 5, 
iDi°
 );

666 i‡–
iBŸtom
 <
iSrchRngVîBŸtom
 )

668 i‡(
bCheckC‹√rsAtDi°1
)

670 i‡–
iLe·
 >
iSrchRngH‹Le·
)

672 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iBŸtom
, 6, 
iDi°
 );

674 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iBŸtom
, 7, 
iDi°
 );

675 i‡–
iRight
 <
iSrchRngH‹Right
 )

677 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iBŸtom
, 8, 
iDi°
 );

682 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iBŸtom
, 7, 
iDi°
 );

688 i‡–
iDi°
 <= 8 )

690 c⁄° 
I¡
 
iT›_2
 = 
iSèπY
 - (
iDi°
>>1);

691 c⁄° 
I¡
 
iBŸtom_2
 = 
iSèπY
 + (
iDi°
>>1);

692 c⁄° 
I¡
 
iLe·_2
 = 
iSèπX
 - (
iDi°
>>1);

693 c⁄° 
I¡
 
iRight_2
 = 
iSèπX
 + (
iDi°
>>1);

695 i‡–
iT›
 >
iSrchRngVîT›
 && 
iLe·
 >
iSrchRngH‹Le·
 &&

696 
iRight
 <
iSrchRngH‹Right
 && 
iBŸtom
 <
iSrchRngVîBŸtom
 )

698 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iT›
, 2, 
iDi°
 );

699 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·_2
, 
iT›_2
, 1, 
iDi°
>>1 );

700 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight_2
, 
iT›_2
, 3, 
iDi°
>>1 );

701 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iSèπY
, 4, 
iDi°
 );

702 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iSèπY
, 5, 
iDi°
 );

703 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·_2
, 
iBŸtom_2
, 6, 
iDi°
>>1 );

704 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight_2
, 
iBŸtom_2
, 8, 
iDi°
>>1 );

705 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iBŸtom
, 7, 
iDi°
 );

709 i‡–
iT›
 >
iSrchRngVîT›
 )

711 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iT›
, 2, 
iDi°
 );

713 i‡–
iT›_2
 >
iSrchRngVîT›
 )

715 i‡–
iLe·_2
 >
iSrchRngH‹Le·
 )

717 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·_2
, 
iT›_2
, 1, (
iDi°
>>1) );

719 i‡–
iRight_2
 <
iSrchRngH‹Right
 )

721 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight_2
, 
iT›_2
, 3, (
iDi°
>>1) );

724 i‡–
iLe·
 >
iSrchRngH‹Le·
 )

726 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iSèπY
, 4, 
iDi°
 );

728 i‡–
iRight
 <
iSrchRngH‹Right
 )

730 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iSèπY
, 5, 
iDi°
 );

732 i‡–
iBŸtom_2
 <
iSrchRngVîBŸtom
 )

734 i‡–
iLe·_2
 >
iSrchRngH‹Le·
 )

736 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·_2
, 
iBŸtom_2
, 6, (
iDi°
>>1) );

738 i‡–
iRight_2
 <
iSrchRngH‹Right
 )

740 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight_2
, 
iBŸtom_2
, 8, (
iDi°
>>1) );

743 i‡–
iBŸtom
 <
iSrchRngVîBŸtom
 )

745 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iBŸtom
, 7, 
iDi°
 );

751 i‡–
iT›
 >
iSrchRngVîT›
 && 
iLe·
 >
iSrchRngH‹Le·
 &&

752 
iRight
 <
iSrchRngH‹Right
 && 
iBŸtom
 <
iSrchRngVîBŸtom
 )

754 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iT›
, 0, 
iDi°
 );

755 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iSèπY
, 0, 
iDi°
 );

756 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iSèπY
, 0, 
iDi°
 );

757 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iBŸtom
, 0, 
iDi°
 );

758  
I¡
 
ödex
 = 1; index < 4; index++ )

760 c⁄° 
I¡
 
iPosYT
 = 
iT›
 + ((
iDi°
>>2Ë* 
ödex
);

761 c⁄° 
I¡
 
iPosYB
 = 
iBŸtom
 - ((
iDi°
>>2Ë* 
ödex
);

762 c⁄° 
I¡
 
iPosXL
 = 
iSèπX
 - ((
iDi°
>>2Ë* 
ödex
);

763 c⁄° 
I¡
 
iPosXR
 = 
iSèπX
 + ((
iDi°
>>2Ë* 
ödex
);

764 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXL
, 
iPosYT
, 0, 
iDi°
 );

765 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXR
, 
iPosYT
, 0, 
iDi°
 );

766 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXL
, 
iPosYB
, 0, 
iDi°
 );

767 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXR
, 
iPosYB
, 0, 
iDi°
 );

772 i‡–
iT›
 >
iSrchRngVîT›
 )

774 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iT›
, 0, 
iDi°
 );

776 i‡–
iLe·
 >
iSrchRngH‹Le·
 )

778 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iLe·
, 
iSèπY
, 0, 
iDi°
 );

780 i‡–
iRight
 <
iSrchRngH‹Right
 )

782 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iRight
, 
iSèπY
, 0, 
iDi°
 );

784 i‡–
iBŸtom
 <
iSrchRngVîBŸtom
 )

786 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iSèπX
, 
iBŸtom
, 0, 
iDi°
 );

788  
I¡
 
ödex
 = 1; index < 4; index++ )

790 c⁄° 
I¡
 
iPosYT
 = 
iT›
 + ((
iDi°
>>2Ë* 
ödex
);

791 c⁄° 
I¡
 
iPosYB
 = 
iBŸtom
 - ((
iDi°
>>2Ë* 
ödex
);

792 c⁄° 
I¡
 
iPosXL
 = 
iSèπX
 - ((
iDi°
>>2Ë* 
ödex
);

793 c⁄° 
I¡
 
iPosXR
 = 
iSèπX
 + ((
iDi°
>>2Ë* 
ödex
);

795 i‡–
iPosYT
 >
iSrchRngVîT›
 )

797 i‡–
iPosXL
 >
iSrchRngH‹Le·
 )

799 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXL
, 
iPosYT
, 0, 
iDi°
 );

801 i‡–
iPosXR
 <
iSrchRngH‹Right
 )

803 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXR
, 
iPosYT
, 0, 
iDi°
 );

806 i‡–
iPosYB
 <
iSrchRngVîBŸtom
 )

808 i‡–
iPosXL
 >
iSrchRngH‹Le·
 )

810 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXL
, 
iPosYB
, 0, 
iDi°
 );

812 i‡–
iPosXR
 <
iSrchRngH‹Right
 )

814 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
rcSåu˘
, 
iPosXR
, 
iPosYB
, 0, 
iDi°
 );

821 
	}
}

823 
Di°‹ti⁄
 
	gTEncSórch
::
	$xP©ã∫Reföemít
–
TComP©ã∫
* 
pcP©ã∫Key
,

824 
TComMv
 
ba£RefMv
,

825 
I¡
 
iFøc
, 
TComMv
& 
rcMvFøc
,

826 
Boﬁ
 
bAŒowU£OfHadam¨d


829 
Di°‹ti⁄
 
uiDi°
;

830 
Di°‹ti⁄
 
uiDi°Be°
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

831 
UI¡
 
uiDúecBe°
 = 0;

833 
Pñ
* 
piRefPos
;

834 
I¡
 
iRefSåide
 = 
m_fûãªdBlock
[0][0].
	`gëSåide
(
COMPONENT_Y
);

836 
m_pcRdCo°
->
	`£tDi°P¨am
–
pcP©ã∫Key
, 
m_fûãªdBlock
[0][0].
	`gëAddr
(
COMPONENT_Y
), 
iRefSåide
, 1, 
m_cDi°P¨am
, 
m_pcEncCfg
->
	`gëU£HADME
(Ë&& 
bAŒowU£OfHadam¨d
 );

838 c⁄° 
TComMv
* 
pcMvReföe
 = (
iFøc
 =2 ? 
s_acMvReföeH
 : 
s_acMvReföeQ
);

840 #i‡
MCTS_ENC_CHECK


841 
UI¡
 
maxReföemíts
 = 9;

842 
I¡
 
mvShi·
 = 2;

845 c⁄° 
UI¡
 
LumaLTSam∂eOff£t
 = 3;

846 c⁄° 
UI¡
 
LumaRBSam∂eOff£t
 = 4;

848 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
())

851 i‡–
pcP©ã∫Key
->
	`gëROIYPosX
(Ë+ (
ba£RefMv
.
	`gëH‹
(Ë>> 
mvShi·
 ) <ÖcP©ã∫Key->
	`gëTûeLe·T›PñPosX
(Ë+ 
LumaLTSam∂eOff£t
 ||

852 
pcP©ã∫Key
->
	`gëROIYPosY
(Ë+ (
ba£RefMv
.
	`gëVî
(Ë>> 
mvShi·
 ) <ÖcP©ã∫Key->
	`gëTûeLe·T›PñPosY
(Ë+ 
LumaLTSam∂eOff£t
 ||

853 
pcP©ã∫Key
->
	`gëROIYPosX
(Ë+ (
ba£RefMv
.
	`gëH‹
(Ë>> 
mvShi·
Ë>ÖcP©ã∫Key->
	`gëTûeRightBŸtomPñPosX
(Ë-ÖcP©ã∫Key->
	`gëROIYWidth
(Ë- 
LumaRBSam∂eOff£t
 ||

854 
pcP©ã∫Key
->
	`gëROIYPosY
(Ë+ (
ba£RefMv
.
	`gëVî
(Ë>> 
mvShi·
Ë>ÖcP©ã∫Key->
	`gëTûeRightBŸtomPñPosY
(Ë-ÖcP©ã∫Key->
	`gëROIYHeight
(Ë- 
LumaRBSam∂eOff£t


858 
maxReföemíts
 = 1;

862 
UI¡
 
i
 = 0; i < 
maxReföemíts
; i++)

864 
UI¡
 
i
 = 0; i < 9; i++)

867 
TComMv
 
cMvTe°
 = 
pcMvReföe
[
i
];

868 
cMvTe°
 +
ba£RefMv
;

870 
I¡
 
h‹VÆ
 = 
cMvTe°
.
	`gëH‹
(Ë* 
iFøc
;

871 
I¡
 
vîVÆ
 = 
cMvTe°
.
	`gëVî
(Ë* 
iFøc
;

872 
piRefPos
 = 
m_fûãªdBlock
[ 
vîVÆ
 & 3 ][ 
h‹VÆ
 & 3 ].
	`gëAddr
(
COMPONENT_Y
);

873 i‡–
h‹VÆ
 =2 && ( 
vîVÆ
 & 1 ) == 0 )

875 
piRefPos
 += 1;

877 i‡––
h‹VÆ
 & 1 ) =0 && 
vîVÆ
 == 2 )

879 
piRefPos
 +
iRefSåide
;

881 
cMvTe°
 = 
pcMvReföe
[
i
];

882 
cMvTe°
 +
rcMvFøc
;

884 
	`£tDi°P¨amComp
(
COMPONENT_Y
);

886 
m_cDi°P¨am
.
pCur
 = 
piRefPos
;

887 
m_cDi°P¨am
.
bôDïth
 = 
pcP©ã∫Key
->
	`gëBôDïthY
();

888 
uiDi°
 = 
m_cDi°P¨am
.
	`Di°Func
( &m_cDistParam );

889 
uiDi°
 +
m_pcRdCo°
->
	`gëCo°OfVe˘‹WôhPªdi˘‹
–
cMvTe°
.
	`gëH‹
(), cMvTe°.
	`gëVî
() );

891 i‡–
uiDi°
 < 
uiDi°Be°
 )

893 
uiDi°Be°
 = 
uiDi°
;

894 
uiDúecBe°
 = 
i
;

895 
m_cDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
uiDi°
;

899 
rcMvFøc
 = 
pcMvReföe
[
uiDúecBe°
];

901  
uiDi°Be°
;

902 
	}
}

906 
Void


907 
	gTEncSórch
::
	$xEncSubdivCbfQT
(
TComTU
 &
rTu
,

908 
Boﬁ
 
bLuma
,

909 
Boﬁ
 
bChroma
 )

911 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

912 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

913 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

914 c⁄° 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

915 c⁄° 
UI¡
 
uiSubdiv
 = ( 
uiTrMode
 > 
uiTrDïth
 ? 1 : 0 );

916 c⁄° 
UI¡
 
uiLog2LumaTøfoSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

918 if–
pcCU
->
	`isI¡ø
(0Ë&&ÖcCU->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_NxN
 && 
uiTrDïth
 == 0 )

920 
	`as£π
–
uiSubdiv
 );

922 if–
uiLog2LumaTøfoSize
 > 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
() )

924 
	`as£π
–
uiSubdiv
 );

926 if–
uiLog2LumaTøfoSize
 =
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MöSize
() )

928 
	`as£π
–!
uiSubdiv
 );

930 if–
uiLog2LumaTøfoSize
 =
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) )

932 
	`as£π
–!
uiSubdiv
 );

936 
	`as£π
–
uiLog2LumaTøfoSize
 > 
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) );

937 if–
bLuma
 )

939 
m_pcE¡r›yCodî
->
	`ícodeTønsf‹mSubdivFœg
–
uiSubdiv
, 5 - 
uiLog2LumaTøfoSize
 );

943 i‡–
bChroma
 )

945 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
rTu
.
	`GëChromaF‹m©
());

946 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
numbîVÆidComp⁄íts
; ch++)

948 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

949 if–
rTu
.
	`Pro˚ssögAŒQuadø¡s
(
compID
Ë&& (
uiTrDïth
==0 || 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, compID, uiTrDepth-1 ) ))

951 
m_pcE¡r›yCodî
->
	`ícodeQtCbf
(
rTu
, 
compID
, (
uiSubdiv
 == 0));

956 if–
uiSubdiv
 )

958 
TComTURecur£
 
	`tuRecur£
(
rTu
, 
Ál£
);

961 
	`xEncSubdivCbfQT
–
tuRecur£
, 
bLuma
, 
bChroma
 );

962 } 
tuRecur£
.
	`√xtSe˘i⁄
(
rTu
));

967 if–
bLuma
 )

969 
m_pcE¡r›yCodî
->
	`ícodeQtCbf
–
rTu
, 
COMPONENT_Y
, 
åue
 );

972 
	}
}

977 
Void


978 
	gTEncSórch
::
	$xEncC€ffQT
(
TComTU
 &
rTu
,

979 c⁄° 
Comp⁄ítID
 
comp⁄ít
,

980 
Boﬁ
 
bRólC€ff
 )

982 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

983 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

984 c⁄° 
UI¡
 
uiTrDïth
=
rTu
.
	`GëTønsf‹mDïthRñ
();

986 c⁄° 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

987 c⁄° 
UI¡
 
uiSubdiv
 = ( 
uiTrMode
 > 
uiTrDïth
 ? 1 : 0 );

989 if–
uiSubdiv
 )

991 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

994 
	`xEncC€ffQT
–
tuRecur£Chûd
, 
comp⁄ít
, 
bRólC€ff
 );

995 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
) );

997 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
comp⁄ít
))

1000 c⁄° 
UI¡
 
uiLog2TøfoSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

1001 
UI¡
 
uiC€ffOff£t
 = 
rTu
.
	`gëC€fficõ¡Off£t
(
comp⁄ít
);

1002 
UI¡
 
uiQTLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TøfoSize
;

1003 
TC€ff
* 
pcC€ff
 = 
bRólC€ff
 ? 
pcCU
->
	`gëC€ff
(
comp⁄ít
Ë: 
m_µcQTTempC€ff
[comp⁄ít][
uiQTLayî
];

1005 i‡(
	`isChroma
(
comp⁄ít
Ë&& (
pcCU
->
	`gëCbf
–
rTu
.
	`GëAbsP¨tIdxTU
(), 
COMPONENT_Y
, 
uiTrMode
 ) !0Ë&&ÖcCU->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
() )

1007 
m_pcE¡r›yCodî
->
	`ícodeCrossComp⁄ítPªdi˘i⁄
–
rTu
, 
comp⁄ít
 );

1010 
m_pcE¡r›yCodî
->
	`ícodeC€ffNxN
–
rTu
, 
pcC€ff
+
uiC€ffOff£t
, 
comp⁄ít
 );

1012 
	}
}

1017 
Void


1018 
	gTEncSórch
::
	$xEncI¡øHódî
–
TComD©aCU
* 
pcCU
,

1019 
UI¡
 
uiTrDïth
,

1020 
UI¡
 
uiAbsP¨tIdx
,

1021 
Boﬁ
 
bLuma
,

1022 
Boﬁ
 
bChroma
 )

1024 if–
bLuma
 )

1027 if–
uiAbsP¨tIdx
 == 0 )

1029 if–!
pcCU
->
	`gëSli˚
()->
	`isI¡ø
() )

1031 i‡(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

1033 
m_pcE¡r›yCodî
->
	`ícodeCUTønsqu™tBy∑ssFœg
–
pcCU
, 0, 
åue
 );

1035 
m_pcE¡r›yCodî
->
	`ícodeSkùFœg
–
pcCU
, 0, 
åue
 );

1036 
m_pcE¡r›yCodî
->
	`ícodePªdMode
–
pcCU
, 0, 
åue
 );

1038 
m_pcE¡r›yCodî
 ->
	`ícodeP¨tSize
–
pcCU
, 0,ÖcCU->
	`gëDïth
(0), 
åue
 );

1040 i‡(
pcCU
->
	`isI¡ø
(0Ë&&ÖcCU->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2Nx2N
 )

1042 
m_pcE¡r›yCodî
->
	`ícodeIPCMInfo
–
pcCU
, 0, 
åue
 );

1044 i‡–
pcCU
->
	`gëIPCMFœg
 (0))

1051 if–
pcCU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2Nx2N
 )

1053 i‡(
uiAbsP¨tIdx
==0)

1055 
m_pcE¡r›yCodî
->
	`ícodeI¡øDúModeLuma
 ( 
pcCU
, 0 );

1060 
UI¡
 
uiQNumP¨ts
 = 
pcCU
->
	`gëTŸÆNumP¨t
() >> 2;

1061 i‡(
uiTrDïth
>0 && (
uiAbsP¨tIdx
%
uiQNumP¨ts
)==0)

1063 
m_pcE¡r›yCodî
->
	`ícodeI¡øDúModeLuma
 ( 
pcCU
, 
uiAbsP¨tIdx
 );

1068 if–
bChroma
 )

1070 if–
pcCU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2Nx2N
 || !
	`íabÀ4ChromaPUsInI¡øNxNCU
’cCU->
	`gëPic
()->
	`gëChromaF‹m©
()))

1072 if(
uiAbsP¨tIdx
==0)

1074 
m_pcE¡r›yCodî
->
	`ícodeI¡øDúModeChroma
 ( 
pcCU
, 
uiAbsP¨tIdx
 );

1079 
UI¡
 
uiQNumP¨ts
 = 
pcCU
->
	`gëTŸÆNumP¨t
() >> 2;

1080 
	`as£π
(
uiTrDïth
>0);

1081 i‡((
uiAbsP¨tIdx
%
uiQNumP¨ts
)==0)

1083 
m_pcE¡r›yCodî
->
	`ícodeI¡øDúModeChroma
 ( 
pcCU
, 
uiAbsP¨tIdx
 );

1087 
	}
}

1092 
UI¡


1093 
	gTEncSórch
::
	$xGëI¡øBôsQT
(
TComTU
 &
rTu
,

1094 
Boﬁ
 
bLuma
,

1095 
Boﬁ
 
bChroma
,

1096 
Boﬁ
 
bRólC€ff
 )

1098 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

1099 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1100 c⁄° 
UI¡
 
uiTrDïth
=
rTu
.
	`GëTønsf‹mDïthRñ
();

1101 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

1102 
	`xEncI¡øHódî
 ( 
pcCU
, 
uiTrDïth
, 
uiAbsP¨tIdx
, 
bLuma
, 
bChroma
 );

1103 
	`xEncSubdivCbfQT
 ( 
rTu
, 
bLuma
, 
bChroma
 );

1105 if–
bLuma
 )

1107 
	`xEncC€ffQT
 ( 
rTu
, 
COMPONENT_Y
, 
bRólC€ff
 );

1109 if–
bChroma
 )

1111 
	`xEncC€ffQT
 ( 
rTu
, 
COMPONENT_Cb
, 
bRólC€ff
 );

1112 
	`xEncC€ffQT
 ( 
rTu
, 
COMPONENT_Cr
, 
bRólC€ff
 );

1114 
UI¡
 
uiBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

1116  
uiBôs
;

1117 
	}
}

1119 
UI¡
 
	gTEncSórch
::
	$xGëI¡øBôsQTChroma
(
TComTU
 &
rTu
,

1120 
Comp⁄ítID
 
compID
,

1121 
Boﬁ
 
bRólC€ff
 )

1123 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

1124 
	`xEncC€ffQT
 ( 
rTu
, 
compID
, 
bRólC€ff
 );

1125 
UI¡
 
uiBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

1126  
uiBôs
;

1127 
	}
}

1129 
Void
 
	gTEncSórch
::
xI¡øCodögTUBlock
–
TComYuv
* 
pcOrgYuv
,

1130 
TComYuv
* 
pcPªdYuv
,

1131 
TComYuv
* 
pcResiYuv
,

1132 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE],

1133 c⁄° 
Boﬁ
 
checkCrossCPªdi˘i⁄
,

1134 
Di°‹ti⁄
& 
ruiDi°
,

1135 c⁄° 
Comp⁄ítID
 
compID
,

1136 
TComTU
& 
rTu


1137 
DEBUG_STRING_FN_DECLARE
(
sDebug
)

1138 ,
I¡
 
deÁu…0Save1Lﬂd2


1141 i‡(!
	grTu
.
Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

1145 c⁄° 
Boﬁ
 
	gbIsLuma
 = 
isLuma
(
compID
);

1146 c⁄° 
	gTComRe˘™gÀ
 &
	gª˘
 = 
rTu
.
gëRe˘
(
compID
);

1147 
TComD©aCU
 *
	gpcCU
 = 
rTu
.
gëCU
();

1148 c⁄° 
UI¡
 
	guiAbsP¨tIdx
 = 
rTu
.
GëAbsP¨tIdxTU
();

1149 c⁄° 
	gTComSPS
 &
	g•s
 = *(
pcCU
->
gëSli˚
()->
gëSPS
());

1151 c⁄° 
UI¡
 
	guiTrDïth
 = 
rTu
.
GëTønsf‹mDïthRñAdj
(
compID
);

1152 c⁄° 
UI¡
 
	guiFuŒDïth
 = 
rTu
.
GëTønsf‹mDïthTŸÆ
();

1153 c⁄° 
UI¡
 
	guiLog2TrSize
 = 
rTu
.
GëLog2LumaTrSize
();

1154 c⁄° 
ChromaF‹m©
 
	gchFmt
 = 
pcOrgYuv
->
gëChromaF‹m©
();

1155 c⁄° 
Ch™√lTy≥
 
	gchTy≥
 = 
toCh™√lTy≥
(
compID
);

1156 c⁄° 
I¡
 
	gbôDïth
 = 
•s
.
gëBôDïth
(
chTy≥
);

1158 c⁄° 
UI¡
 
	guiWidth
 = 
ª˘
.
width
;

1159 c⁄° 
UI¡
 
	guiHeight
 = 
ª˘
.
height
;

1160 c⁄° 
UI¡
 
	guiSåide
 = 
pcOrgYuv
 ->
gëSåide
 (
compID
);

1161 
Pñ
 *
	gpiOrg
 = 
pcOrgYuv
 ->
gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

1162 
Pñ
 *
	gpiPªd
 = 
pcPªdYuv
->
gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

1163 
Pñ
 *
	gpiResi
 = 
pcResiYuv
->
gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

1164 
Pñ
 *
	gpiReco
 = 
pcPªdYuv
->
gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

1165 c⁄° 
UI¡
 
	guiQTLayî
 = 
•s
.
gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

1166 
Pñ
 *
	gpiRecQt
 = 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

1167 c⁄° 
UI¡
 
	guiRecQtSåide
 = 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
gëSåide
(
compID
);

1168 c⁄° 
UI¡
 
	guiZOrdî
 = 
pcCU
->
gëZ‹dîIdxInCtu
(Ë+ 
uiAbsP¨tIdx
;

1169 
Pñ
 *
	gpiRecIPªd
 = 
pcCU
->
gëPic
()->
gëPicYuvRec
()->
gëAddr
–
compID
,ÖcCU->
gëCtuRsAddr
(), 
uiZOrdî
 );

1170 
UI¡
 
	guiRecIPªdSåide
 = 
pcCU
->
gëPic
()->
gëPicYuvRec
()->
gëSåide
 ( 
compID
 );

1171 
TC€ff
 *
	gpcC€ff
 = 
m_µcQTTempC€ff
[
compID
][
uiQTLayî
] + 
rTu
.
gëC€fficõ¡Off£t
(compID);

1172 
Boﬁ
 
	gu£Tønsf‹mSkù
 = 
pcCU
->
gëTønsf‹mSkù
(
uiAbsP¨tIdx
, 
compID
);

1174 #i‡
ADAPTIVE_QP_SELECTION


1175 
TC€ff
 *
	gpcAæC€ff
 = 
m_µcQTTempAæC€ff
[
compID
][ 
uiQTLayî
 ] + 
rTu
.
gëC€fficõ¡Off£t
(compID);

1178 c⁄° 
UI¡
 
	guiChPªdMode
 = 
pcCU
->
gëI¡øDú
–
chTy≥
, 
uiAbsP¨tIdx
 );

1179 c⁄° 
UI¡
 
	g∑πsPîMöCU
 = 1<<(2*(
•s
.
gëMaxTŸÆCUDïth
(Ë- sps.
gëLog2DiffMaxMöCodögBlockSize
()));

1180 c⁄° 
UI¡
 
	guiChCodedMode
 = (
uiChPªdMode
==
DM_CHROMA_IDX
 && !
bIsLuma
Ë? 
pcCU
->
gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
gëChromasC‹ª•⁄dögPULumaIdx
(
uiAbsP¨tIdx
, 
chFmt
, 
∑πsPîMöCU
)) : uiChPredMode;

1181 c⁄° 
UI¡
 
	guiChFöÆMode
 = ((
chFmt
 =
CHROMA_422
Ë&& !
bIsLuma
Ë? 
g_chroma422I¡øAngÀM≠pögTabÀ
[
uiChCodedMode
] : uiChCodedMode;

1183 c⁄° 
I¡
 
	gblkX
 = 
g_auiRa°îToPñX
[ 
g_auiZsˇnToRa°î
[ 
uiAbsP¨tIdx
 ] ];

1184 c⁄° 
I¡
 
	gblkY
 = 
g_auiRa°îToPñY
[ 
g_auiZsˇnToRa°î
[ 
uiAbsP¨tIdx
 ] ];

1185 c⁄° 
I¡
 
	gbuf„rOff£t
 = 
blkX
 + (
blkY
 * 
MAX_CU_SIZE
);

1186 
Pñ
 *c⁄° 
	gícodîLumaResiduÆ
 = 
ªsiLuma
[
RESIDUAL_ENCODER_SIDE
 ] + 
buf„rOff£t
;

1187 
Pñ
 *c⁄° 
	gªc⁄°ru˘edLumaResiduÆ
 = 
ªsiLuma
[
RESIDUAL_RECONSTRUCTED
] + 
buf„rOff£t
;

1188 c⁄° 
Boﬁ
 
	gbU£CrossCPªdi˘i⁄
 = 
isChroma
(
compID
Ë&& (
uiChPªdMode
 =
DM_CHROMA_IDX
Ë&& 
checkCrossCPªdi˘i⁄
;

1189 c⁄° 
Boﬁ
 
	gbU£Rec⁄°ru˘edResiduÆF‹E°im©e
 = 
m_pcEncCfg
->
gëU£Rec⁄Ba£dCrossCPªdi˘i⁄E°im©e
();

1190 
Pñ
 *c⁄° 
	glumaResiduÆF‹E°im©e
 = 
bU£Rec⁄°ru˘edResiduÆF‹E°im©e
 ? 
ªc⁄°ru˘edLumaResiduÆ
 : 
ícodîLumaResiduÆ
;

1192 #i‡
DEBUG_STRING


1193 c⁄° 
I¡
 
	gdebugPªdModeMask
=
DebugSåögGëPªdModeMask
(
MODE_INTRA
);

1197 
DEBUG_STRING_NEW
(
sTemp
)

1199 #i‡!
DEBUG_STRING


1200 if–
	gdeÁu…0Save1Lﬂd2
 != 2 )

1203 c⁄° 
Boﬁ
 
bU£FûãªdPªdi˘i⁄s
=
TComPªdi˘i⁄
::
fûãrögI¡øRe„ªn˚Sam∂es
(
compID
, 
uiChFöÆMode
, 
uiWidth
, 
uiHeight
, 
chFmt
, 
•s
.
gëSpsR™geExãnsi⁄
().
gëI¡øSmoŸhögDißbÀdFœg
());

1205 
öôI¡øP©ã∫ChTy≥
–
rTu
, 
compID
, 
bU£FûãªdPªdi˘i⁄s
 
DEBUG_STRING_PASS_INTO
(
sDebug
) );

1208 
¥edI¡øAng
–
compID
, 
uiChFöÆMode
, 
piOrg
, 
uiSåide
, 
piPªd
, uiSåide, 
rTu
, 
bU£FûãªdPªdi˘i⁄s
 );

1211 if–
	gdeÁu…0Save1Lﬂd2
 == 1 )

1213 
Pñ
* 
pPªd
 = 
piPªd
;

1214 
Pñ
* 
	gpPªdBuf
 = 
m_pSh¨edPªdTønsf‹mSkù
[
compID
];

1215 
I¡
 
	gk
 = 0;

1216  
UI¡
 
	guiY
 = 0; uiY < 
	guiHeight
; uiY++ )

1218  
UI¡
 
	guiX
 = 0; uiX < 
	guiWidth
; uiX++ )

1220 
	gpPªdBuf
[ 
k
 ++ ] = 
pPªd
[ 
uiX
 ];

1222 
	gpPªd
 +
uiSåide
;

1226 #i‡!
DEBUG_STRING


1230 
Pñ
* 
	gpPªd
 = 
piPªd
;

1231 
Pñ
* 
	gpPªdBuf
 = 
m_pSh¨edPªdTønsf‹mSkù
[
compID
];

1232 
I¡
 
	gk
 = 0;

1233  
UI¡
 
	guiY
 = 0; uiY < 
	guiHeight
; uiY++ )

1235  
UI¡
 
	guiX
 = 0; uiX < 
	guiWidth
; uiX++ )

1237 
	gpPªd
[ 
uiX
 ] = 
pPªdBuf
[ 
k
 ++ ];

1239 
	gpPªd
 +
uiSåide
;

1247 
Pñ
* 
	gpOrg
 = 
piOrg
;

1248 
Pñ
* 
	gpPªd
 = 
piPªd
;

1249 
Pñ
* 
	gpResi
 = 
piResi
;

1251  
UI¡
 
	guiY
 = 0; uiY < 
	guiHeight
; uiY++ )

1253  
UI¡
 
	guiX
 = 0; uiX < 
	guiWidth
; uiX++ )

1255 
	gpResi
[ 
uiX
 ] = 
pOrg
[ uiX ] - 
pPªd
[ uiX ];

1258 
	gpOrg
 +
uiSåide
;

1259 
	gpResi
 +
uiSåide
;

1260 
	gpPªd
 +
uiSåide
;

1264 i‡(
	gpcCU
->
gëSli˚
()->
gëPPS
()->
gëPpsR™geExãnsi⁄
().
gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
())

1266 i‡(
	gbU£CrossCPªdi˘i⁄
)

1268 i‡(
xCÆcCrossComp⁄ítPªdi˘i⁄AÕha
–
rTu
, 
compID
, 
lumaResiduÆF‹E°im©e
, 
piResi
, 
uiWidth
, 
uiHeight
, 
MAX_CU_SIZE
, 
uiSåide
 ) == 0)

1272 
	gTComTrQu™t
::
¸ossComp⁄ítPªdi˘i⁄
 ( 
rTu
, 
compID
, 
ªc⁄°ru˘edLumaResiduÆ
, 
piResi
,ÖiResi, 
uiWidth
, 
uiHeight
, 
MAX_CU_SIZE
, 
uiSåide
, uiSåide, 
Ál£
 );

1274 i‡(
isLuma
(
compID
Ë&& !
	gbU£Rec⁄°ru˘edResiduÆF‹E°im©e
)

1276 
xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
–
ícodîLumaResiduÆ
, 
piResi
, 
rTu
, 0, 0, 
MAX_CU_SIZE
, 
uiSåide
 );

1282 if–
	gu£Tønsf‹mSkù
 ? 
	gm_pcEncCfg
->
gëU£RDOQTS
(Ë: 
m_pcEncCfg
->
gëU£RDOQ
() )

1284 
COEFF_SCAN_TYPE
 
sˇnTy≥
 = COEFF_SCAN_TYPE(
pcCU
->
gëC€fSˇnIdx
(
uiAbsP¨tIdx
, 
uiWidth
, 
uiHeight
, 
compID
));

1285 
	gm_pcE¡r›yCodî
->
e°im©eBô
–
m_pcTrQu™t
->
m_pcE°BôsSbac
, 
uiWidth
, 
uiHeight
, 
chTy≥
, 
sˇnTy≥
 );

1289 
TC€ff
 
	guiAbsSum
 = 0;

1290 i‡(
	gbIsLuma
)

1292 
	gpcCU
 ->
£tTrIdxSubP¨ts
 ( 
uiTrDïth
, 
uiAbsP¨tIdx
, 
uiFuŒDïth
 );

1295 c⁄° 
QpP¨am
 
cQP
(*
pcCU
, 
compID
);

1297 #i‡
RDOQ_CHROMA_LAMBDA


1298 
	gm_pcTrQu™t
->
£À˘Lambda
 (
compID
);

1301 
	gm_pcTrQu™t
->
å™sf‹mNxN
 ( 
rTu
, 
compID
, 
piResi
, 
uiSåide
, 
pcC€ff
,

1302 #i‡
ADAPTIVE_QP_SELECTION


1303 
pcAæC€ff
,

1305 
uiAbsSum
, 
cQP


1310 #i‡
DEBUG_STRING


1311 i‡–(
	guiAbsSum
 > 0Ë|| (
	gDebugO±i⁄Li°
::
DebugSåög_InvTøn
.
gëI¡
()&
debugPªdModeMask
) )

1313 i‡–
uiAbsSum
 > 0 )

1316 
m_pcTrQu™t
->
övTønsf‹mNxN
 ( 
rTu
, 
compID
, 
piResi
, 
uiSåide
, 
pcC€ff
, 
cQP
 
DEBUG_STRING_PASS_INTO_OPTIONAL
(&
sDebug
, (
DebugO±i⁄Li°
::
DebugSåög_InvTøn
.
gëI¡
()&
debugPªdModeMask
)) );

1320 
Pñ
* 
	gpResi
 = 
piResi
;

1321 
mem£t
–
pcC€ff
, 0, –
TC€ff
 ) * 
uiWidth
 * 
uiHeight
 );

1322  
UI¡
 
	guiY
 = 0; uiY < 
	guiHeight
; uiY++ )

1324 
mem£t
–
pResi
, 0, –
Pñ
 ) * 
uiWidth
 );

1325 
	gpResi
 +
uiSåide
;

1332 
Pñ
* 
	gpPªd
 = 
piPªd
;

1333 
Pñ
* 
	gpResi
 = 
piResi
;

1334 
Pñ
* 
	gpReco
 = 
piReco
;

1335 
Pñ
* 
	gpRecQt
 = 
piRecQt
;

1336 
Pñ
* 
	gpRecIPªd
 = 
piRecIPªd
;

1338 i‡(
	gpcCU
->
gëSli˚
()->
gëPPS
()->
gëPpsR™geExãnsi⁄
().
gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
())

1340 i‡(
	gbU£CrossCPªdi˘i⁄
)

1342 
	gTComTrQu™t
::
¸ossComp⁄ítPªdi˘i⁄
–
rTu
, 
compID
, 
ªc⁄°ru˘edLumaResiduÆ
, 
piResi
,ÖiResi, 
uiWidth
, 
uiHeight
, 
MAX_CU_SIZE
, 
uiSåide
, uiSåide, 
åue
 );

1344 i‡(
isLuma
(
compID
))

1346 
xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
–
ªc⁄°ru˘edLumaResiduÆ
, 
piResi
, 
rTu
, 0, 0, 
MAX_CU_SIZE
, 
uiSåide
 );

1350 #i‡
DEBUG_STRING


1351 
	g°d
::
°rög°ªam
 
ss
(°rög°ªam::
out
);

1352 c⁄° 
Boﬁ
 
	gbDebugPªd
=((
DebugO±i⁄Li°
::
DebugSåög_Pªd
.
gëI¡
()&
debugPªdModeMask
Ë&& 
DEBUG_STRING_CHANNEL_CONDITION
(
compID
));

1353 c⁄° 
Boﬁ
 
	gbDebugResi
=((
DebugO±i⁄Li°
::
DebugSåög_Resi
.
gëI¡
()&
debugPªdModeMask
Ë&& 
DEBUG_STRING_CHANNEL_CONDITION
(
compID
));

1354 c⁄° 
Boﬁ
 
	gbDebugReco
=((
DebugO±i⁄Li°
::
DebugSåög_Reco
.
gëI¡
()&
debugPªdModeMask
Ë&& 
DEBUG_STRING_CHANNEL_CONDITION
(
compID
));

1356 i‡(
	gbDebugPªd
 || 
	gbDebugResi
 || 
	gbDebugReco
)

1358 
	gss
 << "###: " << "CompID: " << 
	gcompID
 << "Öªd modê(ch/fö): " << 
	guiChPªdMode
 << "/" << 
	guiChFöÆMode
 << "ábsP¨tIdx: " << 
	grTu
.
GëAbsP¨tIdxTU
() << "\n";

1359  
UI¡
 
	guiY
 = 0; uiY < 
	guiHeight
; uiY++ )

1361 
	gss
 << "###: ";

1362 i‡(
	gbDebugPªd
)

1364 
	gss
 << " -Öred: ";

1365  
UI¡
 
	guiX
 = 0; uiX < 
	guiWidth
; uiX++ )

1367 
	gss
 << 
	gpPªd
[ 
uiX
 ] << ", ";

1370 i‡(
	gbDebugResi
)

1372 
	gss
 << " -Ñesi: ";

1374  
UI¡
 
	guiX
 = 0; uiX < 
	guiWidth
; uiX++ )

1376 i‡(
	gbDebugResi
)

1378 
	gss
 << 
	gpResi
[ 
uiX
 ] << ", ";

1380 
	gpReco
 [ 
uiX
 ] = 
Pñ
(
ClùBD
<
I¡
>–I¡(
pPªd
[uiX]Ë+ I¡(
pResi
[uiX]), 
bôDïth
 ));

1381 
	gpRecQt
 [ 
uiX
 ] = 
pReco
[ uiX ];

1382 
	gpRecIPªd
[ 
uiX
 ] = 
pReco
[ uiX ];

1384 i‡(
	gbDebugReco
)

1386 
	gss
 << " -Ñeco: ";

1387  
UI¡
 
	guiX
 = 0; uiX < 
	guiWidth
; uiX++ )

1389 
	gss
 << 
	gpReco
[ 
uiX
 ] << ", ";

1392 
	gpPªd
 +
uiSåide
;

1393 
	gpResi
 +
uiSåide
;

1394 
	gpReco
 +
uiSåide
;

1395 
	gpRecQt
 +
uiRecQtSåide
;

1396 
	gpRecIPªd
 +
uiRecIPªdSåide
;

1397 
	gss
 << "\n";

1399 
DEBUG_STRING_APPEND
(
sDebug
, 
ss
.
°r
())

1405  
UI¡
 
	guiY
 = 0; uiY < 
	guiHeight
; uiY++ )

1407  
UI¡
 
	guiX
 = 0; uiX < 
	guiWidth
; uiX++ )

1409 
	gpReco
 [ 
uiX
 ] = 
Pñ
(
ClùBD
<
I¡
>–I¡(
pPªd
[uiX]Ë+ I¡(
pResi
[uiX]), 
bôDïth
 ));

1410 
	gpRecQt
 [ 
uiX
 ] = 
pReco
[ uiX ];

1411 
	gpRecIPªd
[ 
uiX
 ] = 
pReco
[ uiX ];

1413 
	gpPªd
 +
uiSåide
;

1414 
	gpResi
 +
uiSåide
;

1415 
	gpReco
 +
uiSåide
;

1416 
	gpRecQt
 +
uiRecQtSåide
;

1417 
	gpRecIPªd
 +
uiRecIPªdSåide
;

1423 
	gruiDi°
 +
m_pcRdCo°
->
gëDi°P¨t
–
bôDïth
, 
piReco
, 
uiSåide
, 
piOrg
, uiSåide, 
uiWidth
, 
uiHeight
, 
compID
 );

1429 
Void


1430 
	gTEncSórch
::
xRecurI¡øCodögLumaQT
(
TComYuv
* 
pcOrgYuv
,

1431 
TComYuv
* 
pcPªdYuv
,

1432 
TComYuv
* 
pcResiYuv
,

1433 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE],

1434 
Di°‹ti⁄
& 
ruiDi°Y
,

1435 #i‡
HHI_RQT_INTRA_SPEEDUP


1436 
Boﬁ
 
bCheckFú°
,

1438 
DoubÀ
& 
dRDCo°
,

1439 
TComTU
& 
rTu


1440 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
))

1442 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

1443 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1444 c⁄° 
UI¡
 
uiFuŒDïth
 = 
rTu
.
	`GëTønsf‹mDïthTŸÆ
();

1445 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

1446 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

1447 
Boﬁ
 
bCheckFuŒ
 = ( 
uiLog2TrSize
 <
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
() );

1448 
Boﬁ
 
bCheckS∂ô
 = ( 
uiLog2TrSize
 > 
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) );

1450 
Pñ
 
ªsiLumaS∂ô
 [
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE];

1451 
Pñ
 
ªsiLumaSögÀ
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE];

1453 
Boﬁ
 
bMaöèöResiduÆ
[
NUMBER_OF_STORED_RESIDUAL_TYPES
];

1454 
UI¡
 
ªsiduÆTy≥Index
 = 0;ÑesiduÆTy≥Index < 
NUMBER_OF_STORED_RESIDUAL_TYPES
;ÑesidualTypeIndex++)

1456 
bMaöèöResiduÆ
[
ªsiduÆTy≥Index
] = 
åue
;

1459 
bMaöèöResiduÆ
[
RESIDUAL_ENCODER_SIDE
] = !(
m_pcEncCfg
->
	`gëU£Rec⁄Ba£dCrossCPªdi˘i⁄E°im©e
());

1461 #i‡
HHI_RQT_INTRA_SPEEDUP


1462 
I¡
 
maxTuSize
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
();

1463 
I¡
 
isI¡øSli˚
 = (
pcCU
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë=
I_SLICE
);

1465 
Boﬁ
 
noS∂ôI¡øMaxTuSize
 = 
bCheckFuŒ
;

1466 if(
m_pcEncCfg
->
	`gëRD≥«…y
(Ë&& ! 
isI¡øSli˚
)

1469 
noS∂ôI¡øMaxTuSize
 = ( 
uiLog2TrSize
 <
	`mö
(
maxTuSize
,4) );

1472 if(
m_pcEncCfg
->
	`gëRD≥«…y
()==2)

1474 
bCheckFuŒ
 = ( 
uiLog2TrSize
 <
	`mö
(
maxTuSize
,4));

1477 if–
bCheckFú°
 && 
noS∂ôI¡øMaxTuSize
 )

1480 
bCheckS∂ô
 = 
Ál£
;

1483 
I¡
 
maxTuSize
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
();

1484 
I¡
 
isI¡øSli˚
 = (
pcCU
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë=
I_SLICE
);

1486 if((
m_pcEncCfg
->
	`gëRD≥«…y
()==2Ë&& !
isI¡øSli˚
)

1488 
bCheckFuŒ
 = ( 
uiLog2TrSize
 <
	`mö
(
maxTuSize
,4));

1491 
DoubÀ
 
dSögÀCo°
 = 
MAX_DOUBLE
;

1492 
Di°‹ti⁄
 
uiSögÀDi°Luma
 = 0;

1493 
UI¡
 
uiSögÀCbfLuma
 = 0;

1494 
Boﬁ
 
checkTønsf‹mSkù
 = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£Tønsf‹mSkù
();

1495 
I¡
 
be°ModeId
[
MAX_NUM_COMPONENT
] = { 0, 0, 0};

1496 
checkTønsf‹mSkù
 &
	`TUCompRe˘HasAssocüãdTønsf‹mSkùFœg
(
rTu
.
	`gëRe˘
(
COMPONENT_Y
), 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
());

1497 
checkTønsf‹mSkù
 &(!
pcCU
->
	`gëCUTønsqu™tBy∑ss
(0));

1499 
	`as£π
 (
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
COMPONENT_Y
));

1500 c⁄° 
UI¡
 
tŸÆAdju°edDïthCh™
 = 
rTu
.
	`GëTønsf‹mDïthTŸÆAdj
(
COMPONENT_Y
);

1502 i‡–
m_pcEncCfg
->
	`gëU£Tønsf‹mSkùFa°
() )

1504 
checkTønsf‹mSkù
 &(
pcCU
->
	`gëP¨tôi⁄Size
(
uiAbsP¨tIdx
)==
SIZE_NxN
);

1507 if–
bCheckFuŒ
 )

1509 if(
checkTønsf‹mSkù
 =
åue
)

1512 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

1514 
Di°‹ti⁄
 
sögÀDi°TmpLuma
 = 0;

1515 
UI¡
 
sögÀCbfTmpLuma
 = 0;

1516 
DoubÀ
 
sögÀCo°Tmp
 = 0;

1517 
I¡
 
fú°CheckId
 = 0;

1519 
I¡
 
modeId
 = 
fú°CheckId
; modeId < 2; modeId ++)

1521 
	`DEBUG_STRING_NEW
(
sModeSåög
)

1522 
I¡
 
deÁu…0Save1Lﬂd2
 = 0;

1523 
sögÀDi°TmpLuma
=0;

1524 if(
modeId
 =
fú°CheckId
)

1526 
deÁu…0Save1Lﬂd2
 = 1;

1530 
deÁu…0Save1Lﬂd2
 = 2;

1534 
pcCU
->
	`£tTønsf‹mSkùSubP¨ts
 ( 
modeId
, 
COMPONENT_Y
, 
uiAbsP¨tIdx
, 
tŸÆAdju°edDïthCh™
 );

1535 
	`xI¡øCodögTUBlock
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLumaSögÀ
, 
Ál£
, 
sögÀDi°TmpLuma
, 
COMPONENT_Y
, 
rTu
 
	`DEBUG_STRING_PASS_INTO
(
sModeSåög
), 
deÁu…0Save1Lﬂd2
 );

1537 
sögÀCbfTmpLuma
 = 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
COMPONENT_Y
, 
uiTrDïth
 );

1540 if(
modeId
 =1 && 
sögÀCbfTmpLuma
 == 0)

1543 
sögÀCo°Tmp
 = 
MAX_DOUBLE
;

1547 
UI¡
 
uiSögÀBôs
 = 
	`xGëI¡øBôsQT
–
rTu
, 
åue
, 
Ál£
, false );

1548 
sögÀCo°Tmp
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiSögÀBôs
, 
sögÀDi°TmpLuma
 );

1550 if(
sögÀCo°Tmp
 < 
dSögÀCo°
)

1552 
	`DEBUG_STRING_SWAP
(
sDebug
, 
sModeSåög
)

1553 
dSögÀCo°
 = 
sögÀCo°Tmp
;

1554 
uiSögÀDi°Luma
 = 
sögÀDi°TmpLuma
;

1555 
uiSögÀCbfLuma
 = 
sögÀCbfTmpLuma
;

1557 
be°ModeId
[
COMPONENT_Y
] = 
modeId
;

1558 if(
be°ModeId
[
COMPONENT_Y
] =
fú°CheckId
)

1560 
	`xSt‹eI¡øResu…QT
(
COMPONENT_Y
, 
rTu
 );

1561 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_TEMP_BEST
 ] );

1564 i‡(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
())

1566 c⁄° 
I¡
 
xOff£t
 = 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
x0
;

1567 c⁄° 
I¡
 
yOff£t
 = 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
y0
;

1568 
UI¡
 
°‹edResiduÆIndex
 = 0; st‹edResiduÆIndex < 
NUMBER_OF_STORED_RESIDUAL_TYPES
; storedResidualIndex++)

1570 i‡(
bMaöèöResiduÆ
[
°‹edResiduÆIndex
])

1572 
	`xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
(
ªsiLuma
[
°‹edResiduÆIndex
], 
ªsiLumaSögÀ
[°‹edResiduÆIndex], 
rTu
, 
xOff£t
, 
yOff£t
, 
MAX_CU_SIZE
, MAX_CU_SIZE);

1577 i‡(
modeId
 =
fú°CheckId
)

1579 
m_pcRDGoOnSbacCodî
->
	`lﬂd
 ( 
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

1583 
pcCU
 ->
	`£tTønsf‹mSkùSubP¨ts
 ( 
be°ModeId
[
COMPONENT_Y
], COMPONENT_Y, 
uiAbsP¨tIdx
, 
tŸÆAdju°edDïthCh™
 );

1585 if(
be°ModeId
[
COMPONENT_Y
] =
fú°CheckId
)

1587 
	`xLﬂdI¡øResu…QT
(
COMPONENT_Y
, 
rTu
 );

1588 
pcCU
->
	`£tCbfSubP¨ts
 ( 
uiSögÀCbfLuma
 << 
uiTrDïth
, 
COMPONENT_Y
, 
uiAbsP¨tIdx
, 
rTu
.
	`GëTønsf‹mDïthTŸÆAdj
(COMPONENT_Y) );

1590 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_TEMP_BEST
 ] );

1596 if–
bCheckS∂ô
 )

1598 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

1601 
dSögÀCo°
 = 0.0;

1603 
pcCU
 ->
	`£tTønsf‹mSkùSubP¨ts
 ( 0, 
COMPONENT_Y
, 
uiAbsP¨tIdx
, 
tŸÆAdju°edDïthCh™
 );

1604 
	`xI¡øCodögTUBlock
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLumaSögÀ
, 
Ál£
, 
uiSögÀDi°Luma
, 
COMPONENT_Y
, 
rTu
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
));

1606 if–
bCheckS∂ô
 )

1608 
uiSögÀCbfLuma
 = 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
COMPONENT_Y
, 
uiTrDïth
 );

1611 
UI¡
 
uiSögÀBôs
 = 
	`xGëI¡øBôsQT
–
rTu
, 
åue
, 
Ál£
, false );

1613 if(
m_pcEncCfg
->
	`gëRD≥«…y
(Ë&& (
uiLog2TrSize
==5Ë&& !
isI¡øSli˚
)

1615 
uiSögÀBôs
=uiSingleBits*4;

1618 
dSögÀCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiSögÀBôs
, 
uiSögÀDi°Luma
 );

1620 i‡(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
())

1622 c⁄° 
I¡
 
xOff£t
 = 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
x0
;

1623 c⁄° 
I¡
 
yOff£t
 = 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
y0
;

1624 
UI¡
 
°‹edResiduÆIndex
 = 0; st‹edResiduÆIndex < 
NUMBER_OF_STORED_RESIDUAL_TYPES
; storedResidualIndex++)

1626 i‡(
bMaöèöResiduÆ
[
°‹edResiduÆIndex
])

1628 
	`xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
(
ªsiLuma
[
°‹edResiduÆIndex
], 
ªsiLumaSögÀ
[°‹edResiduÆIndex], 
rTu
, 
xOff£t
, 
yOff£t
, 
MAX_CU_SIZE
, MAX_CU_SIZE);

1635 if–
bCheckS∂ô
 )

1638 if–
bCheckFuŒ
 )

1640 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_TEST
 ] );

1641 
m_pcRDGoOnSbacCodî
->
	`lﬂd
 ( 
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

1645 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

1648 
DoubÀ
 
dS∂ôCo°
 = 0.0;

1649 
Di°‹ti⁄
 
uiS∂ôDi°Luma
 = 0;

1650 
UI¡
 
uiS∂ôCbfLuma
 = 0;

1652 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

1653 
	`DEBUG_STRING_NEW
(
sS∂ô
)

1656 
	`DEBUG_STRING_NEW
(
sChûd
)

1657 #i‡
HHI_RQT_INTRA_SPEEDUP


1658 
	`xRecurI¡øCodögLumaQT
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLumaS∂ô
, 
uiS∂ôDi°Luma
, 
bCheckFú°
, 
dS∂ôCo°
, 
tuRecur£Chûd
 
	`DEBUG_STRING_PASS_INTO
(
sChûd
) );

1660 
	`xRecurI¡øCodögLumaQT
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLumaS∂ô
, 
uiS∂ôDi°Luma
, 
dS∂ôCo°
, 
tuRecur£Chûd
 
	`DEBUG_STRING_PASS_INTO
(
sChûd
) );

1662 
	`DEBUG_STRING_APPEND
(
sS∂ô
, 
sChûd
)

1663 
uiS∂ôCbfLuma
 |
pcCU
->
	`gëCbf
–
tuRecur£Chûd
.
	`GëAbsP¨tIdxTU
(), 
COMPONENT_Y
,ÅuRecur£Chûd.
	`GëTønsf‹mDïthRñ
() );

1664 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
) );

1666 
UI¡
 
uiP¨tsDiv
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
();

1668 i‡(
uiS∂ôCbfLuma
)

1670 c⁄° 
UI¡
 
Êag
=1<<
uiTrDïth
;

1671 
UCh¨
 *
pBa£
=
pcCU
->
	`gëCbf
–
COMPONENT_Y
 );

1672  
UI¡
 
uiOffs
 = 0; uiOff†< 
uiP¨tsDiv
; uiOffs++ )

1674 
pBa£
[ 
uiAbsP¨tIdx
 + 
uiOffs
 ] |
Êag
;

1679 
m_pcRDGoOnSbacCodî
->
	`lﬂd
 ( 
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

1682 
UI¡
 
uiS∂ôBôs
 = 
	`xGëI¡øBôsQT
–
rTu
, 
åue
, 
Ál£
, false );

1683 
dS∂ôCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiS∂ôBôs
, 
uiS∂ôDi°Luma
 );

1686 if–
dS∂ôCo°
 < 
dSögÀCo°
 )

1689 
	`DEBUG_STRING_SWAP
(
sS∂ô
, 
sDebug
)

1690 
ruiDi°Y
 +
uiS∂ôDi°Luma
;

1691 
dRDCo°
 +
dS∂ôCo°
;

1693 i‡(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
())

1695 c⁄° 
I¡
 
xOff£t
 = 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
x0
;

1696 c⁄° 
I¡
 
yOff£t
 = 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
y0
;

1697 
UI¡
 
°‹edResiduÆIndex
 = 0; st‹edResiduÆIndex < 
NUMBER_OF_STORED_RESIDUAL_TYPES
; storedResidualIndex++)

1699 i‡(
bMaöèöResiduÆ
[
°‹edResiduÆIndex
])

1701 
	`xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
(
ªsiLuma
[
°‹edResiduÆIndex
], 
ªsiLumaS∂ô
[°‹edResiduÆIndex], 
rTu
, 
xOff£t
, 
yOff£t
, 
MAX_CU_SIZE
, MAX_CU_SIZE);

1710 
m_pcRDGoOnSbacCodî
->
	`lﬂd
 ( 
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_TEST
 ] );

1713 
pcCU
->
	`£tTrIdxSubP¨ts
–
uiTrDïth
, 
uiAbsP¨tIdx
, 
uiFuŒDïth
 );

1714 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
=
rTu
.
	`gëRe˘
(
COMPONENT_Y
);

1715 
pcCU
->
	`£tCbfSubP¨ts
 ( 
uiSögÀCbfLuma
 << 
uiTrDïth
, 
COMPONENT_Y
, 
uiAbsP¨tIdx
, 
tŸÆAdju°edDïthCh™
 );

1716 
pcCU
 ->
	`£tTønsf‹mSkùSubP¨ts
 ( 
be°ModeId
[
COMPONENT_Y
], COMPONENT_Y, 
uiAbsP¨tIdx
, 
tŸÆAdju°edDïthCh™
 );

1719 c⁄° 
UI¡
 
uiQTLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

1720 c⁄° 
UI¡
 
uiZOrdî
 = 
pcCU
->
	`gëZ‹dîIdxInCtu
(Ë+ 
uiAbsP¨tIdx
;

1721 c⁄° 
UI¡
 
uiWidth
 = 
tuRe˘
.
width
;

1722 c⁄° 
UI¡
 
uiHeight
 = 
tuRe˘
.
height
;

1723 
Pñ
* 
piSrc
 = 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`gëAddr
–
COMPONENT_Y
, 
uiAbsP¨tIdx
 );

1724 
UI¡
 
uiSrcSåide
 = 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`gëSåide
 ( 
COMPONENT_Y
 );

1725 
Pñ
* 
piDes
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
–
COMPONENT_Y
,ÖcCU->
	`gëCtuRsAddr
(), 
uiZOrdî
 );

1726 
UI¡
 
uiDesSåide
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëSåide
 ( 
COMPONENT_Y
 );

1728  
UI¡
 
uiY
 = 0; uiY < 
uiHeight
; uiY++, 
piSrc
 +
uiSrcSåide
, 
piDes
 +
uiDesSåide
 )

1730  
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

1732 
piDes
[ 
uiX
 ] = 
piSrc
[ uiX ];

1736 
ruiDi°Y
 +
uiSögÀDi°Luma
;

1737 
dRDCo°
 +
dSögÀCo°
;

1738 
	}
}

1741 
Void


1742 
	gTEncSórch
::
	$xSëI¡øResu…LumaQT
(
TComYuv
* 
pcRecoYuv
, 
TComTU
 &
rTu
)

1744 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

1745 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

1746 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1747 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

1748 if–
uiTrMode
 =
uiTrDïth
 )

1750 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

1751 
UI¡
 
uiQTLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

1755 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
=
rTu
.
	`gëRe˘
(
COMPONENT_Y
);

1756 c⁄° 
UI¡
 
c€ffOff£t
 = 
rTu
.
	`gëC€fficõ¡Off£t
(
COMPONENT_Y
);

1757 c⁄° 
UI¡
 
numC€ffInBlock
 = 
tuRe˘
.
width
 *ÅuRe˘.
height
;

1759 i‡(
numC€ffInBlock
!=0)

1761 c⁄° 
TC€ff
* 
§cC€ff
 = 
m_µcQTTempC€ff
[
COMPONENT_Y
][
uiQTLayî
] + 
c€ffOff£t
;

1762 
TC€ff
* 
de°C€ff
 = 
pcCU
->
	`gëC€ff
(
COMPONENT_Y
Ë+ 
c€ffOff£t
;

1763 ::
	`mem˝y
–
de°C€ff
, 
§cC€ff
, (
TC€ff
)*
numC€ffInBlock
 );

1764 #i‡
ADAPTIVE_QP_SELECTION


1765 c⁄° 
TC€ff
* 
§cAæC€ff
 = 
m_µcQTTempAæC€ff
[
COMPONENT_Y
][ 
uiQTLayî
 ] + 
c€ffOff£t
;

1766 
TC€ff
* 
de°AæC€ff
 = 
pcCU
->
	`gëAæC€ff
 (
COMPONENT_Y
Ë+ 
c€ffOff£t
;

1767 ::
	`mem˝y
–
de°AæC€ff
, 
§cAæC€ff
, –
TC€ff
 ) * 
numC€ffInBlock
 );

1769 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`c›yP¨tToP¨tComp⁄ít
–
COMPONENT_Y
, 
pcRecoYuv
, 
uiAbsP¨tIdx
, 
tuRe˘
.
width
,ÅuRe˘.
height
 );

1775 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

1778 
	`xSëI¡øResu…LumaQT
–
pcRecoYuv
, 
tuRecur£Chûd
 );

1779 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
));

1781 
	}
}

1784 
Void


1785 
	gTEncSórch
::
	$xSt‹eI¡øResu…QT
(c⁄° 
Comp⁄ítID
 
compID
, 
TComTU
 &
rTu
 )

1787 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

1788 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

1789 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1790 c⁄° 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

1791 i‡–
compID
==
COMPONENT_Y
 || 
uiTrMode
 =
uiTrDïth
 )

1793 
	`as£π
(
uiTrMode
 =
uiTrDïth
);

1794 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

1795 c⁄° 
UI¡
 
uiQTLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

1797 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

1799 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
=
rTu
.
	`gëRe˘
(
compID
);

1802 c⁄° 
UI¡
 
uiNumC€ff
 = 
tuRe˘
.
width
 *ÅuRe˘.
height
;

1803 
TC€ff
* 
pcC€ffSrc
 = 
m_µcQTTempC€ff
[
compID
] [ 
uiQTLayî
 ] + 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

1804 
TC€ff
* 
pcC€ffD°
 = 
m_pcQTTempTUC€ff
[
compID
];

1806 ::
	`mem˝y
–
pcC€ffD°
, 
pcC€ffSrc
, –
TC€ff
 ) * 
uiNumC€ff
 );

1807 #i‡
ADAPTIVE_QP_SELECTION


1808 
TC€ff
* 
pcAæC€ffSrc
 = 
m_µcQTTempAæC€ff
[
compID
] [ 
uiQTLayî
 ] + 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

1809 
TC€ff
* 
pcAæC€ffD°
 = 
m_µcQTTempTUAæC€ff
[
compID
];

1810 ::
	`mem˝y
–
pcAæC€ffD°
, 
pcAæC€ffSrc
, –
TC€ff
 ) * 
uiNumC€ff
 );

1813 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`c›yP¨tToP¨tComp⁄ít
–
compID
, &
m_pcQTTempTønsf‹mSkùTComYuv
, 
uiAbsP¨tIdx
, 
tuRe˘
.
width
,ÅuRe˘.
height
 );

1816 
	}
}

1819 
Void


1820 
	gTEncSórch
::
	$xLﬂdI¡øResu…QT
(c⁄° 
Comp⁄ítID
 
compID
, 
TComTU
 &
rTu
)

1822 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

1823 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

1824 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1825 c⁄° 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

1826 i‡–
compID
==
COMPONENT_Y
 || 
uiTrMode
 =
uiTrDïth
 )

1828 
	`as£π
(
uiTrMode
 =
uiTrDïth
);

1829 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

1830 c⁄° 
UI¡
 
uiQTLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

1831 c⁄° 
UI¡
 
uiZOrdî
 = 
pcCU
->
	`gëZ‹dîIdxInCtu
(Ë+ 
uiAbsP¨tIdx
;

1833 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

1835 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
=
rTu
.
	`gëRe˘
(
compID
);

1838 c⁄° 
UI¡
 
uiNumC€ff
 = 
tuRe˘
.
width
 *ÅuRe˘.
height
;

1839 
TC€ff
* 
pcC€ffD°
 = 
m_µcQTTempC€ff
[
compID
] [ 
uiQTLayî
 ] + 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

1840 
TC€ff
* 
pcC€ffSrc
 = 
m_pcQTTempTUC€ff
[
compID
];

1842 ::
	`mem˝y
–
pcC€ffD°
, 
pcC€ffSrc
, –
TC€ff
 ) * 
uiNumC€ff
 );

1843 #i‡
ADAPTIVE_QP_SELECTION


1844 
TC€ff
* 
pcAæC€ffD°
 = 
m_µcQTTempAæC€ff
[
compID
] [ 
uiQTLayî
 ] + 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

1845 
TC€ff
* 
pcAæC€ffSrc
 = 
m_µcQTTempTUAæC€ff
[
compID
];

1846 ::
	`mem˝y
–
pcAæC€ffD°
, 
pcAæC€ffSrc
, –
TC€ff
 ) * 
uiNumC€ff
 );

1849 
m_pcQTTempTønsf‹mSkùTComYuv
.
	`c›yP¨tToP¨tComp⁄ít
–
compID
, &
m_pcQTTempTComYuv
[ 
uiQTLayî
 ], 
uiAbsP¨tIdx
, 
tuRe˘
.
width
,ÅuRe˘.
height
 );

1851 
Pñ
* 
piRecIPªd
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
–
compID
,ÖcCU->
	`gëCtuRsAddr
(), 
uiZOrdî
 );

1852 
UI¡
 
uiRecIPªdSåide
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëSåide
 (
compID
);

1853 
Pñ
* 
piRecQt
 = 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`gëAddr
–
compID
, 
uiAbsP¨tIdx
 );

1854 
UI¡
 
uiRecQtSåide
 = 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`gëSåide
 (
compID
);

1855 
UI¡
 
uiWidth
 = 
tuRe˘
.
width
;

1856 
UI¡
 
uiHeight
 = 
tuRe˘
.
height
;

1857 
Pñ
* 
pRecQt
 = 
piRecQt
;

1858 
Pñ
* 
pRecIPªd
 = 
piRecIPªd
;

1859  
UI¡
 
uiY
 = 0; uiY < 
uiHeight
; uiY++ )

1861  
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

1863 
pRecIPªd
[ 
uiX
 ] = 
pRecQt
 [ uiX ];

1865 
pRecQt
 +
uiRecQtSåide
;

1866 
pRecIPªd
 +
uiRecIPªdSåide
;

1870 
	}
}

1872 
Void


1873 
	gTEncSórch
::
	$xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
–
Pñ
 *
pResiD°
,

1874 c⁄° 
Pñ
 *
pResiSrc
,

1875 
TComTU
 &
rTu
,

1876 c⁄° 
I¡
 
xOff£t
,

1877 c⁄° 
I¡
 
yOff£t
,

1878 c⁄° 
I¡
 
°rideD°
,

1879 c⁄° 
I¡
 
°rideSrc
 )

1881 c⁄° 
Pñ
 *
pSrc
 = 
pResiSrc
 + 
yOff£t
 * 
°rideSrc
 + 
xOff£t
;

1882 
Pñ
 *
pD°
 = 
pResiD°
 + 
yOff£t
 * 
°rideD°
 + 
xOff£t
;

1884  
I¡
 
y
 = 0; y < 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
height
; y++ )

1886 ::
	`mem˝y
–
pD°
, 
pSrc
, (
Pñ
Ë* 
rTu
.
	`gëRe˘
–
COMPONENT_Y
 ).
width
 );

1887 
pD°
 +
°rideD°
;

1888 
pSrc
 +
°rideSrc
;

1890 
	}
}

1892 
SCh¨


1893 
	gTEncSórch
::
	$xCÆcCrossComp⁄ítPªdi˘i⁄AÕha
–
TComTU
 &
rTu
,

1894 c⁄° 
Comp⁄ítID
 
compID
,

1895 c⁄° 
Pñ
* 
piResiL
,

1896 c⁄° 
Pñ
* 
piResiC
,

1897 c⁄° 
I¡
 
width
,

1898 c⁄° 
I¡
 
height
,

1899 c⁄° 
I¡
 
°rideL
,

1900 c⁄° 
I¡
 
°rideC
 )

1902 c⁄° 
Pñ
 *
pResiL
 = 
piResiL
;

1903 c⁄° 
Pñ
 *
pResiC
 = 
piResiC
;

1905 
TComD©aCU
 *
pCU
 = 
rTu
.
	`gëCU
();

1906 c⁄° 
I¡
 
absP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
–
compID
 );

1907 c⁄° 
I¡
 
diffBôDïth
 = 
pCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëDif„ª¡ülLumaChromaBôDïth
();

1909 
SCh¨
 
Æpha
 = 0;

1910 
I¡
 
SSxy
 = 0;

1911 
I¡
 
SSxx
 = 0;

1913  
UI¡
 
uiY
 = 0; uiY < 
height
; uiY++ )

1915  
UI¡
 
uiX
 = 0; uiX < 
width
; uiX++ )

1917 c⁄° 
Pñ
 
sˇÀdResiL
 = 
	`rightShi·
–
pResiL
[ 
uiX
 ], 
diffBôDïth
 );

1918 
SSxy
 +–
sˇÀdResiL
 * 
pResiC
[ 
uiX
 ] );

1919 
SSxx
 +–
sˇÀdResiL
 * scaledResiL );

1922 
pResiL
 +
°rideL
;

1923 
pResiC
 +
°rideC
;

1926 if–
SSxx
 != 0 )

1928 
DoubÀ
 
dAÕha
 = 
SSxy
 / 
	`DoubÀ
–
SSxx
 );

1929 
Æpha
 = 
	`SCh¨
(
Clù3
<
I¡
>(-16, 16, (I¡)(
dAÕha
 * 16)));

1931 c⁄° 
SCh¨
 
ÆphaQu™t
[17] = {0, 1, 1, 2, 2, 2, 4, 4, 4, 4, 4, 4, 8, 8, 8, 8, 8};

1933 
Æpha
 = (Æph®< 0Ë? -
ÆphaQu™t
[
	`I¡
(-alpha)] :álphaQuant[Int(alpha)];

1935 
pCU
->
	`£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
–
Æpha
, 
compID
, 
absP¨tIdx
, 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
( compID ) );

1937  
Æpha
;

1938 
	}
}

1940 
Void


1941 
	gTEncSórch
::
xRecurI¡øChromaCodögQT
(
TComYuv
* 
pcOrgYuv
,

1942 
TComYuv
* 
pcPªdYuv
,

1943 
TComYuv
* 
pcResiYuv
,

1944 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE],

1945 
Di°‹ti⁄
& 
ruiDi°
,

1946 
TComTU
& 
rTu


1947 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
))

1949 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

1950 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

1951 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

1952 c⁄° 
ChromaF‹m©
 
f‹m©
 = 
rTu
.
	`GëChromaF‹m©
();

1953 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

1954 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
f‹m©
);

1956 if–
uiTrMode
 =
uiTrDïth
 )

1958 i‡(!
rTu
.
	`Pro˚ssCh™√lSe˘i⁄
(
CHANNEL_TYPE_CHROMA
))

1963 c⁄° 
UI¡
 
uiFuŒDïth
 = 
rTu
.
	`GëTønsf‹mDïthTŸÆ
();

1965 
Boﬁ
 
checkTønsf‹mSkù
 = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£Tønsf‹mSkù
();

1966 
checkTønsf‹mSkù
 &
	`TUCompRe˘HasAssocüãdTønsf‹mSkùFœg
(
rTu
.
	`gëRe˘
(
COMPONENT_Cb
), 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
());

1968 i‡–
m_pcEncCfg
->
	`gëU£Tønsf‹mSkùFa°
() )

1970 
checkTønsf‹mSkù
 &
	`TUCompRe˘HasAssocüãdTønsf‹mSkùFœg
(
rTu
.
	`gëRe˘
(
COMPONENT_Y
), 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
());

1972 i‡(
checkTønsf‹mSkù
)

1974 
I¡
 
nbLumaSkù
 = 0;

1975 c⁄° 
UI¡
 
maxAbsP¨tIdxSub
=
uiAbsP¨tIdx
 + (
rTu
.
	`Pro˚ssögAŒQuadø¡s
(
COMPONENT_Cb
)?1:4);

1976 
UI¡
 
absP¨tIdxSub
 = 
uiAbsP¨tIdx
;ábsP¨tIdxSub < 
maxAbsP¨tIdxSub
;ábsPartIdxSub ++)

1978 
nbLumaSkù
 +
pcCU
->
	`gëTønsf‹mSkù
(
absP¨tIdxSub
, 
COMPONENT_Y
);

1980 
checkTønsf‹mSkù
 &(
nbLumaSkù
 > 0);

1985 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
numbîVÆidComp⁄íts
; ch++)

1987 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

1988 
	`DEBUG_STRING_NEW
(
sDebugBe°Mode
)

1991 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[
uiFuŒDïth
][
CI_QT_TRAFO_ROOT
] );

1993 c⁄° 
Boﬁ
 
•lôI¡oSubTUs
 = 
rTu
.
	`gëRe˘
(
compID
).
width
 !rTu.gëRe˘(compID).
height
;

1995 
TComTURecur£
 
	`TUIãøt‹
(
rTu
, 
Ál£
, (
•lôI¡oSubTUs
 ? 
TComTU
::
VERTICAL_SPLIT
 : TComTU::
DONT_SPLIT
), 
åue
, 
compID
);

1997 c⁄° 
UI¡
 
∑πIdxesPîSubTU
 = 
TUIãøt‹
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
);

2001 c⁄° 
UI¡
 
subTUAbsP¨tIdx
 = 
TUIãøt‹
.
	`GëAbsP¨tIdxTU
(
compID
);

2003 
DoubÀ
 
dSögÀCo°
 = 
MAX_DOUBLE
;

2004 
I¡
 
be°ModeId
 = 0;

2005 
Di°‹ti⁄
 
sögÀDi°C
 = 0;

2006 
UI¡
 
sögÀCbfC
 = 0;

2007 
Di°‹ti⁄
 
sögÀDi°CTmp
 = 0;

2008 
DoubÀ
 
sögÀCo°Tmp
 = 0;

2009 
UI¡
 
sögÀCbfCTmp
 = 0;

2010 
SCh¨
 
be°CrossCPªdi˘i⁄AÕha
 = 0;

2011 
I¡
 
be°Tønsf‹mSkùMode
 = 0;

2013 c⁄° 
Boﬁ
 
checkCrossComp⁄ítPªdi˘i⁄
 = (
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_CHROMA
, 
subTUAbsP¨tIdx
Ë=
DM_CHROMA_IDX
)

2014 && 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
()

2015 && (
pcCU
->
	`gëCbf
(
subTUAbsP¨tIdx
, 
COMPONENT_Y
, 
uiTrDïth
) != 0);

2017 c⁄° 
I¡
 
¸ossCPªdi˘i⁄ModesToTe°
 = 
checkCrossComp⁄ítPªdi˘i⁄
 ? 2 : 1;

2018 c⁄° 
I¡
 
å™sf‹mSkùModesToTe°
 = 
checkTønsf‹mSkù
 ? 2 : 1;

2019 c⁄° 
I¡
 
tŸÆModesToTe°
 = 
¸ossCPªdi˘i⁄ModesToTe°
 * 
å™sf‹mSkùModesToTe°
;

2020 
I¡
 
cuºModeId
 = 0;

2021 
I¡
 
deÁu…0Save1Lﬂd2
 = 0;

2023 
I¡
 
å™sf‹mSkùModeId
 = 0;Åønsf‹mSkùModeId < 
å™sf‹mSkùModesToTe°
;ÅransformSkipModeId++)

2025 
I¡
 
¸ossCPªdi˘i⁄ModeId
 = 0; crossCPªdi˘i⁄ModeId < 
¸ossCPªdi˘i⁄ModesToTe°
; crossCPredictionModeId++)

2027 
pcCU
->
	`£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
(0, 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
);

2028 
	`DEBUG_STRING_NEW
(
sDebugMode
)

2029 
pcCU
->
	`£tTønsf‹mSkùP¨tR™ge
–
å™sf‹mSkùModeId
, 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

2030 
cuºModeId
++;

2032 c⁄° 
Boﬁ
 
isO√Mode
 = (
tŸÆModesToTe°
 == 1);

2033 c⁄° 
Boﬁ
 
isLa°Mode
 = (
cuºModeId
 =
tŸÆModesToTe°
);

2035 i‡(
isO√Mode
)

2037 
deÁu…0Save1Lﬂd2
 = 0;

2039 i‡(!
isO√Mode
 && (
å™sf‹mSkùModeId
 =0Ë&& (
¸ossCPªdi˘i⁄ModeId
 == 0))

2041 
deÁu…0Save1Lﬂd2
 = 1;

2045 
deÁu…0Save1Lﬂd2
 = 2;

2048 
sögÀDi°CTmp
 = 0;

2050 
	`xI¡øCodögTUBlock
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLuma
, (
¸ossCPªdi˘i⁄ModeId
 !0), 
sögÀDi°CTmp
, 
compID
, 
TUIãøt‹
 
	`DEBUG_STRING_PASS_INTO
(
sDebugMode
), 
deÁu…0Save1Lﬂd2
);

2051 
sögÀCbfCTmp
 = 
pcCU
->
	`gëCbf
–
subTUAbsP¨tIdx
, 
compID
, 
uiTrDïth
);

2053 i‡–((
¸ossCPªdi˘i⁄ModeId
 =1Ë&& (
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
subTUAbsP¨tIdx
, 
compID
) == 0))

2054 || ((
å™sf‹mSkùModeId
 =1Ë&& (
sögÀCbfCTmp
 == 0)))

2056 
sögÀCo°Tmp
 = 
MAX_DOUBLE
;

2058 i‡(!
isO√Mode
)

2060 
UI¡
 
bôsTmp
 = 
	`xGëI¡øBôsQTChroma
–
TUIãøt‹
, 
compID
, 
Ál£
 );

2061 
sögÀCo°Tmp
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
bôsTmp
, 
sögÀDi°CTmp
);

2064 if(
sögÀCo°Tmp
 < 
dSögÀCo°
)

2066 
	`DEBUG_STRING_SWAP
(
sDebugBe°Mode
, 
sDebugMode
)

2067 
dSögÀCo°
 = 
sögÀCo°Tmp
;

2068 
sögÀDi°C
 = 
sögÀDi°CTmp
;

2069 
be°CrossCPªdi˘i⁄AÕha
 = (
¸ossCPªdi˘i⁄ModeId
 !0Ë? 
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
subTUAbsP¨tIdx
, 
compID
) : 0;

2070 
be°Tønsf‹mSkùMode
 = 
å™sf‹mSkùModeId
;

2071 
be°ModeId
 = 
cuºModeId
;

2072 
sögÀCbfC
 = 
sögÀCbfCTmp
;

2074 i‡(!
isO√Mode
 && !
isLa°Mode
)

2076 
	`xSt‹eI¡øResu…QT
(
compID
, 
TUIãøt‹
);

2077 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_TEMP_BEST
 ] );

2081 i‡(!
isO√Mode
 && !
isLa°Mode
)

2083 
m_pcRDGoOnSbacCodî
->
	`lﬂd
 ( 
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

2088 if(
be°ModeId
 < 
tŸÆModesToTe°
)

2090 
	`xLﬂdI¡øResu…QT
(
compID
, 
TUIãøt‹
);

2091 
pcCU
->
	`£tCbfP¨tR™ge
–
sögÀCbfC
 << 
uiTrDïth
, 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

2093 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
uiFuŒDïth
 ][ 
CI_TEMP_BEST
 ] );

2096 
	`DEBUG_STRING_APPEND
(
sDebug
, 
sDebugBe°Mode
)

2097 
pcCU
 ->
	`£tTønsf‹mSkùP¨tR™ge
 ( 
be°Tønsf‹mSkùMode
, 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

2098 
pcCU
 ->
	`£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
–
be°CrossCPªdi˘i⁄AÕha
, 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

2099 
ruiDi°
 +
sögÀDi°C
;

2100 } 
TUIãøt‹
.
	`√xtSe˘i⁄
(
rTu
));

2102 i‡(
•lôI¡oSubTUs
)

2104 
	`off£tSubTUCBFs
(
rTu
, 
compID
);

2110 
UI¡
 
uiS∂ôCbf
[
MAX_NUM_COMPONENT
] = {0,0,0};

2112 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

2113 c⁄° 
UI¡
 
uiTrDïthChûd
 = 
tuRecur£Chûd
.
	`GëTønsf‹mDïthRñ
();

2116 
	`DEBUG_STRING_NEW
(
sChûd
)

2118 
	`xRecurI¡øChromaCodögQT
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLuma
, 
ruiDi°
, 
tuRecur£Chûd
 
	`DEBUG_STRING_PASS_INTO
(
sChûd
) );

2120 
	`DEBUG_STRING_APPEND
(
sDebug
, 
sChûd
)

2121 c⁄° 
UI¡
 
uiAbsP¨tIdxSub
=
tuRecur£Chûd
.
	`GëAbsP¨tIdxTU
();

2123 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
numbîVÆidComp⁄íts
; ch++)

2125 
uiS∂ôCbf
[
ch
] |
pcCU
->
	`gëCbf
–
uiAbsP¨tIdxSub
, 
	`Comp⁄ítID
(ch), 
uiTrDïthChûd
 );

2127 }  
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
) );

2130 
UI¡
 
uiP¨tsDiv
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
();

2131 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
numbîVÆidComp⁄íts
; ch++)

2133 i‡(
uiS∂ôCbf
[
ch
])

2135 c⁄° 
UI¡
 
Êag
=1<<
uiTrDïth
;

2136 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

2137 
UCh¨
 *
pBa£
=
pcCU
->
	`gëCbf
–
compID
 );

2138  
UI¡
 
uiOffs
 = 0; uiOff†< 
uiP¨tsDiv
; uiOffs++ )

2140 
pBa£
[ 
uiAbsP¨tIdx
 + 
uiOffs
 ] |
Êag
;

2145 
	}
}

2150 
Void


2151 
	gTEncSórch
::
	$xSëI¡øResu…ChromaQT
(
TComYuv
* 
pcRecoYuv
, 
TComTU
 &
rTu
)

2153 i‡(!
rTu
.
	`Pro˚ssCh™√lSe˘i⁄
(
CHANNEL_TYPE_CHROMA
))

2157 
TComD©aCU
 *
pcCU
=
rTu
.
	`gëCU
();

2158 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

2159 c⁄° 
UI¡
 
uiTrDïth
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

2160 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

2161 if–
uiTrMode
 =
uiTrDïth
 )

2163 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

2164 
UI¡
 
uiQTLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

2167 c⁄° 
TComRe˘™gÀ
 &
tuRe˘Cb
=
rTu
.
	`gëRe˘
(
COMPONENT_Cb
);

2168 
UI¡
 
uiNumC€ffC
 = 
tuRe˘Cb
.
width
*tuRe˘Cb.
height
;

2169 c⁄° 
UI¡
 
off£t
 = 
rTu
.
	`gëC€fficõ¡Off£t
(
COMPONENT_Cb
);

2171 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
rTu
.
	`GëChromaF‹m©
());

2172 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
numbîVÆidComp⁄íts
; ch++)

2174 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
ch
);

2175 c⁄° 
TC€ff
* 
§c
 = 
m_µcQTTempC€ff
[
comp⁄ít
][
uiQTLayî
] + 
off£t
;

2176 
TC€ff
* 
de°
 = 
pcCU
->
	`gëC€ff
(
comp⁄ít
Ë+ 
off£t
;

2177 ::
	`mem˝y
–
de°
, 
§c
, (
TC€ff
)*
uiNumC€ffC
 );

2178 #i‡
ADAPTIVE_QP_SELECTION


2179 
TC€ff
* 
pcAæC€ffSrc
 = 
m_µcQTTempAæC€ff
[
comp⁄ít
][ 
uiQTLayî
 ] + 
off£t
;

2180 
TC€ff
* 
pcAæC€ffD°
 = 
pcCU
->
	`gëAæC€ff
(
comp⁄ít
Ë+ 
off£t
;

2181 ::
	`mem˝y
–
pcAæC€ffD°
, 
pcAæC€ffSrc
, –
TC€ff
 ) * 
uiNumC€ffC
 );

2187 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`c›yP¨tToP¨tComp⁄ít
–
COMPONENT_Cb
, 
pcRecoYuv
, 
uiAbsP¨tIdx
, 
tuRe˘Cb
.
width
,ÅuRe˘Cb.
height
 );

2188 
m_pcQTTempTComYuv
[ 
uiQTLayî
 ].
	`c›yP¨tToP¨tComp⁄ít
–
COMPONENT_Cr
, 
pcRecoYuv
, 
uiAbsP¨tIdx
, 
tuRe˘Cb
.
width
,ÅuRe˘Cb.
height
 );

2192 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

2195 
	`xSëI¡øResu…ChromaQT
–
pcRecoYuv
, 
tuRecur£Chûd
 );

2196 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
));

2198 
	}
}

2202 
Void


2203 
	gTEncSórch
::
e°I¡øPªdLumaQT
(
TComD©aCU
* 
pcCU
,

2204 
TComYuv
* 
pcOrgYuv
,

2205 
TComYuv
* 
pcPªdYuv
,

2206 
TComYuv
* 
pcResiYuv
,

2207 
TComYuv
* 
pcRecoYuv
,

2208 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE]

2209 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
))

2211 c⁄° 
UI¡
 
uiDïth
 = 
pcCU
->
	`gëDïth
(0);

2212 c⁄° 
UI¡
 
uiInôTrDïth
 = 
pcCU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2Nx2N
 ? 0 : 1;

2213 c⁄° 
UI¡
 
uiNumPU
 = 1<<(2*
uiInôTrDïth
);

2214 c⁄° 
UI¡
 
uiQNumP¨ts
 = 
pcCU
->
	`gëTŸÆNumP¨t
() >> 2;

2215 c⁄° 
UI¡
 
uiWidthBô
 = 
pcCU
->
	`gëI¡øSizeIdx
(0);

2216 c⁄° 
ChromaF‹m©
 
chFmt
 = 
pcCU
->
	`gëPic
()->
	`gëChromaF‹m©
();

2217 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
	`gëNumbîVÆidComp⁄íts
(
chFmt
);

2218 c⁄° 
TComSPS
 &
•s
 = *(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

2219 c⁄° 
TComPPS
 &
µs
 = *(
pcCU
->
	`gëSli˚
()->
	`gëPPS
());

2220 
Di°‹ti⁄
 
uiOvîÆlDi°Y
 = 0;

2221 
UI¡
 
C™dNum
;

2222 
DoubÀ
 
C™dCo°Li°
[ 
FAST_UDI_MAX_RDMODE_NUM
 ];

2223 
Pñ
 
ªsiLumaPU
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE];

2225 
Boﬁ
 
bMaöèöResiduÆ
[
NUMBER_OF_STORED_RESIDUAL_TYPES
];

2226 
UI¡
 
ªsiduÆTy≥Index
 = 0;ÑesiduÆTy≥Index < 
NUMBER_OF_STORED_RESIDUAL_TYPES
;ÑesidualTypeIndex++)

2228 
bMaöèöResiduÆ
[
ªsiduÆTy≥Index
] = 
åue
;

2231 
bMaöèöResiduÆ
[
RESIDUAL_ENCODER_SIDE
] = !(
m_pcEncCfg
->
	`gëU£Rec⁄Ba£dCrossCPªdi˘i⁄E°im©e
());

2234 #i‡
FULL_NBIT


2235 c⁄° 
DoubÀ
 
sqπLambdaF‹Fú°Pass
(
m_pcEncCfg
->
	`gëCo°Mode
()==
COST_MIXED_LOSSLESS_LOSSY_CODING
 && 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(0)) ?

2236 
	`sqπ
(0.57 * 
	`pow
(2.0, ((
LOSSLESS_AND_MIXED_LOSSLESS_RD_COST_TEST_QP_PRIME
 - 12) / 3.0)))

2237 : 
m_pcRdCo°
->
	`gëSqπLambda
();

2239 c⁄° 
DoubÀ
 
sqπLambdaF‹Fú°Pass
(
m_pcEncCfg
->
	`gëCo°Mode
()==
COST_MIXED_LOSSLESS_LOSSY_CODING
 && 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(0)) ?

2240 
	`sqπ
(0.57 * 
	`pow
(2.0, ((
LOSSLESS_AND_MIXED_LOSSLESS_RD_COST_TEST_QP_PRIME
 - 12 - 6 * (
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
) - 8)) / 3.0)))

2241 : 
m_pcRdCo°
->
	`gëSqπLambda
();

2245 i‡–
µs
.
	`gëU£DQP
(Ë=
åue
)

2247 
pcCU
->
	`£tQPSubP¨ts
–pcCU->
	`gëQP
(0), 0, 
uiDïth
 );

2251 
pcCU
->
	`£tQPSubP¨ts
–pcCU->
	`gëSli˚
()->
	`gëSli˚Qp
(), 0, 
uiDïth
 );

2255 
TComTURecur£
 
	`tuRecur£CU
(
pcCU
, 0);

2256 
TComTURecur£
 
	`tuRecur£WôhPU
(
tuRecur£CU
, 
Ál£
, (
uiInôTrDïth
==0)?
TComTU
::
DONT_SPLIT
 : TComTU::
QUAD_SPLIT
);

2260 c⁄° 
UI¡
 
uiP¨tOff£t
=
tuRecur£WôhPU
.
	`GëAbsP¨tIdxTU
();

2264 
	`DEBUG_STRING_NEW
(
sTemp2
)

2267 
I¡
 
numModesAvaûabÀ
 = 35;

2268 
UI¡
 
uiRdModeLi°
[
FAST_UDI_MAX_RDMODE_NUM
];

2269 
I¡
 
numModesF‹FuŒRD
 = 
m_pcEncCfg
->
	`gëFa°UDIU£MPME«bÀd
()?
g_aucI¡øModeNumFa°_U£MPM
[ 
uiWidthBô
 ] : 
g_aucI¡øModeNumFa°_NŸU£MPM
[ uiWidthBit ];

2272 
	`as£π
 (
tuRecur£WôhPU
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
COMPONENT_Y
));

2273 
	`öôI¡øP©ã∫ChTy≥
–
tuRecur£WôhPU
, 
COMPONENT_Y
, 
åue
 
	`DEBUG_STRING_PASS_INTO
(
sTemp2
) );

2275 
Boﬁ
 
doFa°Sórch
 = (
numModesF‹FuŒRD
 !
numModesAvaûabÀ
);

2276 i‡(
doFa°Sórch
)

2278 
	`as£π
(
numModesF‹FuŒRD
 < 
numModesAvaûabÀ
);

2280  
I¡
 
i
=0; i < 
numModesF‹FuŒRD
; i++ )

2282 
C™dCo°Li°
[ 
i
 ] = 
MAX_DOUBLE
;

2284 
C™dNum
 = 0;

2286 c⁄° 
TComRe˘™gÀ
 &
puRe˘
=
tuRecur£WôhPU
.
	`gëRe˘
(
COMPONENT_Y
);

2287 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
tuRecur£WôhPU
.
	`GëAbsP¨tIdxTU
();

2289 
Pñ
* 
piOrg
 = 
pcOrgYuv
 ->
	`gëAddr
–
COMPONENT_Y
, 
uiAbsP¨tIdx
 );

2290 
Pñ
* 
piPªd
 = 
pcPªdYuv
->
	`gëAddr
–
COMPONENT_Y
, 
uiAbsP¨tIdx
 );

2291 
UI¡
 
uiSåide
 = 
pcPªdYuv
->
	`gëSåide
–
COMPONENT_Y
 );

2292 
Di°P¨am
 
di°P¨am
;

2293 c⁄° 
Boﬁ
 
bU£Hadam¨d
=
pcCU
->
	`gëCUTønsqu™tBy∑ss
(0) == 0;

2294 
m_pcRdCo°
->
	`£tDi°P¨am
(
di°P¨am
, 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
), 
piOrg
, 
uiSåide
, 
piPªd
, uiSåide, 
puRe˘
.
width
,ÖuRe˘.
height
, 
bU£Hadam¨d
);

2295 
di°P¨am
.
bAµlyWeight
 = 
Ál£
;

2296  
I¡
 
modeIdx
 = 0; modeIdx < 
numModesAvaûabÀ
; modeIdx++ )

2298 
UI¡
 
uiMode
 = 
modeIdx
;

2299 
Di°‹ti⁄
 
uiSad
 = 0;

2301 c⁄° 
Boﬁ
 
bU£Fûãr
=
TComPªdi˘i⁄
::
	`fûãrögI¡øRe„ªn˚Sam∂es
(
COMPONENT_Y
, 
uiMode
, 
puRe˘
.
width
,ÖuRe˘.
height
, 
chFmt
, 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`gëI¡øSmoŸhögDißbÀdFœg
());

2303 
	`¥edI¡øAng
–
COMPONENT_Y
, 
uiMode
, 
piOrg
, 
uiSåide
, 
piPªd
, uiSåide, 
tuRecur£WôhPU
, 
bU£Fûãr
, 
TComPªdi˘i⁄
::
	`U£DPCMF‹Fú°PassI¡øE°im©i⁄
(tuRecurseWithPU, uiMode) );

2306 
uiSad
+=
di°P¨am
.
	`Di°Func
(&distParam);

2308 
UI¡
 
iModeBôs
 = 0;

2311 
iModeBôs
+=
	`xModeBôsI¡ø
–
pcCU
, 
uiMode
, 
uiP¨tOff£t
, 
uiDïth
, 
CHANNEL_TYPE_LUMA
 );

2313 
DoubÀ
 
co°
 = (DoubÀ)
uiSad
 + (DoubÀ)
iModeBôs
 * 
sqπLambdaF‹Fú°Pass
;

2315 #i‡
DEBUG_INTRA_SEARCH_COSTS


2316 
°d
::
cout
 << "1°Öas†modê" << 
uiMode
 << " SAD = " << 
uiSad
 << ", modêbô†" << 
iModeBôs
 << ", co° = " << 
co°
 << "\n";

2319 
C™dNum
 +
	`xUpd©eC™dLi°
–
uiMode
, 
co°
, 
numModesF‹FuŒRD
, 
uiRdModeLi°
, 
C™dCo°Li°
 );

2322 i‡(
m_pcEncCfg
->
	`gëFa°UDIU£MPME«bÀd
())

2324 
I¡
 
uiPªds
[
NUM_MOST_PROBABLE_MODES
] = {-1, -1, -1};

2326 
I¡
 
iMode
 = -1;

2327 
pcCU
->
	`gëI¡øDúPªdi˘‹
–
uiP¨tOff£t
, 
uiPªds
, 
COMPONENT_Y
, &
iMode
 );

2329 c⁄° 
I¡
 
numC™d
 = ( 
iMode
 >0 ) ? iModê: 
	`I¡
(
NUM_MOST_PROBABLE_MODES
);

2331  
I¡
 
j
=0; j < 
numC™d
; j++)

2333 
Boﬁ
 
mo°ProbabÀModeIn˛uded
 = 
Ál£
;

2334 
I¡
 
mo°ProbabÀMode
 = 
uiPªds
[
j
];

2336  
I¡
 
i
=0; i < 
numModesF‹FuŒRD
; i++)

2338 
mo°ProbabÀModeIn˛uded
 |(
mo°ProbabÀMode
 =
uiRdModeLi°
[
i
]);

2340 i‡(!
mo°ProbabÀModeIn˛uded
)

2342 
uiRdModeLi°
[
numModesF‹FuŒRD
++] = 
mo°ProbabÀMode
;

2349  
I¡
 
i
=0; i < 
numModesF‹FuŒRD
; i++)

2351 
uiRdModeLi°
[
i
] = i;

2356 #i‡
HHI_RQT_INTRA_SPEEDUP_MOD


2357 
UI¡
 
uiSec⁄dBe°Mode
 = 
MAX_UINT
;

2358 
DoubÀ
 
dSec⁄dBe°PUCo°
 = 
MAX_DOUBLE
;

2360 
	`DEBUG_STRING_NEW
(
sPU
)

2361 
UI¡
 
uiBe°PUMode
 = 0;

2362 
Di°‹ti⁄
 
uiBe°PUDi°Y
 = 0;

2363 
DoubÀ
 
dBe°PUCo°
 = 
MAX_DOUBLE
;

2365 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


2366 
UI¡
 
max
=
numModesF‹FuŒRD
;

2368 i‡(
DebugO±i⁄Li°
::
F‹˚LumaMode
.
	`isSë
())

2370 
max
=0;

2372  
UI¡
 
uiMode
 = 0; uiModê< 
max
; uiMode++)

2374  
UI¡
 
uiMode
 = 0; uiModê< 
numModesF‹FuŒRD
; uiMode++ )

2378 
UI¡
 
uiOrgMode
 = 
uiRdModeLi°
[
uiMode
];

2380 
pcCU
->
	`£tI¡øDúSubP¨ts
 ( 
CHANNEL_TYPE_LUMA
, 
uiOrgMode
, 
uiP¨tOff£t
, 
uiDïth
 + 
uiInôTrDïth
 );

2382 
	`DEBUG_STRING_NEW
(
sMode
)

2384 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[
uiDïth
][
CI_CURR_BEST
] );

2387 
Di°‹ti⁄
 
uiPUDi°Y
 = 0;

2388 
DoubÀ
 
dPUCo°
 = 0.0;

2389 #i‡
HHI_RQT_INTRA_SPEEDUP


2390 
	`xRecurI¡øCodögLumaQT
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLumaPU
, 
uiPUDi°Y
, 
åue
, 
dPUCo°
, 
tuRecur£WôhPU
 
	`DEBUG_STRING_PASS_INTO
(
sMode
) );

2392 
	`xRecurI¡øCodögLumaQT
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLumaPU
, 
uiPUDi°Y
, 
dPUCo°
, 
tuRecur£WôhPU
 
	`DEBUG_STRING_PASS_INTO
(
sMode
) );

2395 #i‡
DEBUG_INTRA_SEARCH_COSTS


2396 
°d
::
cout
 << "2ndÖas†[luma,chroma] modê[" << 
	`I¡
(
pcCU
->
	`gëI¡øDú
(
CHANNEL_TYPE_LUMA
, 
uiP¨tOff£t
)Ë<< "," << I¡’cCU->gëI¡øDú(
CHANNEL_TYPE_CHROMA
, uiP¨tOff£t)Ë<< "] co° = " << 
dPUCo°
 << "\n";

2400 if–
dPUCo°
 < 
dBe°PUCo°
 )

2402 
	`DEBUG_STRING_SWAP
(
sPU
, 
sMode
)

2403 #i‡
HHI_RQT_INTRA_SPEEDUP_MOD


2404 
uiSec⁄dBe°Mode
 = 
uiBe°PUMode
;

2405 
dSec⁄dBe°PUCo°
 = 
dBe°PUCo°
;

2407 
uiBe°PUMode
 = 
uiOrgMode
;

2408 
uiBe°PUDi°Y
 = 
uiPUDi°Y
;

2409 
dBe°PUCo°
 = 
dPUCo°
;

2411 
	`xSëI¡øResu…LumaQT
–
pcRecoYuv
, 
tuRecur£WôhPU
 );

2413 i‡(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
())

2415 c⁄° 
I¡
 
xOff£t
 = 
tuRecur£WôhPU
.
	`gëRe˘
–
COMPONENT_Y
 ).
x0
;

2416 c⁄° 
I¡
 
yOff£t
 = 
tuRecur£WôhPU
.
	`gëRe˘
–
COMPONENT_Y
 ).
y0
;

2417 
UI¡
 
°‹edResiduÆIndex
 = 0; st‹edResiduÆIndex < 
NUMBER_OF_STORED_RESIDUAL_TYPES
; storedResidualIndex++)

2419 i‡(
bMaöèöResiduÆ
[
°‹edResiduÆIndex
])

2421 
	`xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
(
ªsiLuma
[
°‹edResiduÆIndex
], 
ªsiLumaPU
[°‹edResiduÆIndex], 
tuRecur£WôhPU
, 
xOff£t
, 
yOff£t
, 
MAX_CU_SIZE
, MAX_CU_SIZE );

2426 
UI¡
 
uiQP¨tNum
 = 
tuRecur£WôhPU
.
	`GëAbsP¨tIdxNumP¨ts
();

2428 ::
	`mem˝y
–
m_puhQTTempTrIdx
, 
pcCU
->
	`gëTønsf‹mIdx
(Ë+ 
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2429 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< 
numbîVÆidComp⁄íts
; component++)

2431 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp⁄ít
);

2432 ::
	`mem˝y
–
m_puhQTTempCbf
[
compID
], 
pcCU
->
	`gëCbf
–compID ) + 
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2433 ::
	`mem˝y
–
m_puhQTTempTønsf‹mSkùFœg
[
compID
], 
pcCU
->
	`gëTønsf‹mSkù
(compIDË+ 
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2436 #i‡
HHI_RQT_INTRA_SPEEDUP_MOD


2437 if–
dPUCo°
 < 
dSec⁄dBe°PUCo°
 )

2439 
uiSec⁄dBe°Mode
 = 
uiOrgMode
;

2440 
dSec⁄dBe°PUCo°
 = 
dPUCo°
;

2445 #i‡
HHI_RQT_INTRA_SPEEDUP


2446 #i‡
HHI_RQT_INTRA_SPEEDUP_MOD


2447  
UI¡
 
ui
 =0; ui < 2; ++ui )

2450 #i‡
HHI_RQT_INTRA_SPEEDUP_MOD


2451 
UI¡
 
uiOrgMode
 = 
ui
 ? 
uiSec⁄dBe°Mode
 : 
uiBe°PUMode
;

2452 if–
uiOrgMode
 =
MAX_UINT
 )

2457 
UI¡
 
uiOrgMode
 = 
uiBe°PUMode
;

2460 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


2461 i‡(
DebugO±i⁄Li°
::
F‹˚LumaMode
.
	`isSë
())

2463 
uiOrgMode
 = 
DebugO±i⁄Li°
::
F‹˚LumaMode
.
	`gëI¡
();

2467 
pcCU
->
	`£tI¡øDúSubP¨ts
 ( 
CHANNEL_TYPE_LUMA
, 
uiOrgMode
, 
uiP¨tOff£t
, 
uiDïth
 + 
uiInôTrDïth
 );

2468 
	`DEBUG_STRING_NEW
(
sModeTªe
)

2471 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[
uiDïth
][
CI_CURR_BEST
] );

2474 
Di°‹ti⁄
 
uiPUDi°Y
 = 0;

2475 
DoubÀ
 
dPUCo°
 = 0.0;

2477 
	`xRecurI¡øCodögLumaQT
–
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLumaPU
, 
uiPUDi°Y
, 
Ál£
, 
dPUCo°
, 
tuRecur£WôhPU
 
	`DEBUG_STRING_PASS_INTO
(
sModeTªe
));

2480 if–
dPUCo°
 < 
dBe°PUCo°
 )

2482 
	`DEBUG_STRING_SWAP
(
sPU
, 
sModeTªe
)

2483 
uiBe°PUMode
 = 
uiOrgMode
;

2484 
uiBe°PUDi°Y
 = 
uiPUDi°Y
;

2485 
dBe°PUCo°
 = 
dPUCo°
;

2487 
	`xSëI¡øResu…LumaQT
–
pcRecoYuv
, 
tuRecur£WôhPU
 );

2489 i‡(
µs
.
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
())

2491 c⁄° 
I¡
 
xOff£t
 = 
tuRecur£WôhPU
.
	`gëRe˘
–
COMPONENT_Y
 ).
x0
;

2492 c⁄° 
I¡
 
yOff£t
 = 
tuRecur£WôhPU
.
	`gëRe˘
–
COMPONENT_Y
 ).
y0
;

2493 
UI¡
 
°‹edResiduÆIndex
 = 0; st‹edResiduÆIndex < 
NUMBER_OF_STORED_RESIDUAL_TYPES
; storedResidualIndex++)

2495 i‡(
bMaöèöResiduÆ
[
°‹edResiduÆIndex
])

2497 
	`xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
(
ªsiLuma
[
°‹edResiduÆIndex
], 
ªsiLumaPU
[°‹edResiduÆIndex], 
tuRecur£WôhPU
, 
xOff£t
, 
yOff£t
, 
MAX_CU_SIZE
, MAX_CU_SIZE );

2502 c⁄° 
UI¡
 
uiQP¨tNum
 = 
tuRecur£WôhPU
.
	`GëAbsP¨tIdxNumP¨ts
();

2503 ::
	`mem˝y
–
m_puhQTTempTrIdx
, 
pcCU
->
	`gëTønsf‹mIdx
(Ë+ 
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2505 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< 
numbîVÆidComp⁄íts
; component++)

2507 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp⁄ít
);

2508 ::
	`mem˝y
–
m_puhQTTempCbf
[
compID
], 
pcCU
->
	`gëCbf
–compID ) + 
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2509 ::
	`mem˝y
–
m_puhQTTempTønsf‹mSkùFœg
[
compID
], 
pcCU
->
	`gëTønsf‹mSkù
(compIDË+ 
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2515 
	`DEBUG_STRING_APPEND
(
sDebug
, 
sPU
)

2518 
uiOvîÆlDi°Y
 +
uiBe°PUDi°Y
;

2521 c⁄° 
UI¡
 
uiQP¨tNum
 = 
tuRecur£WôhPU
.
	`GëAbsP¨tIdxNumP¨ts
();

2522 ::
	`mem˝y
–
pcCU
->
	`gëTønsf‹mIdx
(Ë+ 
uiP¨tOff£t
, 
m_puhQTTempTrIdx
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2523 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< 
numbîVÆidComp⁄íts
; component++)

2525 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp⁄ít
);

2526 ::
	`mem˝y
–
pcCU
->
	`gëCbf
–
compID
 ) + 
uiP¨tOff£t
, 
m_puhQTTempCbf
[compID], 
uiQP¨tNum
 * –
UCh¨
 ) );

2527 ::
	`mem˝y
–
pcCU
->
	`gëTønsf‹mSkù
–
compID
 ) + 
uiP¨tOff£t
, 
m_puhQTTempTønsf‹mSkùFœg
[compID ], 
uiQP¨tNum
 * –
UCh¨
 ) );

2531 if–!
tuRecur£WôhPU
.
	`IsLa°Se˘i⁄
() )

2533 c⁄° 
TComRe˘™gÀ
 &
puRe˘
=
tuRecur£WôhPU
.
	`gëRe˘
(
COMPONENT_Y
);

2534 c⁄° 
UI¡
 
uiCompWidth
 = 
puRe˘
.
width
;

2535 c⁄° 
UI¡
 
uiCompHeight
 = 
puRe˘
.
height
;

2537 c⁄° 
UI¡
 
uiZOrdî
 = 
pcCU
->
	`gëZ‹dîIdxInCtu
(Ë+ 
uiP¨tOff£t
;

2538 
Pñ
* 
piDes
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
–
COMPONENT_Y
,ÖcCU->
	`gëCtuRsAddr
(), 
uiZOrdî
 );

2539 c⁄° 
UI¡
 
uiDesSåide
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëSåide
–
COMPONENT_Y
);

2540 c⁄° 
Pñ
* 
piSrc
 = 
pcRecoYuv
->
	`gëAddr
–
COMPONENT_Y
, 
uiP¨tOff£t
 );

2541 c⁄° 
UI¡
 
uiSrcSåide
 = 
pcRecoYuv
->
	`gëSåide
–
COMPONENT_Y
);

2543  
UI¡
 
uiY
 = 0; uiY < 
uiCompHeight
; uiY++, 
piSrc
 +
uiSrcSåide
, 
piDes
 +
uiDesSåide
 )

2545  
UI¡
 
uiX
 = 0; uiX < 
uiCompWidth
; uiX++ )

2547 
piDes
[ 
uiX
 ] = 
piSrc
[ uiX ];

2553 
pcCU
->
	`£tI¡øDúSubP¨ts
 ( 
CHANNEL_TYPE_LUMA
, 
uiBe°PUMode
, 
uiP¨tOff£t
, 
uiDïth
 + 
uiInôTrDïth
 );

2554 } 
tuRecur£WôhPU
.
	`√xtSe˘i⁄
(
tuRecur£CU
));

2557 if–
uiNumPU
 > 1 )

2559 
UI¡
 
uiCombCbfY
 = 0;

2560 
UI¡
 
uiCombCbfU
 = 0;

2561 
UI¡
 
uiCombCbfV
 = 0;

2562 
UI¡
 
uiP¨tIdx
 = 0;

2563  
UI¡
 
uiP¨t
 = 0; uiP¨à< 4; uiP¨t++, 
uiP¨tIdx
 +
uiQNumP¨ts
 )

2565 
uiCombCbfY
 |
pcCU
->
	`gëCbf
–
uiP¨tIdx
, 
COMPONENT_Y
, 1 );

2566 
uiCombCbfU
 |
pcCU
->
	`gëCbf
–
uiP¨tIdx
, 
COMPONENT_Cb
, 1 );

2567 
uiCombCbfV
 |
pcCU
->
	`gëCbf
–
uiP¨tIdx
, 
COMPONENT_Cr
, 1 );

2569  
UI¡
 
uiOffs
 = 0; uiOff†< 4 * 
uiQNumP¨ts
; uiOffs++ )

2571 
pcCU
->
	`gëCbf
–
COMPONENT_Y
 )[ 
uiOffs
 ] |
uiCombCbfY
;

2572 
pcCU
->
	`gëCbf
–
COMPONENT_Cb
 )[ 
uiOffs
 ] |
uiCombCbfU
;

2573 
pcCU
->
	`gëCbf
–
COMPONENT_Cr
 )[ 
uiOffs
 ] |
uiCombCbfV
;

2578 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_CURR_BEST
]);

2581 
pcCU
->
	`gëTŸÆDi°‹ti⁄
(Ë
uiOvîÆlDi°Y
;

2582 
	}
}

2587 
Void


2588 
	gTEncSórch
::
e°I¡øPªdChromaQT
(
TComD©aCU
* 
pcCU
,

2589 
TComYuv
* 
pcOrgYuv
,

2590 
TComYuv
* 
pcPªdYuv
,

2591 
TComYuv
* 
pcResiYuv
,

2592 
TComYuv
* 
pcRecoYuv
,

2593 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE]

2594 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
))

2596 c⁄° 
UI¡
 
uiInôTrDïth
 = 
pcCU
->
	`gëP¨tôi⁄Size
(0Ë!
SIZE_2Nx2N
 && 
	`íabÀ4ChromaPUsInI¡øNxNCU
(
pcOrgYuv
->
	`gëChromaF‹m©
()) ? 1 : 0;

2598 
TComTURecur£
 
	`tuRecur£CU
(
pcCU
, 0);

2599 
TComTURecur£
 
	`tuRecur£WôhPU
(
tuRecur£CU
, 
Ál£
, (
uiInôTrDïth
==0)?
TComTU
::
DONT_SPLIT
 : TComTU::
QUAD_SPLIT
);

2600 c⁄° 
UI¡
 
uiQNumP¨ts
 = 
tuRecur£WôhPU
.
	`GëAbsP¨tIdxNumP¨ts
();

2601 c⁄° 
UI¡
 
uiDïthCU
=
tuRecur£WôhPU
.
	`gëCUDïth
();

2602 c⁄° 
UI¡
 
numbîVÆidComp⁄íts
 = 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

2606 
UI¡
 
uiBe°Mode
 = 0;

2607 
Di°‹ti⁄
 
uiBe°Di°
 = 0;

2608 
DoubÀ
 
dBe°Co°
 = 
MAX_DOUBLE
;

2611 i‡(
tuRecur£WôhPU
.
	`Pro˚ssCh™√lSe˘i⁄
(
CHANNEL_TYPE_CHROMA
))

2613 
UI¡
 
uiModeLi°
[
FAST_UDI_MAX_RDMODE_NUM
];

2614 c⁄° 
UI¡
 
uiQP¨tNum
 = 
uiQNumP¨ts
;

2615 c⁄° 
UI¡
 
uiP¨tOff£t
 = 
tuRecur£WôhPU
.
	`GëAbsP¨tIdxTU
();

2617 
UI¡
 
uiMöMode
 = 0;

2618 
UI¡
 
uiMaxMode
 = 
NUM_CHROMA_MODE
;

2621 
pcCU
->
	`gëAŒowedChromaDú
–
uiP¨tOff£t
, 
uiModeLi°
 );

2623 #i‡
ENVIRONMENT_VARIABLE_DEBUG_AND_TEST


2624 i‡(
DebugO±i⁄Li°
::
F‹˚ChromaMode
.
	`isSë
())

2626 
uiMöMode
=
DebugO±i⁄Li°
::
F‹˚ChromaMode
.
	`gëI¡
();

2627 i‡(
uiModeLi°
[
uiMöMode
]==34)

2629 
uiMöMode
=4;

2631 
uiMaxMode
=
uiMöMode
+1;

2635 
	`DEBUG_STRING_NEW
(
sPU
)

2637  
UI¡
 
uiMode
 = 
uiMöMode
; uiModê< 
uiMaxMode
; uiMode++ )

2640 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[
uiDïthCU
][
CI_CURR_BEST
] );

2642 
	`DEBUG_STRING_NEW
(
sMode
)

2644 
Di°‹ti⁄
 
uiDi°
 = 0;

2645 
pcCU
->
	`£tI¡øDúSubP¨ts
 ( 
CHANNEL_TYPE_CHROMA
, 
uiModeLi°
[
uiMode
], 
uiP¨tOff£t
, 
uiDïthCU
+
uiInôTrDïth
 );

2646 
	`xRecurI¡øChromaCodögQT
 ( 
pcOrgYuv
, 
pcPªdYuv
, 
pcResiYuv
, 
ªsiLuma
, 
uiDi°
, 
tuRecur£WôhPU
 
	`DEBUG_STRING_PASS_INTO
(
sMode
) );

2648 if–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£Tønsf‹mSkù
() )

2650 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[
uiDïthCU
][
CI_CURR_BEST
] );

2653 
UI¡
 
uiBôs
 = 
	`xGëI¡øBôsQT
–
tuRecur£WôhPU
, 
Ál£
, 
åue
, false );

2654 
DoubÀ
 
dCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiBôs
, 
uiDi°
 );

2657 if–
dCo°
 < 
dBe°Co°
 )

2659 
	`DEBUG_STRING_SWAP
(
sPU
, 
sMode
);

2660 
dBe°Co°
 = 
dCo°
;

2661 
uiBe°Di°
 = 
uiDi°
;

2662 
uiBe°Mode
 = 
uiModeLi°
[
uiMode
];

2664 
	`xSëI¡øResu…ChromaQT
–
pcRecoYuv
, 
tuRecur£WôhPU
 );

2665 
UI¡
 
comp⁄ítIndex
 = 
COMPONENT_Cb
; comp⁄ítIndex < 
numbîVÆidComp⁄íts
; componentIndex++)

2667 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

2668 ::
	`mem˝y
–
m_puhQTTempCbf
[
compID
], 
pcCU
->
	`gëCbf
–compID )+
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2669 ::
	`mem˝y
–
m_puhQTTempTønsf‹mSkùFœg
[
compID
], 
pcCU
->
	`gëTønsf‹mSkù
–compID )+
uiP¨tOff£t
, 
uiQP¨tNum
 * –
UCh¨
 ) );

2670 ::
	`mem˝y
–
m_phQTTempCrossComp⁄ítPªdi˘i⁄AÕha
[
compID
], 
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(compID)+
uiP¨tOff£t
, 
uiQP¨tNum
 * –
SCh¨
 ) );

2675 
	`DEBUG_STRING_APPEND
(
sDebug
, 
sPU
)

2678 
UI¡
 
comp⁄ítIndex
 = 
COMPONENT_Cb
; comp⁄ítIndex < 
numbîVÆidComp⁄íts
; componentIndex++)

2680 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

2681 ::
	`mem˝y
–
pcCU
->
	`gëCbf
–
compID
 )+
uiP¨tOff£t
, 
m_puhQTTempCbf
[compID], 
uiQP¨tNum
 * –
UCh¨
 ) );

2682 ::
	`mem˝y
–
pcCU
->
	`gëTønsf‹mSkù
–
compID
 )+
uiP¨tOff£t
, 
m_puhQTTempTønsf‹mSkùFœg
[compID], 
uiQP¨tNum
 * –
UCh¨
 ) );

2683 ::
	`mem˝y
–
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
compID
)+
uiP¨tOff£t
, 
m_phQTTempCrossComp⁄ítPªdi˘i⁄AÕha
[compID], 
uiQP¨tNum
 * –
SCh¨
 ) );

2687 if–! 
tuRecur£WôhPU
.
	`IsLa°Se˘i⁄
() )

2689 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
numbîVÆidComp⁄íts
; ch++)

2691 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

2692 c⁄° 
TComRe˘™gÀ
 &
tuRe˘
 = 
tuRecur£WôhPU
.
	`gëRe˘
(
compID
);

2693 c⁄° 
UI¡
 
uiCompWidth
 = 
tuRe˘
.
width
;

2694 c⁄° 
UI¡
 
uiCompHeight
 = 
tuRe˘
.
height
;

2695 c⁄° 
UI¡
 
uiZOrdî
 = 
pcCU
->
	`gëZ‹dîIdxInCtu
(Ë+ 
tuRecur£WôhPU
.
	`GëAbsP¨tIdxTU
();

2696 
Pñ
* 
piDes
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
–
compID
,ÖcCU->
	`gëCtuRsAddr
(), 
uiZOrdî
 );

2697 c⁄° 
UI¡
 
uiDesSåide
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëSåide
–
compID
);

2698 c⁄° 
Pñ
* 
piSrc
 = 
pcRecoYuv
->
	`gëAddr
–
compID
, 
uiP¨tOff£t
 );

2699 c⁄° 
UI¡
 
uiSrcSåide
 = 
pcRecoYuv
->
	`gëSåide
–
compID
);

2701  
UI¡
 
uiY
 = 0; uiY < 
uiCompHeight
; uiY++, 
piSrc
 +
uiSrcSåide
, 
piDes
 +
uiDesSåide
 )

2703  
UI¡
 
uiX
 = 0; uiX < 
uiCompWidth
; uiX++ )

2705 
piDes
[ 
uiX
 ] = 
piSrc
[ uiX ];

2711 
pcCU
->
	`£tI¡øDúSubP¨ts
–
CHANNEL_TYPE_CHROMA
, 
uiBe°Mode
, 
uiP¨tOff£t
, 
uiDïthCU
+
uiInôTrDïth
 );

2712 
pcCU
->
	`gëTŸÆDi°‹ti⁄
 (Ë+
uiBe°Di°
;

2715 } 
tuRecur£WôhPU
.
	`√xtSe˘i⁄
(
tuRecur£CU
));

2719 if–
uiInôTrDïth
 != 0 )

2721 
UI¡
 
uiCombCbfU
 = 0;

2722 
UI¡
 
uiCombCbfV
 = 0;

2723 
UI¡
 
uiP¨tIdx
 = 0;

2724  
UI¡
 
uiP¨t
 = 0; uiP¨à< 4; uiP¨t++, 
uiP¨tIdx
 +
uiQNumP¨ts
 )

2726 
uiCombCbfU
 |
pcCU
->
	`gëCbf
–
uiP¨tIdx
, 
COMPONENT_Cb
, 1 );

2727 
uiCombCbfV
 |
pcCU
->
	`gëCbf
–
uiP¨tIdx
, 
COMPONENT_Cr
, 1 );

2729  
UI¡
 
uiOffs
 = 0; uiOff†< 4 * 
uiQNumP¨ts
; uiOffs++ )

2731 
pcCU
->
	`gëCbf
–
COMPONENT_Cb
 )[ 
uiOffs
 ] |
uiCombCbfU
;

2732 
pcCU
->
	`gëCbf
–
COMPONENT_Cr
 )[ 
uiOffs
 ] |
uiCombCbfV
;

2736 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[
uiDïthCU
][
CI_CURR_BEST
] );

2737 
	}
}

2755 
Void
 
	gTEncSórch
::
	$xEncPCM
 (
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Pñ
* 
pOrg
, Pñ* 
pPCM
, Pñ* 
pPªd
, Pñ* 
pResi
, Pñ* 
pReco
, UI¡ 
uiSåide
, UI¡ 
uiWidth
, UI¡ 
uiHeight
, c⁄° 
Comp⁄ítID
 
compID
 )

2757 c⁄° 
UI¡
 
uiRec⁄Såide
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëSåide
(
compID
);

2758 c⁄° 
UI¡
 
uiPCMBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëPCMBôDïth
(
	`toCh™√lTy≥
(
compID
));

2759 c⁄° 
I¡
 
ch™√lBôDïth
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

2760 
Pñ
* 
pRecoPic
 = 
pcCU
->
	`gëPic
()->
	`gëPicYuvRec
()->
	`gëAddr
(
compID
,ÖcCU->
	`gëCtuRsAddr
(),ÖcCU->
	`gëZ‹dîIdxInCtu
()+
uiAbsP¨tIdx
);

2762 c⁄° 
I¡
 
pcmShi·Right
=(
ch™√lBôDïth
 - 
	`I¡
(
uiPCMBôDïth
));

2764 
	`as£π
(
pcmShi·Right
 >= 0);

2766  
UI¡
 
uiY
 = 0; uiY < 
uiHeight
; uiY++ )

2768  
UI¡
 
uiX
 = 0; uiX < 
uiWidth
; uiX++ )

2771 
pPªd
[
uiX
] = 0;

2772 
pResi
[
uiX
] = 0;

2774 
pPCM
[
uiX
] = (
pOrg
[uiX]>>
pcmShi·Right
);

2776 
pReco
 [
uiX
] = (
pPCM
[uiX]<<(
pcmShi·Right
));

2777 
pRecoPic
[
uiX
] = 
pReco
[uiX];

2779 
pPªd
 +
uiSåide
;

2780 
pResi
 +
uiSåide
;

2781 
pPCM
 +
uiWidth
;

2782 
pOrg
 +
uiSåide
;

2783 
pReco
 +
uiSåide
;

2784 
pRecoPic
 +
uiRec⁄Såide
;

2786 
	}
}

2790 
Void
 
	gTEncSórch
::
	$IPCMSórch
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcOrgYuv
, TComYuv* 
pcPªdYuv
, TComYuv* 
pcResiYuv
, TComYuv* 
pcRecoYuv
 )

2792 
UI¡
 
uiDïth
 = 
pcCU
->
	`gëDïth
(0);

2793 c⁄° 
Di°‹ti⁄
 
uiDi°‹ti⁄
 = 0;

2794 
UI¡
 
uiBôs
;

2796 
DoubÀ
 
dCo°
;

2798 
UI¡
 
ch
=0; ch < 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
(); ch++)

2800 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

2801 c⁄° 
UI¡
 
width
 = 
pcCU
->
	`gëWidth
(0Ë>>ÖcCU->
	`gëPic
()->
	`gëComp⁄ítSˇÀX
(
compID
);

2802 c⁄° 
UI¡
 
height
 = 
pcCU
->
	`gëHeight
(0Ë>>ÖcCU->
	`gëPic
()->
	`gëComp⁄ítSˇÀY
(
compID
);

2803 c⁄° 
UI¡
 
°ride
 = 
pcPªdYuv
->
	`gëSåide
(
compID
);

2805 
Pñ
 * 
pOrig
 = 
pcOrgYuv
->
	`gëAddr
 (
compID
, 0, 
width
);

2806 
Pñ
 * 
pResi
 = 
pcResiYuv
->
	`gëAddr
(
compID
, 0, 
width
);

2807 
Pñ
 * 
pPªd
 = 
pcPªdYuv
->
	`gëAddr
(
compID
, 0, 
width
);

2808 
Pñ
 * 
pReco
 = 
pcRecoYuv
->
	`gëAddr
(
compID
, 0, 
width
);

2809 
Pñ
 * 
pPCM
 = 
pcCU
->
	`gëPCMSam∂e
 (
compID
);

2811 
	`xEncPCM
 ( 
pcCU
, 0, 
pOrig
, 
pPCM
, 
pPªd
, 
pResi
, 
pReco
, 
°ride
, 
width
, 
height
, 
compID
 );

2815 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

2816 
	`xEncI¡øHódî
 ( 
pcCU
, 
uiDïth
, 0, 
åue
, 
Ál£
);

2817 
uiBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

2819 
dCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiBôs
, 
uiDi°‹ti⁄
 );

2821 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[
uiDïth
][
CI_CURR_BEST
]);

2823 
pcCU
->
	`gëTŸÆBôs
(Ë
uiBôs
;

2824 
pcCU
->
	`gëTŸÆCo°
(Ë
dCo°
;

2825 
pcCU
->
	`gëTŸÆDi°‹ti⁄
(Ë
uiDi°‹ti⁄
;

2827 
pcCU
->
	`c›yToPic
(
uiDïth
);

2828 
	}
}

2833 
Void
 
	gTEncSórch
::
	$xGëI¡îPªdi˘i⁄Eº‹
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcYuvOrg
, 
I¡
 
iP¨tIdx
, 
Di°‹ti⁄
& 
ruiEº
, 
Boﬁ
 )

2835 
	`mŸi⁄Com≥nßti⁄
–
pcCU
, &
m_tmpYuvPªd
, 
REF_PIC_LIST_X
, 
iP¨tIdx
 );

2837 
UI¡
 
uiAbsP¨tIdx
 = 0;

2838 
I¡
 
iWidth
 = 0;

2839 
I¡
 
iHeight
 = 0;

2840 
pcCU
->
	`gëP¨tIndexAndSize
–
iP¨tIdx
, 
uiAbsP¨tIdx
, 
iWidth
, 
iHeight
 );

2842 
Di°P¨am
 
cDi°P¨am
;

2844 
cDi°P¨am
.
bAµlyWeight
 = 
Ál£
;

2847 
m_pcRdCo°
->
	`£tDi°P¨am
–
cDi°P¨am
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
),

2848 
pcYuvOrg
->
	`gëAddr
–
COMPONENT_Y
, 
uiAbsP¨tIdx
 ),ÖcYuvOrg->
	`gëSåide
(COMPONENT_Y),

2849 
m_tmpYuvPªd
 .
	`gëAddr
–
COMPONENT_Y
, 
uiAbsP¨tIdx
 ), m_tmpYuvPªd.
	`gëSåide
(COMPONENT_Y),

2850 
iWidth
, 
iHeight
, 
m_pcEncCfg
->
	`gëU£HADME
(Ë&& (
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
iP¨tIdx
) == 0) );

2852 
ruiEº
 = 
cDi°P¨am
.
	`Di°Func
( &cDistParam );

2853 
	}
}

2856 
Void
 
	gTEncSórch
::
	$xMîgeE°im©i⁄
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcYuvOrg
, 
I¡
 
iPUIdx
, 
UI¡
& 
uiI¡îDú
, 
TComMvFõld
* 
∑cMvFõld
, UI¡& 
uiMîgeIndex
, 
Di°‹ti⁄
& 
ruiCo°
, TComMvFõld* 
cMvFõldNeighbours
, 
UCh¨
* 
uhI¡îDúNeighbours
, I¡& 
numVÆidMîgeC™d
 )

2858 
UI¡
 
uiAbsP¨tIdx
 = 0;

2859 
I¡
 
iWidth
 = 0;

2860 
I¡
 
iHeight
 = 0;

2862 
pcCU
->
	`gëP¨tIndexAndSize
–
iPUIdx
, 
uiAbsP¨tIdx
, 
iWidth
, 
iHeight
 );

2863 
UI¡
 
uiDïth
 = 
pcCU
->
	`gëDïth
–
uiAbsP¨tIdx
 );

2865 
P¨tSize
 
∑πSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
( 0 );

2866 i‡–
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëLog2P¨ÆÀlMîgeLevñMöus2
(Ë&& 
∑πSize
 !
SIZE_2Nx2N
 &&ÖcCU->
	`gëWidth
( 0 ) <= 8 )

2868 i‡–
iPUIdx
 == 0 )

2870 
pcCU
->
	`£tP¨tSizeSubP¨ts
–
SIZE_2Nx2N
, 0, 
uiDïth
 );

2871 #i‡
MCTS_ENC_CHECK


2872 
UI¡
 
numS∑tülMîgeC™did©es
 = 0;

2873 
pcCU
->
	`gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
numS∑tülMîgeC™did©es
 );

2874 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
(Ë&& 
pcCU
->
	`isLa°CﬁumnCTUInTûe
())

2876 
numVÆidMîgeC™d
 = 
numS∑tülMîgeC™did©es
;

2879 
pcCU
->
	`gëI¡îMîgeC™did©es
–0, 0, 
cMvFõldNeighbours
,
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
 );

2881 
pcCU
->
	`£tP¨tSizeSubP¨ts
–
∑πSize
, 0, 
uiDïth
 );

2886 #i‡
MCTS_ENC_CHECK


2887 
UI¡
 
numS∑tülMîgeC™did©es
 = 0;

2888 
pcCU
->
	`gëI¡îMîgeC™did©es
–
uiAbsP¨tIdx
, 
iPUIdx
, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
, 
numS∑tülMîgeC™did©es
 );

2889 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
(Ë&& 
pcCU
->
	`isLa°CﬁumnCTUInTûe
())

2891 
numVÆidMîgeC™d
 = 
numS∑tülMîgeC™did©es
;

2894 
pcCU
->
	`gëI¡îMîgeC™did©es
–
uiAbsP¨tIdx
, 
iPUIdx
, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
 );

2898 
	`xRe°ri˘BùªdMîgeC™d
–
pcCU
, 
iPUIdx
, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
 );

2900 
ruiCo°
 = 
°d
::
numîic_limôs
<
Di°‹ti⁄
>::
	`max
();

2901  
UI¡
 
uiMîgeC™d
 = 0; uiMîgeC™d < 
numVÆidMîgeC™d
; ++uiMergeCand )

2903 
Di°‹ti⁄
 
uiCo°C™d
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

2904 
UI¡
 
uiBôsC™d
 = 0;

2906 
P¨tSize
 
eP¨tSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
( 0 );

2908 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMvFõld
–
cMvFõldNeighbours
[0 + 2*
uiMîgeC™d
], 
eP¨tSize
, 
uiAbsP¨tIdx
, 0, 
iPUIdx
 );

2909 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMvFõld
–
cMvFõldNeighbours
[1 + 2*
uiMîgeC™d
], 
eP¨tSize
, 
uiAbsP¨tIdx
, 0, 
iPUIdx
 );

2911 
	`xGëI¡îPªdi˘i⁄Eº‹
–
pcCU
, 
pcYuvOrg
, 
iPUIdx
, 
uiCo°C™d
, 
m_pcEncCfg
->
	`gëU£HADME
() );

2912 
uiBôsC™d
 = 
uiMîgeC™d
 + 1;

2913 i‡(
uiMîgeC™d
 =
m_pcEncCfg
->
	`gëMaxNumMîgeC™d
() -1)

2915 
uiBôsC™d
--;

2917 
uiCo°C™d
 = uiCo°C™d + 
m_pcRdCo°
->
	`gëCo°
–
uiBôsC™d
 );

2918 i‡–
uiCo°C™d
 < 
ruiCo°
 )

2920 
ruiCo°
 = 
uiCo°C™d
;

2921 
∑cMvFõld
[0] = 
cMvFõldNeighbours
[0 + 2*
uiMîgeC™d
];

2922 
∑cMvFõld
[1] = 
cMvFõldNeighbours
[1 + 2*
uiMîgeC™d
];

2923 
uiI¡îDú
 = 
uhI¡îDúNeighbours
[
uiMîgeC™d
];

2924 
uiMîgeIndex
 = 
uiMîgeC™d
;

2927 
	}
}

2937 
Void
 
	gTEncSórch
::
	$xRe°ri˘BùªdMîgeC™d
–
TComD©aCU
* 
pcCU
, 
UI¡
 
puIdx
, 
TComMvFõld
* 
mvFõldNeighbours
, 
UCh¨
* 
öãrDúNeighbours
, 
I¡
 
numVÆidMîgeC™d
 )

2939 i‡–
pcCU
->
	`isBùªdRe°ri˘i⁄
(
puIdx
) )

2941  
UI¡
 
mîgeC™d
 = 0; mîgeC™d < 
numVÆidMîgeC™d
; ++mergeCand )

2943 i‡–
öãrDúNeighbours
[
mîgeC™d
] == 3 )

2945 
öãrDúNeighbours
[
mîgeC™d
] = 1;

2946 
mvFõldNeighbours
[(
mîgeC™d
 << 1Ë+ 1].
	`£tMvFõld
(
	`TComMv
(0,0), -1);

2950 
	}
}

2953 #i‡
AMP_MRG


2954 
Void
 
	gTEncSórch
::
¥edI¡îSórch
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcOrgYuv
, TComYuv* 
pcPªdYuv
, TComYuv* 
pcResiYuv
, TComYuv* 
pcRecoYuv
 
DEBUG_STRING_FN_DECLARE
(
sDebug
), 
Boﬁ
 
bU£Res
, Boﬁ 
bU£MRG
 )

2956 
Void
 
	gTEncSórch
::
	$¥edI¡îSórch
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcOrgYuv
, TComYuv* 
pcPªdYuv
, TComYuv* 
pcResiYuv
, TComYuv* 
pcRecoYuv
, 
Boﬁ
 
bU£Res
 )

2959 
UI¡
 
i
=0; i<
NUM_REF_PIC_LIST_01
; i++)

2961 
m_acYuvPªd
[
i
].
	`˛ór
();

2963 
m_cYuvPªdTemp
.
	`˛ór
();

2964 
pcPªdYuv
->
	`˛ór
();

2966 i‡–!
bU£Res
 )

2968 
pcResiYuv
->
	`˛ór
();

2971 
pcRecoYuv
->
	`˛ór
();

2973 
TComMv
 
cMvSrchRngLT
;

2974 
TComMv
 
cMvSrchRngRB
;

2976 
TComMv
 
cMvZîo
;

2977 
TComMv
 
TempMv
;

2979 
TComMv
 
cMv
[2];

2980 
TComMv
 
cMvBi
[2];

2981 
TComMv
 
cMvTemp
[2][33];

2983 
I¡
 
iNumP¨t
 = 
pcCU
->
	`gëNumP¨tôi⁄s
();

2984 
I¡
 
iNumPªdDú
 = 
pcCU
->
	`gëSli˚
()->
	`isI¡îP
() ? 1 : 2;

2986 
TComMv
 
cMvPªd
[2][33];

2988 
TComMv
 
cMvPªdBi
[2][33];

2989 
I¡
 
ØiMvpIdxBi
[2][33];

2991 
I¡
 
ØiMvpIdx
[2][33];

2992 
I¡
 
ØiMvpNum
[2][33];

2994 
AMVPInfo
 
ØcAMVPInfo
[2][33];

2996 
I¡
 
iRefIdx
[2]={0,0};

2997 
I¡
 
iRefIdxBi
[2];

2999 
UI¡
 
uiP¨tAddr
;

3000 
I¡
 
iRoiWidth
, 
iRoiHeight
;

3002 
UI¡
 
uiMbBôs
[3] = {1, 1, 0};

3004 
UI¡
 
uiLa°Mode
 = 0;

3005 
I¡
 
iRefSèπ
, 
iRefEnd
;

3007 
P¨tSize
 
eP¨tSize
 = 
pcCU
->
	`gëP¨tôi⁄Size
( 0 );

3009 
I¡
 
be°BiPRefIdxL1
 = 0;

3010 
I¡
 
be°BiPMvpL1
 = 0;

3011 
Di°‹ti⁄
 
biPDi°Temp
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3013 
TComMvFõld
 
cMvFõldNeighbours
[
MRG_MAX_NUM_CANDS
 << 1];

3014 
UCh¨
 
uhI¡îDúNeighbours
[
MRG_MAX_NUM_CANDS
];

3015 
I¡
 
numVÆidMîgeC™d
 = 0 ;

3017  
I¡
 
iP¨tIdx
 = 0; iP¨tIdx < 
iNumP¨t
; iPartIdx++ )

3019 
Di°‹ti⁄
 
uiCo°
[2] = { 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
(), std::numeric_limits<Distortion>::max() };

3020 
Di°‹ti⁄
 
uiCo°Bi
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3021 
Di°‹ti⁄
 
uiCo°Temp
;

3023 
UI¡
 
uiBôs
[3];

3024 
UI¡
 
uiBôsTemp
;

3025 
Di°‹ti⁄
 
be°BiPDi°
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3027 
Di°‹ti⁄
 
uiCo°TempL0
[
MAX_NUM_REF
];

3028 
I¡
 
iNumRef
=0; iNumRe‡< 
MAX_NUM_REF
; iNumRef++)

3030 
uiCo°TempL0
[
iNumRef
] = 
°d
::
numîic_limôs
<
Di°‹ti⁄
>::
	`max
();

3032 
UI¡
 
uiBôsTempL0
[
MAX_NUM_REF
];

3034 
TComMv
 
mvVÆidLi°1
;

3035 
I¡
 
ªfIdxVÆidLi°1
 = 0;

3036 
UI¡
 
bôsVÆidLi°1
 = 
MAX_UINT
;

3037 
Di°‹ti⁄
 
co°VÆidLi°1
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3039 
	`xGëBlkBôs
–
eP¨tSize
, 
pcCU
->
	`gëSli˚
()->
	`isI¡îP
(), 
iP¨tIdx
, 
uiLa°Mode
, 
uiMbBôs
);

3041 
pcCU
->
	`gëP¨tIndexAndSize
–
iP¨tIdx
, 
uiP¨tAddr
, 
iRoiWidth
, 
iRoiHeight
 );

3043 #i‡
AMP_MRG


3044 
Boﬁ
 
bTe°N‹mÆMC
 = 
åue
;

3046 i‡–
bU£MRG
 && 
pcCU
->
	`gëWidth
–0 ) > 8 && 
iNumP¨t
 == 2 )

3048 
bTe°N‹mÆMC
 = 
Ál£
;

3051 i‡(
bTe°N‹mÆMC
)

3056  
I¡
 
iRefLi°
 = 0; iRefLi° < 
iNumPªdDú
; iRefList++ )

3058 
RefPicLi°
 
eRefPicLi°
 = ( 
iRefLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

3060  
I¡
 
iRefIdxTemp
 = 0; iRefIdxTem∞< 
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
eRefPicLi°
); iRefIdxTemp++ )

3062 
uiBôsTemp
 = 
uiMbBôs
[
iRefLi°
];

3063 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
eRefPicLi°
) > 1 )

3065 
uiBôsTemp
 +
iRefIdxTemp
+1;

3066 i‡–
iRefIdxTemp
 =
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
eRefPicLi°
)-1 )

3068 
uiBôsTemp
--;

3071 
	`xE°im©eMvPªdAMVP
–
pcCU
, 
pcOrgYuv
, 
iP¨tIdx
, 
eRefPicLi°
, 
iRefIdxTemp
, 
cMvPªd
[
iRefLi°
][iRefIdxTemp], 
Ál£
, &
biPDi°Temp
);

3072 
ØiMvpIdx
[
iRefLi°
][
iRefIdxTemp
] = 
pcCU
->
	`gëMVPIdx
(
eRefPicLi°
, 
uiP¨tAddr
);

3073 
ØiMvpNum
[
iRefLi°
][
iRefIdxTemp
] = 
pcCU
->
	`gëMVPNum
(
eRefPicLi°
, 
uiP¨tAddr
);

3075 if(
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
(Ë&& 
iRefLi°
==1 && 
biPDi°Temp
 < 
be°BiPDi°
)

3077 
be°BiPDi°
 = 
biPDi°Temp
;

3078 
be°BiPMvpL1
 = 
ØiMvpIdx
[
iRefLi°
][
iRefIdxTemp
];

3079 
be°BiPRefIdxL1
 = 
iRefIdxTemp
;

3082 
uiBôsTemp
 +
m_auiMVPIdxCo°
[
ØiMvpIdx
[
iRefLi°
][
iRefIdxTemp
]][
AMVP_MAX_NUM_CANDS
];

3084 i‡–
m_pcEncCfg
->
	`gëFa°MEF‹GíBLowDñayE«bÀd
(Ë&& 
iRefLi°
 == 1 )

3086 i‡–
pcCU
->
	`gëSli˚
()->
	`gëLi°1IdxToLi°0Idx
–
iRefIdxTemp
 ) >= 0 )

3088 
cMvTemp
[1][
iRefIdxTemp
] = cMvTemp[0][
pcCU
->
	`gëSli˚
()->
	`gëLi°1IdxToLi°0Idx
( iRefIdxTemp )];

3089 
uiCo°Temp
 = 
uiCo°TempL0
[
pcCU
->
	`gëSli˚
()->
	`gëLi°1IdxToLi°0Idx
–
iRefIdxTemp
 )];

3091 
uiCo°Temp
 -
m_pcRdCo°
->
	`gëCo°
–
uiBôsTempL0
[
pcCU
->
	`gëSli˚
()->
	`gëLi°1IdxToLi°0Idx
–
iRefIdxTemp
 )] );

3093 
m_pcRdCo°
->
	`£tPªdi˘‹
 ( 
cMvPªd
[
iRefLi°
][
iRefIdxTemp
] );

3094 
uiBôsTemp
 +
m_pcRdCo°
->
	`gëBôsOfVe˘‹WôhPªdi˘‹
–
cMvTemp
[1][
iRefIdxTemp
].
	`gëH‹
(), cMvTemp[1][iRefIdxTemp].
	`gëVî
() );

3096 
uiCo°Temp
 +
m_pcRdCo°
->
	`gëCo°
–
uiBôsTemp
 );

3100 
	`xMŸi⁄E°im©i⁄
 ( 
pcCU
, 
pcOrgYuv
, 
iP¨tIdx
, 
eRefPicLi°
, &
cMvPªd
[
iRefLi°
][
iRefIdxTemp
], iRefIdxTemp, 
cMvTemp
[iRefLi°][iRefIdxTemp], 
uiBôsTemp
, 
uiCo°Temp
 );

3105 
	`xMŸi⁄E°im©i⁄
 ( 
pcCU
, 
pcOrgYuv
, 
iP¨tIdx
, 
eRefPicLi°
, &
cMvPªd
[
iRefLi°
][
iRefIdxTemp
], iRefIdxTemp, 
cMvTemp
[iRefLi°][iRefIdxTemp], 
uiBôsTemp
, 
uiCo°Temp
 );

3107 
	`xC›yAMVPInfo
(
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëAMVPInfo
(), &
ØcAMVPInfo
[
iRefLi°
][
iRefIdxTemp
]);

3108 
	`xCheckBe°MVP
(
pcCU
, 
eRefPicLi°
, 
cMvTemp
[
iRefLi°
][
iRefIdxTemp
], 
cMvPªd
[iRefLi°][iRefIdxTemp], 
ØiMvpIdx
[iRefLi°][iRefIdxTemp], 
uiBôsTemp
, 
uiCo°Temp
);

3110 i‡–
iRefLi°
 == 0 )

3112 
uiCo°TempL0
[
iRefIdxTemp
] = 
uiCo°Temp
;

3113 
uiBôsTempL0
[
iRefIdxTemp
] = 
uiBôsTemp
;

3115 i‡–
uiCo°Temp
 < 
uiCo°
[
iRefLi°
] )

3117 
uiCo°
[
iRefLi°
] = 
uiCo°Temp
;

3118 
uiBôs
[
iRefLi°
] = 
uiBôsTemp
;

3121 
cMv
[
iRefLi°
] = 
cMvTemp
[iRefLi°][
iRefIdxTemp
];

3122 
iRefIdx
[
iRefLi°
] = 
iRefIdxTemp
;

3125 i‡–
iRefLi°
 =1 && 
uiCo°Temp
 < 
co°VÆidLi°1
 && 
pcCU
->
	`gëSli˚
()->
	`gëLi°1IdxToLi°0Idx
–
iRefIdxTemp
 ) < 0 )

3127 
co°VÆidLi°1
 = 
uiCo°Temp
;

3128 
bôsVÆidLi°1
 = 
uiBôsTemp
;

3131 
mvVÆidLi°1
 = 
cMvTemp
[
iRefLi°
][
iRefIdxTemp
];

3132 
ªfIdxVÆidLi°1
 = 
iRefIdxTemp
;

3138 i‡–(
pcCU
->
	`gëSli˚
()->
	`isI¡îB
()Ë&& (pcCU->
	`isBùªdRe°ri˘i⁄
(
iP¨tIdx
Ë=
Ál£
) )

3141 
cMvBi
[0] = 
cMv
[0]; cMvBi[1] = cMv[1];

3142 
iRefIdxBi
[0] = 
iRefIdx
[0]; iRefIdxBi[1] = iRefIdx[1];

3144 ::
	`mem˝y
(
cMvPªdBi
, 
cMvPªd
, (cMvPred));

3145 ::
	`mem˝y
(
ØiMvpIdxBi
, 
ØiMvpIdx
, (aaiMvpIdx));

3147 
UI¡
 
uiMŸBôs
[2];

3149 if(
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
())

3151 
	`xC›yAMVPInfo
(&
ØcAMVPInfo
[1][
be°BiPRefIdxL1
], 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`gëAMVPInfo
());

3152 
pcCU
->
	`£tMVPIdxSubP¨ts
–
be°BiPMvpL1
, 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3153 
ØiMvpIdxBi
[1][
be°BiPRefIdxL1
] = 
be°BiPMvpL1
;

3154 
cMvPªdBi
[1][
be°BiPRefIdxL1
] = 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`gëAMVPInfo
()->
m_acMvC™d
[
be°BiPMvpL1
];

3156 
cMvBi
[1] = 
cMvPªdBi
[1][
be°BiPRefIdxL1
];

3157 
iRefIdxBi
[1] = 
be°BiPRefIdxL1
;

3158 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_1
 )->
	`£tAŒMv
–
cMvBi
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3159 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_1
 )->
	`£tAŒRefIdx
–
iRefIdxBi
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3160 
TComYuv
* 
pcYuvPªd
 = &
m_acYuvPªd
[
REF_PIC_LIST_1
];

3161 
	`mŸi⁄Com≥nßti⁄
–
pcCU
, 
pcYuvPªd
, 
REF_PIC_LIST_1
, 
iP¨tIdx
 );

3163 
uiMŸBôs
[0] = 
uiBôs
[0] - 
uiMbBôs
[0];

3164 
uiMŸBôs
[1] = 
uiMbBôs
[1];

3166 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
REF_PIC_LIST_1
) > 1 )

3168 
uiMŸBôs
[1] +
be°BiPRefIdxL1
+1;

3169 i‡–
be°BiPRefIdxL1
 =
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
REF_PIC_LIST_1
)-1 )

3171 
uiMŸBôs
[1]--;

3175 
uiMŸBôs
[1] +
m_auiMVPIdxCo°
[
ØiMvpIdxBi
[1][
be°BiPRefIdxL1
]][
AMVP_MAX_NUM_CANDS
];

3177 
uiBôs
[2] = 
uiMbBôs
[2] + 
uiMŸBôs
[0] + uiMotBits[1];

3179 
cMvTemp
[1][
be°BiPRefIdxL1
] = 
cMvBi
[1];

3183 
uiMŸBôs
[0] = 
uiBôs
[0] - 
uiMbBôs
[0];

3184 
uiMŸBôs
[1] = 
uiBôs
[1] - 
uiMbBôs
[1];

3185 
uiBôs
[2] = 
uiMbBôs
[2] + 
uiMŸBôs
[0] + uiMotBits[1];

3189 
I¡
 
iNumIãr
 = 4;

3192 i‡–
m_pcEncCfg
->
	`gëFa°I¡îSórchMode
()==
FASTINTERSEARCH_MODE1
 || m_pcEncCfg->gëFa°I¡îSórchMode()==
FASTINTERSEARCH_MODE2
 || 
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
() )

3194 
iNumIãr
 = 1;

3197  
I¡
 
iIãr
 = 0; iIã∏< 
iNumIãr
; iIter++ )

3199 
I¡
 
iRefLi°
 = 
iIãr
 % 2;

3201 i‡–
m_pcEncCfg
->
	`gëFa°I¡îSórchMode
()==
FASTINTERSEARCH_MODE1
 || m_pcEncCfg->gëFa°I¡îSórchMode()==
FASTINTERSEARCH_MODE2
 )

3203 if–
uiCo°
[0] <= uiCost[1] )

3205 
iRefLi°
 = 1;

3209 
iRefLi°
 = 0;

3212 i‡–
iIãr
 == 0 )

3214 
iRefLi°
 = 0;

3216 i‡–
iIãr
 =0 && !
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
())

3218 
pcCU
->
	`gëCUMvFõld
(
	`RefPicLi°
(1-
iRefLi°
))->
	`£tAŒMv
–
cMv
[1-iRefLi°], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3219 
pcCU
->
	`gëCUMvFõld
(
	`RefPicLi°
(1-
iRefLi°
))->
	`£tAŒRefIdx
–
iRefIdx
[1-iRefLi°], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3220 
TComYuv
* 
pcYuvPªd
 = &
m_acYuvPªd
[1-
iRefLi°
];

3221 
	`mŸi⁄Com≥nßti⁄
 ( 
pcCU
, 
pcYuvPªd
, 
	`RefPicLi°
(1-
iRefLi°
), 
iP¨tIdx
 );

3224 
RefPicLi°
 
eRefPicLi°
 = ( 
iRefLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

3226 if(
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
())

3228 
iRefLi°
 = 0;

3229 
eRefPicLi°
 = 
REF_PIC_LIST_0
;

3232 
Boﬁ
 
bCh™ged
 = 
Ál£
;

3234 
iRefSèπ
 = 0;

3235 
iRefEnd
 = 
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
eRefPicLi°
)-1;

3237  
I¡
 
iRefIdxTemp
 = 
iRefSèπ
; iRefIdxTem∞<
iRefEnd
; iRefIdxTemp++ )

3239 
uiBôsTemp
 = 
uiMbBôs
[2] + 
uiMŸBôs
[1-
iRefLi°
];

3240 i‡–
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
eRefPicLi°
) > 1 )

3242 
uiBôsTemp
 +
iRefIdxTemp
+1;

3243 i‡–
iRefIdxTemp
 =
pcCU
->
	`gëSli˚
()->
	`gëNumRefIdx
(
eRefPicLi°
)-1 )

3245 
uiBôsTemp
--;

3248 
uiBôsTemp
 +
m_auiMVPIdxCo°
[
ØiMvpIdxBi
[
iRefLi°
][
iRefIdxTemp
]][
AMVP_MAX_NUM_CANDS
];

3250 
	`xMŸi⁄E°im©i⁄
 ( 
pcCU
, 
pcOrgYuv
, 
iP¨tIdx
, 
eRefPicLi°
, &
cMvPªdBi
[
iRefLi°
][
iRefIdxTemp
], iRefIdxTemp, 
cMvTemp
[iRefLi°][iRefIdxTemp], 
uiBôsTemp
, 
uiCo°Temp
, 
åue
 );

3252 
	`xC›yAMVPInfo
(&
ØcAMVPInfo
[
iRefLi°
][
iRefIdxTemp
], 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëAMVPInfo
());

3253 
	`xCheckBe°MVP
(
pcCU
, 
eRefPicLi°
, 
cMvTemp
[
iRefLi°
][
iRefIdxTemp
], 
cMvPªdBi
[iRefLi°][iRefIdxTemp], 
ØiMvpIdxBi
[iRefLi°][iRefIdxTemp], 
uiBôsTemp
, 
uiCo°Temp
);

3255 i‡–
uiCo°Temp
 < 
uiCo°Bi
 )

3257 
bCh™ged
 = 
åue
;

3259 
cMvBi
[
iRefLi°
] = 
cMvTemp
[iRefLi°][
iRefIdxTemp
];

3260 
iRefIdxBi
[
iRefLi°
] = 
iRefIdxTemp
;

3262 
uiCo°Bi
 = 
uiCo°Temp
;

3263 
uiMŸBôs
[
iRefLi°
] = 
uiBôsTemp
 - 
uiMbBôs
[2] - uiMotBits[1-iRefList];

3264 
uiBôs
[2] = 
uiBôsTemp
;

3266 if(
iNumIãr
!=1)

3269 
pcCU
->
	`gëCUMvFõld
–
eRefPicLi°
 )->
	`£tAŒMv
–
cMvBi
[
iRefLi°
], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3270 
pcCU
->
	`gëCUMvFõld
–
eRefPicLi°
 )->
	`£tAŒRefIdx
–
iRefIdxBi
[
iRefLi°
], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3272 
TComYuv
* 
pcYuvPªd
 = &
m_acYuvPªd
[
iRefLi°
];

3273 
	`mŸi⁄Com≥nßti⁄
–
pcCU
, 
pcYuvPªd
, 
eRefPicLi°
, 
iP¨tIdx
 );

3278 i‡–!
bCh™ged
 )

3280 i‡–
uiCo°Bi
 <
uiCo°
[0] && uiCostBi <= uiCost[1] )

3282 
	`xC›yAMVPInfo
(&
ØcAMVPInfo
[0][
iRefIdxBi
[0]], 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`gëAMVPInfo
());

3283 
	`xCheckBe°MVP
(
pcCU
, 
REF_PIC_LIST_0
, 
cMvBi
[0], 
cMvPªdBi
[0][
iRefIdxBi
[0]], 
ØiMvpIdxBi
[0][iRefIdxBi[0]], 
uiBôs
[2], 
uiCo°Bi
);

3284 if(!
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
())

3286 
	`xC›yAMVPInfo
(&
ØcAMVPInfo
[1][
iRefIdxBi
[1]], 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`gëAMVPInfo
());

3287 
	`xCheckBe°MVP
(
pcCU
, 
REF_PIC_LIST_1
, 
cMvBi
[1], 
cMvPªdBi
[1][
iRefIdxBi
[1]], 
ØiMvpIdxBi
[1][iRefIdxBi[1]], 
uiBôs
[2], 
uiCo°Bi
);

3295 #i‡
AMP_MRG


3299 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMvFõld
–
	`TComMvFõld
(), 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3300 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMvFõld
–
	`TComMvFõld
(), 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3301 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMvd
 ( 
cMvZîo
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3302 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMvd
 ( 
cMvZîo
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3304 
pcCU
->
	`£tMVPIdxSubP¨ts
–-1, 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3305 
pcCU
->
	`£tMVPNumSubP¨ts
–-1, 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3306 
pcCU
->
	`£tMVPIdxSubP¨ts
–-1, 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3307 
pcCU
->
	`£tMVPNumSubP¨ts
–-1, 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3309 
UI¡
 
uiMEBôs
 = 0;

3311 
cMv
[1] = 
mvVÆidLi°1
;

3312 
iRefIdx
[1] = 
ªfIdxVÆidLi°1
;

3313 
uiBôs
[1] = 
bôsVÆidLi°1
;

3314 
uiCo°
[1] = 
co°VÆidLi°1
;

3316 #i‡
AMP_MRG


3317 i‡(
bTe°N‹mÆMC
)

3320 i‡–
uiCo°Bi
 <
uiCo°
[0] && uiCostBi <= uiCost[1])

3322 
uiLa°Mode
 = 2;

3323 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMv
–
cMvBi
[0], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3324 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒRefIdx
–
iRefIdxBi
[0], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3325 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMv
–
cMvBi
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3326 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒRefIdx
–
iRefIdxBi
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3328 
TempMv
 = 
cMvBi
[0] - 
cMvPªdBi
[0][
iRefIdxBi
[0]];

3329 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMvd
 ( 
TempMv
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3331 
TempMv
 = 
cMvBi
[1] - 
cMvPªdBi
[1][
iRefIdxBi
[1]];

3332 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMvd
 ( 
TempMv
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3334 
pcCU
->
	`£tI¡îDúSubP¨ts
–3, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(0) );

3336 
pcCU
->
	`£tMVPIdxSubP¨ts
–
ØiMvpIdxBi
[0][
iRefIdxBi
[0]], 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3337 
pcCU
->
	`£tMVPNumSubP¨ts
–
ØiMvpNum
[0][
iRefIdxBi
[0]], 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3338 
pcCU
->
	`£tMVPIdxSubP¨ts
–
ØiMvpIdxBi
[1][
iRefIdxBi
[1]], 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3339 
pcCU
->
	`£tMVPNumSubP¨ts
–
ØiMvpNum
[1][
iRefIdxBi
[1]], 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3341 
uiMEBôs
 = 
uiBôs
[2];

3343 i‡–
uiCo°
[0] <= uiCost[1] )

3345 
uiLa°Mode
 = 0;

3346 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMv
–
cMv
[0], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3347 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒRefIdx
–
iRefIdx
[0], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3349 
TempMv
 = 
cMv
[0] - 
cMvPªd
[0][
iRefIdx
[0]];

3350 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMvd
 ( 
TempMv
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3352 
pcCU
->
	`£tI¡îDúSubP¨ts
–1, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(0) );

3354 
pcCU
->
	`£tMVPIdxSubP¨ts
–
ØiMvpIdx
[0][
iRefIdx
[0]], 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3355 
pcCU
->
	`£tMVPNumSubP¨ts
–
ØiMvpNum
[0][
iRefIdx
[0]], 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3357 
uiMEBôs
 = 
uiBôs
[0];

3361 
uiLa°Mode
 = 1;

3362 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMv
–
cMv
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3363 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒRefIdx
–
iRefIdx
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3365 
TempMv
 = 
cMv
[1] - 
cMvPªd
[1][
iRefIdx
[1]];

3366 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMvd
 ( 
TempMv
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3368 
pcCU
->
	`£tI¡îDúSubP¨ts
–2, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(0) );

3370 
pcCU
->
	`£tMVPIdxSubP¨ts
–
ØiMvpIdx
[1][
iRefIdx
[1]], 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3371 
pcCU
->
	`£tMVPNumSubP¨ts
–
ØiMvpNum
[1][
iRefIdx
[1]], 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3373 
uiMEBôs
 = 
uiBôs
[1];

3375 #i‡
AMP_MRG


3379 i‡–
pcCU
->
	`gëP¨tôi⁄Size
–
uiP¨tAddr
 ) !
SIZE_2Nx2N
 )

3381 
UI¡
 
uiMRGI¡îDú
 = 0;

3382 
TComMvFõld
 
cMRGMvFõld
[2];

3383 
UI¡
 
uiMRGIndex
 = 0;

3385 
UI¡
 
uiMEI¡îDú
 = 0;

3386 
TComMvFõld
 
cMEMvFõld
[2];

3388 
m_pcRdCo°
->
	`£À˘MŸi⁄Lambda
–
åue
, 0, 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiP¨tAddr
) );

3390 #i‡
AMP_MRG


3392 
Di°‹ti⁄
 
uiMEEº‹
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3393 
Di°‹ti⁄
 
uiMECo°
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3395 i‡(
bTe°N‹mÆMC
)

3397 
	`xGëI¡îPªdi˘i⁄Eº‹
–
pcCU
, 
pcOrgYuv
, 
iP¨tIdx
, 
uiMEEº‹
, 
m_pcEncCfg
->
	`gëU£HADME
() );

3398 
uiMECo°
 = 
uiMEEº‹
 + 
m_pcRdCo°
->
	`gëCo°
–
uiMEBôs
 );

3402 
Di°‹ti⁄
 
uiMEEº‹
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3403 
	`xGëI¡îPªdi˘i⁄Eº‹
–
pcCU
, 
pcOrgYuv
, 
iP¨tIdx
, 
uiMEEº‹
, 
m_pcEncCfg
->
	`gëU£HADME
() );

3404 
Di°‹ti⁄
 
uiMECo°
 = 
uiMEEº‹
 + 
m_pcRdCo°
->
	`gëCo°
–
uiMEBôs
 );

3407 
uiMEI¡îDú
 = 
pcCU
->
	`gëI¡îDú
–
uiP¨tAddr
 );

3408 
TComD©aCU
::
	`gëMvFõld
–
pcCU
, 
uiP¨tAddr
, 
REF_PIC_LIST_0
, 
cMEMvFõld
[0] );

3409 
TComD©aCU
::
	`gëMvFõld
–
pcCU
, 
uiP¨tAddr
, 
REF_PIC_LIST_1
, 
cMEMvFõld
[1] );

3412 
Di°‹ti⁄
 
uiMRGCo°
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3414 
	`xMîgeE°im©i⁄
–
pcCU
, 
pcOrgYuv
, 
iP¨tIdx
, 
uiMRGI¡îDú
, 
cMRGMvFõld
, 
uiMRGIndex
, 
uiMRGCo°
, 
cMvFõldNeighbours
, 
uhI¡îDúNeighbours
, 
numVÆidMîgeC™d
);

3416 i‡–
uiMRGCo°
 < 
uiMECo°
 )

3419 
pcCU
->
	`£tMîgeFœgSubP¨ts
 ( 
åue
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
( uiPartAddr ) );

3420 
pcCU
->
	`£tMîgeIndexSubP¨ts
–
uiMRGIndex
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
( uiPartAddr ) );

3421 
pcCU
->
	`£tI¡îDúSubP¨ts
 ( 
uiMRGI¡îDú
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
( uiPartAddr ) );

3422 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_0
 )->
	`£tAŒMvFõld
–
cMRGMvFõld
[0], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3423 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_1
 )->
	`£tAŒMvFõld
–
cMRGMvFõld
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3425 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_0
)->
	`£tAŒMvd
 ( 
cMvZîo
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3426 
pcCU
->
	`gëCUMvFõld
(
REF_PIC_LIST_1
)->
	`£tAŒMvd
 ( 
cMvZîo
, 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3428 
pcCU
->
	`£tMVPIdxSubP¨ts
–-1, 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3429 
pcCU
->
	`£tMVPNumSubP¨ts
–-1, 
REF_PIC_LIST_0
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3430 
pcCU
->
	`£tMVPIdxSubP¨ts
–-1, 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3431 
pcCU
->
	`£tMVPNumSubP¨ts
–-1, 
REF_PIC_LIST_1
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3436 
pcCU
->
	`£tMîgeFœgSubP¨ts
–
Ál£
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
( uiPartAddr ) );

3437 
pcCU
->
	`£tI¡îDúSubP¨ts
 ( 
uiMEI¡îDú
, 
uiP¨tAddr
, 
iP¨tIdx
,ÖcCU->
	`gëDïth
( uiPartAddr ) );

3438 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_0
 )->
	`£tAŒMvFõld
–
cMEMvFõld
[0], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3439 
pcCU
->
	`gëCUMvFõld
–
REF_PIC_LIST_1
 )->
	`£tAŒMvFõld
–
cMEMvFõld
[1], 
eP¨tSize
, 
uiP¨tAddr
, 0, 
iP¨tIdx
 );

3443 #i‡
MCTS_ENC_CHECK


3444 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
(Ë&& (!
	`checkTM˘sMvp
(
pcCU
, 
iP¨tIdx
)))

3446 
pcCU
->
	`£tTM˘sMvpIsVÆid
(
Ál£
);

3452 
	`mŸi⁄Com≥nßti⁄
 ( 
pcCU
, 
pcPªdYuv
, 
REF_PIC_LIST_X
, 
iP¨tIdx
 );

3456 
	`£tWpSˇlögDi°P¨am
–
pcCU
, -1, 
REF_PIC_LIST_X
 );

3459 
	}
}

3463 
Void
 
	gTEncSórch
::
	$xE°im©eMvPªdAMVP
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcOrgYuv
, 
UI¡
 
uiP¨tIdx
, 
RefPicLi°
 
eRefPicLi°
, 
I¡
 
iRefIdx
, 
TComMv
& 
rcMvPªd
, 
Boﬁ
 
bFûÀd
, 
Di°‹ti⁄
* 
puiDi°BiP
 )

3465 
AMVPInfo
* 
pcAMVPInfo
 = 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëAMVPInfo
();

3467 
TComMv
 
cBe°Mv
;

3468 
I¡
 
iBe°Idx
 = 0;

3469 
TComMv
 
cZîoMv
;

3470 
TComMv
 
cMvPªd
;

3471 
Di°‹ti⁄
 
uiBe°Co°
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3472 
UI¡
 
uiP¨tAddr
 = 0;

3473 
I¡
 
iRoiWidth
, 
iRoiHeight
;

3474 
I¡
 
i
;

3475 
I¡
 
möMVPC™d
;

3476 
I¡
 
maxMVPC™d
;

3478 
pcCU
->
	`gëP¨tIndexAndSize
–
uiP¨tIdx
, 
uiP¨tAddr
, 
iRoiWidth
, 
iRoiHeight
 );

3480 i‡(!
bFûÀd
)

3482 
pcCU
->
	`fûlMvpC™d
–
uiP¨tIdx
, 
uiP¨tAddr
, 
eRefPicLi°
, 
iRefIdx
, 
pcAMVPInfo
 );

3485 #i‡
MCTS_ENC_CHECK


3486 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
(Ë&& 
pcCU
->
	`isLa°CﬁumnCTUInTûe
(Ë&& (
pcAMVPInfo
->
numS∑tülMVPC™did©es
 <ÖcAMVPInfo->
iN
))

3488 
iBe°Idx
 = (
pcAMVPInfo
->
numS∑tülMVPC™did©es
 == 0) ? 1 : 0;

3489 
cBe°Mv
 = 
pcAMVPInfo
->
m_acMvC™d
[’cAMVPInfo->
numS∑tülMVPC™did©es
 == 0) ? 1 : 0];

3490 
möMVPC™d
 = (
pcAMVPInfo
->
numS∑tülMVPC™did©es
 == 0) ? 1 : 0;

3491 
maxMVPC™d
 = (
pcAMVPInfo
->
numS∑tülMVPC™did©es
 =0Ë?ÖcAMVPInfo->
iN
 : 1;

3495 
iBe°Idx
 = 0;

3496 
cBe°Mv
 = 
pcAMVPInfo
->
m_acMvC™d
[0];

3497 
möMVPC™d
 = 0;

3498 
maxMVPC™d
 = 
pcAMVPInfo
->
iN
;

3501 
iBe°Idx
 = 0;

3502 
cBe°Mv
 = 
pcAMVPInfo
->
m_acMvC™d
[0];

3503 
möMVPC™d
 = 0;

3504 
maxMVPC™d
 = 
pcAMVPInfo
->
iN
;

3506 i‡(
pcAMVPInfo
->
iN
 <= 1)

3508 
rcMvPªd
 = 
cBe°Mv
;

3510 
pcCU
->
	`£tMVPIdxSubP¨ts
–
iBe°Idx
, 
eRefPicLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3511 
pcCU
->
	`£tMVPNumSubP¨ts
–
pcAMVPInfo
->
iN
, 
eRefPicLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3513 if(
pcCU
->
	`gëSli˚
()->
	`gëMvdL1ZîoFœg
(Ë&& 
eRefPicLi°
==
REF_PIC_LIST_1
)

3515 (*
puiDi°BiP
Ë
	`xGëTem∂©eCo°
–
pcCU
, 
uiP¨tAddr
, 
pcOrgYuv
, &
m_cYuvPªdTemp
, 
rcMvPªd
, 0, 
AMVP_MAX_NUM_CANDS
, 
eRefPicLi°
, 
iRefIdx
, 
iRoiWidth
, 
iRoiHeight
);

3520 i‡(
bFûÀd
)

3522 
	`as£π
(
pcCU
->
	`gëMVPIdx
(
eRefPicLi°
,
uiP¨tAddr
) >= 0);

3523 
rcMvPªd
 = 
pcAMVPInfo
->
m_acMvC™d
[
pcCU
->
	`gëMVPIdx
(
eRefPicLi°
,
uiP¨tAddr
)];

3527 
m_cYuvPªdTemp
.
	`˛ór
();

3529  
i
 = 
möMVPC™d
 ; i < 
maxMVPC™d
; i++)

3531 
Di°‹ti⁄
 
uiTmpCo°
;

3532 
uiTmpCo°
 = 
	`xGëTem∂©eCo°
–
pcCU
, 
uiP¨tAddr
, 
pcOrgYuv
, &
m_cYuvPªdTemp
, 
pcAMVPInfo
->
m_acMvC™d
[
i
], i, 
AMVP_MAX_NUM_CANDS
, 
eRefPicLi°
, 
iRefIdx
, 
iRoiWidth
, 
iRoiHeight
);

3533 i‡–
uiBe°Co°
 > 
uiTmpCo°
 )

3535 
uiBe°Co°
 = 
uiTmpCo°
;

3536 
cBe°Mv
 = 
pcAMVPInfo
->
m_acMvC™d
[
i
];

3537 
iBe°Idx
 = 
i
;

3538 (*
puiDi°BiP
Ë
uiTmpCo°
;

3542 
m_cYuvPªdTemp
.
	`˛ór
();

3545 
rcMvPªd
 = 
cBe°Mv
;

3546 
pcCU
->
	`£tMVPIdxSubP¨ts
–
iBe°Idx
, 
eRefPicLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3547 
pcCU
->
	`£tMVPNumSubP¨ts
–
pcAMVPInfo
->
iN
, 
eRefPicLi°
, 
uiP¨tAddr
, 
uiP¨tIdx
,ÖcCU->
	`gëDïth
(uiPartAddr));

3549 
	}
}

3551 
UI¡
 
	gTEncSórch
::
	$xGëMvpIdxBôs
(
I¡
 
iIdx
, I¡ 
iNum
)

3553 
	`as£π
(
iIdx
 >0 && 
iNum
 >= 0 && iIdx < iNum);

3555 i‡(
iNum
 == 1)

3560 
UI¡
 
uiLígth
 = 1;

3561 
I¡
 
iTemp
 = 
iIdx
;

3562 i‡–
iTemp
 == 0 )

3564  
uiLígth
;

3567 
Boﬁ
 
bCodeLa°
 = ( 
iNum
-1 > 
iTemp
 );

3569 
uiLígth
 +(
iTemp
-1);

3571 if–
bCodeLa°
 )

3573 
uiLígth
++;

3576  
uiLígth
;

3577 
	}
}

3579 
Void
 
	gTEncSórch
::
	$xGëBlkBôs
–
P¨tSize
 
eCUMode
, 
Boﬁ
 
bPSli˚
, 
I¡
 
iP¨tIdx
, 
UI¡
 
uiLa°Mode
, UI¡ 
uiBlkBô
[3])

3581 i‡–
eCUMode
 =
SIZE_2Nx2N
 )

3583 
uiBlkBô
[0] = (! 
bPSli˚
) ? 3 : 1;

3584 
uiBlkBô
[1] = 3;

3585 
uiBlkBô
[2] = 5;

3587 i‡–(
eCUMode
 =
SIZE_2NxN
 ||ÉCUModê=
SIZE_2NxnU
Ë||ÉCUModê=
SIZE_2NxnD
 )

3589 
UI¡
 
ØuiMbBôs
[2][3][3] = { { {0,0,3}, {0,0,0}, {0,0,0} } , { {5,7,7}, {7,5,7}, {9-3,9-3,9-3} } };

3590 i‡–
bPSli˚
 )

3592 
uiBlkBô
[0] = 3;

3593 
uiBlkBô
[1] = 0;

3594 
uiBlkBô
[2] = 0;

3598 ::
	`mem˝y
–
uiBlkBô
, 
ØuiMbBôs
[
iP¨tIdx
][
uiLa°Mode
], 3*(
UI¡
) );

3601 i‡–(
eCUMode
 =
SIZE_Nx2N
 ||ÉCUModê=
SIZE_nLx2N
Ë||ÉCUModê=
SIZE_nRx2N
 )

3603 
UI¡
 
ØuiMbBôs
[2][3][3] = { { {0,2,3}, {0,0,0}, {0,0,0} } , { {5,7,7}, {7-2,7-2,9-2}, {9-3,9-3,9-3} } };

3604 i‡–
bPSli˚
 )

3606 
uiBlkBô
[0] = 3;

3607 
uiBlkBô
[1] = 0;

3608 
uiBlkBô
[2] = 0;

3612 ::
	`mem˝y
–
uiBlkBô
, 
ØuiMbBôs
[
iP¨tIdx
][
uiLa°Mode
], 3*(
UI¡
) );

3615 i‡–
eCUMode
 =
SIZE_NxN
 )

3617 
uiBlkBô
[0] = (! 
bPSli˚
) ? 3 : 1;

3618 
uiBlkBô
[1] = 3;

3619 
uiBlkBô
[2] = 5;

3623 
	`¥ötf
("Wrong!\n");

3624 
	`as£π
( 0 );

3626 
	}
}

3628 
Void
 
	gTEncSórch
::
	$xC›yAMVPInfo
 (
AMVPInfo
* 
pSrc
, AMVPInfo* 
pD°
)

3630 
pD°
->
iN
 = 
pSrc
->iN;

3631 
I¡
 
i
 = 0; i < 
pSrc
->
iN
; i++)

3633 
pD°
->
m_acMvC™d
[
i
] = 
pSrc
->m_acMvCand[i];

3635 
	}
}

3637 
Void
 
	gTEncSórch
::
	$xCheckBe°MVP
 ( 
TComD©aCU
* 
pcCU
, 
RefPicLi°
 
eRefPicLi°
, 
TComMv
 
cMv
, TComMv& 
rcMvPªd
, 
I¡
& 
riMVPIdx
, 
UI¡
& 
ruiBôs
, 
Di°‹ti⁄
& 
ruiCo°
 )

3639 
AMVPInfo
* 
pcAMVPInfo
 = 
pcCU
->
	`gëCUMvFõld
(
eRefPicLi°
)->
	`gëAMVPInfo
();

3641 
	`as£π
(
pcAMVPInfo
->
m_acMvC™d
[
riMVPIdx
] =
rcMvPªd
);

3643 i‡(
pcAMVPInfo
->
iN
 < 2)

3648 
m_pcRdCo°
->
	`£À˘MŸi⁄Lambda
–
åue
, 0, 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(0) );

3649 
m_pcRdCo°
->
	`£tCo°SˇÀ
 ( 0 );

3651 
I¡
 
iBe°MVPIdx
 = 
riMVPIdx
;

3653 
m_pcRdCo°
->
	`£tPªdi˘‹
–
rcMvPªd
 );

3654 
I¡
 
iOrgMvBôs
 = 
m_pcRdCo°
->
	`gëBôsOfVe˘‹WôhPªdi˘‹
(
cMv
.
	`gëH‹
(), cMv.
	`gëVî
());

3655 
iOrgMvBôs
 +
m_auiMVPIdxCo°
[
riMVPIdx
][
AMVP_MAX_NUM_CANDS
];

3656 
I¡
 
iBe°MvBôs
 = 
iOrgMvBôs
;

3658 #i‡
MCTS_ENC_CHECK


3659 
I¡
 
möMVPC™d
 = 0;

3660 
I¡
 
maxMVPC™d
 = 
pcAMVPInfo
->
iN
;

3662 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
(Ë&& 
pcCU
->
	`isLa°CﬁumnCTUInTûe
())

3664 
möMVPC™d
 = (
pcAMVPInfo
->
numS∑tülMVPC™did©es
 == 0) ? 1 : 0;

3665 
maxMVPC™d
 = (
pcAMVPInfo
->
numS∑tülMVPC™did©es
 =0Ë?ÖcAMVPInfo->
iN
 : 1;

3667 
I¡
 
iMVPIdx
 = 
möMVPC™d
; iMVPIdx < 
maxMVPC™d
; iMVPIdx++)

3669 
I¡
 
iMVPIdx
 = 0; iMVPIdx < 
pcAMVPInfo
->
iN
; iMVPIdx++)

3672 i‡(
iMVPIdx
 =
riMVPIdx
)

3677 
m_pcRdCo°
->
	`£tPªdi˘‹
–
pcAMVPInfo
->
m_acMvC™d
[
iMVPIdx
] );

3679 
I¡
 
iMvBôs
 = 
m_pcRdCo°
->
	`gëBôsOfVe˘‹WôhPªdi˘‹
(
cMv
.
	`gëH‹
(), cMv.
	`gëVî
());

3680 
iMvBôs
 +
m_auiMVPIdxCo°
[
iMVPIdx
][
AMVP_MAX_NUM_CANDS
];

3682 i‡(
iMvBôs
 < 
iBe°MvBôs
)

3684 
iBe°MvBôs
 = 
iMvBôs
;

3685 
iBe°MVPIdx
 = 
iMVPIdx
;

3689 i‡(
iBe°MVPIdx
 !
riMVPIdx
)

3691 
rcMvPªd
 = 
pcAMVPInfo
->
m_acMvC™d
[
iBe°MVPIdx
];

3693 
riMVPIdx
 = 
iBe°MVPIdx
;

3694 
UI¡
 
uiOrgBôs
 = 
ruiBôs
;

3695 
ruiBôs
 = 
uiOrgBôs
 - 
iOrgMvBôs
 + 
iBe°MvBôs
;

3696 
ruiCo°
 = (ruiCo° - 
m_pcRdCo°
->
	`gëCo°
–
uiOrgBôs
 )Ë+ m_pcRdCo°->gëCo°–
ruiBôs
 );

3698 
	}
}

3701 
Di°‹ti⁄
 
	gTEncSórch
::
	$xGëTem∂©eCo°
–
TComD©aCU
* 
pcCU
,

3702 
UI¡
 
uiP¨tAddr
,

3703 
TComYuv
* 
pcOrgYuv
,

3704 
TComYuv
* 
pcTem∂©eC™d
,

3705 
TComMv
 
cMvC™d
,

3706 
I¡
 
iMVPIdx
,

3707 
I¡
 
iMVPNum
,

3708 
RefPicLi°
 
eRefPicLi°
,

3709 
I¡
 
iRefIdx
,

3710 
I¡
 
iSizeX
,

3711 
I¡
 
iSizeY


3714 
Di°‹ti⁄
 
uiCo°
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3716 
TComPicYuv
* 
pcPicYuvRef
 = 
pcCU
->
	`gëSli˚
()->
	`gëRefPic
–
eRefPicLi°
, 
iRefIdx
 )->
	`gëPicYuvRec
();

3718 
pcCU
->
	`˛ùMv
–
cMvC™d
 );

3721 i‡–
pcCU
->
	`gëSli˚
()->
	`ã°WeightPªd
(Ë&&ÖcCU->gëSli˚()->
	`gëSli˚Ty≥
()==
P_SLICE
 )

3723 
	`xPªdI¡îBlk
–
COMPONENT_Y
, 
pcCU
, 
pcPicYuvRef
, 
uiP¨tAddr
, &
cMvC™d
, 
iSizeX
, 
iSizeY
, 
pcTem∂©eC™d
, 
åue
,ÖcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
) );

3727 
	`xPªdI¡îBlk
–
COMPONENT_Y
, 
pcCU
, 
pcPicYuvRef
, 
uiP¨tAddr
, &
cMvC™d
, 
iSizeX
, 
iSizeY
, 
pcTem∂©eC™d
, 
Ál£
,ÖcCU->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
) );

3730 i‡–
pcCU
->
	`gëSli˚
()->
	`ã°WeightPªd
(Ë&&ÖcCU->gëSli˚()->
	`gëSli˚Ty≥
()==
P_SLICE
 )

3732 
	`xWeighãdPªdi˘i⁄Uni
–
pcCU
, 
pcTem∂©eC™d
, 
uiP¨tAddr
, 
iSizeX
, 
iSizeY
, 
eRefPicLi°
,ÖcTem∂©eC™d, 
iRefIdx
 );

3737 
uiCo°
 = 
m_pcRdCo°
->
	`gëDi°P¨t
–
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
), 
pcTem∂©eC™d
->
	`gëAddr
(
COMPONENT_Y
, 
uiP¨tAddr
),ÖcTem∂©eC™d->
	`gëSåide
(COMPONENT_Y), 
pcOrgYuv
->gëAddr(COMPONENT_Y, uiP¨tAddr),ÖcOrgYuv->gëSåide(COMPONENT_Y), 
iSizeX
, 
iSizeY
, COMPONENT_Y, 
DF_SAD
 );

3738 
uiCo°
 = (
UI¡
Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–
m_auiMVPIdxCo°
[
iMVPIdx
][
iMVPNum
], uiCo°, 
DF_SAD
 );

3739  
uiCo°
;

3740 
	}
}

3743 
Void
 
	gTEncSórch
::
	$xMŸi⁄E°im©i⁄
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcYuvOrg
, 
I¡
 
iP¨tIdx
, 
RefPicLi°
 
eRefPicLi°
, 
TComMv
* 
pcMvPªd
, I¡ 
iRefIdxPªd
, TComMv& 
rcMv
, 
UI¡
& 
ruiBôs
, 
Di°‹ti⁄
& 
ruiCo°
, 
Boﬁ
 
bBi
 )

3745 
UI¡
 
uiP¨tAddr
;

3746 
I¡
 
iRoiWidth
;

3747 
I¡
 
iRoiHeight
;

3749 
TComMv
 
cMvHÆf
, 
cMvQãr
;

3750 
TComMv
 
cMvSrchRngLT
;

3751 
TComMv
 
cMvSrchRngRB
;

3753 
TComYuv
* 
pcYuv
 = 
pcYuvOrg
;

3755 
	`as£π
(
eRefPicLi°
 < 
MAX_NUM_REF_LIST_ADAPT_SR
 && 
iRefIdxPªd
<
	`I¡
(
MAX_IDX_ADAPT_SR
));

3756 
m_iSórchR™ge
 = 
m_ØiAd≠tSR
[
eRefPicLi°
][
iRefIdxPªd
];

3758 
I¡
 
iSrchRng
 = ( 
bBi
 ? 
m_bùªdSórchR™ge
 : 
m_iSórchR™ge
 );

3759 
TComP©ã∫
 
cP©ã∫
;

3761 
DoubÀ
 
fWeight
 = 1.0;

3763 
pcCU
->
	`gëP¨tIndexAndSize
–
iP¨tIdx
, 
uiP¨tAddr
, 
iRoiWidth
, 
iRoiHeight
 );

3765 i‡–
bBi
 )

3767 
TComYuv
* 
pcYuvOthî
 = &
m_acYuvPªd
[1-(
I¡
)
eRefPicLi°
];

3768 
pcYuv
 = &
m_cYuvPªdTemp
;

3770 
pcYuvOrg
->
	`c›yP¨tToP¨tYuv
–
pcYuv
, 
uiP¨tAddr
, 
iRoiWidth
, 
iRoiHeight
 );

3772 
pcYuv
->
	`ªmoveHighFªq
–
pcYuvOthî
, 
uiP¨tAddr
, 
iRoiWidth
, 
iRoiHeight
, 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïths
().
ªc⁄
, 
m_pcEncCfg
->
	`gëClùF‹BiPªdMeE«bÀd
() );

3774 
fWeight
 = 0.5;

3776 
m_cDi°P¨am
.
bIsBiPªd
 = 
bBi
;

3779 #i‡
MCTS_ENC_CHECK


3780 
I¡
 
roiPosX
, 
roiPosY
;

3781 
I¡
 
roiW
, 
roiH
;

3782 
pcCU
->
	`gëP¨tPosôi⁄
(
iP¨tIdx
, 
roiPosX
, 
roiPosY
, 
roiW
, 
roiH
);

3783 
	`as£π
(
roiW
 =
iRoiWidth
);

3784 
	`as£π
(
roiH
 =
iRoiHeight
);

3785 
cP©ã∫
.
	`öôP©ã∫
–
pcYuv
->
	`gëAddr
(
COMPONENT_Y
, 
uiP¨tAddr
),

3786 
iRoiWidth
,

3787 
iRoiHeight
,

3788 
pcYuv
->
	`gëSåide
(
COMPONENT_Y
),

3789 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
),

3790 
roiPosX
,

3791 
roiPosY
);

3792 
	`xInôTûeB‹dîs
(
pcCU
, &
cP©ã∫
);

3794 
cP©ã∫
.
	`öôP©ã∫
–
pcYuv
->
	`gëAddr
 ( 
COMPONENT_Y
, 
uiP¨tAddr
 ),

3795 
iRoiWidth
,

3796 
iRoiHeight
,

3797 
pcYuv
->
	`gëSåide
(
COMPONENT_Y
),

3798 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
) );

3801 
Pñ
* 
piRefY
 = 
pcCU
->
	`gëSli˚
()->
	`gëRefPic
–
eRefPicLi°
, 
iRefIdxPªd
 )->
	`gëPicYuvRec
()->
	`gëAddr
–
COMPONENT_Y
,ÖcCU->
	`gëCtuRsAddr
(),ÖcCU->
	`gëZ‹dîIdxInCtu
(Ë+ 
uiP¨tAddr
 );

3802 
I¡
 
iRefSåide
 = 
pcCU
->
	`gëSli˚
()->
	`gëRefPic
–
eRefPicLi°
, 
iRefIdxPªd
 )->
	`gëPicYuvRec
()->
	`gëSåide
(
COMPONENT_Y
);

3804 
TComMv
 
cMvPªd
 = *
pcMvPªd
;

3806 i‡–
bBi
 )

3808 #i‡
MCTS_ENC_CHECK


3809 
	`xSëSórchR™ge
(
pcCU
, 
rcMv
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
, &
cP©ã∫
);

3811 
	`xSëSórchR™ge
(
pcCU
, 
rcMv
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
);

3816 #i‡
MCTS_ENC_CHECK


3817 
	`xSëSórchR™ge
(
pcCU
, 
cMvPªd
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
, &
cP©ã∫
);

3819 
	`xSëSórchR™ge
(
pcCU
, 
cMvPªd
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
);

3823 
m_pcRdCo°
->
	`£À˘MŸi⁄Lambda
–
åue
, 0, 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiP¨tAddr
) );

3825 
m_pcRdCo°
->
	`£tPªdi˘‹
 ( *
pcMvPªd
 );

3826 
m_pcRdCo°
->
	`£tCo°SˇÀ
 ( 2 );

3828 
	`£tWpSˇlögDi°P¨am
–
pcCU
, 
iRefIdxPªd
, 
eRefPicLi°
 );

3830 i‡–(
m_mŸi⁄E°im©i⁄SórchMëhod
==
MESEARCH_FULL
Ë|| 
bBi
 )

3832 
	`xP©ã∫Sórch
 ( &
cP©ã∫
, 
piRefY
, 
iRefSåide
, &
cMvSrchRngLT
, &
cMvSrchRngRB
, 
rcMv
, 
ruiCo°
 );

3836 
rcMv
 = *
pcMvPªd
;

3837 c⁄° 
TComMv
 *
pI¡egîMv2Nx2NPªd
=0;

3838 i‡(
pcCU
->
	`gëP¨tôi⁄Size
(0Ë!
SIZE_2Nx2N
 ||ÖcCU->
	`gëDïth
(0) != 0)

3840 
pI¡egîMv2Nx2NPªd
 = &(
m_öãgîMv2Nx2N
[
eRefPicLi°
][
iRefIdxPªd
]);

3842 
	`xP©ã∫SórchFa°
 ( 
pcCU
, &
cP©ã∫
, 
piRefY
, 
iRefSåide
, &
cMvSrchRngLT
, &
cMvSrchRngRB
, 
rcMv
, 
ruiCo°
, 
pI¡egîMv2Nx2NPªd
 );

3843 i‡(
pcCU
->
	`gëP¨tôi⁄Size
(0Ë=
SIZE_2Nx2N
)

3845 
m_öãgîMv2Nx2N
[
eRefPicLi°
][
iRefIdxPªd
] = 
rcMv
;

3849 
m_pcRdCo°
->
	`£À˘MŸi⁄Lambda
–
åue
, 0, 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiP¨tAddr
) );

3850 
m_pcRdCo°
->
	`£tCo°SˇÀ
 ( 1 );

3852 c⁄° 
Boﬁ
 
bIsLos¶essCoded
 = 
pcCU
->
	`gëCUTønsqu™tBy∑ss
(
uiP¨tAddr
) != 0;

3853 
	`xP©ã∫SórchFøcDIF
–
bIsLos¶essCoded
, &
cP©ã∫
, 
piRefY
, 
iRefSåide
, &
rcMv
, 
cMvHÆf
, 
cMvQãr
, 
ruiCo°
 );

3855 
m_pcRdCo°
->
	`£tCo°SˇÀ
( 0 );

3856 
rcMv
 <<= 2;

3857 
rcMv
 +(
cMvHÆf
 <<= 1);

3858 
rcMv
 +
cMvQãr
;

3860 
UI¡
 
uiMvBôs
 = 
m_pcRdCo°
->
	`gëBôsOfVe˘‹WôhPªdi˘‹
–
rcMv
.
	`gëH‹
(),ÑcMv.
	`gëVî
() );

3862 
ruiBôs
 +
uiMvBôs
;

3863 
ruiCo°
 = (
Di°‹ti⁄
)–
	`Êo‹
–
fWeight
 * ( (
DoubÀ
ÏuiCo° - (DoubÀ)
m_pcRdCo°
->
	`gëCo°
–
uiMvBôs
 ) ) ) + (DoubÀ)m_pcRdCo°->gëCo°–
ruiBôs
 ) );

3864 
	}
}

3866 #i‡
MCTS_ENC_CHECK


3867 
Void
 
	gTEncSórch
::
	$xInôTûeB‹dîs
(c⁄° 
TComD©aCU
* c⁄° 
pcCU
, 
TComP©ã∫
* 
pcP©ã∫Key
)

3869 i‡(
m_pcEncCfg
->
	`gëTMCTSSEITûeC⁄°øöt
())

3871 
UI¡
 
tûeXPosInCtus
 = 0;

3872 
UI¡
 
tûeYPosInCtus
 = 0;

3873 
UI¡
 
tûeWidthtInCtus
 = 0;

3874 
UI¡
 
tûeHeightInCtus
 = 0;

3876 
	`gëTûePosôi⁄
(
pcCU
, 
tûeXPosInCtus
, 
tûeYPosInCtus
, 
tûeWidthtInCtus
, 
tûeHeightInCtus
);

3878 c⁄° 
I¡
 
˘uLígth
 = 
pcCU
->
	`gëPic
()->
	`gëPicSym
()->
	`gëSPS
().
	`gëMaxCUWidth
();

3881 c⁄° 
I¡
 
tûeLe·T›PñPosX
 = 
˘uLígth
 * 
tûeXPosInCtus
;

3882 c⁄° 
I¡
 
tûeLe·T›PñPosY
 = 
˘uLígth
 * 
tûeYPosInCtus
;

3883 c⁄° 
I¡
 
tûeRightBŸtomPñPosX
 = ((
tûeWidthtInCtus
 + 
tûeXPosInCtus
Ë* 
˘uLígth
) - 1;

3884 c⁄° 
I¡
 
tûeRightBŸtomPñPosY
 = ((
tûeHeightInCtus
 + 
tûeYPosInCtus
Ë* 
˘uLígth
) - 1;

3886 
pcP©ã∫Key
->
	`£tTûeB‹dîs
 (
tûeLe·T›PñPosX
,
tûeLe·T›PñPosY
,
tûeRightBŸtomPñPosX
,
tûeRightBŸtomPñPosY
);

3888 
	}
}

3892 
Void
 
	gTEncSórch
::
xSëSórchR™ge
 ( c⁄° 
TComD©aCU
* c⁄° 
pcCU
, c⁄° 
TComMv
& 
cMvPªd
, c⁄° 
I¡
 
iSrchRng
,

3893 #i‡
MCTS_ENC_CHECK


3894 
TComMv
& 
rcMvSrchRngLT
, TComMv& 
rcMvSrchRngRB
, c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
 )

3896 
	gTComMv
& 
	grcMvSrchRngLT
, TComMv& 
	grcMvSrchRngRB
 )

3899 
I¡
 
	giMvShi·
 = 2;

3900 
TComMv
 
	gcTmpMvPªd
 = 
cMvPªd
;

3901 
	gpcCU
->
˛ùMv
–
cTmpMvPªd
 );

3903 #i‡
MCTS_ENC_CHECK


3904 i‡(
	gm_pcEncCfg
->
gëTMCTSSEITûeC⁄°øöt
())

3906 c⁄° 
I¡
 
	glR™geXLe·
 = 
max
(
cTmpMvPªd
.
gëH‹
(Ë- (
iSrchRng
 << 
iMvShi·
), (
pcP©ã∫Key
->
gëTûeLe·T›PñPosX
(Ë-ÖcP©ã∫Key->
gëROIYPosX
()) << iMvShift);

3907 c⁄° 
I¡
 
	glR™geYT›
 = 
max
(
cTmpMvPªd
.
gëVî
(Ë- (
iSrchRng
 << 
iMvShi·
), (
pcP©ã∫Key
->
gëTûeLe·T›PñPosY
(Ë-ÖcP©ã∫Key->
gëROIYPosY
()) << iMvShift);

3908 c⁄° 
I¡
 
	glR™geXRight
 = 
mö
(
cTmpMvPªd
.
gëH‹
(Ë+ (
iSrchRng
 << 
iMvShi·
), (
pcP©ã∫Key
->
gëTûeRightBŸtomPñPosX
(Ë- (pcP©ã∫Key->
gëROIYPosX
(Ë+ÖcP©ã∫Key->
gëROIYWidth
())) << iMvShift);

3909 c⁄° 
I¡
 
	glR™geYBŸtom
 = 
mö
(
cTmpMvPªd
.
gëVî
(Ë+ (
iSrchRng
 << 
iMvShi·
), (
pcP©ã∫Key
->
gëTûeRightBŸtomPñPosY
(Ë- (pcP©ã∫Key->
gëROIYPosY
(Ë+ÖcP©ã∫Key->
gëROIYHeight
())) << iMvShift);

3911 
	grcMvSrchRngLT
.
£tH‹
(
lR™geXLe·
);

3912 
	grcMvSrchRngLT
.
£tVî
(
lR™geYT›
);

3914 
	grcMvSrchRngRB
.
£tH‹
(
lR™geXRight
);

3915 
	grcMvSrchRngRB
.
£tVî
(
lR™geYBŸtom
);

3919 
	grcMvSrchRngLT
.
£tH‹
(
cTmpMvPªd
.
gëH‹
(Ë- (
iSrchRng
 << 
iMvShi·
));

3920 
	grcMvSrchRngLT
.
£tVî
(
cTmpMvPªd
.
gëVî
(Ë- (
iSrchRng
 << 
iMvShi·
));

3922 
	grcMvSrchRngRB
.
£tH‹
–
cTmpMvPªd
.
gëH‹
(Ë+ (
iSrchRng
 << 
iMvShi·
));

3923 
	grcMvSrchRngRB
.
£tVî
–
cTmpMvPªd
.
gëVî
(Ë+ (
iSrchRng
 << 
iMvShi·
) );

3926 
	grcMvSrchRngLT
.
£tH‹
–
cTmpMvPªd
.
gëH‹
(Ë- (
iSrchRng
 << 
iMvShi·
) );

3927 
	grcMvSrchRngLT
.
£tVî
–
cTmpMvPªd
.
gëVî
(Ë- (
iSrchRng
 << 
iMvShi·
) );

3929 
	grcMvSrchRngRB
.
£tH‹
–
cTmpMvPªd
.
gëH‹
(Ë+ (
iSrchRng
 << 
iMvShi·
));

3930 
	grcMvSrchRngRB
.
£tVî
–
cTmpMvPªd
.
gëVî
(Ë+ (
iSrchRng
 << 
iMvShi·
) );

3933 
	gpcCU
->
˛ùMv
 ( 
rcMvSrchRngLT
 );

3934 
	gpcCU
->
˛ùMv
 ( 
rcMvSrchRngRB
 );

3936 #i‡
ME_ENABLE_ROUNDING_OF_MVS


3937 
	grcMvSrchRngLT
.
divideByPowîOf2
(
iMvShi·
);

3938 
	grcMvSrchRngRB
.
divideByPowîOf2
(
iMvShi·
);

3940 
	grcMvSrchRngLT
 >>
iMvShi·
;

3941 
	grcMvSrchRngRB
 >>
iMvShi·
;

3946 
Void
 
	gTEncSórch
::
	$xP©ã∫Sórch
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

3947 c⁄° 
Pñ
* 
piRefY
,

3948 c⁄° 
I¡
 
iRefSåide
,

3949 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

3950 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

3951 
TComMv
& 
rcMv
,

3952 
Di°‹ti⁄
& 
ruiSAD
 )

3954 
I¡
 
iSrchRngH‹Le·
 = 
pcMvSrchRngLT
->
	`gëH‹
();

3955 
I¡
 
iSrchRngH‹Right
 = 
pcMvSrchRngRB
->
	`gëH‹
();

3956 
I¡
 
iSrchRngVîT›
 = 
pcMvSrchRngLT
->
	`gëVî
();

3957 
I¡
 
iSrchRngVîBŸtom
 = 
pcMvSrchRngRB
->
	`gëVî
();

3959 
Di°‹ti⁄
 
uiSad
;

3960 
Di°‹ti⁄
 
uiSadBe°
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
	`max
();

3961 
I¡
 
iBe°X
 = 0;

3962 
I¡
 
iBe°Y
 = 0;

3965 
m_pcRdCo°
->
	`£tDi°P¨am
–
pcP©ã∫Key
, 
piRefY
, 
iRefSåide
, 
m_cDi°P¨am
 );

3968 i‡–
m_pcEncCfg
->
	`gëFa°I¡îSórchMode
()==
FASTINTERSEARCH_MODE1
 || m_pcEncCfg->gëFa°I¡îSórchMode()==
FASTINTERSEARCH_MODE3
 )

3970 i‡–
m_cDi°P¨am
.
iRows
 > 8 )

3972 
m_cDi°P¨am
.
iSubShi·
 = 1;

3976 
piRefY
 +(
iSrchRngVîT›
 * 
iRefSåide
);

3977  
I¡
 
y
 = 
iSrchRngVîT›
; y <
iSrchRngVîBŸtom
; y++ )

3979  
I¡
 
x
 = 
iSrchRngH‹Le·
; x <
iSrchRngH‹Right
; x++ )

3982 
m_cDi°P¨am
.
pCur
 = 
piRefY
 + 
x
;

3984 
	`£tDi°P¨amComp
(
COMPONENT_Y
);

3986 
m_cDi°P¨am
.
bôDïth
 = 
pcP©ã∫Key
->
	`gëBôDïthY
();

3987 
uiSad
 = 
m_cDi°P¨am
.
	`Di°Func
( &m_cDistParam );

3990 
uiSad
 +
m_pcRdCo°
->
	`gëCo°OfVe˘‹WôhPªdi˘‹
–
x
, 
y
 );

3992 i‡–
uiSad
 < 
uiSadBe°
 )

3994 
uiSadBe°
 = 
uiSad
;

3995 
iBe°X
 = 
x
;

3996 
iBe°Y
 = 
y
;

3997 
m_cDi°P¨am
.
m_maximumDi°‹ti⁄F‹E¨lyExô
 = 
uiSad
;

4000 
piRefY
 +
iRefSåide
;

4003 
rcMv
.
	`£t
–
iBe°X
, 
iBe°Y
 );

4005 
ruiSAD
 = 
uiSadBe°
 - 
m_pcRdCo°
->
	`gëCo°OfVe˘‹WôhPªdi˘‹
–
iBe°X
, 
iBe°Y
 );

4007 
	}
}

4010 
Void
 
	gTEncSórch
::
	$xP©ã∫SórchFa°
–c⁄° 
TComD©aCU
* c⁄° 
pcCU
,

4011 c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

4012 c⁄° 
Pñ
* c⁄° 
piRefY
,

4013 c⁄° 
I¡
 
iRefSåide
,

4014 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

4015 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

4016 
TComMv
& 
rcMv
,

4017 
Di°‹ti⁄
& 
ruiSAD
,

4018 c⁄° 
TComMv
* c⁄° 
pI¡egîMv2Nx2NPªd
 )

4020 
	`as£π
 (
MD_LEFT
 < 
NUM_MV_PREDICTORS
);

4021 
pcCU
->
	`gëMvPªdLe·
 ( 
m_acMvPªdi˘‹s
[
MD_LEFT
] );

4022 
	`as£π
 (
MD_ABOVE
 < 
NUM_MV_PREDICTORS
);

4023 
pcCU
->
	`gëMvPªdAbove
 ( 
m_acMvPªdi˘‹s
[
MD_ABOVE
] );

4024 
	`as£π
 (
MD_ABOVE_RIGHT
 < 
NUM_MV_PREDICTORS
);

4025 
pcCU
->
	`gëMvPªdAboveRight
 ( 
m_acMvPªdi˘‹s
[
MD_ABOVE_RIGHT
] );

4027  
m_mŸi⁄E°im©i⁄SórchMëhod
 )

4029 
MESEARCH_DIAMOND
:

4030 
	`xTZSórch
–
pcCU
, 
pcP©ã∫Key
, 
piRefY
, 
iRefSåide
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
rcMv
, 
ruiSAD
, 
pI¡egîMv2Nx2NPªd
, 
Ál£
 );

4033 
MESEARCH_SELECTIVE
:

4034 
	`xTZSórchSñe˘ive
–
pcCU
, 
pcP©ã∫Key
, 
piRefY
, 
iRefSåide
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
rcMv
, 
ruiSAD
, 
pI¡egîMv2Nx2NPªd
 );

4037 
MESEARCH_DIAMOND_ENHANCED
:

4038 
	`xTZSórch
–
pcCU
, 
pcP©ã∫Key
, 
piRefY
, 
iRefSåide
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
rcMv
, 
ruiSAD
, 
pI¡egîMv2Nx2NPªd
, 
åue
 );

4041 
MESEARCH_FULL
:

4045 
	}
}

4048 
Void
 
	gTEncSórch
::
	$xTZSórch
–c⁄° 
TComD©aCU
* c⁄° 
pcCU
,

4049 c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

4050 c⁄° 
Pñ
* c⁄° 
piRefY
,

4051 c⁄° 
I¡
 
iRefSåide
,

4052 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

4053 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

4054 
TComMv
& 
rcMv
,

4055 
Di°‹ti⁄
& 
ruiSAD
,

4056 c⁄° 
TComMv
* c⁄° 
pI¡egîMv2Nx2NPªd
,

4057 c⁄° 
Boﬁ
 
bExãndedSëtögs
)

4059 c⁄° 
Boﬁ
 
bU£Ad≠tiveRa°î
 = 
bExãndedSëtögs
;

4060 c⁄° 
I¡
 
iRa°î
 = 5;

4061 c⁄° 
Boﬁ
 
bTe°OthîPªdi˘edMV
 = 
bExãndedSëtögs
;

4062 c⁄° 
Boﬁ
 
bTe°ZîoVe˘‹
 = 
åue
;

4063 c⁄° 
Boﬁ
 
bTe°ZîoVe˘‹Sèπ
 = 
bExãndedSëtögs
;

4064 c⁄° 
Boﬁ
 
bTe°ZîoVe˘‹St›
 = 
Ál£
;

4065 c⁄° 
Boﬁ
 
bFú°SórchDüm⁄d
 = 
åue
;

4066 c⁄° 
Boﬁ
 
bFú°C‹√rsF‹Düm⁄dDi°1
 = 
bExãndedSëtögs
;

4067 c⁄° 
Boﬁ
 
bFú°SórchSt›
 = 
m_pcEncCfg
->
	`gëFa°MEAssumögSmoŸhîMVE«bÀd
();

4068 c⁄° 
UI¡
 
uiFú°SórchRounds
 = 3;

4069 c⁄° 
Boﬁ
 
bE«bÀRa°îSórch
 = 
åue
;

4070 c⁄° 
Boﬁ
 
bAlwaysRa°îSórch
 = 
bExãndedSëtögs
;

4071 c⁄° 
Boﬁ
 
bRa°îReföemítE«bÀ
 = 
Ál£
;

4072 c⁄° 
Boﬁ
 
bRa°îReföemítDüm⁄d
 = 
Ál£
;

4073 c⁄° 
Boﬁ
 
bRa°îReföemítC‹√rsF‹Düm⁄dDi°1
 = 
bExãndedSëtögs
;

4074 c⁄° 
Boﬁ
 
bSèrReföemítE«bÀ
 = 
åue
;

4075 c⁄° 
Boﬁ
 
bSèrReföemítDüm⁄d
 = 
åue
;

4076 c⁄° 
Boﬁ
 
bSèrReföemítC‹√rsF‹Düm⁄dDi°1
 = 
bExãndedSëtögs
;

4077 c⁄° 
Boﬁ
 
bSèrReföemítSt›
 = 
Ál£
;

4078 c⁄° 
UI¡
 
uiSèrReföemítRounds
 = 2;

4079 c⁄° 
Boﬁ
 
bNewZîoNeighbourhoodTe°
 = 
bExãndedSëtögs
;

4081 
UI¡
 
uiSórchR™ge
 = 
m_iSórchR™ge
;

4082 
pcCU
->
	`˛ùMv
–
rcMv
 );

4083 #i‡
ME_ENABLE_ROUNDING_OF_MVS


4084 
rcMv
.
	`divideByPowîOf2
(2);

4086 
rcMv
 >>= 2;

4089 
I¡TZSórchSåu˘
 
cSåu˘
;

4090 
cSåu˘
.
iYSåide
 = 
iRefSåide
;

4091 
cSåu˘
.
piRefY
 =ÖiRefY;

4092 
cSåu˘
.
uiBe°Sad
 = 
MAX_UINT
;

4095 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
rcMv
.
	`gëH‹
(),ÑcMv.
	`gëVî
(), 0, 0 );

4098 i‡–
bTe°OthîPªdi˘edMV
 )

4100  
UI¡
 
ödex
 = 0; index < 
NUM_MV_PREDICTORS
; index++ )

4102 
TComMv
 
cMv
 = 
m_acMvPªdi˘‹s
[
ödex
];

4103 
pcCU
->
	`˛ùMv
–
cMv
 );

4104 #i‡
ME_ENABLE_ROUNDING_OF_MVS


4105 
cMv
.
	`divideByPowîOf2
(2);

4107 
cMv
 >>= 2;

4109 i‡(
cMv
 !
rcMv
 && (cMv.
	`gëH‹
(Ë!
cSåu˘
.
iBe°X
 && cMv.
	`gëVî
(Ë!cSåu˘.
iBe°Y
))

4112 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
cMv
.
	`gëH‹
(), cMv.
	`gëVî
(), 0, 0 );

4118 i‡–
bTe°ZîoVe˘‹
 )

4120 i‡((
rcMv
.
	`gëH‹
(Ë!0 ||ÑcMv.
	`gëVî
() != 0) &&

4121 (0 !
cSåu˘
.
iBe°X
 || 0 !cSåu˘.
iBe°Y
))

4124 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 0, 0, 0, 0 );

4128 
I¡
 
iSrchRngH‹Le·
 = 
pcMvSrchRngLT
->
	`gëH‹
();

4129 
I¡
 
iSrchRngH‹Right
 = 
pcMvSrchRngRB
->
	`gëH‹
();

4130 
I¡
 
iSrchRngVîT›
 = 
pcMvSrchRngLT
->
	`gëVî
();

4131 
I¡
 
iSrchRngVîBŸtom
 = 
pcMvSrchRngRB
->
	`gëVî
();

4133 i‡(
pI¡egîMv2Nx2NPªd
 != 0)

4135 
TComMv
 
öãgîMv2Nx2NPªd
 = *
pI¡egîMv2Nx2NPªd
;

4136 
öãgîMv2Nx2NPªd
 <<= 2;

4137 
pcCU
->
	`˛ùMv
–
öãgîMv2Nx2NPªd
 );

4138 #i‡
ME_ENABLE_ROUNDING_OF_MVS


4139 
öãgîMv2Nx2NPªd
.
	`divideByPowîOf2
(2);

4141 
öãgîMv2Nx2NPªd
 >>= 2;

4143 i‡((
rcMv
 !
öãgîMv2Nx2NPªd
) &&

4144 (
öãgîMv2Nx2NPªd
.
	`gëH‹
(Ë!
cSåu˘
.
iBe°X
 || i¡egîMv2Nx2NPªd.
	`gëVî
(Ë!cSåu˘.
iBe°Y
))

4147 
	`xTZSórchHñp
(
pcP©ã∫Key
, 
cSåu˘
, 
öãgîMv2Nx2NPªd
.
	`gëH‹
(), i¡egîMv2Nx2NPªd.
	`gëVî
(), 0, 0);

4151 
TComMv
 
cMvSrchRngLT
;

4152 
TComMv
 
cMvSrchRngRB
;

4153 
I¡
 
iSrchRng
 = 
m_iSórchR™ge
;

4154 
TComMv
 
	`cuºBe°Mv
(
cSåu˘
.
iBe°X
, cSåu˘.
iBe°Y
 );

4155 
cuºBe°Mv
 <<= 2;

4156 #i‡
MCTS_ENC_CHECK


4157 
	`xSëSórchR™ge
(
pcCU
, 
cuºBe°Mv
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
, 
pcP©ã∫Key
);

4159 
	`xSëSórchR™ge
(
pcCU
, 
cuºBe°Mv
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
);

4161 
iSrchRngH‹Le·
 = 
cMvSrchRngLT
.
	`gëH‹
();

4162 
iSrchRngH‹Right
 = 
cMvSrchRngRB
.
	`gëH‹
();

4163 
iSrchRngVîT›
 = 
cMvSrchRngLT
.
	`gëVî
();

4164 
iSrchRngVîBŸtom
 = 
cMvSrchRngRB
.
	`gëVî
();

4168 
I¡
 
iDi°
 = 0;

4169 
I¡
 
iSèπX
 = 
cSåu˘
.
iBe°X
;

4170 
I¡
 
iSèπY
 = 
cSåu˘
.
iBe°Y
;

4172 c⁄° 
Boﬁ
 
bBe°C™did©eZîo
 = (
cSåu˘
.
iBe°X
 =0Ë&& (cSåu˘.
iBe°Y
 == 0);

4176  
iDi°
 = 1; iDi° <(
I¡
)
uiSórchR™ge
; iDist*=2 )

4178 i‡–
bFú°SórchDüm⁄d
 == 1 )

4180 
	`xTZ8PoötDüm⁄dSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
, 
bFú°C‹√rsF‹Düm⁄dDi°1
 );

4184 
	`xTZ8PoötSqu¨eSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
 );

4187 i‡–
bFú°SórchSt›
 && ( 
cSåu˘
.
uiBe°Round
 >
uiFú°SórchRounds
 ) )

4193 i‡(!
bNewZîoNeighbourhoodTe°
)

4196 i‡–
bTe°ZîoVe˘‹Sèπ
 && ((
cSåu˘
.
iBe°X
 !0Ë|| (cSåu˘.
iBe°Y
 != 0)) )

4198 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 0, 0, 0, 0 );

4199 i‡–(
cSåu˘
.
iBe°X
 =0Ë&& (cSåu˘.
iBe°Y
 == 0) )

4202  
iDi°
 = 1; iDi° <(
I¡
)
uiSórchR™ge
; iDist*=2 )

4204 
	`xTZ8PoötDüm⁄dSórch
–
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 0, 0, 
iDi°
, 
Ál£
 );

4205 i‡–
bTe°ZîoVe˘‹St›
 && (
cSåu˘
.
uiBe°Round
 > 0) )

4219 i‡(
bTe°ZîoVe˘‹Sèπ
 =
åue
 && 
bBe°C™did©eZîo
 !=Årue)

4221  
iDi°
 = 1; iDi° <((
I¡
)
uiSórchR™ge
 >> 1); iDist*=2 )

4223 
	`xTZ8PoötDüm⁄dSórch
–
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 0, 0, 
iDi°
, 
Ál£
 );

4224 i‡–
bTe°ZîoVe˘‹St›
 && (
cSåu˘
.
uiBe°Round
 > 2) )

4233 i‡–
cSåu˘
.
uiBe°Di°™˚
 == 1 )

4235 
cSåu˘
.
uiBe°Di°™˚
 = 0;

4236 
	`xTZ2PoötSórch
–
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
 );

4240 i‡(
bU£Ad≠tiveRa°î
)

4242 
I¡
 
iWödowSize
 = 
iRa°î
;

4243 
I¡
 
iSrchRngRa°îLe·
 = 
iSrchRngH‹Le·
;

4244 
I¡
 
iSrchRngRa°îRight
 = 
iSrchRngH‹Right
;

4245 
I¡
 
iSrchRngRa°îT›
 = 
iSrchRngVîT›
;

4246 
I¡
 
iSrchRngRa°îBŸtom
 = 
iSrchRngVîBŸtom
;

4248 i‡(!(
bE«bÀRa°îSórch
 && ( ((
I¡
)(
cSåu˘
.
uiBe°Di°™˚
Ë> 
iRa°î
))))

4250 
iWödowSize
 ++;

4251 
iSrchRngRa°îLe·
 /= 2;

4252 
iSrchRngRa°îRight
 /= 2;

4253 
iSrchRngRa°îT›
 /= 2;

4254 
iSrchRngRa°îBŸtom
 /= 2;

4256 
cSåu˘
.
uiBe°Di°™˚
 = 
iWödowSize
;

4257  
iSèπY
 = 
iSrchRngRa°îT›
; iSèπY <
iSrchRngRa°îBŸtom
; iSèπY +
iWödowSize
 )

4259  
iSèπX
 = 
iSrchRngRa°îLe·
; iSèπX <
iSrchRngRa°îRight
; iSèπX +
iWödowSize
 )

4261 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
iSèπX
, 
iSèπY
, 0, 
iWödowSize
 );

4267 i‡–
bE«bÀRa°îSórch
 && ( ((
I¡
)(
cSåu˘
.
uiBe°Di°™˚
Ë> 
iRa°î
Ë|| 
bAlwaysRa°îSórch
 ) )

4269 
cSåu˘
.
uiBe°Di°™˚
 = 
iRa°î
;

4270  
iSèπY
 = 
iSrchRngVîT›
; iSèπY <
iSrchRngVîBŸtom
; iSèπY +
iRa°î
 )

4272  
iSèπX
 = 
iSrchRngH‹Le·
; iSèπX <
iSrchRngH‹Right
; iSèπX +
iRa°î
 )

4274 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
iSèπX
, 
iSèπY
, 0, 
iRa°î
 );

4282 i‡–
bRa°îReföemítE«bÀ
 && 
cSåu˘
.
uiBe°Di°™˚
 > 0 )

4284  
cSåu˘
.
uiBe°Di°™˚
 > 0 )

4286 
iSèπX
 = 
cSåu˘
.
iBe°X
;

4287 
iSèπY
 = 
cSåu˘
.
iBe°Y
;

4288 i‡–
cSåu˘
.
uiBe°Di°™˚
 > 1 )

4290 
iDi°
 = 
cSåu˘
.
uiBe°Di°™˚
 >>= 1;

4291 i‡–
bRa°îReföemítDüm⁄d
 == 1 )

4293 
	`xTZ8PoötDüm⁄dSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
, 
bRa°îReföemítC‹√rsF‹Düm⁄dDi°1
 );

4297 
	`xTZ8PoötSqu¨eSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
 );

4302 i‡–
cSåu˘
.
uiBe°Di°™˚
 == 1 )

4304 
cSåu˘
.
uiBe°Di°™˚
 = 0;

4305 i‡–
cSåu˘
.
ucPoötNr
 != 0 )

4307 
	`xTZ2PoötSórch
–
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
 );

4314 i‡–
bSèrReföemítE«bÀ
 && 
cSåu˘
.
uiBe°Di°™˚
 > 0 )

4316  
cSåu˘
.
uiBe°Di°™˚
 > 0 )

4318 
iSèπX
 = 
cSåu˘
.
iBe°X
;

4319 
iSèπY
 = 
cSåu˘
.
iBe°Y
;

4320 
cSåu˘
.
uiBe°Di°™˚
 = 0;

4321 
cSåu˘
.
ucPoötNr
 = 0;

4322  
iDi°
 = 1; iDi° < (
I¡
)
uiSórchR™ge
 + 1; iDist*=2 )

4324 i‡–
bSèrReföemítDüm⁄d
 == 1 )

4326 
	`xTZ8PoötDüm⁄dSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
, 
bSèrReföemítC‹√rsF‹Düm⁄dDi°1
 );

4330 
	`xTZ8PoötSqu¨eSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
 );

4332 i‡–
bSèrReföemítSt›
 && (
cSåu˘
.
uiBe°Round
 >
uiSèrReföemítRounds
) )

4339 i‡–
cSåu˘
.
uiBe°Di°™˚
 == 1 )

4341 
cSåu˘
.
uiBe°Di°™˚
 = 0;

4342 i‡–
cSåu˘
.
ucPoötNr
 != 0 )

4344 
	`xTZ2PoötSórch
–
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
 );

4351 
rcMv
.
	`£t
–
cSåu˘
.
iBe°X
, cSåu˘.
iBe°Y
 );

4352 
ruiSAD
 = 
cSåu˘
.
uiBe°Sad
 - 
m_pcRdCo°
->
	`gëCo°OfVe˘‹WôhPªdi˘‹
–cSåu˘.
iBe°X
, cSåu˘.
iBe°Y
 );

4353 
	}
}

4356 
Void
 
	gTEncSórch
::
	$xTZSórchSñe˘ive
–c⁄° 
TComD©aCU
* c⁄° 
pcCU
,

4357 c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

4358 c⁄° 
Pñ
* c⁄° 
piRefY
,

4359 c⁄° 
I¡
 
iRefSåide
,

4360 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

4361 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

4362 
TComMv
 &
rcMv
,

4363 
Di°‹ti⁄
 &
ruiSAD
,

4364 c⁄° 
TComMv
* c⁄° 
pI¡egîMv2Nx2NPªd
 )

4366 c⁄° 
Boﬁ
 
bTe°OthîPªdi˘edMV
 = 
åue
;

4367 c⁄° 
Boﬁ
 
bTe°ZîoVe˘‹
 = 
åue
;

4368 c⁄° 
Boﬁ
 
bE«bÀRa°îSórch
 = 
åue
;

4369 c⁄° 
Boﬁ
 
bAlwaysRa°îSórch
 = 
Ál£
;

4370 c⁄° 
Boﬁ
 
bSèrReföemítE«bÀ
 = 
åue
;

4371 c⁄° 
Boﬁ
 
bSèrReföemítDüm⁄d
 = 
åue
;

4372 c⁄° 
Boﬁ
 
bSèrReföemítSt›
 = 
Ál£
;

4373 c⁄° 
UI¡
 
uiSèrReföemítRounds
 = 2;

4374 c⁄° 
UI¡
 
uiSórchR™ge
 = 
m_iSórchR™ge
;

4375 c⁄° 
I¡
 
uiSórchR™geInôül
 = 
m_iSórchR™ge
 >> 2;

4376 c⁄° 
I¡
 
uiSórchSãp
 = 4;

4377 c⁄° 
I¡
 
iMVDi°Thªsh
 = 8;

4379 
I¡
 
iSrchRngH‹Le·
 = 
pcMvSrchRngLT
->
	`gëH‹
();

4380 
I¡
 
iSrchRngH‹Right
 = 
pcMvSrchRngRB
->
	`gëH‹
();

4381 
I¡
 
iSrchRngVîT›
 = 
pcMvSrchRngLT
->
	`gëVî
();

4382 
I¡
 
iSrchRngVîBŸtom
 = 
pcMvSrchRngRB
->
	`gëVî
();

4383 
I¡
 
iFú°SrchRngH‹Le·
 = 0;

4384 
I¡
 
iFú°SrchRngH‹Right
 = 0;

4385 
I¡
 
iFú°SrchRngVîT›
 = 0;

4386 
I¡
 
iFú°SrchRngVîBŸtom
 = 0;

4387 
I¡
 
iSèπX
 = 0;

4388 
I¡
 
iSèπY
 = 0;

4389 
I¡
 
iBe°X
 = 0;

4390 
I¡
 
iBe°Y
 = 0;

4391 
I¡
 
iDi°
 = 0;

4393 
pcCU
->
	`˛ùMv
–
rcMv
 );

4394 #i‡
ME_ENABLE_ROUNDING_OF_MVS


4395 
rcMv
.
	`divideByPowîOf2
(2);

4397 
rcMv
 >>= 2;

4400 
I¡TZSórchSåu˘
 
cSåu˘
;

4401 
cSåu˘
.
iYSåide
 = 
iRefSåide
;

4402 
cSåu˘
.
piRefY
 =ÖiRefY;

4403 
cSåu˘
.
uiBe°Sad
 = 
MAX_UINT
;

4404 
cSåu˘
.
iBe°X
 = 0;

4405 
cSåu˘
.
iBe°Y
 = 0;

4409 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
rcMv
.
	`gëH‹
(),ÑcMv.
	`gëVî
(), 0, 0 );

4412 i‡–
bTe°OthîPªdi˘edMV
 )

4414  
UI¡
 
ödex
 = 0; index < 
NUM_MV_PREDICTORS
; index++ )

4416 
TComMv
 
cMv
 = 
m_acMvPªdi˘‹s
[
ödex
];

4417 
pcCU
->
	`˛ùMv
–
cMv
 );

4418 #i‡
ME_ENABLE_ROUNDING_OF_MVS


4419 
cMv
.
	`divideByPowîOf2
(2);

4421 
cMv
 >>= 2;

4423 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
cMv
.
	`gëH‹
(), cMv.
	`gëVî
(), 0, 0 );

4428 i‡–
bTe°ZîoVe˘‹
 )

4430 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 0, 0, 0, 0 );

4433 i‡–
pI¡egîMv2Nx2NPªd
 != 0 )

4435 
TComMv
 
öãgîMv2Nx2NPªd
 = *
pI¡egîMv2Nx2NPªd
;

4436 
öãgîMv2Nx2NPªd
 <<= 2;

4437 
pcCU
->
	`˛ùMv
–
öãgîMv2Nx2NPªd
 );

4438 #i‡
ME_ENABLE_ROUNDING_OF_MVS


4439 
öãgîMv2Nx2NPªd
.
	`divideByPowîOf2
(2);

4441 
öãgîMv2Nx2NPªd
 >>= 2;

4443 
	`xTZSórchHñp
(
pcP©ã∫Key
, 
cSåu˘
, 
öãgîMv2Nx2NPªd
.
	`gëH‹
(), i¡egîMv2Nx2NPªd.
	`gëVî
(), 0, 0);

4446 
TComMv
 
cMvSrchRngLT
;

4447 
TComMv
 
cMvSrchRngRB
;

4448 
I¡
 
iSrchRng
 = 
m_iSórchR™ge
;

4449 
TComMv
 
	`cuºBe°Mv
(
cSåu˘
.
iBe°X
, cSåu˘.
iBe°Y
 );

4450 
cuºBe°Mv
 <<= 2;

4451 #i‡
MCTS_ENC_CHECK


4452 
	`xSëSórchR™ge
(
pcCU
, 
cuºBe°Mv
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
, 
pcP©ã∫Key
);

4454 
	`xSëSórchR™ge
(
pcCU
, 
cuºBe°Mv
, 
iSrchRng
, 
cMvSrchRngLT
, 
cMvSrchRngRB
);

4456 
iSrchRngH‹Le·
 = 
cMvSrchRngLT
.
	`gëH‹
();

4457 
iSrchRngH‹Right
 = 
cMvSrchRngRB
.
	`gëH‹
();

4458 
iSrchRngVîT›
 = 
cMvSrchRngLT
.
	`gëVî
();

4459 
iSrchRngVîBŸtom
 = 
cMvSrchRngRB
.
	`gëVî
();

4463 
iBe°X
 = 
cSåu˘
.iBestX;

4464 
iBe°Y
 = 
cSåu˘
.iBestY;

4465 
iFú°SrchRngH‹Le·
 = ((
iBe°X
 - 
uiSórchR™geInôül
Ë> 
iSrchRngH‹Le·
) ? (iBestX - uiSearchRangeInitial) : iSrchRngHorLeft;

4466 
iFú°SrchRngVîT›
 = ((
iBe°Y
 - 
uiSórchR™geInôül
Ë> 
iSrchRngVîT›
) ? (iBestY - uiSearchRangeInitial) : iSrchRngVerTop;

4467 
iFú°SrchRngH‹Right
 = ((
iBe°X
 + 
uiSórchR™geInôül
Ë< 
iSrchRngH‹Right
) ? (iBestX + uiSearchRangeInitial) : iSrchRngHorRight;

4468 
iFú°SrchRngVîBŸtom
 = ((
iBe°Y
 + 
uiSórchR™geInôül
Ë< 
iSrchRngVîBŸtom
) ? (iBestY + uiSearchRangeInitial) : iSrchRngVerBottom;

4470  
iSèπY
 = 
iFú°SrchRngVîT›
; iSèπY <
iFú°SrchRngVîBŸtom
; iSèπY +
uiSórchSãp
 )

4472  
iSèπX
 = 
iFú°SrchRngH‹Le·
; iSèπX <
iFú°SrchRngH‹Right
; iSèπX +
uiSórchSãp
 )

4474 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
iSèπX
, 
iSèπY
, 0, 0 );

4475 
	`xTZ8PoötDüm⁄dSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 1, 
Ál£
 );

4476 
	`xTZ8PoötDüm⁄dSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 2, 
Ál£
 );

4480 
I¡
 
iMaxMVDi°ToPªd
 = (
	`abs
(
cSåu˘
.
iBe°X
 - iBe°XË> 
iMVDi°Thªsh
 ||ábs(cSåu˘.
iBe°Y
 - iBestY) > iMVDistThresh);

4483 i‡–
bE«bÀRa°îSórch
 && (
iMaxMVDi°ToPªd
 || 
bAlwaysRa°îSórch
) )

4485  
iSèπY
 = 
iSrchRngVîT›
; iSèπY <
iSrchRngVîBŸtom
; iStartY += 1 )

4487  
iSèπX
 = 
iSrchRngH‹Le·
; iSèπX <
iSrchRngH‹Right
; iStartX += 1 )

4489 
	`xTZSórchHñp
–
pcP©ã∫Key
, 
cSåu˘
, 
iSèπX
, 
iSèπY
, 0, 1 );

4494 i‡–
bSèrReföemítE«bÀ
 && 
cSåu˘
.
uiBe°Di°™˚
 > 0 )

4497  
cSåu˘
.
uiBe°Di°™˚
 > 0 )

4499 
iSèπX
 = 
cSåu˘
.
iBe°X
;

4500 
iSèπY
 = 
cSåu˘
.
iBe°Y
;

4501 
cSåu˘
.
uiBe°Di°™˚
 = 0;

4502 
cSåu˘
.
ucPoötNr
 = 0;

4503  
iDi°
 = 1; iDi° < (
I¡
)
uiSórchR™ge
 + 1; iDist*=2 )

4505 i‡–
bSèrReföemítDüm⁄d
 == 1 )

4507 
	`xTZ8PoötDüm⁄dSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
, 
Ál£
 );

4511 
	`xTZ8PoötSqu¨eSórch
 ( 
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
, 
iSèπX
, 
iSèπY
, 
iDi°
 );

4513 i‡–
bSèrReföemítSt›
 && (
cSåu˘
.
uiBe°Round
 >
uiSèrReföemítRounds
) )

4520 i‡–
cSåu˘
.
uiBe°Di°™˚
 == 1 )

4522 
cSåu˘
.
uiBe°Di°™˚
 = 0;

4523 i‡–
cSåu˘
.
ucPoötNr
 != 0 )

4525 
	`xTZ2PoötSórch
–
pcP©ã∫Key
, 
cSåu˘
, 
pcMvSrchRngLT
, 
pcMvSrchRngRB
 );

4532 
rcMv
.
	`£t
–
cSåu˘
.
iBe°X
, cSåu˘.
iBe°Y
 );

4533 
ruiSAD
 = 
cSåu˘
.
uiBe°Sad
 - 
m_pcRdCo°
->
	`gëCo°OfVe˘‹WôhPªdi˘‹
–cSåu˘.
iBe°X
, cSåu˘.
iBe°Y
 );

4535 
	}
}

4538 
Void
 
	gTEncSórch
::
	$xP©ã∫SórchFøcDIF
(

4539 
Boﬁ
 
bIsLos¶essCoded
,

4540 
TComP©ã∫
* 
pcP©ã∫Key
,

4541 
Pñ
* 
piRefY
,

4542 
I¡
 
iRefSåide
,

4543 
TComMv
* 
pcMvI¡
,

4544 
TComMv
& 
rcMvHÆf
,

4545 
TComMv
& 
rcMvQãr
,

4546 
Di°‹ti⁄
& 
ruiCo°


4550 
TComP©ã∫
 
cP©ã∫Roi
;

4551 
I¡
 
iOff£t
 = 
pcMvI¡
->
	`gëH‹
(Ë+ÖcMvI¡->
	`gëVî
(Ë* 
iRefSåide
;

4552 
cP©ã∫Roi
.
	`öôP©ã∫
(
piRefY
 + 
iOff£t
,

4553 
pcP©ã∫Key
->
	`gëROIYWidth
(),

4554 
pcP©ã∫Key
->
	`gëROIYHeight
(),

4555 
iRefSåide
,

4556 #i‡
MCTS_ENC_CHECK


4557 
pcP©ã∫Key
->
	`gëBôDïthY
(),

4558 
pcP©ã∫Key
->
	`gëROIYPosX
(),

4559 
pcP©ã∫Key
->
	`gëROIYPosY
());

4561 
pcP©ã∫Key
->
	`gëBôDïthY
());

4563 #i‡
MCTS_ENC_CHECK


4564 
cP©ã∫Roi
.
	`£tTûeB‹dîs
(
pcP©ã∫Key
->
	`gëTûeLe·T›PñPosX
(),ÖcP©ã∫Key->
	`gëTûeLe·T›PñPosY
(),ÖcP©ã∫Key->
	`gëTûeRightBŸtomPñPosX
(),ÖcP©ã∫Key->
	`gëTûeRightBŸtomPñPosY
());

4568 
	`xExtDIFUpSam∂ögH
 ( &
cP©ã∫Roi
 );

4570 
rcMvHÆf
 = *
pcMvI¡
;ÑcMvHalf <<= 1;

4571 
TComMv
 
	`ba£RefMv
(0, 0);

4572 
ruiCo°
 = 
	`xP©ã∫Reföemít
–
pcP©ã∫Key
, 
ba£RefMv
, 2, 
rcMvHÆf
, !
bIsLos¶essCoded
 );

4574 
m_pcRdCo°
->
	`£tCo°SˇÀ
( 0 );

4576 
	`xExtDIFUpSam∂ögQ
 ( &
cP©ã∫Roi
, 
rcMvHÆf
 );

4577 
ba£RefMv
 = 
rcMvHÆf
;

4578 
ba£RefMv
 <<= 1;

4580 
rcMvQãr
 = *
pcMvI¡
;ÑcMvQter <<= 1;

4581 
rcMvQãr
 +
rcMvHÆf
;ÑcMvQter <<= 1;

4582 
ruiCo°
 = 
	`xP©ã∫Reföemít
–
pcP©ã∫Key
, 
ba£RefMv
, 1, 
rcMvQãr
, !
bIsLos¶essCoded
 );

4583 
	}
}

4587 
Void
 
	gTEncSórch
::
ícodeResAndCÆcRdI¡îCU
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcYuvOrg
, TComYuv* 
pcYuvPªd
,

4588 
TComYuv
* 
pcYuvResi
, TComYuv* 
pcYuvResiBe°
, TComYuv* 
pcYuvRec
,

4589 
Boﬁ
 
bSkùResiduÆ
 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
) )

4591 
	`as£π
 ( !
pcCU
->
	`isI¡ø
(0) );

4593 c⁄° 
UI¡
 
cuWidthPixñs
 = 
pcCU
->
	`gëWidth
 ( 0 );

4594 c⁄° 
UI¡
 
cuHeightPixñs
 = 
pcCU
->
	`gëHeight
( 0 );

4595 c⁄° 
I¡
 
numVÆidComp⁄íts
 = 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

4596 c⁄° 
TComSPS
 &
•s
=*(
pcCU
->
	`gëSli˚
()->
	`gëSPS
());

4601 i‡–
bSkùResiduÆ
 )

4603 
pcCU
->
	`£tSkùFœgSubP¨ts
–
åue
, 0,ÖcCU->
	`gëDïth
(0) );

4605 
pcYuvResi
->
	`˛ór
();

4607 
pcYuvPªd
->
	`c›yToP¨tYuv
–
pcYuvRec
, 0 );

4608 
Di°‹ti⁄
 
di°‹ti⁄
 = 0;

4610 
I¡
 
comp
=0; com∞< 
numVÆidComp⁄íts
; comp++)

4612 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

4613 c⁄° 
UI¡
 
csx
=
pcYuvOrg
->
	`gëComp⁄ítSˇÀX
(
compID
);

4614 c⁄° 
UI¡
 
csy
=
pcYuvOrg
->
	`gëComp⁄ítSˇÀY
(
compID
);

4615 
di°‹ti⁄
 +
m_pcRdCo°
->
	`gëDi°P¨t
–
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
)), 
pcYuvRec
->
	`gëAddr
(compID),ÖcYuvRec->
	`gëSåide
(compID), 
pcYuvOrg
->getAddr(compID),

4616 
pcYuvOrg
->
	`gëSåide
(
compID
), 
cuWidthPixñs
 >> 
csx
, 
cuHeightPixñs
 >> 
csy
, compID);

4619 
m_pcRDGoOnSbacCodî
->
	`lﬂd
(
m_µpcRDSbacCodî
[
pcCU
->
	`gëDïth
(0)][
CI_CURR_BEST
]);

4620 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

4622 i‡(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

4624 
m_pcE¡r›yCodî
->
	`ícodeCUTønsqu™tBy∑ssFœg
(
pcCU
, 0, 
åue
);

4627 
m_pcE¡r›yCodî
->
	`ícodeSkùFœg
(
pcCU
, 0, 
åue
);

4628 
m_pcE¡r›yCodî
->
	`ícodeMîgeIndex
–
pcCU
, 0, 
åue
 );

4630 
UI¡
 
uiBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

4631 
pcCU
->
	`gëTŸÆBôs
(Ë
uiBôs
;

4632 
pcCU
->
	`gëTŸÆDi°‹ti⁄
(Ë
di°‹ti⁄
;

4633 
pcCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiBôs
, 
di°‹ti⁄
 );

4635 
m_pcRDGoOnSbacCodî
->
	`°‹e
(
m_µpcRDSbacCodî
[
pcCU
->
	`gëDïth
(0)][
CI_TEMP_BEST
]);

4637 #i‡
DEBUG_STRING


4638 
pcYuvResiBe°
->
	`˛ór
();

4639 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
+1; i++)

4641 
sDebug
+=
debug_ª‹dî_d©a_öãr_tokí
[
i
];

4650 
pcYuvResi
->
	`subåa˘
–
pcYuvOrg
, 
pcYuvPªd
, 0, 
cuWidthPixñs
 );

4652 
TComTURecur£
 
	`tuLevñ0
(
pcCU
, 0);

4654 
DoubÀ
 
n⁄ZîoCo°
 = 0;

4655 
UI¡
 
n⁄ZîoBôs
 = 0;

4656 
Di°‹ti⁄
 
n⁄ZîoDi°‹ti⁄
 = 0;

4657 
Di°‹ti⁄
 
zîoDi°‹ti⁄
 = 0;

4659 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
pcCU
->
	`gëDïth
–0 ) ][ 
CI_CURR_BEST
 ] );

4661 
	`xE°im©eI¡îResiduÆQT
–
pcYuvResi
, 
n⁄ZîoCo°
, 
n⁄ZîoBôs
, 
n⁄ZîoDi°‹ti⁄
, &
zîoDi°‹ti⁄
, 
tuLevñ0
 
	`DEBUG_STRING_PASS_INTO
(
sDebug
) );

4668 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

4669 
m_pcE¡r›yCodî
->
	`ícodeQtRoŸCbfZîo
( );

4670 c⁄° 
UI¡
 
zîoResiBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

4671 c⁄° 
DoubÀ
 
zîoCo°
 = (
pcCU
->
	`isLos¶essCoded
–0 )Ë? (
n⁄ZîoCo°
+1Ë: (
m_pcRdCo°
->
	`ˇlcRdCo°
–
zîoResiBôs
, 
zîoDi°‹ti⁄
 ));

4673 i‡–
zîoCo°
 < 
n⁄ZîoCo°
 || !
pcCU
->
	`gëQtRoŸCbf
(0) )

4675 c⁄° 
UI¡
 
uiQP¨tNum
 = 
tuLevñ0
.
	`GëAbsP¨tIdxNumP¨ts
();

4676 ::
	`mem£t
–
pcCU
->
	`gëTønsf‹mIdx
(Ë, 0, 
uiQP¨tNum
 * (
UCh¨
) );

4677 
I¡
 
comp
=0; com∞< 
numVÆidComp⁄íts
; comp++)

4679 c⁄° 
Comp⁄ítID
 
comp⁄ít
 = 
	`Comp⁄ítID
(
comp
);

4680 ::
	`mem£t
–
pcCU
->
	`gëCbf
–
comp⁄ít
 ) , 0, 
uiQP¨tNum
 * (
UCh¨
) );

4681 ::
	`mem£t
–
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
comp⁄ít
), 0, ( 
uiQP¨tNum
 * (
SCh¨
) ) );

4683 c⁄° 
UI¡
 
u£TS
[
MAX_NUM_COMPONENT
]={0,0,0};

4684 
pcCU
->
	`£tTønsf‹mSkùSubP¨ts
 ( 
u£TS
, 0,ÖcCU->
	`gëDïth
(0) );

4685 #i‡
DEBUG_STRING


4686 
sDebug
.
	`˛ór
();

4687 
UI¡
 
i
=0; i<
MAX_NUM_COMPONENT
+1; i++)

4689 
sDebug
+=
debug_ª‹dî_d©a_öãr_tokí
[
i
];

4695 
	`xSëI¡îResiduÆQTD©a
–
NULL
, 
Ál£
, 
tuLevñ0
);

4699 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[
pcCU
->
	`gëDïth
(0)][
CI_CURR_BEST
] );

4701 
UI¡
 
föÆBôs
 = 0;

4702 
	`xAddSymbﬁBôsI¡î
–
pcCU
, 
föÆBôs
 );

4705 i‡–!
pcCU
->
	`gëQtRoŸCbf
( 0 ) )

4707 
pcYuvResiBe°
->
	`˛ór
();

4711 
	`xSëI¡îResiduÆQTD©a
–
pcYuvResiBe°
, 
åue
, 
tuLevñ0
 );

4713 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
pcCU
->
	`gëDïth
–0 ) ][ 
CI_TEMP_BEST
 ] );

4715 
pcYuvRec
->
	`addClù
 ( 
pcYuvPªd
, 
pcYuvResiBe°
, 0, 
cuWidthPixñs
, 
•s
.
	`gëBôDïths
() );

4719 
Di°‹ti⁄
 
föÆDi°‹ti⁄
 = 0;

4720 
I¡
 
comp
=0; comp<
numVÆidComp⁄íts
; comp++)

4722 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

4723 
föÆDi°‹ti⁄
 +
m_pcRdCo°
->
	`gëDi°P¨t
–
•s
.
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
)), 
pcYuvRec
->
	`gëAddr
(compID ),ÖcYuvRec->
	`gëSåide
(compID ), 
pcYuvOrg
->gëAddr(compID ),ÖcYuvOrg->gëSåide(compID), 
cuWidthPixñs
 >>ÖcYuvOrg->
	`gëComp⁄ítSˇÀX
(compID), 
cuHeightPixñs
 >>ÖcYuvOrg->
	`gëComp⁄ítSˇÀY
(compID), compID);

4726 
pcCU
->
	`gëTŸÆBôs
(Ë
föÆBôs
;

4727 
pcCU
->
	`gëTŸÆDi°‹ti⁄
(Ë
föÆDi°‹ti⁄
;

4728 
pcCU
->
	`gëTŸÆCo°
(Ë
m_pcRdCo°
->
	`ˇlcRdCo°
–
föÆBôs
, 
föÆDi°‹ti⁄
 );

4729 
	}
}

4733 
Void
 
	gTEncSórch
::
xE°im©eI¡îResiduÆQT
–
TComYuv
 *
pcResi
,

4734 
DoubÀ
 &
rdCo°
,

4735 
UI¡
 &
ruiBôs
,

4736 
Di°‹ti⁄
 &
ruiDi°
,

4737 
Di°‹ti⁄
 *
puiZîoDi°
,

4738 
TComTU
 &
rTu


4739 
	$DEBUG_STRING_FN_DECLARE
(
sDebug
) )

4741 
TComD©aCU
 *
pcCU
 = 
rTu
.
	`gëCU
();

4742 c⁄° 
UI¡
 
uiAbsP¨tIdx
 = 
rTu
.
	`GëAbsP¨tIdxTU
();

4743 c⁄° 
UI¡
 
uiDïth
 = 
rTu
.
	`GëTønsf‹mDïthTŸÆ
();

4744 c⁄° 
UI¡
 
uiTrMode
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

4745 c⁄° 
UI¡
 
subTUDïth
 = 
uiTrMode
 + 1;

4746 c⁄° 
UI¡
 
numVÆidComp
 = 
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
();

4747 
	`DEBUG_STRING_NEW
(
sSögÀSåögComp
[
MAX_NUM_COMPONENT
])

4749 
	`as£π
–
pcCU
->
	`gëDïth
–0 ) =pcCU->gëDïth–
uiAbsP¨tIdx
 ) );

4750 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

4752 
UI¡
 
S∂ôFœg
 = ((
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTUMaxDïthI¡î
(Ë=1Ë&&ÖcCU->
	`isI¡î
(
uiAbsP¨tIdx
Ë&& (ÖcCU->
	`gëP¨tôi⁄Size
(uiAbsP¨tIdxË!
SIZE_2Nx2N
 ));

4753 #i‡
DEBUG_STRING


4754 c⁄° 
I¡
 
debugPªdModeMask
 = 
	`DebugSåögGëPªdModeMask
(
pcCU
->
	`gëPªdi˘i⁄Mode
(
uiAbsP¨tIdx
));

4757 
Boﬁ
 
bCheckFuŒ
;

4759 i‡–
S∂ôFœg
 && 
uiDïth
 =
pcCU
->
	`gëDïth
(
uiAbsP¨tIdx
Ë&& ( 
uiLog2TrSize
 >ÖcCU->
	`gëQuadåìTULog2MöSizeInCU
(uiAbsPartIdx) ) )

4761 
bCheckFuŒ
 = 
Ál£
;

4765 
bCheckFuŒ
 = ( 
uiLog2TrSize
 <
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
() );

4768 c⁄° 
Boﬁ
 
bCheckS∂ô
 = ( 
uiLog2TrSize
 > 
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) );

4770 
	`as£π
–
bCheckFuŒ
 || 
bCheckS∂ô
 );

4773 
DoubÀ
 
dSögÀCo°
 = 
MAX_DOUBLE
;

4774 
UI¡
 
uiSögÀBôs
 = 0;

4775 
Di°‹ti⁄
 
uiSögÀDi°Comp
 [
MAX_NUM_COMPONENT
][2 ] = {{0,0},{0,0},{0,0}};

4776 
Di°‹ti⁄
 
uiSögÀDi°
 = 0;

4777 
TC€ff
 
uiAbsSum
 [
MAX_NUM_COMPONENT
][2 ] = {{0,0},{0,0},{0,0}};

4778 
UI¡
 
uiBe°Tønsf‹mMode
 [
MAX_NUM_COMPONENT
][2 ] = {{0,0},{0,0},{0,0}};

4780 
UI¡
 
be°Ex∂icôRdpcmModeUnS∂ô
[
MAX_NUM_COMPONENT
][2 ] = {{3,3}, {3,3}, {3,3}};

4781 
SCh¨
 
be°CrossCPªdi˘i⁄AÕha
 [
MAX_NUM_COMPONENT
][2 ] = {{0,0},{0,0},{0,0}};

4783 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

4785 if–
bCheckFuŒ
 )

4787 
DoubÀ
 
möCo°
[
MAX_NUM_COMPONENT
][2 ];

4788 
Boﬁ
 
checkTønsf‹mSkù
[
MAX_NUM_COMPONENT
];

4789 
pcCU
->
	`£tTrIdxSubP¨ts
–
uiTrMode
, 
uiAbsP¨tIdx
, 
uiDïth
 );

4791 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

4793 
	`mem£t
–
m_pTempPñ
, 0, –
Pñ
 ) * 
rTu
.
	`gëRe˘
(
COMPONENT_Y
).
width
 *ÑTu.gëRe˘(COMPONENT_Y).
height
 );

4795 c⁄° 
UI¡
 
uiQTTempAc˚ssLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

4796 
TC€ff
 *
pcC€ffCuº
[
MAX_NUM_COMPONENT
];

4797 #i‡
ADAPTIVE_QP_SELECTION


4798 
TC€ff
 *
pcAæC€ffCuº
[
MAX_NUM_COMPONENT
];

4801 
UI¡
 
i
=0; i<
numVÆidComp
; i++)

4803 
möCo°
[
i
][0] = 
MAX_DOUBLE
;

4804 
möCo°
[
i
][1] = 
MAX_DOUBLE
;

4807 
Pñ
 
¸ossCPªdi˘edResiduÆBuf„r
[ 
MAX_TU_SIZE
 * MAX_TU_SIZE ];

4809 
UI¡
 
i
=0; i<
numVÆidComp
; i++)

4811 
checkTønsf‹mSkù
[
i
]=
Ál£
;

4812 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
i
);

4813 c⁄° 
I¡
 
ch™√lBôDïth
=
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

4814 
pcC€ffCuº
[
compID
] = 
m_µcQTTempC€ff
[compID][
uiQTTempAc˚ssLayî
] + 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

4815 #i‡
ADAPTIVE_QP_SELECTION


4816 
pcAæC€ffCuº
[
compID
] = 
m_µcQTTempAæC€ff
[compID ][
uiQTTempAc˚ssLayî
] + 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

4819 if(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

4821 c⁄° 
QpP¨am
 
	`cQP
(*
pcCU
, 
compID
);

4823 
checkTønsf‹mSkù
[
compID
] = 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëU£Tønsf‹mSkù
() &&

4824 
	`TUCompRe˘HasAssocüãdTønsf‹mSkùFœg
(
rTu
.
	`gëRe˘
(
compID
), 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëLog2MaxTønsf‹mSkùBlockSize
()) &&

4825 (!
pcCU
->
	`isLos¶essCoded
(0));

4827 c⁄° 
Boﬁ
 
•lôI¡oSubTUs
 = 
rTu
.
	`gëRe˘
(
compID
).
width
 !rTu.gëRe˘(compID).
height
;

4829 
TComTURecur£
 
	`TUIãøt‹
(
rTu
, 
Ál£
, (
•lôI¡oSubTUs
 ? 
TComTU
::
VERTICAL_SPLIT
 : TComTU::
DONT_SPLIT
), 
åue
, 
compID
);

4831 c⁄° 
UI¡
 
∑πIdxesPîSubTU
 = 
TUIãøt‹
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
);

4835 c⁄° 
UI¡
 
subTUIndex
 = 
TUIãøt‹
.
	`GëSe˘i⁄Numbî
();

4836 c⁄° 
UI¡
 
subTUAbsP¨tIdx
 = 
TUIãøt‹
.
	`GëAbsP¨tIdxTU
(
compID
);

4837 c⁄° 
TComRe˘™gÀ
 &
tuCompRe˘
 = 
TUIãøt‹
.
	`gëRe˘
(
compID
);

4838 c⁄° 
UI¡
 
subTUBuf„rOff£t
 = 
tuCompRe˘
.
width
 *ÅuCompRe˘.
height
 * 
subTUIndex
;

4840 
TC€ff
 *
cuºítC€fficõ¡s
 = 
pcC€ffCuº
[
compID
] + 
subTUBuf„rOff£t
;

4841 #i‡
ADAPTIVE_QP_SELECTION


4842 
TC€ff
 *
cuºítARLC€fficõ¡s
 = 
pcAæC€ffCuº
[
compID
] + 
subTUBuf„rOff£t
;

4844 c⁄° 
Boﬁ
 
isCrossCPªdi˘i⁄AvaûabÀ
 = 
	`isChroma
(
compID
)

4845 && 
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
()

4846 && (
pcCU
->
	`gëCbf
(
subTUAbsP¨tIdx
, 
COMPONENT_Y
, 
uiTrMode
) != 0);

4848 
SCh¨
 
¥eCÆcAÕha
 = 0;

4849 c⁄° 
Pñ
 *
pLumaResi
 = 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
–
COMPONENT_Y
, 
rTu
.
	`gëRe˘
–COMPONENT_Y ).
x0
,ÑTu.gëRe˘–COMPONENT_Y ).
y0
 );

4851 i‡(
isCrossCPªdi˘i⁄AvaûabÀ
)

4853 c⁄° 
Boﬁ
 
bU£Rec⁄°ru˘edResiduÆF‹E°im©e
 = 
m_pcEncCfg
->
	`gëU£Rec⁄Ba£dCrossCPªdi˘i⁄E°im©e
();

4854 c⁄° 
Pñ
 *c⁄° 
lumaResiduÆF‹E°im©e
 = 
bU£Rec⁄°ru˘edResiduÆF‹E°im©e
 ? 
pLumaResi
 : 
pcResi
->
	`gëAddrPix
(
COMPONENT_Y
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
);

4855 c⁄° 
UI¡
 
lumaResiduÆSåideF‹E°im©e
 = 
bU£Rec⁄°ru˘edResiduÆF‹E°im©e
 ? 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
COMPONENT_Y
Ë: 
pcResi
->getStride(COMPONENT_Y);

4857 
¥eCÆcAÕha
 = 
	`xCÆcCrossComp⁄ítPªdi˘i⁄AÕha
(
TUIãøt‹
,

4858 
compID
,

4859 
lumaResiduÆF‹E°im©e
,

4860 
pcResi
->
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
),

4861 
tuCompRe˘
.
width
,

4862 
tuCompRe˘
.
height
,

4863 
lumaResiduÆSåideF‹E°im©e
,

4864 
pcResi
->
	`gëSåide
(
compID
));

4867 c⁄° 
I¡
 
å™sf‹mSkùModesToTe°
 = 
checkTønsf‹mSkù
[
compID
] ? 2 : 1;

4868 c⁄° 
I¡
 
¸ossCPªdi˘i⁄ModesToTe°
 = (
¥eCÆcAÕha
 != 0) ? 2 : 1;

4870 c⁄° 
Boﬁ
 
isO√Mode
 = (
¸ossCPªdi˘i⁄ModesToTe°
 =1Ë&& (
å™sf‹mSkùModesToTe°
 == 1);

4872 
I¡
 
å™sf‹mSkùModeId
 = 0;Åønsf‹mSkùModeId < 
å™sf‹mSkùModesToTe°
;ÅransformSkipModeId++)

4874 
pcCU
->
	`£tTønsf‹mSkùP¨tR™ge
(
å™sf‹mSkùModeId
, 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
);

4876 
I¡
 
¸ossCPªdi˘i⁄ModeId
 = 0; crossCPªdi˘i⁄ModeId < 
¸ossCPªdi˘i⁄ModesToTe°
; crossCPredictionModeId++)

4878 c⁄° 
Boﬁ
 
isFú°Mode
 = (
å™sf‹mSkùModeId
 =0Ë&& (
¸ossCPªdi˘i⁄ModeId
 == 0);

4879 c⁄° 
Boﬁ
 
bU£CrossCPªdi˘i⁄
 = 
¸ossCPªdi˘i⁄ModeId
 != 0;

4881 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

4882 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

4884 
pcCU
->
	`£tTønsf‹mSkùP¨tR™ge
(
å™sf‹mSkùModeId
, 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
);

4885 
pcCU
->
	`£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
((
bU£CrossCPªdi˘i⁄
 ? 
¥eCÆcAÕha
 : 0), 
compID
, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

4887 i‡((
compID
 !
COMPONENT_Cr
Ë&& ((
å™sf‹mSkùModeId
 =1Ë? 
m_pcEncCfg
->
	`gëU£RDOQTS
(Ë: m_pcEncCfg->
	`gëU£RDOQ
()))

4889 
COEFF_SCAN_TYPE
 
sˇnTy≥
 = 
	`COEFF_SCAN_TYPE
(
pcCU
->
	`gëC€fSˇnIdx
(
uiAbsP¨tIdx
, 
tuCompRe˘
.
width
,ÅuCompRe˘.
height
, 
compID
));

4890 
m_pcE¡r›yCodî
->
	`e°im©eBô
(
m_pcTrQu™t
->
m_pcE°BôsSbac
, 
tuCompRe˘
.
width
,ÅuCompRe˘.
height
, 
	`toCh™√lTy≥
(
compID
), 
sˇnTy≥
);

4893 #i‡
RDOQ_CHROMA_LAMBDA


4894 
m_pcTrQu™t
->
	`£À˘Lambda
(
compID
);

4897 
Pñ
 *
pcResiCuºComp
 = 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
);

4898 
UI¡
 
ªsiSåide
 = 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
compID
);

4900 
TC€ff
 
be°C€ffComp
 [
MAX_TU_SIZE
*MAX_TU_SIZE];

4901 
Pñ
 
be°ResiComp
 [
MAX_TU_SIZE
*MAX_TU_SIZE];

4903 #i‡
ADAPTIVE_QP_SELECTION


4904 
TC€ff
 
be°AæC€ffComp
[
MAX_TU_SIZE
*MAX_TU_SIZE];

4906 
TC€ff
 
cuºAbsSum
 = 0;

4907 
UI¡
 
cuºCompBôs
 = 0;

4908 
Di°‹ti⁄
 
cuºCompDi°
 = 0;

4909 
DoubÀ
 
cuºCompCo°
 = 0;

4910 
UI¡
 
n⁄C€ffBôs
 = 0;

4911 
Di°‹ti⁄
 
n⁄C€ffDi°
 = 0;

4912 
DoubÀ
 
n⁄C€ffCo°
 = 0;

4914 if(!
isO√Mode
 && !
isFú°Mode
)

4916 
	`mem˝y
(
be°C€ffComp
, 
cuºítC€fficõ¡s
, ((
TC€ff
Ë* 
tuCompRe˘
.
width
 *ÅuCompRe˘.
height
));

4917 #i‡
ADAPTIVE_QP_SELECTION


4918 
	`mem˝y
(
be°AæC€ffComp
, 
cuºítARLC€fficõ¡s
, ((
TC€ff
Ë* 
tuCompRe˘
.
width
 *ÅuCompRe˘.
height
));

4920 
I¡
 
y
 = 0; y < 
tuCompRe˘
.
height
; y++)

4922 
	`mem˝y
(&
be°ResiComp
[
y
 * 
tuCompRe˘
.
width
], (
pcResiCuºComp
 + (y * 
ªsiSåide
)), ((
Pñ
) *ÅuCompRect.width));

4926 i‡(
bU£CrossCPªdi˘i⁄
)

4928 
TComTrQu™t
::
	`¸ossComp⁄ítPªdi˘i⁄
(
TUIãøt‹
,

4929 
compID
,

4930 
pLumaResi
,

4931 
pcResi
->
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
),

4932 
¸ossCPªdi˘edResiduÆBuf„r
,

4933 
tuCompRe˘
.
width
,

4934 
tuCompRe˘
.
height
,

4935 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
COMPONENT_Y
),

4936 
pcResi
->
	`gëSåide
(
compID
),

4937 
tuCompRe˘
.
width
,

4938 
Ál£
);

4940 
m_pcTrQu™t
->
	`å™sf‹mNxN
(
TUIãøt‹
, 
compID
, 
¸ossCPªdi˘edResiduÆBuf„r
, 
tuCompRe˘
.
width
, 
cuºítC€fficõ¡s
,

4941 #i‡
ADAPTIVE_QP_SELECTION


4942 
cuºítARLC€fficõ¡s
,

4944 
cuºAbsSum
, 
cQP
);

4948 
m_pcTrQu™t
->
	`å™sf‹mNxN
(
TUIãøt‹
, 
compID
, 
pcResi
->
	`gëAddrPix
–compID, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
 ),ÖcResi->
	`gëSåide
(compID), 
cuºítC€fficõ¡s
,

4949 #i‡
ADAPTIVE_QP_SELECTION


4950 
cuºítARLC€fficõ¡s
,

4952 
cuºAbsSum
, 
cQP
);

4955 if(
isFú°Mode
 || (
cuºAbsSum
 == 0))

4957 i‡(
bU£CrossCPªdi˘i⁄
)

4959 
TComTrQu™t
::
	`¸ossComp⁄ítPªdi˘i⁄
(
TUIãøt‹
,

4960 
compID
,

4961 
pLumaResi
,

4962 
m_pTempPñ
,

4963 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
),

4964 
tuCompRe˘
.
width
,

4965 
tuCompRe˘
.
height
,

4966 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
COMPONENT_Y
),

4967 
tuCompRe˘
.
width
,

4968 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
compID
),

4969 
åue
);

4971 
n⁄C€ffDi°
 = 
m_pcRdCo°
->
	`gëDi°P¨t
–
ch™√lBôDïth
, 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
–
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
 ),

4972 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
–
compID
 ), 
pcResi
->
	`gëAddrPix
–compID, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
 ),

4973 
pcResi
->
	`gëSåide
(
compID
), 
tuCompRe˘
.
width
,ÅuCompRe˘.
height
, compID);

4977 
n⁄C€ffDi°
 = 
m_pcRdCo°
->
	`gëDi°P¨t
–
ch™√lBôDïth
, 
m_pTempPñ
, 
tuCompRe˘
.
width
, 
pcResi
->
	`gëAddrPix
–
compID
,ÅuCompRe˘.
x0
,ÅuCompRe˘.
y0
 ),

4978 
pcResi
->
	`gëSåide
(
compID
), 
tuCompRe˘
.
width
,ÅuCompRe˘.
height
, compID);

4981 
m_pcE¡r›yCodî
->
	`ícodeQtCbfZîo
–
TUIãøt‹
, 
	`toCh™√lTy≥
(
compID
) );

4983 i‡–
isCrossCPªdi˘i⁄AvaûabÀ
 )

4985 
m_pcE¡r›yCodî
->
	`ícodeCrossComp⁄ítPªdi˘i⁄
–
TUIãøt‹
, 
compID
 );

4988 
n⁄C€ffBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

4989 
n⁄C€ffCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
n⁄C€ffBôs
, 
n⁄C€ffDi°
 );

4992 if((
puiZîoDi°
 !
NULL
Ë&& 
isFú°Mode
)

4994 *
puiZîoDi°
 +
n⁄C€ffDi°
;

4997 
	`DEBUG_STRING_NEW
(
sSögÀSåögTe°
)

4999 if–
cuºAbsSum
 > 0 )

5001 i‡(
isFú°Mode
)

5003 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

5004 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

5007 
m_pcE¡r›yCodî
->
	`ícodeQtCbf
–
TUIãøt‹
, 
compID
, 
åue
 );

5009 i‡(
isCrossCPªdi˘i⁄AvaûabÀ
)

5011 
m_pcE¡r›yCodî
->
	`ícodeCrossComp⁄ítPªdi˘i⁄
–
TUIãøt‹
, 
compID
 );

5014 
m_pcE¡r›yCodî
->
	`ícodeC€ffNxN
–
TUIãøt‹
, 
cuºítC€fficõ¡s
, 
compID
 );

5015 
cuºCompBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

5017 
pcResiCuºComp
 = 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
–
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
 );

5019 
m_pcTrQu™t
->
	`övTønsf‹mNxN
–
TUIãøt‹
, 
compID
, 
pcResiCuºComp
, 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(compID), 
cuºítC€fficõ¡s
, 
cQP
 
	`DEBUG_STRING_PASS_INTO_OPTIONAL
(&
sSögÀSåögTe°
, (
DebugO±i⁄Li°
::
DebugSåög_InvTøn
.
	`gëI¡
()&
debugPªdModeMask
)) );

5021 i‡(
bU£CrossCPªdi˘i⁄
)

5023 
TComTrQu™t
::
	`¸ossComp⁄ítPªdi˘i⁄
(
TUIãøt‹
,

5024 
compID
,

5025 
pLumaResi
,

5026 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
),

5027 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
),

5028 
tuCompRe˘
.
width
,

5029 
tuCompRe˘
.
height
,

5030 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
COMPONENT_Y
),

5031 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
compID
 ),

5032 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
compID
 ),

5033 
åue
);

5036 
cuºCompDi°
 = 
m_pcRdCo°
->
	`gëDi°P¨t
–
ch™√lBôDïth
, 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
–
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
 ),

5037 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
compID
),

5038 
pcResi
->
	`gëAddrPix
–
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
 ),

5039 
pcResi
->
	`gëSåide
(
compID
),

5040 
tuCompRe˘
.
width
,ÅuCompRe˘.
height
, 
compID
);

5042 
cuºCompCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
(
cuºCompBôs
, 
cuºCompDi°
);

5044 i‡(
pcCU
->
	`isLos¶essCoded
(0))

5046 
n⁄C€ffCo°
 = 
MAX_DOUBLE
;

5049 i‡((
å™sf‹mSkùModeId
 =1Ë&& !
bU£CrossCPªdi˘i⁄
)

5051 
cuºCompCo°
 = 
MAX_DOUBLE
;

5055 
cuºCompBôs
 = 
n⁄C€ffBôs
;

5056 
cuºCompDi°
 = 
n⁄C€ffDi°
;

5057 
cuºCompCo°
 = 
n⁄C€ffCo°
;

5061 i‡((
cuºCompCo°
 < 
möCo°
[
compID
][
subTUIndex
]Ë|| ((
å™sf‹mSkùModeId
 == 1) && (currCompCost == minCost[compID][subTUIndex])))

5063 
be°Ex∂icôRdpcmModeUnS∂ô
[
compID
][
subTUIndex
] = 
pcCU
->
	`gëEx∂icôRdpcmMode
(compID, 
subTUAbsP¨tIdx
);

5065 if(
isFú°Mode
)

5067 if((
n⁄C€ffCo°
 < 
cuºCompCo°
Ë|| (
cuºAbsSum
 == 0))

5069 
	`mem£t
(
cuºítC€fficõ¡s
, 0, ((
TC€ff
Ë* 
tuCompRe˘
.
width
 *ÅuCompRe˘.
height
));

5071 
cuºAbsSum
 = 0;

5072 
cuºCompBôs
 = 
n⁄C€ffBôs
;

5073 
cuºCompDi°
 = 
n⁄C€ffDi°
;

5074 
cuºCompCo°
 = 
n⁄C€ffCo°
;

5078 #i‡
DEBUG_STRING


5079 i‡(
cuºAbsSum
 > 0)

5081 
	`DEBUG_STRING_SWAP
(
sSögÀSåögComp
[
compID
], 
sSögÀSåögTe°
)

5085 
sSögÀSåögComp
[
compID
].
	`˛ór
();

5089 
uiAbsSum
 [
compID
][
subTUIndex
] = 
cuºAbsSum
;

5090 
uiSögÀDi°Comp
 [
compID
][
subTUIndex
] = 
cuºCompDi°
;

5091 
möCo°
 [
compID
][
subTUIndex
] = 
cuºCompCo°
;

5092 
uiBe°Tønsf‹mMode
 [
compID
][
subTUIndex
] = 
å™sf‹mSkùModeId
;

5093 
be°CrossCPªdi˘i⁄AÕha
[
compID
][
subTUIndex
] = (
¸ossCPªdi˘i⁄ModeId
 =1Ë? 
pcCU
->
	`gëCrossComp⁄ítPªdi˘i⁄AÕha
(
subTUAbsP¨tIdx
, compID) : 0;

5095 i‡(
uiAbsSum
[
compID
][
subTUIndex
] == 0)

5097 i‡(
bU£CrossCPªdi˘i⁄
)

5099 
TComTrQu™t
::
	`¸ossComp⁄ítPªdi˘i⁄
(
TUIãøt‹
,

5100 
compID
,

5101 
pLumaResi
,

5102 
m_pTempPñ
,

5103 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
),

5104 
tuCompRe˘
.
width
,

5105 
tuCompRe˘
.
height
,

5106 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
COMPONENT_Y
),

5107 
tuCompRe˘
.
width
,

5108 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
compID
),

5109 
åue
);

5113 
pcResiCuºComp
 = 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëAddrPix
(
compID
, 
tuCompRe˘
.
x0
,ÅuCompRe˘.
y0
);

5114 c⁄° 
UI¡
 
uiSåide
 = 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`gëSåide
(
compID
);

5115 
UI¡
 
uiY
 = 0; uiY < 
tuCompRe˘
.
height
; uiY++)

5117 
	`mem£t
(
pcResiCuºComp
, 0, ((
Pñ
Ë* 
tuCompRe˘
.
width
));

5118 
pcResiCuºComp
 +
uiSåide
;

5126 
	`mem˝y
(
cuºítC€fficõ¡s
, 
be°C€ffComp
, ((
TC€ff
Ë* 
tuCompRe˘
.
width
 *ÅuCompRe˘.
height
));

5127 #i‡
ADAPTIVE_QP_SELECTION


5128 
	`mem˝y
(
cuºítARLC€fficõ¡s
, 
be°AæC€ffComp
, ((
TC€ff
Ë* 
tuCompRe˘
.
width
 *ÅuCompRe˘.
height
));

5130 
I¡
 
y
 = 0; y < 
tuCompRe˘
.
height
; y++)

5132 
	`mem˝y
((
pcResiCuºComp
 + (
y
 * 
ªsiSåide
)), &
be°ResiComp
[y * 
tuCompRe˘
.
width
], ((
Pñ
) *ÅuCompRect.width));

5138 
pcCU
->
	`£tEx∂icôRdpcmModeP¨tR™ge
 ( 
be°Ex∂icôRdpcmModeUnS∂ô
[
compID
][
subTUIndex
], compID, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
);

5139 
pcCU
->
	`£tTønsf‹mSkùP¨tR™ge
 ( 
uiBe°Tønsf‹mMode
 [
compID
][
subTUIndex
], compID, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

5140 
pcCU
->
	`£tCbfP¨tR™ge
 ((((
uiAbsSum
 [
compID
][
subTUIndex
] > 0Ë? 1 : 0Ë<< 
uiTrMode
), compID, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

5141 
pcCU
->
	`£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
–
be°CrossCPªdi˘i⁄AÕha
 [
compID
][
subTUIndex
], compID, 
subTUAbsP¨tIdx
, 
∑πIdxesPîSubTU
 );

5142 } 
TUIãøt‹
.
	`√xtSe˘i⁄
(
rTu
));

5146 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5148 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

5149 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
Ë&& (rTu.
	`gëRe˘
(compID).
width
 !rTu.gëRe˘(compID).
height
))

5151 
	`off£tSubTUCBFs
(
rTu
, 
compID
);

5155 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

5156 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

5158 if–
uiLog2TrSize
 > 
pcCU
->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) )

5160 
m_pcE¡r›yCodî
->
	`ícodeTønsf‹mSubdivFœg
–0, 5 - 
uiLog2TrSize
 );

5163 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5165 c⁄° 
UI¡
 
chOrdîCh™ge
 = ((
ch
 + 1Ë=
numVÆidComp
) ? 0 : (ch + 1);

5166 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
chOrdîCh™ge
);

5167 if–
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
) )

5169 
m_pcE¡r›yCodî
->
	`ícodeQtCbf
–
rTu
, 
compID
, 
åue
 );

5173 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5175 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

5176 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

5178 if(
	`isChroma
(
compID
Ë&& (
uiAbsSum
[
COMPONENT_Y
][0] != 0))

5180 
m_pcE¡r›yCodî
->
	`ícodeCrossComp⁄ítPªdi˘i⁄
–
rTu
, 
compID
 );

5183 
m_pcE¡r›yCodî
->
	`ícodeC€ffNxN
–
rTu
, 
pcC€ffCuº
[
compID
], compID );

5184 
UI¡
 
subTUIndex
 = 0; subTUIndex < 2; subTUIndex++)

5186 
uiSögÀDi°
 +
uiSögÀDi°Comp
[
compID
][
subTUIndex
];

5191 
uiSögÀBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

5193 
dSögÀCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiSögÀBôs
, 
uiSögÀDi°
 );

5197 if–
bCheckS∂ô
 )

5199 if–
bCheckFuŒ
 )

5201 
m_pcRDGoOnSbacCodî
->
	`°‹e
–
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_TEST
 ] );

5202 
m_pcRDGoOnSbacCodî
->
	`lﬂd
 ( 
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

5204 
Di°‹ti⁄
 
uiSubdivDi°
 = 0;

5205 
UI¡
 
uiSubdivBôs
 = 0;

5206 
DoubÀ
 
dSubdivCo°
 = 0.0;

5210 
UI¡
 
be°CBF
 [
MAX_NUM_COMPONENT
];

5211 
UI¡
 
be°subTUCBF
[
MAX_NUM_COMPONENT
][2];

5212 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5214 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

5216 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

5218 
be°CBF
[
compID
] = 
pcCU
->
	`gëCbf
(
uiAbsP¨tIdx
, compID, 
uiTrMode
);

5220 c⁄° 
TComRe˘™gÀ
 &
tuCompRe˘
 = 
rTu
.
	`gëRe˘
(
compID
);

5221 i‡(
tuCompRe˘
.
width
 !tuCompRe˘.
height
)

5223 c⁄° 
UI¡
 
∑πIdxesPîSubTU
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
) >> 1;

5225 
UI¡
 
subTU
 = 0; subTU < 2; subTU++)

5227 
be°subTUCBF
[
compID
][
subTU
] = 
pcCU
->
	`gëCbf
 ((
uiAbsP¨tIdx
 + (subTU * 
∑πIdxesPîSubTU
)), compID, 
subTUDïth
);

5234 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

5235 c⁄° 
UI¡
 
uiQP¨tNumSubdiv
 = 
tuRecur£Chûd
.
	`GëAbsP¨tIdxNumP¨ts
();

5237 
	`DEBUG_STRING_NEW
(
sS∂ôSåög
[
MAX_NUM_COMPONENT
])

5241 
	`DEBUG_STRING_NEW
(
chûdSåög
)

5242 
	`xE°im©eI¡îResiduÆQT
–
pcResi
, 
dSubdivCo°
, 
uiSubdivBôs
, 
uiSubdivDi°
, 
bCheckFuŒ
 ? 
NULL
 : 
puiZîoDi°
, 
tuRecur£Chûd
 
	`DEBUG_STRING_PASS_INTO
(
chûdSåög
));

5243 #i‡
DEBUG_STRING


5245 
°d
::
size_t
 
œ°Pos
=0;

5246 c⁄° 
°d
::
size_t
 
ídSång
=
chûdSåög
.
	`föd
(
debug_ª‹dî_d©a_öãr_tokí
[
MAX_NUM_COMPONENT
], 
œ°Pos
);

5247 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5249 i‡(
œ°Pos
!=
°d
::
°rög
::
≈os
 && 
chûdSåög
.
	`föd
(
debug_ª‹dî_d©a_öãr_tokí
[
ch
],ÜastPos)==lastPos)

5251 
œ°Pos
+=
	`°æí
(
debug_ª‹dî_d©a_öãr_tokí
[
ch
]);

5253 
°d
::
size_t
 
pos
=
chûdSåög
.
	`föd
(
debug_ª‹dî_d©a_öãr_tokí
[
ch
+1], 
œ°Pos
);

5254 i‡(
pos
!=
°d
::
°rög
::
≈os
 &&Öos>
ídSång
)

5256 
œ°Pos
=
ídSång
;

5258 
sS∂ôSåög
[
ch
]+=
chûdSåög
.
	`sub°r
(
œ°Pos
, (
pos
==
°d
::
°rög
::
≈os
)? std::string::npos : (pos-lastPos) );

5259 
œ°Pos
=
pos
;

5262 }  
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
) ) ;

5264 
UI¡
 
uiCbfAny
=0;

5265 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5267 
UI¡
 
uiYUVCbf
 = 0;

5268  
UI¡
 
ui
 = 0; ui < 4; ++ui )

5270 
uiYUVCbf
 |
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
 + 
ui
 * 
uiQP¨tNumSubdiv
, 
	`Comp⁄ítID
(
ch
), 
uiTrMode
 + 1 );

5272 
UCh¨
 *
pBa£
=
pcCU
->
	`gëCbf
–
	`Comp⁄ítID
(
ch
) );

5273 c⁄° 
UI¡
 
Êags
=
uiYUVCbf
 << 
uiTrMode
;

5274  
UI¡
 
ui
 = 0; uò< 4 * 
uiQP¨tNumSubdiv
; ++ui )

5276 
pBa£
[
uiAbsP¨tIdx
 + 
ui
] |
Êags
;

5278 
uiCbfAny
|=
uiYUVCbf
;

5281 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_ROOT
 ] );

5282 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

5285 
	`xEncodeI¡îResiduÆQT
–
MAX_NUM_COMPONENT
, 
rTu
 );

5286 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5288 
	`xEncodeI¡îResiduÆQT
–
	`Comp⁄ítID
(
ch
), 
rTu
 );

5291 
uiSubdivBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

5292 
dSubdivCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–
uiSubdivBôs
, 
uiSubdivDi°
 );

5294 i‡(!
bCheckFuŒ
 || (
uiCbfAny
 && (
dSubdivCo°
 < 
dSögÀCo°
)))

5296 
rdCo°
 +
dSubdivCo°
;

5297 
ruiBôs
 +
uiSubdivBôs
;

5298 
ruiDi°
 +
uiSubdivDi°
;

5299 #i‡
DEBUG_STRING


5300 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5302 
	`DEBUG_STRING_APPEND
(
sDebug
, 
debug_ª‹dî_d©a_öãr_tokí
[
ch
])

5303 
	`DEBUG_STRING_APPEND
(
sDebug
, 
sS∂ôSåög
[
ch
])

5309 
rdCo°
 +
dSögÀCo°
;

5310 
ruiBôs
 +
uiSögÀBôs
;

5311 
ruiDi°
 +
uiSögÀDi°
;

5315 
pcCU
->
	`£tTrIdxSubP¨ts
–
uiTrMode
, 
uiAbsP¨tIdx
, 
uiDïth
 );

5317 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5319 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

5321 
	`DEBUG_STRING_APPEND
(
sDebug
, 
debug_ª‹dî_d©a_öãr_tokí
[
ch
])

5322 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

5324 
	`DEBUG_STRING_APPEND
(
sDebug
, 
sSögÀSåögComp
[
compID
])

5326 c⁄° 
Boﬁ
 
•lôI¡oSubTUs
 = 
rTu
.
	`gëRe˘
(
compID
).
width
 !rTu.gëRe˘(compID).
height
;

5327 c⁄° 
UI¡
 
numbîOfSe˘i⁄s
 = 
•lôI¡oSubTUs
 ? 2 : 1;

5328 c⁄° 
UI¡
 
∑πIdxesPîSubTU
 = 
rTu
.
	`GëAbsP¨tIdxNumP¨ts
(
compID
Ë>> (
•lôI¡oSubTUs
 ? 1 : 0);

5330 
UI¡
 
subTUIndex
 = 0; subTUIndex < 
numbîOfSe˘i⁄s
; subTUIndex++)

5332 c⁄° 
UI¡
 
uisubTUP¨tIdx
 = 
uiAbsP¨tIdx
 + (
subTUIndex
 * 
∑πIdxesPîSubTU
);

5334 i‡(
•lôI¡oSubTUs
)

5336 c⁄° 
UCh¨
 
comböedCBF
 = (
be°subTUCBF
[
compID
][
subTUIndex
] << 
subTUDïth
Ë| (
be°CBF
[compID] << 
uiTrMode
);

5337 
pcCU
->
	`£tCbfP¨tR™ge
(
comböedCBF
, 
compID
, 
uisubTUP¨tIdx
, 
∑πIdxesPîSubTU
);

5341 
pcCU
->
	`£tCbfP¨tR™ge
((
be°CBF
[
compID
] << 
uiTrMode
), compID, 
uisubTUP¨tIdx
, 
∑πIdxesPîSubTU
);

5344 
pcCU
->
	`£tCrossComp⁄ítPªdi˘i⁄AÕhaP¨tR™ge
(
be°CrossCPªdi˘i⁄AÕha
[
compID
][
subTUIndex
], compID, 
uisubTUP¨tIdx
, 
∑πIdxesPîSubTU
);

5345 
pcCU
->
	`£tTønsf‹mSkùP¨tR™ge
(
uiBe°Tønsf‹mMode
[
compID
][
subTUIndex
], compID, 
uisubTUP¨tIdx
, 
∑πIdxesPîSubTU
);

5346 
pcCU
->
	`£tEx∂icôRdpcmModeP¨tR™ge
(
be°Ex∂icôRdpcmModeUnS∂ô
[
compID
][
subTUIndex
], compID, 
uisubTUP¨tIdx
, 
∑πIdxesPîSubTU
);

5351 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[ 
uiDïth
 ][ 
CI_QT_TRAFO_TEST
 ] );

5356 
rdCo°
 +
dSögÀCo°
;

5357 
ruiBôs
 +
uiSögÀBôs
;

5358 
ruiDi°
 +
uiSögÀDi°
;

5359 #i‡
DEBUG_STRING


5360 
UI¡
 
ch
 = 0; ch < 
numVÆidComp
; ch++)

5362 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
ch
);

5363 
	`DEBUG_STRING_APPEND
(
sDebug
, 
debug_ª‹dî_d©a_öãr_tokí
[
compID
])

5365 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

5367 
	`DEBUG_STRING_APPEND
(
sDebug
, 
sSögÀSåögComp
[
compID
])

5372 
	`DEBUG_STRING_APPEND
(
sDebug
, 
debug_ª‹dî_d©a_öãr_tokí
[
MAX_NUM_COMPONENT
])

5373 
	}
}

5377 
Void
 
	gTEncSórch
::
	$xEncodeI¡îResiduÆQT
–c⁄° 
Comp⁄ítID
 
compID
, 
TComTU
 &
rTu
 )

5379 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

5380 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

5381 c⁄° 
UI¡
 
uiCuºTrMode
 = 
rTu
.
	`GëTønsf‹mDïthRñ
();

5382 
	`as£π
–
pcCU
->
	`gëDïth
–0 ) =pcCU->gëDïth–
uiAbsP¨tIdx
 ) );

5383 c⁄° 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

5385 c⁄° 
Boﬁ
 
bSubdiv
 = 
uiCuºTrMode
 !
uiTrMode
;

5387 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

5389 i‡(
compID
==
MAX_NUM_COMPONENT
)

5391 if–
uiLog2TrSize
 <
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë&& uiLog2TrSizê>ÖcCU->
	`gëQuadåìTULog2MöSizeInCU
(
uiAbsP¨tIdx
) )

5393 if((
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTUMaxDïthI¡î
(Ë=1Ë&& (pcCU->
	`gëP¨tôi⁄Size
(
uiAbsP¨tIdx
Ë!
SIZE_2Nx2N
))

5395 
	`as£π
(
bSubdiv
);

5399 
m_pcE¡r›yCodî
->
	`ícodeTønsf‹mSubdivFœg
–
bSubdiv
, 5 - 
uiLog2TrSize
 );

5403 
	`as£π
–!
pcCU
->
	`isI¡ø
(
uiAbsP¨tIdx
) );

5405 c⁄° 
Boﬁ
 
bFú°CbfOfCU
 = 
uiCuºTrMode
 == 0;

5407 
UI¡
 
ch
=
COMPONENT_Cb
; ch<
pcCU
->
	`gëPic
()->
	`gëNumbîVÆidComp⁄íts
(); ch++)

5409 c⁄° 
Comp⁄ítID
 
compIdI¬î
=
	`Comp⁄ítID
(
ch
);

5410 if–
bFú°CbfOfCU
 || 
rTu
.
	`Pro˚ssögAŒQuadø¡s
(
compIdI¬î
) )

5412 if–
bFú°CbfOfCU
 || 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
compIdI¬î
, 
uiCuºTrMode
 - 1 ) )

5414 
m_pcE¡r›yCodî
->
	`ícodeQtCbf
–
rTu
, 
compIdI¬î
, !
bSubdiv
 );

5419 
	`as£π
–
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, 
compIdI¬î
, 
uiCuºTrMode
 ) ==ÖcCU->getCbf( uiAbsPartIdx, compIdInner, uiCurrTrMode - 1 ) );

5423 i‡(!
bSubdiv
)

5425 
m_pcE¡r›yCodî
->
	`ícodeQtCbf
–
rTu
, 
COMPONENT_Y
, 
åue
 );

5429 if–!
bSubdiv
 )

5431 i‡(
compID
 !
MAX_NUM_COMPONENT
)

5433 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

5435 i‡(
	`isChroma
(
compID
Ë&& (
pcCU
->
	`gëCbf
(
uiAbsP¨tIdx
, 
COMPONENT_Y
, 
uiTrMode
) != 0))

5437 
m_pcE¡r›yCodî
->
	`ícodeCrossComp⁄ítPªdi˘i⁄
(
rTu
, 
compID
);

5440 i‡(
pcCU
->
	`gëCbf
(
uiAbsP¨tIdx
, 
compID
, 
uiTrMode
) != 0)

5442 c⁄° 
UI¡
 
uiQTTempAc˚ssLayî
 = 
pcCU
->
	`gëSli˚
()->
	`gëSPS
()->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

5443 
TC€ff
 *
pcC€ffCuº
 = 
m_µcQTTempC€ff
[
compID
][
uiQTTempAc˚ssLayî
] + 
rTu
.
	`gëC€fficõ¡Off£t
(compID);

5444 
m_pcE¡r›yCodî
->
	`ícodeC€ffNxN
–
rTu
, 
pcC€ffCuº
, 
compID
 );

5451 if–
compID
==
MAX_NUM_COMPONENT
 || 
pcCU
->
	`gëCbf
–
uiAbsP¨tIdx
, compID, 
uiCuºTrMode
 ) )

5453 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

5456 
	`xEncodeI¡îResiduÆQT
–
compID
, 
tuRecur£Chûd
 );

5457 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
));

5460 
	}
}

5465 
Void
 
	gTEncSórch
::
	$xSëI¡îResiduÆQTD©a
–
TComYuv
* 
pcResi
, 
Boﬁ
 
bS∑tül
, 
TComTU
 &
rTu
 )

5467 
TComD©aCU
* 
pcCU
=
rTu
.
	`gëCU
();

5468 c⁄° 
UI¡
 
uiCuºTrMode
=
rTu
.
	`GëTønsf‹mDïthRñ
();

5469 c⁄° 
UI¡
 
uiAbsP¨tIdx
=
rTu
.
	`GëAbsP¨tIdxTU
();

5470 
	`as£π
–
pcCU
->
	`gëDïth
–0 ) =pcCU->gëDïth–
uiAbsP¨tIdx
 ) );

5471 c⁄° 
UI¡
 
uiTrMode
 = 
pcCU
->
	`gëTønsf‹mIdx
–
uiAbsP¨tIdx
 );

5472 c⁄° 
TComSPS
 *
•s
=
pcCU
->
	`gëSli˚
()->
	`gëSPS
();

5474 if–
uiCuºTrMode
 =
uiTrMode
 )

5476 c⁄° 
UI¡
 
uiLog2TrSize
 = 
rTu
.
	`GëLog2LumaTrSize
();

5477 c⁄° 
UI¡
 
uiQTTempAc˚ssLayî
 = 
•s
->
	`gëQuadåìTULog2MaxSize
(Ë- 
uiLog2TrSize
;

5479 if–
bS∑tül
 )

5483 
UI¡
 
i
=0; i<
pcResi
->
	`gëNumbîVÆidComp⁄íts
(); i++)

5485 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
i
);

5486 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

5488 c⁄° 
TComRe˘™gÀ
 &
	`ª˘CompTU
(
rTu
.
	`gëRe˘
(
compID
));

5489 
m_pcQTTempTComYuv
[
uiQTTempAc˚ssLayî
].
	`c›yP¨tToP¨tComp⁄ítMxN
 ( 
compID
, 
pcResi
, 
ª˘CompTU
 );

5495 
UI¡
 
ch
=0; ch < 
	`gëNumbîVÆidComp⁄íts
(
•s
->
	`gëChromaF‹m©Idc
()); ch++)

5497 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
ch
);

5498 i‡(
rTu
.
	`Pro˚ssComp⁄ítSe˘i⁄
(
compID
))

5500 c⁄° 
TComRe˘™gÀ
 &
	`ª˘CompTU
(
rTu
.
	`gëRe˘
(
compID
));

5501 c⁄° 
UI¡
 
numC€ffInBlock
 = 
ª˘CompTU
.
width
 *Ñe˘CompTU.
height
;

5502 c⁄° 
UI¡
 
off£t
 = 
rTu
.
	`gëC€fficõ¡Off£t
(
compID
);

5503 
TC€ff
* 
de°
 = 
pcCU
->
	`gëC€ff
(
compID
Ë+ 
off£t
;

5504 c⁄° 
TC€ff
* 
§c
 = 
m_µcQTTempC€ff
[
compID
][
uiQTTempAc˚ssLayî
] + 
off£t
;

5505 ::
	`mem˝y
–
de°
, 
§c
, (
TC€ff
)*
numC€ffInBlock
 );

5507 #i‡
ADAPTIVE_QP_SELECTION


5508 
TC€ff
* 
pcAæC€ffSrc
 = 
m_µcQTTempAæC€ff
[
compID
][
uiQTTempAc˚ssLayî
] + 
off£t
;

5509 
TC€ff
* 
pcAæC€ffD°
 = 
pcCU
->
	`gëAæC€ff
(
compID
Ë+ 
off£t
;

5510 ::
	`mem˝y
–
pcAæC€ffD°
, 
pcAæC€ffSrc
, –
TC€ff
 ) * 
numC€ffInBlock
 );

5519 
TComTURecur£
 
	`tuRecur£Chûd
(
rTu
, 
Ál£
);

5522 
	`xSëI¡îResiduÆQTD©a
–
pcResi
, 
bS∑tül
, 
tuRecur£Chûd
 );

5523 } 
tuRecur£Chûd
.
	`√xtSe˘i⁄
(
rTu
));

5525 
	}
}

5530 
UI¡
 
	gTEncSórch
::
	$xModeBôsI¡ø
–
TComD©aCU
* 
pcCU
, 
UI¡
 
uiMode
, UI¡ 
uiP¨tOff£t
, UI¡ 
uiDïth
, c⁄° 
Ch™√lTy≥
 
chTy≥
 )

5533 
m_pcRDGoOnSbacCodî
->
	`lﬂdI¡øDúMode
–
m_µpcRDSbacCodî
[
uiDïth
][
CI_CURR_BEST
], 
chTy≥
 );

5539 
UCh¨
 &
rI¡øDúVÆ
=
pcCU
->
	`gëI¡øDú
–
chTy≥
 )[
uiP¨tOff£t
];

5540 
UCh¨
 
‹igVÆ
=
rI¡øDúVÆ
;

5541 
rI¡øDúVÆ
 = 
uiMode
;

5544 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

5545 i‡(
	`isLuma
(
chTy≥
))

5547 
m_pcE¡r›yCodî
->
	`ícodeI¡øDúModeLuma
 ( 
pcCU
, 
uiP¨tOff£t
);

5551 
m_pcE¡r›yCodî
->
	`ícodeI¡øDúModeChroma
 ( 
pcCU
, 
uiP¨tOff£t
);

5554 
rI¡øDúVÆ
 = 
‹igVÆ
;

5556  
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

5557 
	}
}

5562 
UI¡
 
	gTEncSórch
::
	$xUpd©eC™dLi°
–
UI¡
 
uiMode
, 
DoubÀ
 
uiCo°
, UI¡ 
uiFa°C™dNum
, UI¡ * 
C™dModeLi°
, DoubÀ * 
C™dCo°Li°
 )

5564 
UI¡
 
i
;

5565 
UI¡
 
shi·
=0;

5567  
shi·
<
uiFa°C™dNum
 && 
uiCo°
<
C™dCo°Li°
[ uiFastCandNum-1-shift ] )

5569 
shi·
++;

5572 if–
shi·
!=0 )

5574 
i
=1; i<
shi·
; i++)

5576 
C™dModeLi°
[ 
uiFa°C™dNum
-
i
 ] = CandModeList[ uiFastCandNum-1-i ];

5577 
C™dCo°Li°
[ 
uiFa°C™dNum
-
i
 ] = CandCostList[ uiFastCandNum-1-i ];

5579 
C™dModeLi°
[ 
uiFa°C™dNum
-
shi·
 ] = 
uiMode
;

5580 
C™dCo°Li°
[ 
uiFa°C™dNum
-
shi·
 ] = 
uiCo°
;

5585 
	}
}

5598 
Void
 
	gTEncSórch
::
	$xAddSymbﬁBôsI¡î
–
TComD©aCU
* 
pcCU
, 
UI¡
& 
ruiBôs
 )

5600 if(
pcCU
->
	`gëMîgeFœg
–0 ) &&ÖcCU->
	`gëP¨tôi⁄Size
–0 ) =
SIZE_2Nx2N
 && !pcCU->
	`gëQtRoŸCbf
( 0 ))

5602 
pcCU
->
	`£tSkùFœgSubP¨ts
–
åue
, 0,ÖcCU->
	`gëDïth
(0) );

5604 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

5605 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

5607 
m_pcE¡r›yCodî
->
	`ícodeCUTønsqu™tBy∑ssFœg
(
pcCU
, 0, 
åue
);

5609 
m_pcE¡r›yCodî
->
	`ícodeSkùFœg
(
pcCU
, 0, 
åue
);

5610 
m_pcE¡r›yCodî
->
	`ícodeMîgeIndex
(
pcCU
, 0, 
åue
);

5612 
ruiBôs
 +
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

5616 
m_pcE¡r›yCodî
->
	`ª£tBôs
();

5618 if(
pcCU
->
	`gëSli˚
()->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())

5620 
m_pcE¡r›yCodî
->
	`ícodeCUTønsqu™tBy∑ssFœg
(
pcCU
, 0, 
åue
);

5623 
m_pcE¡r›yCodî
->
	`ícodeSkùFœg
 ( 
pcCU
, 0, 
åue
 );

5624 
m_pcE¡r›yCodî
->
	`ícodePªdMode
–
pcCU
, 0, 
åue
 );

5625 
m_pcE¡r›yCodî
->
	`ícodeP¨tSize
–
pcCU
, 0,ÖcCU->
	`gëDïth
(0), 
åue
 );

5626 
m_pcE¡r›yCodî
->
	`ícodePªdInfo
–
pcCU
, 0 );

5628 
Boﬁ
 
codeDñèQp
 = 
Ál£
;

5629 
Boﬁ
 
codeChromaQpAdj
 = 
Ál£
;

5630 
m_pcE¡r›yCodî
->
	`ícodeC€ff
 ( 
pcCU
, 0,ÖcCU->
	`gëDïth
(0), 
codeDñèQp
, 
codeChromaQpAdj
 );

5632 
ruiBôs
 +
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

5634 
	}
}

5646 
Void
 
	gTEncSórch
::
	$xExtDIFUpSam∂ögH
–
TComP©ã∫
* 
∑âîn
 )

5648 
I¡
 
width
 = 
∑âîn
->
	`gëROIYWidth
();

5649 
I¡
 
height
 = 
∑âîn
->
	`gëROIYHeight
();

5650 
I¡
 
§cSåide
 = 
∑âîn
->
	`gëP©ã∫LSåide
();

5652 
I¡
 
ötSåide
 = 
m_fûãªdBlockTmp
[0].
	`gëSåide
(
COMPONENT_Y
);

5653 
I¡
 
d°Såide
 = 
m_fûãªdBlock
[0][0].
	`gëSåide
(
COMPONENT_Y
);

5654 
Pñ
 *
ötPå
;

5655 
Pñ
 *
d°På
;

5656 
I¡
 
fûãrSize
 = 
NTAPS_LUMA
;

5657 
I¡
 
hÆfFûãrSize
 = (
fûãrSize
>>1);

5658 
Pñ
 *
§cPå
 = 
∑âîn
->
	`gëROIY
(Ë- 
hÆfFûãrSize
*
§cSåide
 - 1;

5660 c⁄° 
ChromaF‹m©
 
chFmt
 = 
m_fûãªdBlock
[0][0].
	`gëChromaF‹m©
();

5662 
m_if
.
	`fûãrH‹
(
COMPONENT_Y
, 
§cPå
, 
§cSåide
, 
m_fûãªdBlockTmp
[0].
	`gëAddr
(COMPONENT_Y), 
ötSåide
, 
width
+1, 
height
+
fûãrSize
, 0, 
Ál£
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5663 
m_if
.
	`fûãrH‹
(
COMPONENT_Y
, 
§cPå
, 
§cSåide
, 
m_fûãªdBlockTmp
[2].
	`gëAddr
(COMPONENT_Y), 
ötSåide
, 
width
+1, 
height
+
fûãrSize
, 2, 
Ál£
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5665 
ötPå
 = 
m_fûãªdBlockTmp
[0].
	`gëAddr
(
COMPONENT_Y
Ë+ 
hÆfFûãrSize
 * 
ötSåide
 + 1;

5666 
d°På
 = 
m_fûãªdBlock
[0][0].
	`gëAddr
(
COMPONENT_Y
);

5667 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
+0, 
height
+0, 0, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5669 
ötPå
 = 
m_fûãªdBlockTmp
[0].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
 + 1;

5670 
d°På
 = 
m_fûãªdBlock
[2][0].
	`gëAddr
(
COMPONENT_Y
);

5671 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
+0, 
height
+1, 2, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5673 
ötPå
 = 
m_fûãªdBlockTmp
[2].
	`gëAddr
(
COMPONENT_Y
Ë+ 
hÆfFûãrSize
 * 
ötSåide
;

5674 
d°På
 = 
m_fûãªdBlock
[0][2].
	`gëAddr
(
COMPONENT_Y
);

5675 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
+1, 
height
+0, 0, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5677 
ötPå
 = 
m_fûãªdBlockTmp
[2].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5678 
d°På
 = 
m_fûãªdBlock
[2][2].
	`gëAddr
(
COMPONENT_Y
);

5679 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
+1, 
height
+1, 2, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5680 
	}
}

5693 
Void
 
	gTEncSórch
::
	$xExtDIFUpSam∂ögQ
–
TComP©ã∫
* 
∑âîn
, 
TComMv
 
hÆfPñRef
 )

5695 
I¡
 
width
 = 
∑âîn
->
	`gëROIYWidth
();

5696 
I¡
 
height
 = 
∑âîn
->
	`gëROIYHeight
();

5697 
I¡
 
§cSåide
 = 
∑âîn
->
	`gëP©ã∫LSåide
();

5699 
Pñ
 *
§cPå
;

5700 
I¡
 
ötSåide
 = 
m_fûãªdBlockTmp
[0].
	`gëSåide
(
COMPONENT_Y
);

5701 
I¡
 
d°Såide
 = 
m_fûãªdBlock
[0][0].
	`gëSåide
(
COMPONENT_Y
);

5702 
Pñ
 *
ötPå
;

5703 
Pñ
 *
d°På
;

5704 
I¡
 
fûãrSize
 = 
NTAPS_LUMA
;

5706 
I¡
 
hÆfFûãrSize
 = (
fûãrSize
>>1);

5708 
I¡
 
extHeight
 = (
hÆfPñRef
.
	`gëVî
(Ë=0Ë? 
height
 + 
fûãrSize
 : height + filterSize-1;

5710 c⁄° 
ChromaF‹m©
 
chFmt
 = 
m_fûãªdBlock
[0][0].
	`gëChromaF‹m©
();

5713 
§cPå
 = 
∑âîn
->
	`gëROIY
(Ë- 
hÆfFûãrSize
 * 
§cSåide
 - 1;

5714 
ötPå
 = 
m_fûãªdBlockTmp
[1].
	`gëAddr
(
COMPONENT_Y
);

5715 i‡(
hÆfPñRef
.
	`gëVî
() > 0)

5717 
§cPå
 +
§cSåide
;

5719 i‡(
hÆfPñRef
.
	`gëH‹
() >= 0)

5721 
§cPå
 += 1;

5723 
m_if
.
	`fûãrH‹
(
COMPONENT_Y
, 
§cPå
, 
§cSåide
, 
ötPå
, 
ötSåide
, 
width
, 
extHeight
, 1, 
Ál£
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5726 
§cPå
 = 
∑âîn
->
	`gëROIY
(Ë- 
hÆfFûãrSize
*
§cSåide
 - 1;

5727 
ötPå
 = 
m_fûãªdBlockTmp
[3].
	`gëAddr
(
COMPONENT_Y
);

5728 i‡(
hÆfPñRef
.
	`gëVî
() > 0)

5730 
§cPå
 +
§cSåide
;

5732 i‡(
hÆfPñRef
.
	`gëH‹
() > 0)

5734 
§cPå
 += 1;

5736 
m_if
.
	`fûãrH‹
(
COMPONENT_Y
, 
§cPå
, 
§cSåide
, 
ötPå
, 
ötSåide
, 
width
, 
extHeight
, 3, 
Ál£
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5739 
ötPå
 = 
m_fûãªdBlockTmp
[1].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5740 
d°På
 = 
m_fûãªdBlock
[1][1].
	`gëAddr
(
COMPONENT_Y
);

5741 i‡(
hÆfPñRef
.
	`gëVî
() == 0)

5743 
ötPå
 +
ötSåide
;

5745 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 1, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5748 
ötPå
 = 
m_fûãªdBlockTmp
[1].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5749 
d°På
 = 
m_fûãªdBlock
[3][1].
	`gëAddr
(
COMPONENT_Y
);

5750 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 3, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5752 i‡(
hÆfPñRef
.
	`gëVî
() != 0)

5755 
ötPå
 = 
m_fûãªdBlockTmp
[1].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5756 
d°På
 = 
m_fûãªdBlock
[2][1].
	`gëAddr
(
COMPONENT_Y
);

5757 i‡(
hÆfPñRef
.
	`gëVî
() == 0)

5759 
ötPå
 +
ötSåide
;

5761 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 2, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5764 
ötPå
 = 
m_fûãªdBlockTmp
[3].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5765 
d°På
 = 
m_fûãªdBlock
[2][3].
	`gëAddr
(
COMPONENT_Y
);

5766 i‡(
hÆfPñRef
.
	`gëVî
() == 0)

5768 
ötPå
 +
ötSåide
;

5770 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 2, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5775 
ötPå
 = 
m_fûãªdBlockTmp
[1].
	`gëAddr
(
COMPONENT_Y
Ë+ 
hÆfFûãrSize
 * 
ötSåide
;

5776 
d°På
 = 
m_fûãªdBlock
[0][1].
	`gëAddr
(
COMPONENT_Y
);

5777 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 0, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5780 
ötPå
 = 
m_fûãªdBlockTmp
[3].
	`gëAddr
(
COMPONENT_Y
Ë+ 
hÆfFûãrSize
 * 
ötSåide
;

5781 
d°På
 = 
m_fûãªdBlock
[0][3].
	`gëAddr
(
COMPONENT_Y
);

5782 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 0, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5785 i‡(
hÆfPñRef
.
	`gëH‹
() != 0)

5788 
ötPå
 = 
m_fûãªdBlockTmp
[2].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5789 
d°På
 = 
m_fûãªdBlock
[1][2].
	`gëAddr
(
COMPONENT_Y
);

5790 i‡(
hÆfPñRef
.
	`gëH‹
() > 0)

5792 
ötPå
 += 1;

5794 i‡(
hÆfPñRef
.
	`gëVî
() >= 0)

5796 
ötPå
 +
ötSåide
;

5798 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 1, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5801 
ötPå
 = 
m_fûãªdBlockTmp
[2].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5802 
d°På
 = 
m_fûãªdBlock
[3][2].
	`gëAddr
(
COMPONENT_Y
);

5803 i‡(
hÆfPñRef
.
	`gëH‹
() > 0)

5805 
ötPå
 += 1;

5807 i‡(
hÆfPñRef
.
	`gëVî
() > 0)

5809 
ötPå
 +
ötSåide
;

5811 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 3, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5816 
ötPå
 = 
m_fûãªdBlockTmp
[0].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
 + 1;

5817 
d°På
 = 
m_fûãªdBlock
[1][0].
	`gëAddr
(
COMPONENT_Y
);

5818 i‡(
hÆfPñRef
.
	`gëVî
() >= 0)

5820 
ötPå
 +
ötSåide
;

5822 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 1, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5825 
ötPå
 = 
m_fûãªdBlockTmp
[0].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
 + 1;

5826 
d°På
 = 
m_fûãªdBlock
[3][0].
	`gëAddr
(
COMPONENT_Y
);

5827 i‡(
hÆfPñRef
.
	`gëVî
() > 0)

5829 
ötPå
 +
ötSåide
;

5831 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 3, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5835 
ötPå
 = 
m_fûãªdBlockTmp
[3].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5836 
d°På
 = 
m_fûãªdBlock
[1][3].
	`gëAddr
(
COMPONENT_Y
);

5837 i‡(
hÆfPñRef
.
	`gëVî
() == 0)

5839 
ötPå
 +
ötSåide
;

5841 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 1, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5844 
ötPå
 = 
m_fûãªdBlockTmp
[3].
	`gëAddr
(
COMPONENT_Y
Ë+ (
hÆfFûãrSize
-1Ë* 
ötSåide
;

5845 
d°På
 = 
m_fûãªdBlock
[3][3].
	`gëAddr
(
COMPONENT_Y
);

5846 
m_if
.
	`fûãrVî
(
COMPONENT_Y
, 
ötPå
, 
ötSåide
, 
d°På
, 
d°Såide
, 
width
, 
height
, 3, 
Ál£
, 
åue
, 
chFmt
, 
∑âîn
->
	`gëBôDïthY
());

5847 
	}
}

5854 
Void
 
	gTEncSórch
::
	$£tWpSˇlögDi°P¨am
–
TComD©aCU
* 
pcCU
, 
I¡
 
iRefIdx
, 
RefPicLi°
 
eRefPicLi°Cur
 )

5856 i‡–
iRefIdx
<0 )

5858 
m_cDi°P¨am
.
bAµlyWeight
 = 
Ál£
;

5862 
TComSli˚
 *
pcSli˚
 = 
pcCU
->
	`gëSli˚
();

5863 
WPSˇlögP¨am
 *
wp0
 , *
wp1
;

5865 
m_cDi°P¨am
.
bAµlyWeight
 = ( 
pcSli˚
->
	`gëSli˚Ty≥
()==
P_SLICE
 &&ÖcSli˚->
	`ã°WeightPªd
(ËË|| (ÖcSli˚->gëSli˚Ty≥()==
B_SLICE
 &&ÖcSli˚->
	`ã°WeightBiPªd
() ) ;

5867 i‡–!
m_cDi°P¨am
.
bAµlyWeight
 )

5872 
I¡
 
iRefIdx0
 = ( 
eRefPicLi°Cur
 =
REF_PIC_LIST_0
 ) ? 
iRefIdx
 : (-1);

5873 
I¡
 
iRefIdx1
 = ( 
eRefPicLi°Cur
 =
REF_PIC_LIST_1
 ) ? 
iRefIdx
 : (-1);

5875 
	`gëWpSˇlög
–
pcCU
, 
iRefIdx0
, 
iRefIdx1
, 
wp0
 , 
wp1
 );

5877 i‡–
iRefIdx0
 < 0 )

5879 
wp0
 = 
NULL
;

5881 i‡–
iRefIdx1
 < 0 )

5883 
wp1
 = 
NULL
;

5886 
m_cDi°P¨am
.
wpCur
 = 
NULL
;

5888 i‡–
eRefPicLi°Cur
 =
REF_PIC_LIST_0
 )

5890 
m_cDi°P¨am
.
wpCur
 = 
wp0
;

5894 
m_cDi°P¨am
.
wpCur
 = 
wp1
;

5896 
	}
}

	@TLibEncoder/TEncSearch.h

38 #i‚de‡
__TENCSEARCH__


39 
	#__TENCSEARCH__


	)

42 
	~"TLibComm⁄/TComYuv.h
"

43 
	~"TLibComm⁄/TComMŸi⁄Info.h
"

44 
	~"TLibComm⁄/TComP©ã∫.h
"

45 
	~"TLibComm⁄/TComPªdi˘i⁄.h
"

46 
	~"TLibComm⁄/TComTrQu™t.h
"

47 
	~"TLibComm⁄/TComPic.h
"

48 
	~"TLibComm⁄/TComRe˘™gÀ.h
"

49 
	~"TEncE¡r›y.h
"

50 
	~"TEncSbac.h
"

51 
	~"TEncCfg.h
"

57 
˛ass
 
	gTEncCu
;

63 c⁄° 
UI¡
 
	gMAX_NUM_REF_LIST_ADAPT_SR
=2;

64 c⁄° 
UI¡
 
	gMAX_IDX_ADAPT_SR
=33;

65 c⁄° 
UI¡
 
	gNUM_MV_PREDICTORS
=3;

68 ˛as†
	cTEncSórch
 : 
public
 
TComPªdi˘i⁄


70 
¥iv©e
:

71 
TC€ff
** 
m_µcQTTempC€ff
[
MAX_NUM_COMPONENT
 ];

72 #i‡
ADAPTIVE_QP_SELECTION


73 
TC€ff
** 
	mm_µcQTTempAæC€ff
[
MAX_NUM_COMPONENT
];

75 
UCh¨
* 
	mm_puhQTTempTrIdx
;

76 
UCh¨
* 
	mm_puhQTTempCbf
[
MAX_NUM_COMPONENT
];

78 
TComYuv
* 
	mm_pcQTTempTComYuv
;

79 
TComYuv
 
	mm_tmpYuvPªd
;

81 
SCh¨
* 
	mm_phQTTempCrossComp⁄ítPªdi˘i⁄AÕha
[
MAX_NUM_COMPONENT
];

82 
Pñ
* 
	mm_pSh¨edPªdTønsf‹mSkù
[
MAX_NUM_COMPONENT
];

83 
TC€ff
* 
	mm_pcQTTempTUC€ff
[
MAX_NUM_COMPONENT
];

84 
UCh¨
* 
	mm_puhQTTempTønsf‹mSkùFœg
[
MAX_NUM_COMPONENT
];

85 
TComYuv
 
	mm_pcQTTempTønsf‹mSkùTComYuv
;

86 #i‡
ADAPTIVE_QP_SELECTION


87 
TC€ff
* 
	mm_µcQTTempTUAæC€ff
[
MAX_NUM_COMPONENT
];

90 
	m¥Ÿe˘ed
:

92 
TEncCfg
* 
m_pcEncCfg
;

95 
TComTrQu™t
* 
	mm_pcTrQu™t
;

96 
TComRdCo°
* 
	mm_pcRdCo°
;

97 
TEncE¡r›y
* 
	mm_pcE¡r›yCodî
;

100 
I¡
 
	mm_iSórchR™ge
;

101 
I¡
 
	mm_bùªdSórchR™ge
;

102 
MESórchMëhod
 
	mm_mŸi⁄E°im©i⁄SórchMëhod
;

103 
I¡
 
	mm_ØiAd≠tSR
[
MAX_NUM_REF_LIST_ADAPT_SR
][
MAX_IDX_ADAPT_SR
];

104 
TComMv
 
	mm_acMvPªdi˘‹s
[
NUM_MV_PREDICTORS
];

107 
TEncSbac
*** 
	mm_µpcRDSbacCodî
;

108 
TEncSbac
* 
	mm_pcRDGoOnSbacCodî
;

109 
Di°P¨am
 
	mm_cDi°P¨am
;

112 
Pñ
* 
	mm_pTempPñ
;

116 
UI¡
 
	mm_auiMVPIdxCo°
[
AMVP_MAX_NUM_CANDS
+1][AMVP_MAX_NUM_CANDS+1];

118 
TComMv
 
	mm_öãgîMv2Nx2N
[
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
];

120 
Boﬁ
 
	mm_isInôülized
;

121 
	mpublic
:

122 
TEncSórch
();

123 
	mvútuÆ
 ~
TEncSórch
();

125 
Void
 
öô
(
TEncCfg
* 
pcEncCfg
,

126 
TComTrQu™t
* 
pcTrQu™t
,

127 
I¡
 
iSórchR™ge
,

128 
I¡
 
bùªdSórchR™ge
,

129 
MESórchMëhod
 
mŸi⁄E°im©i⁄SórchMëhod
,

130 c⁄° 
UI¡
 
maxCUWidth
,

131 c⁄° 
UI¡
 
maxCUHeight
,

132 c⁄° 
UI¡
 
maxTŸÆCUDïth
,

133 
TEncE¡r›y
* 
pcE¡r›yCodî
,

134 
TComRdCo°
* 
pcRdCo°
,

135 
TEncSbac
*** 
µpcRDSbacCodî
,

136 
TEncSbac
* 
pcRDGoOnSbacCodî
 );

138 
Void
 
de°roy
();

140 
	m¥Ÿe˘ed
:

143 
Di°‹ti⁄
 
xP©ã∫Reföemít
–
TComP©ã∫
* 
pcP©ã∫Key
,

144 
TComMv
 
ba£RefMv
,

145 
I¡
 
iFøc
, 
TComMv
& 
rcMvFøc
, 
Boﬁ
 
bAŒowU£OfHadam¨d


150 c⁄° 
Pñ
* 
	mpiRefY
;

151 
I¡
 
	miYSåide
;

152 
I¡
 
	miBe°X
;

153 
I¡
 
	miBe°Y
;

154 
UI¡
 
	muiBe°Round
;

155 
UI¡
 
	muiBe°Di°™˚
;

156 
Di°‹ti⁄
 
	muiBe°Sad
;

157 
UCh¨
 
	mucPoötNr
;

158 } 
	tI¡TZSórchSåu˘
;

161 
__ölöe
 
Void
 
xTZSórchHñp
 ( c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, 
I¡TZSórchSåu˘
& 
rcSåu˘
, c⁄° 
I¡
 
iSórchX
, c⁄° I¡ 
iSórchY
, c⁄° 
UCh¨
 
ucPoötNr
, c⁄° 
UI¡
 
uiDi°™˚
 );

162 
__ölöe
 
Void
 
xTZ2PoötSórch
 ( c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, 
I¡TZSórchSåu˘
& 
rcSåu˘
, c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
, c⁄° TComMv* c⁄° 
pcMvSrchRngRB
 );

163 
__ölöe
 
Void
 
xTZ8PoötSqu¨eSórch
 ( c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, 
I¡TZSórchSåu˘
& 
rcSåu˘
, c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
, c⁄° TComMv* c⁄° 
pcMvSrchRngRB
, c⁄° 
I¡
 
iSèπX
, c⁄° I¡ 
iSèπY
, c⁄° I¡ 
iDi°
 );

164 
__ölöe
 
Void
 
xTZ8PoötDüm⁄dSórch
–c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
, 
I¡TZSórchSåu˘
& 
rcSåu˘
, c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
, c⁄° TComMv* c⁄° 
pcMvSrchRngRB
, c⁄° 
I¡
 
iSèπX
, c⁄° I¡ 
iSèπY
, c⁄° I¡ 
iDi°
, c⁄° 
Boﬁ
 
bCheckC‹√rsAtDi°1
 );

166 
Void
 
xGëI¡îPªdi˘i⁄Eº‹
–
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcYuvOrg
, 
I¡
 
iP¨tIdx
, 
Di°‹ti⁄
& 
ruiSAD
, 
Boﬁ
 
Hadam¨d
 );

168 
	gpublic
:

169 
Void
 
e°I¡øPªdLumaQT
 ( 
TComD©aCU
* 
pcCU
,

170 
TComYuv
* 
pcOrgYuv
,

171 
TComYuv
* 
pcPªdYuv
,

172 
TComYuv
* 
pcResiYuv
,

173 
TComYuv
* 
pcRecoYuv
,

174 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE]

175 
DEBUG_STRING_FN_DECLARE
(
sDebug
));

177 
Void
 
e°I¡øPªdChromaQT
 ( 
TComD©aCU
* 
pcCU
,

178 
TComYuv
* 
pcOrgYuv
,

179 
TComYuv
* 
pcPªdYuv
,

180 
TComYuv
* 
pcResiYuv
,

181 
TComYuv
* 
pcRecoYuv
,

182 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE]

183 
DEBUG_STRING_FN_DECLARE
(
sDebug
));

186 
Void
 
¥edI¡îSórch
 ( 
TComD©aCU
* 
pcCU
,

187 
TComYuv
* 
pcOrgYuv
,

188 
TComYuv
* 
pcPªdYuv
,

189 
TComYuv
* 
pcResiYuv
,

190 
TComYuv
* 
pcRecoYuv


191 
DEBUG_STRING_FN_DECLARE
(
sDebug
),

192 
Boﬁ
 
bU£Res
 = 
Ál£


193 #i‡
AMP_MRG


194 ,
Boﬁ
 
bU£MRG
 = 
Ál£


199 
Void
 
ícodeResAndCÆcRdI¡îCU
–
TComD©aCU
* 
pcCU
,

200 
TComYuv
* 
pcYuvOrg
,

201 
TComYuv
* 
pcYuvPªd
,

202 
TComYuv
* 
pcYuvResi
,

203 
TComYuv
* 
pcYuvResiBe°
,

204 
TComYuv
* 
pcYuvRec
,

205 
Boﬁ
 
bSkùResiduÆ


206 
DEBUG_STRING_FN_DECLARE
(
sDebug
) );

209 
Void
 
	$£tAd≠tiveSórchR™ge
 ( 
I¡
 
iDú
, I¡ 
iRefIdx
, I¡ 
iSórchR™ge
Ë{ 
	`as£π
(iDú < 
MAX_NUM_REF_LIST_ADAPT_SR
 && iRefIdx<
	`I¡
(
MAX_IDX_ADAPT_SR
)); 
m_ØiAd≠tSR
[iDú][iRefIdx] = iSórchR™ge; 
	}
}

211 
Void
 
xEncPCM
 (
TComD©aCU
* 
pcCU
, 
UI¡
 
uiAbsP¨tIdx
, 
Pñ
* 
piOrg
, Pñ* 
piPCM
, Pñ* 
piPªd
, Pñ* 
piResi
, Pñ* 
piReco
, UI¡ 
uiSåide
, UI¡ 
uiWidth
, UI¡ 
uiHeight
, c⁄° 
Comp⁄ítID
 
compID
 );

212 
Void
 
IPCMSórch
 (
TComD©aCU
* 
pcCU
, 
TComYuv
* 
pcOrgYuv
, TComYuv* 
ΩcPªdYuv
, TComYuv* 
ΩcResiYuv
, TComYuv* 
ΩcRecoYuv
 );

213 
	g¥Ÿe˘ed
:

219 
Void
 
xEncSubdivCbfQT
 ( 
TComTU
 &
rTu
,

220 
Boﬁ
 
bLuma
,

221 
Boﬁ
 
bChroma
 );

223 
Void
 
xEncC€ffQT
 ( 
TComTU
 &
rTu
,

224 
Comp⁄ítID
 
comp⁄ít
,

225 
Boﬁ
 
bRólC€ff
 );

226 
Void
 
xEncI¡øHódî
 ( 
TComD©aCU
* 
pcCU
,

227 
UI¡
 
uiTrDïth
,

228 
UI¡
 
uiAbsP¨tIdx
,

229 
Boﬁ
 
bLuma
,

230 
Boﬁ
 
bChroma
 );

231 
UI¡
 
xGëI¡øBôsQT
 ( 
TComTU
 &
rTu
,

232 
Boﬁ
 
bLuma
,

233 
Boﬁ
 
bChroma
,

234 
Boﬁ
 
bRólC€ff
 );

236 
UI¡
 
xGëI¡øBôsQTChroma
 ( 
TComTU
 &
rTu
,

237 
Comp⁄ítID
 
compID
,

238 
Boﬁ
 
bRólC€ff
 );

240 
Void
 
xI¡øCodögTUBlock
 ( 
TComYuv
* 
pcOrgYuv
,

241 
TComYuv
* 
pcPªdYuv
,

242 
TComYuv
* 
pcResiYuv
,

243 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE],

244 c⁄° 
Boﬁ
 
checkCrossCPªdi˘i⁄
,

245 
Di°‹ti⁄
& 
ruiDi°
,

246 c⁄° 
Comp⁄ítID
 
compID
,

247 
TComTU
 &
rTu


248 
DEBUG_STRING_FN_DECLARE
(
sTe°
)

249 ,
I¡
 
deÁu…0Save1Lﬂd2
 = 0

252 
Void
 
xRecurI¡øCodögLumaQT
 ( 
TComYuv
* 
pcOrgYuv
,

253 
TComYuv
* 
pcPªdYuv
,

254 
TComYuv
* 
pcResiYuv
,

255 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE],

256 
Di°‹ti⁄
& 
ruiDi°Y
,

257 #i‡
HHI_RQT_INTRA_SPEEDUP


258 
Boﬁ
 
bCheckFú°
,

260 
DoubÀ
& 
dRDCo°
,

261 
TComTU
 &
rTu


262 
DEBUG_STRING_FN_DECLARE
(
sDebug
));

264 
Void
 
xSëI¡øResu…LumaQT
 ( 
TComYuv
* 
pcRecoYuv
,

265 
TComTU
 &
rTu
);

267 
Void
 
xSt‹eCrossComp⁄ítPªdi˘i⁄Resu…
 ( 
Pñ
 *
pResiLuma
,

268 c⁄° 
Pñ
 *
pBe°Luma
,

269 
TComTU
 &
rTu
,

270 c⁄° 
I¡
 
xOff£t
,

271 c⁄° 
I¡
 
yOff£t
,

272 c⁄° 
I¡
 
°rideResi
,

273 c⁄° 
I¡
 
°rideBe°
 );

275 
SCh¨
 
xCÆcCrossComp⁄ítPªdi˘i⁄AÕha
 ( 
TComTU
 &
rTu
,

276 c⁄° 
Comp⁄ítID
 
compID
,

277 c⁄° 
Pñ
* 
piResiL
,

278 c⁄° 
Pñ
* 
piResiC
,

279 c⁄° 
I¡
 
width
,

280 c⁄° 
I¡
 
height
,

281 c⁄° 
I¡
 
°rideL
,

282 c⁄° 
I¡
 
°rideC
 );

284 
Void
 
xRecurI¡øChromaCodögQT
 ( 
TComYuv
* 
pcOrgYuv
,

285 
TComYuv
* 
pcPªdYuv
,

286 
TComYuv
* 
pcResiYuv
,

287 
Pñ
 
ªsiLuma
[
NUMBER_OF_STORED_RESIDUAL_TYPES
][
MAX_CU_SIZE
 * MAX_CU_SIZE],

288 
Di°‹ti⁄
& 
ruiDi°
,

289 
TComTU
 &
rTu


290 
DEBUG_STRING_FN_DECLARE
(
sDebug
));

292 
Void
 
xSëI¡øResu…ChromaQT
 ( 
TComYuv
* 
pcRecoYuv
, 
TComTU
 &
rTu
);

294 
Void
 
xSt‹eI¡øResu…QT
 ( c⁄° 
Comp⁄ítID
 
compID
, 
TComTU
 &
rTu
);

295 
Void
 
xLﬂdI¡øResu…QT
 ( c⁄° 
Comp⁄ítID
 
compID
, 
TComTU
 &
rTu
);

302 
Void
 
xE°im©eMvPªdAMVP
 ( 
TComD©aCU
* 
pcCU
,

303 
TComYuv
* 
pcOrgYuv
,

304 
UI¡
 
uiP¨tIdx
,

305 
RefPicLi°
 
eRefPicLi°
,

306 
I¡
 
iRefIdx
,

307 
TComMv
& 
rcMvPªd
,

308 
Boﬁ
 
bFûÀd
 = 
Ál£


309 , 
Di°‹ti⁄
* 
puiDi°BiP
 = 
NULL


312 
Void
 
xCheckBe°MVP
 ( 
TComD©aCU
* 
pcCU
,

313 
RefPicLi°
 
eRefPicLi°
,

314 
TComMv
 
cMv
,

315 
TComMv
& 
rcMvPªd
,

316 
I¡
& 
riMVPIdx
,

317 
UI¡
& 
ruiBôs
,

318 
Di°‹ti⁄
& 
ruiCo°
 );

320 
Di°‹ti⁄
 
xGëTem∂©eCo°
 ( 
TComD©aCU
* 
pcCU
,

321 
UI¡
 
uiP¨tAddr
,

322 
TComYuv
* 
pcOrgYuv
,

323 
TComYuv
* 
pcTem∂©eC™d
,

324 
TComMv
 
cMvC™d
,

325 
I¡
 
iMVPIdx
,

326 
I¡
 
iMVPNum
,

327 
RefPicLi°
 
eRefPicLi°
,

328 
I¡
 
iRefIdx
,

329 
I¡
 
iSizeX
,

330 
I¡
 
iSizeY


334 
Void
 
xC›yAMVPInfo
 ( 
AMVPInfo
* 
pSrc
, AMVPInfo* 
pD°
 );

335 
UI¡
 
xGëMvpIdxBôs
 ( 
I¡
 
iIdx
, I¡ 
iNum
 );

336 
Void
 
xGëBlkBôs
 ( 
P¨tSize
 
eCUMode
, 
Boﬁ
 
bPSli˚
, 
I¡
 
iP¨tIdx
, 
UI¡
 
uiLa°Mode
, UI¡ 
uiBlkBô
[3]);

338 
Void
 
xMîgeE°im©i⁄
 ( 
TComD©aCU
* 
pcCU
,

339 
TComYuv
* 
pcYuvOrg
,

340 
I¡
 
iP¨tIdx
,

341 
UI¡
& 
uiI¡îDú
,

342 
TComMvFõld
* 
∑cMvFõld
,

343 
UI¡
& 
uiMîgeIndex
,

344 
Di°‹ti⁄
& 
ruiCo°
,

345 
TComMvFõld
* 
cMvFõldNeighbours
,

346 
UCh¨
* 
uhI¡îDúNeighbours
,

347 
I¡
& 
numVÆidMîgeC™d


350 
Void
 
xRe°ri˘BùªdMîgeC™d
 ( 
TComD©aCU
* 
pcCU
,

351 
UI¡
 
puIdx
,

352 
TComMvFõld
* 
mvFõldNeighbours
,

353 
UCh¨
* 
öãrDúNeighbours
,

354 
I¡
 
numVÆidMîgeC™d
 );

361 
Void
 
xMŸi⁄E°im©i⁄
 ( 
TComD©aCU
* 
pcCU
,

362 
TComYuv
* 
pcYuvOrg
,

363 
I¡
 
iP¨tIdx
,

364 
RefPicLi°
 
eRefPicLi°
,

365 
TComMv
* 
pcMvPªd
,

366 
I¡
 
iRefIdxPªd
,

367 
TComMv
& 
rcMv
,

368 
UI¡
& 
ruiBôs
,

369 
Di°‹ti⁄
& 
ruiCo°
,

370 
Boﬁ
 
bBi
 = 
Ál£
 );

372 
Void
 
xTZSórch
 ( c⁄° 
TComD©aCU
* c⁄° 
pcCU
,

373 c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

374 c⁄° 
Pñ
* c⁄° 
piRefY
,

375 c⁄° 
I¡
 
iRefSåide
,

376 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

377 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

378 
TComMv
& 
rcMv
,

379 
Di°‹ti⁄
& 
ruiSAD
,

380 c⁄° 
TComMv
* c⁄° 
pI¡egîMv2Nx2NPªd
,

381 c⁄° 
Boﬁ
 
bExãndedSëtögs


384 
Void
 
xTZSórchSñe˘ive
 ( c⁄° 
TComD©aCU
* c⁄° 
pcCU
,

385 c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

386 c⁄° 
Pñ
* c⁄° 
piRefY
,

387 c⁄° 
I¡
 
iRefSåide
,

388 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

389 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

390 
TComMv
& 
rcMv
,

391 
Di°‹ti⁄
& 
ruiSAD
,

392 c⁄° 
TComMv
* c⁄° 
pI¡egîMv2Nx2NPªd


395 
Void
 
xSëSórchR™ge
 ( c⁄° 
TComD©aCU
* c⁄° 
pcCU
,

396 c⁄° 
TComMv
& 
cMvPªd
,

397 c⁄° 
I¡
 
iSrchRng
,

398 
TComMv
& 
rcMvSrchRngLT
,

399 #i‡!
MCTS_ENC_CHECK


400 
TComMv
& 
rcMvSrchRngRB
 );

402 
	gTComMv
& 
	grcMvSrchRngRB
,

403 c⁄° 
TComP©ã∫
* c⁄° 
	gpcP©ã∫Key
 );

406 #i‡
MCTS_ENC_CHECK


407 
Void
 
xInôTûeB‹dîs
(c⁄° 
TComD©aCU
* c⁄° 
pcCU
, 
TComP©ã∫
* 
pcP©ã∫Key
);

410 
Void
 
xP©ã∫SórchFa°
 ( c⁄° 
TComD©aCU
* c⁄° 
pcCU
,

411 c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

412 c⁄° 
Pñ
* c⁄° 
piRefY
,

413 c⁄° 
I¡
 
iRefSåide
,

414 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

415 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

416 
TComMv
& 
rcMv
,

417 
Di°‹ti⁄
& 
ruiSAD
,

418 c⁄° 
TComMv
* c⁄° 
pI¡egîMv2Nx2NPªd


421 
Void
 
xP©ã∫Sórch
 ( c⁄° 
TComP©ã∫
* c⁄° 
pcP©ã∫Key
,

422 c⁄° 
Pñ
* 
piRefY
,

423 c⁄° 
I¡
 
iRefSåide
,

424 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngLT
,

425 c⁄° 
TComMv
* c⁄° 
pcMvSrchRngRB
,

426 
TComMv
& 
rcMv
,

427 
Di°‹ti⁄
& 
ruiSAD
 );

429 
Void
 
xP©ã∫SórchFøcDIF
 (

430 
Boﬁ
 
bIsLos¶essCoded
,

431 
TComP©ã∫
* 
pcP©ã∫Key
,

432 
Pñ
* 
piRefY
,

433 
I¡
 
iRefSåide
,

434 
TComMv
* 
pcMvI¡
,

435 
TComMv
& 
rcMvHÆf
,

436 
TComMv
& 
rcMvQãr
,

437 
Di°‹ti⁄
& 
ruiCo°


440 
Void
 
xExtDIFUpSam∂ögH
–
TComP©ã∫
* 
pcP©ã∫
 );

441 
Void
 
xExtDIFUpSam∂ögQ
–
TComP©ã∫
* 
pcP©ã∫Key
, 
TComMv
 
hÆfPñRef
 );

448 
Void
 
xEncodeI¡îResiduÆQT
–c⁄° 
Comp⁄ítID
 
compID
, 
TComTU
 &
rTu
 );

449 
Void
 
xE°im©eI¡îResiduÆQT
–
TComYuv
* 
pcResi
, 
DoubÀ
 &
rdCo°
, 
UI¡
 &
ruiBôs
, 
Di°‹ti⁄
 &
ruiDi°
, Di°‹ti⁄ *
puiZîoDi°
, 
TComTU
 &
rTu
 
DEBUG_STRING_FN_DECLARE
(
sDebug
) );

450 
Void
 
xSëI¡îResiduÆQTD©a
–
TComYuv
* 
pcResi
, 
Boﬁ
 
bS∑tül
, 
TComTU
 &
rTu
 );

452 
UI¡
 
xModeBôsI¡ø
 ( 
TComD©aCU
* 
pcCU
, UI¡ 
uiMode
, UI¡ 
uiP¨tOff£t
, UI¡ 
uiDïth
, c⁄° 
Ch™√lTy≥
 
compID
 );

453 
UI¡
 
xUpd©eC™dLi°
–UI¡ 
uiMode
, 
DoubÀ
 
uiCo°
, UI¡ 
uiFa°C™dNum
, UI¡ * 
C™dModeLi°
, DoubÀ * 
C™dCo°Li°
 );

459 
Void
 
xAddSymbﬁBôsI¡î
 ( 
TComD©aCU
* 
pcCU
,

460 
UI¡
& 
ruiBôs
);

462 
Void
 
£tWpSˇlögDi°P¨am
–
TComD©aCU
* 
pcCU
, 
I¡
 
iRefIdx
, 
RefPicLi°
 
eRefPicLi°Cur
 );

463 
ölöe
 
Void
 
	$£tDi°P¨amComp
–
Comp⁄ítID
 
compIdx
 ) { 
m_cDi°P¨am
.compIdx = compIdx; 
	}
}

	@TLibEncoder/TEncSlice.cpp

38 
	~"TEncT›.h
"

39 
	~"TEncSli˚.h
"

40 
	~<m©h.h
>

49 
	gTEncSli˚
::
	$TEncSli˚
()

50 : 
	$m_ícCABACTabÀIdx
(
I_SLICE
)

52 
	}
}

54 
TEncSli˚
::~
	$TEncSli˚
()

56 
	`de°roy
();

57 
	}
}

59 
Void
 
	gTEncSli˚
::
	$¸óã
–
I¡
 
iWidth
, I¡ 
iHeight
, 
ChromaF‹m©
 
chromaF‹m©
, 
UI¡
 
iMaxCUWidth
, UI¡ 
iMaxCUHeight
, 
UCh¨
 
uhTŸÆDïth
 )

62 
m_picYuvPªd
.
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©
, 
iMaxCUWidth
, 
iMaxCUHeight
, 
uhTŸÆDïth
, 
åue
 );

65 
m_picYuvResi
.
	`¸óã
–
iWidth
, 
iHeight
, 
chromaF‹m©
, 
iMaxCUWidth
, 
iMaxCUHeight
, 
uhTŸÆDïth
, 
åue
 );

66 
	}
}

68 
Void
 
	gTEncSli˚
::
	$de°roy
()

70 
m_picYuvPªd
.
	`de°roy
();

71 
m_picYuvResi
.
	`de°roy
();

74 
m_vdRdPicLambda
.
	`˛ór
();

75 
m_vdRdPicQp
.
	`˛ór
();

76 
m_viRdPicQp
.
	`˛ór
();

77 
	}
}

79 
Void
 
	gTEncSli˚
::
	$öô
–
TEncT›
* 
pcEncT›
 )

81 
m_pcCfg
 = 
pcEncT›
;

82 
m_pcLi°Pic
 = 
pcEncT›
->
	`gëLi°Pic
();

84 
m_pcGOPEncodî
 = 
pcEncT›
->
	`gëGOPEncodî
();

85 
m_pcCuEncodî
 = 
pcEncT›
->
	`gëCuEncodî
();

86 
m_pcPªdSórch
 = 
pcEncT›
->
	`gëPªdSórch
();

88 
m_pcE¡r›yCodî
 = 
pcEncT›
->
	`gëE¡r›yCodî
();

89 
m_pcSbacCodî
 = 
pcEncT›
->
	`gëSbacCodî
();

90 
m_pcBöCABAC
 = 
pcEncT›
->
	`gëBöCABAC
();

91 
m_pcTrQu™t
 = 
pcEncT›
->
	`gëTrQu™t
();

93 
m_pcRdCo°
 = 
pcEncT›
->
	`gëRdCo°
();

94 
m_µpcRDSbacCodî
 = 
pcEncT›
->
	`gëRDSbacCodî
();

95 
m_pcRDGoOnSbacCodî
 = 
pcEncT›
->
	`gëRDGoOnSbacCodî
();

98 
m_vdRdPicLambda
.
	`ªsize
(
m_pcCfg
->
	`gëDñèQpRD
() * 2 + 1 );

99 
m_vdRdPicQp
.
	`ªsize
–
m_pcCfg
->
	`gëDñèQpRD
() * 2 + 1 );

100 
m_viRdPicQp
.
	`ªsize
–
m_pcCfg
->
	`gëDñèQpRD
() * 2 + 1 );

101 
m_pcR©eCål
 = 
pcEncT›
->
	`gëR©eCål
();

102 
	}
}

104 
Void
 
	gTEncSli˚
::
	$upd©eLambda
(
TComSli˚
* 
pSli˚
, 
DoubÀ
 
dQP
)

106 
I¡
 
iQP
 = (I¡)
dQP
;

107 
DoubÀ
 
dLambda
 = 
	`ˇlcuœãLambda
(
pSli˚
, 
m_g›ID
,ÖSli˚->
	`gëDïth
(),ÖSli˚->
	`gëSli˚Qp
(), 
dQP
, 
iQP
);

109 
	`£tUpLambda
(
pSli˚
, 
dLambda
, 
iQP
);

110 
	}
}

112 
Void


113 
	gTEncSli˚
::
	$£tUpLambda
(
TComSli˚
* 
¶i˚
, c⁄° 
DoubÀ
 
dLambda
, 
I¡
 
iQP
)

116 
m_pcRdCo°
 ->
	`£tLambda
–
dLambda
, 
¶i˚
->
	`gëSPS
()->
	`gëBôDïths
() );

120 
DoubÀ
 
dLambdas
[
MAX_NUM_COMPONENT
] = { 
dLambda
 };

121 
UI¡
 
compIdx
=1; compIdx<
MAX_NUM_COMPONENT
; compIdx++)

123 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
compIdx
);

124 
I¡
 
chromaQPOff£t
 = 
¶i˚
->
	`gëPPS
()->
	`gëQpOff£t
(
compID
Ë+ sli˚->
	`gëSli˚ChromaQpDñè
(compID);

125 
I¡
 
qpc
=(
iQP
 + 
chromaQPOff£t
 < 0Ë? iQP : 
	`gëSˇÀdChromaQP
(iQP + chromaQPOff£t, 
m_pcCfg
->
	`gëChromaF‹m©Idc
());

126 
DoubÀ
 
tmpWeight
 = 
	`pow
–2.0, (
iQP
-
qpc
)/3.0 );

127 
m_pcRdCo°
->
	`£tDi°‹ti⁄Weight
(
compID
, 
tmpWeight
);

128 
dLambdas
[
compIdx
]=
dLambda
/
tmpWeight
;

131 #i‡
RDOQ_CHROMA_LAMBDA


133 
m_pcTrQu™t
->
	`£tLambdas
–
dLambdas
 );

135 
m_pcTrQu™t
->
	`£tLambda
–
dLambda
 );

139 
¶i˚
->
	`£tLambdas
–
dLambdas
 );

140 
	}
}

159 
Void
 
	gTEncSli˚
::
	$öôEncSli˚
–
TComPic
* 
pcPic
, c⁄° 
I¡
 
pocLa°
, c⁄° I¡ 
pocCuº
, c⁄° I¡ 
iGOPid
, 
TComSli˚
*& 
ΩcSli˚
, c⁄° 
Boﬁ
 
isFõld
 )

161 
DoubÀ
 
dQP
;

162 
DoubÀ
 
dLambda
;

164 
ΩcSli˚
 = 
pcPic
->
	`gëSli˚
(0);

165 
ΩcSli˚
->
	`£tSli˚Bôs
(0);

166 
ΩcSli˚
->
	`£tPic
–
pcPic
 );

167 
ΩcSli˚
->
	`öôSli˚
();

168 
ΩcSli˚
->
	`£tPicOuçutFœg
–
åue
 );

169 
ΩcSli˚
->
	`£tPOC
–
pocCuº
 );

170 
pcPic
->
	`£tFõld
(
isFõld
);

171 
m_g›ID
 = 
iGOPid
;

174 
I¡
 
dïth
;

176 
I¡
 
poc
 = 
ΩcSli˚
->
	`gëPOC
();

177 if(
isFõld
)

179 
poc
 = (poc/2Ë% (
m_pcCfg
->
	`gëGOPSize
()/2);

183 
poc
 =Öo¯% 
m_pcCfg
->
	`gëGOPSize
();

186 i‡–
poc
 == 0 )

188 
dïth
 = 0;

192 
I¡
 
°ï
 = 
m_pcCfg
->
	`gëGOPSize
();

193 
dïth
 = 0;

194  
I¡
 
i
=
°ï
>>1; i>=1; i>>=1 )

196  
I¡
 
j
=
i
; j<
m_pcCfg
->
	`gëGOPSize
(); j+=
°ï
 )

198 i‡–
j
 =
poc
 )

200 
i
=0;

204 
°ï
 >>= 1;

205 
dïth
++;

209 if(
m_pcCfg
->
	`gëH¨m⁄izeG›Fú°FõldCou∂eE«bÀd
(Ë&& 
poc
 != 0)

211 i‡(
isFõld
 && ((
ΩcSli˚
->
	`gëPOC
() % 2) == 1))

213 
dïth
 ++;

219 
Sli˚Ty≥
 
eSli˚Ty≥
;

221 
eSli˚Ty≥
=
B_SLICE
;

222 if(!(
isFõld
 && 
pocLa°
 =1Ë|| !
m_pcCfg
->
	`gëEfficõ¡FõldIRAPE«bÀd
())

224 if(
m_pcCfg
->
	`gëDecodögRe‰eshTy≥
() == 3)

226 
eSli˚Ty≥
 = (
pocLa°
 =0 || 
pocCuº
 % 
m_pcCfg
->
	`gëI¡øPîiod
(Ë=0 || 
m_pcGOPEncodî
->
	`gëGOPSize
(Ë=0Ë? 
I_SLICE
 :ÉSliceType;

230 
eSli˚Ty≥
 = (
pocLa°
 =0 || (
pocCuº
 - (
isFõld
 ? 1 : 0)Ë% 
m_pcCfg
->
	`gëI¡øPîiod
(Ë=0 || 
m_pcGOPEncodî
->
	`gëGOPSize
(Ë=0Ë? 
I_SLICE
 :ÉSliceType;

234 
ΩcSli˚
->
	`£tSli˚Ty≥
 ( 
eSli˚Ty≥
 );

240 if(
pocLa°
 == 0)

242 
ΩcSli˚
->
	`£tTemp‹ÆLayîN⁄Re„ªn˚Fœg
(
Ál£
);

246 
ΩcSli˚
->
	`£tTemp‹ÆLayîN⁄Re„ªn˚Fœg
(!
m_pcCfg
->
	`gëGOPE¡ry
(
iGOPid
).
m_ªfPic
);

248 
ΩcSli˚
->
	`£tRe„ªn˚d
(
åue
);

254 
dQP
 = 
m_pcCfg
->
	`gëQPF‹Pi˘uª
(
iGOPid
, 
ΩcSli˚
);

260 c⁄° 
I¡
 
ãmp‹ÆId
=
m_pcCfg
->
	`gëGOPE¡ry
(
iGOPid
).
m_ãmp‹ÆId
;

261 
I¡
 
iQP
;

262 
DoubÀ
 
dOrigQP
 = 
dQP
;

265  
I¡
 
iDQpIdx
 = 0; iDQpIdx < 2 * 
m_pcCfg
->
	`gëDñèQpRD
() + 1; iDQpIdx++ )

268 
dQP
 = 
dOrigQP
 + ((
iDQpIdx
+1)>>1)*(iDQpIdx%2 ? -1 : 1);

269 
dLambda
 = 
	`ˇlcuœãLambda
(
ΩcSli˚
, 
iGOPid
, 
dïth
, 
dQP
, dQP, 
iQP
 );

271 
m_vdRdPicLambda
[
iDQpIdx
] = 
dLambda
;

272 
m_vdRdPicQp
 [
iDQpIdx
] = 
dQP
;

273 
m_viRdPicQp
 [
iDQpIdx
] = 
iQP
;

277 
dLambda
 = 
m_vdRdPicLambda
[0];

278 
dQP
 = 
m_vdRdPicQp
 [0];

279 
iQP
 = 
m_viRdPicQp
 [0];

282 if(
ΩcSli˚
->
	`gëPPS
()->
	`gëSli˚ChromaQpFœg
())

284 c⁄° 
Boﬁ
 
bU£I¡øOrPîiodicOff£t
 = 
ΩcSli˚
->
	`gëSli˚Ty≥
()==
I_SLICE
 || (
m_pcCfg
->
	`gëSli˚ChromaOff£tQpPîiodicôy
()!=0 && (ΩcSli˚->
	`gëPOC
()%m_pcCfg->getSliceChromaOffsetQpPeriodicity())==0);

285 
I¡
 
cbQP
 = 
bU£I¡øOrPîiodicOff£t
? 
m_pcCfg
->
	`gëSli˚ChromaOff£tQpI¡øOrPîiodic
(
Ál£
Ë: m_pcCfg->
	`gëGOPE¡ry
(
iGOPid
).
m_CbQPoff£t
;

286 
I¡
 
¸QP
 = 
bU£I¡øOrPîiodicOff£t
? 
m_pcCfg
->
	`gëSli˚ChromaOff£tQpI¡øOrPîiodic
(
åue
Ë: m_pcCfg->
	`gëGOPE¡ry
(
iGOPid
).
m_CrQPoff£t
;

288 
cbQP
 = 
	`Clù3
–-12, 12, cbQP + 
ΩcSli˚
->
	`gëPPS
()->
	`gëQpOff£t
(
COMPONENT_Cb
) ) -ÑpcSlice->getPPS()->getQpOffset(COMPONENT_Cb);

289 
¸QP
 = 
	`Clù3
–-12, 12, crQP + 
ΩcSli˚
->
	`gëPPS
()->
	`gëQpOff£t
(
COMPONENT_Cr
) ) -ÑpcSlice->getPPS()->getQpOffset(COMPONENT_Cr);

290 
ΩcSli˚
->
	`£tSli˚ChromaQpDñè
(
COMPONENT_Cb
, 
	`Clù3
–-12, 12, 
cbQP
));

291 
	`as£π
(
ΩcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cb
)+ΩcSli˚->
	`gëPPS
()->
	`gëQpOff£t
(COMPONENT_Cb)<=12 &&ÑpcSlice->getSliceChromaQpDelta(COMPONENT_Cb)+rpcSlice->getPPS()->getQpOffset(COMPONENT_Cb)>=-12);

292 
ΩcSli˚
->
	`£tSli˚ChromaQpDñè
(
COMPONENT_Cr
, 
	`Clù3
–-12, 12, 
¸QP
));

293 
	`as£π
(
ΩcSli˚
->
	`gëSli˚ChromaQpDñè
(
COMPONENT_Cr
)+ΩcSli˚->
	`gëPPS
()->
	`gëQpOff£t
(COMPONENT_Cr)<=12 &&ÑpcSlice->getSliceChromaQpDelta(COMPONENT_Cr)+rpcSlice->getPPS()->getQpOffset(COMPONENT_Cr)>=-12);

297 
ΩcSli˚
->
	`£tSli˚ChromaQpDñè
–
COMPONENT_Cb
, 0 );

298 
ΩcSli˚
->
	`£tSli˚ChromaQpDñè
–
COMPONENT_Cr
, 0 );

302 
	`£tUpLambda
(
ΩcSli˚
, 
dLambda
, 
iQP
);

304 i‡(
m_pcCfg
->
	`gëFa°MEF‹GíBLowDñayE«bÀd
())

308 if(!(
isFõld
 && 
pocLa°
 =1Ë|| !
m_pcCfg
->
	`gëEfficõ¡FõldIRAPE«bÀd
())

310 if(
m_pcCfg
->
	`gëDecodögRe‰eshTy≥
() == 3)

312 
eSli˚Ty≥
 = (
pocLa°
 =0 || (
pocCuº
Ë% 
m_pcCfg
->
	`gëI¡øPîiod
(Ë=0 || 
m_pcGOPEncodî
->
	`gëGOPSize
(Ë=0Ë? 
I_SLICE
 :ÉSliceType;

316 
eSli˚Ty≥
 = (
pocLa°
 =0 || (
pocCuº
 - (
isFõld
 ? 1 : 0)Ë% 
m_pcCfg
->
	`gëI¡øPîiod
(Ë=0 || 
m_pcGOPEncodî
->
	`gëGOPSize
(Ë=0Ë? 
I_SLICE
 :ÉSliceType;

320 
ΩcSli˚
->
	`£tSli˚Ty≥
 ( 
eSli˚Ty≥
 );

323 i‡(
m_pcCfg
->
	`gëU£ReˇlcuœãQPAcc‹dögToLambda
())

325 
dQP
 = 
	`xGëQPVÆueAcc‹dögToLambda
–
dLambda
 );

326 
iQP
 = 
	`max
–-
ΩcSli˚
->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
	`mö
–
MAX_QP
, (
I¡
Ë
	`Êo‹
–
dQP
 + 0.5 ) ) );

329 
ΩcSli˚
->
	`£tSli˚Qp
 ( 
iQP
 );

330 #i‡
ADAPTIVE_QP_SELECTION


331 
ΩcSli˚
->
	`£tSli˚QpBa£
 ( 
iQP
 );

333 
ΩcSli˚
->
	`£tSli˚QpDñè
 ( 0 );

334 
ΩcSli˚
->
	`£tU£ChromaQpAdj
–ΩcSli˚->
	`gëPPS
()->
	`gëPpsR™geExãnsi⁄
().
	`gëChromaQpOff£tLi°E«bÀdFœg
() );

335 
ΩcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_0
,
m_pcCfg
->
	`gëGOPE¡ry
(
iGOPid
).
m_numRefPicsA˘ive
);

336 
ΩcSli˚
->
	`£tNumRefIdx
(
REF_PIC_LIST_1
,
m_pcCfg
->
	`gëGOPE¡ry
(
iGOPid
).
m_numRefPicsA˘ive
);

338 i‡–
m_pcCfg
->
	`gëDeblockögFûãrMëric
() )

340 
ΩcSli˚
->
	`£tDeblockögFûãrOvîrideFœg
(
åue
);

341 
ΩcSli˚
->
	`£tDeblockögFûãrDißbÀ
(
Ál£
);

342 
ΩcSli˚
->
	`£tDeblockögFûãrBëaOff£tDiv2
( 0 );

343 
ΩcSli˚
->
	`£tDeblockögFûãrTcOff£tDiv2
( 0 );

345 i‡(
ΩcSli˚
->
	`gëPPS
()->
	`gëDeblockögFûãrC⁄åﬁPª£¡Fœg
())

347 
ΩcSli˚
->
	`£tDeblockögFûãrOvîrideFœg
–ΩcSli˚->
	`gëPPS
()->
	`gëDeblockögFûãrOvîrideE«bÀdFœg
() );

348 
ΩcSli˚
->
	`£tDeblockögFûãrDißbÀ
–ΩcSli˚->
	`gëPPS
()->
	`gëPPSDeblockögFûãrDißbÀdFœg
() );

349 i‡–!
ΩcSli˚
->
	`gëDeblockögFûãrDißbÀ
())

351 i‡–
ΩcSli˚
->
	`gëDeblockögFûãrOvîrideFœg
(Ë&& 
eSli˚Ty≥
!=
I_SLICE
)

353 
ΩcSli˚
->
	`£tDeblockögFûãrBëaOff£tDiv2
–
m_pcCfg
->
	`gëGOPE¡ry
(
iGOPid
).
m_bëaOff£tDiv2
 + m_pcCfg->
	`gëLo›FûãrBëaOff£t
() );

354 
ΩcSli˚
->
	`£tDeblockögFûãrTcOff£tDiv2
–
m_pcCfg
->
	`gëGOPE¡ry
(
iGOPid
).
m_tcOff£tDiv2
 + m_pcCfg->
	`gëLo›FûãrTcOff£t
() );

358 
ΩcSli˚
->
	`£tDeblockögFûãrBëaOff£tDiv2
–
m_pcCfg
->
	`gëLo›FûãrBëaOff£t
() );

359 
ΩcSli˚
->
	`£tDeblockögFûãrTcOff£tDiv2
–
m_pcCfg
->
	`gëLo›FûãrTcOff£t
() );

365 
ΩcSli˚
->
	`£tDeblockögFûãrOvîrideFœg
–
Ál£
 );

366 
ΩcSli˚
->
	`£tDeblockögFûãrDißbÀ
–
Ál£
 );

367 
ΩcSli˚
->
	`£tDeblockögFûãrBëaOff£tDiv2
( 0 );

368 
ΩcSli˚
->
	`£tDeblockögFûãrTcOff£tDiv2
( 0 );

371 
ΩcSli˚
->
	`£tDïth
 ( 
dïth
 );

373 
pcPic
->
	`£tTLayî
–
ãmp‹ÆId
 );

374 if(
eSli˚Ty≥
==
I_SLICE
)

376 
pcPic
->
	`£tTLayî
(0);

378 
ΩcSli˚
->
	`£tTLayî
–
pcPic
->
	`gëTLayî
() );

380 
pcPic
->
	`£tPicYuvPªd
–&
m_picYuvPªd
 );

381 
pcPic
->
	`£tPicYuvResi
–&
m_picYuvResi
 );

382 
ΩcSli˚
->
	`£tSli˚Mode
 ( 
m_pcCfg
->
	`gëSli˚Mode
() );

383 
ΩcSli˚
->
	`£tSli˚Argumít
 ( 
m_pcCfg
->
	`gëSli˚Argumít
() );

384 
ΩcSli˚
->
	`£tSli˚SegmítMode
 ( 
m_pcCfg
->
	`gëSli˚SegmítMode
() );

385 
ΩcSli˚
->
	`£tSli˚SegmítArgumít
 ( 
m_pcCfg
->
	`gëSli˚SegmítArgumít
() );

386 
ΩcSli˚
->
	`£tMaxNumMîgeC™d
 ( 
m_pcCfg
->
	`gëMaxNumMîgeC™d
() );

387 
	}
}

390 
DoubÀ
 
	gTEncSli˚
::
	$ˇlcuœãLambda
–c⁄° 
TComSli˚
* 
¶i˚
,

391 c⁄° 
I¡
 
GOPid
,

392 c⁄° 
I¡
 
dïth
,

393 c⁄° 
DoubÀ
 
ªfQP
,

394 c⁄° 
DoubÀ
 
dQP
,

395 
I¡
 &
iQP
 )

397 
Sli˚Ty≥
 
eSli˚Ty≥
 = 
¶i˚
->
	`gëSli˚Ty≥
();

398 c⁄° 
Boﬁ
 
isFõld
 = 
¶i˚
->
	`gëPic
()->
	`isFõld
();

399 c⁄° 
I¡
 
NumbîBFømes
 = ( 
m_pcCfg
->
	`gëGOPSize
() - 1 );

400 c⁄° 
I¡
 
SHIFT_QP
 = 12;

401 c⁄° 
I¡
 
ãmp‹ÆId
=
m_pcCfg
->
	`gëGOPE¡ry
(
GOPid
).
m_ãmp‹ÆId
;

402 c⁄° 
°d
::
ve˘‹
<
DoubÀ
> &
öåaLambdaModifõrs
=
m_pcCfg
->
	`gëI¡øLambdaModifõr
();

404 #i‡
FULL_NBIT


405 
I¡
 
bôdïth_luma_qp_sˇÀ
 = 6 * (
¶i˚
->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
) - 8);

407 
I¡
 
bôdïth_luma_qp_sˇÀ
 = 0;

409 
DoubÀ
 
qp_ãmp
 = 
dQP
 + 
bôdïth_luma_qp_sˇÀ
 - 
SHIFT_QP
;

411 
DoubÀ
 
dQPFa˘‹
 = 
m_pcCfg
->
	`gëGOPE¡ry
(
GOPid
).
m_QPFa˘‹
;

412 i‡–
eSli˚Ty≥
==
I_SLICE
 )

414 i‡(
m_pcCfg
->
	`gëI¡øQpFa˘‹
()>=0.0 && m_pcCfg->
	`gëGOPE¡ry
(
GOPid
).
m_¶i˚Ty≥
 !
I_SLICE
)

416 
dQPFa˘‹
=
m_pcCfg
->
	`gëI¡øQpFa˘‹
();

420 if(
m_pcCfg
->
	`gëLambdaFromQPE«bÀ
())

422 
dQPFa˘‹
=0.57;

426 
DoubÀ
 
dLambda_sˇÀ
 = 1.0 - 
	`Clù3
–0.0, 0.5, 0.05*(DoubÀ)(
isFõld
 ? 
NumbîBFømes
/2 : NumberBFrames) );

427 
dQPFa˘‹
=0.57*
dLambda_sˇÀ
;

431 if–
m_pcCfg
->
	`gëLambdaFromQPE«bÀ
() )

433 
dQPFa˘‹
=0.57;

436 
DoubÀ
 
dLambda
 = 
dQPFa˘‹
*
	`pow
–2.0, 
qp_ãmp
/3.0 );

438 if–!(
m_pcCfg
->
	`gëLambdaFromQPE«bÀ
()Ë&& 
dïth
>0 )

440 #i‡
FULL_NBIT


441 
DoubÀ
 
qp_ãmp_ªf_‹ig
 = 
ªfQP
 - 
SHIFT_QP
;

442 
dLambda
 *
	`Clù3
–2.00, 4.00, (
qp_ãmp_ªf_‹ig
 / 6.0) );

444 
DoubÀ
 
qp_ãmp_ªf
 = 
ªfQP
 + 
bôdïth_luma_qp_sˇÀ
 - 
SHIFT_QP
;

445 
dLambda
 *
	`Clù3
–2.00, 4.00, (
qp_ãmp_ªf
 / 6.0) );

450 i‡–!
m_pcCfg
->
	`gëU£HADME
(Ë&& 
¶i˚
->
	`gëSli˚Ty≥
–Ë!
I_SLICE
 )

452 
dLambda
 *= 0.95;

455 
DoubÀ
 
œmbdaModifõr
;

456 if–
eSli˚Ty≥
 !
I_SLICE
 || 
öåaLambdaModifõrs
.
	`em±y
())

458 
œmbdaModifõr
 = 
m_pcCfg
->
	`gëLambdaModifõr
–
ãmp‹ÆId
 );

462 
œmbdaModifõr
 = 
öåaLambdaModifõrs
[ (
ãmp‹ÆId
 < i¡øLambdaModifõrs.
	`size
()) ?ÅemporalId : (intraLambdaModifiers.size()-1) ];

464 
dLambda
 *
œmbdaModifõr
;

466 
iQP
 = 
	`max
–-
¶i˚
->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
	`mö
–
MAX_QP
, (
I¡
Ë
	`Êo‹
–
dQP
 + 0.5 ) ) );

469  
dLambda
;

470 
	}
}

472 
Void
 
	gTEncSli˚
::
	$ª£tQP
–
TComPic
* 
pic
, 
I¡
 
¶i˚QP
, 
DoubÀ
 
œmbda
 )

474 
TComSli˚
* 
¶i˚
 = 
pic
->
	`gëSli˚
(0);

477 
¶i˚
->
	`£tSli˚Qp
–
¶i˚QP
 );

478 #i‡
ADAPTIVE_QP_SELECTION


479 
¶i˚
->
	`£tSli˚QpBa£
 ( 
¶i˚QP
 );

481 
	`£tUpLambda
(
¶i˚
, 
œmbda
, 
¶i˚QP
);

482 
	}
}

489 
Void
 
	gTEncSli˚
::
	$£tSórchR™ge
–
TComSli˚
* 
pcSli˚
 )

491 
I¡
 
iCuºPOC
 = 
pcSli˚
->
	`gëPOC
();

492 
I¡
 
iRefPOC
;

493 
I¡
 
iGOPSize
 = 
m_pcCfg
->
	`gëGOPSize
();

494 
I¡
 
iOff£t
 = (
iGOPSize
 >> 1);

495 
I¡
 
iMaxSR
 = 
m_pcCfg
->
	`gëSórchR™ge
();

496 
I¡
 
iNumPªdDú
 = 
pcSli˚
->
	`isI¡îP
() ? 1 : 2;

498 
I¡
 
iDú
 = 0; iDú < 
iNumPªdDú
; iDir++)

500 
RefPicLi°
 
e
 = ( 
iDú
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

501 
I¡
 
iRefIdx
 = 0; iRefIdx < 
pcSli˚
->
	`gëNumRefIdx
(
e
); iRefIdx++)

503 
iRefPOC
 = 
pcSli˚
->
	`gëRefPic
(
e
, 
iRefIdx
)->
	`gëPOC
();

504 
I¡
 
√wSórchR™ge
 = 
	`Clù3
(
m_pcCfg
->
	`gëMöSórchWödow
(), 
iMaxSR
, (iMaxSR*
ADAPT_SR_SCALE
*
	`abs
(
iCuºPOC
 - 
iRefPOC
)+
iOff£t
)/
iGOPSize
);

505 
m_pcPªdSórch
->
	`£tAd≠tiveSórchR™ge
(
iDú
, 
iRefIdx
, 
√wSórchR™ge
);

508 
	}
}

515 
Void
 
	gTEncSli˚
::
	$¥ecom¥essSli˚
–
TComPic
* 
pcPic
 )

518 i‡–
m_pcCfg
->
	`gëDñèQpRD
() == 0 )

523 i‡–
m_pcCfg
->
	`gëU£R©eCål
() )

525 
	`¥ötf
( "\nMultiple QP optimization isÇotállowed whenÑate control isÉnabled." );

526 
	`as£π
(0);

530 
TComSli˚
* 
pcSli˚
 = 
pcPic
->
	`gëSli˚
(
	`gëSli˚Idx
());

532 i‡(
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
())

539 i‡(
pcSli˚
->
	`gëSli˚Mode
()==
FIXED_NUMBER_OF_BYTES
)

542 
	`¥ötf
( "\nUnableÅo optimise Slice-level QP if Slice Mode is setÅo FIXED_NUMBER_OF_BYTES\n" );

543 
	`as£π
(0);

547 
DoubÀ
 
dPicRdCo°Be°
 = 
MAX_DOUBLE
;

548 
UI¡
 
uiQpIdxBe°
 = 0;

550 
DoubÀ
 
dFømeLambda
;

551 #i‡
FULL_NBIT


552 
I¡
 
SHIFT_QP
 = 12 + 6 * (
pcSli˚
->
	`gëSPS
()->
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
) - 8);

554 
I¡
 
SHIFT_QP
 = 12;

558 i‡(
m_pcCfg
->
	`gëGOPSize
() > 1)

560 
dFømeLambda
 = 0.68 * 
	`pow
 (2, (
m_viRdPicQp
[0] - 
SHIFT_QP
Ë/ 3.0Ë* (
pcSli˚
->
	`isI¡îB
()? 2 : 1);

564 
dFømeLambda
 = 0.68 * 
	`pow
 (2, (
m_viRdPicQp
[0] - 
SHIFT_QP
) / 3.0);

566 
m_pcRdCo°
 ->
	`£tFømeLambda
(
dFømeLambda
);

569  
UI¡
 
uiQpIdx
 = 0; uiQpIdx < 2 * 
m_pcCfg
->
	`gëDñèQpRD
() + 1; uiQpIdx++ )

571 
pcSli˚
 ->
	`£tSli˚Qp
 ( 
m_viRdPicQp
 [
uiQpIdx
] );

572 #i‡
ADAPTIVE_QP_SELECTION


573 
pcSli˚
 ->
	`£tSli˚QpBa£
 ( 
m_viRdPicQp
 [
uiQpIdx
] );

575 
	`£tUpLambda
(
pcSli˚
, 
m_vdRdPicLambda
[
uiQpIdx
], 
m_viRdPicQp
 [uiQpIdx]);

578 
	`com¥essSli˚
 ( 
pcPic
, 
åue
, 
m_pcCfg
->
	`gëFa°DñèQp
());

580 
UI¡64
 
uiPicDi°
 = 
m_uiPicDi°
;

589 
DoubÀ
 
dPicRdCo°
 = 
m_pcRdCo°
->
	`ˇlcRdCo°
–(DoubÀ)
m_uiPicTŸÆBôs
, 
uiPicDi°
, 
DF_SSE_FRAME
);

591 i‡–
dPicRdCo°
 < 
dPicRdCo°Be°
 )

593 
uiQpIdxBe°
 = 
uiQpIdx
;

594 
dPicRdCo°Be°
 = 
dPicRdCo°
;

599 
pcSli˚
 ->
	`£tSli˚Qp
 ( 
m_viRdPicQp
 [
uiQpIdxBe°
] );

600 #i‡
ADAPTIVE_QP_SELECTION


601 
pcSli˚
 ->
	`£tSli˚QpBa£
 ( 
m_viRdPicQp
 [
uiQpIdxBe°
] );

603 
	`£tUpLambda
(
pcSli˚
, 
m_vdRdPicLambda
[
uiQpIdxBe°
], 
m_viRdPicQp
 [uiQpIdxBest]);

604 
	}
}

606 
Void
 
	gTEncSli˚
::
	$ˇlCo°Sli˚I
(
TComPic
* 
pcPic
)

608 
DoubÀ
 
iSumHadSli˚
 = 0;

609 
TComSli˚
 * c⁄° 
pcSli˚
 = 
pcPic
->
	`gëSli˚
(
	`gëSli˚Idx
());

610 c⁄° 
TComSPS
 &
•s
 = *(
pcSli˚
->
	`gëSPS
());

611 c⁄° 
I¡
 
shi·
 = 
•s
.
	`gëBôDïth
(
CHANNEL_TYPE_LUMA
)-8;

612 c⁄° 
I¡
 
off£t
 = (
shi·
>0)?(1<<(shift-1)):0;

614 
pcSli˚
->
	`£tSli˚SegmítBôs
(0);

616 
UI¡
 
°¨tCtuTsAddr
, 
boundögCtuTsAddr
;

617 
	`xDëîmöeSèπAndBoundögCtuTsAddr
 ( 
°¨tCtuTsAddr
, 
boundögCtuTsAddr
, 
pcPic
 );

619  
UI¡
 
˘uTsAddr
 = 
°¨tCtuTsAddr
, 
˘uRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
( startCtuTsAddr);

620 
˘uTsAddr
 < 
boundögCtuTsAddr
;

621 
˘uRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(++
˘uTsAddr
) )

624 
TComD©aCU
* 
pCtu
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 );

625 
pCtu
->
	`öôCtu
–
pcPic
, 
˘uRsAddr
 );

627 
I¡
 
height
 = 
	`mö
–
•s
.
	`gëMaxCUHeight
(),•s.
	`gëPicHeightInLumaSam∂es
(Ë- 
˘uRsAddr
 / 
pcPic
->
	`gëFømeWidthInCtus
() * sps.getMaxCUHeight() );

628 
I¡
 
width
 = 
	`mö
–
•s
.
	`gëMaxCUWidth
(), sps.
	`gëPicWidthInLumaSam∂es
(Ë- 
˘uRsAddr
 % 
pcPic
->
	`gëFømeWidthInCtus
() * sps.getMaxCUWidth() );

630 
I¡
 
iSumHad
 = 
m_pcCuEncodî
->
	`upd©eCtuD©aISli˚
(
pCtu
, 
width
, 
height
);

632 (
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCU
(
˘uRsAddr
)).
m_co°I¡ø
=(
iSumHad
+
off£t
)>>
shi·
;

633 
iSumHadSli˚
 +(
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCU
(
˘uRsAddr
)).
m_co°I¡ø
;

636 
m_pcR©eCål
->
	`gëRCPic
()->
	`£tTŸÆI¡øCo°
(
iSumHadSli˚
);

637 
	}
}

641 
Void
 
	gTEncSli˚
::
	$com¥essSli˚
–
TComPic
* 
pcPic
, c⁄° 
Boﬁ
 
bCom¥essE¡úeSli˚
, c⁄° Boﬁ 
bFa°DñèQP
 )

646 
UI¡
 
°¨tCtuTsAddr
;

647 
UI¡
 
boundögCtuTsAddr
;

648 
TComSli˚
* c⁄° 
pcSli˚
 = 
pcPic
->
	`gëSli˚
(
	`gëSli˚Idx
());

649 
pcSli˚
->
	`£tSli˚SegmítBôs
(0);

650 
	`xDëîmöeSèπAndBoundögCtuTsAddr
 ( 
°¨tCtuTsAddr
, 
boundögCtuTsAddr
, 
pcPic
 );

651 i‡(
bCom¥essE¡úeSli˚
)

653 
boundögCtuTsAddr
 = 
pcSli˚
->
	`gëSli˚CurEndCtuTsAddr
();

654 
pcSli˚
->
	`£tSli˚SegmítCurEndCtuTsAddr
(
boundögCtuTsAddr
);

658 
m_uiPicTŸÆBôs
 = 0;

659 
m_dPicRdCo°
 = 0;

660 
m_uiPicDi°
 = 0;

662 
m_pcE¡r›yCodî
->
	`£tE¡r›yCodî
 ( 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
] );

663 
m_pcE¡r›yCodî
->
	`ª£tE¡r›y
 ( 
pcSli˚
 );

665 
TEncBöCABAC
* 
pRDSbacCodî
 = (TEncBöCABAC *Ë
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]->
	`gëEncBöIf
();

666 
pRDSbacCodî
->
	`£tBöCou¡ögE«bÀFœg
–
Ál£
 );

667 
pRDSbacCodî
->
	`£tBösCoded
( 0 );

669 
TComBôCou¡î
 
ãmpBôCou¡î
;

670 c⁄° 
UI¡
 
‰ameWidthInCtus
 = 
pcPic
->
	`gëPicSym
()->
	`gëFømeWidthInCtus
();

672 
m_pcCuEncodî
->
	`£tFa°DñèQp
(
bFa°DñèQP
);

678 if–
pcSli˚
->
	`gëPPS
()->
	`gëU£WP
(Ë||ÖcSli˚->gëPPS()->
	`gëWPBiPªd
() )

680 
	`xCÆcACDCP¨amSli˚
(
pcSli˚
);

683 c⁄° 
Boﬁ
 
bWp_ex∂icô
 = (
pcSli˚
->
	`gëSli˚Ty≥
()==
P_SLICE
 &&ÖcSli˚->
	`gëPPS
()->
	`gëU£WP
()Ë|| (pcSli˚->gëSli˚Ty≥()==
B_SLICE
 &&ÖcSli˚->gëPPS()->
	`gëWPBiPªd
());

685 i‡–
bWp_ex∂icô
 )

690 i‡–
pcSli˚
->
	`gëSli˚Mode
()==
FIXED_NUMBER_OF_BYTES
 ||ÖcSli˚->
	`gëSli˚SegmítMode
()==FIXED_NUMBER_OF_BYTES )

692 
	`¥ötf
("Weighãd Pªdi˘i⁄ i†nŸ suµ‹ãd wôh sli˚ modêdëîmöed by maxÇumbî o‡bös.\n"); 
	`exô
(0);

695 
	`xE°im©eWPP¨amSli˚
–
pcSli˚
, 
m_pcCfg
->
	`gëWeighãdPªdi˘i⁄Mëhod
() );

696 
pcSli˚
->
	`öôWpSˇlög
’cSli˚->
	`gëSPS
());

699 
	`xCheckWPE«bÀ
–
pcSli˚
 );

702 #i‡
ADAPTIVE_QP_SELECTION


703 if–
m_pcCfg
->
	`gëU£Ad≠tQpSñe˘
(Ë&& !(
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
()))

706 
m_pcTrQu™t
->
	`˛órSli˚ARLC¡
();

707 if(
pcSli˚
->
	`gëSli˚Ty≥
()!=
I_SLICE
)

709 
I¡
 
qpBa£
 = 
pcSli˚
->
	`gëSli˚QpBa£
();

710 
pcSli˚
->
	`£tSli˚Qp
(
qpBa£
 + 
m_pcTrQu™t
->
	`gëQpDñè
(qpBase));

719 c⁄° 
UI¡
 
˘uRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
–
°¨tCtuTsAddr
);

720 c⁄° 
UI¡
 
cuºítTûeIdx
 = 
pcPic
->
	`gëPicSym
()->
	`gëTûeIdxM≠
(
˘uRsAddr
);

721 c⁄° 
TComTûe
 *
pCuºítTûe
 = 
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
(
cuºítTûeIdx
);

722 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
pCuºítTûe
->
	`gëFú°CtuRsAddr
();

723 if–
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
(Ë&& 
˘uRsAddr
 !
fú°CtuRsAddrOfTûe
 )

726 if–
pCuºítTûe
->
	`gëTûeWidthInCtus
(Ë>2 || !
m_pcCfg
->
	`gëE¡r›yCodögSyncE«bÀdFœg
() )

728 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]->
	`lﬂdC⁄ãxts
–&
m_œ°Sli˚SegmítEndC⁄ãxtSèã
 );

735  
UI¡
 
˘uTsAddr
 = 
°¨tCtuTsAddr
; ctuTsAdd∏< 
boundögCtuTsAddr
; ++ctuTsAddr )

737 c⁄° 
UI¡
 
˘uRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
˘uTsAddr
);

739 
TComD©aCU
* 
pCtu
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 );

740 
pCtu
->
	`öôCtu
–
pcPic
, 
˘uRsAddr
 );

743 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
’cPic->gëPicSym()->
	`gëTûeIdxM≠
(
˘uRsAddr
))->
	`gëFú°CtuRsAddr
();

744 c⁄° 
UI¡
 
tûeXPosInCtus
 = 
fú°CtuRsAddrOfTûe
 % 
‰ameWidthInCtus
;

745 c⁄° 
UI¡
 
˘uXPosInCtus
 = 
˘uRsAddr
 % 
‰ameWidthInCtus
;

747 i‡(
˘uRsAddr
 =
fú°CtuRsAddrOfTûe
)

749 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]->
	`ª£tE¡r›y
(
pcSli˚
);

751 i‡–
˘uXPosInCtus
 =
tûeXPosInCtus
 && 
m_pcCfg
->
	`gëE¡r›yCodögSyncE«bÀdFœg
())

754 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]->
	`ª£tE¡r›y
(
pcSli˚
);

756 
TComD©aCU
 *
pCtuUp
 = 
pCtu
->
	`gëCtuAbove
();

757 i‡–
pCtuUp
 && ((
˘uRsAddr
%
‰ameWidthInCtus
+1) < frameWidthInCtus) )

759 
TComD©aCU
 *
pCtuTR
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 - 
‰ameWidthInCtus
 + 1 );

760 i‡–
pCtu
->
	`CUIsFromSameSli˚AndTûe
(
pCtuTR
) )

763 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]->
	`lﬂdC⁄ãxts
–&
m_íå›yCodögSyncC⁄ãxtSèã
 );

769 
m_pcE¡r›yCodî
->
	`£tE¡r›yCodî
 ( 
m_pcRDGoOnSbacCodî
 );

770 
m_pcE¡r›yCodî
->
	`£tBô°ªam
–&
ãmpBôCou¡î
 );

771 
ãmpBôCou¡î
.
	`ª£tBôs
();

772 
m_pcRDGoOnSbacCodî
->
	`lﬂd
–
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
] );

775 ((
TEncBöCABAC
*)
m_pcRDGoOnSbacCodî
->
	`gëEncBöIf
())->
	`£tBöCou¡ögE«bÀFœg
(
åue
);

777 
DoubÀ
 
ﬁdLambda
 = 
m_pcRdCo°
->
	`gëLambda
();

778 i‡–
m_pcCfg
->
	`gëU£R©eCål
() )

780 
I¡
 
e°QP
 = 
pcSli˚
->
	`gëSli˚Qp
();

781 
DoubÀ
 
e°Lambda
 = -1.0;

782 
DoubÀ
 
bµ
 = -1.0;

784 i‡––
pcPic
->
	`gëSli˚
–0 )->
	`gëSli˚Ty≥
(Ë=
I_SLICE
 && 
m_pcCfg
->
	`gëF‹˚I¡øQP
(ËË|| !m_pcCfg->
	`gëLCULevñRC
() )

786 
e°QP
 = 
pcSli˚
->
	`gëSli˚Qp
();

790 
bµ
 = 
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCUT¨gëBµ
(
pcSli˚
->
	`gëSli˚Ty≥
());

791 i‡–
pcPic
->
	`gëSli˚
–0 )->
	`gëSli˚Ty≥
(Ë=
I_SLICE
)

793 
e°Lambda
 = 
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCUE°LambdaAndQP
(
bµ
, 
pcSli˚
->
	`gëSli˚Qp
(), &
e°QP
);

797 
e°Lambda
 = 
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCUE°Lambda
–
bµ
 );

798 
e°QP
 = 
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCUE°QP
 ( 
e°Lambda
, 
pcSli˚
->
	`gëSli˚Qp
() );

801 
e°QP
 = 
	`Clù3
–-
pcSli˚
->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
), 
MAX_QP
,ÉstQP );

803 
m_pcRdCo°
->
	`£tLambda
(
e°Lambda
, 
pcSli˚
->
	`gëSPS
()->
	`gëBôDïths
());

805 #i‡
RDOQ_CHROMA_LAMBDA


807 c⁄° 
DoubÀ
 
chromaLambda
 = 
e°Lambda
 / 
m_pcRdCo°
->
	`gëChromaWeight
();

808 c⁄° 
DoubÀ
 
œmbdaAºay
[
MAX_NUM_COMPONENT
] = { 
e°Lambda
, 
chromaLambda
, chromaLambda };

809 
m_pcTrQu™t
->
	`£tLambdas
–
œmbdaAºay
 );

811 
m_pcTrQu™t
->
	`£tLambda
–
e°Lambda
 );

815 
m_pcR©eCål
->
	`£tRCQP
–
e°QP
 );

816 #i‡
ADAPTIVE_QP_SELECTION


817 
pCtu
->
	`gëSli˚
()->
	`£tSli˚QpBa£
–
e°QP
 );

822 
m_pcCuEncodî
->
	`com¥essCtu
–
pCtu
 );

829 
m_pcE¡r›yCodî
->
	`£tE¡r›yCodî
 ( 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
] );

830 
m_pcE¡r›yCodî
->
	`£tBô°ªam
–&
ãmpBôCou¡î
 );

831 
pRDSbacCodî
->
	`£tBöCou¡ögE«bÀFœg
–
åue
 );

832 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]->
	`ª£tBôs
();

833 
pRDSbacCodî
->
	`£tBösCoded
( 0 );

836 
m_pcCuEncodî
->
	`ícodeCtu
–
pCtu
 );

839 
pRDSbacCodî
->
	`£tBöCou¡ögE«bÀFœg
–
Ál£
 );

841 c⁄° 
I¡
 
numbîOfWrôãnBôs
 = 
m_pcE¡r›yCodî
->
	`gëNumbîOfWrôãnBôs
();

845 c⁄° 
UI¡
 
vÆidEndOfSli˚CtuTsAddr
 = 
˘uTsAddr
 + (˘uTsAdd∏=
°¨tCtuTsAddr
 ? 1 : 0);

847 if(
pcSli˚
->
	`gëSli˚Mode
()==
FIXED_NUMBER_OF_BYTES
 &&ÖcSli˚->
	`gëSli˚Bôs
()+
numbîOfWrôãnBôs
 > (pcSli˚->
	`gëSli˚Argumít
()<<3))

849 
pcSli˚
->
	`£tSli˚SegmítCurEndCtuTsAddr
(
vÆidEndOfSli˚CtuTsAddr
);

850 
pcSli˚
->
	`£tSli˚CurEndCtuTsAddr
(
vÆidEndOfSli˚CtuTsAddr
);

851 
boundögCtuTsAddr
=
vÆidEndOfSli˚CtuTsAddr
;

853 if((!
bCom¥essE¡úeSli˚
Ë&& 
pcSli˚
->
	`gëSli˚SegmítMode
()==
FIXED_NUMBER_OF_BYTES
 &&ÖcSli˚->
	`gëSli˚SegmítBôs
()+
numbîOfWrôãnBôs
 > (pcSli˚->
	`gëSli˚SegmítArgumít
()<<3))

855 
pcSli˚
->
	`£tSli˚SegmítCurEndCtuTsAddr
(
vÆidEndOfSli˚CtuTsAddr
);

856 
boundögCtuTsAddr
=
vÆidEndOfSli˚CtuTsAddr
;

859 i‡(
boundögCtuTsAddr
 <
˘uTsAddr
)

864 
pcSli˚
->
	`£tSli˚Bôs
–(
UI¡
)’cSli˚->
	`gëSli˚Bôs
(Ë+ 
numbîOfWrôãnBôs
) );

865 
pcSli˚
->
	`£tSli˚SegmítBôs
’cSli˚->
	`gëSli˚SegmítBôs
()+
numbîOfWrôãnBôs
);

868 i‡–
˘uXPosInCtus
 =
tûeXPosInCtus
+1 && 
m_pcCfg
->
	`gëE¡r›yCodögSyncE«bÀdFœg
())

870 
m_íå›yCodögSyncC⁄ãxtSèã
.
	`lﬂdC⁄ãxts
(
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]);

874 i‡–
m_pcCfg
->
	`gëU£R©eCål
() )

876 
I¡
 
a˘uÆQP
 = 
g_RCInvÆidQPVÆue
;

877 
DoubÀ
 
a˘uÆLambda
 = 
m_pcRdCo°
->
	`gëLambda
();

878 
I¡
 
a˘uÆBôs
 = 
pCtu
->
	`gëTŸÆBôs
();

879 
I¡
 
numbîOfEf„˘ivePixñs
 = 0;

881 #i‡
JVET_M0600_RATE_CTRL


882 
I¡
 
numbîOfSkùPixñ
 = 0;

883 
I¡
 
idx
 = 0; idx < 
pcPic
->
	`gëNumP¨tôi⁄sInCtu
(); idx++)

886 
numbîOfSkùPixñ
 +16 * 
pCtu
->
	`isSkù≥d
(
idx
);

890  
I¡
 
idx
 = 0; idx < 
pcPic
->
	`gëNumP¨tôi⁄sInCtu
(); idx++ )

892 i‡–
pCtu
->
	`gëPªdi˘i⁄Mode
–
idx
 ) !
NUMBER_OF_PREDICTION_MODES
 && ( !pCtu->
	`isSkù≥d
( idx ) ) )

894 
numbîOfEf„˘ivePixñs
 =ÇumberOfEffectivePixels + 16;

899 #i‡
JVET_M0600_RATE_CTRL


900 
DoubÀ
 
skùR©io
 = (DoubÀ)
numbîOfSkùPixñ
 / 
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCU
(
˘uTsAddr
).
m_numbîOfPixñ
;

903 i‡–
numbîOfEf„˘ivePixñs
 == 0 )

905 
a˘uÆQP
 = 
g_RCInvÆidQPVÆue
;

909 
a˘uÆQP
 = 
pCtu
->
	`gëQP
( 0 );

911 #i‡
JVET_K0390_RATE_CTRL


912 
m_pcR©eCål
->
	`gëRCPic
()->
	`gëLCU
(
˘uTsAddr
).
m_a˘uÆMSE
 = (
DoubÀ
)
pCtu
->
	`gëTŸÆDi°‹ti⁄
(Ë/ (DoubÀ)m_pcR©eCål->gëRCPic()->gëLCU(˘uTsAddr).
m_numbîOfPixñ
;

914 
m_pcRdCo°
->
	`£tLambda
(
ﬁdLambda
, 
pcSli˚
->
	`gëSPS
()->
	`gëBôDïths
());

915 #i‡
JVET_M0600_RATE_CTRL


916 
m_pcR©eCål
->
	`gëRCPic
()->
	`upd©eA·îCTU
(m_pcR©eCål->gëRCPic()->
	`gëLCUCoded
(), 
a˘uÆBôs
, 
a˘uÆQP
, 
a˘uÆLambda
, 
skùR©io
,

917 
pCtu
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë=
I_SLICE
 ? 0 : 
m_pcCfg
->
	`gëLCULevñRC
());

919 
m_pcR©eCål
->
	`gëRCPic
()->
	`upd©eA·îCTU
–m_pcR©eCål->gëRCPic()->
	`gëLCUCoded
(), 
a˘uÆBôs
, 
a˘uÆQP
, 
a˘uÆLambda
,

920 
pCtu
->
	`gëSli˚
()->
	`gëSli˚Ty≥
(Ë=
I_SLICE
 ? 0 : 
m_pcCfg
->
	`gëLCULevñRC
() );

924 
m_uiPicTŸÆBôs
 +
pCtu
->
	`gëTŸÆBôs
();

925 
m_dPicRdCo°
 +
pCtu
->
	`gëTŸÆCo°
();

926 
m_uiPicDi°
 +
pCtu
->
	`gëTŸÆDi°‹ti⁄
();

931 if–
pcSli˚
->
	`gëPPS
()->
	`gëDïídítSli˚SegmítsE«bÀdFœg
() )

933 
m_œ°Sli˚SegmítEndC⁄ãxtSèã
.
	`lﬂdC⁄ãxts
–
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
] );

937 
m_µpcRDSbacCodî
[0][
CI_CURR_BEST
]->
	`£tBô°ªam
(
NULL
);

938 
m_pcRDGoOnSbacCodî
->
	`£tBô°ªam
(
NULL
);

949 
	}
}

951 
Void
 
	gTEncSli˚
::
	$ícodeSli˚
 ( 
TComPic
* 
pcPic
, 
TComOuçutBô°ªam
* 
pcSub°ªams
, 
UI¡
 &
numBösCoded
 )

953 
TComSli˚
 *c⁄° 
pcSli˚
 = 
pcPic
->
	`gëSli˚
(
	`gëSli˚Idx
());

955 c⁄° 
UI¡
 
°¨tCtuTsAddr
 = 
pcSli˚
->
	`gëSli˚SegmítCurSèπCtuTsAddr
();

956 c⁄° 
UI¡
 
boundögCtuTsAddr
 = 
pcSli˚
->
	`gëSli˚SegmítCurEndCtuTsAddr
();

958 c⁄° 
UI¡
 
‰ameWidthInCtus
 = 
pcPic
->
	`gëPicSym
()->
	`gëFømeWidthInCtus
();

959 c⁄° 
Boﬁ
 
dïSli˚SegmítsE«bÀd
 = 
pcSli˚
->
	`gëPPS
()->
	`gëDïídítSli˚SegmítsE«bÀdFœg
();

960 c⁄° 
Boﬁ
 
wave‰⁄tsE«bÀd
 = 
pcSli˚
->
	`gëPPS
()->
	`gëE¡r›yCodögSyncE«bÀdFœg
();

963 
m_pcSbacCodî
->
	`öô
–(
TEncBöIf
*)
m_pcBöCABAC
 );

964 
m_pcE¡r›yCodî
->
	`£tE¡r›yCodî
 ( 
m_pcSbacCodî
 );

965 
m_pcE¡r›yCodî
->
	`ª£tE¡r›y
 ( 
pcSli˚
 );

967 
numBösCoded
 = 0;

968 
m_pcBöCABAC
->
	`£tBöCou¡ögE«bÀFœg
–
åue
 );

969 
m_pcBöCABAC
->
	`£tBösCoded
(0);

971 #i‡
ENC_DEC_TRACE


972 
g_bJu°DoIt
 = 
g_bEncDecTø˚E«bÀ
;

974 
	`DTRACE_CABAC_VL
–
g_nSymbﬁCou¡î
++ );

975 
	`DTRACE_CABAC_T
( "\tPOC: " );

976 
	`DTRACE_CABAC_V
–
pcPic
->
	`gëPOC
() );

977 
	`DTRACE_CABAC_T
( "\n" );

978 #i‡
ENC_DEC_TRACE


979 
g_bJu°DoIt
 = 
g_bEncDecTø˚DißbÀ
;

983 i‡(
dïSli˚SegmítsE«bÀd
)

986 c⁄° 
UI¡
 
˘uRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
–
°¨tCtuTsAddr
 );

987 c⁄° 
UI¡
 
cuºítTûeIdx
=
pcPic
->
	`gëPicSym
()->
	`gëTûeIdxM≠
(
˘uRsAddr
);

988 c⁄° 
TComTûe
 *
pCuºítTûe
=
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
(
cuºítTûeIdx
);

989 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
pCuºítTûe
->
	`gëFú°CtuRsAddr
();

991 if–
pcSli˚
->
	`gëDïídítSli˚SegmítFœg
(Ë&& 
˘uRsAddr
 !
fú°CtuRsAddrOfTûe
 )

993 if–
pCuºítTûe
->
	`gëTûeWidthInCtus
(Ë>2 || !
wave‰⁄tsE«bÀd
 )

995 
m_pcSbacCodî
->
	`lﬂdC⁄ãxts
(&
m_œ°Sli˚SegmítEndC⁄ãxtSèã
);

1002  
UI¡
 
˘uTsAddr
 = 
°¨tCtuTsAddr
; ctuTsAdd∏< 
boundögCtuTsAddr
; ++ctuTsAddr )

1004 c⁄° 
UI¡
 
˘uRsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
˘uTsAddr
);

1005 c⁄° 
TComTûe
 &
cuºítTûe
 = *(
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
’cPic->gëPicSym()->
	`gëTûeIdxM≠
(
˘uRsAddr
)));

1006 c⁄° 
UI¡
 
fú°CtuRsAddrOfTûe
 = 
cuºítTûe
.
	`gëFú°CtuRsAddr
();

1007 c⁄° 
UI¡
 
tûeXPosInCtus
 = 
fú°CtuRsAddrOfTûe
 % 
‰ameWidthInCtus
;

1008 c⁄° 
UI¡
 
tûeYPosInCtus
 = 
fú°CtuRsAddrOfTûe
 / 
‰ameWidthInCtus
;

1009 c⁄° 
UI¡
 
˘uXPosInCtus
 = 
˘uRsAddr
 % 
‰ameWidthInCtus
;

1010 c⁄° 
UI¡
 
˘uYPosInCtus
 = 
˘uRsAddr
 / 
‰ameWidthInCtus
;

1011 c⁄° 
UI¡
 
uiSubSåm
=
pcPic
->
	`gëSub°ªamF‹CtuAddr
(
˘uRsAddr
, 
åue
, 
pcSli˚
);

1012 
TComD©aCU
* 
pCtu
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 );

1014 
m_pcE¡r›yCodî
->
	`£tBô°ªam
–&
pcSub°ªams
[
uiSubSåm
] );

1017 i‡(
˘uRsAddr
 =
fú°CtuRsAddrOfTûe
)

1019 i‡(
˘uTsAddr
 !
°¨tCtuTsAddr
)

1021 
m_pcE¡r›yCodî
->
	`ª£tE¡r›y
(
pcSli˚
);

1024 i‡(
˘uXPosInCtus
 =
tûeXPosInCtus
 && 
wave‰⁄tsE«bÀd
)

1027 i‡(
˘uTsAddr
 !
°¨tCtuTsAddr
)

1029 
m_pcE¡r›yCodî
->
	`ª£tE¡r›y
(
pcSli˚
);

1031 
TComD©aCU
 *
pCtuUp
 = 
pCtu
->
	`gëCtuAbove
();

1032 i‡–
pCtuUp
 && ((
˘uRsAddr
%
‰ameWidthInCtus
+1) < frameWidthInCtus) )

1034 
TComD©aCU
 *
pCtuTR
 = 
pcPic
->
	`gëCtu
–
˘uRsAddr
 - 
‰ameWidthInCtus
 + 1 );

1035 i‡–
pCtu
->
	`CUIsFromSameSli˚AndTûe
(
pCtuTR
) )

1038 
m_pcSbacCodî
->
	`lﬂdC⁄ãxts
–&
m_íå›yCodögSyncC⁄ãxtSèã
 );

1044 i‡–
pcSli˚
->
	`gëSPS
()->
	`gëU£SAO
() )

1046 
Boﬁ
 
bIsSAOSli˚E«bÀd
 = 
Ál£
;

1047 
Boﬁ
 
¶i˚E«bÀd
[
MAX_NUM_COMPONENT
];

1048 
I¡
 
comp
=0; com∞< 
MAX_NUM_COMPONENT
; comp++)

1050 
Comp⁄ítID
 
compId
=
	`Comp⁄ítID
(
comp
);

1051 
¶i˚E«bÀd
[
compId
] = 
pcSli˚
->
	`gëSaoE«bÀdFœg
(
	`toCh™√lTy≥
(compId)Ë&& (
comp
 < 
pcPic
->
	`gëNumbîVÆidComp⁄íts
());

1052 i‡(
¶i˚E«bÀd
[
compId
])

1054 
bIsSAOSli˚E«bÀd
=
åue
;

1057 i‡(
bIsSAOSli˚E«bÀd
)

1059 
SAOBlkP¨am
& 
ßoblkP¨am
 = (
pcPic
->
	`gëPicSym
()->
	`gëSAOBlkP¨am
())[
˘uRsAddr
];

1061 
Boﬁ
 
À·MîgeAvaû
 = 
Ál£
;

1062 
Boﬁ
 
aboveMîgeAvaû

Ál£
;

1064 
I¡
 
rx
 = (
˘uRsAddr
 % 
‰ameWidthInCtus
);

1065 if(
rx
 > 0)

1067 
À·MîgeAvaû
 = 
pcPic
->
	`gëSAOMîgeAvaûabûôy
(
˘uRsAddr
, ctuRsAddr-1);

1071 
I¡
 
ry
 = (
˘uRsAddr
 / 
‰ameWidthInCtus
);

1072 if(
ry
 > 0)

1074 
aboveMîgeAvaû
 = 
pcPic
->
	`gëSAOMîgeAvaûabûôy
(
˘uRsAddr
, ctuRsAddr-
‰ameWidthInCtus
);

1077 
m_pcE¡r›yCodî
->
	`ícodeSAOBlkP¨am
(
ßoblkP¨am
, 
pcPic
->
	`gëPicSym
()->
	`gëSPS
().
	`gëBôDïths
(), 
¶i˚E«bÀd
, 
À·MîgeAvaû
, 
aboveMîgeAvaû
);

1081 #i‡
ENC_DEC_TRACE


1082 
g_bJu°DoIt
 = 
g_bEncDecTø˚E«bÀ
;

1084 
m_pcCuEncodî
->
	`ícodeCtu
–
pCtu
 );

1085 #i‡
ENC_DEC_TRACE


1086 
g_bJu°DoIt
 = 
g_bEncDecTø˚DißbÀ
;

1090 i‡–
˘uXPosInCtus
 =
tûeXPosInCtus
+1 && 
wave‰⁄tsE«bÀd
)

1092 
m_íå›yCodögSyncC⁄ãxtSèã
.
	`lﬂdC⁄ãxts
–
m_pcSbacCodî
 );

1096 i‡(
˘uTsAddr
+1 =
boundögCtuTsAddr
 ||

1097 –
˘uXPosInCtus
 + 1 =
tûeXPosInCtus
 + 
cuºítTûe
.
	`gëTûeWidthInCtus
() &&

1098 –
˘uYPosInCtus
 + 1 =
tûeYPosInCtus
 + 
cuºítTûe
.
	`gëTûeHeightInCtus
(Ë|| 
wave‰⁄tsE«bÀd
)

1102 
m_pcE¡r›yCodî
->
	`ícodeTîmö©ögBô
(1);

1103 
m_pcE¡r›yCodî
->
	`ícodeSli˚Föish
();

1105 
pcSub°ªams
[
uiSubSåm
].
	`wrôeByãAlignmít
();

1108 i‡(
˘uTsAddr
+1 !
boundögCtuTsAddr
)

1110 
pcSli˚
->
	`addSub°ªamSize
–(
pcSub°ªams
[
uiSubSåm
].
	`gëNumbîOfWrôãnBôs
(Ë>> 3Ë+ÖcSub°ªams[uiSubSåm].
	`cou¡SèπCodeEmuœti⁄s
() );

1115 if–
dïSli˚SegmítsE«bÀd
 )

1117 
m_œ°Sli˚SegmítEndC⁄ãxtSèã
.
	`lﬂdC⁄ãxts
–
m_pcSbacCodî
 );

1120 #i‡
ADAPTIVE_QP_SELECTION


1121 if–
m_pcCfg
->
	`gëU£Ad≠tQpSñe˘
() )

1123 
m_pcTrQu™t
->
	`°‹eSli˚QpNext
(
pcSli˚
);

1127 i‡(
pcSli˚
->
	`gëPPS
()->
	`gëCabacInôPª£¡Fœg
(Ë&& !pcSli˚->gëPPS()->
	`gëDïídítSli˚SegmítsE«bÀdFœg
())

1129 
m_ícCABACTabÀIdx
 = 
m_pcE¡r›yCodî
->
	`dëîmöeCabacInôIdx
(
pcSli˚
);

1133 
m_ícCABACTabÀIdx
 = 
pcSli˚
->
	`gëSli˚Ty≥
();

1136 
numBösCoded
 = 
m_pcBöCABAC
->
	`gëBösCoded
();

1137 
	}
}

1139 
Void
 
	gTEncSli˚
::
	$ˇlcuœãBoundögCtuTsAddrF‹Sli˚
(
UI¡
 &
°¨tCtuTSAddrSli˚
, UI¡ &
boundögCtuTSAddrSli˚
, 
Boﬁ
 &
haveRóchedTûeBound¨y
,

1140 
TComPic
* 
pcPic
, c⁄° 
I¡
 
¶i˚Mode
, c⁄° I¡ 
¶i˚Argumít
)

1142 
TComSli˚
* 
pcSli˚
 = 
pcPic
->
	`gëSli˚
(
	`gëSli˚Idx
());

1143 c⁄° 
UI¡
 
numbîOfCtusInFøme
 = 
pcPic
->
	`gëNumbîOfCtusInFøme
();

1144 c⁄° 
TComPPS
 &
µs
=*(
pcSli˚
->
	`gëPPS
());

1145 
boundögCtuTSAddrSli˚
=0;

1146 
haveRóchedTûeBound¨y
=
Ál£
;

1148 
¶i˚Mode
)

1150 
FIXED_NUMBER_OF_CTU
:

1152 
UI¡
 
˘uAddrIn¸emít
 = 
¶i˚Argumít
;

1153 
boundögCtuTSAddrSli˚
 = ((
°¨tCtuTSAddrSli˚
 + 
˘uAddrIn¸emít
Ë< 
numbîOfCtusInFøme
) ? (startCtuTSAddrSlice + ctuAddrIncrement) :ÇumberOfCtusInFrame;

1156 
FIXED_NUMBER_OF_BYTES
:

1157 
boundögCtuTSAddrSli˚
 = 
numbîOfCtusInFøme
;

1159 
FIXED_NUMBER_OF_TILES
:

1161 c⁄° 
UI¡
 
tûeIdx
 = 
pcPic
->
	`gëPicSym
()->
	`gëTûeIdxM≠
–pcPic->gëPicSym()->
	`gëCtuTsToRsAddrM≠
(
°¨tCtuTSAddrSli˚
) );

1162 c⁄° 
UI¡
 
tûeTŸÆCou¡
 = (
pcPic
->
	`gëPicSym
()->
	`gëNumTûeCﬁumnsMöus1
()+1Ë* (pcPic->gëPicSym()->
	`gëNumTûeRowsMöus1
()+1);

1163 
UI¡
 
˘uAddrIn¸emít
 = 0;

1165 
UI¡
 
tûeIdxIn¸emít
 = 0;ÅûeIdxIn¸emíà< 
¶i˚Argumít
;ÅileIdxIncrement++)

1167 if((
tûeIdx
 + 
tûeIdxIn¸emít
Ë< 
tûeTŸÆCou¡
)

1169 
UI¡
 
tûeWidthInCtus
 = 
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
(
tûeIdx
 + 
tûeIdxIn¸emít
)->
	`gëTûeWidthInCtus
();

1170 
UI¡
 
tûeHeightInCtus
 = 
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
(
tûeIdx
 + 
tûeIdxIn¸emít
)->
	`gëTûeHeightInCtus
();

1171 
˘uAddrIn¸emít
 +(
tûeWidthInCtus
 * 
tûeHeightInCtus
);

1175 
boundögCtuTSAddrSli˚
 = ((
°¨tCtuTSAddrSli˚
 + 
˘uAddrIn¸emít
Ë< 
numbîOfCtusInFøme
) ? (startCtuTSAddrSlice + ctuAddrIncrement) :ÇumberOfCtusInFrame;

1179 
boundögCtuTSAddrSli˚
 = 
numbîOfCtusInFøme
;

1184 c⁄° 
Boﬁ
 
wave‰⁄tsAªE«bÀd
 = 
µs
.
	`gëE¡r›yCodögSyncE«bÀdFœg
();

1186 i‡((
¶i˚Mode
 =
FIXED_NUMBER_OF_CTU
 || sli˚Modê=
FIXED_NUMBER_OF_BYTES
) &&

1187 (
µs
.
	`gëNumTûeRowsMöus1
(Ë> 0 ||Öps.
	`gëNumTûeCﬁumnsMöus1
() > 0))

1189 c⁄° 
UI¡
 
˘uRSAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuTsToRsAddrM≠
(
°¨tCtuTSAddrSli˚
);

1190 c⁄° 
UI¡
 
°¨tTûeIdx
 = 
pcPic
->
	`gëPicSym
()->
	`gëTûeIdxM≠
(
˘uRSAddr
);

1192 c⁄° 
TComTûe
 *
pSèπögTûe
 = 
pcPic
->
	`gëPicSym
()->
	`gëTComTûe
(
°¨tTûeIdx
);

1193 c⁄° 
UI¡
 
tûeSèπTsAddr
 = 
pcPic
->
	`gëPicSym
()->
	`gëCtuRsToTsAddrM≠
(
pSèπögTûe
->
	`gëFú°CtuRsAddr
());

1194 c⁄° 
UI¡
 
tûeSèπWidth
 = 
pSèπögTûe
->
	`gëTûeWidthInCtus
();

1195 c⁄° 
UI¡
 
tûeSèπHeight
 = 
pSèπögTûe
->
	`gëTûeHeightInCtus
();

1196 c⁄° 
UI¡
 
tûeLa°TsAddr_ex˛
 = 
tûeSèπTsAddr
 + 
tûeSèπWidth
*
tûeSèπHeight
;

1197 c⁄° 
UI¡
 
tûeBoundögCtuTsAddrSli˚
 = 
tûeLa°TsAddr_ex˛
;

1199 c⁄° 
UI¡
 
˘uCﬁumnOfSèπögTûe
 = ((
°¨tCtuTSAddrSli˚
-
tûeSèπTsAddr
)%
tûeSèπWidth
);

1200 i‡(
wave‰⁄tsAªE«bÀd
 && 
˘uCﬁumnOfSèπögTûe
!=0)

1203 c⁄° 
UI¡
 
numbîOfCTUsToEndOfRow
 = 
tûeSèπWidth
 - 
˘uCﬁumnOfSèπögTûe
;

1204 c⁄° 
UI¡
 
wave‰⁄tTûeBoundögCtuAddrSli˚
 = 
°¨tCtuTSAddrSli˚
 + 
numbîOfCTUsToEndOfRow
;

1205 i‡(
wave‰⁄tTûeBoundögCtuAddrSli˚
 < 
boundögCtuTSAddrSli˚
)

1207 
boundögCtuTSAddrSli˚
 = 
wave‰⁄tTûeBoundögCtuAddrSli˚
;

1211 i‡(
tûeBoundögCtuTsAddrSli˚
 < 
boundögCtuTSAddrSli˚
)

1213 
boundögCtuTSAddrSli˚
 = 
tûeBoundögCtuTsAddrSli˚
;

1214 
haveRóchedTûeBound¨y
 = 
åue
;

1217 i‡((
¶i˚Mode
 =
FIXED_NUMBER_OF_CTU
 || sli˚Modê=
FIXED_NUMBER_OF_BYTES
Ë&& 
wave‰⁄tsAªE«bÀd
 && ((
°¨tCtuTSAddrSli˚
 % 
pcPic
->
	`gëFømeWidthInCtus
()) != 0))

1221 
boundögCtuTSAddrSli˚
 = 
	`mö
(boundögCtuTSAddrSli˚, 
°¨tCtuTSAddrSli˚
 - (°¨tCtuTSAddrSli˚ % 
pcPic
->
	`gëFømeWidthInCtus
()) + (pcPic->getFrameWidthInCtus()));

1223 
	}
}

1232 
Void
 
	gTEncSli˚
::
	$xDëîmöeSèπAndBoundögCtuTsAddr
 ( 
UI¡
& 
°¨tCtuTsAddr
, UI¡& 
boundögCtuTsAddr
, 
TComPic
* 
pcPic
 )

1234 
TComSli˚
* 
pcSli˚
 = 
pcPic
->
	`gëSli˚
(
	`gëSli˚Idx
());

1237 
UI¡
 
°¨tCtuTsAddrSli˚
 = 
pcSli˚
->
	`gëSli˚CurSèπCtuTsAddr
();

1238 
Boﬁ
 
haveRóchedTûeBound¨ySli˚
 = 
Ál£
;

1239 
UI¡
 
boundögCtuTsAddrSli˚
;

1240 
	`ˇlcuœãBoundögCtuTsAddrF‹Sli˚
(
°¨tCtuTsAddrSli˚
, 
boundögCtuTsAddrSli˚
, 
haveRóchedTûeBound¨ySli˚
, 
pcPic
,

1241 
m_pcCfg
->
	`gëSli˚Mode
(), m_pcCfg->
	`gëSli˚Argumít
());

1242 
pcSli˚
->
	`£tSli˚CurEndCtuTsAddr
–
boundögCtuTsAddrSli˚
 );

1243 
pcSli˚
->
	`£tSli˚CurSèπCtuTsAddr
–
°¨tCtuTsAddrSli˚
 );

1246 
UI¡
 
°¨tCtuTsAddrSli˚Segmít
 = 
pcSli˚
->
	`gëSli˚SegmítCurSèπCtuTsAddr
();

1247 
Boﬁ
 
haveRóchedTûeBound¨ySli˚Segmít
 = 
Ál£
;

1248 
UI¡
 
boundögCtuTsAddrSli˚Segmít
;

1249 
	`ˇlcuœãBoundögCtuTsAddrF‹Sli˚
(
°¨tCtuTsAddrSli˚Segmít
, 
boundögCtuTsAddrSli˚Segmít
, 
haveRóchedTûeBound¨ySli˚Segmít
, 
pcPic
,

1250 
m_pcCfg
->
	`gëSli˚SegmítMode
(), m_pcCfg->
	`gëSli˚SegmítArgumít
());

1251 i‡(
boundögCtuTsAddrSli˚Segmít
>
boundögCtuTsAddrSli˚
)

1253 
boundögCtuTsAddrSli˚Segmít
 = 
boundögCtuTsAddrSli˚
;

1255 
pcSli˚
->
	`£tSli˚SegmítCurEndCtuTsAddr
–
boundögCtuTsAddrSli˚Segmít
 );

1256 
pcSli˚
->
	`£tSli˚SegmítCurSèπCtuTsAddr
(
°¨tCtuTsAddrSli˚Segmít
);

1259 
°¨tCtuTsAddr
 = 
	`max
(
°¨tCtuTsAddrSli˚
 , 
°¨tCtuTsAddrSli˚Segmít
 );

1260 
boundögCtuTsAddr
 = 
boundögCtuTsAddrSli˚Segmít
;

1261 
	}
}

1263 
DoubÀ
 
	gTEncSli˚
::
	$xGëQPVÆueAcc‹dögToLambda
 ( 
DoubÀ
 
œmbda
 )

1265  4.2005*
	`log
(
œmbda
) + 13.7122;

1266 
	}
}

	@TLibEncoder/TEncSlice.h

38 #i‚de‡
__TENCSLICE__


39 
	#__TENCSLICE__


	)

42 
	~"TLibComm⁄/Comm⁄Def.h
"

43 
	~"TLibComm⁄/TComLi°.h
"

44 
	~"TLibComm⁄/TComPic.h
"

45 
	~"TLibComm⁄/TComPicYuv.h
"

46 
	~"TEncCu.h
"

47 
	~"WeightPªdA«lysis.h
"

48 
	~"TEncR©eCål.h
"

53 
˛ass
 
	gTEncT›
;

54 
˛ass
 
	gTEncGOP
;

61 ˛as†
	cTEncSli˚


62 : 
public
 
WeightPªdA«lysis


64 
¥iv©e
:

66 
TEncCfg
* 
m_pcCfg
;

69 
	mTComLi°
<
	mTComPic
*>* 
	mm_pcLi°Pic
;

70 
TComPicYuv
 
	mm_picYuvPªd
;

71 
TComPicYuv
 
	mm_picYuvResi
;

74 
TEncGOP
* 
	mm_pcGOPEncodî
;

75 
TEncCu
* 
	mm_pcCuEncodî
;

78 
TEncSórch
* 
	mm_pcPªdSórch
;

81 
TEncE¡r›y
* 
	mm_pcE¡r›yCodî
;

82 
TEncSbac
* 
	mm_pcSbacCodî
;

83 
TEncBöCABAC
* 
	mm_pcBöCABAC
;

84 
TComTrQu™t
* 
	mm_pcTrQu™t
;

87 
TComRdCo°
* 
	mm_pcRdCo°
;

88 
TEncSbac
*** 
	mm_µpcRDSbacCodî
;

89 
TEncSbac
* 
	mm_pcRDGoOnSbacCodî
;

90 
UI¡64
 
	mm_uiPicTŸÆBôs
;

91 
UI¡64
 
	mm_uiPicDi°
;

92 
DoubÀ
 
	mm_dPicRdCo°
;

93 
	m°d
::
ve˘‹
<
DoubÀ
> 
m_vdRdPicLambda
;

94 
	m°d
::
ve˘‹
<
DoubÀ
> 
m_vdRdPicQp
;

95 
	m°d
::
ve˘‹
<
I¡
> 
m_viRdPicQp
;

96 
TEncR©eCål
* 
	mm_pcR©eCål
;

97 
UI¡
 
	mm_uiSli˚Idx
;

98 
TEncSbac
 
	mm_œ°Sli˚SegmítEndC⁄ãxtSèã
;

99 
TEncSbac
 
	mm_íå›yCodögSyncC⁄ãxtSèã
;

100 
Sli˚Ty≥
 
	mm_ícCABACTabÀIdx
;

101 
I¡
 
	mm_g›ID
;

103 
DoubÀ
 
ˇlcuœãLambda
–c⁄° 
TComSli˚
* 
pSli˚
, c⁄° 
I¡
 
GOPid
, c⁄° I¡ 
dïth
, c⁄° DoubÀ 
ªfQP
, c⁄° DoubÀ 
dQP
, I¡ &
iQP
 );

104 
Void
 
£tUpLambda
(
TComSli˚
* 
¶i˚
, c⁄° 
DoubÀ
 
dLambda
, 
I¡
 
iQP
);

105 
Void
 
ˇlcuœãBoundögCtuTsAddrF‹Sli˚
(
UI¡
 &
°¨tCtuTSAddrSli˚
, UI¡ &
boundögCtuTSAddrSli˚
, 
Boﬁ
 &
haveRóchedTûeBound¨y
, 
TComPic
* 
pcPic
, c⁄° 
I¡
 
¶i˚Mode
, c⁄° I¡ 
¶i˚Argumít
);

107 
	mpublic
:

108 
TEncSli˚
();

109 
	mvútuÆ
 ~
TEncSli˚
();

111 
Void
 
¸óã
 ( 
I¡
 
iWidth
, I¡ 
iHeight
, 
ChromaF‹m©
 
chromaF‹m©
, 
UI¡
 
iMaxCUWidth
, UI¡ 
iMaxCUHeight
, 
UCh¨
 
uhTŸÆDïth
 );

112 
Void
 
de°roy
 ();

113 
Void
 
öô
 ( 
TEncT›
* 
pcEncT›
 );

114 
Void
 
	$ª£tEncodîDecisi⁄s
(Ë{ 
m_ícCABACTabÀIdx
 = 
I_SLICE
; }

117 
Void
 
	`öôEncSli˚
 ( 
TComPic
* 
pcPic
, c⁄° 
I¡
 
pocLa°
, c⁄° I¡ 
pocCuº
,

118 c⁄° 
I¡
 
iGOPid
, 
TComSli˚
*& 
ΩcSli˚
, c⁄° 
Boﬁ
 
isFõld
 );

119 
Void
 
	`ª£tQP
 ( 
TComPic
* 
pic
, 
I¡
 
¶i˚QP
, 
DoubÀ
 
œmbda
 );

120 
Void
 
	$£tG›ID
–
I¡
 
iG›ID
 ) { 
m_g›ID
 = iG›ID; 
	}
}

121 
I¡
 
	$gëG›ID
(Ëc⁄° {  
m_g›ID
; 
	}
}

122 
Void
 
upd©eLambda
(
TComSli˚
* 
pSli˚
, 
DoubÀ
 
dQP
);

125 
Void
 
¥ecom¥essSli˚
 ( 
TComPic
* 
pcPic
 );

126 
Void
 
com¥essSli˚
 ( 
TComPic
* 
pcPic
, c⁄° 
Boﬁ
 
bCom¥essE¡úeSli˚
, c⁄° Boﬁ 
bFa°DñèQP
 );

127 
Void
 
ˇlCo°Sli˚I
 ( 
TComPic
* 
pcPic
 );

128 
Void
 
ícodeSli˚
 ( 
TComPic
* 
pcPic
, 
TComOuçutBô°ªam
* 
pcSub°ªams
, 
UI¡
 &
numBösCoded
 );

131 
Void
 
£tSórchR™ge
 ( 
TComSli˚
* 
pcSli˚
 );

133 
TEncCu
* 
	$gëCUEncodî
(Ë{  
m_pcCuEncodî
; 
	}
}

134 
Void
 
xDëîmöeSèπAndBoundögCtuTsAddr
 ( 
UI¡
& 
°¨tCtuTsAddr
, UI¡& 
boundögCtuTsAddr
, 
TComPic
* 
pcPic
 );

135 
UI¡
 
	$gëSli˚Idx
(Ë{  
m_uiSli˚Idx
; 
	}
}

136 
Void
 
	$£tSli˚Idx
(
UI¡
 
i
Ë{ 
m_uiSli˚Idx
 = i; 
	}
}

138 
Sli˚Ty≥
 
	$gëEncCABACTabÀIdx
(Ëc⁄° {  
m_ícCABACTabÀIdx
; 
	}
}

140 
	g¥iv©e
:

141 
DoubÀ
 
xGëQPVÆueAcc‹dögToLambda
 ( DoubÀ 
œmbda
 );

	@TLibEncoder/TEncTemporalFilter.cpp

37 
	~"TEncTemp‹ÆFûãr.h
"

38 
	~<m©h.h
>

45 c⁄° 
I¡
 
	gTEncTemp‹ÆFûãr
::
s_ønge
 = 2;

46 c⁄° 
DoubÀ
 
	gTEncTemp‹ÆFûãr
::
s_chromaFa˘‹
 = 0.55;

47 c⁄° 
DoubÀ
 
	gTEncTemp‹ÆFûãr
::
s_sigmaMu…ùlõr
 = 9.0;

48 c⁄° 
DoubÀ
 
	gTEncTemp‹ÆFûãr
::
s_sigmaZîoPoöt
 = 10.0;

49 c⁄° 
I¡
 
	gTEncTemp‹ÆFûãr
::
s_mŸi⁄Ve˘‹Fa˘‹
 = 16;

50 c⁄° 
I¡
 
	gTEncTemp‹ÆFûãr
::
s_∑ddög
 = 128;

51 c⁄° 
I¡
 
	gTEncTemp‹ÆFûãr
::
s_öãΩﬁ©i⁄Fûãr
[16][8] =

71 c⁄° 
DoubÀ
 
	gTEncTemp‹ÆFûãr
::
s_ªfSåígths
[3][2] =

79 
	gTEncTemp‹ÆFûãr
::
	$TEncTemp‹ÆFûãr
() :

80 
	`m_FømeSkù
(0),

81 
	`m_chromaF‹m©IDC
(
NUM_CHROMA_FORMAT
),

82 
	`m_sour˚Width
(0),

83 
	`m_sour˚Height
(0),

84 
	`m_QP
(0),

85 
	`m_GOPSize
(0),

86 
	`m_‰amesToBeEncoded
(0),

87 
	`m_bClùI≈utVideoToRec709R™ge
(
Ál£
),

88 
	$m_öputCﬁourS∑˚C⁄vît
(
NUMBER_INPUT_COLOUR_SPACE_CONVERSIONS
)

89 {
	}
}

91 
	gTEncTemp‹ÆFûãr
::
öô
(c⁄° 
I¡
 
‰ameSkù
,

92 c⁄° 
I¡
 
öputBôDïth
[
MAX_NUM_CHANNEL_TYPE
],

93 c⁄° 
I¡
 
MSBExãndedBôDïth
[
MAX_NUM_CHANNEL_TYPE
],

94 c⁄° 
I¡
 
öã∫ÆBôDïth
[
MAX_NUM_CHANNEL_TYPE
],

95 c⁄° 
I¡
 
width
,

96 c⁄° 
I¡
 
height
,

97 c⁄° 
I¡
 *
∑d
,

98 c⁄° 
I¡
 
‰ames
,

99 c⁄° 
Boﬁ
 
Rec709
,

100 c⁄° 
°d
::
°rög
 &
fûíame
,

101 c⁄° 
ChromaF‹m©
 
öputChromaF‹m©IDC
,

102 c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
cﬁ‹S∑˚C⁄v
,

103 c⁄° 
I¡
 
QP
,

104 c⁄° 
I¡
 
GOPSize
,

105 c⁄° 
°d
::
m≠
<
I¡
, 
DoubÀ
> &
ãmp‹ÆFûãrSåígths
,

106 c⁄° 
Boﬁ
 
g›Ba£dTemp‹ÆFûãrFutuªRe„ªn˚
)

108 
	gm_FømeSkù
 = 
‰ameSkù
;

109 
I¡
 
	gi
 = 0; i < 
	gMAX_NUM_CHANNEL_TYPE
; i++)

111 
	gm_öputBôDïth
[
i
] = 
öputBôDïth
[i];

112 
	gm_MSBExãndedBôDïth
[
i
] = 
MSBExãndedBôDïth
[i];

113 
	gm_öã∫ÆBôDïth
[
i
] = 
öã∫ÆBôDïth
[i];

116 
	gm_sour˚Width
 = 
width
;

117 
	gm_sour˚Height
 = 
height
;

118 
I¡
 
	gi
 = 0; i < 2; i++)

120 
	gm_aiPad
[
i
] = 
∑d
[i];

122 
	gm_‰amesToBeEncoded
 = 
‰ames
;

123 
	gm_bClùI≈utVideoToRec709R™ge
 = 
Rec709
;

124 
	gm_öputFûeName
 = 
fûíame
;

125 
	gm_chromaF‹m©IDC
 = 
öputChromaF‹m©IDC
;

126 
	gm_öputCﬁourS∑˚C⁄vît
 = 
cﬁ‹S∑˚C⁄v
;

127 
	gm_QP
 = 
QP
;

128 
	gm_GOPSize
 = 
GOPSize
;

129 
	gm_ãmp‹ÆFûãrSåígths
 = 
ãmp‹ÆFûãrSåígths
;

130 
	gm_g›Ba£dTemp‹ÆFûãrFutuªRe„ªn˚
 = 
g›Ba£dTemp‹ÆFûãrFutuªRe„ªn˚
;

137 
Boﬁ
 
	gTEncTemp‹ÆFûãr
::
	$fûãr
(
TComPicYuv
 *
‹gPic
, 
I¡
 
ª˚ivedPoc
)

139 
Boﬁ
 
isFûãrThisFøme
 = 
Ál£
;

140 i‡(
m_QP
 >= 17)

142 
m≠
<
I¡
, 
DoubÀ
>::
ôî©‹
 
ô
 = 
m_ãmp‹ÆFûãrSåígths
.
	`begö
(); ià!m_ãmp‹ÆFûãrSåígths.
	`íd
(); ++it)

144 
I¡
 
fûãªdFøme
 = 
ô
->
fú°
;

145 i‡(
ª˚ivedPoc
 % 
fûãªdFøme
 == 0)

147 
isFûãrThisFøme
 = 
åue
;

153 i‡(
isFûãrThisFøme
)

155 
I¡
 
off£t
 = 
m_FømeSkù
;

156 
TVideoIOYuv
 
yuvFømes
;

157 
yuvFømes
.
	`›í
(
m_öputFûeName
, 
Ál£
, 
m_öputBôDïth
, 
m_MSBExãndedBôDïth
, 
m_öã∫ÆBôDïth
);

158 
yuvFømes
.
	`skùFømes
(
°d
::
	`max
(
off£t
 + 
ª˚ivedPoc
 - 
s_ønge
, 0), 
m_sour˚Width
 - 
m_aiPad
[0], 
m_sour˚Height
 - m_aiPad[1], 
m_chromaF‹m©IDC
);

161 
°d
::
deque
<
Temp‹ÆFûãrSour˚PicInfo
> 
§cFømeInfo
;

163 
I¡
 
fú°Føme
 = 
ª˚ivedPoc
 + 
off£t
 - 
s_ønge
;

164 
I¡
 
œ°Føme
 = 
ª˚ivedPoc
 + 
off£t
 + 
s_ønge
;

165 i‡(!
m_g›Ba£dTemp‹ÆFûãrFutuªRe„ªn˚
)

167 
œ°Føme
 = 
ª˚ivedPoc
 + 
off£t
 - 1;

169 
I¡
 
‹igOff£t
 = -
s_ønge
;

172 
TComPicYuv
 
‹igPadded
;

174 
‹igPadded
.
	`¸óãWôhoutCUInfo
(
m_sour˚Width
, 
m_sour˚Height
, 
m_chromaF‹m©IDC
, 
åue
, 
s_∑ddög
, s_padding);

175 
‹gPic
->
	`c›yToPic
(&
‹igPadded
);

176 
‹igPadded
.
	`exãndPicB‹dî
();

178 
TComPicYuv
 
‹igSubßm∂ed2
;

179 
TComPicYuv
 
‹igSubßm∂ed4
;

181 
	`subßm∂eLuma
(
‹igPadded
, 
‹igSubßm∂ed2
);

182 
	`subßm∂eLuma
(
‹igSubßm∂ed2
, 
‹igSubßm∂ed4
);

185 
I¡
 
poc
 = 
fú°Føme
;Öo¯<
œ°Føme
;Öoc++)

187 i‡(
poc
 < 0)

189 
‹igOff£t
++;

192 i‡(
poc
 =
off£t
 + 
ª˚ivedPoc
)

194 
yuvFømes
.
	`skùFømes
(1, 
m_sour˚Width
 - 
m_aiPad
[0], 
m_sour˚Height
 - m_aiPad[1], 
m_chromaF‹m©IDC
);

195 
‹igOff£t
++;

198 
§cFømeInfo
.
	`push_back
(
	`Temp‹ÆFûãrSour˚PicInfo
());

199 
Temp‹ÆFûãrSour˚PicInfo
 &
§cPic
=
§cFømeInfo
.
	`back
();

201 
TComPicYuv
 
dummyPicBuf„rTO
;

202 
§cPic
.
picBuf„r
.
	`¸óãWôhoutCUInfo
(
m_sour˚Width
, 
m_sour˚Height
, 
m_chromaF‹m©IDC
, 
åue
, 
s_∑ddög
, s_padding);

203 
dummyPicBuf„rTO
.
	`¸óãWôhoutCUInfo
(
m_sour˚Width
, 
m_sour˚Height
, 
m_chromaF‹m©IDC
, 
åue
, 
s_∑ddög
, s_padding);

204 i‡(!
yuvFømes
.
	`ªad
(&
§cPic
.
picBuf„r
, &
dummyPicBuf„rTO
, 
m_öputCﬁourS∑˚C⁄vît
, 
m_aiPad
, 
m_chromaF‹m©IDC
, 
m_bClùI≈utVideoToRec709R™ge
))

206  
Ál£
;

208 
§cPic
.
picBuf„r
.
	`exãndPicB‹dî
();

209 
§cPic
.
mvs
.
	`Æloˇã
(
m_sour˚Width
 / 4, 
m_sour˚Height
 / 4);

211 
	`mŸi⁄E°im©i⁄
(
§cPic
.
mvs
, 
‹igPadded
, srcPic.
picBuf„r
, 
‹igSubßm∂ed2
, 
‹igSubßm∂ed4
);

212 
§cPic
.
‹igOff£t
 = origOffset;

213 
‹igOff£t
++;

217 
TComPicYuv
 
√wOrgPic
;

218 
√wOrgPic
.
	`¸óãWôhoutCUInfo
(
m_sour˚Width
, 
m_sour˚Height
, 
m_chromaF‹m©IDC
, 
åue
, 
s_∑ddög
, s_padding);

219 
DoubÀ
 
ovîÆlSåígth
 = -1.0;

220 
m≠
<
I¡
, 
DoubÀ
>::
ôî©‹
 
ô
 = 
m_ãmp‹ÆFûãrSåígths
.
	`begö
(); ià!m_ãmp‹ÆFûãrSåígths.
	`íd
(); ++it)

222 
I¡
 
‰ame
 = 
ô
->
fú°
;

223 
DoubÀ
 
°ªngth
 = 
ô
->
£c⁄d
;

224 i‡(
ª˚ivedPoc
 % 
‰ame
 == 0)

226 
ovîÆlSåígth
 = 
°ªngth
;

230 
	`bû©îÆFûãr
(
‹igPadded
, 
§cFømeInfo
, 
√wOrgPic
, 
ovîÆlSåígth
);

233 
√wOrgPic
.
	`c›yToPic
(
‹gPic
);

235 
yuvFømes
.
	`˛o£
();

236  
åue
;

238  
Ál£
;

239 
	}
}

245 
Void
 
	gTEncTemp‹ÆFûãr
::
	$subßm∂eLuma
(c⁄° 
TComPicYuv
 &
öput
, TComPicYuv &
ouçut
, c⁄° 
I¡
 
Á˘‹
) const

247 c⁄° 
I¡
 
√wWidth
 = 
öput
.
	`gëWidth
(
COMPONENT_Y
Ë/ 
Á˘‹
;

248 c⁄° 
I¡
 
√wHeight
 = 
öput
.
	`gëHeight
(
COMPONENT_Y
Ë/ 
Á˘‹
;

249 
ouçut
.
	`¸óãWôhoutCUInfo
(
√wWidth
, 
√wHeight
, 
öput
.
	`gëChromaF‹m©
(), 
åue
, 
s_∑ddög
, s_padding);

251 c⁄° 
Pñ
* 
§cRow
 =
öput
.
	`gëAddr
(
COMPONENT_Y
);

252 c⁄° 
UI¡
 
§cSåide
=
öput
.
	`gëSåide
(
COMPONENT_Y
);

253 
Pñ
 *
d°Row
 =
ouçut
.
	`gëAddr
(
COMPONENT_Y
);

254 c⁄° 
UI¡
 
d°Såide
=
ouçut
.
	`gëSåide
(
COMPONENT_Y
);

256 
I¡
 
y
 = 0; y < 
√wHeight
; y++, 
§cRow
+=
Á˘‹
*
§cSåide
, 
d°Row
+=
d°Såide
)

258 c⁄° 
Pñ
 *
öRow
 = 
§cRow
;

259 c⁄° 
Pñ
 *
öRowBñow
 = 
§cRow
+
§cSåide
;

260 
Pñ
 *
èrgë
 = 
d°Row
;

262 
I¡
 
x
 = 0; x < 
√wWidth
; x++)

264 
èrgë
[
x
] = (
öRow
[0] + 
öRowBñow
[0] + inRow[1] + inRowBelow[1] + 2) >> 2;

265 
öRow
 += 2;

266 
öRowBñow
 += 2;

269 
ouçut
.
	`exãndPicB‹dî
();

270 
	}
}

272 
I¡
 
	gTEncTemp‹ÆFûãr
::
	$mŸi⁄Eº‹Luma
(c⁄° 
TComPicYuv
 &
‹ig
,

273 c⁄° 
TComPicYuv
 &
buf„r
,

274 c⁄° 
I¡
 
x
,

275 c⁄° 
I¡
 
y
,

276 
I¡
 
dx
,

277 
I¡
 
dy
,

278 c⁄° 
I¡
 
bs
,

279 c⁄° 
I¡
 
be°îr‹
 = 8 * 8 * 1024 * 1024) const

282 c⁄° 
Pñ
* 
‹igOrigö
 =
‹ig
.
	`gëAddr
(
COMPONENT_Y
);

283 c⁄° 
I¡
 
‹igSåide
 =
‹ig
.
	`gëSåide
(
COMPONENT_Y
);

284 c⁄° 
Pñ
 *
buffOrigö
 =
buf„r
.
	`gëAddr
(
COMPONENT_Y
);

285 c⁄° 
I¡
 
buffSåide
 =
buf„r
.
	`gëSåide
(
COMPONENT_Y
);

286 
I¡
 
îr‹
 = 0;

287 i‡(((
dx
 | 
dy
) & 0xF) == 0)

289 
dx
 /
s_mŸi⁄Ve˘‹Fa˘‹
;

290 
dy
 /
s_mŸi⁄Ve˘‹Fa˘‹
;

291 
I¡
 
y1
 = 0; y1 < 
bs
; y1++)

293 c⁄° 
Pñ
* 
‹igRowSèπ
 = 
‹igOrigö
 + (
y
+
y1
)*
‹igSåide
 + 
x
;

294 c⁄° 
Pñ
* 
buf„rRowSèπ
 = 
buffOrigö
 + (
y
+
y1
+
dy
)*
buffSåide
 + (
x
+
dx
);

295 
I¡
 
x1
 = 0; x1 < 
bs
; x1 += 2)

297 
I¡
 
diff
 = 
‹igRowSèπ
[
x1
] - 
buf„rRowSèπ
[x1];

298 
îr‹
 +
diff
 * diff;

299 
diff
 = 
‹igRowSèπ
[
x1
 + 1] - 
buf„rRowSèπ
[x1 + 1];

300 
îr‹
 +
diff
 * diff;

302 i‡(
îr‹
 > 
be°îr‹
)

304  
îr‹
;

310 c⁄° 
I¡
 *
xFûãr
 = 
s_öãΩﬁ©i⁄Fûãr
[
dx
 & 0xF];

311 c⁄° 
I¡
 *
yFûãr
 = 
s_öãΩﬁ©i⁄Fûãr
[
dy
 & 0xF];

312 
I¡
 
ãmpAºay
[64 + 8][64];

314 
I¡
 
iSum
, 
iBa£
;

315 
I¡
 
y1
 = 1; y1 < 
bs
 + 7; y1++)

317 c⁄° 
I¡
 
yOff£t
 = 
y
 + 
y1
 + (
dy
 >> 4) - 3;

318 c⁄° 
Pñ
 *
sour˚Row
 = 
buffOrigö
 + (
yOff£t
)*
buffSåide
 + 0;

319 
I¡
 
x1
 = 0; x1 < 
bs
; x1++)

321 
iSum
 = 0;

322 
iBa£
 = 
x
 + 
x1
 + (
dx
 >> 4) - 3;

323 c⁄° 
Pñ
 *
rowSèπ
 = 
sour˚Row
 + 
iBa£
;

325 
iSum
 +
xFûãr
[1] * 
rowSèπ
[1];

326 
iSum
 +
xFûãr
[2] * 
rowSèπ
[2];

327 
iSum
 +
xFûãr
[3] * 
rowSèπ
[3];

328 
iSum
 +
xFûãr
[4] * 
rowSèπ
[4];

329 
iSum
 +
xFûãr
[5] * 
rowSèπ
[5];

330 
iSum
 +
xFûãr
[6] * 
rowSèπ
[6];

332 
ãmpAºay
[
y1
][
x1
] = 
iSum
;

336 c⁄° 
Pñ
 
maxSam∂eVÆue
 = (1<<
m_öã∫ÆBôDïth
[
CHANNEL_TYPE_LUMA
])-1;

337 
I¡
 
y1
 = 0; y1 < 
bs
; y1++)

339 c⁄° 
Pñ
 *
‹igRow
 = 
‹igOrigö
 + (
y
+
y1
)*
‹igSåide
 + 0;

340 
I¡
 
x1
 = 0; x1 < 
bs
; x1++)

342 
iSum
 = 0;

343 
iSum
 +
yFûãr
[1] * 
ãmpAºay
[
y1
 + 1][
x1
];

344 
iSum
 +
yFûãr
[2] * 
ãmpAºay
[
y1
 + 2][
x1
];

345 
iSum
 +
yFûãr
[3] * 
ãmpAºay
[
y1
 + 3][
x1
];

346 
iSum
 +
yFûãr
[4] * 
ãmpAºay
[
y1
 + 4][
x1
];

347 
iSum
 +
yFûãr
[5] * 
ãmpAºay
[
y1
 + 5][
x1
];

348 
iSum
 +
yFûãr
[6] * 
ãmpAºay
[
y1
 + 6][
x1
];

350 
iSum
 = (iSum + (1 << 11)) >> 12;

351 
iSum
 = iSum < 0 ? 0 : (iSum > 
maxSam∂eVÆue
 ? maxSampleValue : iSum);

353 
îr‹
 +(
iSum
 - 
‹igRow
[
x
 + 
x1
]) * (iSum - origRow[x + x1]);

355 i‡(
îr‹
 > 
be°îr‹
)

357  
îr‹
;

361  
îr‹
;

362 
	}
}

364 
Void
 
	gTEncTemp‹ÆFûãr
::
mŸi⁄E°im©i⁄Luma
(
Aºay2D
<
MŸi⁄Ve˘‹
> &
mvs
, c⁄° 
TComPicYuv
 &
‹ig
, c⁄° TComPicYuv &
buf„r
, c⁄° 
I¡
 
blockSize
,

365 c⁄° 
Aºay2D
<
MŸi⁄Ve˘‹
> *
¥evious
, c⁄° 
I¡
 
Á˘‹
, c⁄° 
Boﬁ
 
doubÀRes
) const

367 
I¡
 
	gønge
 = 5;

368 c⁄° 
I¡
 
	g°ïSize
 = 
blockSize
;

370 c⁄° 
I¡
 
	g‹igWidth
 = 
‹ig
.
gëWidth
(
COMPONENT_Y
);

371 c⁄° 
I¡
 
	g‹igHeight
 = 
‹ig
.
gëHeight
(
COMPONENT_Y
);

373 
I¡
 
	gblockY
 = 0; blockY + 
	gblockSize
 < 
	g‹igHeight
; blockY +
°ïSize
)

375 
I¡
 
blockX
 = 0; 
	gblockX
 + 
	gblockSize
 < 
	g‹igWidth
; blockX +
°ïSize
)

377 
MŸi⁄Ve˘‹
 
be°
;

379 i‡(
	g¥evious
 =
NULL
)

381 
ønge
 = 8;

385 
I¡
 
	gpy
 = -2;Öy <= 2;Öy++)

387 
I¡
 
	gã°y
 = 
blockY
 / (2 * 
blockSize
Ë+ 
py
;

388 
I¡
 
	gpx
 = -2;Öx <= 2;Öx++)

390 
I¡
 
	gã°x
 = 
blockX
 / (2 * 
blockSize
Ë+ 
px
;

391 i‡((
	gã°x
 >0Ë&& (
ã°x
 < 
‹igWidth
 / (2 * 
blockSize
)Ë&& (
ã°y
 >0Ë&& (ã°y < 
‹igHeight
 / (2 * blockSize)))

393 
MŸi⁄Ve˘‹
 
ﬁd
 = 
¥evious
->
gë
(
ã°x
, 
ã°y
);

394 
I¡
 
	gîr‹
 = 
mŸi⁄Eº‹Luma
(
‹ig
, 
buf„r
, 
blockX
, 
blockY
, 
ﬁd
.
x
 * 
Á˘‹
, old.
y
 * fa˘‹, 
blockSize
, 
be°
.
îr‹
);

395 i‡(
	gîr‹
 < 
	gbe°
.error)

397 
	gbe°
.
£t
(
ﬁd
.
x
 * 
Á˘‹
, old.
y
 * fa˘‹, 
îr‹
);

403 
MŸi⁄Ve˘‹
 
	g¥evBe°
 = 
be°
;

404 
I¡
 
	gy2
 = 
¥evBe°
.
y
 / 
s_mŸi⁄Ve˘‹Fa˘‹
 - 
ønge
; y2 <=ÖrevBest.y / s_motionVectorFactor +Ñange; y2++)

406 
I¡
 
	gx2
 = 
¥evBe°
.
x
 / 
s_mŸi⁄Ve˘‹Fa˘‹
 - 
ønge
; x2 <=ÖrevBest.x / s_motionVectorFactor +Ñange; x2++)

408 
I¡
 
	gîr‹
 = 
mŸi⁄Eº‹Luma
(
‹ig
, 
buf„r
, 
blockX
, 
blockY
, 
x2
 * 
s_mŸi⁄Ve˘‹Fa˘‹
, 
y2
 * s_mŸi⁄Ve˘‹Fa˘‹, 
blockSize
, 
be°
.
îr‹
);

409 i‡(
	gîr‹
 < 
	gbe°
.error)

411 
	gbe°
.
£t
(
x2
 * 
s_mŸi⁄Ve˘‹Fa˘‹
, 
y2
 * s_mŸi⁄Ve˘‹Fa˘‹, 
îr‹
);

415 i‡(
	gdoubÀRes
)

417 
	g¥evBe°
 = 
be°
;

418 
I¡
 
	gdoubÀR™ge
 = 3 * 4;

419 
I¡
 
	gy2
 = 
¥evBe°
.
y
 - 
doubÀR™ge
; y2 <=ÖrevBest.y + doubleRange; y2 += 4)

421 
I¡
 
x2
 = 
¥evBe°
.
x
 - 
doubÀR™ge
; 
	gx2
 <=ÖrevBest.x + doubleRange; x2 += 4)

423 
I¡
 
îr‹
 = 
mŸi⁄Eº‹Luma
(
‹ig
, 
buf„r
, 
blockX
, 
blockY
, 
x2
, 
y2
, 
blockSize
, 
be°
.error);

424 i‡(
	gîr‹
 < 
	gbe°
.error)

426 
	gbe°
.
£t
(
x2
, 
y2
, 
îr‹
);

432 
	g¥evBe°
 = 
be°
;

433 
	gdoubÀR™ge
 = 3;

434 
I¡
 
	gy2
 = 
¥evBe°
.
y
 - 
doubÀR™ge
; y2 <=ÖrevBest.y + doubleRange; y2++)

436 
I¡
 
	gx2
 = 
¥evBe°
.
x
 - 
doubÀR™ge
; x2 <=ÖrevBest.x + doubleRange; x2++)

438 
I¡
 
	gîr‹
 = 
mŸi⁄Eº‹Luma
(
‹ig
, 
buf„r
, 
blockX
, 
blockY
, 
x2
, 
y2
, 
blockSize
, 
be°
.
îr‹
);

439 i‡(
	gîr‹
 < 
	gbe°
.error)

441 
	gbe°
.
£t
(
x2
, 
y2
, 
îr‹
);

448 
	gmvs
.
gë
(
blockX
 / 
°ïSize
, 
blockY
 / sãpSizeË
be°
;

453 
Void
 
	gTEncTemp‹ÆFûãr
::
mŸi⁄E°im©i⁄
(
Aºay2D
<
MŸi⁄Ve˘‹
> &
mv
, c⁄° 
TComPicYuv
 &
‹gPic
, c⁄° TComPicYuv &
buf„r
, c⁄° TComPicYuv &
‹igSubßm∂ed2
, c⁄° TComPicYuv &
‹igSubßm∂ed4
) const

455 c⁄° 
I¡
 
	gwidth
 = 
m_sour˚Width
;

456 c⁄° 
I¡
 
	gheight
 = 
m_sour˚Height
;

457 
	gAºay2D
<
	gMŸi⁄Ve˘‹
> 
mv_0
(
width
 / 16, 
height
 / 16);

458 
	gAºay2D
<
	gMŸi⁄Ve˘‹
> 
mv_1
(
width
 / 16, 
height
 / 16);

459 
	gAºay2D
<
	gMŸi⁄Ve˘‹
> 
mv_2
(
width
 / 16, 
height
 / 16);

461 
TComPicYuv
 
	gbuf„rSub2
;

462 
TComPicYuv
 
	gbuf„rSub4
;

464 
subßm∂eLuma
(
buf„r
, 
buf„rSub2
);

465 
subßm∂eLuma
(
buf„rSub2
, 
buf„rSub4
);

467 
mŸi⁄E°im©i⁄Luma
(
mv_0
, 
‹igSubßm∂ed4
, 
buf„rSub4
, 16);

468 
mŸi⁄E°im©i⁄Luma
(
mv_1
, 
‹igSubßm∂ed2
, 
buf„rSub2
, 16, &
mv_0
, 2);

469 
mŸi⁄E°im©i⁄Luma
(
mv_2
, 
‹gPic
, 
buf„r
, 16, &
mv_1
, 2);

471 
mŸi⁄E°im©i⁄Luma
(
mv
, 
‹gPic
, 
buf„r
, 8, &
mv_2
, 1, 
åue
);

474 
Void
 
	gTEncTemp‹ÆFûãr
::
≠∂yMŸi⁄
(c⁄° 
Aºay2D
<
MŸi⁄Ve˘‹
> &
mvs
, c⁄° 
TComPicYuv
 &
öput
, TComPicYuv &
ouçut
) const

476 c⁄° 
I¡
 
	glumaBlockSize
=8;

478 
I¡
 
	gc
=0; c< 
gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
); c++)

480 c⁄° 
Comp⁄ítID
 
	gcompID
=(Comp⁄ítID)
c
;

481 c⁄° 
I¡
 
	gcsx
=
gëComp⁄ítSˇÀX
(
compID
, 
m_chromaF‹m©IDC
);

482 c⁄° 
I¡
 
	gcsy
=
gëComp⁄ítSˇÀY
(
compID
, 
m_chromaF‹m©IDC
);

483 c⁄° 
I¡
 
	gblockSizeX
 = 
lumaBlockSize
>>
csx
;

484 c⁄° 
I¡
 
	gblockSizeY
 = 
lumaBlockSize
>>
csy
;

485 c⁄° 
I¡
 
	gheight
 = 
öput
.
gëHeight
(
compID
);

486 c⁄° 
I¡
 
	gwidth
 = 
öput
.
gëWidth
(
compID
);

488 c⁄° 
Pñ
 
	gmaxVÆue
 = (1<<
m_öã∫ÆBôDïth
[
toCh™√lTy≥
(
compID
)])-1;

490 c⁄° 
Pñ
 *
	gpSrcImage
=
öput
.
gëAddr
(
compID
);

491 c⁄° 
I¡
 
	g§cSåide
=
öput
.
gëSåide
(
compID
);

493 
Pñ
 *
	gpD°Image
=
ouçut
.
gëAddr
(
compID
);

494 
I¡
 
	gd°Såide
=
ouçut
.
gëSåide
(
compID
);

496 
I¡
 
	gy
 = 0, 
	gblockNumY
 = 0; y + 
	gblockSizeY
 <
height
; y +
blockSizeY
, blockNumY++)

498 
I¡
 
	gx
 = 0, 
	gblockNumX
 = 0; x + 
	gblockSizeX
 <
width
; x +
blockSizeX
, blockNumX++)

500 c⁄° 
	gMŸi⁄Ve˘‹
 &
	gmv
 = 
mvs
.
gë
(
blockNumX
,
blockNumY
);

501 c⁄° 
I¡
 
	gdx
 = 
mv
.
x
 >> 
csx
 ;

502 c⁄° 
I¡
 
	gdy
 = 
mv
.
y
 >> 
csy
 ;

503 c⁄° 
I¡
 
	gxI¡
 = 
mv
.
x
 >> (4+
csx
) ;

504 c⁄° 
I¡
 
	gyI¡
 = 
mv
.
y
 >> (4+
csy
) ;

506 c⁄° 
I¡
 *
	gxFûãr
 = 
s_öãΩﬁ©i⁄Fûãr
[
dx
 & 0xf];

507 c⁄° 
I¡
 *
	gyFûãr
 = 
s_öãΩﬁ©i⁄Fûãr
[
dy
 & 0xf];

508 c⁄° 
I¡
 
	gnumFûãrT≠s
=7;

509 c⁄° 
I¡
 
	g˚¡ªT≠Off£t
=3;

511 
I¡
 
	gãmpAºay
[
lumaBlockSize
 + 
numFûãrT≠s
][lumaBlockSize];

513 
I¡
 
	gby
 = 1; by < 
	gblockSizeY
 + 
	gnumFûãrT≠s
; by++)

515 c⁄° 
I¡
 
	gyOff£t
 = 
y
 + 
by
 + 
yI¡
 - 
˚¡ªT≠Off£t
;

516 c⁄° 
Pñ
 *
	gsour˚Row
 = 
pSrcImage
+
yOff£t
*
§cSåide
;

517 
I¡
 
	gbx
 = 0; bx < 
	gblockSizeX
; bx++)

519 
I¡
 
	giBa£
 = 
x
 + 
bx
 + 
xI¡
 - 
˚¡ªT≠Off£t
;

520 c⁄° 
Pñ
 *
	growSèπ
 = 
sour˚Row
 + 
iBa£
;

522 
I¡
 
	giSum
 = 0;

523 
	giSum
 +
xFûãr
[1] * 
rowSèπ
[1];

524 
	giSum
 +
xFûãr
[2] * 
rowSèπ
[2];

525 
	giSum
 +
xFûãr
[3] * 
rowSèπ
[3];

526 
	giSum
 +
xFûãr
[4] * 
rowSèπ
[4];

527 
	giSum
 +
xFûãr
[5] * 
rowSèπ
[5];

528 
	giSum
 +
xFûãr
[6] * 
rowSèπ
[6];

530 
	gãmpAºay
[
by
][
bx
] = 
iSum
;

534 
Pñ
 *
	gpD°Row
=
pD°Image
+
y
*
d°Såide
;

535 
I¡
 
	gby
 = 0; by < 
	gblockSizeY
; by++, 
	gpD°Row
+=
d°Såide
)

537 
Pñ
 *
pD°Pñ
=
pD°Row
+
x
;

538 
I¡
 
	gbx
 = 0; bx < 
	gblockSizeX
; bx++, 
	gpD°Pñ
++)

540 
I¡
 
	giSum
 = 0;

542 
	giSum
 +
yFûãr
[1] * 
ãmpAºay
[
by
 + 1][
bx
];

543 
	giSum
 +
yFûãr
[2] * 
ãmpAºay
[
by
 + 2][
bx
];

544 
	giSum
 +
yFûãr
[3] * 
ãmpAºay
[
by
 + 3][
bx
];

545 
	giSum
 +
yFûãr
[4] * 
ãmpAºay
[
by
 + 4][
bx
];

546 
	giSum
 +
yFûãr
[5] * 
ãmpAºay
[
by
 + 5][
bx
];

547 
	giSum
 +
yFûãr
[6] * 
ãmpAºay
[
by
 + 6][
bx
];

549 
	giSum
 = (
iSum
 + (1 << 11)) >> 12;

550 
	giSum
 = 
iSum
 < 0 ? 0 : (iSum > 
maxVÆue
 ? maxValue : iSum);

551 *
	gpD°Pñ
 = 
iSum
;

559 
Void
 
	gTEncTemp‹ÆFûãr
::
bû©îÆFûãr
(c⁄° 
TComPicYuv
 &
‹gPic
,

560 c⁄° 
°d
::
deque
<
Temp‹ÆFûãrSour˚PicInfo
> &
§cFømeInfo
,

561 
TComPicYuv
 &
√wOrgPic
,

562 
DoubÀ
 
ovîÆlSåígth
) const

564 c⁄° 
	gnumRefs
 = 
I¡
(
§cFømeInfo
.
size
());

565 
	g°d
::
ve˘‹
<
TComPicYuv
> 
c‹ª˘edPics
(
numRefs
);

566 
I¡
 
	gi
 = 0; i < 
	gnumRefs
; i++)

568 
	gc‹ª˘edPics
[
i
].
¸óãWôhoutCUInfo
–
m_sour˚Width
, 
m_sour˚Height
, 
‹gPic
.
gëChromaF‹m©
(), 
åue
, 
s_∑ddög
, s_padding );

569 
≠∂yMŸi⁄
(
§cFømeInfo
[
i
].
mvs
, srcFømeInfo[i].
picBuf„r
, 
c‹ª˘edPics
[i]);

572 
I¡
 
	gªfSåígthRow
 = 2;

573 i‡(
	gnumRefs
 =
s_ønge
*2)

575 
ªfSåígthRow
 = 0;

577 i‡(
	gnumRefs
 =
s_ønge
)

579 
ªfSåígthRow
 = 1;

582 c⁄° 
DoubÀ
 
	glumaSigmaSq
 = (
m_QP
 - 
s_sigmaZîoPoöt
Ë* (m_QP - s_sigmaZîoPoötË* 
s_sigmaMu…ùlõr
;

583 c⁄° 
DoubÀ
 
	gchromaSigmaSq
 = 30 * 30;

585 
I¡
 
	gc
=0; c< 
gëNumbîVÆidComp⁄íts
(
m_chromaF‹m©IDC
); c++)

587 c⁄° 
Comp⁄ítID
 
	gcompID
=(Comp⁄ítID)
c
;

588 c⁄° 
I¡
 
	gheight
 = 
‹gPic
.
gëHeight
(
compID
);

589 c⁄° 
I¡
 
	gwidth
 = 
‹gPic
.
gëWidth
(
compID
);

590 c⁄° 
Pñ
 *
	g§cPñRow
 = 
‹gPic
.
gëAddr
(
compID
);

591 c⁄° 
I¡
 
	g§cSåide
 = 
‹gPic
.
gëSåide
(
compID
);

592 
Pñ
 *
	gd°PñRow
 = 
√wOrgPic
.
gëAddr
(
compID
);

593 c⁄° 
I¡
 
	gd°Såide
 = 
√wOrgPic
.
gëSåide
(
compID
);

594 c⁄° 
DoubÀ
 
	gsigmaSq
 = 
isChroma
(
compID
)? 
chromaSigmaSq
 : 
lumaSigmaSq
;

595 c⁄° 
DoubÀ
 
	gweightSˇlög
 = 
ovîÆlSåígth
 * (
isChroma
(
compID
Ë? 
s_chromaFa˘‹
 : 0.4);

596 c⁄° 
Pñ
 
	gmaxSam∂eVÆue
 = (1<<
m_öã∫ÆBôDïth
[
toCh™√lTy≥
(
compID
)])-1;

597 c⁄° 
DoubÀ
 
	gbôDïthDiffWeightög
=1024.0 / (
maxSam∂eVÆue
+1);

599 
I¡
 
	gy
 = 0; y < 
	gheight
; y++, 
	g§cPñRow
+=
§cSåide
, 
	gd°PñRow
+=
d°Såide
)

601 c⁄° 
Pñ
 *
§cPñ
=
§cPñRow
;

602 
Pñ
 *
	gd°Pñ
=
d°PñRow
;

603 
I¡
 
	gx
 = 0; x < 
	gwidth
; x++, 
	g§cPñ
++, 
	gd°Pñ
++)

605 c⁄° 
I¡
 
	g‹gVÆ
 = (I¡Ë*
§cPñ
;

606 
DoubÀ
 
	gãmp‹ÆWeightSum
 = 1.0;

607 
DoubÀ
 
	g√wVÆ
 = (DoubÀË
‹gVÆ
;

608 
I¡
 
	gi
 = 0; i < 
	gnumRefs
; i++)

610 c⁄° 
Pñ
 *
	gpC‹ª˘edPñPå
=
c‹ª˘edPics
[
i
].
gëAddr
(
compID
)+(
y
*c‹ª˘edPics[i].
gëSåide
(compID)+
x
);

611 c⁄° 
I¡
 
	gªfVÆ
 = (I¡Ë*
pC‹ª˘edPñPå
;

612 
DoubÀ
 
	gdiff
 = (DoubÀ)(
ªfVÆ
 - 
‹gVÆ
);

613 
	gdiff
 *
bôDïthDiffWeightög
;

614 
DoubÀ
 
	gdiffSq
 = 
diff
 * diff;

615 c⁄° 
I¡
 
	gödex
 = 
°d
::
mö
(1, std::
abs
(
§cFømeInfo
[
i
].
‹igOff£t
) - 1);

616 c⁄° 
DoubÀ
 
	gweight
 = 
weightSˇlög
 * 
s_ªfSåígths
[
ªfSåígthRow
][
ödex
] * 
exp
(-
diffSq
 / (2 * 
sigmaSq
));

617 
	g√wVÆ
 +
weight
 * 
ªfVÆ
;

618 
	gãmp‹ÆWeightSum
 +
weight
;

620 
	g√wVÆ
 /
ãmp‹ÆWeightSum
;

621 
Pñ
 
	gßm∂eVÆ
 = (Pñ)
round
(
√wVÆ
);

622 
	gßm∂eVÆ
=(
ßm∂eVÆ
<0?0 : (ßm∂eVÆ>
maxSam∂eVÆue
 ? maxSampleValue : sampleVal));

623 *
	gd°Pñ
 = 
ßm∂eVÆ
;

	@TLibEncoder/TEncTemporalFilter.h

38 #i‚de‡
__TEMPORAL_FILTER__


39 
	#__TEMPORAL_FILTER__


	)

40 
	~"TLibComm⁄/TComPicYuv.h
"

41 
	~"Utûôõs/TVideoIOYuv.h
"

42 
	~<s°ªam
>

43 
	~<m≠
>

44 
	~<deque
>

49 
	sMŸi⁄Ve˘‹


51 
I¡
 
	mx
, 
	my
;

52 
I¡
 
	mîr‹
;

53 
MŸi⁄Ve˘‹
(Ë: 
x
(0), 
y
(0), 
îr‹
(
INT_LEAST32_MAX
) {}

54 
£t
(
I¡
 
nx
, I¡ 
ny
, I¡ 
√
Ë{ 
	mx
 =Çx; 
	my
 =Çy; 
	mîr‹
 =Çe; }

57 
	gãm∂©e
 <
˛ass
 
	gT
>

58 
	sAºay2D


60 
	m¥iv©e
:

61 
UI¡
 
m_width
, 
	mm_height
;

62 
	m°d
::
ve˘‹
< 
T
 > 
v
;

63 
	mpublic
:

64 
Aºay2D
(Ë: 
m_width
(0), 
m_height
(0), 
v
() { }

65 
Aºay2D
(
UI¡
 
width
, UI¡ 
height
, c⁄° 
T
& 
vÆue
=T()Ë: 
m_width
(0), 
m_height
(0), 
v
(Ë{ 
Æloˇã
(width, height, value); }

67 
Void
 
Æloˇã
(
UI¡
 
width
, UI¡ 
height
, c⁄° 
T
& 
vÆue
=T())

69 
m_width
=
width
;

70 
	mm_height
=
height
;

71 
	mv
.
ªsize
(
°d
::
size_t
(
m_width
*
m_height
), 
vÆue
);

74 
	mT
& 
gë
(
UI¡
 
x
, UI¡ 
y
)

76 
as£π
(
x
<
m_width
 && 
y
<
m_height
);

77  
	mv
[
y
*
m_width
+
x
];

80 c⁄° 
	mT
& 
gë
(
UI¡
 
x
, UI¡ 
y
) const

82 
as£π
(
x
<
m_width
 && 
y
<
m_height
);

83  
	mv
[
y
*
m_width
+
x
];

87 
	sTemp‹ÆFûãrSour˚PicInfo


89 
Temp‹ÆFûãrSour˚PicInfo
(Ë: 
picBuf„r
(), 
mvs
(), 
‹igOff£t
(0) { }

90 
TComPicYuv
 
	mpicBuf„r
;

91 
	mAºay2D
<
	mMŸi⁄Ve˘‹
> 
	mmvs
;

92 
I¡
 
	m‹igOff£t
;

99 ˛as†
	cTEncTemp‹ÆFûãr


101 
	mpublic
:

102 
TEncTemp‹ÆFûãr
();

103 ~
	$TEncTemp‹ÆFûãr
() {}

105 
	`öô
(c⁄° 
I¡
 
‰ameSkù
,

106 c⁄° 
I¡
 
öputBôDïth
[
MAX_NUM_CHANNEL_TYPE
],

107 c⁄° 
I¡
 
MSBExãndedBôDïth
[
MAX_NUM_CHANNEL_TYPE
], c⁄° I¡ 
I¡î«lBôDïth
[MAX_NUM_CHANNEL_TYPE],

108 c⁄° 
I¡
 
width
,

109 c⁄° 
I¡
 
height
,

110 c⁄° 
I¡
 *
∑d
,

111 c⁄° 
I¡
 
‰ames
,

112 c⁄° 
Boﬁ
 
Rec709
,

113 c⁄° 
°d
::
°rög
 &
fûíame
,

114 c⁄° 
ChromaF‹m©
 
öputChromaF‹m©IDC
,

115 c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
cﬁ‹S∑˚C⁄v
,

116 c⁄° 
I¡
 
qp
,

117 c⁄° 
I¡
 
GOPSize
,

118 c⁄° 
°d
::
m≠
<
I¡
, 
DoubÀ
> &
ãmp‹ÆFûãrSåígths
,

119 c⁄° 
Boﬁ
 
g›Ba£dTemp‹ÆFûãrFutuªRe„ªn˚
);

121 
Boﬁ
 
	`fûãr
(
TComPicYuv
 *
‹gPic
, 
I¡
 
‰ame
);

123 
¥iv©e
:

125 c⁄° 
I¡
 
s_ønge
;

126 c⁄° 
DoubÀ
 
s_chromaFa˘‹
;

127 c⁄° 
DoubÀ
 
s_sigmaMu…ùlõr
;

128 c⁄° 
DoubÀ
 
s_sigmaZîoPoöt
;

129 c⁄° 
I¡
 
s_mŸi⁄Ve˘‹Fa˘‹
;

130 c⁄° 
I¡
 
s_∑ddög
;

131 c⁄° 
I¡
 
s_öãΩﬁ©i⁄Fûãr
[16][8];

132 c⁄° 
DoubÀ
 
s_ªfSåígths
[3][2];

135 
I¡
 
m_FømeSkù
;

136 
°d
::
°rög
 
m_öputFûeName
;

137 
I¡
 
m_öputBôDïth
[
MAX_NUM_CHANNEL_TYPE
];

138 
I¡
 
m_MSBExãndedBôDïth
[
MAX_NUM_CHANNEL_TYPE
];

139 
I¡
 
m_öã∫ÆBôDïth
[
MAX_NUM_CHANNEL_TYPE
];

140 
ChromaF‹m©
 
m_chromaF‹m©IDC
;

141 
I¡
 
m_sour˚Width
;

142 
I¡
 
m_sour˚Height
;

143 
I¡
 
m_QP
;

144 
I¡
 
m_GOPSize
;

145 
°d
::
m≠
<
I¡
, 
DoubÀ
> 
m_ãmp‹ÆFûãrSåígths
;

146 
I¡
 
m_aiPad
[2];

147 
I¡
 
m_‰amesToBeEncoded
;

148 
Boﬁ
 
m_bClùI≈utVideoToRec709R™ge
;

149 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
m_öputCﬁourS∑˚C⁄vît
;

150 
Boﬁ
 
m_g›Ba£dTemp‹ÆFûãrFutuªRe„ªn˚
;

153 
Void
 
	$subßm∂eLuma
(c⁄° 
TComPicYuv
 &
öput
, TComPicYuv &
ouçut
, c⁄° 
I¡
 
Á˘‹
 = 2) const;

154 
I¡
 
	$mŸi⁄Eº‹Luma
(c⁄° 
TComPicYuv
 &
‹ig
, c⁄° TComPicYuv &
buf„r
, c⁄° 
I¡
 
x
, c⁄° I¡ 
y
, I¡ 
dx
, I¡ 
dy
, c⁄° I¡ 
bs
, c⁄° I¡ 
be°îr‹
) const;

155 
Void
 
	`mŸi⁄E°im©i⁄Luma
(
Aºay2D
<
MŸi⁄Ve˘‹
> &
mvs
, c⁄° 
TComPicYuv
 &
‹ig
, c⁄° TComPicYuv &
buf„r
, c⁄° 
I¡
 
bs
,

156 c⁄° 
Aºay2D
<
MŸi⁄Ve˘‹
> *
¥evious
=0, c⁄° 
I¡
 
Á˘‹
 = 1, c⁄° 
Boﬁ
 
doubÀRes
 = 
Ál£
) const;

157 
Void
 
	`mŸi⁄E°im©i⁄
(
Aºay2D
<
MŸi⁄Ve˘‹
> &
mvs
, c⁄° 
TComPicYuv
 &
‹gPic
, c⁄° TComPicYuv &
buf„r
, c⁄° TComPicYuv &
‹igSubßm∂ed2
, c⁄° TComPicYuv &
‹igSubßm∂ed4
) const;

159 
Void
 
	`bû©îÆFûãr
(c⁄° 
TComPicYuv
 &
‹gPic
, c⁄° 
°d
::
deque
<
Temp‹ÆFûãrSour˚PicInfo
> &
§cFømeInfo
, TComPicYuv &
√wOrgPic
, 
DoubÀ
 
ovîÆlSåígth
) const;

160 
Void
 
	`≠∂yMŸi⁄
(c⁄° 
Aºay2D
<
MŸi⁄Ve˘‹
> &
mvs
, c⁄° 
TComPicYuv
 &
öput
, TComPicYuv &
ouçut
) const;

161 
	}
};

	@TLibEncoder/TEncTop.cpp

38 
	~"TLibComm⁄/Comm⁄Def.h
"

39 
	~"TEncT›.h
"

40 
	~"TEncPic.h
"

41 
	~"TLibComm⁄/TComChromaF‹m©.h
"

42 #i‡
FAST_BIT_EST


43 
	~"TLibComm⁄/C⁄ãxtModñ.h
"

53 
	gTEncT›
::
	$TEncT›
() :

54 
	`m_•sM≠
(
MAX_NUM_SPS
)

55 , 
	$m_µsM≠
(
MAX_NUM_PPS
)

57 
m_iPOCLa°
 = -1;

58 
m_iNumPicRcvd
 = 0;

59 
m_uiNumAŒPicCoded
 = 0;

60 
m_µpcRDSbacCodî
 = 
NULL
;

61 
m_µpcBöCodîCABAC
 = 
NULL
;

62 
m_cRDGoOnSbacCodî
.
	`öô
–&
m_cRDGoOnBöCodîCABAC
 );

63 #i‡
ENC_DEC_TRACE


64 i‡(
g_hTø˚
 =
NULL
)

66 
g_hTø˚
 = 
	`f›í
( "TraceEnc.txt", "wb" );

68 
g_bJu°DoIt
 = 
g_bEncDecTø˚DißbÀ
;

69 
g_nSymbﬁCou¡î
 = 0;

72 
m_iMaxRefPicNum
 = 0;

74 #i‡
FAST_BIT_EST


75 
C⁄ãxtModñ
::
	`buûdNextSèãTabÀ
();

77 
	}
}

79 
	gTEncT›
::~
	$TEncT›
()

81 #i‡
ENC_DEC_TRACE


82 i‡(
g_hTø˚
 !
°dout
)

84 
	`f˛o£
–
g_hTø˚
 );

87 
	}
}

89 
Void
 
	gTEncT›
::
	$¸óã
 ()

92 
	`öôROM
();

95 
m_cGOPEncodî
. 
	`¸óã
( );

96 
m_cSli˚Encodî
. 
	`¸óã
–
	`gëSour˚Width
(), 
	`gëSour˚Height
(), 
m_chromaF‹m©IDC
, 
m_maxCUWidth
, 
m_maxCUHeight
, 
m_maxTŸÆCUDïth
 );

97 
m_cCuEncodî
. 
	`¸óã
–
m_maxTŸÆCUDïth
, 
m_maxCUWidth
, 
m_maxCUHeight
, 
m_chromaF‹m©IDC
 );

98 i‡(
m_bU£SAO
)

100 
m_cEncSAO
.
	`¸óã
–
	`gëSour˚Width
(), 
	`gëSour˚Height
(), 
m_chromaF‹m©IDC
, 
m_maxCUWidth
, 
m_maxCUHeight
, 
m_maxTŸÆCUDïth
, 
m_log2SaoOff£tSˇÀ
[
CHANNEL_TYPE_LUMA
], m_log2SaoOff£tSˇÀ[
CHANNEL_TYPE_CHROMA
] );

101 
m_cEncSAO
.
	`¸óãEncD©a
(
	`gëSaoCtuBound¨y
());

103 #i‡
ADAPTIVE_QP_SELECTION


104 i‡(
m_bU£Ad≠tQpSñe˘
)

106 
m_cTrQu™t
.
	`öôSli˚QpDñè
();

110 
m_cLo›Fûãr
.
	`¸óã
–
m_maxTŸÆCUDïth
 );

112 i‡–
m_RCE«bÀR©eC⁄åﬁ
 )

114 
m_cR©eCål
.
	`öô
–
m_‰amesToBeEncoded
, 
m_RCT¨gëBôøã
, (
I¡
)–(
DoubÀ
)
m_iFømeR©e
/
m_ãmp‹ÆSubßm∂eR©io
 + 0.5), 
m_iGOPSize
, 
m_iSour˚Width
, 
m_iSour˚Height
,

115 
m_maxCUWidth
, 
m_maxCUHeight
,
m_RCKìpHõørchiˇlBô
, 
m_RCU£LCUSï¨©eModñ
, 
m_GOPLi°
 );

118 
m_µpcRDSbacCodî
 = 
√w
 
TEncSbac
** [
m_maxTŸÆCUDïth
+1];

119 #i‡
FAST_BIT_EST


120 
m_µpcBöCodîCABAC
 = 
√w
 
TEncBöCABACCou¡î
** [
m_maxTŸÆCUDïth
+1];

122 
m_µpcBöCodîCABAC
 = 
√w
 
TEncBöCABAC
** [
m_maxTŸÆCUDïth
+1];

125  
I¡
 
iDïth
 = 0; iDïth < 
m_maxTŸÆCUDïth
+1; iDepth++ )

127 
m_µpcRDSbacCodî
[
iDïth
] = 
√w
 
TEncSbac
* [
CI_NUM
];

128 #i‡
FAST_BIT_EST


129 
m_µpcBöCodîCABAC
[
iDïth
] = 
√w
 
TEncBöCABACCou¡î
* [
CI_NUM
];

131 
m_µpcBöCodîCABAC
[
iDïth
] = 
√w
 
TEncBöCABAC
* [
CI_NUM
];

134 
I¡
 
iCIIdx
 = 0; iCIIdx < 
CI_NUM
; iCIIdx ++ )

136 
m_µpcRDSbacCodî
[
iDïth
][
iCIIdx
] = 
√w
 
TEncSbac
;

137 #i‡
FAST_BIT_EST


138 
m_µpcBöCodîCABAC
 [
iDïth
][
iCIIdx
] = 
√w
 
TEncBöCABACCou¡î
;

140 
m_µpcBöCodîCABAC
 [
iDïth
][
iCIIdx
] = 
√w
 
TEncBöCABAC
;

142 
m_µpcRDSbacCodî
 [
iDïth
][
iCIIdx
]->
	`öô
–
m_µpcBöCodîCABAC
 [iDepth][iCIIdx] );

145 
	}
}

147 
Void
 
	gTEncT›
::
	$de°roy
 ()

150 
m_cGOPEncodî
. 
	`de°roy
();

151 
m_cSli˚Encodî
. 
	`de°roy
();

152 
m_cCuEncodî
. 
	`de°roy
();

153 
m_cEncSAO
. 
	`de°royEncD©a
();

154 
m_cEncSAO
. 
	`de°roy
();

155 
m_cLo›Fûãr
. 
	`de°roy
();

156 
m_cR©eCål
. 
	`de°roy
();

157 
m_cSórch
. 
	`de°roy
();

158 
I¡
 
iDïth
;

159  
iDïth
 = 0; iDïth < 
m_maxTŸÆCUDïth
+1; iDepth++ )

161 
I¡
 
iCIIdx
 = 0; iCIIdx < 
CI_NUM
; iCIIdx ++ )

163 
dñëe
 
m_µpcRDSbacCodî
[
iDïth
][
iCIIdx
];

164 
dñëe
 
m_µpcBöCodîCABAC
[
iDïth
][
iCIIdx
];

168  
iDïth
 = 0; iDïth < 
m_maxTŸÆCUDïth
+1; iDepth++ )

170 
dñëe
 [] 
m_µpcRDSbacCodî
[
iDïth
];

171 
dñëe
 [] 
m_µpcBöCodîCABAC
[
iDïth
];

174 
dñëe
 [] 
m_µpcRDSbacCodî
;

175 
dñëe
 [] 
m_µpcBöCodîCABAC
;

178 
	`de°royROM
();

181 
	}
}

183 
Void
 
	gTEncT›
::
	$öô
(
Boﬁ
 
isFõldCodög
)

185 
TComSPS
 &
•s0
=*(
m_•sM≠
.
	`ÆloˇãPS
(0));

186 
TComPPS
 &
µs0
=*(
m_µsM≠
.
	`ÆloˇãPS
(0));

188 
	`xInôSPS
(
•s0
);

189 
	`xInôVPS
(
m_cVPS
, 
•s0
);

191 i‡(
m_RCCpbS©uøti⁄E«bÀd
)

193 
m_cR©eCål
.
	`öôHrdP¨am
(
•s0
.
	`gëVuiP¨amëîs
()->
	`gëHrdP¨amëîs
(), 
m_iFømeR©e
, 
m_RCInôülCpbFuŒ√ss
);

196 
m_cRdCo°
.
	`£tCo°Mode
(
m_co°Mode
);

199 
	`xInôPPS
(
µs0
, 
•s0
);

200 
	`xInôRPS
(
•s0
, 
isFõldCodög
);

201 
	`xInôSˇlögLi°s
(
•s0
, 
µs0
);

203 i‡(
m_wcgChromaQpC⁄åﬁ
.
	`isE«bÀd
())

205 
TComPPS
 &
µs1
=*(
m_µsM≠
.
	`ÆloˇãPS
(1));

206 
	`xInôPPS
(
µs1
, 
•s0
);

207 
	`xInôSˇlögLi°s
(
•s0
, 
µs1
);

211 
m_cGOPEncodî
. 
	`öô
–
this
 );

212 
m_cSli˚Encodî
.
	`öô
–
this
 );

213 
m_cCuEncodî
. 
	`öô
–
this
 );

214 
m_cCuEncodî
.
	`£tSli˚Encodî
(&
m_cSli˚Encodî
);

217 
m_pcCavlcCodî
 = 
	`gëCavlcCodî
();

219 
m_cTrQu™t
.
	`öô
–1 << 
m_uiQuadåìTULog2MaxSize
,

220 
m_u£RDOQ
,

221 
m_u£RDOQTS
,

222 
m_u£Sñe˘iveRDOQ
,

223 
åue


224 ,
m_u£Tønsf‹mSkùFa°


225 #i‡
ADAPTIVE_QP_SELECTION


226 ,
m_bU£Ad≠tQpSñe˘


231 
m_cSórch
.
	`öô
–
this
, &
m_cTrQu™t
, 
m_iSórchR™ge
, 
m_bùªdSórchR™ge
, 
m_mŸi⁄E°im©i⁄SórchMëhod
, 
m_maxCUWidth
, 
m_maxCUHeight
, 
m_maxTŸÆCUDïth
, &
m_cE¡r›yCodî
, &
m_cRdCo°
, 
	`gëRDSbacCodî
(), 
	`gëRDGoOnSbacCodî
() );

233 
m_iMaxRefPicNum
 = 0;

234 
	}
}

236 
Void
 
	gTEncT›
::
	$xInôSˇlögLi°s
(
TComSPS
 &
•s
, 
TComPPS
 &
µs
)

240 c⁄° 
I¡
 
maxLog2TrDy«micR™ge
[
MAX_NUM_CHANNEL_TYPE
] =

242 
•s
.
	`gëMaxLog2TrDy«micR™ge
(
CHANNEL_TYPE_LUMA
),

243 
•s
.
	`gëMaxLog2TrDy«micR™ge
(
CHANNEL_TYPE_CHROMA
)

245 if(
	`gëU£SˇlögLi°Id
(Ë=
SCALING_LIST_OFF
)

247 
	`gëTrQu™t
()->
	`£tFœtSˇlögLi°
(
maxLog2TrDy«micR™ge
, 
•s
.
	`gëBôDïths
());

248 
	`gëTrQu™t
()->
	`£tU£SˇlögLi°
(
Ál£
);

249 
•s
.
	`£tSˇlögLi°Pª£¡Fœg
(
Ál£
);

250 
µs
.
	`£tSˇlögLi°Pª£¡Fœg
(
Ál£
);

252 if(
	`gëU£SˇlögLi°Id
(Ë=
SCALING_LIST_DEFAULT
)

254 
•s
.
	`gëSˇlögLi°
().
	`£tDeÁu…SˇlögLi°
 ();

255 
•s
.
	`£tSˇlögLi°Pª£¡Fœg
(
Ál£
);

256 
µs
.
	`£tSˇlögLi°Pª£¡Fœg
(
Ál£
);

258 
	`gëTrQu™t
()->
	`£tSˇlögLi°
(&(
•s
.
	`gëSˇlögLi°
()), 
maxLog2TrDy«micR™ge
, sps.
	`gëBôDïths
());

259 
	`gëTrQu™t
()->
	`£tU£SˇlögLi°
(
åue
);

261 if(
	`gëU£SˇlögLi°Id
(Ë=
SCALING_LIST_FILE_READ
)

263 
•s
.
	`gëSˇlögLi°
().
	`£tDeÁu…SˇlögLi°
 ();

264 if(
•s
.
	`gëSˇlögLi°
().
	`xP¨£SˇlögLi°
(
	`gëSˇlögLi°FûeName
()))

266 
Boﬁ
 
bP¨£dSˇlögLi°
=
Ál£
;

267 
	`as£π
(
bP¨£dSˇlögLi°
);

268 
	`exô
(1);

270 
•s
.
	`gëSˇlögLi°
().
	`checkDcOfM©rix
();

271 
•s
.
	`£tSˇlögLi°Pª£¡Fœg
(•s.
	`gëSˇlögLi°
().
	`checkDeÁu…SˇlögLi°
());

272 
µs
.
	`£tSˇlögLi°Pª£¡Fœg
(
Ál£
);

273 
	`gëTrQu™t
()->
	`£tSˇlögLi°
(&(
•s
.
	`gëSˇlögLi°
()), 
maxLog2TrDy«micR™ge
, sps.
	`gëBôDïths
());

274 
	`gëTrQu™t
()->
	`£tU£SˇlögLi°
(
åue
);

278 
	`¥ötf
("îr‹ : SˇlögLi° =%dÇŸ suµ‹ãd\n",
	`gëU£SˇlögLi°Id
());

279 
	`as£π
(0);

282 i‡(
	`gëU£SˇlögLi°Id
(Ë!
SCALING_LIST_OFF
)

285 
UI¡
 
sizeId
 = 0; sizeId < 
SCALING_LIST_SIZE_NUM
; sizeId++)

287 c⁄° 
I¡
 
¥edLi°Sãp
 = (
sizeId
 =
SCALING_LIST_32x32
? (
SCALING_LIST_NUM
/
NUMBER_OF_PREDICTION_MODES
) : 1);

289 
UI¡
 
li°Id
 = 0;Üi°Id < 
SCALING_LIST_NUM
;Üi°Id+=
¥edLi°Sãp
)

291 
•s
.
	`gëSˇlögLi°
().
	`checkPªdMode
–
sizeId
, 
li°Id
 );

295 
	}
}

301 
Void
 
	gTEncT›
::
	$dñëePicBuf„r
()

303 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
m_cLi°Pic
.
	`begö
();

304 
I¡
 
iSize
 = 
	`I¡
–
m_cLi°Pic
.
	`size
() );

306  
I¡
 
i
 = 0; i < 
iSize
; i++ )

308 
TComPic
* 
pcPic
 = *(
ôîPic
++);

310 
pcPic
->
	`de°roy
();

311 
dñëe
 
pcPic
;

312 
pcPic
 = 
NULL
;

314 
	}
}

329 
Void
 
	gTEncT›
::
ícode
–
Boﬁ
 
Êush
, 
TComPicYuv
* 
pcPicYuvOrg
, TComPicYuv* 
pcPicYuvTrueOrg
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢rCSC
, 
TComLi°
<TComPicYuv*>& 
rcLi°PicYuvRecOut
, 
°d
::
li°
<
Ac˚ssUnô
>& 
ac˚ssUnôsOut
, 
I¡
& 
iNumEncoded
 )

331 i‡(
	gpcPicYuvOrg
 !
NULL
)

334 
TComPic
* 
pcPicCuº
 = 
NULL
;

336 
I¡
 
	gµsID
=-1;

337 i‡(
gëWCGChromaQPC⁄åﬁ
().
isE«bÀd
())

339 
	gµsID
=
gëdQPs
()[ 
m_iPOCLa°
+1 ];

341 
xGëNewPicBuf„r
–
pcPicCuº
, 
µsID
 );

342 
	gpcPicYuvOrg
->
c›yToPic
–
pcPicCuº
->
gëPicYuvOrg
() );

343 
	gpcPicYuvTrueOrg
->
c›yToPic
–
pcPicCuº
->
gëPicYuvTrueOrg
() );

346 i‡–
gëU£Ad≠tiveQP
() )

348 
	gm_cPª™Æyzî
.
xPª™Æyze
–
dy«mic_ˇ°
<
TEncPic
*>–
pcPicCuº
 ) );

352 i‡((
	gm_iNumPicRcvd
 =0Ë|| (!
Êush
 && (
m_iPOCLa°
 !0Ë&& (
m_iNumPicRcvd
 !
m_iGOPSize
) && (m_iGOPSize != 0)))

354 
iNumEncoded
 = 0;

358 i‡–
	gm_RCE«bÀR©eC⁄åﬁ
 )

360 
	gm_cR©eCål
.
öôRCGOP
–
m_iNumPicRcvd
 );

364 
	gm_cGOPEncodî
.
com¥essGOP
(
m_iPOCLa°
, 
m_iNumPicRcvd
, 
m_cLi°Pic
, 
rcLi°PicYuvRecOut
, 
ac˚ssUnôsOut
, 
Ál£
, fÆ£, 
ùCSC
, 
¢rCSC
, 
gëOuçutLogC⁄åﬁ
());

366 i‡–
	gm_RCE«bÀR©eC⁄åﬁ
 )

368 
	gm_cR©eCål
.
de°royRCGOP
();

371 
	giNumEncoded
 = 
m_iNumPicRcvd
;

372 
	gm_iNumPicRcvd
 = 0;

373 
	gm_uiNumAŒPicCoded
 +
iNumEncoded
;

379 
Void
 
	$£∑øãFõlds
(
Pñ
* 
‹g
, Pñ* 
d°Fõld
, 
UI¡
 
°ride
, UI¡ 
width
, UI¡ 
height
, 
Boﬁ
 
isT›
)

381 i‡(!
isT›
)

383 
‹g
 +
°ride
;

385 
I¡
 
y
 = 0; y < 
height
>>1; y++)

387 
I¡
 
x
 = 0; x < 
width
; x++)

389 
d°Fõld
[
x
] = 
‹g
[x];

392 
d°Fõld
 +
°ride
;

393 
‹g
 +
°ride
*2;

396 
	}
}

398 
Void
 
	gTEncT›
::
ícode
(
Boﬁ
 
Êush
, 
TComPicYuv
* 
pcPicYuvOrg
, TComPicYuv* 
pcPicYuvTrueOrg
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢rCSC
, 
TComLi°
<TComPicYuv*>& 
rcLi°PicYuvRecOut
, 
°d
::
li°
<
Ac˚ssUnô
>& 
ac˚ssUnôsOut
, 
I¡
& 
iNumEncoded
, Boﬁ 
isTff
)

400 
	giNumEncoded
 = 0;

402 
I¡
 
	gfõldNum
=0; fieldNum<2; fieldNum++)

404 i‡(
	gpcPicYuvOrg
)

408 c⁄° 
Boﬁ
 
	gisT›Fõld
=
isTff
==(
fõldNum
==0);

410 
TComPic
 *
	gpcFõld
;

411 
xGëNewPicBuf„r
–
pcFõld
, -1 );

412 
	gpcFõld
->
£tRec⁄M¨k
 (
Ál£
);

414 i‡(
	gfõldNum
==1)

416 
TComPicYuv
* 
ΩcPicYuvRec
;

419 i‡–
	grcLi°PicYuvRecOut
.
size
(Ë>(
UI¡
)
m_iGOPSize
+1 )

421 
ΩcPicYuvRec
 = 
rcLi°PicYuvRecOut
.
p›Fr⁄t
();

425 
	gΩcPicYuvRec
 = 
√w
 
TComPicYuv
;

426 
	gΩcPicYuvRec
->
¸óã
–
m_iSour˚Width
, 
m_iSour˚Height
, 
m_chromaF‹m©IDC
, 
m_maxCUWidth
, 
m_maxCUHeight
, 
m_maxTŸÆCUDïth
, 
åue
);

428 
	grcLi°PicYuvRecOut
.
pushBack
–
ΩcPicYuvRec
 );

431 
	gpcFõld
->
gëSli˚
(0)->
£tPOC
–
m_iPOCLa°
 );

432 #i‡!
REDUCED_ENCODER_MEMORY


433 
	gpcFõld
->
gëPicYuvRec
()->
£tB‹dîExãnsi⁄
(
Ál£
);

436 
	gpcFõld
->
£tT›Fõld
(
isT›Fõld
);

438 
UI¡
 
	gcomp⁄ítIndex
 = 0; comp⁄ítIndex < 
	gpcPicYuvOrg
->
gëNumbîVÆidComp⁄íts
(); componentIndex++)

440 c⁄° 
Comp⁄ítID
 
	gcomp⁄ít
 = Comp⁄ítID(
comp⁄ítIndex
);

441 c⁄° 
UI¡
 
	g°ride
 = 
pcPicYuvOrg
->
gëSåide
(
comp⁄ít
);

443 
£∑øãFõlds
((
pcPicYuvOrg
->
gëBuf
(
comp⁄ít
Ë+ÖcPicYuvOrg->
gëM¨göX
(comp⁄ítË+ (pcPicYuvOrg->
gëM¨göY
(comp⁄ítË* 
°ride
)),

444 
pcFõld
->
gëPicYuvOrg
()->
gëAddr
(
comp⁄ít
),

445 
pcPicYuvOrg
->
gëSåide
(
comp⁄ít
),

446 
pcPicYuvOrg
->
gëWidth
(
comp⁄ít
),

447 
pcPicYuvOrg
->
gëHeight
(
comp⁄ít
),

448 
isT›Fõld
);

450 
£∑øãFõlds
((
pcPicYuvTrueOrg
->
gëBuf
(
comp⁄ít
Ë+ÖcPicYuvTrueOrg->
gëM¨göX
(comp⁄ítË+ (pcPicYuvTrueOrg->
gëM¨göY
(comp⁄ítË* 
°ride
)),

451 
pcFõld
->
gëPicYuvTrueOrg
()->
gëAddr
(
comp⁄ít
),

452 
pcPicYuvTrueOrg
->
gëSåide
(
comp⁄ít
),

453 
pcPicYuvTrueOrg
->
gëWidth
(
comp⁄ít
),

454 
pcPicYuvTrueOrg
->
gëHeight
(
comp⁄ít
),

455 
isT›Fõld
);

459 i‡–
gëU£Ad≠tiveQP
() )

461 
	gm_cPª™Æyzî
.
xPª™Æyze
–
dy«mic_ˇ°
<
TEncPic
*>–
pcFõld
 ) );

465 i‡–
	gm_iNumPicRcvd
 && ((
	gÊush
&&
	gfõldNum
==1Ë|| (
m_iPOCLa°
/2)==0 || 
m_iNumPicRcvd
==
m_iGOPSize
 ) )

468 
m_cGOPEncodî
.
com¥essGOP
(
m_iPOCLa°
, 
m_iNumPicRcvd
, 
m_cLi°Pic
, 
rcLi°PicYuvRecOut
, 
ac˚ssUnôsOut
, 
åue
, 
isTff
, 
ùCSC
, 
¢rCSC
, 
gëOuçutLogC⁄åﬁ
());

469 
	giNumEncoded
 +
m_iNumPicRcvd
;

470 
	gm_uiNumAŒPicCoded
 +
m_iNumPicRcvd
;

471 
	gm_iNumPicRcvd
 = 0;

487 
Void
 
	gTEncT›
::
	$xGëNewPicBuf„r
 ( 
TComPic
*& 
ΩcPic
, 
I¡
 
µsId
 )

489 
ΩcPic
=0;

492 c⁄° 
TComPPS
 *
pPPS
=(
µsId
<0Ë? 
m_µsM≠
.
	`gëFú°PS
(Ë: m_µsM≠.
	`gëPS
(ppsId);

493 
	`as£π
 (
pPPS
!=0);

494 c⁄° 
TComPPS
 &
µs
=*
pPPS
;

496 c⁄° 
TComSPS
 *
pSPS
=
m_•sM≠
.
	`gëPS
(
µs
.
	`gëSPSId
());

497 
	`as£π
 (
pSPS
!=0);

498 c⁄° 
TComSPS
 &
•s
=*
pSPS
;

500 
TComSli˚
::
	`s‹tPicLi°
(
m_cLi°Pic
);

503 i‡(
m_cLi°Pic
.
	`size
(Ë>(
UI¡
)(
m_iGOPSize
 + 
	`gëMaxDecPicBuf„rög
(
MAX_TLAYER
-1) + 2) )

505 
TComLi°
<
TComPic
*>::
ôî©‹
 
ôîPic
 = 
m_cLi°Pic
.
	`begö
();

506 
I¡
 
iSize
 = 
	`I¡
–
m_cLi°Pic
.
	`size
() );

507  
I¡
 
i
 = 0; i < 
iSize
; i++ )

509 
ΩcPic
 = *
ôîPic
;

510 if(
ΩcPic
->
	`gëSli˚
(0)->
	`isRe„ªn˚d
(Ë=
Ál£
)

514 
ôîPic
++;

519 i‡(
µs
.
	`gëPPSId
(Ë=
ΩcPic
->
	`gëPicSym
()->
	`gëPPS
().getPPSId())

521 #i‡
REDUCED_ENCODER_MEMORY


522 
ΩcPic
->
	`ªÀa£AŒRec⁄°ru˘i⁄D©a
();

523 
ΩcPic
->
	`¥ï¨eF‹EncodîSour˚PicYuv
();

529 
dñëe
 
ΩcPic
;

530 
m_cLi°Pic
.
	`îa£
(
ôîPic
);

531 
ΩcPic
=0;

535 i‡(
ΩcPic
==0)

537 i‡–
	`gëU£Ad≠tiveQP
() )

539 
TEncPic
* 
pcEPic
 = 
√w
 TEncPic;

540 #i‡
REDUCED_ENCODER_MEMORY


541 
pcEPic
->
	`¸óã
–
•s
, 
µs
,Öps.
	`gëMaxCuDQPDïth
()+1);

543 
pcEPic
->
	`¸óã
–
•s
, 
µs
,Öps.
	`gëMaxCuDQPDïth
()+1, 
Ál£
);

545 
ΩcPic
 = 
pcEPic
;

549 
ΩcPic
 = 
√w
 
TComPic
;

550 #i‡
REDUCED_ENCODER_MEMORY


551 
ΩcPic
->
	`¸óã
–
•s
, 
µs
, 
åue
, 
Ál£
 );

553 
ΩcPic
->
	`¸óã
–
•s
, 
µs
, 
Ál£
 );

557 
m_cLi°Pic
.
	`pushBack
–
ΩcPic
 );

559 
ΩcPic
->
	`£tRec⁄M¨k
 (
Ál£
);

561 
m_iPOCLa°
++;

562 
m_iNumPicRcvd
++;

564 
ΩcPic
->
	`gëSli˚
(0)->
	`£tPOC
–
m_iPOCLa°
 );

565 #i‡!
REDUCED_ENCODER_MEMORY


567 
ΩcPic
->
	`gëPicYuvRec
()->
	`£tB‹dîExãnsi⁄
(
Ál£
);

569 
	}
}

571 
Void
 
	gTEncT›
::
	$xInôVPS
(
TComVPS
 &
vps
, c⁄° 
TComSPS
 &
•s
)

575 *
vps
.
	`gëPTL
(Ë*
•s
.getPTL();

576 
vps
.
	`£tMaxOpSës
(1);

577 
vps
.
	`gëTimögInfo
()->
	`£tTimögInfoPª£¡Fœg
 ( 
Ál£
 );

578 
vps
.
	`£tNumHrdP¨amëîs
( 0 );

580 
vps
.
	`¸óãHrdP¨amBuf„r
();

581  
UI¡
 
i
 = 0; i < 
vps
.
	`gëNumHrdP¨amëîs
(); i ++ )

583 
vps
.
	`£tHrdOpSëIdx
–0, 
i
 );

584 
vps
.
	`£tC¥msPª£¡Fœg
–
Ál£
, 
i
 );

587 
	}
}

589 
Void
 
	gTEncT›
::
	$xInôSPS
(
TComSPS
 &
•s
)

591 
ProfûeTõrLevñ
& 
¥ofûeTõrLevñ
 = *
•s
.
	`gëPTL
()->
	`gëGíîÆPTL
();

592 
¥ofûeTõrLevñ
.
	`£tLevñIdc
(
m_Àvñ
);

593 
¥ofûeTõrLevñ
.
	`£tTõrFœg
(
m_ÀvñTõr
);

594 
¥ofûeTõrLevñ
.
	`£tProfûeIdc
(
m_¥ofûe
);

595 
¥ofûeTõrLevñ
.
	`£tProfûeCom∑tibûôyFœg
(
m_¥ofûe
, 1);

596 
¥ofûeTõrLevñ
.
	`£tProgªssiveSour˚Fœg
(
m_¥ogªssiveSour˚Fœg
);

597 
¥ofûeTõrLevñ
.
	`£tI¡îœ˚dSour˚Fœg
(
m_öãæa˚dSour˚Fœg
);

598 
¥ofûeTõrLevñ
.
	`£tN⁄PackedC⁄°øötFœg
(
m_n⁄PackedC⁄°øötFœg
);

599 
¥ofûeTõrLevñ
.
	`£tFømeO∆yC⁄°øötFœg
(
m_‰ameO∆yC⁄°øötFœg
);

600 
¥ofûeTõrLevñ
.
	`£tBôDïthC⁄°øöt
(
m_bôDïthC⁄°øötVÆue
);

601 
¥ofûeTõrLevñ
.
	`£tChromaF‹m©C⁄°øöt
(
m_chromaF‹m©C⁄°øötVÆue
);

602 
¥ofûeTõrLevñ
.
	`£tI¡øC⁄°øötFœg
(
m_öåaC⁄°øötFœg
);

603 
¥ofûeTõrLevñ
.
	`£tO√Pi˘uªO∆yC⁄°øötFœg
(
m_⁄ePi˘uªO∆yC⁄°øötFœg
);

604 
¥ofûeTõrLevñ
.
	`£tLowîBôR©eC⁄°øötFœg
(
m_lowîBôR©eC⁄°øötFœg
);

606 i‡((
m_¥ofûe
 =
Profûe
::
MAIN10
Ë&& (
m_bôDïth
[
CHANNEL_TYPE_LUMA
] =8Ë&& (m_bôDïth[
CHANNEL_TYPE_CHROMA
] == 8))

609 
¥ofûeTõrLevñ
.
	`£tProfûeCom∑tibûôyFœg
(
Profûe
::
MAIN
, 1);

611 i‡(
m_¥ofûe
 =
Profûe
::
MAIN
)

614 
¥ofûeTõrLevñ
.
	`£tProfûeCom∑tibûôyFœg
(
Profûe
::
MAIN10
, 1);

620 
•s
.
	`£tPicWidthInLumaSam∂es
 ( 
m_iSour˚Width
 );

621 
•s
.
	`£tPicHeightInLumaSam∂es
 ( 
m_iSour˚Height
 );

622 
•s
.
	`£tC⁄f‹m™˚Wödow
 ( 
m_c⁄f‹m™˚Wödow
 );

623 
•s
.
	`£tMaxCUWidth
 ( 
m_maxCUWidth
 );

624 
•s
.
	`£tMaxCUHeight
 ( 
m_maxCUHeight
 );

625 
•s
.
	`£tMaxTŸÆCUDïth
 ( 
m_maxTŸÆCUDïth
 );

626 
•s
.
	`£tChromaF‹m©Idc
–
m_chromaF‹m©IDC
);

627 
•s
.
	`£tLog2DiffMaxMöCodögBlockSize
(
m_log2DiffMaxMöCodögBlockSize
);

629 
I¡
 
möCUSize
 = 
•s
.
	`gëMaxCUWidth
(Ë>> ( sps.
	`gëLog2DiffMaxMöCodögBlockSize
() );

630 
I¡
 
log2MöCUSize
 = 0;

631 
möCUSize
 > 1)

633 
möCUSize
 >>= 1;

634 
log2MöCUSize
++;

637 
•s
.
	`£tLog2MöCodögBlockSize
(
log2MöCUSize
);

639 
•s
.
	`£tPCMLog2MöSize
 (
m_uiPCMLog2MöSize
);

640 
•s
.
	`£tU£PCM
 ( 
m_u£PCM
 );

641 
•s
.
	`£tPCMLog2MaxSize
–
m_pcmLog2MaxSize
 );

643 
•s
.
	`£tQuadåìTULog2MaxSize
–
m_uiQuadåìTULog2MaxSize
 );

644 
•s
.
	`£tQuadåìTULog2MöSize
–
m_uiQuadåìTULog2MöSize
 );

645 
•s
.
	`£tQuadåìTUMaxDïthI¡î
–
m_uiQuadåìTUMaxDïthI¡î
 );

646 
•s
.
	`£tQuadåìTUMaxDïthI¡ø
–
m_uiQuadåìTUMaxDïthI¡ø
 );

648 
•s
.
	`£tSPSTemp‹ÆMVPE«bÀdFœg
((
	`gëTMVPModeId
() == 2 || getTMVPModeId() == 1));

650 
•s
.
	`£tMaxTrSize
 ( 1 << 
m_uiQuadåìTULog2MaxSize
 );

652 
•s
.
	`£tU£AMP
 ( 
m_u£AMP
 );

654 
UI¡
 
ch™√lTy≥
 = 0; ch™√lTy≥ < 
MAX_NUM_CHANNEL_TYPE
; channelType++)

656 
•s
.
	`£tBôDïth
 (
	`Ch™√lTy≥
(
ch™√lTy≥
), 
m_bôDïth
[channelType] );

657 #i‡
O0043_BEST_EFFORT_DECODING


658 
•s
.
	`£tSåómBôDïth
(
	`Ch™√lTy≥
(
ch™√lTy≥
), 
m_bôDïth
[channelType] );

660 
•s
.
	`£tQpBDOff£t
 (
	`Ch™√lTy≥
(
ch™√lTy≥
), (6 * (
m_bôDïth
[channelType] - 8)));

661 
•s
.
	`£tPCMBôDïth
 (
	`Ch™√lTy≥
(
ch™√lTy≥
), 
m_PCMBôDïth
[channelType] );

664 
•s
.
	`£tU£SAO
–
m_bU£SAO
 );

666 
•s
.
	`£tMaxTLayîs
–
m_maxTempLayî
 );

667 
•s
.
	`£tTemp‹ÆIdNe°ögFœg
––
m_maxTempLayî
 =1 ) ? 
åue
 : 
Ál£
 );

669 
I¡
 
i
 = 0; i < 
	`mö
(
•s
.
	`gëMaxTLayîs
(),(
UI¡
Ë
MAX_TLAYER
); i++ )

671 
•s
.
	`£tMaxDecPicBuf„rög
(
m_maxDecPicBuf„rög
[
i
], i);

672 
•s
.
	`£tNumRe‹dîPics
(
m_numRe‹dîPics
[
i
], i);

675 
•s
.
	`£tPCMFûãrDißbÀFœg
 ( 
m_bPCMFûãrDißbÀFœg
 );

676 
•s
.
	`£tSˇlögLi°Fœg
 ( (
m_u£SˇlögLi°Id
 =
SCALING_LIST_OFF
) ? 0 : 1 );

677 
•s
.
	`£tU£Så⁄gI¡øSmoŸhög
–
m_u£Så⁄gI¡øSmoŸhög
 );

678 
•s
.
	`£tVuiP¨amëîsPª£¡Fœg
(
	`gëVuiP¨amëîsPª£¡Fœg
());

680 i‡(
•s
.
	`gëVuiP¨amëîsPª£¡Fœg
())

682 
TComVUI
* 
pcVUI
 = 
•s
.
	`gëVuiP¨amëîs
();

683 
pcVUI
->
	`£tA•e˘R©ioInfoPª£¡Fœg
(
	`gëA•e˘R©ioInfoPª£¡Fœg
());

684 
pcVUI
->
	`£tA•e˘R©ioIdc
(
	`gëA•e˘R©ioIdc
());

685 
pcVUI
->
	`£tS¨Width
(
	`gëS¨Width
());

686 
pcVUI
->
	`£tS¨Height
(
	`gëS¨Height
());

687 
pcVUI
->
	`£tOvîsˇnInfoPª£¡Fœg
(
	`gëOvîsˇnInfoPª£¡Fœg
());

688 
pcVUI
->
	`£tOvîsˇnAµr›rüãFœg
(
	`gëOvîsˇnAµr›rüãFœg
());

689 
pcVUI
->
	`£tVideoSig«lTy≥Pª£¡Fœg
(
	`gëVideoSig«lTy≥Pª£¡Fœg
());

690 
pcVUI
->
	`£tVideoF‹m©
(
	`gëVideoF‹m©
());

691 
pcVUI
->
	`£tVideoFuŒR™geFœg
(
	`gëVideoFuŒR™geFœg
());

692 
pcVUI
->
	`£tCﬁourDes¸ùti⁄Pª£¡Fœg
(
	`gëCﬁourDes¸ùti⁄Pª£¡Fœg
());

693 
pcVUI
->
	`£tCﬁourPrim¨õs
(
	`gëCﬁourPrim¨õs
());

694 
pcVUI
->
	`£tTøns„rCh¨a˘îi°ics
(
	`gëTøns„rCh¨a˘îi°ics
());

695 
pcVUI
->
	`£tM©rixC€fficõ¡s
(
	`gëM©rixC€fficõ¡s
());

696 
pcVUI
->
	`£tChromaLocInfoPª£¡Fœg
(
	`gëChromaLocInfoPª£¡Fœg
());

697 
pcVUI
->
	`£tChromaSam∂eLocTy≥T›Fõld
(
	`gëChromaSam∂eLocTy≥T›Fõld
());

698 
pcVUI
->
	`£tChromaSam∂eLocTy≥BŸtomFõld
(
	`gëChromaSam∂eLocTy≥BŸtomFõld
());

699 
pcVUI
->
	`£tNeuåÆChromaIndiˇti⁄Fœg
(
	`gëNeuåÆChromaIndiˇti⁄Fœg
());

700 
pcVUI
->
	`£tDeÁu…Di•œyWödow
(
	`gëDeÁu…Di•œyWödow
());

701 
pcVUI
->
	`£tFømeFõldInfoPª£¡Fœg
(
	`gëFømeFõldInfoPª£¡Fœg
());

702 
pcVUI
->
	`£tFõldSeqFœg
(
Ál£
);

703 
pcVUI
->
	`£tHrdP¨amëîsPª£¡Fœg
(
Ál£
);

704 
pcVUI
->
	`gëTimögInfo
()->
	`£tPocPr›‹ti⁄ÆToTimögFœg
(
	`gëPocPr›‹ti⁄ÆToTimögFœg
());

705 
pcVUI
->
	`gëTimögInfo
()->
	`£tNumTicksPocDiffO√Möus1
 (
	`gëNumTicksPocDiffO√Möus1
() );

706 
pcVUI
->
	`£tBô°ªamRe°ri˘i⁄Fœg
(
	`gëBô°ªamRe°ri˘i⁄Fœg
());

707 
pcVUI
->
	`£tTûesFixedSåu˘uªFœg
(
	`gëTûesFixedSåu˘uªFœg
());

708 
pcVUI
->
	`£tMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
(
	`gëMŸi⁄Ve˘‹sOvîPicBound¨õsFœg
());

709 
pcVUI
->
	`£tMöS∑tülSegmíèti⁄Idc
(
	`gëMöS∑tülSegmíèti⁄Idc
());

710 
pcVUI
->
	`£tMaxByãsPîPicDíom
(
	`gëMaxByãsPîPicDíom
());

711 
pcVUI
->
	`£tMaxBôsPîMöCuDíom
(
	`gëMaxBôsPîMöCuDíom
());

712 
pcVUI
->
	`£tLog2MaxMvLígthH‹iz⁄èl
(
	`gëLog2MaxMvLígthH‹iz⁄èl
());

713 
pcVUI
->
	`£tLog2MaxMvLígthVîtiˇl
(
	`gëLog2MaxMvLígthVîtiˇl
());

715 
•s
.
	`£tNumL⁄gTîmRefPicSPS
(
NUM_LONG_TERM_REF_PIC_SPS
);

716 
	`as£π
 (
NUM_LONG_TERM_REF_PIC_SPS
 <
MAX_NUM_LONG_TERM_REF_PICS
);

717 
I¡
 
k
 = 0; k < 
NUM_LONG_TERM_REF_PIC_SPS
; k++)

719 
•s
.
	`£tLtRefPicPocLsbSps
(
k
, 0);

720 
•s
.
	`£tU£dByCuºPicLtSPSFœg
(
k
, 0);

723 if–
	`gëPi˘uªTimögSEIE«bÀd
(Ë|| 
	`gëDecodögUnôInfoSEIE«bÀd
(Ë|| 
	`gëCpbS©uøti⁄E«bÀd
() )

725 
	`xInôHrdP¨amëîs
(
•s
);

727 if–
	`gëBuf„rögPîiodSEIE«bÀd
(Ë|| 
	`gëPi˘uªTimögSEIE«bÀd
(Ë|| 
	`gëDecodögUnôInfoSEIE«bÀd
() )

729 
•s
.
	`gëVuiP¨amëîs
()->
	`£tHrdP¨amëîsPª£¡Fœg
–
åue
 );

733 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tTønsf‹mSkùRŸ©i⁄E«bÀdFœg
(
m_å™sf‹mSkùRŸ©i⁄E«bÀdFœg
);

734 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tTønsf‹mSkùC⁄ãxtE«bÀdFœg
(
m_å™sf‹mSkùC⁄ãxtE«bÀdFœg
);

735 
UI¡
 
sig«ŒögModeIndex
 = 0; sig«ŒögModeIndex < 
NUMBER_OF_RDPCM_SIGNALLING_MODES
; signallingModeIndex++)

737 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tRdpcmE«bÀdFœg
(
	`RDPCMSig«ŒögMode
(
sig«ŒögModeIndex
), 
m_rdpcmE«bÀdFœg
[signallingModeIndex]);

739 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tExãndedPªcisi⁄Pro˚ssögFœg
(
m_exãndedPªcisi⁄Pro˚ssögFœg
);

740 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tI¡øSmoŸhögDißbÀdFœg
–
m_öåaSmoŸhögDißbÀdFœg
 );

741 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tHighPªcisi⁄Off£tsE«bÀdFœg
(
m_highPªcisi⁄Off£tsE«bÀdFœg
);

742 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tPîsi°ítRi˚Ad≠èti⁄E«bÀdFœg
(
m_≥rsi°ítRi˚Ad≠èti⁄E«bÀdFœg
);

743 
•s
.
	`gëSpsR™geExãnsi⁄
().
	`£tCabacBy∑ssAlignmítE«bÀdFœg
(
m_ˇbacBy∑ssAlignmítE«bÀdFœg
);

744 
	}
}

747 
I¡
 
	$ˇlcSˇÀ
(
I¡
 
x
)

749 i‡(
x
==0)

753 
UI¡
 
iMask
 = 0xffffffff;

754 
I¡
 
SˇÀVÆue
 = 32;

756 (
x
&
iMask
) != 0)

758 
SˇÀVÆue
--;

759 
iMask
 = (iMask >> 1);

762  
SˇÀVÆue
;

763 
	}
}

765 
Void
 
	gTEncT›
::
	$xInôHrdP¨amëîs
(
TComSPS
 &
•s
)

767 
Boﬁ
 
u£SubCpbP¨ams
 = (
	`gëSli˚Mode
(Ë> 0Ë|| (
	`gëSli˚SegmítMode
() > 0);

768 
I¡
 
bôR©e
 = 
	`gëT¨gëBôøã
();

769 
Boﬁ
 
isR™domAc˚ss
 = 
	`gëI¡øPîiod
() > 0;

770 
I¡
 
˝bSize
 = 
	`gëCpbSize
();

771 
	`as£π
 (
˝bSize
!=0);

772 if–!
	`gëVuiP¨amëîsPª£¡Fœg
(Ë&& !
	`gëCpbS©uøti⁄E«bÀd
() )

777 
TComVUI
 *
vui
 = 
•s
.
	`gëVuiP¨amëîs
();

778 
TComHRD
 *
hrd
 = 
vui
->
	`gëHrdP¨amëîs
();

780 
TimögInfo
 *
timögInfo
 = 
vui
->
	`gëTimögInfo
();

781 
timögInfo
->
	`£tTimögInfoPª£¡Fœg
–
åue
 );

782  
	`gëFømeR©e
() )

785 
timögInfo
->
	`£tNumUnôsInTick
–1125000 );ÅimögInfo->
	`£tTimeSˇÀ
 ( 27000000 );

788 
timögInfo
->
	`£tNumUnôsInTick
–1080000 );ÅimögInfo->
	`£tTimeSˇÀ
 ( 27000000 );

791 
timögInfo
->
	`£tNumUnôsInTick
–900900 );ÅimögInfo->
	`£tTimeSˇÀ
 ( 27000000 );

794 
timögInfo
->
	`£tNumUnôsInTick
–540000 );ÅimögInfo->
	`£tTimeSˇÀ
 ( 27000000 );

797 
timögInfo
->
	`£tNumUnôsInTick
–450450 );ÅimögInfo->
	`£tTimeSˇÀ
 ( 27000000 );

800 
timögInfo
->
	`£tNumUnôsInTick
–1001 );ÅimögInfo->
	`£tTimeSˇÀ
 ( 60000 );

804 i‡(
	`gëTemp‹ÆSubßm∂eR©io
()>1)

806 
UI¡
 
ãmp‹ÆSubßm∂eR©io
 = 
	`gëTemp‹ÆSubßm∂eR©io
();

807 i‡–
	`DoubÀ
(
timögInfo
->
	`gëNumUnôsInTick
()Ë* 
ãmp‹ÆSubßm∂eR©io
 > 
°d
::
numîic_limôs
<
UI¡
>::
	`max
() )

809 
timögInfo
->
	`£tTimeSˇÀ
–timögInfo->
	`gëTimeSˇÀ
(Ë/ 
ãmp‹ÆSubßm∂eR©io
 );

813 
timögInfo
->
	`£tNumUnôsInTick
–timögInfo->
	`gëNumUnôsInTick
(Ë* 
ãmp‹ÆSubßm∂eR©io
 );

817 
Boﬁ
 
øãC¡
 = ( 
bôR©e
 > 0 );

818 
hrd
->
	`£tNÆHrdP¨amëîsPª£¡Fœg
–
øãC¡
 );

819 
hrd
->
	`£tV˛HrdP¨amëîsPª£¡Fœg
–
øãC¡
 );

820 
hrd
->
	`£tSubPicCpbP¨amsPª£¡Fœg
–
u£SubCpbP¨ams
 );

822 if–
hrd
->
	`gëSubPicCpbP¨amsPª£¡Fœg
() )

824 
hrd
->
	`£tTickDivis‹Möus2
( 100 - 2 );

825 
hrd
->
	`£tDuCpbRemovÆDñayLígthMöus1
( 7 );

826 
hrd
->
	`£tSubPicCpbP¨amsInPicTimögSEIFœg
–
åue
 );

827 
hrd
->
	`£tDpbOuçutDñayDuLígthMöus1
( 5 + 7 );

831 
hrd
->
	`£tSubPicCpbP¨amsInPicTimögSEIFœg
–
Ál£
 );

834 i‡(
	`ˇlcSˇÀ
(
bôR©e
) <= 6)

836 
hrd
->
	`£tBôR©eSˇÀ
(0);

840 
hrd
->
	`£tBôR©eSˇÀ
(
	`ˇlcSˇÀ
(
bôR©e
) - 6);

843 i‡(
	`ˇlcSˇÀ
(
˝bSize
) <= 4)

845 
hrd
->
	`£tCpbSizeSˇÀ
(0);

849 
hrd
->
	`£tCpbSizeSˇÀ
(
	`ˇlcSˇÀ
(
˝bSize
) - 4);

852 
hrd
->
	`£tDuCpbSizeSˇÀ
( 6 );

854 
hrd
->
	`£tInôülCpbRemovÆDñayLígthMöus1
(15);

855 if–
isR™domAc˚ss
 )

857 
hrd
->
	`£tCpbRemovÆDñayLígthMöus1
(5);

858 
hrd
->
	`£tDpbOuçutDñayLígthMöus1
 (5);

862 
hrd
->
	`£tCpbRemovÆDñayLígthMöus1
(9);

863 
hrd
->
	`£tDpbOuçutDñayLígthMöus1
 (9);

867 
I¡
 
i
, 
j
;

868 
UI¡
 
bôøãVÆue
, 
˝bSizeVÆue
;

869 
UI¡
 
duCpbSizeVÆue
;

870 
UI¡
 
duBôR©eVÆue
 = 0;

872  
i
 = 0; i < 
MAX_TLAYER
; i ++ )

874 
hrd
->
	`£tFixedPicR©eFœg
–
i
, 1 );

875 
hrd
->
	`£tPicDuøti⁄InTcMöus1
–
i
, 0 );

876 
hrd
->
	`£tLowDñayHrdFœg
–
i
, 0 );

877 
hrd
->
	`£tCpbC¡Möus1
–
i
, 0 );

881 
bôøãVÆue
 = 
bôR©e
 / (1 << (6 + 
hrd
->
	`gëBôR©eSˇÀ
()) );

883 
˝bSizeVÆue
 = 
˝bSize
 / (1 << (4 + 
hrd
->
	`gëCpbSizeSˇÀ
()) );

887 
duCpbSizeVÆue
 = 
bôøãVÆue
;

888 
duBôR©eVÆue
 = 
˝bSizeVÆue
;

890  
j
 = 0; j < ( 
hrd
->
	`gëCpbC¡Möus1
–
i
 ) + 1 ); j ++ )

892 
hrd
->
	`£tBôR©eVÆueMöus1
–
i
, 
j
, 0, ( 
bôøãVÆue
 - 1 ) );

893 
hrd
->
	`£tCpbSizeVÆueMöus1
–
i
, 
j
, 0, ( 
˝bSizeVÆue
 - 1 ) );

894 
hrd
->
	`£tDuCpbSizeVÆueMöus1
–
i
, 
j
, 0, ( 
duCpbSizeVÆue
 - 1 ) );

895 
hrd
->
	`£tDuBôR©eVÆueMöus1
–
i
, 
j
, 0, ( 
duBôR©eVÆue
 - 1 ) );

896 
hrd
->
	`£tCbrFœg
–
i
, 
j
, 0, 
Ál£
 );

898 
hrd
->
	`£tBôR©eVÆueMöus1
–
i
, 
j
, 1, ( 
bôøãVÆue
 - 1) );

899 
hrd
->
	`£tCpbSizeVÆueMöus1
–
i
, 
j
, 1, ( 
˝bSizeVÆue
 - 1 ) );

900 
hrd
->
	`£tDuCpbSizeVÆueMöus1
–
i
, 
j
, 1, ( 
duCpbSizeVÆue
 - 1 ) );

901 
hrd
->
	`£tDuBôR©eVÆueMöus1
–
i
, 
j
, 1, ( 
duBôR©eVÆue
 - 1 ) );

902 
hrd
->
	`£tCbrFœg
–
i
, 
j
, 1, 
Ál£
 );

905 
	}
}

907 
Void
 
	gTEncT›
::
	$xInôPPS
(
TComPPS
 &
µs
, c⁄° 
TComSPS
 &
•s
)

910 
µs
.
	`£tSPSId
(
•s
.
	`gëSPSId
());

912 
µs
.
	`£tC⁄°øöedI¡øPªd
–
m_bU£C⁄°øöedI¡øPªd
 );

913 
Boﬁ
 
bU£DQP
 = (
	`gëMaxCuDQPDïth
(Ë> 0)? 
åue
 : 
Ál£
;

915 if((
	`gëMaxDñèQP
(Ë!0 )|| 
	`gëU£Ad≠tiveQP
())

917 
bU£DQP
 = 
åue
;

920 i‡–
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
() )

922 
bU£DQP
 = 
åue
;

925 i‡(
m_co°Mode
==
COST_SEQUENCE_LEVEL_LOSSLESS
 || m_co°Mode==
COST_LOSSLESS_CODING
)

927 
bU£DQP
=
Ál£
;

931 i‡–
m_RCE«bÀR©eC⁄åﬁ
 )

933 
µs
.
	`£tU£DQP
(
åue
);

934 
µs
.
	`£tMaxCuDQPDïth
( 0 );

936 if(
bU£DQP
)

938 
µs
.
	`£tU£DQP
(
åue
);

939 
µs
.
	`£tMaxCuDQPDïth
–
m_iMaxCuDQPDïth
 );

943 
µs
.
	`£tU£DQP
(
Ál£
);

944 
µs
.
	`£tMaxCuDQPDïth
( 0 );

947 i‡–
m_diffCuChromaQpOff£tDïth
 >= 0 )

949 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`£tDiffCuChromaQpOff£tDïth
(
m_diffCuChromaQpOff£tDïth
);

950 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`˛órChromaQpOff£tLi°
();

951 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`£tChromaQpOff£tLi°E¡ry
(1, 6, 6);

956 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`£tDiffCuChromaQpOff£tDïth
(0);

957 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`˛órChromaQpOff£tLi°
();

959 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`£tCrossComp⁄ítPªdi˘i⁄E«bÀdFœg
(
m_¸ossComp⁄ítPªdi˘i⁄E«bÀdFœg
);

960 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`£tLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_LUMA
, 
m_log2SaoOff£tSˇÀ
[CHANNEL_TYPE_LUMA ]);

961 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`£tLog2SaoOff£tSˇÀ
(
CHANNEL_TYPE_CHROMA
, 
m_log2SaoOff£tSˇÀ
[CHANNEL_TYPE_CHROMA]);

963 i‡(
	`gëWCGChromaQPC⁄åﬁ
().
	`isE«bÀd
())

965 c⁄° 
I¡
 
ba£Qp
=
m_iQP
+
µs
.
	`gëPPSId
();

966 c⁄° 
DoubÀ
 
chromaQp
 = 
m_wcgChromaQpC⁄åﬁ
.
chromaQpSˇÀ
 * 
ba£Qp
 + m_wcgChromaQpC⁄åﬁ.
chromaQpOff£t
;

967 c⁄° 
DoubÀ
 
dcbQP
 = 
m_wcgChromaQpC⁄åﬁ
.
chromaCbQpSˇÀ
 * 
chromaQp
;

968 c⁄° 
DoubÀ
 
d¸QP
 = 
m_wcgChromaQpC⁄åﬁ
.
chromaCrQpSˇÀ
 * 
chromaQp
;

969 c⁄° 
I¡
 
cbQP
 =(I¡)(
dcbQP
 + ( dcbQP < 0 ? -0.5 : 0.5) );

970 c⁄° 
I¡
 
¸QP
 =(I¡)(
d¸QP
 + ( dcrQP < 0 ? -0.5 : 0.5) );

971 
µs
.
	`£tQpOff£t
(
COMPONENT_Cb
, 
	`Clù3
–-12, 12, 
	`mö
(0, 
cbQP
Ë+ 
m_chromaCbQpOff£t
 ));

972 
µs
.
	`£tQpOff£t
(
COMPONENT_Cr
, 
	`Clù3
–-12, 12, 
	`mö
(0, 
¸QP
Ë+ 
m_chromaCrQpOff£t
));

976 
µs
.
	`£tQpOff£t
(
COMPONENT_Cb
, 
m_chromaCbQpOff£t
 );

977 
µs
.
	`£tQpOff£t
(
COMPONENT_Cr
, 
m_chromaCrQpOff£t
 );

979 
Boﬁ
 
bChromaDñèQPE«bÀd
 = 
Ál£
;

981 
bChromaDñèQPE«bÀd
 = ( 
m_¶i˚ChromaQpOff£tI¡øOrPîiodic
[0] || m_sliceChromaQpOffsetIntraOrPeriodic[1] );

982 if–!
bChromaDñèQPE«bÀd
 )

984  
I¡
 
i
=0; i<
m_iGOPSize
; i++ )

986 if–
m_GOPLi°
[
i
].
m_CbQPoff£t
 || m_GOPLi°[i].
m_CrQPoff£t
 )

988 
bChromaDñèQPE«bÀd
 = 
åue
;

994 
µs
.
	`£tSli˚ChromaQpFœg
(
bChromaDñèQPE«bÀd
);

996 
µs
.
	`£tE¡r›yCodögSyncE«bÀdFœg
–
m_íå›yCodögSyncE«bÀdFœg
 );

997 
µs
.
	`£tTûesE«bÀdFœg
–(
m_iNumCﬁumnsMöus1
 > 0 || 
m_iNumRowsMöus1
 > 0) );

998 
µs
.
	`£tU£WP
–
m_u£WeighãdPªd
 );

999 
µs
.
	`£tWPBiPªd
–
m_u£WeighãdBiPªd
 );

1000 
µs
.
	`£tOuçutFœgPª£¡Fœg
–
Ál£
 );

1001 
µs
.
	`£tSignD©aHidögE«bÀdFœg
(
	`gëSignD©aHidögE«bÀdFœg
());

1003 i‡–
	`gëDeblockögFûãrMëric
() )

1005 
µs
.
	`£tDeblockögFûãrOvîrideE«bÀdFœg
(
åue
);

1006 
µs
.
	`£tPPSDeblockögFûãrDißbÀdFœg
(
Ál£
);

1010 
µs
.
	`£tDeblockögFûãrOvîrideE«bÀdFœg
–!
	`gëLo›FûãrOff£tInPPS
() );

1011 
µs
.
	`£tPPSDeblockögFûãrDißbÀdFœg
–
	`gëLo›FûãrDißbÀ
() );

1014 i‡(! 
µs
.
	`gëPPSDeblockögFûãrDißbÀdFœg
())

1016 
µs
.
	`£tDeblockögFûãrBëaOff£tDiv2
–
	`gëLo›FûãrBëaOff£t
() );

1017 
µs
.
	`£tDeblockögFûãrTcOff£tDiv2
–
	`gëLo›FûãrTcOff£t
() );

1021 
µs
.
	`£tDeblockögFûãrBëaOff£tDiv2
(0);

1022 
µs
.
	`£tDeblockögFûãrTcOff£tDiv2
(0);

1026 c⁄° 
Boﬁ
 
deblockögFûãrC⁄åﬁPª£¡Fœg
 = 
µs
.
	`gëDeblockögFûãrOvîrideE«bÀdFœg
() ||

1027 
µs
.
	`gëPPSDeblockögFûãrDißbÀdFœg
() ||

1028 
µs
.
	`gëDeblockögFûãrBëaOff£tDiv2
() != 0 ||

1029 
µs
.
	`gëDeblockögFûãrTcOff£tDiv2
() != 0;

1031 
µs
.
	`£tDeblockögFûãrC⁄åﬁPª£¡Fœg
(
deblockögFûãrC⁄åﬁPª£¡Fœg
);

1033 
µs
.
	`£tLog2P¨ÆÀlMîgeLevñMöus2
 (
m_log2P¨ÆÀlMîgeLevñMöus2
 );

1034 
µs
.
	`£tCabacInôPª£¡Fœg
(
CABAC_INIT_PRESENT_FLAG
);

1035 
µs
.
	`£tLo›FûãrA¸ossSli˚sE«bÀdFœg
–
m_bLFCrossSli˚Bound¨yFœg
 );

1038 
I¡
 
hi°ogøm
[
MAX_NUM_REF
 + 1];

1039  
I¡
 
i
 = 0; i <
MAX_NUM_REF
; i++ )

1041 
hi°ogøm
[
i
]=0;

1043  
I¡
 
i
 = 0; i < 
	`gëGOPSize
(); i++)

1045 
	`as£π
(
	`gëGOPE¡ry
(
i
).
m_numRefPicsA˘ive
 >0 && gëGOPE¡ry(i).m_numRefPicsA˘ivê<
MAX_NUM_REF
);

1046 
hi°ogøm
[
	`gëGOPE¡ry
(
i
).
m_numRefPicsA˘ive
]++;

1049 
I¡
 
maxHi°
=-1;

1050 
I¡
 
be°Pos
=0;

1051  
I¡
 
i
 = 0; i <
MAX_NUM_REF
; i++ )

1053 if(
hi°ogøm
[
i
]>
maxHi°
)

1055 
maxHi°
=
hi°ogøm
[
i
];

1056 
be°Pos
=
i
;

1059 
	`as£π
(
be°Pos
 <= 15);

1060 
µs
.
	`£tNumRefIdxL0DeÁu…A˘ive
(
be°Pos
);

1061 
µs
.
	`£tNumRefIdxL1DeÁu…A˘ive
(
be°Pos
);

1062 
µs
.
	`£tTønsqu™tBy∑ssE«bÀdFœg
(
	`gëTønsqu™tBy∑ssE«bÀdFœg
());

1063 
µs
.
	`£tU£Tønsf‹mSkù
–
m_u£Tønsf‹mSkù
 );

1064 
µs
.
	`gëPpsR™geExãnsi⁄
().
	`£tLog2MaxTønsf‹mSkùBlockSize
–
m_log2MaxTønsf‹mSkùBlockSize
 );

1066 i‡(
m_¶i˚SegmítMode
 !
NO_SLICES
)

1068 
µs
.
	`£tDïídítSli˚SegmítsE«bÀdFœg
–
åue
 );

1071 
	`xInôPPSf‹Tûes
(
µs
);

1072 
	}
}

1075 
Void
 
	gTEncT›
::
	$xInôRPS
(
TComSPS
 &
•s
, 
Boﬁ
 
isFõldCodög
)

1077 
TComRe„ªn˚Pi˘uªSë
* 
Ωs
;

1079 
•s
.
	`¸óãRPSLi°
(
	`gëGOPSize
(Ë+ 
m_exåaRPSs
 + 1);

1080 
TComRPSLi°
* 
ΩsLi°
 = 
•s
.
	`gëRPSLi°
();

1082  
I¡
 
i
 = 0; i < 
	`gëGOPSize
()+
m_exåaRPSs
; i++)

1084 c⁄° 
GOPE¡ry
 &
ge
 = 
	`gëGOPE¡ry
(
i
);

1085 
Ωs
 = 
ΩsLi°
->
	`gëRe„ªn˚Pi˘uªSë
(
i
);

1086 
Ωs
->
	`£tNumbîOfPi˘uªs
(
ge
.
m_numRefPics
);

1087 
Ωs
->
	`£tNumRefIdc
(
ge
.
m_numRefIdc
);

1088 
I¡
 
numNeg
 = 0;

1089 
I¡
 
numPos
 = 0;

1090  
I¡
 
j
 = 0; j < 
ge
.
m_numRefPics
; j++)

1092 
Ωs
->
	`£tDñèPOC
(
j
,
ge
.
m_ª„ªn˚Pics
[j]);

1093 
Ωs
->
	`£tU£d
(
j
,
ge
.
m_u£dByCuºPic
[j]);

1094 if(
ge
.
m_ª„ªn˚Pics
[
j
]>0)

1096 
numPos
++;

1100 
numNeg
++;

1103 
Ωs
->
	`£tNumbîOfNeg©ivePi˘uªs
(
numNeg
);

1104 
Ωs
->
	`£tNumbîOfPosôivePi˘uªs
(
numPos
);

1107 
Ωs
->
	`£tI¡îRPSPªdi˘i⁄
(
ge
.
m_öãrRPSPªdi˘i⁄
 > 0);

1108 
Ωs
->
	`£tDñèRIdxMöus1
(0);

1109 
TComRe„ªn˚Pi˘uªSë
* 
RPSRef
 = 
i
>0 ? 
ΩsLi°
->
	`gëRe„ªn˚Pi˘uªSë
(i-1): 
NULL
;

1111 i‡(
ge
.
m_öãrRPSPªdi˘i⁄
 == 2)

1113 
	`as£π
 (
RPSRef
!=
NULL
);

1114 
I¡
 
dñèRPS
 = 
	`gëGOPE¡ry
(
i
-1).
m_POC
 - 
ge
.m_POC;

1115 
I¡
 
numRefDñèPOC
 = 
RPSRef
->
	`gëNumbîOfPi˘uªs
();

1117 
Ωs
->
	`£tDñèRPS
(
dñèRPS
);

1118 
Ωs
->
	`£tNumRefIdc
(
numRefDñèPOC
+1);

1119 
I¡
 
cou¡
=0;

1120 
I¡
 
j
 = 0; j <
numRefDñèPOC
; j++ )

1122 
I¡
 
RefDñèPOC
 = (
j
<
numRefDñèPOC
)? 
RPSRef
->
	`gëDñèPOC
(j): 0;

1123 
Ωs
->
	`£tRefIdc
(
j
, 0);

1124 
I¡
 
k
 = 0; k < 
Ωs
->
	`gëNumbîOfPi˘uªs
(); k++ )

1126 i‡(
Ωs
->
	`gëDñèPOC
(
k
Ë=–
RefDñèPOC
 + 
dñèRPS
))

1128 
Ωs
->
	`£tRefIdc
(
j
, (Ωs->
	`gëU£d
(
k
)?1:2));

1129 
cou¡
++;

1134 i‡(
cou¡
 !
Ωs
->
	`gëNumbîOfPi˘uªs
())

1136 
	`¥ötf
("Warning: Unable fullyÖredictáll delta POCs usingÅheÑeference RPS index given inÅhe config file. Setting Inter RPSÅo false forÅhis RPS.\n");

1137 
Ωs
->
	`£tI¡îRPSPªdi˘i⁄
(0);

1140 i‡(
ge
.
m_öãrRPSPªdi˘i⁄
 == 1)

1142 
	`as£π
 (
RPSRef
!=
NULL
);

1143 
Ωs
->
	`£tDñèRPS
(
ge
.
m_dñèRPS
);

1144 
Ωs
->
	`£tNumRefIdc
(
ge
.
m_numRefIdc
);

1145 
I¡
 
j
 = 0; j < 
ge
.
m_numRefIdc
; j++ )

1147 
Ωs
->
	`£tRefIdc
(
j
, 
ge
.
m_ªfIdc
[j]);

1151 
numNeg
 = 0;

1152 
numPos
 = 0;

1153 
TComRe„ªn˚Pi˘uªSë
 
RPSTemp
;

1155 
I¡
 
j
 = 0; j < 
ge
.
m_numRefIdc
; j++ )

1157 i‡(
ge
.
m_ªfIdc
[
j
])

1159 
I¡
 
dñèPOC
 = 
ge
.
m_dñèRPS
 + ((
j
 < 
RPSRef
->
	`gëNumbîOfPi˘uªs
())? RPSRef->
	`gëDñèPOC
(j) : 0);

1160 
RPSTemp
.
	`£tDñèPOC
((
numNeg
+
numPos
),
dñèPOC
);

1161 
RPSTemp
.
	`£tU£d
((
numNeg
+
numPos
),
ge
.
m_ªfIdc
[
j
]==1?1:0);

1162 i‡(
dñèPOC
<0)

1164 
numNeg
++;

1168 
numPos
++;

1172 i‡(
numNeg
 !
Ωs
->
	`gëNumbîOfNeg©ivePi˘uªs
())

1174 
	`¥ötf
("Warning:Çumber ofÇegativeÖictures in RPS is different between intraánd inter RPS specified inÅhe config file.\n");

1175 
Ωs
->
	`£tNumbîOfNeg©ivePi˘uªs
(
numNeg
);

1176 
Ωs
->
	`£tNumbîOfPi˘uªs
(
numNeg
+
numPos
);

1178 i‡(
numPos
 !
Ωs
->
	`gëNumbîOfPosôivePi˘uªs
())

1180 
	`¥ötf
("Warning:Çumber ofÖositiveÖictures in RPS is different between intraánd inter RPS specified inÅhe config file.\n");

1181 
Ωs
->
	`£tNumbîOfPosôivePi˘uªs
(
numPos
);

1182 
Ωs
->
	`£tNumbîOfPi˘uªs
(
numNeg
+
numPos
);

1184 
RPSTemp
.
	`£tNumbîOfPi˘uªs
(
numNeg
+
numPos
);

1185 
RPSTemp
.
	`£tNumbîOfNeg©ivePi˘uªs
(
numNeg
);

1186 
RPSTemp
.
	`s‹tDñèPOC
();

1189 
I¡
 
j
 = 0; j < 
ge
.
m_numRefIdc
; j++ )

1191 i‡(
RPSTemp
.
	`gëDñèPOC
(
j
Ë!
Ωs
->getDeltaPOC(j))

1193 
	`¥ötf
("Warning: delta POC is different between intra RPSánd inter RPS specified inÅhe config file.\n");

1194 
Ωs
->
	`£tDñèPOC
(
j
,
RPSTemp
.
	`gëDñèPOC
(j));

1196 i‡(
RPSTemp
.
	`gëU£d
(
j
Ë!
Ωs
->getUsed(j))

1198 
	`¥ötf
("Warning: Used by Current in RPS is different between intraánd inter RPS specified inÅhe config file.\n");

1199 
Ωs
->
	`£tU£d
(
j
,
RPSTemp
.
	`gëU£d
(j));

1206 i‡(
isFõldCodög
)

1208 
Ωs
 = 
ΩsLi°
->
	`gëRe„ªn˚Pi˘uªSë
(
	`gëGOPSize
()+
m_exåaRPSs
);

1209 
Ωs
->
	`£tNumbîOfPi˘uªs
(1);

1210 
Ωs
->
	`£tNumbîOfNeg©ivePi˘uªs
(1);

1211 
Ωs
->
	`£tNumbîOfPosôivePi˘uªs
(0);

1212 
Ωs
->
	`£tNumbîOfL⁄gãrmPi˘uªs
(0);

1213 
Ωs
->
	`£tDñèPOC
(0,-1);

1214 
Ωs
->
	`£tPOC
(0,0);

1215 
Ωs
->
	`£tU£d
(0,
åue
);

1216 
Ωs
->
	`£tI¡îRPSPªdi˘i⁄
(
Ál£
);

1217 
Ωs
->
	`£tDñèRIdxMöus1
(0);

1218 
Ωs
->
	`£tDñèRPS
(0);

1219 
Ωs
->
	`£tNumRefIdc
(0);

1221 
	}
}

1226 
Void
 
	gTEncT›
::
	$£À˘Re„ªn˚Pi˘uªSë
(
TComSli˚
* 
¶i˚
, 
I¡
 
POCCuº
, I¡ 
GOPid
 )

1228 
¶i˚
->
	`£tRPSidx
(
GOPid
);

1230 
I¡
 
exåaNum
=
m_iGOPSize
;ÉxåaNum<
m_exåaRPSs
+m_iGOPSize;ÉxtraNum++)

1232 if(
m_uiI¡øPîiod
 > 0 && 
	`gëDecodögRe‰eshTy≥
() > 0)

1234 
I¡
 
POCIndex
 = 
POCCuº
%
m_uiI¡øPîiod
;

1235 if(
POCIndex
 == 0)

1237 
POCIndex
 = 
m_uiI¡øPîiod
;

1239 if(
POCIndex
 =
m_GOPLi°
[
exåaNum
].
m_POC
)

1241 
¶i˚
->
	`£tRPSidx
(
exåaNum
);

1246 if(
POCCuº
==
m_GOPLi°
[
exåaNum
].
m_POC
)

1248 
¶i˚
->
	`£tRPSidx
(
exåaNum
);

1253 if(
POCCuº
 =1 && 
¶i˚
->
	`gëPic
()->
	`isFõld
())

1255 
¶i˚
->
	`£tRPSidx
(
m_iGOPSize
+
m_exåaRPSs
);

1258 c⁄° 
TComRe„ªn˚Pi˘uªSë
 *
Ωs
 = (
¶i˚
->
	`gëSPS
()->
	`gëRPSLi°
()->
	`gëRe„ªn˚Pi˘uªSë
(¶i˚->
	`gëRPSidx
()));

1259 
¶i˚
->
	`£tRPS
(
Ωs
);

1260 
	}
}

1262 
I¡
 
	gTEncT›
::
	$gëRe„ªn˚Pi˘uªSëIdxF‹SOP
(
I¡
 
POCCuº
, I¡ 
GOPid
 )

1264 
I¡
 
ΩsIdx
 = 
GOPid
;

1266 
I¡
 
exåaNum
=
m_iGOPSize
;ÉxåaNum<
m_exåaRPSs
+m_iGOPSize;ÉxtraNum++)

1268 if(
m_uiI¡øPîiod
 > 0 && 
	`gëDecodögRe‰eshTy≥
() > 0)

1270 
I¡
 
POCIndex
 = 
POCCuº
%
m_uiI¡øPîiod
;

1271 if(
POCIndex
 == 0)

1273 
POCIndex
 = 
m_uiI¡øPîiod
;

1275 if(
POCIndex
 =
m_GOPLi°
[
exåaNum
].
m_POC
)

1277 
ΩsIdx
 = 
exåaNum
;

1282 if(
POCCuº
==
m_GOPLi°
[
exåaNum
].
m_POC
)

1284 
ΩsIdx
 = 
exåaNum
;

1289  
ΩsIdx
;

1290 
	}
}

1292 
Void
 
	gTEncT›
::
	$xInôPPSf‹Tûes
(
TComPPS
 &
µs
)

1294 
µs
.
	`£tTûeUnif‹mS∑cögFœg
–
m_tûeUnif‹mS∑cögFœg
 );

1295 
µs
.
	`£tNumTûeCﬁumnsMöus1
–
m_iNumCﬁumnsMöus1
 );

1296 
µs
.
	`£tNumTûeRowsMöus1
–
m_iNumRowsMöus1
 );

1297 if–!
m_tûeUnif‹mS∑cögFœg
 )

1299 
µs
.
	`£tTûeCﬁumnWidth
–
m_tûeCﬁumnWidth
 );

1300 
µs
.
	`£tTûeRowHeight
–
m_tûeRowHeight
 );

1302 
µs
.
	`£tLo›FûãrA¸ossTûesE«bÀdFœg
–
m_lo›FûãrA¸ossTûesE«bÀdFœg
 );

1305 
	}
}

1307 
Void
 
	gTEncCfg
::
	$xCheckGSP¨amëîs
()

1309 
I¡
 
iWidthInCU
 = ( 
m_iSour˚Width
%
m_maxCUWidth
 ) ? m_iSourceWidth/m_maxCUWidth + 1 : m_iSourceWidth/m_maxCUWidth;

1310 
I¡
 
iHeightInCU
 = ( 
m_iSour˚Height
%
m_maxCUHeight
 ) ? m_iSourceHeight/m_maxCUHeight + 1 : m_iSourceHeight/m_maxCUHeight;

1311 
UI¡
 
uiCummuœtiveCﬁumnWidth
 = 0;

1312 
UI¡
 
uiCummuœtiveRowHeight
 = 0;

1315 if–
m_iNumCﬁumnsMöus1
 >(1<<(
LOG2_MAX_NUM_COLUMNS_MINUS1
+1)) )

1317 
	`¥ötf
( "TheÇumber of columns isÜargerÅhanÅhe maximumállowedÇumber of columns.\n" );

1318 
	`exô
–
EXIT_FAILURE
 );

1321 if–
m_iNumCﬁumnsMöus1
 >
iWidthInCU
 )

1323 
	`¥ötf
( "The currentÖicture canÇot have so many columns.\n" );

1324 
	`exô
–
EXIT_FAILURE
 );

1327 if–
m_iNumCﬁumnsMöus1
 && !
m_tûeUnif‹mS∑cögFœg
 )

1329 
I¡
 
i
=0; i<
m_iNumCﬁumnsMöus1
; i++)

1331 
uiCummuœtiveCﬁumnWidth
 +
m_tûeCﬁumnWidth
[
i
];

1334 if–
uiCummuœtiveCﬁumnWidth
 >
iWidthInCU
 )

1336 
	`¥ötf
( "The width ofÅhe column isÅooÜarge.\n" );

1337 
	`exô
–
EXIT_FAILURE
 );

1342 if–
m_iNumRowsMöus1
 >(1<<(
LOG2_MAX_NUM_ROWS_MINUS1
+1)) )

1344 
	`¥ötf
( "TheÇumber ofÑows isÜargerÅhanÅhe maximumállowedÇumber ofÑows.\n" );

1345 
	`exô
–
EXIT_FAILURE
 );

1348 if–
m_iNumRowsMöus1
 >
iHeightInCU
 )

1350 
	`¥ötf
( "The currentÖicture canÇot have so manyÑows.\n" );

1351 
	`exô
–
EXIT_FAILURE
 );

1354 if–
m_iNumRowsMöus1
 && !
m_tûeUnif‹mS∑cögFœg
 )

1356 
I¡
 
i
=0; i<
m_iNumRowsMöus1
; i++)

1358 
uiCummuœtiveRowHeight
 +
m_tûeRowHeight
[
i
];

1361 if–
uiCummuœtiveRowHeight
 >
iHeightInCU
 )

1363 
	`¥ötf
( "The height ofÅheÑow isÅooÜarge.\n" );

1364 
	`exô
–
EXIT_FAILURE
 );

1367 
	}
}

1369 
Void
 
	gTEncT›
::
	$£tP¨amSëCh™ged
(
I¡
 
•sId
, I¡ 
µsId
)

1371 
m_µsM≠
.
	`£tCh™gedFœg
(
µsId
);

1372 
m_•sM≠
.
	`£tCh™gedFœg
(
•sId
);

1373 
	}
}

1375 
Boﬁ
 
	gTEncT›
::
	$PPSNìdsWrôög
(
I¡
 
µsId
)

1377 
Boﬁ
 
bCh™ged
=
m_µsM≠
.
	`gëCh™gedFœg
(
µsId
);

1378 
m_µsM≠
.
	`˛órCh™gedFœg
(
µsId
);

1379  
bCh™ged
;

1380 
	}
}

1382 
Boﬁ
 
	gTEncT›
::
	$SPSNìdsWrôög
(
I¡
 
•sId
)

1384 
Boﬁ
 
bCh™ged
=
m_•sM≠
.
	`gëCh™gedFœg
(
•sId
);

1385 
m_•sM≠
.
	`˛órCh™gedFœg
(
•sId
);

1386  
bCh™ged
;

1387 
	}
}

1389 
I¡
 
	gTEncCfg
::
	$gëQPF‹Pi˘uª
(c⁄° 
UI¡
 
g›Index
, c⁄° 
TComSli˚
 *
pSli˚
) const

1391 c⁄° 
I¡
 
lumaQpBDOff£t
 = 
pSli˚
->
	`gëSPS
()->
	`gëQpBDOff£t
(
CHANNEL_TYPE_LUMA
);

1392 
I¡
 
qp
;

1394 i‡(
	`gëCo°Mode
()==
COST_LOSSLESS_CODING
)

1396 
qp
=
LOSSLESS_AND_MIXED_LOSSLESS_RD_COST_TEST_QP
;

1400 c⁄° 
Sli˚Ty≥
 
¶i˚Ty≥
=
pSli˚
->
	`gëSli˚Ty≥
();

1402 
qp
 = 
	`gëBa£QP
();

1405 c⁄° 
I¡
* 
pdQPs
 = 
	`gëdQPs
();

1406 i‡–
pdQPs
 )

1408 
qp
 +
pdQPs
[ 
pSli˚
->
	`gëPOC
() ];

1411 if(
¶i˚Ty≥
==
I_SLICE
)

1413 
qp
 +
	`gëI¡øQPOff£t
();

1418 i‡(!(–
	`gëMaxDñèQP
(Ë=0 ) && (!
	`gëLumaLevñToDñèQPM≠pög
().
	`isE«bÀd
()Ë&& (
qp
 =-
lumaQpBDOff£t
 ) && (
pSli˚
->
	`gëPPS
()->
	`gëTønsqu™tBy∑ssE«bÀdFœg
())))

1420 c⁄° 
GOPE¡ry
 &
g›E¡ry
=
	`gëGOPE¡ry
(
g›Index
);

1422 
qp
 +=
g›E¡ry
.
m_QPOff£t
;

1425 
DoubÀ
 
dqpOff£t
=
qp
*
g›E¡ry
.
m_QPOff£tModñSˇÀ
+g›E¡ry.
m_QPOff£tModñOff£t
+0.5;

1426 
I¡
 
qpOff£t
 = (I¡)
	`Êo‹
(
Clù3
<
DoubÀ
>(0.0, 3.0, 
dqpOff£t
));

1427 
qp
 +
qpOff£t
 ;

1432 
qp
 = 
	`Clù3
–-
lumaQpBDOff£t
, 
MAX_QP
, qp );

1433  
qp
;

1434 
	}
}

	@TLibEncoder/TEncTop.h

38 #i‚de‡
__TENCTOP__


39 
	#__TENCTOP__


	)

42 
	~"TLibComm⁄/TComLi°.h
"

43 
	~"TLibComm⁄/TComPªdi˘i⁄.h
"

44 
	~"TLibComm⁄/TComTrQu™t.h
"

45 
	~"TLibComm⁄/TComLo›Fûãr.h
"

46 
	~"TLibComm⁄/Ac˚ssUnô.h
"

48 
	~"Utûôõs/TVideoIOYuv.h
"

50 
	~"TEncCfg.h
"

51 
	~"TEncGOP.h
"

52 
	~"TEncSli˚.h
"

53 
	~"TEncE¡r›y.h
"

54 
	~"TEncCavlc.h
"

55 
	~"TEncSbac.h
"

56 
	~"TEncSórch.h
"

57 
	~"TEncSam∂eAd≠tiveOff£t.h
"

58 
	~"TEncPª™Æyzî.h
"

59 
	~"TEncR©eCål.h
"

68 ˛as†
	cTEncT›
 : 
public
 
TEncCfg


70 
¥iv©e
:

72 
I¡
 
m_iPOCLa°
;

73 
I¡
 
	mm_iNumPicRcvd
;

74 
UI¡
 
	mm_uiNumAŒPicCoded
;

75 
	mTComLi°
<
	mTComPic
*> 
	mm_cLi°Pic
;

78 
TEncSórch
 
	mm_cSórch
;

80 
TEncCavlc
* 
	mm_pcCavlcCodî
;

82 
TComTrQu™t
 
	mm_cTrQu™t
;

83 
TComLo›Fûãr
 
	mm_cLo›Fûãr
;

84 
TEncSam∂eAd≠tiveOff£t
 
	mm_cEncSAO
;

85 
TEncE¡r›y
 
	mm_cE¡r›yCodî
;

86 
TEncCavlc
 
	mm_cCavlcCodî
;

87 
TEncSbac
 
	mm_cSbacCodî
;

88 
TEncBöCABAC
 
	mm_cBöCodîCABAC
;

91 
TEncGOP
 
	mm_cGOPEncodî
;

92 
TEncSli˚
 
	mm_cSli˚Encodî
;

93 
TEncCu
 
	mm_cCuEncodî
;

95 
	mP¨amëîSëM≠
<
	mTComSPS
> 
	mm_•sM≠
;

96 
	mP¨amëîSëM≠
<
	mTComPPS
> 
	mm_µsM≠
;

98 
TComRdCo°
 
	mm_cRdCo°
;

99 
TEncSbac
*** 
	mm_µpcRDSbacCodî
;

100 
TEncSbac
 
	mm_cRDGoOnSbacCodî
;

101 #i‡
FAST_BIT_EST


102 
TEncBöCABACCou¡î
*** 
	mm_µpcBöCodîCABAC
;

103 
TEncBöCABACCou¡î
 
	mm_cRDGoOnBöCodîCABAC
;

105 
TEncBöCABAC
*** 
	mm_µpcBöCodîCABAC
;

106 
TEncBöCABAC
 
	mm_cRDGoOnBöCodîCABAC
;

110 
TEncPª™Æyzî
 
	mm_cPª™Æyzî
;

112 
TEncR©eCål
 
	mm_cR©eCål
;

114 
	m¥Ÿe˘ed
:

115 
Void
 
xGëNewPicBuf„r
 ( 
TComPic
*& 
ΩcPic
, 
I¡
 
µsId
 );

116 
Void
 
xInôVPS
 (
TComVPS
 &
vps
, c⁄° 
TComSPS
 &
•s
);

117 
Void
 
xInôSPS
 (
TComSPS
 &
•s
);

118 
Void
 
xInôPPS
 (
TComPPS
 &
µs
, c⁄° 
TComSPS
 &
•s
);

119 
Void
 
xInôSˇlögLi°s
 (
TComSPS
 &
•s
, 
TComPPS
 &
µs
);

120 
Void
 
xInôHrdP¨amëîs
(
TComSPS
 &
•s
);

122 
Void
 
xInôPPSf‹Tûes
 (
TComPPS
 &
µs
);

123 
Void
 
xInôRPS
 (
TComSPS
 &
•s
, 
Boﬁ
 
isFõldCodög
);

125 
	mpublic
:

126 
TEncT›
();

127 
	mvútuÆ
 ~
TEncT›
();

129 
Void
 
¸óã
 ();

130 
Void
 
de°roy
 ();

131 
Void
 
öô
 (
Boﬁ
 
isFõldCodög
);

132 
Void
 
dñëePicBuf„r
 ();

138 
	mTComLi°
<
	mTComPic
*>* 
	$gëLi°Pic
 (Ë{  &
m_cLi°Pic
; }

139 
TEncSórch
* 
	$gëPªdSórch
 (Ë{  &
m_cSórch
; 
	}
}

141 
TComTrQu™t
* 
	$gëTrQu™t
 (Ë{  &
m_cTrQu™t
; 
	}
}

142 
TComLo›Fûãr
* 
	$gëLo›Fûãr
 (Ë{  &
m_cLo›Fûãr
; 
	}
}

143 
TEncSam∂eAd≠tiveOff£t
* 
	$gëSAO
 (Ë{  &
m_cEncSAO
; 
	}
}

144 
TEncGOP
* 
	$gëGOPEncodî
 (Ë{  &
m_cGOPEncodî
; 
	}
}

145 
TEncSli˚
* 
	$gëSli˚Encodî
 (Ë{  &
m_cSli˚Encodî
; 
	}
}

146 
TEncCu
* 
	$gëCuEncodî
 (Ë{  &
m_cCuEncodî
; 
	}
}

147 
TEncE¡r›y
* 
	$gëE¡r›yCodî
 (Ë{  &
m_cE¡r›yCodî
; 
	}
}

148 
TEncCavlc
* 
	$gëCavlcCodî
 (Ë{  &
m_cCavlcCodî
; 
	}
}

149 
TEncSbac
* 
	$gëSbacCodî
 (Ë{  &
m_cSbacCodî
; 
	}
}

150 
TEncBöCABAC
* 
	$gëBöCABAC
 (Ë{  &
m_cBöCodîCABAC
; 
	}
}

152 
TComRdCo°
* 
	$gëRdCo°
 (Ë{  &
m_cRdCo°
; 
	}
}

153 
TEncSbac
*** 
	$gëRDSbacCodî
 (Ë{  
m_µpcRDSbacCodî
; 
	}
}

154 
TEncSbac
* 
	$gëRDGoOnSbacCodî
 (Ë{  &
m_cRDGoOnSbacCodî
; 
	}
}

155 
TEncR©eCål
* 
	$gëR©eCål
 (Ë{  &
m_cR©eCål
; 
	}
}

156 
Void
 
£À˘Re„ªn˚Pi˘uªSë
(
TComSli˚
* 
¶i˚
, 
I¡
 
POCCuº
, I¡ 
GOPid
 );

157 
I¡
 
gëRe„ªn˚Pi˘uªSëIdxF‹SOP
(I¡ 
POCCuº
, I¡ 
GOPid
 );

159 
Void
 
£tP¨amSëCh™ged
(
I¡
 
•sId
, I¡ 
µsId
);

160 
Boﬁ
 
PPSNìdsWrôög
(
I¡
 
µsId
);

161 
Boﬁ
 
SPSNìdsWrôög
(
I¡
 
•sId
);

168 
Void
 
ícode
–
Boﬁ
 
bEos
,

169 
TComPicYuv
* 
pcPicYuvOrg
,

170 
TComPicYuv
* 
pcPicYuvTrueOrg
,

171 c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢rCSC
,

172 
TComLi°
<
TComPicYuv
*>& 
rcLi°PicYuvRecOut
,

173 
°d
::
li°
<
Ac˚ssUnô
>& 
ac˚ssUnôsOut
, 
I¡
& 
iNumEncoded
 );

176 
Void
 
ícode
–
Boﬁ
 
bEos
, 
TComPicYuv
* 
pcPicYuvOrg
,

177 
TComPicYuv
* 
pcPicYuvTrueOrg
,

178 c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, c⁄° I≈utCﬁourS∑˚C⁄vîsi⁄ 
¢rCSC
,

179 
TComLi°
<
TComPicYuv
*>& 
rcLi°PicYuvRecOut
,

180 
°d
::
li°
<
Ac˚ssUnô
>& 
ac˚ssUnôsOut
, 
I¡
& 
iNumEncoded
, 
Boﬁ
 
isTff
);

182 
	gTEncA«lyze
::
OuçutLogC⁄åﬁ
 
	$gëOuçutLogC⁄åﬁ
() const

184 
TEncA«lyze
::
OuçutLogC⁄åﬁ
 
ouçutLogCål
;

185 
ouçutLogCål
.
¥ötFømeMSE
=
m_¥ötFømeMSE
;

186 
ouçutLogCål
.
¥ötMSEBa£dSNR
=
m_¥ötMSEBa£dSequí˚PSNR
;

187 
ouçutLogCål
.
¥ötMSSSIM
=
m_¥ötMSSSIM
;

188 
ouçutLogCål
.
¥ötSequí˚MSE
=
m_¥ötSequí˚MSE
;

189 
ouçutLogCål
.
¥ötXPSNR
=
m_bXPSNRE«bÀFœg
;

190 
ouçutLogCål
.
¥ötHexPîPOCPSNRs
=
m_¥ötHexP¢r
;

191  
ouçutLogCål
;

192 
	}
}

194 
Void
 
	$¥ötSumm¨y
(
Boﬁ
 
isFõld
)

196 
m_cGOPEncodî
.
	`¥ötOutSumm¨y
 (
m_uiNumAŒPicCoded
, 
isFõld
, 
	`gëOuçutLogC⁄åﬁ
(), 
m_•sM≠
.
	`gëFú°PS
()->
	`gëBôDïths
());

197 
	}
}

	@TLibEncoder/WeightPredAnalysis.cpp

38 
	~"../TLibComm⁄/Comm⁄Def.h
"

39 
	~"../TLibComm⁄/TComSli˚.h
"

40 
	~"../TLibComm⁄/TComPic.h
"

41 
	~"../TLibComm⁄/TComPicYuv.h
"

42 
	~"WeightPªdA«lysis.h
"

43 
	~<limôs
>

45 c⁄° 
DoubÀ
 
	gWEIGHT_PRED_SAD_RELATIVE_TO_NON_WEIGHT_PRED_SAD
=0.99;

49 
I¡64
 
xCÆcSADvÆueWP
(c⁄° 
I¡
 
bôDïth
,

50 c⁄° 
Pñ
 *
pOrgPñ
,

51 c⁄° 
Pñ
 *
pRefPñ
,

52 c⁄° 
I¡
 
width
,

53 c⁄° 
I¡
 
height
,

54 c⁄° 
I¡
 
‹gSåide
,

55 c⁄° 
I¡
 
ªfSåide
,

56 c⁄° 
I¡
 
log2Díom
,

57 c⁄° 
I¡
 
weight
,

58 c⁄° 
I¡
 
off£t
,

59 c⁄° 
Boﬁ
 
u£HighPªcisi⁄
);

63 
I¡64
 
xCÆcSADvÆueWPO±i⁄ÆClù
(c⁄° 
I¡
 
bôDïth
,

64 c⁄° 
Pñ
 *
pOrgPñ
,

65 c⁄° 
Pñ
 *
pRefPñ
,

66 c⁄° 
I¡
 
width
,

67 c⁄° 
I¡
 
height
,

68 c⁄° 
I¡
 
‹gSåide
,

69 c⁄° 
I¡
 
ªfSåide
,

70 c⁄° 
I¡
 
log2Díom
,

71 c⁄° 
I¡
 
weight
,

72 c⁄° 
I¡
 
off£t
,

73 c⁄° 
Boﬁ
 
u£HighPªcisi⁄
,

74 c⁄° 
Boﬁ
 
˛ù≥d
);

82 
Void
 
xCÆcHi°ogøm
(c⁄° 
Pñ
 *
pPñ
,

83 
°d
::
ve˘‹
<
I¡
> &
hi°ogøm
,

84 c⁄° 
I¡
 
width
,

85 c⁄° 
I¡
 
height
,

86 c⁄° 
I¡
 
°ride
,

87 c⁄° 
I¡
 
maxPñ
)

89 
	ghi°ogøm
.
˛ór
();

90 
	ghi°ogøm
.
ªsize
(
maxPñ
);

91  
I¡
 
	gy
 = 0; y < 
	gheight
; y++ )

93  
I¡
 
	gx
 = 0; x < 
	gwidth
; x++ )

95 c⁄° 
Pñ
 
	gv
=
pPñ
[
x
];

96 
	ghi°ogøm
[
v
<0?0:(v>=
maxPñ
)?maxPel-1:v]++;

98 
	gpPñ
 +
°ride
;

103 
Di°‹ti⁄
 
xCÆcHi°Di°‹ti⁄
 (c⁄° 
°d
::
ve˘‹
<
I¡
> &
hi°ogøm0
,

104 c⁄° 
°d
::
ve˘‹
<
I¡
> &
hi°ogøm1
)

106 
Di°‹ti⁄
 
di°‹ti⁄
 = 0;

107 
as£π
(
hi°ogøm0
.
size
()==
hi°ogøm1
.size());

108 c⁄° 
I¡
 
	gnumEÀmíts
=I¡(
hi°ogøm0
.
size
());

111 
I¡
 
	gi
 = 0; i <
numEÀmíts
; i++)

113 
	gdi°‹ti⁄
 +(
Di°‹ti⁄
)(
abs
(
hi°ogøm0
[
i
] - 
hi°ogøm1
[i]));

116  
	gdi°‹ti⁄
;

120 
xSˇÀHi°ogøm
(c⁄° 
°d
::
ve˘‹
<
I¡
> &
hi°ogømI≈ut
,

121 
°d
::
ve˘‹
<
I¡
> &
hi°ogømOuçut
,

122 c⁄° 
I¡
 
bôDïth
,

123 c⁄° 
I¡
 
log2Díom
,

124 c⁄° 
I¡
 
weight
,

125 c⁄° 
I¡
 
off£t
,

126 c⁄° 
Boﬁ
 
bHighPªcisi⁄
)

128 
as£π
(&
hi°ogømI≈ut
 !&
hi°ogømOuçut
);

129 c⁄° 
I¡
 
	gnumEÀmíts
=I¡(
hi°ogømI≈ut
.
size
());

130 
	ghi°ogømOuçut
.
˛ór
();

131 
	ghi°ogømOuçut
.
ªsize
(
numEÀmíts
);

133 c⁄° 
I¡64
 
	giRólLog2Díom
 = 
bHighPªcisi⁄
 ? 0 : (
bôDïth
 - 8);

134 c⁄° 
I¡64
 
	giRólOff£t
 = ((I¡64)
off£t
)<<
iRólLog2Díom
;

136 c⁄° 
I¡
 
	gdivOff£t
 = 
log2Díom
 == 0 ? 0 : 1 << (log2Denom - 1);

141 
I¡
 
	gi
 = 0; i < 
	gnumEÀmíts
; i++)

143 c⁄° 
I¡
 
	gj
 = 
Clù3
(0, 
numEÀmíts
 - 1, (I¡)(((
weight
 * 
i
 + 
divOff£t
Ë>> 
log2Díom
Ë+ 
iRólOff£t
));

144 
	ghi°ogømOuçut
[
j
] +
hi°ogømI≈ut
[
i
];

149 
Di°‹ti⁄
 
xSórchHi°ogøm
(c⁄° 
°d
::
ve˘‹
<
I¡
> &
hi°ogømSour˚
,

150 c⁄° 
°d
::
ve˘‹
<
I¡
> &
hi°ogømRef
,

151 
°d
::
ve˘‹
<
I¡
> &
ouçutHi°ogøm
,

152 c⁄° 
I¡
 
bôDïth
,

153 c⁄° 
I¡
 
log2Díom
,

154 
I¡
 &
weightToUpd©e
,

155 
I¡
 &
off£tToUpd©e
,

156 c⁄° 
Boﬁ
 
bHighPªcisi⁄
,

157 c⁄° 
Comp⁄ítID
 
compID
)

159 c⁄° 
I¡
 
	göôülWeight
 = 
weightToUpd©e
;

160 c⁄° 
I¡
 
	göôülOff£t
 = 
off£tToUpd©e
;

161 c⁄° 
I¡
 
	gweightR™ge
 = 10;

162 c⁄° 
I¡
 
	goff£tR™ge
 = 10;

163 c⁄° 
I¡
 
	gmaxOff£t
 = 1 << ((
bHighPªcisi⁄
 =
åue
Ë? (
bôDïth
 - 1) : 7);

164 c⁄° 
I¡
 
	gønge
 = 
bHighPªcisi⁄
 ? (1<<
bôDïth
) / 2 : 128;

165 c⁄° 
I¡
 
	gdeÁu…Weight
 = (1<<
log2Díom
);

166 c⁄° 
I¡
 
	gmöSórchWeight
 = 
°d
::
max
<I¡>(
öôülWeight
 - 
weightR™ge
, 
	gdeÁu…Weight
 - 
	gønge
);

167 c⁄° 
I¡
 
	gmaxSórchWeight
 = 
°d
::
mö
<I¡>(
öôülWeight
 + 
weightR™ge
+1, 
	gdeÁu…Weight
 + 
	gønge
);

169 
Di°‹ti⁄
 
	gmöDi°‹ti⁄
 = 
°d
::
numîic_limôs
<Di°‹ti⁄>::
max
();

170 
I¡
 
	gbe°Weight
 = 
öôülWeight
;

171 
I¡
 
	gbe°Off£t
 = 
öôülOff£t
;

173 
I¡
 
	g£¨chWeight
 = 
möSórchWeight
; sórchWeighà< 
	gmaxSórchWeight
; searchWeight++)

175 i‡(
	gcompID
 =
COMPONENT_Y
)

177 
I¡
 
£¨chOff£t
 = 
°d
::
max
<I¡>(
öôülOff£t
 - 
off£tR™ge
, -
	gmaxOff£t
);

178 
	g£¨chOff£t
 <
öôülOff£t
 + 
off£tR™ge
 && 
£¨chOff£t
<=(
maxOff£t
-1);

179 
	g£¨chOff£t
++)

181 
xSˇÀHi°ogøm
(
hi°ogømRef
, 
ouçutHi°ogøm
, 
bôDïth
, 
log2Díom
, 
£¨chWeight
, 
£¨chOff£t
, 
bHighPªcisi⁄
);

182 c⁄° 
Di°‹ti⁄
 
	gdi°‹ti⁄
 = 
xCÆcHi°Di°‹ti⁄
(
hi°ogømSour˚
, 
ouçutHi°ogøm
);

184 i‡(
	gdi°‹ti⁄
 < 
	gmöDi°‹ti⁄
)

186 
	gmöDi°‹ti⁄
 = 
di°‹ti⁄
;

187 
	gbe°Weight
 = 
£¨chWeight
;

188 
	gbe°Off£t
 = 
£¨chOff£t
;

194 c⁄° 
I¡
 
	g¥ed
 = ( 
maxOff£t
 - ( ( maxOff£t*
£¨chWeight
)>>(
log2Díom
) ) );

196 
I¡
 
	g£¨chOff£t
 = 
öôülOff£t
 - 
off£tR™ge
; searchOffset <= initialOffset + offsetRange; searchOffset++)

198 c⁄° 
I¡
 
	gdñèOff£t
 = 
Clù3
–-4*
maxOff£t
, 4*maxOff£t-1, (
£¨chOff£t
 - 
¥ed
) );

199 c⁄° 
I¡
 
	g˛ù≥dOff£t
 = 
Clù3
–-1*
maxOff£t
, 1*maxOff£t-1, (
dñèOff£t
 + 
¥ed
) );

200 
xSˇÀHi°ogøm
(
hi°ogømRef
, 
ouçutHi°ogøm
, 
bôDïth
, 
log2Díom
, 
£¨chWeight
, 
˛ù≥dOff£t
, 
bHighPªcisi⁄
);

201 c⁄° 
Di°‹ti⁄
 
	gdi°‹ti⁄
 = 
xCÆcHi°Di°‹ti⁄
(
hi°ogømSour˚
, 
ouçutHi°ogøm
);

203 i‡(
	gdi°‹ti⁄
 < 
	gmöDi°‹ti⁄
)

205 
	gmöDi°‹ti⁄
 = 
di°‹ti⁄
;

206 
	gbe°Weight
 = 
£¨chWeight
;

207 
	gbe°Off£t
 = 
˛ù≥dOff£t
;

213 
	gweightToUpd©e
 = 
be°Weight
;

214 
	goff£tToUpd©e
 = 
be°Off£t
;

217 
xSˇÀHi°ogøm
(
hi°ogømRef
, 
ouçutHi°ogøm
, 
bôDïth
, 
log2Díom
, 
be°Weight
, 
be°Off£t
, 
bHighPªcisi⁄
);

219  
	gmöDi°‹ti⁄
;

226 
	gWeightPªdA«lysis
::
	$WeightPªdA«lysis
()

228  
UI¡
 
l°
 =0 ;Ü°<
NUM_REF_PIC_LIST_01
 ;Üst++ )

230  
I¡
 
ªfIdx
=0 ;ÑefIdx<
MAX_NUM_REF
 ;ÑefIdx++ )

232  
I¡
 
comp
=0 ; comp<
MAX_NUM_COMPONENT
 ;comp++ )

234 
WPSˇlögP¨am
 *
pwp
 = &(
m_wp
[
l°
][
ªfIdx
][
comp
]);

235 
pwp
->
bPª£¡Fœg
 = 
Ál£
;

236 
pwp
->
uiLog2WeightDíom
 = 0;

237 
pwp
->
iWeight
 = 1;

238 
pwp
->
iOff£t
 = 0;

242 
	}
}

246 
Void
 
	gWeightPªdA«lysis
::
	$xCÆcACDCP¨amSli˚
(
TComSli˚
 *c⁄° 
¶i˚
)

249 
TComPicYuv
* 
pPic
 = 
¶i˚
->
	`gëPic
()->
	`gëPicYuvOrg
();

251 
WPACDCP¨am
 
weightACDCP¨am
[
MAX_NUM_COMPONENT
];

253 
I¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
pPic
->
	`gëNumbîVÆidComp⁄íts
(); componentIndex++)

255 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp⁄ítIndex
);

259 c⁄° 
I¡
 
°ride
 = 
pPic
->
	`gëSåide
(
compID
);

260 c⁄° 
I¡
 
width
 = 
pPic
->
	`gëWidth
(
compID
);

261 c⁄° 
I¡
 
height
 = 
pPic
->
	`gëHeight
(
compID
);

263 c⁄° 
I¡
 
ßm∂e
 = 
width
*
height
;

265 
I¡64
 
‹gDC
 = 0;

267 c⁄° 
Pñ
 *
pPñ
 = 
pPic
->
	`gëAddr
(
compID
);

269 
I¡
 
y
 = 0; y < 
height
; y++, 
pPñ
+=
°ride
 )

271 
I¡
 
x
 = 0; x < 
width
; x++ )

273 
‹gDC
 +(
I¡
)–
pPñ
[
x
] );

278 c⁄° 
I¡64
 
‹gN‹mDC
 = ((
‹gDC
+(
ßm∂e
>>1)) / sample);

280 
I¡64
 
‹gAC
 = 0;

282 c⁄° 
Pñ
 *
pPñ
 = 
pPic
->
	`gëAddr
(
compID
);

284 
I¡
 
y
 = 0; y < 
height
; y++, 
pPñ
 +
°ride
 )

286 
I¡
 
x
 = 0; x < 
width
; x++ )

288 
‹gAC
 +
	`abs
–(
I¡
)
pPñ
[
x
] - (I¡)
‹gN‹mDC
 );

293 c⁄° 
I¡
 
fixedBôShi·
 = (
¶i˚
->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
())?
RExt__PREDICTION_WEIGHTING_ANALYSIS_DC_PRECISION
:0;

294 
weightACDCP¨am
[
compID
].
iDC
 = (((
‹gDC
<<
fixedBôShi·
)+(
ßm∂e
>>1)) / sample);

295 
weightACDCP¨am
[
compID
].
iAC
 = 
‹gAC
;

298 
¶i˚
->
	`£tWpAcDcP¨am
(
weightACDCP¨am
);

299 
	}
}

303 
Void
 
	gWeightPªdA«lysis
::
	$xCheckWPE«bÀ
(
TComSli˚
 *c⁄° 
¶i˚
)

305 c⁄° 
TComPicYuv
 *
pPic
 = 
¶i˚
->
	`gëPic
()->
	`gëPicYuvOrg
();

307 
I¡
 
¥e£¡C¡
 = 0;

308  
UI¡
 
l°
=0 ;Ü°<
NUM_REF_PIC_LIST_01
 ;Üst++ )

310  
I¡
 
ªfIdx
=0 ;ÑefIdx<
MAX_NUM_REF
 ;ÑefIdx++ )

312 
I¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
pPic
->
	`gëNumbîVÆidComp⁄íts
(); componentIndex++)

314 
WPSˇlögP¨am
 *
pwp
 = &(
m_wp
[
l°
][
ªfIdx
][
comp⁄ítIndex
]);

315 
¥e£¡C¡
 +(
I¡
)
pwp
->
bPª£¡Fœg
;

320 if(
¥e£¡C¡
==0)

322 
¶i˚
->
	`£tTe°WeightPªd
(
Ál£
);

323 
¶i˚
->
	`£tTe°WeightBiPªd
(
Ál£
);

325  
UI¡
 
l°
=0 ;Ü°<
NUM_REF_PIC_LIST_01
 ;Üst++ )

327  
I¡
 
ªfIdx
=0 ;ÑefIdx<
MAX_NUM_REF
 ;ÑefIdx++ )

329 
I¡
 
comp⁄ítIndex
 = 0; comp⁄ítIndex < 
pPic
->
	`gëNumbîVÆidComp⁄íts
(); componentIndex++)

331 
WPSˇlögP¨am
 *
pwp
 = &(
m_wp
[
l°
][
ªfIdx
][
comp⁄ítIndex
]);

333 
pwp
->
bPª£¡Fœg
 = 
Ál£
;

334 
pwp
->
uiLog2WeightDíom
 = 0;

335 
pwp
->
iWeight
 = 1;

336 
pwp
->
iOff£t
 = 0;

340 
¶i˚
->
	`£tWpSˇlög
–
m_wp
 );

344 
¶i˚
->
	`£tTe°WeightPªd
 (¶i˚->
	`gëPPS
()->
	`gëU£WP
());

345 
¶i˚
->
	`£tTe°WeightBiPªd
(¶i˚->
	`gëPPS
()->
	`gëWPBiPªd
());

347 
	}
}

351 
Void
 
	gWeightPªdA«lysis
::
	$xE°im©eWPP¨amSli˚
(
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
WeighãdPªdi˘i⁄Mëhod
 
mëhod
)

353 
I¡
 
iDíom
 = 6;

354 
Boﬁ
 
vÆidR™geFœg
 = 
Ál£
;

356 if(
¶i˚
->
	`gëNumRefIdx
(
REF_PIC_LIST_0
)>3)

358 
iDíom
 = 7;

363 
vÆidR™geFœg
 = 
	`xUpd©ögWPP¨amëîs
(
¶i˚
, 
iDíom
);

364 i‡(!
vÆidR™geFœg
)

366 
iDíom
--;

368 } 
vÆidR™geFœg
 =
Ál£
);

372 
mëhod
)

374 
WP_PER_PICTURE_WITH_SIMPLE_DC_COMBINED_COMPONENT
:

375 
	`xSñe˘WP
(
¶i˚
, 
iDíom
);

377 
WP_PER_PICTURE_WITH_SIMPLE_DC_PER_COMPONENT
:

378 
	`xSñe˘WPHi°ExtClù
(
¶i˚
, 
iDíom
, 
Ál£
, false, false);

380 
WP_PER_PICTURE_WITH_HISTOGRAM_AND_PER_COMPONENT
:

381 
	`xSñe˘WPHi°ExtClù
(
¶i˚
, 
iDíom
, 
Ál£
, fÆ£, 
åue
);

383 
WP_PER_PICTURE_WITH_HISTOGRAM_AND_PER_COMPONENT_AND_CLIPPING
:

384 
	`xSñe˘WPHi°ExtClù
(
¶i˚
, 
iDíom
, 
Ál£
, 
åue
,Årue);

386 
WP_PER_PICTURE_WITH_HISTOGRAM_AND_PER_COMPONENT_AND_CLIPPING_AND_EXTENSION
:

387 
	`xSñe˘WPHi°ExtClù
(
¶i˚
, 
iDíom
, 
åue
,Årue,Årue);

390 
	`as£π
(0);

391 
	`exô
(1);

394 
¶i˚
->
	`£tWpSˇlög
–
m_wp
 );

395 
	}
}

399 
Boﬁ
 
	gWeightPªdA«lysis
::
	$xUpd©ögWPP¨amëîs
(
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
I¡
 
log2Díom
)

401 c⁄° 
I¡
 
numComp
 = 
¶i˚
->
	`gëPic
()->
	`gëPicYuvOrg
()->
	`gëNumbîVÆidComp⁄íts
();

402 c⁄° 
Boﬁ
 
bU£HighPªcisi⁄Weightög
 = 
¶i˚
->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
();

403 c⁄° 
I¡
 
numPªdDú
 = 
¶i˚
->
	`isI¡îP
() ? 1 : 2;

405 
	`as£π
 (
numPªdDú
 <
	`I¡
(
NUM_REF_PIC_LIST_01
));

407  
I¡
 
ªfLi°
 = 0;ÑefLi° < 
numPªdDú
;ÑefList++ )

409 c⁄° 
RefPicLi°
 
eRefPicLi°
 = ( 
ªfLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

411  
I¡
 
ªfIdxTemp
 = 0;ÑefIdxTem∞< 
¶i˚
->
	`gëNumRefIdx
(
eRefPicLi°
);ÑefIdxTemp++ )

413 
WPACDCP¨am
 *
cuºWeightACDCP¨am
, *
ªfWeightACDCP¨am
;

414 
¶i˚
->
	`gëWpAcDcP¨am
(
cuºWeightACDCP¨am
);

415 
¶i˚
->
	`gëRefPic
(
eRefPicLi°
, 
ªfIdxTemp
)->
	`gëSli˚
(0)->
	`gëWpAcDcP¨am
(
ªfWeightACDCP¨am
);

417  
I¡
 
comp
 = 0; com∞< 
numComp
; comp++ )

419 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp
);

420 c⁄° 
I¡
 
bôDïth
 = 
¶i˚
->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

421 c⁄° 
I¡
 
ønge
 = 
bU£HighPªcisi⁄Weightög
 ? (1<<
bôDïth
)/2 : 128;

422 c⁄° 
I¡
 
ªÆLog2Díom
 = 
log2Díom
 + (
bU£HighPªcisi⁄Weightög
 ? 
RExt__PREDICTION_WEIGHTING_ANALYSIS_DC_PRECISION
 : (
bôDïth
 - 8));

423 c⁄° 
I¡
 
ªÆOff£t
 = ((I¡)1<<(
ªÆLog2Díom
-1));

426 c⁄° 
I¡64
 
cuºDC
 = 
cuºWeightACDCP¨am
[
comp
].
iDC
;

427 c⁄° 
I¡64
 
cuºAC
 = 
cuºWeightACDCP¨am
[
comp
].
iAC
;

429 c⁄° 
I¡64
 
ªfDC
 = 
ªfWeightACDCP¨am
[
comp
].
iDC
;

430 c⁄° 
I¡64
 
ªfAC
 = 
ªfWeightACDCP¨am
[
comp
].
iAC
;

433 c⁄° 
DoubÀ
 
dWeight
 = (
ªfAC
==0Ë? (DoubÀ)1.0 : 
	`Clù3
–-16.0, 15.0, ((DoubÀ)
cuºAC
 / (Double)refAC) );

434 c⁄° 
I¡
 
weight
 = (I¡)–0.5 + 
dWeight
 * (
DoubÀ
)(1<<
log2Díom
) );

435 c⁄° 
I¡
 
off£t
 = (I¡)–((
cuºDC
<<
log2Díom
Ë- ((
I¡64
)
weight
 * 
ªfDC
Ë+ (I¡64)
ªÆOff£t
Ë>> 
ªÆLog2Díom
 );

437 
I¡
 
˛ù≥dOff£t
;

438 if(
	`isChroma
(
compID
))

440 c⁄° 
I¡
 
¥ed
 = ( 
ønge
 - ( (Ñ™ge*
weight
)>>(
log2Díom
) ) );

441 c⁄° 
I¡
 
dñèOff£t
 = 
	`Clù3
–-4*
ønge
, 4*ønge-1, (
off£t
 - 
¥ed
) );

443 
˛ù≥dOff£t
 = 
	`Clù3
–-
ønge
,Ñ™ge-1, (
dñèOff£t
 + 
¥ed
) );

447 
˛ù≥dOff£t
 = 
	`Clù3
–-
ønge
,Ñ™ge-1, 
off£t
);

451 c⁄° 
I¡
 
deÁu…Weight
 = (1<<
log2Díom
);

452 c⁄° 
I¡
 
dñèWeight
 = (
weight
 - 
deÁu…Weight
);

454 if(
dñèWeight
 >
ønge
 || deltaWeight < -range)

456  
Ál£
;

459 
m_wp
[
ªfLi°
][
ªfIdxTemp
][
comp
].
bPª£¡Fœg
 = 
åue
;

460 
m_wp
[
ªfLi°
][
ªfIdxTemp
][
comp
].
iWeight
 = 
weight
;

461 
m_wp
[
ªfLi°
][
ªfIdxTemp
][
comp
].
iOff£t
 = 
˛ù≥dOff£t
;

462 
m_wp
[
ªfLi°
][
ªfIdxTemp
][
comp
].
uiLog2WeightDíom
 = 
log2Díom
;

466  
åue
;

467 
	}
}

475 
Boﬁ
 
	gWeightPªdA«lysis
::
	$xSñe˘WPHi°ExtClù
(
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
I¡
 
log2Díom
, c⁄° 
Boﬁ
 
bDoEnh™˚mít
, c⁄° Boﬁ 
bClùInôülSADWP
, c⁄° Boﬁ 
bU£Hi°ogøm
)

477 c⁄° 
TComPicYuv
 *c⁄° 
pPic
 = 
¶i˚
->
	`gëPic
()->
	`gëPicYuvOrg
();

478 c⁄° 
I¡
 
deÁu…Weight
 = 1<<
log2Díom
;

479 c⁄° 
I¡
 
numPªdDú
 = 
¶i˚
->
	`isI¡îP
() ? 1 : 2;

480 c⁄° 
Boﬁ
 
u£HighPªcisi⁄
 = 
¶i˚
->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
();

482 
	`as£π
 (
numPªdDú
 <
	`I¡
(
NUM_REF_PIC_LIST_01
));

484  
I¡
 
ªfLi°
 = 0;ÑefLi° < 
numPªdDú
;ÑefList++ )

486 c⁄° 
RefPicLi°
 
eRefPicLi°
 = ( 
ªfLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

488  
I¡
 
ªfIdxTemp
 = 0;ÑefIdxTem∞< 
¶i˚
->
	`gëNumRefIdx
(
eRefPicLi°
);ÑefIdxTemp++ )

490 
Boﬁ
 
u£ChromaWeight
 = 
Ál£
;

492 
I¡
 
comp
=0; comp<
pPic
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

494 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp
);

495 c⁄° 
Pñ
 *
pOrg
 = 
pPic
->
	`gëAddr
(
compID
);

496 c⁄° 
Pñ
 *
pRef
 = 
¶i˚
->
	`gëRefPic
(
eRefPicLi°
, 
ªfIdxTemp
)->
	`gëPicYuvRec
()->
	`gëAddr
(
compID
);

497 c⁄° 
I¡
 
‹gSåide
 = 
pPic
->
	`gëSåide
(
compID
);

498 c⁄° 
I¡
 
ªfSåide
 = 
¶i˚
->
	`gëRefPic
(
eRefPicLi°
, 
ªfIdxTemp
)->
	`gëPicYuvRec
()->
	`gëSåide
(
compID
);

499 c⁄° 
I¡
 
width
 = 
pPic
->
	`gëWidth
(
compID
);

500 c⁄° 
I¡
 
height
 = 
pPic
->
	`gëHeight
(
compID
);

501 c⁄° 
I¡
 
bôDïth
 = 
¶i˚
->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

502 
WPSˇlögP¨am
 &
wp
 = 
m_wp
[
ªfLi°
][
ªfIdxTemp
][
compID
];

503 
I¡
 
weight
 = 
wp
.
iWeight
;

504 
I¡
 
off£t
 = 
wp
.
iOff£t
;

505 
I¡
 
weightDef
 = 
deÁu…Weight
;

506 
I¡
 
off£tDef
 = 0;

509 c⁄° 
I¡64
 
SADnoWP
 = 
	`xCÆcSADvÆueWPO±i⁄ÆClù
(
bôDïth
, 
pOrg
, 
pRef
, 
width
, 
height
, 
‹gSåide
, 
ªfSåide
, 
log2Díom
, 
deÁu…Weight
, 0, 
u£HighPªcisi⁄
, 
bClùInôülSADWP
);

510 i‡(
SADnoWP
 > 0)

512 c⁄° 
I¡64
 
SADWP
 = 
	`xCÆcSADvÆueWPO±i⁄ÆClù
(
bôDïth
, 
pOrg
, 
pRef
, 
width
, 
height
, 
‹gSåide
, 
ªfSåide
, 
log2Díom
, 
weight
, 
off£t
, 
u£HighPªcisi⁄
, 
bClùInôülSADWP
);

513 c⁄° 
DoubÀ
 
dR©ioSAD
 = (DoubÀ)
SADWP
 / (DoubÀ)
SADnoWP
;

514 
DoubÀ
 
dR©ioSr0SAD
 = 
°d
::
numîic_limôs
<DoubÀ>::
	`max
();

515 
DoubÀ
 
dR©ioSrSAD
 = 
°d
::
numîic_limôs
<DoubÀ>::
	`max
();

517 i‡(
bU£Hi°ogøm
)

519 
°d
::
ve˘‹
<
I¡
> 
hi°ogømOrg
;

520 
°d
::
ve˘‹
<
I¡
> 
hi°ogømRef
;

521 
°d
::
ve˘‹
<
I¡
> 
£¨chedHi°ogøm
;

524 
	`xCÆcHi°ogøm
(
pOrg
, 
hi°ogømOrg
, 
width
, 
height
, 
‹gSåide
, 1 << 
bôDïth
);

525 
	`xCÆcHi°ogøm
(
pRef
, 
hi°ogømRef
, 
width
, 
height
, 
ªfSåide
, 1 << 
bôDïth
);

528 
	`xSórchHi°ogøm
(
hi°ogømOrg
, 
hi°ogømRef
, 
£¨chedHi°ogøm
, 
bôDïth
, 
log2Díom
, 
weight
, 
off£t
, 
u£HighPªcisi⁄
, 
compID
);

530 c⁄° 
I¡64
 
SADSrWP
 = 
	`xCÆcSADvÆueWP
(
bôDïth
, 
pOrg
, 
pRef
, 
width
, 
height
, 
‹gSåide
, 
ªfSåide
, 
log2Díom
, 
weight
, 
off£t
, 
u£HighPªcisi⁄
);

531 
dR©ioSrSAD
 = (
DoubÀ
)
SADSrWP
 / (DoubÀ)
SADnoWP
;

533 i‡(
bDoEnh™˚mít
)

536 
	`xSórchHi°ogøm
(
hi°ogømOrg
, 
hi°ogømRef
, 
£¨chedHi°ogøm
, 
bôDïth
, 
log2Díom
, 
weightDef
, 
off£tDef
, 
u£HighPªcisi⁄
, 
compID
);

538 c⁄° 
I¡64
 
SADSr0WP
 = 
	`xCÆcSADvÆueWP
(
bôDïth
, 
pOrg
, 
pRef
, 
width
, 
height
, 
‹gSåide
, 
ªfSåide
, 
log2Díom
, 
weightDef
, 
off£tDef
, 
u£HighPªcisi⁄
);

539 
dR©ioSr0SAD
 = (
DoubÀ
)
SADSr0WP
 / (DoubÀ)
SADnoWP
;

543 if(
	`mö
(
dR©ioSr0SAD
, mö(
dR©ioSAD
, 
dR©ioSrSAD
)Ë>
WEIGHT_PRED_SAD_RELATIVE_TO_NON_WEIGHT_PRED_SAD
)

545 
wp
.
bPª£¡Fœg
 = 
Ál£
;

546 
wp
.
iOff£t
 = 0;

547 
wp
.
iWeight
 = 
deÁu…Weight
;

548 
wp
.
uiLog2WeightDíom
 = 
log2Díom
;

552 i‡(
compID
 !
COMPONENT_Y
)

554 
u£ChromaWeight
 = 
åue
;

557 i‡(
dR©ioSr0SAD
 < 
dR©ioSrSAD
 && dR©ioSr0SAD < 
dR©ioSAD
)

559 
wp
.
bPª£¡Fœg
 = 
åue
;

560 
wp
.
iOff£t
 = 
off£tDef
;

561 
wp
.
iWeight
 = 
weightDef
;

562 
wp
.
uiLog2WeightDíom
 = 
log2Díom
;

564 i‡(
dR©ioSrSAD
 < 
dR©ioSAD
)

566 
wp
.
bPª£¡Fœg
 = 
åue
;

567 
wp
.
iOff£t
 = 
off£t
;

568 
wp
.
iWeight
 = 
weight
;

569 
wp
.
uiLog2WeightDíom
 = 
log2Díom
;

575 
wp
.
bPª£¡Fœg
 = 
Ál£
;

576 
wp
.
iOff£t
 = 0;

577 
wp
.
iWeight
 = 
deÁu…Weight
;

578 
wp
.
uiLog2WeightDíom
 = 
log2Díom
;

582 
I¡
 
comp
=1; comp<
pPic
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

584 
m_wp
[
ªfLi°
][
ªfIdxTemp
][
comp
].
bPª£¡Fœg
 = 
u£ChromaWeight
;

589  
åue
;

590 
	}
}

593 
Boﬁ
 
	gWeightPªdA«lysis
::
	$xSñe˘WP
(
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
I¡
 
log2Díom
)

595 
TComPicYuv
 *c⁄° 
pPic
 = 
¶i˚
->
	`gëPic
()->
	`gëPicYuvOrg
();

596 c⁄° 
I¡
 
deÁu…Weight
 = 1<<
log2Díom
;

597 c⁄° 
I¡
 
numPªdDú
 = 
¶i˚
->
	`isI¡îP
() ? 1 : 2;

598 c⁄° 
Boﬁ
 
u£HighPªcisi⁄Pªdi˘i⁄Weightög
 = 
¶i˚
->
	`gëSPS
()->
	`gëSpsR™geExãnsi⁄
().
	`gëHighPªcisi⁄Off£tsE«bÀdFœg
();

600 
	`as£π
 (
numPªdDú
 <
	`I¡
(
NUM_REF_PIC_LIST_01
));

602  
I¡
 
ªfLi°
 = 0;ÑefLi° < 
numPªdDú
;ÑefList++ )

604 c⁄° 
RefPicLi°
 
eRefPicLi°
 = ( 
ªfLi°
 ? 
REF_PIC_LIST_1
 : 
REF_PIC_LIST_0
 );

606  
I¡
 
ªfIdxTemp
 = 0;ÑefIdxTem∞< 
¶i˚
->
	`gëNumRefIdx
(
eRefPicLi°
);ÑefIdxTemp++ )

608 
I¡64
 
SADWP
 = 0, 
SADnoWP
 = 0;

610 
I¡
 
comp
=0; comp<
pPic
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

612 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp
);

613 
Pñ
 *
pOrg
 = 
pPic
->
	`gëAddr
(
compID
);

614 
Pñ
 *
pRef
 = 
¶i˚
->
	`gëRefPic
(
eRefPicLi°
, 
ªfIdxTemp
)->
	`gëPicYuvRec
()->
	`gëAddr
(
compID
);

615 c⁄° 
I¡
 
‹gSåide
 = 
pPic
->
	`gëSåide
(
compID
);

616 c⁄° 
I¡
 
ªfSåide
 = 
¶i˚
->
	`gëRefPic
(
eRefPicLi°
, 
ªfIdxTemp
)->
	`gëPicYuvRec
()->
	`gëSåide
(
compID
);

617 c⁄° 
I¡
 
width
 = 
pPic
->
	`gëWidth
(
compID
);

618 c⁄° 
I¡
 
height
 = 
pPic
->
	`gëHeight
(
compID
);

619 c⁄° 
I¡
 
bôDïth
 = 
¶i˚
->
	`gëSPS
()->
	`gëBôDïth
(
	`toCh™√lTy≥
(
compID
));

622 
SADWP
 +
	`xCÆcSADvÆueWP
(
bôDïth
, 
pOrg
, 
pRef
, 
width
, 
height
, 
‹gSåide
, 
ªfSåide
, 
log2Díom
, 
m_wp
[
ªfLi°
][
ªfIdxTemp
][
compID
].
iWeight
, m_wp[ªfLi°][ªfIdxTemp][compID].
iOff£t
, 
u£HighPªcisi⁄Pªdi˘i⁄Weightög
);

623 
SADnoWP
 +
	`xCÆcSADvÆueWP
(
bôDïth
, 
pOrg
, 
pRef
, 
width
, 
height
, 
‹gSåide
, 
ªfSåide
, 
log2Díom
, 
deÁu…Weight
, 0, 
u£HighPªcisi⁄Pªdi˘i⁄Weightög
);

626 c⁄° 
DoubÀ
 
dR©io
 = 
SADnoWP
 > 0 ? (((DoubÀ)
SADWP
 / (DoubÀ)SADnoWP)Ë: 
°d
::
numîic_limôs
<DoubÀ>::
	`max
();

627 if(
dR©io
 >
WEIGHT_PRED_SAD_RELATIVE_TO_NON_WEIGHT_PRED_SAD
)

629 
I¡
 
comp
=0; comp<
pPic
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

631 
WPSˇlögP¨am
 &
wp
=
m_wp
[
ªfLi°
][
ªfIdxTemp
][
comp
];

632 
wp
.
bPª£¡Fœg
 = 
Ál£
;

633 
wp
.
iOff£t
 = 0;

634 
wp
.
iWeight
 = 
deÁu…Weight
;

635 
wp
.
uiLog2WeightDíom
 = 
log2Díom
;

641  
åue
;

642 
	}
}

647 
I¡64
 
	$xCÆcSADvÆueWP
(c⁄° 
I¡
 
bôDïth
,

648 c⁄° 
Pñ
 *
pOrgPñ
,

649 c⁄° 
Pñ
 *
pRefPñ
,

650 c⁄° 
I¡
 
width
,

651 c⁄° 
I¡
 
height
,

652 c⁄° 
I¡
 
‹gSåide
,

653 c⁄° 
I¡
 
ªfSåide
,

654 c⁄° 
I¡
 
log2Díom
,

655 c⁄° 
I¡
 
weight
,

656 c⁄° 
I¡
 
off£t
,

657 c⁄° 
Boﬁ
 
u£HighPªcisi⁄
)

660 c⁄° 
I¡64
 
ªÆLog2Díom
 = 
u£HighPªcisi⁄
 ? 
log2Díom
 : (log2Díom + (
bôDïth
 - 8));

661 c⁄° 
I¡64
 
ªÆOff£t
 = ((I¡64)
off£t
)<<
ªÆLog2Díom
;

663 
I¡64
 
SAD
 = 0;

664  
I¡
 
y
 = 0; y < 
height
; y++ )

666  
I¡
 
x
 = 0; x < 
width
; x++ )

668 
SAD
 +
	`abs
(–((
I¡64
)
pOrgPñ
[
x
] << (I¡64Ë
log2Díom
Ë- ( (I¡64Ë
pRefPñ
[x] * (I¡64Ë
weight
 + (
ªÆOff£t
) ) ) );

670 
pOrgPñ
 +
‹gSåide
;

671 
pRefPñ
 +
ªfSåide
;

675  
SAD
;

676 
	}
}

679 
I¡64
 
	$xCÆcSADvÆueWPO±i⁄ÆClù
(c⁄° 
I¡
 
bôDïth
,

680 c⁄° 
Pñ
 *
pOrgPñ
,

681 c⁄° 
Pñ
 *
pRefPñ
,

682 c⁄° 
I¡
 
width
,

683 c⁄° 
I¡
 
height
,

684 c⁄° 
I¡
 
‹gSåide
,

685 c⁄° 
I¡
 
ªfSåide
,

686 c⁄° 
I¡
 
log2Díom
,

687 c⁄° 
I¡
 
weight
,

688 c⁄° 
I¡
 
off£t
,

689 c⁄° 
Boﬁ
 
u£HighPªcisi⁄
,

690 c⁄° 
Boﬁ
 
˛ù≥d
)

692 
I¡64
 
SAD
 = 0;

693 i‡(
˛ù≥d
)

695 c⁄° 
I¡64
 
ªÆLog2Díom
 = 
u£HighPªcisi⁄
 ? 0 : (
bôDïth
 - 8);

696 c⁄° 
I¡64
 
ªÆOff£t
 = (I¡64)
off£t
<<
ªÆLog2Díom
;

697 c⁄° 
I¡64
 
roundOff£t
 = (
log2Díom
 == 0) ? 0 : 1 << (log2Denom - 1);

698 c⁄° 
I¡64
 
möVÆue
 = 0;

699 c⁄° 
I¡64
 
maxVÆue
 = (1 << 
bôDïth
) - 1;

701  
I¡
 
y
 = 0; y < 
height
; y++ )

703  
I¡
 
x
 = 0; x < 
width
; x++ )

705 
I¡64
 
sˇÀdVÆue
 = 
	`Clù3
(
möVÆue
, 
maxVÆue
, ((((I¡64Ë
pRefPñ
[
x
] * (I¡64Ë
weight
 + 
roundOff£t
ËË>> (I¡64Ë
log2Díom
Ë+ 
ªÆOff£t
);

706 
SAD
 +
	`abs
((
I¡64
)
pOrgPñ
[
x
] - 
sˇÀdVÆue
);

708 
pOrgPñ
 +
‹gSåide
;

709 
pRefPñ
 +
ªfSåide
;

715 c⁄° 
I¡64
 
ªÆLog2Díom
 = 
u£HighPªcisi⁄
 ? 
log2Díom
 : (log2Díom + (
bôDïth
 - 8));

716 c⁄° 
I¡64
 
ªÆOff£t
 = ((I¡64)
off£t
)<<
ªÆLog2Díom
;

718  
I¡
 
y
 = 0; y < 
height
; y++ )

720  
I¡
 
x
 = 0; x < 
width
; x++ )

722 
SAD
 +
	`abs
(–((
I¡64
)
pOrgPñ
[
x
] << (I¡64Ë
log2Díom
Ë- ( (I¡64Ë
pRefPñ
[x] * (I¡64Ë
weight
 + (
ªÆOff£t
) ) ) );

724 
pOrgPñ
 +
‹gSåide
;

725 
pRefPñ
 +
ªfSåide
;

728  
SAD
;

729 
	}
}

	@TLibEncoder/WeightPredAnalysis.h

37 #i‚de‡
__WEIGHTPREDANALYSIS__


38 
	#__WEIGHTPREDANALYSIS__


	)

40 
	~"../TLibComm⁄/Comm⁄Def.h
"

41 
	~"../TLibComm⁄/TComSli˚.h
"

42 
	~"TEncCavlc.h
"

44 ˛as†
	cWeightPªdA«lysis


46 
	m¥iv©e
:

49 
WPSˇlögP¨am
 
m_wp
[
NUM_REF_PIC_LIST_01
][
MAX_NUM_REF
][
MAX_NUM_COMPONENT
];

53 
Boﬁ
 
xSñe˘WP
 (
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
I¡
 
log2Díom
);

54 
Boﬁ
 
xSñe˘WPHi°ExtClù
 (
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
I¡
 
log2Díom
, c⁄° Boﬁ 
bDoEnh™˚mít
, c⁄° Boﬁ 
bClùInôülSADWP
, c⁄° Boﬁ 
bU£Hi°ogøm
);

55 
Boﬁ
 
xUpd©ögWPP¨amëîs
(
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
I¡
 
log2Díom
);

57 
	mpublic
:

59 
WeightPªdA«lysis
();

62 
Void
 
xCÆcACDCP¨amSli˚
 (
TComSli˚
 *c⁄° 
¶i˚
);

63 
Void
 
xE°im©eWPP¨amSli˚
(
TComSli˚
 *c⁄° 
¶i˚
, c⁄° 
WeighãdPªdi˘i⁄Mëhod
 
mëhod
);

64 
Void
 
xCheckWPE«bÀ
 (
TComSli˚
 *c⁄° 
¶i˚
);

	@Utilities/TVideoIOYuv.cpp

38 
	~<c°dlib
>

39 
	~<f˙é.h
>

40 
	~<as£π.h
>

41 
	~<sys/°©.h
>

42 
	~<f°ªam
>

43 
	~<io°ªam
>

44 
	~<mem‹y.h
>

46 
	~"TLibComm⁄/TComRom.h
"

47 
	~"TVideoIOYuv.h
"

49 
usög
 
«me•a˚
 
	g°d
;

70 
Void
 
	$sˇÀPœ√
(
Pñ
* 
img
, c⁄° 
UI¡
 
°ride
, c⁄° UI¡ 
width
, c⁄° UI¡ 
height
, 
I¡
 
shi·bôs
, Pñ 
mövÆ
, Pñ 
maxvÆ
)

72 i‡(
shi·bôs
 > 0)

74 
UI¡
 
y
 = 0; y < 
height
; y++, 
img
+=
°ride
)

76 
UI¡
 
x
 = 0; x < 
width
; x++)

78 
img
[
x
] <<
shi·bôs
;

82 i‡(
shi·bôs
 < 0)

84 
shi·bôs
=-shiftbits;

86 
Pñ
 
roundög
 = 1 << (
shi·bôs
-1);

87 
UI¡
 
y
 = 0; y < 
height
; y++, 
img
+=
°ride
)

89 
UI¡
 
x
 = 0; x < 
width
; x++)

91 
img
[
x
] = 
	`Clù3
(
mövÆ
, 
maxvÆ
, 
	`Pñ
((img[x] + 
roundög
Ë>> 
shi·bôs
));

95 
	}
}

97 
Void


98 
c›yPœ√
(c⁄° 
TComPicYuv
 &
§c
, c⁄° 
Comp⁄ítID
 
§cPœ√
, TComPicYuv &
de°
, c⁄° Comp⁄ítID 
de°Pœ√
);

120 
Void
 
	gTVideoIOYuv
::
	$›í
–c⁄° 
°d
::
°rög
 &
fûeName
, 
Boﬁ
 
bWrôeMode
, c⁄° 
I¡
 
fûeBôDïth
[
MAX_NUM_CHANNEL_TYPE
], c⁄° I¡ 
MSBExãndedBôDïth
[MAX_NUM_CHANNEL_TYPE], c⁄° I¡ 
öã∫ÆBôDïth
[MAX_NUM_CHANNEL_TYPE] )

123 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

125 
m_fûeBôdïth
 [
ch
] = 
°d
::
mö
<
UI¡
>(
fûeBôDïth
[ch], 16);

126 
m_MSBExãndedBôDïth
[
ch
] = 
MSBExãndedBôDïth
[ch];

127 
m_bôdïthShi·
 [
ch
] = 
öã∫ÆBôDïth
[ch] - 
m_MSBExãndedBôDïth
[ch];

129 i‡(
m_fûeBôdïth
[
ch
] > 16)

131 i‡(
bWrôeMode
)

133 
°d
::
˚º
 << "\nWARNING: C™nŸ wrôê®yuv fûêo‡bô dïth gª©îÅh™ 16 - ouçuàwû»bêright-shi·ed dow¿tÿ16-bôÖªcisi⁄\n" << std::
ídl
;

137 
°d
::
˚º
 << "\nERROR: C™nŸÑódá yuv fûêo‡bô dïth gª©îÅh™ 16\n" << std::
ídl
;

138 
	`exô
(0);

143 i‡–
bWrôeMode
 )

145 
m_cH™dÀ
.
	`›í
–
fûeName
.
	`c_°r
(), 
ios
::
bö¨y
 | ios::
out
 );

147 if–
m_cH™dÀ
.
	`Áû
() )

149 
	`¥ötf
("\nfailedÅo writeÑeconstructed YUV file\n");

150 
	`exô
(0);

155 
m_cH™dÀ
.
	`›í
–
fûeName
.
	`c_°r
(), 
ios
::
bö¨y
 | ios::
ö
 );

157 if–
m_cH™dÀ
.
	`Áû
() )

159 
	`¥ötf
("\nfailedÅo open Input YUV file\n");

160 
	`exô
(0);

165 
	}
}

167 
Void
 
	gTVideoIOYuv
::
	$˛o£
()

169 
m_cH™dÀ
.
	`˛o£
();

170 
	}
}

172 
Boﬁ
 
	gTVideoIOYuv
::
	$isEof
()

174  
m_cH™dÀ
.
	`eof
();

175 
	}
}

177 
Boﬁ
 
	gTVideoIOYuv
::
	$isFaû
()

179  
m_cH™dÀ
.
	`Áû
();

180 
	}
}

188 
Void
 
	gTVideoIOYuv
::
	$skùFømes
(
I¡
 
numFømes
, 
UI¡
 
width
, UI¡ 
height
, 
ChromaF‹m©
 
f‹m©
)

190 i‡(
numFømes
==0)

197 
°ªamoff
 
‰ameSize
 = 0;

198 
UI¡
 
w‹dsize
=1;

199 
UI¡
 
comp⁄ít
 = 0; comp⁄íà< 
	`gëNumbîVÆidComp⁄íts
(
f‹m©
); component++)

201 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp⁄ít
);

202 
‰ameSize
 +(
width
 >> 
	`gëComp⁄ítSˇÀX
(
compID
, 
f‹m©
)Ë* (
height
 >> 
	`gëComp⁄ítSˇÀY
(compID, format));

203 i‡(
m_fûeBôdïth
[
	`toCh™√lTy≥
(
compID
)] > 8)

205 
w‹dsize
=2;

208 
‰ameSize
 *
w‹dsize
;

211 c⁄° 
°ªamoff
 
off£t
 = 
‰ameSize
 * 
numFømes
;

214 i‡(!!
m_cH™dÀ
.
	`£ekg
(
off£t
, 
ios
::
cur
))

218 
m_cH™dÀ
.
	`˛ór
();

221 
TCh¨
 
buf
[512];

222 c⁄° 
°ªamoff
 
off£t_mod_bufsize
 = 
off£t
 % (
buf
);

223 
°ªamoff
 
i
 = 0; i < 
off£t
 - 
off£t_mod_bufsize
; i +(
buf
))

225 
m_cH™dÀ
.
	`ªad
(
buf
, (buf));

227 
m_cH™dÀ
.
	`ªad
(
buf
, 
off£t_mod_bufsize
);

228 
	}
}

249 
Boﬁ
 
	$ªadPœ√
(
Pñ
* 
d°
,

250 
i°ªam
& 
fd
,

251 
Boﬁ
 
is16bô
,

252 
UI¡
 
°ride444
,

253 
UI¡
 
width444
,

254 
UI¡
 
height444
,

255 
UI¡
 
∑d_x444
,

256 
UI¡
 
∑d_y444
,

257 c⁄° 
Comp⁄ítID
 
compID
,

258 c⁄° 
ChromaF‹m©
 
de°F‹m©
,

259 c⁄° 
ChromaF‹m©
 
fûeF‹m©
,

260 c⁄° 
UI¡
 
fûeBôDïth
)

262 c⁄° 
UI¡
 
csx_fûe
 =
	`gëComp⁄ítSˇÀX
(
compID
, 
fûeF‹m©
);

263 c⁄° 
UI¡
 
csy_fûe
 =
	`gëComp⁄ítSˇÀY
(
compID
, 
fûeF‹m©
);

264 c⁄° 
UI¡
 
csx_de°
 =
	`gëComp⁄ítSˇÀX
(
compID
, 
de°F‹m©
);

265 c⁄° 
UI¡
 
csy_de°
 =
	`gëComp⁄ítSˇÀY
(
compID
, 
de°F‹m©
);

267 c⁄° 
UI¡
 
width_de°
 = 
width444
 >>
csx_de°
;

268 c⁄° 
UI¡
 
height_de°
 = 
height444
>>
csy_de°
;

269 c⁄° 
UI¡
 
∑d_x_de°
 = 
∑d_x444
>>
csx_de°
;

270 c⁄° 
UI¡
 
∑d_y_de°
 = 
∑d_y444
>>
csy_de°
;

271 c⁄° 
UI¡
 
°ride_de°
 = 
°ride444
>>
csx_de°
;

273 c⁄° 
UI¡
 
fuŒ_width_de°
 = 
width_de°
+
∑d_x_de°
;

274 c⁄° 
UI¡
 
fuŒ_height_de°
 = 
height_de°
+
∑d_y_de°
;

276 c⁄° 
UI¡
 
°ride_fûe
 = (
width444
 * (
is16bô
 ? 2 : 1)Ë>> 
csx_fûe
;

277 
°d
::
ve˘‹
<
UCh¨
> 
	`bufVec
(
°ride_fûe
);

278 
UCh¨
 *
buf
=&(
bufVec
[0]);

280 i‡(
compID
!=
COMPONENT_Y
 && (
fûeF‹m©
==
CHROMA_400
 || 
de°F‹m©
==CHROMA_400))

282 i‡(
de°F‹m©
!=
CHROMA_400
)

285 c⁄° 
Pñ
 
vÆue
=
	`Pñ
(1<<(
fûeBôDïth
-1));

286 
UI¡
 
y
 = 0; y < 
fuŒ_height_de°
; y++, 
d°
+=
°ride_de°
)

288 
UI¡
 
x
 = 0; x < 
fuŒ_width_de°
; x++)

290 
d°
[
x
] = 
vÆue
;

295 i‡(
fûeF‹m©
!=
CHROMA_400
)

297 c⁄° 
UI¡
 
height_fûe
 = 
height444
>>
csy_fûe
;

298 
fd
.
	`£ekg
(
height_fûe
*
°ride_fûe
, 
ios
::
cur
);

299 i‡(
fd
.
	`eof
(Ë|| fd.
	`Áû
() )

301  
Ál£
;

307 c⁄° 
UI¡
 
mask_y_fûe
=(1<<
csy_fûe
)-1;

308 c⁄° 
UI¡
 
mask_y_de°
=(1<<
csy_de°
)-1;

309 
UI¡
 
y444
=0; y444<
height444
; y444++)

311 i‡((
y444
&
mask_y_fûe
)==0)

314 
fd
.
	`ªad
(
ªöãΩªt_ˇ°
<
TCh¨
*>(
buf
), 
°ride_fûe
);

315 i‡(
fd
.
	`eof
(Ë|| fd.
	`Áû
() )

317  
Ál£
;

321 i‡((
y444
&
mask_y_de°
)==0)

324 i‡(
csx_fûe
 < 
csx_de°
)

327 c⁄° 
UI¡
 
sx
=
csx_de°
-
csx_fûe
;

328 i‡(!
is16bô
)

330 
UI¡
 
x
 = 0; x < 
width_de°
; x++)

332 
d°
[
x
] = 
buf
[x<<
sx
];

337 
UI¡
 
x
 = 0; x < 
width_de°
; x++)

339 
d°
[
x
] = 
	`Pñ
(
buf
[(x<<
sx
)*2+0]) | (Pel(buf[(x<<sx)*2+1])<<8);

346 c⁄° 
UI¡
 
sx
=
csx_fûe
-
csx_de°
;

347 i‡(!
is16bô
)

349 
UI¡
 
x
 = 0; x < 
width_de°
; x++)

351 
d°
[
x
] = 
buf
[x>>
sx
];

356 
UI¡
 
x
 = 0; x < 
width_de°
; x++)

358 
d°
[
x
] = 
	`Pñ
(
buf
[(x>>
sx
)*2+0]) | (Pel(buf[(x>>sx)*2+1])<<8);

364 c⁄° 
Pñ
 
vÆ
=
d°
[
width_de°
-1];

365 
UI¡
 
x
 = 
width_de°
; x < 
fuŒ_width_de°
; x++)

367 
d°
[
x
] = 
vÆ
;

370 
d°
 +
°ride_de°
;

375 
UI¡
 
y
 = 
height_de°
; y < 
fuŒ_height_de°
; y++, 
d°
+=
°ride_de°
)

377 
UI¡
 
x
 = 0; x < 
fuŒ_width_de°
; x++)

379 
d°
[
x
] = (d° - 
°ride_de°
)[x];

383  
åue
;

384 
	}
}

401 
Boﬁ
 
	$wrôePœ√
(
o°ªam
& 
fd
, 
Pñ
* 
§c
, 
Boﬁ
 
is16bô
,

402 
UI¡
 
°ride444
,

403 
UI¡
 
width444
, UI¡ 
height444
,

404 c⁄° 
Comp⁄ítID
 
compID
,

405 c⁄° 
ChromaF‹m©
 
§cF‹m©
,

406 c⁄° 
ChromaF‹m©
 
fûeF‹m©
,

407 c⁄° 
UI¡
 
fûeBôDïth
)

409 c⁄° 
UI¡
 
csx_fûe
 =
	`gëComp⁄ítSˇÀX
(
compID
, 
fûeF‹m©
);

410 c⁄° 
UI¡
 
csy_fûe
 =
	`gëComp⁄ítSˇÀY
(
compID
, 
fûeF‹m©
);

411 c⁄° 
UI¡
 
csx_§c
 =
	`gëComp⁄ítSˇÀX
(
compID
, 
§cF‹m©
);

412 c⁄° 
UI¡
 
csy_§c
 =
	`gëComp⁄ítSˇÀY
(
compID
, 
§cF‹m©
);

414 c⁄° 
UI¡
 
°ride_§c
 = 
°ride444
>>
csx_§c
;

416 c⁄° 
UI¡
 
°ride_fûe
 = (
width444
 * (
is16bô
 ? 2 : 1)Ë>> 
csx_fûe
;

417 c⁄° 
UI¡
 
width_fûe
 = 
width444
 >>
csx_fûe
;

418 c⁄° 
UI¡
 
height_fûe
 = 
height444
>>
csy_fûe
;

420 
°d
::
ve˘‹
<
UCh¨
> 
	`bufVec
(
°ride_fûe
);

421 
UCh¨
 *
buf
=&(
bufVec
[0]);

423 i‡(
compID
!=
COMPONENT_Y
 && (
fûeF‹m©
==
CHROMA_400
 || 
§cF‹m©
==CHROMA_400))

425 i‡(
fûeF‹m©
!=
CHROMA_400
)

427 c⁄° 
UI¡
 
vÆue
=1<<(
fûeBôDïth
-1);

429 
UI¡
 
y
=0; y< 
height_fûe
; y++)

431 i‡(!
is16bô
)

433 
UCh¨
 
	`vÆ
(
vÆue
);

434 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

436 
buf
[
x
]=
vÆ
;

441 
USh‹t
 
	`vÆ
(
vÆue
);

442 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

444 
buf
[2*
x
+0](
vÆ
>>0) & 0xff;

445 
buf
[2*
x
+1](
vÆ
>>8) & 0xff;

449 
fd
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(
buf
), 
°ride_fûe
);

450 i‡(
fd
.
	`eof
(Ë|| fd.
	`Áû
() )

452  
Ál£
;

459 c⁄° 
UI¡
 
mask_y_fûe
=(1<<
csy_fûe
)-1;

460 c⁄° 
UI¡
 
mask_y_§c
 =(1<<
csy_§c
 )-1;

461 
UI¡
 
y444
=0; y444<
height444
; y444++)

463 i‡((
y444
&
mask_y_fûe
)==0)

466 i‡(
csx_fûe
 < 
csx_§c
)

469 c⁄° 
UI¡
 
sx
=
csx_§c
-
csx_fûe
;

470 i‡(!
is16bô
)

472 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

474 
buf
[
x
] = (
UCh¨
)(
§c
[x>>
sx
]);

479 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

481 
buf
[2*
x
 ] = (
§c
[x>>
sx
]>>0) & 0xff;

482 
buf
[2*
x
+1] = (
§c
[x>>
sx
]>>8) & 0xff;

489 c⁄° 
UI¡
 
sx
=
csx_fûe
-
csx_§c
;

490 i‡(!
is16bô
)

492 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

494 
buf
[
x
] = (
UCh¨
)(
§c
[x<<
sx
]);

499 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

501 
buf
[2*
x
 ] = (
§c
[x<<
sx
]>>0) & 0xff;

502 
buf
[2*
x
+1] = (
§c
[x<<
sx
]>>8) & 0xff;

507 
fd
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(
buf
), 
°ride_fûe
);

508 i‡(
fd
.
	`eof
(Ë|| fd.
	`Áû
() )

510  
Ál£
;

514 i‡((
y444
&
mask_y_§c
)==0)

516 
§c
 +
°ride_§c
;

521  
åue
;

522 
	}
}

524 
Boﬁ
 
	$wrôeFõld
(
o°ªam
& 
fd
, 
Pñ
* 
t›
, Pñ* 
bŸtom
, 
Boﬁ
 
is16bô
,

525 
UI¡
 
°ride444
,

526 
UI¡
 
width444
, UI¡ 
height444
,

527 c⁄° 
Comp⁄ítID
 
compID
,

528 c⁄° 
ChromaF‹m©
 
§cF‹m©
,

529 c⁄° 
ChromaF‹m©
 
fûeF‹m©
,

530 c⁄° 
UI¡
 
fûeBôDïth
, c⁄° 
Boﬁ
 
isTff
)

532 c⁄° 
UI¡
 
csx_fûe
 =
	`gëComp⁄ítSˇÀX
(
compID
, 
fûeF‹m©
);

533 c⁄° 
UI¡
 
csy_fûe
 =
	`gëComp⁄ítSˇÀY
(
compID
, 
fûeF‹m©
);

534 c⁄° 
UI¡
 
csx_§c
 =
	`gëComp⁄ítSˇÀX
(
compID
, 
§cF‹m©
);

535 c⁄° 
UI¡
 
csy_§c
 =
	`gëComp⁄ítSˇÀY
(
compID
, 
§cF‹m©
);

537 c⁄° 
UI¡
 
°ride_§c
 = 
°ride444
>>
csx_§c
;

539 c⁄° 
UI¡
 
°ride_fûe
 = (
width444
 * (
is16bô
 ? 2 : 1)Ë>> 
csx_fûe
;

540 c⁄° 
UI¡
 
width_fûe
 = 
width444
 >>
csx_fûe
;

541 c⁄° 
UI¡
 
height_fûe
 = 
height444
>>
csy_fûe
;

543 
°d
::
ve˘‹
<
UCh¨
> 
	`bufVec
(
°ride_fûe
 * 2);

544 
UCh¨
 *
buf
=&(
bufVec
[0]);

546 i‡(
compID
!=
COMPONENT_Y
 && (
fûeF‹m©
==
CHROMA_400
 || 
§cF‹m©
==CHROMA_400))

548 i‡(
fûeF‹m©
!=
CHROMA_400
)

550 c⁄° 
UI¡
 
vÆue
=1<<(
fûeBôDïth
-1);

552 
UI¡
 
y
=0; y< 
height_fûe
; y++)

554 
UI¡
 
fõld
 = 0; field < 2; field++)

556 
UCh¨
 *
fõldBuf„r
 = 
buf
 + (
fõld
 * 
°ride_fûe
);

558 i‡(!
is16bô
)

560 
UCh¨
 
	`vÆ
(
vÆue
);

561 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

563 
fõldBuf„r
[
x
]=
vÆ
;

568 
USh‹t
 
	`vÆ
(
vÆue
);

569 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

571 
fõldBuf„r
[2*
x
+0](
vÆ
>>0) & 0xff;

572 
fõldBuf„r
[2*
x
+1](
vÆ
>>8) & 0xff;

577 
fd
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(
buf
), (
°ride_fûe
 * 2));

578 i‡(
fd
.
	`eof
(Ë|| fd.
	`Áû
() )

580  
Ál£
;

587 c⁄° 
UI¡
 
mask_y_fûe
=(1<<
csy_fûe
)-1;

588 c⁄° 
UI¡
 
mask_y_§c
 =(1<<
csy_§c
 )-1;

589 
UI¡
 
y444
=0; y444<
height444
; y444++)

591 i‡((
y444
&
mask_y_fûe
)==0)

593 
UI¡
 
fõld
 = 0; field < 2; field++)

595 
UCh¨
 *
fõldBuf„r
 = 
buf
 + (
fõld
 * 
°ride_fûe
);

596 
Pñ
 *
§c
 = (((
fõld
 =0Ë&& 
isTff
Ë|| ((fõld =1Ë&& (!isTff))Ë? 
t›
 : 
bŸtom
;

599 i‡(
csx_fûe
 < 
csx_§c
)

602 c⁄° 
UI¡
 
sx
=
csx_§c
-
csx_fûe
;

603 i‡(!
is16bô
)

605 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

607 
fõldBuf„r
[
x
] = (
UCh¨
)(
§c
[x>>
sx
]);

612 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

614 
fõldBuf„r
[2*
x
 ] = (
§c
[x>>
sx
]>>0) & 0xff;

615 
fõldBuf„r
[2*
x
+1] = (
§c
[x>>
sx
]>>8) & 0xff;

622 c⁄° 
UI¡
 
sx
=
csx_fûe
-
csx_§c
;

623 i‡(!
is16bô
)

625 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

627 
fõldBuf„r
[
x
] = (
UCh¨
)(
§c
[x<<
sx
]);

632 
UI¡
 
x
 = 0; x < 
width_fûe
; x++)

634 
fõldBuf„r
[2*
x
 ] = (
§c
[x<<
sx
]>>0) & 0xff;

635 
fõldBuf„r
[2*
x
+1] = (
§c
[x<<
sx
]>>8) & 0xff;

641 
fd
.
	`wrôe
(
ªöãΩªt_ˇ°
<c⁄° 
TCh¨
*>(
buf
), (
°ride_fûe
 * 2));

642 i‡(
fd
.
	`eof
(Ë|| fd.
	`Áû
() )

644  
Ál£
;

648 i‡((
y444
&
mask_y_§c
)==0)

650 
t›
 +
°ride_§c
;

651 
bŸtom
 +
°ride_§c
;

656  
åue
;

657 
	}
}

675 
Boﬁ
 
	gTVideoIOYuv
::
	$ªad
 ( 
TComPicYuv
* 
pPicYuvU£r
, TComPicYuv* 
pPicYuvTrueOrg
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùcsc
, 
I¡
 
aiPad
[2], 
ChromaF‹m©
 
f‹m©
, c⁄° 
Boﬁ
 
bClùToRec709
 )

678 i‡–
	`isEof
() )

680  
Ál£
;

682 
TComPicYuv
 *
pPicYuv
=
pPicYuvTrueOrg
;

683 i‡(
f‹m©
>=
NUM_CHROMA_FORMAT
)

685 
f‹m©
=
pPicYuv
->
	`gëChromaF‹m©
();

688 
Boﬁ
 
is16bô
 = 
Ál£
;

690 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

692 i‡(
m_fûeBôdïth
[
ch
] > 8)

694 
is16bô
=
åue
;

698 c⁄° 
UI¡
 
°ride444
 = 
pPicYuv
->
	`gëSåide
(
COMPONENT_Y
);

701 c⁄° 
UI¡
 
∑d_h444
 = 
aiPad
[0];

702 c⁄° 
UI¡
 
∑d_v444
 = 
aiPad
[1];

704 c⁄° 
UI¡
 
width_fuŒ444
 = 
pPicYuv
->
	`gëWidth
(
COMPONENT_Y
);

705 c⁄° 
UI¡
 
height_fuŒ444
 = 
pPicYuv
->
	`gëHeight
(
COMPONENT_Y
);

707 c⁄° 
UI¡
 
width444
 = 
width_fuŒ444
 - 
∑d_h444
;

708 c⁄° 
UI¡
 
height444
 = 
height_fuŒ444
 - 
∑d_v444
;

710 
UI¡
 
comp
=0; comp<
MAX_NUM_COMPONENT
; comp++)

712 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp
);

713 c⁄° 
Ch™√lTy≥
 
chTy≥
=
	`toCh™√lTy≥
(
compID
);

715 c⁄° 
I¡
 
desúed_bôdïth
 = 
m_MSBExãndedBôDïth
[
chTy≥
] + 
m_bôdïthShi·
[chType];

717 c⁄° 
Boﬁ
 
b709Com∂ün˚
=(
bClùToRec709
Ë&& (
m_bôdïthShi·
[
chTy≥
] < 0 && 
desúed_bôdïth
 >= 8);

718 c⁄° 
Pñ
 
mövÆ
 = 
b709Com∂ün˚
? (–1 << (
desúed_bôdïth
 - 8)) ) : 0;

719 c⁄° 
Pñ
 
maxvÆ
 = 
b709Com∂ün˚
? ((0xf‡<< (
desúed_bôdïth
 - 8)) -1) : (1 << desired_bitdepth) - 1;

721 i‡(! 
	`ªadPœ√
(
pPicYuv
->
	`gëAddr
(
compID
), 
m_cH™dÀ
, 
is16bô
, 
°ride444
, 
width444
, 
height444
, 
∑d_h444
, 
∑d_v444
, compID,ÖPicYuv->
	`gëChromaF‹m©
(), 
f‹m©
, 
m_fûeBôdïth
[
chTy≥
]))

723  
Ál£
;

726 i‡(
compID
 < 
pPicYuv
->
	`gëNumbîVÆidComp⁄íts
() )

728 c⁄° 
UI¡
 
csx
=
	`gëComp⁄ítSˇÀX
(
compID
, 
pPicYuv
->
	`gëChromaF‹m©
());

729 c⁄° 
UI¡
 
csy
=
	`gëComp⁄ítSˇÀY
(
compID
, 
pPicYuv
->
	`gëChromaF‹m©
());

730 
	`sˇÀPœ√
(
pPicYuv
->
	`gëAddr
(
compID
), 
°ride444
>>
csx
, 
width_fuŒ444
>>csx, 
height_fuŒ444
>>
csy
, 
m_bôdïthShi·
[
chTy≥
], 
mövÆ
, 
maxvÆ
);

734 if(
pPicYuvU£r
)

736 
	`CﬁourS∑˚C⁄vît
(*
pPicYuvTrueOrg
, *
pPicYuvU£r
, 
ùcsc
, 
åue
);

739  
åue
;

740 
	}
}

755 
Boﬁ
 
	gTVideoIOYuv
::
	$wrôe
–
TComPicYuv
* 
pPicYuvU£r
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, 
I¡
 
c⁄fLe·
, I¡ 
c⁄fRight
, I¡ 
c⁄fT›
, I¡ 
c⁄fBŸtom
, 
ChromaF‹m©
 
f‹m©
, c⁄° 
Boﬁ
 
bClùToRec709
 )

757 
TComPicYuv
 
cPicYuvCSCd
;

758 i‡(
ùCSC
!=
IPCOLOURSPACE_UNCHANGED
)

760 
cPicYuvCSCd
.
	`¸óãWôhoutCUInfo
(
pPicYuvU£r
->
	`gëWidth
(
COMPONENT_Y
),ÖPicYuvU£r->
	`gëHeight
(COMPONENT_Y),ÖPicYuvU£r->
	`gëChromaF‹m©
() );

761 
	`CﬁourS∑˚C⁄vît
(*
pPicYuvU£r
, 
cPicYuvCSCd
, 
ùCSC
, 
Ál£
);

763 
TComPicYuv
 *
pPicYuv
=(
ùCSC
==
IPCOLOURSPACE_UNCHANGED
Ë? 
pPicYuvU£r
 : &
cPicYuvCSCd
;

766 
Boﬁ
 
is16bô
 = 
Ál£
;

767 
Boﬁ
 
n⁄ZîoBôDïthShi·
=
Ál£
;

769 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

771 i‡(
m_fûeBôdïth
[
ch
] > 8)

773 
is16bô
=
åue
;

775 i‡(
m_bôdïthShi·
[
ch
] != 0)

777 
n⁄ZîoBôDïthShi·
=
åue
;

781 
TComPicYuv
 *
d°PicYuv
 = 
NULL
;

782 
Boﬁ
 
ªtvÆ
 = 
åue
;

783 i‡(
f‹m©
>=
NUM_CHROMA_FORMAT
)

785 
f‹m©
=
pPicYuv
->
	`gëChromaF‹m©
();

788 i‡(
n⁄ZîoBôDïthShi·
)

790 
d°PicYuv
 = 
√w
 
TComPicYuv
;

791 
d°PicYuv
->
	`¸óãWôhoutCUInfo
–
pPicYuv
->
	`gëWidth
(
COMPONENT_Y
),ÖPicYuv->
	`gëHeight
(COMPONENT_Y),ÖPicYuv->
	`gëChromaF‹m©
() );

793 
UI¡
 
comp
=0; comp<
d°PicYuv
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

795 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

796 c⁄° 
Ch™√lTy≥
 
ch
=
	`toCh™√lTy≥
(
compID
);

797 c⁄° 
Boﬁ
 
b709Com∂ün˚
 = 
bClùToRec709
 && (-
m_bôdïthShi·
[
ch
] < 0 && 
m_MSBExãndedBôDïth
[ch] >= 8);

798 c⁄° 
Pñ
 
mövÆ
 = 
b709Com∂ün˚
? (–1 << (
m_MSBExãndedBôDïth
[
ch
] - 8)) ) : 0;

799 c⁄° 
Pñ
 
maxvÆ
 = 
b709Com∂ün˚
? ((0xf‡<< (
m_MSBExãndedBôDïth
[
ch
] - 8)) -1) : (1 << m_MSBExtendedBitDepth[ch]) - 1;

801 
	`c›yPœ√
(*
pPicYuv
, 
compID
, *
d°PicYuv
, compID);

802 
	`sˇÀPœ√
(
d°PicYuv
->
	`gëAddr
(
compID
), d°PicYuv->
	`gëSåide
(compID), d°PicYuv->
	`gëWidth
(compID), d°PicYuv->
	`gëHeight
(compID), -
m_bôdïthShi·
[
ch
], 
mövÆ
, 
maxvÆ
);

807 
d°PicYuv
 = 
pPicYuv
;

810 c⁄° 
I¡
 
°ride444
 = 
d°PicYuv
->
	`gëSåide
(
COMPONENT_Y
);

811 c⁄° 
UI¡
 
width444
 = 
d°PicYuv
->
	`gëWidth
(
COMPONENT_Y
Ë- 
c⁄fLe·
 - 
c⁄fRight
;

812 c⁄° 
UI¡
 
height444
 = 
d°PicYuv
->
	`gëHeight
(
COMPONENT_Y
Ë- 
c⁄fT›
 - 
c⁄fBŸtom
;

814 i‡((
width444
 =0Ë|| (
height444
 == 0))

816 
	`¥ötf
 ("\nW¨nög: wrôög %d x %dÜum®ßm∂êouçuàpi˘uª!", 
width444
, 
height444
);

819 
UI¡
 
comp
=0; 
ªtvÆ
 && comp<
d°PicYuv
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

821 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp
);

822 c⁄° 
Ch™√lTy≥
 
ch
=
	`toCh™√lTy≥
(
compID
);

823 c⁄° 
UI¡
 
csx
 = 
d°PicYuv
->
	`gëComp⁄ítSˇÀX
(
compID
);

824 c⁄° 
UI¡
 
csy
 = 
d°PicYuv
->
	`gëComp⁄ítSˇÀY
(
compID
);

825 c⁄° 
I¡
 
∂™eOff£t
 = (
c⁄fLe·
>>
csx
Ë+ (
c⁄fT›
>>
csy
Ë* 
d°PicYuv
->
	`gëSåide
(
compID
);

826 i‡(! 
	`wrôePœ√
(
m_cH™dÀ
, 
d°PicYuv
->
	`gëAddr
(
compID
Ë+ 
∂™eOff£t
, 
is16bô
, 
°ride444
, 
width444
, 
height444
, compID, d°PicYuv->
	`gëChromaF‹m©
(), 
f‹m©
, 
m_fûeBôdïth
[
ch
]))

828 
ªtvÆ
=
Ál£
;

832 i‡(
n⁄ZîoBôDïthShi·
)

834 
d°PicYuv
->
	`de°roy
();

835 
dñëe
 
d°PicYuv
;

838 
cPicYuvCSCd
.
	`de°roy
();

840  
ªtvÆ
;

841 
	}
}

843 
Boﬁ
 
	gTVideoIOYuv
::
	$wrôe
–
TComPicYuv
* 
pPicYuvU£rT›
, TComPicYuv* 
pPicYuvU£rBŸtom
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, 
I¡
 
c⁄fLe·
, I¡ 
c⁄fRight
, I¡ 
c⁄fT›
, I¡ 
c⁄fBŸtom
, 
ChromaF‹m©
 
f‹m©
, c⁄° 
Boﬁ
 
isTff
, c⁄° Boﬁ 
bClùToRec709
 )

846 
TComPicYuv
 
cPicYuvT›CSCd
;

847 
TComPicYuv
 
cPicYuvBŸtomCSCd
;

848 i‡(
ùCSC
!=
IPCOLOURSPACE_UNCHANGED
)

850 
cPicYuvT›CSCd
 .
	`¸óãWôhoutCUInfo
(
pPicYuvU£rT›
 ->
	`gëWidth
(
COMPONENT_Y
),ÖPicYuvU£rT› ->
	`gëHeight
(COMPONENT_Y),ÖPicYuvU£rT› ->
	`gëChromaF‹m©
() );

851 
cPicYuvBŸtomCSCd
.
	`¸óãWôhoutCUInfo
(
pPicYuvU£rBŸtom
->
	`gëWidth
(
COMPONENT_Y
),ÖPicYuvU£rBŸtom->
	`gëHeight
(COMPONENT_Y),ÖPicYuvU£rBŸtom->
	`gëChromaF‹m©
() );

852 
	`CﬁourS∑˚C⁄vît
(*
pPicYuvU£rT›
, 
cPicYuvT›CSCd
, 
ùCSC
, 
Ál£
);

853 
	`CﬁourS∑˚C⁄vît
(*
pPicYuvU£rBŸtom
, 
cPicYuvBŸtomCSCd
, 
ùCSC
, 
Ál£
);

855 
TComPicYuv
 *
pPicYuvT›
 = (
ùCSC
==
IPCOLOURSPACE_UNCHANGED
Ë? 
pPicYuvU£rT›
 : &
cPicYuvT›CSCd
;

856 
TComPicYuv
 *
pPicYuvBŸtom
 = (
ùCSC
==
IPCOLOURSPACE_UNCHANGED
Ë? 
pPicYuvU£rBŸtom
 : &
cPicYuvBŸtomCSCd
;

858 
Boﬁ
 
is16bô
 = 
Ál£
;

859 
Boﬁ
 
n⁄ZîoBôDïthShi·
=
Ál£
;

861 
UI¡
 
ch
=0; ch<
MAX_NUM_CHANNEL_TYPE
; ch++)

863 i‡(
m_fûeBôdïth
[
ch
] > 8)

865 
is16bô
=
åue
;

867 i‡(
m_bôdïthShi·
[
ch
] != 0)

869 
n⁄ZîoBôDïthShi·
=
åue
;

873 
TComPicYuv
 *
d°PicYuvT›
 = 
NULL
;

874 
TComPicYuv
 *
d°PicYuvBŸtom
 = 
NULL
;

876 
UI¡
 
fõld
 = 0; field < 2; field++)

878 
TComPicYuv
 *
pPicYuv
 = (
fõld
 =0Ë? 
pPicYuvT›
 : 
pPicYuvBŸtom
;

880 i‡(
f‹m©
>=
NUM_CHROMA_FORMAT
)

882 
f‹m©
=
pPicYuv
->
	`gëChromaF‹m©
();

885 
TComPicYuv
* &
d°PicYuv
 = (
fõld
 =0Ë? 
d°PicYuvT›
 : 
d°PicYuvBŸtom
;

887 i‡(
n⁄ZîoBôDïthShi·
)

889 
d°PicYuv
 = 
√w
 
TComPicYuv
;

890 
d°PicYuv
->
	`¸óãWôhoutCUInfo
–
pPicYuv
->
	`gëWidth
(
COMPONENT_Y
),ÖPicYuv->
	`gëHeight
(COMPONENT_Y),ÖPicYuv->
	`gëChromaF‹m©
() );

892 
UI¡
 
comp
=0; comp<
d°PicYuv
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

894 c⁄° 
Comp⁄ítID
 
compID
=
	`Comp⁄ítID
(
comp
);

895 c⁄° 
Ch™√lTy≥
 
ch
=
	`toCh™√lTy≥
(
compID
);

896 c⁄° 
Boﬁ
 
b709Com∂ün˚
=
bClùToRec709
 && (-
m_bôdïthShi·
[
ch
] < 0 && 
m_MSBExãndedBôDïth
[ch] >= 8);

897 c⁄° 
Pñ
 
mövÆ
 = 
b709Com∂ün˚
? (–1 << (
m_MSBExãndedBôDïth
[
ch
] - 8)) ) : 0;

898 c⁄° 
Pñ
 
maxvÆ
 = 
b709Com∂ün˚
? ((0xf‡<< (
m_MSBExãndedBôDïth
[
ch
] - 8)) -1) : (1 << m_MSBExtendedBitDepth[ch]) - 1;

900 
	`c›yPœ√
(*
pPicYuv
, 
compID
, *
d°PicYuv
, compID);

901 
	`sˇÀPœ√
(
d°PicYuv
->
	`gëAddr
(
compID
), d°PicYuv->
	`gëSåide
(compID), d°PicYuv->
	`gëWidth
(compID), d°PicYuv->
	`gëHeight
(compID), -
m_bôdïthShi·
[
ch
], 
mövÆ
, 
maxvÆ
);

906 
d°PicYuv
 = 
pPicYuv
;

910 
Boﬁ
 
ªtvÆ
 = 
åue
;

912 
	`as£π
(
d°PicYuvT›
->
	`gëNumbîVÆidComp⁄íts
(Ë=
d°PicYuvBŸtom
->getNumberValidComponents());

913 
	`as£π
(
d°PicYuvT›
->
	`gëChromaF‹m©
(Ë=
d°PicYuvBŸtom
->getChromaFormat() );

915 
UI¡
 
comp
=0; 
ªtvÆ
 && comp<
d°PicYuvT›
->
	`gëNumbîVÆidComp⁄íts
(); comp++)

917 c⁄° 
Comp⁄ítID
 
compID
 = 
	`Comp⁄ítID
(
comp
);

918 c⁄° 
Ch™√lTy≥
 
ch
=
	`toCh™√lTy≥
(
compID
);

920 
	`as£π
(
d°PicYuvT›
->
	`gëWidth
 (
compID
Ë=
d°PicYuvBŸtom
->getWidth (compID));

921 
	`as£π
(
d°PicYuvT›
->
	`gëHeight
 (
compID
Ë=
d°PicYuvBŸtom
->getHeight (compID));

922 
	`as£π
(
d°PicYuvT›
->
	`gëComp⁄ítSˇÀX
(
compID
Ë=
d°PicYuvBŸtom
->getComponentScaleX(compID));

923 
	`as£π
(
d°PicYuvT›
->
	`gëComp⁄ítSˇÀY
(
compID
Ë=
d°PicYuvBŸtom
->getComponentScaleY(compID));

924 
	`as£π
(
d°PicYuvT›
->
	`gëSåide
 (
compID
Ë=
d°PicYuvBŸtom
->getStride (compID));

926 c⁄° 
UI¡
 
width444
 = 
d°PicYuvT›
->
	`gëWidth
(
COMPONENT_Y
Ë- (
c⁄fLe·
 + 
c⁄fRight
);

927 c⁄° 
UI¡
 
height444
 = 
d°PicYuvT›
->
	`gëHeight
(
COMPONENT_Y
Ë- (
c⁄fT›
 + 
c⁄fBŸtom
);

929 i‡((
width444
 =0Ë|| (
height444
 == 0))

931 
	`¥ötf
 ("\nW¨nög: wrôög %d x %dÜum®ßm∂êouçuàpi˘uª!", 
width444
, 
height444
);

934 c⁄° 
UI¡
 
csx
 = 
d°PicYuvT›
->
	`gëComp⁄ítSˇÀX
(
compID
);

935 c⁄° 
UI¡
 
csy
 = 
d°PicYuvT›
->
	`gëComp⁄ítSˇÀY
(
compID
);

936 c⁄° 
I¡
 
∂™eOff£t
 = (
c⁄fLe·
>>
csx
Ë+ ( 
c⁄fT›
>>
csy
Ë* 
d°PicYuvT›
->
	`gëSåide
(
compID
);

938 i‡(! 
	`wrôeFõld
(
m_cH™dÀ
,

939 (
d°PicYuvT›
 ->
	`gëAddr
(
compID
Ë+ 
∂™eOff£t
),

940 (
d°PicYuvBŸtom
->
	`gëAddr
(
compID
Ë+ 
∂™eOff£t
),

941 
is16bô
,

942 
d°PicYuvT›
->
	`gëSåide
(
COMPONENT_Y
),

943 
width444
, 
height444
, 
compID
, 
d°PicYuvT›
->
	`gëChromaF‹m©
(), 
f‹m©
, 
m_fûeBôdïth
[
ch
], 
isTff
))

945 
ªtvÆ
=
Ál£
;

949 i‡(
n⁄ZîoBôDïthShi·
)

951 
d°PicYuvT›
->
	`de°roy
();

952 
d°PicYuvBŸtom
->
	`de°roy
();

953 
dñëe
 
d°PicYuvT›
;

954 
dñëe
 
d°PicYuvBŸtom
;

957 
cPicYuvT›CSCd
.
	`de°roy
();

958 
cPicYuvBŸtomCSCd
.
	`de°roy
();

960  
ªtvÆ
;

961 
	}
}

963 
Void


964 
	$c›yPœ√
(c⁄° 
TComPicYuv
 &
§c
, c⁄° 
Comp⁄ítID
 
§cPœ√
, TComPicYuv &
de°
, c⁄° Comp⁄ítID 
de°Pœ√
)

966 c⁄° 
UI¡
 
width
=
§c
.
	`gëWidth
(
§cPœ√
);

967 c⁄° 
UI¡
 
height
=
§c
.
	`gëHeight
(
§cPœ√
);

968 
	`as£π
(
de°
.
	`gëWidth
(
de°Pœ√
Ë=
width
);

969 
	`as£π
(
de°
.
	`gëHeight
(
de°Pœ√
Ë=
height
);

970 c⁄° 
Pñ
 *
pSrc
=
§c
.
	`gëAddr
(
§cPœ√
);

971 
Pñ
 *
pDe°
=
de°
.
	`gëAddr
(
de°Pœ√
);

972 c⁄° 
UI¡
 
°rideSrc
=
§c
.
	`gëSåide
(
§cPœ√
);

973 c⁄° 
UI¡
 
°rideDe°
=
de°
.
	`gëSåide
(
de°Pœ√
);

974 
UI¡
 
y
=0; y<
height
; y++, 
pSrc
+=
°rideSrc
, 
pDe°
+=
°rideDe°
)

976 
	`mem˝y
(
pDe°
, 
pSrc
, 
width
*(
Pñ
));

978 
	}
}

981 
Void
 
	gTVideoIOYuv
::
	$CﬁourS∑˚C⁄vît
(c⁄° 
TComPicYuv
 &
§c
, TComPicYuv &
de°
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
c⁄vîsi⁄
, 
Boﬁ
 
bIsF‹w¨ds
)

983 c⁄° 
ChromaF‹m©
 
f‹m©
=
§c
.
	`gëChromaF‹m©
();

984 c⁄° 
UI¡
 
numVÆidComp
=
§c
.
	`gëNumbîVÆidComp⁄íts
();

986 
c⁄vîsi⁄
)

988 
IPCOLOURSPACE_YCbCπoYYY
:

989 i‡(
f‹m©
!=
CHROMA_444
)

992 
	`as£π
(
f‹m©
==
CHROMA_444
);

993 
	`exô
(1);

997 
UI¡
 
comp
=0; comp<
numVÆidComp
; comp++)

999 
	`c›yPœ√
(
§c
, 
	`Comp⁄ítID
(
bIsF‹w¨ds
?0:
comp
), 
de°
, ComponentID(comp));

1003 
IPCOLOURSPACE_YCbCπoYCrCb
:

1005 
UI¡
 
comp
=0; comp<
numVÆidComp
; comp++)

1007 
	`c›yPœ√
(
§c
, 
	`Comp⁄ítID
(
comp
), 
de°
, Comp⁄ítID((
numVÆidComp
-comp)%numValidComp));

1012 
IPCOLOURSPACE_RGBtoGBR
:

1014 i‡(
f‹m©
!=
CHROMA_444
)

1017 
	`as£π
(
f‹m©
==
CHROMA_444
);

1018 
	`exô
(1);

1022 
UI¡
 
comp
=0; comp<
numVÆidComp
; comp++)

1024 c⁄° 
Comp⁄ítID
 
compID§c
=
	`Comp⁄ítID
((
comp
+1)%
numVÆidComp
);

1025 c⁄° 
Comp⁄ítID
 
compIDd°
=
	`Comp⁄ítID
(
comp
);

1026 
	`c›yPœ√
(
§c
, 
bIsF‹w¨ds
?
compID§c
:
compIDd°
, 
de°
, bIsForwards?compIDdst:compIDsrc);

1031 
IPCOLOURSPACE_UNCHANGED
:

1034 
UI¡
 
comp
=0; comp<
numVÆidComp
; comp++)

1036 
	`c›yPœ√
(
§c
, 
	`Comp⁄ítID
(
comp
), 
de°
, ComponentID(comp));

1041 
	}
}

	@Utilities/TVideoIOYuv.h

38 #i‚de‡
__TVIDEOIOYUV__


39 
	#__TVIDEOIOYUV__


	)

41 
	~<°dio.h
>

42 
	~<f°ªam
>

43 
	~<io°ªam
>

44 
	~"TLibComm⁄/Comm⁄Def.h
"

45 
	~"TLibComm⁄/TComPicYuv.h
"

47 
usög
 
«me•a˚
 
	g°d
;

54 ˛as†
	cTVideoIOYuv


56 
	m¥iv©e
:

57 
f°ªam
 
m_cH™dÀ
;

58 
I¡
 
	mm_fûeBôdïth
[
MAX_NUM_CHANNEL_TYPE
];

59 
I¡
 
	mm_MSBExãndedBôDïth
[
MAX_NUM_CHANNEL_TYPE
];

60 
I¡
 
	mm_bôdïthShi·
[
MAX_NUM_CHANNEL_TYPE
];

62 
	mpublic
:

63 
	$TVideoIOYuv
() {}

64 
vútuÆ
 ~
	$TVideoIOYuv
(Ë{
	}
}

66 
Void
 
›í
 ( c⁄° 
°d
::
°rög
 &
fûeName
, 
Boﬁ
 
bWrôeMode
, c⁄° 
I¡
 
fûeBôDïth
[
MAX_NUM_CHANNEL_TYPE
], c⁄° I¡ 
MSBExãndedBôDïth
[MAX_NUM_CHANNEL_TYPE], c⁄° I¡ 
öã∫ÆBôDïth
[MAX_NUM_CHANNEL_TYPE] );

67 
Void
 
˛o£
 ();

69 
Void
 
skùFømes
(
I¡
 
numFømes
, 
UI¡
 
width
, UI¡ 
height
, 
ChromaF‹m©
 
f‹m©
);

75 
Boﬁ
 
ªad
 ( 
TComPicYuv
* 
pPicYuv
, TComPicYuv* 
pPicYuvTrueOrg
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùcsc
, 
I¡
 
aiPad
[2], 
ChromaF‹m©
 
fûeF‹m©
=
NUM_CHROMA_FORMAT
, c⁄° Boﬁ 
bClùToRec709
=
Ál£
 );

78 
Boﬁ
 
wrôe
 ( 
TComPicYuv
* 
pPicYuv
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, 
I¡
 
c⁄fLe·
=0, I¡ 
c⁄fRight
=0, I¡ 
c⁄fT›
=0, I¡ 
c⁄fBŸtom
=0, 
ChromaF‹m©
 
fûeF‹m©
=
NUM_CHROMA_FORMAT
, c⁄° Boﬁ 
bClùToRec709
=
Ál£
 );

81 
Boﬁ
 
wrôe
 ( 
TComPicYuv
* 
pPicYuvT›
, TComPicYuv* 
pPicYuvBŸtom
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
ùCSC
, 
I¡
 
c⁄fLe·
=0, I¡ 
c⁄fRight
=0, I¡ 
c⁄fT›
=0, I¡ 
c⁄fBŸtom
=0, 
ChromaF‹m©
 
fûeF‹m©
=
NUM_CHROMA_FORMAT
, c⁄° Boﬁ 
isTff
=
Ál£
, c⁄° Boﬁ 
bClùToRec709
=false);

82 
Void
 
CﬁourS∑˚C⁄vît
(c⁄° 
TComPicYuv
 &
§c
, TComPicYuv &
de°
, c⁄° 
I≈utCﬁourS∑˚C⁄vîsi⁄
 
c⁄vîsi⁄
, 
Boﬁ
 
bIsF‹w¨ds
);

84 
Boﬁ
 
isEof
 ();

85 
Boﬁ
 
isFaû
();

	@Utilities/program_options_lite.cpp

33 
	~<°dlib.h
>

34 
	~<io°ªam
>

35 
	~<f°ªam
>

36 
	~<s°ªam
>

37 
	~<°rög
>

38 
	~<li°
>

39 
	~<m≠
>

40 
	~<Æg‹ôhm
>

41 
	~"¥ogøm_›ti⁄s_lôe.h
"

43 
usög
 
«me•a˚
 
	g°d
;

48 
«me•a˚
 
	gdf


50 
«me•a˚
 
	g¥ogøm_›ti⁄s_lôe


52 
Eº‹Rï‹ãr
 
	gdeÁu…_îr‹_ªp‹ãr
;

54 
	go°ªam
& 
	gEº‹Rï‹ãr
::
îr‹
(c⁄° 
°rög
& 
whîe
)

56 
is_îr‹ed
 = 1;

57 
	g˚º
 << 
	gwhîe
 << "Érror: ";

58  
	g˚º
;

61 
	go°ªam
& 
	gEº‹Rï‹ãr
::
w¨n
(c⁄° 
°rög
& 
whîe
)

63 
˚º
 << 
whîe
 << " warning: ";

64  
	g˚º
;

67 
	gO±i⁄s
::~
O±i⁄s
()

69 
O±i⁄s
::
NamesPåLi°
::
ôî©‹
 
ô
 = 
›t_li°
.
begö
(); 
	gô
 !›t_li°.
íd
(); it++)

71 
dñëe
 *
	gô
;

75 
	gO±i⁄s
::
addO±i⁄
(
O±i⁄Ba£
 *
›t
)

77 
Names
* 
«mes
 = 
√w
 Names();

78 
	g«mes
->
	g›t
 = 
›t
;

79 
	g°rög
& 
	g›t_°rög
 = 
›t
->
›t_°rög
;

81 
size_t
 
	g›t_°¨t
 = 0;

82 
size_t
 
	g›t_íd
 = 0; o±_íd !
°rög
::
≈os
;)

84 
	g›t_íd
 = 
›t_°rög
.
föd_fú°_of
(',', 
›t_°¨t
);

85 
boﬁ
 
	gf‹˚_sh‹t
 = 0;

86 i‡(
	g›t_°rög
[
›t_°¨t
] == '-')

88 
›t_°¨t
++;

89 
	gf‹˚_sh‹t
 = 1;

91 
°rög
 
	g›t_«me
 = 
›t_°rög
.
sub°r
(
›t_°¨t
, 
›t_íd
 - opt_start);

92 i‡(
	gf‹˚_sh‹t
 || 
	g›t_«me
.
size
() == 1)

94 
«mes
->
›t_sh‹t
.
push_back
(
›t_«me
);

95 
	g›t_sh‹t_m≠
[
›t_«me
].
push_back
(
«mes
);

99 i‡(
	g›t_«me
.
size
(Ë> 0 && o±_«me.
back
() == '*')

101 
°rög
 
¥efix_«me
 = 
›t_«me
.
sub°r
(0, o±_«me.
size
() - 1);

102 
	g«mes
->
	g›t_¥efix
.
push_back
(
¥efix_«me
);

103 
	g›t_¥efix_m≠
[
¥efix_«me
].
push_back
(
«mes
);

107 
	g«mes
->
	g›t_l⁄g
.
push_back
(
›t_«me
);

108 
	g›t_l⁄g_m≠
[
›t_«me
].
push_back
(
«mes
);

111 
	g›t_°¨t
 +
›t_íd
 + 1;

113 
	g›t_li°
.
push_back
(
«mes
);

117 
O±i⁄S≥cific
 
	gO±i⁄s
::
addO±i⁄s
()

119  
O±i⁄S≥cific
(*
this
);

122 
£tO±i⁄s
(
O±i⁄s
::
NamesPåLi°
& 
›t_li°
, c⁄° 
°rög
& 
vÆue
, 
Eº‹Rï‹ãr
& 
îr‹_ªp‹ãr
)

126 
	gO±i⁄s
::
NamesPåLi°
::
ôî©‹
 
ô
 = 
›t_li°
.
begö
(); 
	gô
 !›t_li°.
íd
(); ++it)

128 (*
	gô
)->
	g›t
->
∑r£
(
vÆue
, 
îr‹_ªp‹ãr
);

132 c⁄° 
	g•a˚s
[41] = " ";

138 
doHñpO±
(
o°ªam
& 
out
, c⁄° 
O±i⁄s
::
Names
& 
íåy
, 
∑d_sh‹t
 = 0)

140 
∑d_sh‹t
 = 
mö
(pad_short, 8u);

142 i‡(!
	gíåy
.
	g›t_sh‹t
.
em±y
())

144 
	g∑d
 = 
max
(()
∑d_sh‹t
 - ()
íåy
.
›t_sh‹t
.
‰⁄t
().
size
(), 0);

145 
	gout
 << "-" << 
	gíåy
.
	g›t_sh‹t
.
‰⁄t
();

146 i‡(!
	gíåy
.
	g›t_l⁄g
.
em±y
())

148 
	gout
 << ", ";

150 
	gout
 << &(
	g•a˚s
[40 - 
∑d
]);

154 
	gout
 << " ";

155 
	gout
 << &(
	g•a˚s
[40 - 
∑d_sh‹t
]);

158 i‡(!
	gíåy
.
	g›t_l⁄g
.
em±y
())

160 
	gout
 << "--" << 
	gíåy
.
	g›t_l⁄g
.
‰⁄t
();

162 i‡(!
	gíåy
.
	g›t_¥efix
.
em±y
())

164 
	gout
 << "--" << 
	gíåy
.
	g›t_¥efix
.
‰⁄t
() << "*";

169 
doHñp
(
o°ªam
& 
out
, 
O±i⁄s
& 
›ts
, 
cﬁumns
)

171 c⁄° 
	g∑d_sh‹t
 = 3;

173 
	gmax_width
 = 0;

174 
	gO±i⁄s
::
NamesPåLi°
::
ôî©‹
 
ô
 = 
›ts
.
›t_li°
.
begö
(); 
	gô
 !›ts.›t_li°.
íd
(); it++)

176 
o°rög°ªam
 
löe
(
ios_ba£
::
out
);

177 
doHñpO±
(
löe
, **
ô
, 
∑d_sh‹t
);

178 
	gmax_width
 = 
max
(
max_width
, (Ë
löe
.
ãŒp
());

181 
	g›t_width
 = 
mö
(
max_width
+2, 28u + 
∑d_sh‹t
) + 2;

182 
	gdesc_width
 = 
cﬁumns
 - 
›t_width
;

189 
	gO±i⁄s
::
NamesPåLi°
::
ôî©‹
 
ô
 = 
›ts
.
›t_li°
.
begö
(); 
	gô
 !›ts.›t_li°.
íd
(); it++)

191 
o°rög°ªam
 
löe
(
ios_ba£
::
out
);

192 
	glöe
 << " ";

193 
doHñpO±
(
löe
, **
ô
, 
∑d_sh‹t
);

195 c⁄° 
	g°rög
& 
	g›t_desc
 = (*
ô
)->
›t
->
›t_desc
;

196 i‡(
	g›t_desc
.
em±y
())

199 
	gcout
 << 
	glöe
.
°r
(Ë<< 
	gídl
;

202 
size_t
 
	gcuºÀngth
 = size_t(
löe
.
ãŒp
());

203 i‡(
	gcuºÀngth
 > 
	g›t_width
)

207 
	glöe
 << 
	gídl
;

208 
	gcuºÀngth
 = 0;

212 
size_t
 
	g√wlöe_pos
 = 0, 
	gcur_pos
 = 0; cur_po†!
°rög
::
≈os
; 
	gcuºÀngth
 = 0)

215 
löe
 << &(
•a˚s
[40 - 
›t_width
 + 
cuºÀngth
]);

216 
	g√wlöe_pos
 = 
›t_desc
.
föd_fú°_of
('\n', 
√wlöe_pos
);

217 i‡(
	g√wlöe_pos
 !
°rög
::
≈os
)

220 
√wlöe_pos
++;

221 
	glöe
 << 
	g›t_desc
.
sub°r
(
cur_pos
, 
√wlöe_pos
 - cur_pos);

222 
	gcur_pos
 = 
√wlöe_pos
;

225 i‡(
	gcur_pos
 + 
	gdesc_width
 > 
	g›t_desc
.
size
())

228 
	glöe
 << 
	g›t_desc
.
sub°r
(
cur_pos
);

232 
size_t
 
	g•lô_pos
 = 
›t_desc
.
föd_œ°_of
(' ', 
cur_pos
 + 
desc_width
);

233 i‡(
	g•lô_pos
 !
°rög
::
≈os
)

236 
•lô_pos
 = 
›t_desc
.
föd_œ°_nŸ_of
(' ', split_pos) + 1;

240 
boﬁ
 
	gbad_•lô
 = 
•lô_pos
 =
°rög
::
≈os
 || s∂ô_po†<
cur_pos
;

241 i‡(
	gbad_•lô
)

243 
	g•lô_pos
 = 
cur_pos
 + 
desc_width
;

245 
	glöe
 << 
	g›t_desc
.
sub°r
(
cur_pos
, 
•lô_pos
 - cur_pos);

248 i‡(!
	gbad_•lô
)

250 
	g•lô_pos
 = 
›t_desc
.
föd_fú°_nŸ_of
(' ', 
•lô_pos
);

252 
	gcur_pos
 = 
√wlöe_pos
 = 
•lô_pos
;

254 i‡(
	gcur_pos
 >
›t_desc
.
size
())

258 
	glöe
 << 
	gídl
;

261 
	gcout
 << 
	glöe
.
°r
(Ë<< 
	gídl
;

265 
	sO±i⁄Wrôî


267 
O±i⁄Wrôî
(
O±i⁄s
& 
rO±s
, 
Eº‹Rï‹ãr
& 
îr
)

268 : 
›ts
(
rO±s
), 
îr‹_ªp‹ãr
(
îr
)

270 
	gvútuÆ
 ~
O±i⁄Wrôî
() {}

272 
vútuÆ
 c⁄° 
°rög
 
whîe
() = 0;

274 
boﬁ
 
°‹ePaú
(boﬁ 
Ælow_l⁄g
, boﬁ 
Ælow_sh‹t
, c⁄° 
°rög
& 
«me
, c⁄° såög& 
vÆue
);

275 
boﬁ
 
°‹ePaú
(c⁄° 
°rög
& 
«me
, c⁄° såög& 
vÆue
)

277  
°‹ePaú
(
åue
,Årue, 
«me
, 
vÆue
);

280 
	gO±i⁄s
& 
	g›ts
;

281 
	gEº‹Rï‹ãr
& 
	gîr‹_ªp‹ãr
;

284 
boﬁ
 
	gO±i⁄Wrôî
::
°‹ePaú
(boﬁ 
Ælow_l⁄g
, boﬁ 
Ælow_sh‹t
, c⁄° 
°rög
& 
«me
, c⁄° såög& 
vÆue
)

286 
boﬁ
 
	gfound
 = 
Ál£
;

287 
	g°d
::
°rög
 
vÆ
 = 
vÆue
;

288 
	gO±i⁄s
::
NamesM≠
::
ôî©‹
 
›t_ô
;

289 i‡(
	gÆlow_l⁄g
)

291 
	g›t_ô
 = 
›ts
.
›t_l⁄g_m≠
.
föd
(
«me
);

292 i‡(
	g›t_ô
 !
›ts
.
›t_l⁄g_m≠
.
íd
())

294 
found
 = 
åue
;

299 i‡(
	gÆlow_sh‹t
 && !(
	gfound
 && 
	gÆlow_l⁄g
))

301 
	g›t_ô
 = 
›ts
.
›t_sh‹t_m≠
.
föd
(
«me
);

302 i‡(
	g›t_ô
 !
›ts
.
›t_sh‹t_m≠
.
íd
())

304 
found
 = 
åue
;

308 
boﬁ
 
	gÆlow_¥efix
 = 
Ælow_l⁄g
;

309 i‡(
	gÆlow_¥efix
 && !
	gfound
)

311 
	g›t_ô
 = 
›ts
.
›t_¥efix_m≠
.
begö
(); o±_ô !›ts.›t_¥efix_m≠.
íd
(); opt_it++)

313 
	g°d
::
°rög
 
«me_¥efix
 = 
«me
.
sub°r
(0, 
›t_ô
->
fú°
.
size
());

314 i‡(
	g«me_¥efix
 =
›t_ô
->
fú°
)

317 
vÆ
 = 
«me
.
sub°r
(
«me_¥efix
.
size
()Ë+ 
°d
::
°rög
(" ") + val;

318 
	gfound
 = 
åue
;

324 i‡(!
	gfound
)

326 
	gîr‹_ªp‹ãr
.
îr‹
(
whîe
())

327 << "Unknow¿›ti⁄ `" << 
	g«me
 << "' (vÆue:`" << 
	gvÆue
 << "')\n";

328  
	gÁl£
;

331 
£tO±i⁄s
((*
›t_ô
).
£c⁄d
, 
vÆ
, 
îr‹_ªp‹ãr
);

332  
	gåue
;

335 
	gArgvP¨£r
 : 
public
 
O±i⁄Wrôî


337 
ArgvP¨£r
(
O±i⁄s
& 
rO±s
, 
Eº‹Rï‹ãr
& 
rEº‹_ªp‹ãr
)

338 : 
O±i⁄Wrôî
(
rO±s
, 
rEº‹_ªp‹ãr
)

341 c⁄° 
°rög
 
whîe
() {  "commandÜine"; }

343 
∑r£GNU
(
¨gc
, c⁄° * 
¨gv
[]);

344 
∑r£SHORT
(
¨gc
, c⁄° * 
¨gv
[]);

350 
	gArgvP¨£r
::
∑r£GNU
(
¨gc
, c⁄° * 
¨gv
[])

356 
°rög
 
¨g
(
¨gv
[0]);

357 
size_t
 
	g¨g_›t_°¨t
 = 
¨g
.
föd_fú°_nŸ_of
('-');

358 
size_t
 
	g¨g_›t_£p
 = 
¨g
.
föd_fú°_of
('=');

359 
°rög
 
	g›ti⁄
 = 
¨g
.
sub°r
(
¨g_›t_°¨t
, 
¨g_›t_£p
 -árg_opt_start);

361 
	gexåa_¨gc_c⁄sumed
 = 0;

362 i‡(
	g¨g_›t_£p
 =
°rög
::
≈os
)

370 i‡(
¨gc
 == 1)

374 
	gexåa_¨gc_c⁄sumed
 = 1;

376 if(!
°‹ePaú
(
åue
, 
Ál£
, 
›ti⁄
, "1"))

384 
°rög
 
	gvÆ
 = 
¨g
.
sub°r
(
¨g_›t_£p
 + 1);

385 
°‹ePaú
(
åue
, 
Ál£
, 
›ti⁄
, 
vÆ
);

388  
	gexåa_¨gc_c⁄sumed
;

391 
	gArgvP¨£r
::
∑r£SHORT
(
¨gc
, c⁄° * 
¨gv
[])

397 
°rög
 
¨g
(
¨gv
[0]);

398 
size_t
 
	g¨g_›t_°¨t
 = 
¨g
.
föd_fú°_nŸ_of
('-');

399 
°rög
 
	g›ti⁄
 = 
¨g
.
sub°r
(
¨g_›t_°¨t
);

404 i‡(
	g¨gc
 == 1)

406 
îr‹_ªp‹ãr
.
îr‹
(
whîe
())

407 << "NŸÖro˚ssög o±i⁄ `" << 
›ti⁄
 << "' withoutárgument\n";

410 
°‹ePaú
(
Ál£
, 
åue
, 
›ti⁄
, 
°rög
(
¨gv
[1]));

415 
	gli°
<const *>

416 
sˇnArgv
(
O±i⁄s
& 
›ts
, 
¨gc
, c⁄° * 
¨gv
[], 
Eº‹Rï‹ãr
& 
îr‹_ªp‹ãr
)

418 
ArgvP¨£r
 
avp
(
›ts
, 
îr‹_ªp‹ãr
);

421 
	gli°
<c⁄° *> 
	gn⁄_›ti⁄_¨gumíts
;

423 
	gi
 = 1; i < 
	g¨gc
; i++)

425 i‡(
	g¨gv
[
i
][0] != '-')

427 
n⁄_›ti⁄_¨gumíts
.
push_back
(
¨gv
[
i
]);

431 i‡(
	g¨gv
[
i
][1] == 0)

434 
n⁄_›ti⁄_¨gumíts
.
push_back
(
¨gv
[
i
]);

438 i‡(
	g¨gv
[
i
][1] != '-')

441 
i
 +
avp
.
∑r£SHORT
(
¨gc
 - i, &
¨gv
[i]);

445 i‡(
	g¨gv
[
i
][2] == 0)

448 ++
i
 < 
¨gc
)

450 
n⁄_›ti⁄_¨gumíts
.
push_back
(
¨gv
[
i
]);

456 
	gi
 +
avp
.
∑r£GNU
(
¨gc
 - 
i
, &
¨gv
[i]);

459  
	gn⁄_›ti⁄_¨gumíts
;

462 
	gCfgSåómP¨£r
 : 
public
 
O±i⁄Wrôî


464 
CfgSåómP¨£r
(c⁄° 
°rög
& 
rName
, 
O±i⁄s
& 
rO±s
, 
Eº‹Rï‹ãr
& 
rEº‹_ªp‹ãr
)

465 : 
O±i⁄Wrôî
(
rO±s
, 
rEº‹_ªp‹ãr
)

466 , 
«me
(
rName
)

467 , 
löíum
(0)

470 c⁄° 
°rög
 
	g«me
;

471 
	glöíum
;

472 c⁄° 
°rög
 
whîe
()

474 
o°rög°ªam
 
	gos
;

475 
	gos
 << 
	g«me
 << ":" << 
	glöíum
;

476  
	gos
.
°r
();

479 
sˇnLöe
(
°rög
& 
löe
);

480 
sˇnSåóm
(
i°ªam
& 
ö
);

483 
	gCfgSåómP¨£r
::
sˇnLöe
(
°rög
& 
löe
)

486 
size_t
 
°¨t
 = 
löe
.
föd_fú°_nŸ_of
(" \t\n\r");

487 i‡(
	g°¨t
 =
°rög
::
≈os
)

492 i‡(
	glöe
[
°¨t
] == '#')

498 
size_t
 
	g›ti⁄_íd
 = 
löe
.
föd_fú°_of
(": \t\n\r",
°¨t
);

499 
°rög
 
	g›ti⁄
 = 
löe
.
sub°r
(
°¨t
, 
›ti⁄_íd
 - start);

502 
	g°¨t
 = 
löe
.
föd_fú°_nŸ_of
(" \t\n\r", 
›ti⁄_íd
);

503 i‡(
	g°¨t
 =
°rög
::
≈os
)

506 
îr‹_ªp‹ãr
.
w¨n
(
whîe
()) << "line formattingÉrror\n";

509 i‡(
	glöe
[
°¨t
] != ':')

512 
îr‹_ªp‹ãr
.
w¨n
(
whîe
()) << "line formattingÉrror\n";

517 
	g°¨t
 = 
löe
.
föd_fú°_nŸ_of
(" \t\n\r", ++
°¨t
);

518 i‡(
	g°¨t
 =
°rög
::
≈os
)

521 
îr‹_ªp‹ãr
.
w¨n
(
whîe
()) << "line formattingÉrror\n";

527 
size_t
 
	gvÆue_íd
 = 
°¨t
;

530 i‡(
	glöe
[
vÆue_íd
] == '#')

533 
vÆue_íd
--;

536 
	gvÆue_íd
 = 
löe
.
föd_fú°_of
(" \t\n\r", 
vÆue_íd
);

539 
	gvÆue_íd
 = 
löe
.
föd_fú°_nŸ_of
(" \t\n\r", 
vÆue_íd
);

540 } 
	gvÆue_íd
 !
°rög
::
≈os
);

542 
	gvÆue_íd
 = 
löe
.
föd_œ°_nŸ_of
(" \t\n\r", 
vÆue_íd
);

544 
°rög
 
	gvÆue
;

545 i‡(
	gvÆue_íd
 >
°¨t
)

547 
vÆue
 = 
löe
.
sub°r
(
°¨t
, 
vÆue_íd
 +1 - start);

552 
	gîr‹_ªp‹ãr
.
w¨n
(
whîe
()) << "no value found\n";

557 
°‹ePaú
(
åue
, 
Ál£
, 
›ti⁄
, 
vÆue
);

560 
	gCfgSåómP¨£r
::
sˇnSåóm
(
i°ªam
& 
ö
)

564 
löíum
++;

565 
°rög
 
	glöe
;

566 
gëlöe
(
ö
, 
löe
);

567 
sˇnLöe
(
löe
);

568 } !!
	gö
);

573 
£tDeÁu…s
(
O±i⁄s
& 
›ts
)

575 
	gO±i⁄s
::
NamesPåLi°
::
ôî©‹
 
ô
 = 
›ts
.
›t_li°
.
begö
(); 
	gô
 !›ts.›t_li°.
íd
(); it++)

577 (*
	gô
)->
	g›t
->
£tDeÁu…
();

581 
∑r£C⁄figFûe
(
O±i⁄s
& 
›ts
, c⁄° 
°rög
& 
fûíame
, 
Eº‹Rï‹ãr
& 
îr‹_ªp‹ãr
)

583 
if°ªam
 
cfg°ªam
(
fûíame
.
c_°r
(), if°ªam::
ö
);

584 i‡(!
	gcfg°ªam
)

586 
	gîr‹_ªp‹ãr
.
îr‹
(
fûíame
) << "FailedÅo open config file\n";

589 
CfgSåómP¨£r
 
c•
(
fûíame
, 
›ts
, 
îr‹_ªp‹ãr
);

590 
	gc•
.
sˇnSåóm
(
cfg°ªam
);

	@Utilities/program_options_lite.h

33 
	~<io°ªam
>

34 
	~<s°ªam
>

35 
	~<°rög
>

36 
	~<li°
>

37 
	~<m≠
>

39 #i‚de‡
__PROGRAM_OPTIONS_LITE__


40 
	#__PROGRAM_OPTIONS_LITE__


	)

46 
«me•a˚
 
	gdf


48 
«me•a˚
 
	g¥ogøm_›ti⁄s_lôe


50 
	gO±i⁄s
;

52 
	gP¨£Faûuª
 : 
public
 
°d
::
ex˚±i⁄


54 
P¨£Faûuª
(
°d
::
°rög
 
¨g0
, std::°rög 
vÆ0
Ë
throw
()

55 : 
¨g
(
¨g0
), 
vÆ
(
vÆ0
)

58 ~
P¨£Faûuª
(Ë
throw
() {};

60 
	g°d
::
°rög
 
¨g
;

61 
	g°d
::
°rög
 
vÆ
;

63 c⁄° * 
wh©
(Ëc⁄° 
throw
() {  "Option Parse Failure"; }

66 
	sEº‹Rï‹ãr


68 
Eº‹Rï‹ãr
(Ë: 
is_îr‹ed
(0) {}

69 
vútuÆ
 ~
Eº‹Rï‹ãr
() {}

70 
vútuÆ
 
°d
::
o°ªam
& 
îr‹
(c⁄° std::
°rög
& 
whîe
);

71 
vútuÆ
 
	g°d
::
o°ªam
& 
w¨n
(c⁄° 
°d
::
°rög
& 
whîe
);

72 
boﬁ
 
	gis_îr‹ed
;

75 
Eº‹Rï‹ãr
 
deÁu…_îr‹_ªp‹ãr
;

77 
doHñp
(
°d
::
o°ªam
& 
out
, 
O±i⁄s
& 
›ts
, 
cﬁumns
 = 80);

78 
	g°d
::
li°
<c⁄° *> 
sˇnArgv
(
O±i⁄s
& 
›ts
, 
¨gc
, c⁄° * 
¨gv
[], 
Eº‹Rï‹ãr
& 
îr‹_ªp‹ãr
 = 
deÁu…_îr‹_ªp‹ãr
);

79 
£tDeÁu…s
(
O±i⁄s
& 
›ts
);

80 
∑r£C⁄figFûe
(
O±i⁄s
& 
›ts
, c⁄° 
°d
::
°rög
& 
fûíame
, 
Eº‹Rï‹ãr
& 
îr‹_ªp‹ãr
 = 
deÁu…_îr‹_ªp‹ãr
);

85 
	sO±i⁄Ba£


87 
O±i⁄Ba£
(c⁄° 
°d
::
°rög
& 
«me
, c⁄° std::°rög& 
desc
)

88 : 
›t_°rög
(
«me
), 
›t_desc
(
desc
)

91 
	gvútuÆ
 ~
O±i⁄Ba£
() {}

94 
vútuÆ
 
∑r£
(c⁄° 
°d
::
°rög
& 
¨g
, 
Eº‹Rï‹ãr
&) = 0;

96 
vútuÆ
 
£tDeÁu…
() = 0;

98 
	g°d
::
°rög
 
›t_°rög
;

99 
	g°d
::
°rög
 
›t_desc
;

103 
	gãm∂©e
<
ty≥«me
 
	gT
>

104 
	gO±i⁄
 : 
public
 
O±i⁄Ba£


106 
O±i⁄
(c⁄° 
°d
::
°rög
& 
«me
, 
T
& 
°‹age
, T 
deÁu…_vÆ
, c⁄° std::°rög& 
desc
)

107 : 
O±i⁄Ba£
(
«me
, 
desc
), 
›t_°‹age
(
°‹age
), 
›t_deÁu…_vÆ
(
deÁu…_vÆ
)

110 
∑r£
(c⁄° 
°d
::
°rög
& 
¨g
, 
Eº‹Rï‹ãr
&);

112 
£tDeÁu…
()

114 
	g›t_°‹age
 = 
›t_deÁu…_vÆ
;

117 
	gT
& 
	g›t_°‹age
;

118 
T
 
	g›t_deÁu…_vÆ
;

122 
	gãm∂©e
<
ty≥«me
 
	gT
>

123 
ölöe
 

124 
	gO±i⁄
<
	gT
>::
∑r£
(c⁄° 
°d
::
°rög
& 
¨g
, 
Eº‹Rï‹ãr
&)

126 
	g°d
::
i°rög°ªam
 
¨g_ss
 (
¨g
,
°d
::i°rög°ªam::
ö
);

127 
	g¨g_ss
.
ex˚±i⁄s
(
°d
::
ios
::
Áûbô
);

128 
	gåy


130 
	g¨g_ss
 >> 
	g›t_°‹age
;

132 
ˇtch
 (...)

134 
throw
 
P¨£Faûuª
(
›t_°rög
, 
¨g
);

140 
	gãm∂©e
<>

141 
ölöe
 

142 
	gO±i⁄
<
	g°d
::
°rög
>::
∑r£
(c⁄° 
°d
::°rög& 
¨g
, 
Eº‹Rï‹ãr
&)

144 
	g›t_°‹age
 = 
¨g
;

148 
	gO±i⁄Func
 : 
public
 
O±i⁄Ba£


150 (
Func
)(
	tO±i⁄s
&, c⁄° 
	t°d
::
	t°rög
&, 
	tEº‹Rï‹ãr
&);

152 
O±i⁄Func
(c⁄° 
°d
::
°rög
& 
«me
, 
O±i⁄s
& 
∑ª¡_
, 
Func
 *
func_
, c⁄° std::°rög& 
desc
)

153 : 
O±i⁄Ba£
(
«me
, 
desc
), 
∑ª¡
(
∑ª¡_
), 
func
(
func_
)

156 
∑r£
(c⁄° 
°d
::
°rög
& 
¨g
, 
Eº‹Rï‹ãr
& 
îr‹_ªp‹ãr
)

158 
func
(
∑ª¡
, 
¨g
, 
îr‹_ªp‹ãr
);

161 
£tDeÁu…
()

166 
	g¥iv©e
:

167 
O±i⁄s
& 
∑ª¡
;

168 
Func
* 
	gfunc
;

171 
˛ass
 
	gO±i⁄S≥cific
;

172 
	sO±i⁄s


174 ~
O±i⁄s
();

176 
O±i⁄S≥cific
 
addO±i⁄s
();

178 
	sNames


180 
Names
(Ë: 
›t
(0) {};

181 ~
Names
()

183 i‡(
	g›t
)

185 
dñëe
 
	g›t
;

188 
	g°d
::
li°
<
°d
::
°rög
> 
›t_l⁄g
;

189 
	g°d
::
li°
<
°d
::
°rög
> 
›t_¥efix
;

190 
	g°d
::
li°
<
°d
::
°rög
> 
›t_sh‹t
;

191 
O±i⁄Ba£
* 
	g›t
;

194 
addO±i⁄
(
O±i⁄Ba£
 *
›t
);

196 
	g°d
::
	tli°
<
	tNames
*> 
	tNamesPåLi°
;

197 
NamesPåLi°
 
	g›t_li°
;

199 
	g°d
::
	tm≠
<
	t°d
::
	t°rög
, 
	tNamesPåLi°
> 
	tNamesM≠
;

200 
NamesM≠
 
	g›t_l⁄g_m≠
;

201 
NamesM≠
 
	g›t_sh‹t_m≠
;

202 
NamesM≠
 
	g›t_¥efix_m≠
;

206 ˛as†
	cO±i⁄S≥cific


208 
	gpublic
:

209 
O±i⁄S≥cific
(
O±i⁄s
& 
∑ª¡_
Ë: 
∑ª¡
(parent_) {}

217 
ãm∂©e
<
ty≥«me
 
T
>

218 
O±i⁄S≥cific
&

219 
›î©‹
()(c⁄° 
°d
::
°rög
& 
«me
, 
	gT
& 
	g°‹age
, 
T
 
	gdeÁu…_vÆ
, c⁄° 
	g°d
::°rög& 
desc
 = "")

221 
∑ª¡
.
addO±i⁄
(
√w
 
O±i⁄
<
T
>(
«me
, 
°‹age
, 
deÁu…_vÆ
, 
desc
));

222  *
	gthis
;

232 
	gO±i⁄S≥cific
&

233 
›î©‹
()(c⁄° 
	g°d
::
°rög
& 
«me
, 
	gO±i⁄Func
::
Func
 *
func
, c⁄° std::°rög& 
desc
 = "")

235 
∑ª¡
.
addO±i⁄
(
√w
 
O±i⁄Func
(
«me
,Ö¨ít, 
func
, 
desc
));

236  *
	gthis
;

238 
	g¥iv©e
:

239 
O±i⁄s
& 
∑ª¡
;

	@libmd5/MD5.h

33 #¥agm®
⁄˚


34 
	~"libmd5.h
"

35 
	~<°rög
>

40 c⁄° 
UI¡
 
	gMD5_DIGEST_STRING_LENGTH
=16;

42 ˛as†
	cMD5


44 
	mpublic
:

48 
	$MD5
()

50 
	`MD5Inô
(&
m_°©e
);

57 
	$upd©e
(*
buf
, 
Àn
)

59 
	`MD5Upd©e
(&
m_°©e
, 
buf
, 
Àn
);

60 
	}
}

65 
	$föÆize
(
dige°
[
MD5_DIGEST_STRING_LENGTH
])

67 
	`MD5FöÆ
(
dige°
, &
m_°©e
);

68 
	}
}

70 
	g¥iv©e
:

71 
c⁄ãxt_md5_t
 
m_°©e
;

	@libmd5/libmd5.cpp

16 
	~<°döt.h
>

17 
	~<°rög.h
>

18 
	~"libmd5.h
"

23 
MD5Tønsf‹m
(
uöt32_t
 
buf
[4], uöt32_àc⁄° 
ö
[16]);

25 #i‚de‡
__BIG_ENDIAN__


26 
	#byãRevî£
(
buf
, 
Àn
Ë

	)

28 
byãRevî£
(
uöt32_t
 *
buf
, 
Àn
);

32 
	$byãRevî£
(
uöt32_t
 *
buf
, 
Àn
)

34 
uöt32_t
 
t
;

36 * 
byãs
 = (*Ë
buf
;

37 
t
 = ((Ë
byãs
[3] << 8 | bytes[2]) << 16 |

38 ((Ë
byãs
[1] << 8 | bytes[0]);

39 *
buf
 = 
t
;

40 
buf
++;

41 } --
Àn
);

42 
	}
}

49 
	$MD5Inô
(
c⁄ãxt_md5_t
 *
˘x
)

51 
˘x
->
buf
[0] = 0x67452301;

52 
˘x
->
buf
[1] = 0xefcdab89;

53 
˘x
->
buf
[2] = 0x98badcfe;

54 
˘x
->
buf
[3] = 0x10325476;

56 
˘x
->
bôs
[0] = 0;

57 
˘x
->
bôs
[1] = 0;

58 
	}
}

64 
	$MD5Upd©e
(
c⁄ãxt_md5_t
 *
˘x
, *
buf
, 
Àn
)

66 
uöt32_t
 
t
;

70 
t
 = 
˘x
->
bôs
[0];

71 i‡((
˘x
->
bôs
[0] = 
t
 + ((
uöt32_t
Ë
Àn
 << 3)) <Å)

72 
˘x
->
bôs
[1]++;

73 
˘x
->
bôs
[1] +
Àn
 >> 29;

75 
t
 = (t >> 3) & 0x3f;

79 i‡(
t
) {

80 *
p
 = 
˘x
->
ö
.
b8
 + 
t
;

82 
t
 = 64 -Å;

83 i‡(
Àn
 < 
t
) {

84 
	`mem˝y
(
p
, 
buf
, 
Àn
);

87 
	`mem˝y
(
p
, 
buf
, 
t
);

88 
	`byãRevî£
(
˘x
->
ö
.
b32
, 16);

89 
	`MD5Tønsf‹m
(
˘x
->
buf
, ctx->
ö
.
b32
);

90 
buf
 +
t
;

91 
Àn
 -
t
;

95 
Àn
 >= 64) {

96 
	`mem˝y
(
˘x
->
ö
.
b8
, 
buf
, 64);

97 
	`byãRevî£
(
˘x
->
ö
.
b32
, 16);

98 
	`MD5Tønsf‹m
(
˘x
->
buf
, ctx->
ö
.
b32
);

99 
buf
 += 64;

100 
Àn
 -= 64;

105 
	`mem˝y
(
˘x
->
ö
.
b8
, 
buf
, 
Àn
);

106 
	}
}

112 
	$MD5FöÆ
(
dige°
[16], 
c⁄ãxt_md5_t
 *
˘x
)

114 
cou¡
;

115 *
p
;

118 
cou¡
 = (
˘x
->
bôs
[0] >> 3) & 0x3F;

122 
p
 = 
˘x
->
ö
.
b8
 + 
cou¡
;

123 *
p
++ = 0x80;

126 
cou¡
 = 64 - 1 - count;

129 i‡(
cou¡
 < 8) {

131 
	`mem£t
(
p
, 0, 
cou¡
);

132 
	`byãRevî£
(
˘x
->
ö
.
b32
, 16);

133 
	`MD5Tønsf‹m
(
˘x
->
buf
, ctx->
ö
.
b32
);

136 
	`mem£t
(
˘x
->
ö
.
b8
, 0, 56);

139 
	`mem£t
(
p
, 0, 
cou¡
 - 8);

141 
	`byãRevî£
(
˘x
->
ö
.
b32
, 14);

144 
˘x
->
ö
.
b32
[14] = ctx->
bôs
[0];

145 
˘x
->
ö
.
b32
[15] = ctx->
bôs
[1];

147 
	`MD5Tønsf‹m
(
˘x
->
buf
, ctx->
ö
.
b32
);

148 
	`byãRevî£
((
uöt32_t
 *Ë
˘x
->
buf
, 4);

149 
	`mem˝y
(
dige°
, 
˘x
->
buf
, 16);

151 
	`mem£t
(
˘x
, 0, (* ctx));

156 
	}
}

161 
	#F1
(
x
, 
y
, 
z
Ë(z ^ (x & (y ^ z)))

	)

162 
	#F2
(
x
, 
y
, 
z
Ë
	`F1
(z, x, y)

	)

163 
	#F3
(
x
, 
y
, 
z
Ë(x ^ y ^ z)

	)

164 
	#F4
(
x
, 
y
, 
z
Ë(y ^ (x | ~z))

	)

167 
	#MD5STEP
(
f
, 
w
, 
x
, 
y
, 
z
, 
d©a
, 
s
) \

168 –
w
 +
	`f
(
x
, 
y
, 
z
Ë+ 
d©a
, w = w<<
s
 | w>>(32-s), w +x )

	)

175 
	$MD5Tønsf‹m
(
uöt32_t
 
buf
[4], uöt32_àc⁄° 
ö
[16])

177 
uöt32_t
 
a
, 
b
, 
c
, 
d
;

179 
a
 = 
buf
[0];

180 
b
 = 
buf
[1];

181 
c
 = 
buf
[2];

182 
d
 = 
buf
[3];

184 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
ö
[0] + 0xd76aa478, 7);

185 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
ö
[1] + 0xe8c7b756, 12);

186 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
ö
[2] + 0x242070db, 17);

187 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
ö
[3] + 0xc1bdceee, 22);

188 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
ö
[4] + 0xf57c0faf, 7);

189 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
ö
[5] + 0x4787c62a, 12);

190 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
ö
[6] + 0xa8304613, 17);

191 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
ö
[7] + 0xfd469501, 22);

192 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
ö
[8] + 0x698098d8, 7);

193 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
ö
[9] + 0x8b44f7af, 12);

194 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
ö
[10] + 0xffff5bb1, 17);

195 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
ö
[11] + 0x895cd7be, 22);

196 
	`MD5STEP
(
F1
, 
a
, 
b
, 
c
, 
d
, 
ö
[12] + 0x6b901122, 7);

197 
	`MD5STEP
(
F1
, 
d
, 
a
, 
b
, 
c
, 
ö
[13] + 0xfd987193, 12);

198 
	`MD5STEP
(
F1
, 
c
, 
d
, 
a
, 
b
, 
ö
[14] + 0xa679438e, 17);

199 
	`MD5STEP
(
F1
, 
b
, 
c
, 
d
, 
a
, 
ö
[15] + 0x49b40821, 22);

201 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
ö
[1] + 0xf61e2562, 5);

202 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
ö
[6] + 0xc040b340, 9);

203 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
ö
[11] + 0x265e5a51, 14);

204 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
ö
[0] + 0xe9b6c7aa, 20);

205 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
ö
[5] + 0xd62f105d, 5);

206 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
ö
[10] + 0x02441453, 9);

207 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
ö
[15] + 0xd8a1e681, 14);

208 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
ö
[4] + 0xe7d3fbc8, 20);

209 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
ö
[9] + 0x21e1cde6, 5);

210 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
ö
[14] + 0xc33707d6, 9);

211 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
ö
[3] + 0xf4d50d87, 14);

212 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
ö
[8] + 0x455a14ed, 20);

213 
	`MD5STEP
(
F2
, 
a
, 
b
, 
c
, 
d
, 
ö
[13] + 0xa9e3e905, 5);

214 
	`MD5STEP
(
F2
, 
d
, 
a
, 
b
, 
c
, 
ö
[2] + 0xfcefa3f8, 9);

215 
	`MD5STEP
(
F2
, 
c
, 
d
, 
a
, 
b
, 
ö
[7] + 0x676f02d9, 14);

216 
	`MD5STEP
(
F2
, 
b
, 
c
, 
d
, 
a
, 
ö
[12] + 0x8d2a4c8a, 20);

218 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
ö
[5] + 0xfffa3942, 4);

219 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
ö
[8] + 0x8771f681, 11);

220 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
ö
[11] + 0x6d9d6122, 16);

221 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
ö
[14] + 0xfde5380c, 23);

222 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
ö
[1] + 0xa4beea44, 4);

223 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
ö
[4] + 0x4bdecfa9, 11);

224 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
ö
[7] + 0xf6bb4b60, 16);

225 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
ö
[10] + 0xbebfbc70, 23);

226 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
ö
[13] + 0x289b7ec6, 4);

227 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
ö
[0] + 0xeaa127fa, 11);

228 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
ö
[3] + 0xd4ef3085, 16);

229 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
ö
[6] + 0x04881d05, 23);

230 
	`MD5STEP
(
F3
, 
a
, 
b
, 
c
, 
d
, 
ö
[9] + 0xd9d4d039, 4);

231 
	`MD5STEP
(
F3
, 
d
, 
a
, 
b
, 
c
, 
ö
[12] + 0xe6db99e5, 11);

232 
	`MD5STEP
(
F3
, 
c
, 
d
, 
a
, 
b
, 
ö
[15] + 0x1fa27cf8, 16);

233 
	`MD5STEP
(
F3
, 
b
, 
c
, 
d
, 
a
, 
ö
[2] + 0xc4ac5665, 23);

235 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
ö
[0] + 0xf4292244, 6);

236 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
ö
[7] + 0x432aff97, 10);

237 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
ö
[14] + 0xab9423a7, 15);

238 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
ö
[5] + 0xfc93a039, 21);

239 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
ö
[12] + 0x655b59c3, 6);

240 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
ö
[3] + 0x8f0ccc92, 10);

241 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
ö
[10] + 0xffeff47d, 15);

242 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
ö
[1] + 0x85845dd1, 21);

243 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
ö
[8] + 0x6fa87e4f, 6);

244 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
ö
[15] + 0xfe2ce6e0, 10);

245 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
ö
[6] + 0xa3014314, 15);

246 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
ö
[13] + 0x4e0811a1, 21);

247 
	`MD5STEP
(
F4
, 
a
, 
b
, 
c
, 
d
, 
ö
[4] + 0xf7537e82, 6);

248 
	`MD5STEP
(
F4
, 
d
, 
a
, 
b
, 
c
, 
ö
[11] + 0xbd3af235, 10);

249 
	`MD5STEP
(
F4
, 
c
, 
d
, 
a
, 
b
, 
ö
[2] + 0x2ad7d2bb, 15);

250 
	`MD5STEP
(
F4
, 
b
, 
c
, 
d
, 
a
, 
ö
[9] + 0xeb86d391, 21);

252 
buf
[0] +
a
;

253 
buf
[1] +
b
;

254 
buf
[2] +
c
;

255 
buf
[3] +
d
;

256 
	}
}

	@libmd5/libmd5.h

33 #¥agm®
⁄˚


34 
	~<°döt.h
>

39 
	s_c⁄ãxt_md5_t
 {

40 
uöt32_t
 
	mbuf
[4];

41 
uöt32_t
 
	mbôs
[2];

43 
	mb8
[64];

44 
uöt32_t
 
	mb32
[16];

45 } 
	mö
;

46 } 
	tc⁄ãxt_md5_t
;

48 #ifde‡
__˝lu•lus


51 
MD5Inô
(
c⁄ãxt_md5_t
 *
˘x
);

52 
MD5Upd©e
(
c⁄ãxt_md5_t
 *
˘x
, *
buf
, 
Àn
);

53 
MD5FöÆ
(
dige°
[16], 
c⁄ãxt_md5_t
 *
˘x
);

54 #ifde‡
__˝lu•lus


	@/usr/include/assert.h

23 #ifdef 
_ASSERT_H


25 #unde‡
_ASSERT_H


26 #unde‡
as£π


27 #unde‡
__ASSERT_VOID_CAST


29 #ifdef 
__USE_GNU


30 #unde‡
as£π_≥º‹


35 
	#_ASSERT_H
 1

	)

36 
	~<„©uªs.h
>

38 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

39 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

41 
	#__ASSERT_VOID_CAST
 ()

	)

49 #ifdef 
NDEBUG


51 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

59 #ifdef 
__USE_GNU


60 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

65 
__BEGIN_DECLS


68 
	$__as£π_Áû
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
,

69 
__löe
, c⁄° *
__fun˘i⁄
)

70 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

73 
	$__as£π_≥º‹_Áû
 (
__î∫um
, c⁄° *
__fûe
,

74 
__löe
, c⁄° *
__fun˘i⁄
)

75 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

80 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

81 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

84 
__END_DECLS


86 
	#as£π
(
ex¥
) \

87 ((
ex¥
) \

88 ? 
	`__ASSERT_VOID_CAST
 (0) \

89 : 
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

91 #ifdef 
__USE_GNU


92 
	#as£π_≥º‹
(
î∫um
) \

93 (!(
î∫um
) \

94 ? 
	`__ASSERT_VOID_CAST
 (0) \

95 : 
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

103 #i‡
deföed
 
__˝lu•lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

104 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

106 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

107 
	#__ASSERT_FUNCTION
 
__func__


	)

109 
	#__ASSERT_FUNCTION
 ((c⁄° *Ë0)

	)

116 #i‡
deföed
 
__USE_ISOC11
 && !deföed 
__˝lu•lus


118 #unde‡
°©ic_as£π


119 
	#°©ic_as£π
 
_Sètic_as£π


	)

	@/usr/include/fcntl.h

22 #i‚def 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

35 
	~<bôs/f˙é.h
>

39 #ifde‡
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oÊag
) \

41 (((
oÊag
Ë& 
O_CREAT
Ë!0 || ((oÊagË& 
__O_TMPFILE
Ë=__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oÊag
Ë(((oÊagË& 
O_CREAT
Ë!0)

	)

49 #i‚de‡
__mode_t_deföed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_deföed


	)

54 #i‚de‡
__off_t_deföed


55 #i‚de‡
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_deföed


	)

63 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_deföed


	)

68 #i‚de‡
__pid_t_deföed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_deföed


	)

74 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


75 
	#__√ed_time•ec


	)

76 
	~<time.h
>

77 
	~<bôs/°©.h
>

79 
	#S_IFMT
 
__S_IFMT


	)

80 
	#S_IFDIR
 
__S_IFDIR


	)

81 
	#S_IFCHR
 
__S_IFCHR


	)

82 
	#S_IFBLK
 
__S_IFBLK


	)

83 
	#S_IFREG
 
__S_IFREG


	)

84 #ifde‡
__S_IFIFO


85 
	#S_IFIFO
 
__S_IFIFO


	)

87 #ifde‡
__S_IFLNK


88 
	#S_IFLNK
 
__S_IFLNK


	)

90 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
Ë&& deföed 
__S_IFSOCK


91 
	#S_IFSOCK
 
__S_IFSOCK


	)

96 
	#S_ISUID
 
__S_ISUID


	)

97 
	#S_ISGID
 
__S_ISGID


	)

99 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


101 
	#S_ISVTX
 
__S_ISVTX


	)

104 
	#S_IRUSR
 
__S_IREAD


	)

105 
	#S_IWUSR
 
__S_IWRITE


	)

106 
	#S_IXUSR
 
__S_IEXEC


	)

108 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

110 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

111 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

112 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

114 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

116 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

117 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

118 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

120 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

123 #ifdef 
__USE_MISC


124 #i‚de‡
R_OK


127 
	#R_OK
 4

	)

128 
	#W_OK
 2

	)

129 
	#X_OK
 1

	)

130 
	#F_OK
 0

	)

135 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


136 
	#SEEK_SET
 0

	)

137 
	#SEEK_CUR
 1

	)

138 
	#SEEK_END
 2

	)

141 #ifde‡
__USE_ATFILE


142 
	#AT_FDCWD
 -100

	)

145 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

146 
	#AT_REMOVEDIR
 0x200

	)

148 
	#AT_SYMLINK_FOLLOW
 0x400

	)

149 #ifde‡
__USE_GNU


150 
	#AT_NO_AUTOMOUNT
 0x800

	)

152 
	#AT_EMPTY_PATH
 0x1000

	)

154 
	#AT_EACCESS
 0x200

	)

163 
f˙é
 (
__fd
, 
__cmd
, ...);

172 #i‚de‡
__USE_FILE_OFFSET64


173 
	$›í
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

175 #ifde‡
__REDIRECT


176 
	`__REDIRECT
 (
›í
, (c⁄° *
__fûe
, 
__oÊag
, ...), 
›í64
)

177 
	`__n⁄nuŒ
 ((1));

179 
	#›í
 
›í64


	)

182 #ifde‡
__USE_LARGEFILE64


183 
	$›í64
 (c⁄° *
__fûe
, 
__oÊag
, ...Ë
	`__n⁄nuŒ
 ((1));

186 #ifde‡
__USE_ATFILE


196 #i‚de‡
__USE_FILE_OFFSET64


197 
	$›í©
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

198 
	`__n⁄nuŒ
 ((2));

200 #ifde‡
__REDIRECT


201 
	`__REDIRECT
 (
›í©
, (
__fd
, c⁄° *
__fûe
, 
__oÊag
,

202 ...), 
›í©64
Ë
	`__n⁄nuŒ
 ((2));

204 
	#›í©
 
›í©64


	)

207 #ifde‡
__USE_LARGEFILE64


208 
	$›í©64
 (
__fd
, c⁄° *
__fûe
, 
__oÊag
, ...)

209 
	`__n⁄nuŒ
 ((2));

218 #i‚de‡
__USE_FILE_OFFSET64


219 
	$¸ót
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

221 #ifde‡
__REDIRECT


222 
	`__REDIRECT
 (
¸ót
, (c⁄° *
__fûe
, 
mode_t
 
__mode
),

223 
¸ót64
Ë
	`__n⁄nuŒ
 ((1));

225 
	#¸ót
 
¸ót64


	)

228 #ifde‡
__USE_LARGEFILE64


229 
	$¸ót64
 (c⁄° *
__fûe
, 
mode_t
 
__mode
Ë
	`__n⁄nuŒ
 ((1));

232 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

233 && !
deföed
 
__USE_POSIX
))

242 
	#F_ULOCK
 0

	)

243 
	#F_LOCK
 1

	)

244 
	#F_TLOCK
 2

	)

245 
	#F_TEST
 3

	)

247 #i‚de‡
__USE_FILE_OFFSET64


248 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Àn
);

250 #ifde‡
__REDIRECT


251 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

253 
	#lockf
 
lockf64


	)

256 #ifde‡
__USE_LARGEFILE64


257 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Àn
);

261 #ifde‡
__USE_XOPEN2K


264 #i‚de‡
__USE_FILE_OFFSET64


265 
	$posix_Ádvi£
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
,

266 
__advi£
Ë
__THROW
;

268 #ifde‡
__REDIRECT_NTH


269 
	`__REDIRECT_NTH
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

270 
__off64_t
 
__Àn
, 
__advi£
),

271 
posix_Ádvi£64
);

273 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

276 #ifde‡
__USE_LARGEFILE64


277 
	$posix_Ádvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
,

278 
__advi£
Ë
__THROW
;

286 #i‚de‡
__USE_FILE_OFFSET64


287 
	`posix_ÁŒoˇã
 (
__fd
, 
off_t
 
__off£t
, off_à
__Àn
);

289 #ifde‡
__REDIRECT


290 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

291 
__off64_t
 
__Àn
),

292 
posix_ÁŒoˇã64
);

294 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

297 #ifde‡
__USE_LARGEFILE64


298 
	`posix_ÁŒoˇã64
 (
__fd
, 
off64_t
 
__off£t
, off64_à
__Àn
);

304 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
 \

305 && 
deföed
 
__va_¨g_∑ck_Àn


306 
	~<bôs/f˙é2.h
>

309 
__END_DECLS


	@/usr/include/malloc.h

20 #i‚de‡
_MALLOC_H


21 
	#_MALLOC_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<°ddef.h
>

25 
	~<°dio.h
>

26 
	#__mÆloc_±r_t
 *

	)

29 
	#__mÆloc_size_t
 
size_t


	)

30 
	#__mÆloc_±rdiff_t
 
±rdiff_t


	)

32 #ifde‡
__GNUC__


34 
	#__MALLOC_P
(
¨gs
Ë¨g†
__THROW


	)

37 
	#__MALLOC_PMT
(
¨gs
Ë
	)
args

39 #ifde‡
_LIBC


40 
	#__MALLOC_HOOK_VOLATILE


	)

41 
	#__MALLOC_DEPRECATED


	)

43 
	#__MALLOC_HOOK_VOLATILE
 vﬁ©ûe

	)

44 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

49 
	#__MALLOC_P
(
¨gs
Ë
	)
args

50 
	#__MALLOC_PMT
(
¨gs
Ë
	)
args

51 
	#__MALLOC_HOOK_VOLATILE


	)

52 
	#__MALLOC_DEPRECATED
 
__©åibuã_dïªˇãd__


	)

57 
__BEGIN_DECLS


60 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

63 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

64 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

71 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

72 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

75 
	$‰ì
 (*
__±r
Ë
__THROW
;

78 
	$c‰ì
 (*
__±r
Ë
__THROW
;

81 *
	$memÆign
 (
size_t
 
__Æignmít
, size_à
__size
)

82 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

85 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

89 * 
	$pvÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

93 *(*
__m‹ec‹e
Ë(
±rdiff_t
 
__size
);

96 *
	$__deÁu…_m‹ec‹e
 (
±rdiff_t
 
__size
)

97 
__THROW
 
__©åibuã_mÆloc__
;

101 
	smÆlöfo


103 
¨ía
;

104 
‹dblks
;

105 
smblks
;

106 
hblks
;

107 
hblkhd
;

108 
usmblks
;

109 
fsmblks
;

110 
u‹dblks
;

111 
f‹dblks
;

112 
kìpco°
;

116 
mÆlöfo
 
	$mÆlöfo
 (Ë
__THROW
;

119 #i‚de‡
M_MXFAST


120 
	#M_MXFAST
 1

	)

122 #i‚de‡
M_NLBLKS


123 
	#M_NLBLKS
 2

	)

125 #i‚de‡
M_GRAIN


126 
	#M_GRAIN
 3

	)

128 #i‚de‡
M_KEEP


129 
	#M_KEEP
 4

	)

133 
	#M_TRIM_THRESHOLD
 -1

	)

134 
	#M_TOP_PAD
 -2

	)

135 
	#M_MMAP_THRESHOLD
 -3

	)

136 
	#M_MMAP_MAX
 -4

	)

137 
	#M_CHECK_ACTION
 -5

	)

138 
	#M_PERTURB
 -6

	)

139 
	#M_ARENA_TEST
 -7

	)

140 
	#M_ARENA_MAX
 -8

	)

143 
	$mÆl›t
 (
__∑øm
, 
__vÆ
Ë
__THROW
;

147 
	$mÆloc_åim
 (
size_t
 
__∑d
Ë
__THROW
;

151 
size_t
 
	$mÆloc_ußbÀ_size
 (*
__±r
Ë
__THROW
;

154 
	$mÆloc_°©s
 (Ë
__THROW
;

157 
	$mÆloc_öfo
 (
__›ti⁄s
, 
FILE
 *
__Â
Ë
__THROW
;

160 *
	$mÆloc_gë_°©e
 (Ë
__THROW
;

164 
	$mÆloc_£t_°©e
 (*
__±r
Ë
__THROW
;

169 (*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_öôülize_hook
) ()

170 
__MALLOC_DEPRECATED
;

172 (*
__MALLOC_HOOK_VOLATILE
 
__‰ì_hook
Ë(*
__±r
,

173 c⁄° 
__mÆloc_±r_t
)

174 
__MALLOC_DEPRECATED
;

175 *(*
__MALLOC_HOOK_VOLATILE
 
__mÆloc_hook
Ë(
size_t
 
__size
,

176 c⁄° 
__mÆloc_±r_t
)

177 
__MALLOC_DEPRECATED
;

178 *(*
__MALLOC_HOOK_VOLATILE
 
__ªÆloc_hook
Ë(*
__±r
,

179 
size_t
 
__size
,

180 c⁄° 
__mÆloc_±r_t
)

181 
__MALLOC_DEPRECATED
;

182 *(*
__MALLOC_HOOK_VOLATILE
 
__memÆign_hook
Ë(
size_t
 
__Æignmít
,

183 
size_t
 
__size
,

184 c⁄° 
__mÆloc_±r_t
)

185 
__MALLOC_DEPRECATED
;

186 (*
__MALLOC_HOOK_VOLATILE
 
__a·î_m‹ec‹e_hook
) ();

189 
	$__mÆloc_check_öô
 (Ë
__THROW
 
__MALLOC_DEPRECATED
;

192 
__END_DECLS


	@/usr/include/math.h

24 #i‚def 
_MATH_H


25 
	#_MATH_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 
	~<bôs/huge_vÆ.h
>

34 #ifde‡
__USE_ISOC99


35 
	~<bôs/huge_vÆf.h
>

36 
	~<bôs/huge_vÆl.h
>

39 
	~<bôs/öf.h
>

42 
	~<bôs/«n.h
>

46 
	~<bôs/m©hdef.h
>

53 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

54 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

55 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

56 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

57 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

58 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

59 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

60 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

61 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

62 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

63 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

64 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

66 
	#_MdoubÀ_
 

	)

67 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

68 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

69 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

70 
	~<bôs/m©hˇŒs.h
>

71 #unde‡
_MdoubÀ_


72 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


73 #unde‡
_MdoubÀ_END_NAMESPACE


74 #unde‡
__MATH_PRECNAME


76 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


82 #i‚de‡
_MÊﬂt_


83 
	#_MÊﬂt_
 

	)

85 
	#_MdoubÀ_
 
_MÊﬂt_


	)

86 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

87 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

88 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

89 
	~<bôs/m©hˇŒs.h
>

90 #unde‡
_MdoubÀ_


91 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


92 #unde‡
_MdoubÀ_END_NAMESPACE


93 #unde‡
__MATH_PRECNAME


95 #i‡!(
deföed
 
__NO_LONG_DOUBLE_MATH
 && deföed 
_LIBC
) \

96 || 
deföed
 
__LDBL_COMPAT


97 #ifde‡
__LDBL_COMPAT


99 #ifde‡
__USE_ISOC99


100 
	$__∆dbl_√xâow¨df
 (
__x
, 
__y
)

101 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

102 #ifde‡
__REDIRECT_NTH


103 
	`__REDIRECT_NTH
 (
√xâow¨df
, (
__x
, 
__y
),

104 
__∆dbl_√xâow¨df
)

105 
	`__©åibuã__
 ((
__c⁄°__
));

106 
	`__REDIRECT_NTH
 (
√xâow¨d
, (
__x
, 
__y
),

107 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

108 
	`__REDIRECT_NTH
 (
√xâow¨dl
,

109 (
__x
, 
__y
),

110 
√xè·î
Ë
	`__©åibuã__
 ((
__c⁄°__
));

114 #unde‡
__MATHDECL_1


115 
	#__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
Æüs
) \

116 
ty≥
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
), \

117 
¨gs
, 
Æüs
)

	)

118 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

119 
	`__MATHDECL_2
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
	`__CONCAT
(fun˘i⁄,suffix))

	)

125 #i‚de‡
_Ml⁄g_doubÀ_


126 
	#_Ml⁄g_doubÀ_
 

	)

128 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

129 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

130 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

131 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

132 
	#__MATH_DECLARE_LDOUBLE
 1

	)

133 
	~<bôs/m©hˇŒs.h
>

134 #unde‡
_MdoubÀ_


135 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


136 #unde‡
_MdoubÀ_END_NAMESPACE


137 #unde‡
__MATH_PRECNAME


142 #unde‡
__MATHDECL_1


143 #unde‡
__MATHDECL


144 #unde‡
__MATHCALL


147 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


149 
signgam
;

154 #ifde‡
__USE_ISOC99


192 
FP_NAN
 =

193 
	#FP_NAN
 0

	)

194 
FP_NAN
,

195 
FP_INFINITE
 =

196 
	#FP_INFINITE
 1

	)

197 
FP_INFINITE
,

198 
FP_ZERO
 =

199 
	#FP_ZERO
 2

	)

200 
FP_ZERO
,

201 
FP_SUBNORMAL
 =

202 
	#FP_SUBNORMAL
 3

	)

203 
FP_SUBNORMAL
,

204 
FP_NORMAL
 =

205 
	#FP_NORMAL
 4

	)

206 
FP_NORMAL


210 #ifde‡
__NO_LONG_DOUBLE_MATH


211 
	#Â˛assify
(
x
) \

212 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

214 
	#Â˛assify
(
x
) \

215 ( (
x
) ==  () \

216 ? 
	`__Â˛assifyf
 (
x
) \

217 :  (
x
) ==  () \

218 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

222 #ifde‡
__NO_LONG_DOUBLE_MATH


223 
	#signbô
(
x
) \

224 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

226 
	#signbô
(
x
) \

227 ( (
x
) ==  () \

228 ? 
	`__signbôf
 (
x
) \

229 :  (
x
) ==  () \

230 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

234 #ifde‡
__NO_LONG_DOUBLE_MATH


235 
	#isföôe
(
x
) \

236 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

238 
	#isföôe
(
x
) \

239 ( (
x
) ==  () \

240 ? 
	`__föôef
 (
x
) \

241 :  (
x
) ==  () \

242 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

246 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

250 #ifde‡
__NO_LONG_DOUBLE_MATH


251 
	#i¢™
(
x
) \

252 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

254 
	#i¢™
(
x
) \

255 ( (
x
) ==  () \

256 ? 
	`__i¢™f
 (
x
) \

257 :  (
x
) ==  () \

258 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

262 #ifde‡
__NO_LONG_DOUBLE_MATH


263 
	#isöf
(
x
) \

264 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

266 
	#isöf
(
x
) \

267 ( (
x
) ==  () \

268 ? 
	`__isöff
 (
x
) \

269 :  (
x
) ==  () \

270 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

274 
	#MATH_ERRNO
 1

	)

275 
	#MATH_ERREXCEPT
 2

	)

280 #i‚de‡
__FAST_MATH__


281 
	#m©h_îrh™dlög
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

286 #ifdef 
__USE_MISC


290 
_IEEE_
 = -1,

291 
_SVID_
,

292 
_XOPEN_
,

293 
_POSIX_
,

294 
_ISOC_


295 } 
	t_LIB_VERSION_TYPE
;

300 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

304 #ifde‡
__USE_SVID


310 #ifde‡
__˝lu•lus


311 
__ex˚±i⁄


313 
ex˚±i⁄


316 
ty≥
;

317 *
«me
;

318 
¨g1
;

319 
¨g2
;

320 
ªtvÆ
;

321 
	}
};

323 #ifde‡
__˝lu•lus


324 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

326 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

329 
	#X_TLOSS
 1.41484755040568800000e+16

	)

332 
	#DOMAIN
 1

	)

333 
	#SING
 2

	)

334 
	#OVERFLOW
 3

	)

335 
	#UNDERFLOW
 4

	)

336 
	#TLOSS
 5

	)

337 
	#PLOSS
 6

	)

340 
	#HUGE
 3.40282347e+38F

	)

344 #ifde‡
__USE_XOPEN


346 
	#MAXFLOAT
 3.40282347e+38F

	)

353 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


354 
	#M_E
 2.7182818284590452354

	)

355 
	#M_LOG2E
 1.4426950408889634074

	)

356 
	#M_LOG10E
 0.43429448190325182765

	)

357 
	#M_LN2
 0.69314718055994530942

	)

358 
	#M_LN10
 2.30258509299404568402

	)

359 
	#M_PI
 3.14159265358979323846

	)

360 
	#M_PI_2
 1.57079632679489661923

	)

361 
	#M_PI_4
 0.78539816339744830962

	)

362 
	#M_1_PI
 0.31830988618379067154

	)

363 
	#M_2_PI
 0.63661977236758134308

	)

364 
	#M_2_SQRTPI
 1.12837916709551257390

	)

365 
	#M_SQRT2
 1.41421356237309504880

	)

366 
	#M_SQRT1_2
 0.70710678118654752440

	)

372 #ifde‡
__USE_GNU


373 
	#M_El
 2.718281828459045235360287471352662498L

	)

374 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

375 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

376 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

377 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

378 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

379 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

380 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

381 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

382 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

383 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

384 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

385 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

392 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


393 
	#__NO_MATH_INLINES
 1

	)

396 #i‡
deföed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

403 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
(x, y)

	)

404 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
(x, y)

	)

405 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
(x, y)

	)

406 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
(x, y)

	)

407 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
(x, y)

	)

408 
	#isun‹dîed
(
u
, 
v
Ë
	`__buûtö_isun‹dîed
(u, v)

	)

412 #ifde‡
__USE_EXTERN_INLINES


413 
	~<bôs/m©hölöe.h
>

418 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

419 
	~<bôs/m©h-föôe.h
>

422 #ifde‡
__USE_ISOC99


426 #i‚de‡
isgª©î


427 
	#isgª©î
(
x
, 
y
) \

428 (
__exãnsi⁄__
 \

429 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

430 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

434 #i‚de‡
isgª©îequÆ


435 
	#isgª©îequÆ
(
x
, 
y
) \

436 (
__exãnsi⁄__
 \

437 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

438 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

442 #i‚de‡
i¶ess


443 
	#i¶ess
(
x
, 
y
) \

444 (
__exãnsi⁄__
 \

445 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

446 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

450 #i‚de‡
i¶es£quÆ


451 
	#i¶es£quÆ
(
x
, 
y
) \

452 (
__exãnsi⁄__
 \

453 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

454 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

458 #i‚de‡
i¶essgª©î


459 
	#i¶essgª©î
(
x
, 
y
) \

460 (
__exãnsi⁄__
 \

461 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

462 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

466 #i‚de‡
isun‹dîed


467 
	#isun‹dîed
(
u
, 
v
) \

468 (
__exãnsi⁄__
 \

469 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

470 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

475 
	g__END_DECLS


	@/usr/include/memory.h

22 #i‚def 
_MEMORY_H


23 
	#_MEMORY_H
 1

	)

25 
	~<„©uªs.h
>

28 #i‚def 
_STRING_H


29 
	~<°rög.h
>

	@/usr/include/stdint.h

22 #i‚de‡
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<„©uªs.h
>

26 
	~<bôs/wch¨.h
>

27 
	~<bôs/w‹dsize.h
>

34 #i‚de‡
__öt8_t_deföed


35 
	#__öt8_t_deföed


	)

36 sig√d 
	töt8_t
;

37 
	töt16_t
;

38 
	töt32_t
;

39 #i‡
__WORDSIZE
 == 64

40 
	töt64_t
;

42 
__exãnsi⁄__


43 
	töt64_t
;

48 
	tuöt8_t
;

49 
	tuöt16_t
;

50 #i‚de‡
__uöt32_t_deföed


51 
	tuöt32_t
;

52 
	#__uöt32_t_deföed


	)

54 #i‡
__WORDSIZE
 == 64

55 
	tuöt64_t
;

57 
__exãnsi⁄__


58 
	tuöt64_t
;

65 sig√d 
	töt_Àa°8_t
;

66 
	töt_Àa°16_t
;

67 
	töt_Àa°32_t
;

68 #i‡
__WORDSIZE
 == 64

69 
	töt_Àa°64_t
;

71 
__exãnsi⁄__


72 
	töt_Àa°64_t
;

76 
	tuöt_Àa°8_t
;

77 
	tuöt_Àa°16_t
;

78 
	tuöt_Àa°32_t
;

79 #i‡
__WORDSIZE
 == 64

80 
	tuöt_Àa°64_t
;

82 
__exãnsi⁄__


83 
	tuöt_Àa°64_t
;

90 sig√d 
	töt_Á°8_t
;

91 #i‡
__WORDSIZE
 == 64

92 
	töt_Á°16_t
;

93 
	töt_Á°32_t
;

94 
	töt_Á°64_t
;

96 
	töt_Á°16_t
;

97 
	töt_Á°32_t
;

98 
__exãnsi⁄__


99 
	töt_Á°64_t
;

103 
	tuöt_Á°8_t
;

104 #i‡
__WORDSIZE
 == 64

105 
	tuöt_Á°16_t
;

106 
	tuöt_Á°32_t
;

107 
	tuöt_Á°64_t
;

109 
	tuöt_Á°16_t
;

110 
	tuöt_Á°32_t
;

111 
__exãnsi⁄__


112 
	tuöt_Á°64_t
;

117 #i‡
__WORDSIZE
 == 64

118 #i‚de‡
__öçå_t_deföed


119 
	töçå_t
;

120 
	#__öçå_t_deföed


	)

122 
	tuöçå_t
;

124 #i‚de‡
__öçå_t_deföed


125 
	töçå_t
;

126 
	#__öçå_t_deföed


	)

128 
	tuöçå_t
;

133 #i‡
__WORDSIZE
 == 64

134 
	tötmax_t
;

135 
	tuötmax_t
;

137 
__exãnsi⁄__


138 
	tötmax_t
;

139 
__exãnsi⁄__


140 
	tuötmax_t
;

144 #i‡
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
Ë¯## 
L


	)

146 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

148 
	#__INT64_C
(
c
Ë¯## 
LL


	)

149 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #i‡
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #i‡
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #i‡
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #i‡
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #i‡
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #i‡
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 #ifde‡
__WORDSIZE32_SIZE_ULONG


264 
	#SIZE_MAX
 (4294967295UL)

	)

266 
	#SIZE_MAX
 (4294967295U)

	)

271 #i‚de‡
WCHAR_MIN


273 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

274 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

278 
	#WINT_MIN
 (0u)

	)

279 
	#WINT_MAX
 (4294967295u)

	)

283 
	#INT8_C
(
c
Ë
	)
c

284 
	#INT16_C
(
c
Ë
	)
c

285 
	#INT32_C
(
c
Ë
	)
c

286 #i‡
__WORDSIZE
 == 64

287 
	#INT64_C
(
c
Ë¯## 
L


	)

289 
	#INT64_C
(
c
Ë¯## 
LL


	)

293 
	#UINT8_C
(
c
Ë
	)
c

294 
	#UINT16_C
(
c
Ë
	)
c

295 
	#UINT32_C
(
c
Ë¯## 
U


	)

296 #i‡
__WORDSIZE
 == 64

297 
	#UINT64_C
(
c
Ë¯## 
UL


	)

299 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

303 #i‡
__WORDSIZE
 == 64

304 
	#INTMAX_C
(
c
Ë¯## 
L


	)

305 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

307 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

308 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/stdio.h

23 #i‚de‡
_STDIO_H


25 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	~<bôs/ty≥s.h
>

36 
	#__√ed_FILE


	)

37 
	#__√ed___FILE


	)

41 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

51 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

52 || 
deföed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_deföed
 1

	)

58 #unde‡
__√ed_FILE


61 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_deföed
 1

	)

68 #unde‡
__√ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


77 #ifde‡
__GNUC__


78 #i‚de‡
_VA_LIST_DEFINED


79 
_G_va_li°
 
	tva_li°
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<°d¨g.h
>

87 #ifde‡
__USE_XOPEN2K8


88 #i‚de‡
__off_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_deföed


	)

96 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_deföed


	)

101 #i‚de‡
__ssize_t_deföed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_deföed


	)

108 
__BEGIN_NAMESPACE_STD


109 #i‚de‡
__USE_FILE_OFFSET64


110 
_G_Âos_t
 
	tÂos_t
;

112 
_G_Âos64_t
 
	tÂos_t
;

114 
__END_NAMESPACE_STD


115 #ifde‡
__USE_LARGEFILE64


116 
_G_Âos64_t
 
	tÂos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #i‚de‡
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #i‚de‡
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde‡
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


151 
	#P_tmpdú
 "/tmp"

	)

164 
	~<bôs/°dio_lim.h
>

168 
_IO_FILE
 *
°dö
;

169 
_IO_FILE
 *
°dout
;

170 
_IO_FILE
 *
°dîr
;

172 
	#°dö
 
°dö


	)

173 
	#°dout
 
°dout


	)

174 
	#°dîr
 
°dîr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$ªmove
 (c⁄° *
__fûíame
Ë
__THROW
;

180 
	$ª«me
 (c⁄° *
__ﬁd
, c⁄° *
__√w
Ë
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde‡
__USE_ATFILE


185 
	$ª«mót
 (
__ﬁdfd
, c⁄° *
__ﬁd
, 
__√wfd
,

186 c⁄° *
__√w
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #i‚de‡
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfûe
 (Ë
__wur
;

197 #ifde‡
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
Ë
__wur
;

200 
	#tmpfûe
 
tmpfûe64


	)

204 #ifde‡
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfûe64
 (Ë
__wur
;

209 *
	$tm≤am
 (*
__s
Ë
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde‡
__USE_MISC


215 *
	$tm≤am_r
 (*
__s
Ë
__THROW
 
__wur
;

219 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


227 *
	$ãm≤am
 (c⁄° *
__dú
, c⁄° *
__pfx
)

228 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`f˛o£
 (
FILE
 *
__°ªam
);

242 
	`fÊush
 (
FILE
 *
__°ªam
);

243 
__END_NAMESPACE_STD


245 #ifde‡
__USE_MISC


252 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

255 #ifde‡
__USE_GNU


262 
	`f˛o£Æl
 ();

266 
__BEGIN_NAMESPACE_STD


267 #i‚de‡
__USE_FILE_OFFSET64


272 
FILE
 *
	$f›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

273 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

278 
FILE
 *
	$‰e›í
 (c⁄° *
__ª°ri˘
 
__fûíame
,

279 c⁄° *
__ª°ri˘
 
__modes
,

280 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

282 #ifde‡
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
f›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

284 c⁄° *
__ª°ri˘
 
__modes
), 
f›í64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (c⁄° *
__ª°ri˘
 
__fûíame
,

287 c⁄° *
__ª°ri˘
 
__modes
,

288 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
)

289 
__wur
;

291 
	#f›í
 
f›í64


	)

292 
	#‰e›í
 
‰e›í64


	)

295 
__END_NAMESPACE_STD


296 #ifde‡
__USE_LARGEFILE64


297 
FILE
 *
	$f›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

298 c⁄° *
__ª°ri˘
 
__modes
Ë
__wur
;

299 
FILE
 *
	$‰e›í64
 (c⁄° *
__ª°ri˘
 
__fûíame
,

300 c⁄° *
__ª°ri˘
 
__modes
,

301 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fd›í
 (
__fd
, c⁄° *
__modes
Ë
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

313 c⁄° *
__ª°ri˘
 
__modes
,

314 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
 
__wur
;

317 #ifde‡
__USE_XOPEN2K8


319 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, c⁄° *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$›í_mem°ªam
 (**
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

337 
__modes
, 
size_t
 
__n
Ë
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

344 
size_t
 
__size
Ë
__THROW
;

347 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

357 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

362 
	`¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

364 
	$•rötf
 (*
__ª°ri˘
 
__s
,

365 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROWNL
;

371 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

372 
_G_va_li°
 
__¨g
);

377 
	`v¥ötf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

379 
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

380 
_G_va_li°
 
__¨g
Ë
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

387 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

388 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

390 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

391 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

392 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde‡
__USE_GNU


399 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__f
,

400 
_G_va_li°
 
__¨g
)

401 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 0))Ë
__wur
;

402 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

403 c⁄° *
__ª°ri˘
 
__fmt
, ...)

404 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

405 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

406 c⁄° *
__ª°ri˘
 
__fmt
, ...)

407 
__THROWNL
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 2, 3))Ë
__wur
;

410 #ifde‡
__USE_XOPEN2K8


412 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
,

413 
_G_va_li°
 
__¨g
)

414 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

415 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

416 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

426 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

431 
	$sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

433 
	$ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

434 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

436 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

437 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

438 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

439 #ifde‡
__REDIRECT


443 
	`__REDIRECT
 (
fsˇnf
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

444 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

445 
__isoc99_fsˇnf
Ë
__wur
;

446 
	`__REDIRECT
 (
sˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

447 
__isoc99_sˇnf
Ë
__wur
;

448 
	`__REDIRECT_NTH
 (
ssˇnf
, (c⁄° *
__ª°ri˘
 
__s
,

449 c⁄° *
__ª°ri˘
 
__f‹m©
, ...),

450 
__isoc99_ssˇnf
);

452 
	$__isoc99_fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

453 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

454 
	$__isoc99_sˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__wur
;

455 
	$__isoc99_ssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

456 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

457 
	#fsˇnf
 
__isoc99_fsˇnf


	)

458 
	#sˇnf
 
__isoc99_sˇnf


	)

459 
	#ssˇnf
 
__isoc99_ssˇnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__f‹m©
,

472 
_G_va_li°
 
__¨g
)

473 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

479 
	$vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

480 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

483 
	$vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

484 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

485 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

487 #i‡!
deföed
 
__USE_GNU
 \

488 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

489 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

490 #ifde‡
__REDIRECT


494 
	`__REDIRECT
 (
vfsˇnf
,

495 (
FILE
 *
__ª°ri˘
 
__s
,

496 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
),

497 
__isoc99_vfsˇnf
)

498 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 2, 0))Ë
__wur
;

499 
	`__REDIRECT
 (
vsˇnf
, (c⁄° *
__ª°ri˘
 
__f‹m©
,

500 
_G_va_li°
 
__¨g
), 
__isoc99_vsˇnf
)

501 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__sˇnf__
, 1, 0))Ë
__wur
;

502 
	`__REDIRECT_NTH
 (
vssˇnf
,

503 (c⁄° *
__ª°ri˘
 
__s
,

504 c⁄° *
__ª°ri˘
 
__f‹m©
,

505 
_G_va_li°
 
__¨g
), 
__isoc99_vssˇnf
)

506 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

508 
	$__isoc99_vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
,

509 c⁄° *
__ª°ri˘
 
__f‹m©
,

510 
_G_va_li°
 
__¨g
Ë
__wur
;

511 
	$__isoc99_vsˇnf
 (c⁄° *
__ª°ri˘
 
__f‹m©
,

512 
_G_va_li°
 
__¨g
Ë
__wur
;

513 
	$__isoc99_vssˇnf
 (c⁄° *
__ª°ri˘
 
__s
,

514 c⁄° *
__ª°ri˘
 
__f‹m©
,

515 
_G_va_li°
 
__¨g
Ë
__THROW
;

516 
	#vfsˇnf
 
__isoc99_vfsˇnf


	)

517 
	#vsˇnf
 
__isoc99_vsˇnf


	)

518 
	#vssˇnf
 
__isoc99_vssˇnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgëc
 (
FILE
 *
__°ªam
);

532 
	`gëc
 (
FILE
 *
__°ªam
);

538 
	`gëch¨
 ();

539 
__END_NAMESPACE_STD


543 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

545 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


550 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

551 
	`gëch¨_u∆ocked
 ();

554 #ifde‡
__USE_MISC


561 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

565 
__BEGIN_NAMESPACE_STD


573 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

574 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

580 
	`putch¨
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

587 #ifde‡
__USE_MISC


594 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

597 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


602 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

603 
	`putch¨_u∆ocked
 (
__c
);

607 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

608 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

610 
	`gëw
 (
FILE
 *
__°ªam
);

613 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

623 
__wur
;

625 #i‡!
deföed
 
__USE_ISOC11
 \

626 || (
deföed
 
__˝lu•lus
 && __cplusplus <= 201103L)

638 *
	$gës
 (*
__s
Ë
__wur
 
__©åibuã_dïªˇãd__
;

640 
__END_NAMESPACE_STD


642 #ifde‡
__USE_GNU


649 *
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

650 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gëdñim
 (**
__ª°ri˘
 
__löïå
,

666 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

667 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

668 
_IO_ssize_t
 
	$gëdñim
 (**
__ª°ri˘
 
__löïå
,

669 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

670 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

678 
_IO_ssize_t
 
	$gëlöe
 (**
__ª°ri˘
 
__löïå
,

679 
size_t
 *
__ª°ri˘
 
__n
,

680 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`Âuts
 (c⁄° *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

695 
	`puts
 (c⁄° *
__s
);

702 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

709 
size_t
 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

715 
size_t
 
	`fwrôe
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde‡
__USE_GNU


726 
	`Âuts_u∆ocked
 (c⁄° *
__ª°ri˘
 
__s
,

727 
FILE
 *
__ª°ri˘
 
__°ªam
);

730 #ifde‡
__USE_MISC


737 
size_t
 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

739 
size_t
 
	`fwrôe_u∆ocked
 (c⁄° *
__ª°ri˘
 
__±r
, size_à
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

754 
	$·ñl
 (
FILE
 *
__°ªam
Ë
__wur
;

759 
	`ªwöd
 (
FILE
 *
__°ªam
);

760 
__END_NAMESPACE_STD


767 #i‡
deföed
 
__USE_LARGEFILE
 || deföed 
__USE_XOPEN2K


768 #i‚de‡
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

778 
__off_t
 
	$·ñlo
 (
FILE
 *
__°ªam
Ë
__wur
;

780 #ifde‡
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#·ñlo
 
·ñlo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #i‚de‡
__USE_FILE_OFFSET64


798 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

803 
	`f£ços
 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
);

805 #ifde‡
__REDIRECT


806 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

807 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

808 
	`__REDIRECT
 (
f£ços
,

809 (
FILE
 *
__°ªam
, c⁄° 
Âos_t
 *
__pos
), 
f£ços64
);

811 
	#fgëpos
 
fgëpos64


	)

812 
	#f£ços
 
f£ços64


	)

815 
__END_NAMESPACE_STD


817 #ifde‡
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

819 
__off64_t
 
	$·ñlo64
 (
FILE
 *
__°ªam
Ë
__wur
;

820 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

821 
	`f£ços64
 (
FILE
 *
__°ªam
, c⁄° 
Âos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

828 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

830 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde‡
__USE_MISC


835 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

836 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

837 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`≥º‹
 (c⁄° *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bôs/sys_îæi°.h
>

856 #ifdef 
__USE_POSIX


858 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

861 #ifde‡
__USE_MISC


863 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

867 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

868 
deföed
 
__USE_MISC
)

873 
FILE
 *
	$p›í
 (c⁄° *
__comm™d
, c⁄° *
__modes
Ë
__wur
;

879 
	`p˛o£
 (
FILE
 *
__°ªam
);

883 #ifdef 
__USE_POSIX


885 *
	$˘îmid
 (*
__s
Ë
__THROW
;

889 #ifde‡
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob°ack
;

899 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

900 c⁄° *
__ª°ri˘
 
__f‹m©
, ...)

901 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

902 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

903 c⁄° *
__ª°ri˘
 
__f‹m©
,

904 
_G_va_li°
 
__¨gs
)

905 
__THROWNL
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

909 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


913 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

917 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
 
__wur
;

920 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

923 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


927 
	#__√ed_gë›t


	)

928 
	~<gë›t.h
>

933 #ifde‡
__USE_EXTERN_INLINES


934 
	~<bôs/°dio.h
>

936 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


937 
	~<bôs/°dio2.h
>

939 #ifde‡
__LDBL_COMPAT


940 
	~<bôs/°dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__a
;

422 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

423 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

424 
	$î™d48_r
 (
__xsubi
[3],

425 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

426 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

429 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

430 *
__ª°ri˘
 
__ªsu…
)

431 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

432 
	$ƒ™d48_r
 (
__xsubi
[3],

433 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

434 *
__ª°ri˘
 
__ªsu…
)

435 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

439 *
__ª°ri˘
 
__ªsu…
)

440 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

441 
	$jønd48_r
 (
__xsubi
[3],

442 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

443 *
__ª°ri˘
 
__ªsu…
)

444 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

448 
__THROW
 
	`__n⁄nuŒ
 ((2));

450 
	$£ed48_r
 (
__£ed16v
[3],

451 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$lc⁄g48_r
 (
__∑øm
[7],

454 
dønd48_d©a
 *
__buf„r
)

455 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

461 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


462 
	#__mÆloc_™d_ˇŒoc_deföed


	)

463 
__BEGIN_NAMESPACE_STD


465 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

467 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

468 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

469 
__END_NAMESPACE_STD


472 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


473 
__BEGIN_NAMESPACE_STD


479 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

480 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

482 
	$‰ì
 (*
__±r
Ë
__THROW
;

483 
__END_NAMESPACE_STD


485 #ifdef 
__USE_MISC


487 
	$c‰ì
 (*
__±r
Ë
__THROW
;

490 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


491 
	~<Æloˇ.h
>

494 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

495 || 
deföed
 
__USE_BSD


497 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

500 #ifde‡
__USE_XOPEN2K


502 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

503 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

506 #ifde‡
__USE_ISOC11


508 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

509 
__THROW
 
__wur
 
	`__©åibuã__
 ((
__mÆloc__
, 
	`__Æloc_size__
 (2)));

512 
__BEGIN_NAMESPACE_STD


514 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

518 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

520 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


522 #ifde‡
__˝lu•lus


523 "C++" 
	`©_quick_exô
 ((*
__func
) ())

524 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

526 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

529 
__END_NAMESPACE_STD


531 #ifdef 
__USE_MISC


534 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

535 
__THROW
 
	`__n⁄nuŒ
 ((1));

538 
__BEGIN_NAMESPACE_STD


542 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

544 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


548 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

550 
__END_NAMESPACE_STD


552 #ifde‡
__USE_ISOC99


553 
__BEGIN_NAMESPACE_C99


556 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

557 
__END_NAMESPACE_C99


561 
__BEGIN_NAMESPACE_STD


563 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

564 
__END_NAMESPACE_STD


566 #ifde‡
__USE_GNU


569 *
	$£cuª_gëív
 (c⁄° *
__«me
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

573 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


577 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

580 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


583 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

584 
__THROW
 
	`__n⁄nuŒ
 ((2));

587 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

590 #ifdef 
__USE_MISC


594 
	$˛óªnv
 (Ë
__THROW
;

598 #i‡
deföed
 
__USE_MISC
 \

599 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

605 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

609 || 
deföed
 
__USE_XOPEN2K8


618 #i‚de‡
__USE_FILE_OFFSET64


619 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

621 #ifde‡
__REDIRECT


622 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

623 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

625 
	#mk°emp
 
mk°emp64


	)

628 #ifde‡
__USE_LARGEFILE64


629 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_MISC


640 #i‚de‡
__USE_FILE_OFFSET64


641 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

643 #ifde‡
__REDIRECT


644 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

645 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

647 
	#mk°emps
 
mk°emps64


	)

650 #ifde‡
__USE_LARGEFILE64


651 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

652 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

656 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


662 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

665 #ifde‡
__USE_GNU


672 #i‚de‡
__USE_FILE_OFFSET64


673 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

675 #ifde‡
__REDIRECT


676 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

677 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

679 
	#mko°emp
 
mko°emp64


	)

682 #ifde‡
__USE_LARGEFILE64


683 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

692 #i‚de‡
__USE_FILE_OFFSET64


693 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

694 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

696 #ifde‡
__REDIRECT


697 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

698 
__Êags
), 
mko°emps64
)

699 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

701 
	#mko°emps
 
mko°emps64


	)

704 #ifde‡
__USE_LARGEFILE64


705 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

706 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

724 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

727 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


733 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

734 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

739 #i‚de‡
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com∑r_‚_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

747 #ifde‡
__USE_GNU


748 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

755 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

756 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

760 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

761 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

762 #ifde‡
__USE_GNU


763 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

764 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

765 
	`__n⁄nuŒ
 ((1, 4));

770 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

771 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

772 
__END_NAMESPACE_STD


774 #ifde‡
__USE_ISOC99


775 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

776 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

780 
__BEGIN_NAMESPACE_STD


784 
div_t
 
	$div
 (
__numî
, 
__díom
)

785 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

786 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

787 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

788 
__END_NAMESPACE_STD


790 #ifde‡
__USE_ISOC99


791 
__BEGIN_NAMESPACE_C99


792 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

793 
__díom
)

794 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

795 
__END_NAMESPACE_C99


799 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

800 || 
deföed
 
__USE_SVID


807 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

808 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

813 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

814 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

819 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

820 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

823 #ifde‡
__USE_MISC


825 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

826 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

827 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

828 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

829 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

830 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

831 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

837 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

838 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

839 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

840 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

841 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

842 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

844 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

845 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

846 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

847 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

848 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

849 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

850 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

851 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

856 
__BEGIN_NAMESPACE_STD


859 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

862 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

863 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

866 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

870 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

871 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

873 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

874 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

875 
__THROW
;

876 
__END_NAMESPACE_STD


879 #ifde‡
__USE_SVID


884 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

888 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


895 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

896 *c⁄° *
__ª°ri˘
 
__tokís
,

897 **
__ª°ri˘
 
__vÆuï
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

902 #ifde‡
__USE_XOPEN


904 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

910 #ifde‡
__USE_XOPEN2KXSI


912 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

915 #ifde‡
__USE_XOPEN


920 
	$gø¡±
 (
__fd
Ë
__THROW
;

924 
	$u∆ock±
 (
__fd
Ë
__THROW
;

929 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

932 #ifde‡
__USE_GNU


936 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

937 
__THROW
 
	`__n⁄nuŒ
 ((2));

940 
	`gë±
 ();

943 #ifde‡
__USE_BSD


947 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

948 
__THROW
 
	`__n⁄nuŒ
 ((1));

951 
	~<bôs/°dlib-Êﬂt.h
>

954 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


955 
	~<bôs/°dlib.h
>

957 #ifde‡
__LDBL_COMPAT


958 
	~<bôs/°dlib-ldbl.h
>

962 #unde‡
__√ed_mÆloc_™d_ˇŒoc


964 
__END_DECLS


	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

35 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


54 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

65 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

69 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

74 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 #ifde‡
__OPTIMIZE__


78 
__exã∫_Æways_ölöe
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


81  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

84 
__exã∫_Æways_ölöe
 const *

85 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


87  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifde‡
__USE_GNU


100 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

107 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

128 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

129 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

133 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

137 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

141 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

151 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
 
	`__n⁄nuŒ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifde‡
__USE_XOPEN2K8


159 
	~<xloˇÀ.h
>

162 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

163 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

165 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

166 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

169 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

170 || 
deföed
 
__USE_XOPEN2K8


172 *
	$°rdup
 (c⁄° *
__s
)

173 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

179 #i‡
deföed
 
__USE_XOPEN2K8


180 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

181 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

184 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


186 
	#°rdu∑
(
s
) \

187 (
__exãnsi⁄__
 \

189 c⁄° *
__ﬁd
 = (
s
); \

190 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

191 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

192 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

193 
	}
}))

	)

196 
	#°∫du∑
(
s
, 
n
) \

197 (
__exãnsi⁄__
 \

199 c⁄° *
__ﬁd
 = (
s
); \

200 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

201 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

202 
__√w
[
__Àn
] = '\0'; \

203 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

204 }))

	)

207 
	g__BEGIN_NAMESPACE_STD


209 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


212 *
°rchr
 (*
__s
, 
__c
)

213 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

214 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

215 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

217 #ifde‡
__OPTIMIZE__


218 
__exã∫_Æways_ölöe
 *

219 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


221  
__buûtö_°rchr
 (
__s
, 
__c
);

224 
__exã∫_Æways_ölöe
 const *

225 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


227  
__buûtö_°rchr
 (
__s
, 
__c
);

232 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

233 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

236 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


239 *
	`°ºchr
 (*
__s
, 
__c
)

240 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

241 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

242 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

244 #ifde‡
__OPTIMIZE__


245 
__exã∫_Æways_ölöe
 *

246 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


248  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

251 
__exã∫_Æways_ölöe
 const *

252 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


254  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

257 
	}
}

259 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

260 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 
__END_NAMESPACE_STD


264 #ifde‡
__USE_GNU


267 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


268 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

269 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

270 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

271 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

273 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

274 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

278 
__BEGIN_NAMESPACE_STD


281 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

282 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

285 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

288 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


291 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

292 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

293 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

294 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

296 #ifde‡
__OPTIMIZE__


297 
__exã∫_Æways_ölöe
 *

298 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


300  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

303 
__exã∫_Æways_ölöe
 const *

304 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


306  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

309 
	}
}

311 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

312 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

315 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


318 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

319 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

320 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

321 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

323 #ifde‡
__OPTIMIZE__


324 
__exã∫_Æways_ölöe
 *

325 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


327  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

330 
__exã∫_Æways_ölöe
 const *

331 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


333  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

336 
	}
}

338 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

339 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

344 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

345 
__THROW
 
	`__n⁄nuŒ
 ((2));

346 
__END_NAMESPACE_STD


350 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

351 c⁄° *
__ª°ri˘
 
__dñim
,

352 **
__ª°ri˘
 
__ßve_±r
)

353 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

354 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


355 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

360 #ifde‡
__USE_GNU


362 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


363 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

364 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

365 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

366 c⁄° *
__√edÀ
)

367 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

374 #ifde‡
__USE_GNU


378 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

379 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

380 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

384 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

385 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

386 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

387 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

388 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

389 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

393 
__BEGIN_NAMESPACE_STD


395 
size_t
 
	$°æí
 (c⁄° *
__s
)

396 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

397 
__END_NAMESPACE_STD


399 #ifdef 
__USE_XOPEN2K8


402 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

403 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

407 
__BEGIN_NAMESPACE_STD


409 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

410 
__END_NAMESPACE_STD


411 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


419 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


422 #ifde‡
__REDIRECT_NTH


423 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

424 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

425 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

427 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

428 
__THROW
 
	`__n⁄nuŒ
 ((2));

429 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

434 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

435 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

439 #ifde‡
__USE_XOPEN2K8


441 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

447 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

449 #ifde‡
__USE_BSD


451 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

455 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

458 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

459 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

462 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


465 *
	`ödex
 (*
__s
, 
__c
)

466 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

467 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

468 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

470 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


471 
__exã∫_Æways_ölöe
 *

472 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


474  
	`__buûtö_ödex
 (
__s
, 
__c
);

477 
__exã∫_Æways_ölöe
 const *

478 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


480  
	`__buûtö_ödex
 (
__s
, 
__c
);

483 
	}
}

485 *
	$ödex
 (c⁄° *
__s
, 
__c
)

486 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

490 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


493 *
	`rödex
 (*
__s
, 
__c
)

494 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

495 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

496 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

498 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


499 
__exã∫_Æways_ölöe
 *

500 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


502  
	`__buûtö_rödex
 (
__s
, 
__c
);

505 
__exã∫_Æways_ölöe
 const *

506 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


508  
	`__buûtö_rödex
 (
__s
, 
__c
);

511 
	}
}

513 *
	$rödex
 (c⁄° *
__s
, 
__c
)

514 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

519 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

523 #ifdef 
__USE_GNU


524 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

525 #ifde‡
__GNUC__


526 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

527 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

532 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

533 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

536 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

537 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

540 #ifdef 
__USE_GNU


543 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

544 
__loˇÀ_t
 
__loc
)

545 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

547 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

548 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

549 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

552 #ifdef 
__USE_BSD


555 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

556 c⁄° *
__ª°ri˘
 
__dñim
)

557 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

560 #ifdef 
__USE_XOPEN2K8


562 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

565 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

566 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

567 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

572 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

573 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

575 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

576 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

577 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

580 #ifdef 
__USE_GNU


582 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

583 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

586 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

589 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #i‚de‡
ba£«me


596 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


597 "C++" *
	$ba£«me
 (*
__fûíame
)

598 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

599 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

602 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

609 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

610 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


630 
	~<bôs/°rög.h
>

633 
	~<bôs/°rög2.h
>

636 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


638 
	~<bôs/°rög3.h
>

642 
__END_DECLS


	@/usr/include/sys/stat.h

23 #i‚def 
_SYS_STAT_H


24 
	#_SYS_STAT_H
 1

	)

26 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

30 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K
 || deföed 
__USE_MISC
 \

31 || 
deföed
 
	g__USE_ATFILE


32 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


33 
	#__√ed_time_t


	)

35 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ATFILE


36 
	#__√ed_time•ec


	)

38 
	~<time.h
>

41 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K


44 #i‚de‡
__dev_t_deföed


45 
__dev_t
 
	tdev_t
;

46 
	#__dev_t_deföed


	)

49 #i‚de‡
__gid_t_deföed


50 
__gid_t
 
	tgid_t
;

51 
	#__gid_t_deföed


	)

54 #i‚de‡
__öo_t_deföed


55 #i‚de‡
__USE_FILE_OFFSET64


56 
__öo_t
 
	töo_t
;

58 
__öo64_t
 
	töo_t
;

60 
	#__öo_t_deföed


	)

63 #i‚de‡
__mode_t_deföed


64 
__mode_t
 
	tmode_t
;

65 
	#__mode_t_deföed


	)

68 #i‚de‡
__∆ök_t_deföed


69 
__∆ök_t
 
	t∆ök_t
;

70 
	#__∆ök_t_deföed


	)

73 #i‚de‡
__off_t_deföed


74 #i‚de‡
__USE_FILE_OFFSET64


75 
__off_t
 
	toff_t
;

77 
__off64_t
 
	toff_t
;

79 
	#__off_t_deföed


	)

82 #i‚de‡
__uid_t_deföed


83 
__uid_t
 
	tuid_t
;

84 
	#__uid_t_deföed


	)

88 #ifde‡
__USE_UNIX98


89 #i‚de‡
__blk˙t_t_deföed


90 #i‚de‡
__USE_FILE_OFFSET64


91 
__blk˙t_t
 
	tblk˙t_t
;

93 
__blk˙t64_t
 
	tblk˙t_t
;

95 
	#__blk˙t_t_deföed


	)

98 #i‚de‡
__blksize_t_deföed


99 
__blksize_t
 
	tblksize_t
;

100 
	#__blksize_t_deföed


	)

104 
	g__BEGIN_DECLS


106 
	~<bôs/°©.h
>

108 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


109 
	#S_IFMT
 
__S_IFMT


	)

110 
	#S_IFDIR
 
__S_IFDIR


	)

111 
	#S_IFCHR
 
__S_IFCHR


	)

112 
	#S_IFBLK
 
__S_IFBLK


	)

113 
	#S_IFREG
 
__S_IFREG


	)

114 #ifde‡
__S_IFIFO


115 
	#S_IFIFO
 
__S_IFIFO


	)

117 #ifde‡
__S_IFLNK


118 
	#S_IFLNK
 
__S_IFLNK


	)

120 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_UNIX98
) \

121 && 
deföed
 
	g__S_IFSOCK


122 
	#S_IFSOCK
 
__S_IFSOCK


	)

128 
	#__S_ISTYPE
(
mode
, 
mask
Ë(((modeË& 
__S_IFMT
Ë=(mask))

	)

130 
	#S_ISDIR
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

131 
	#S_ISCHR
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

132 
	#S_ISBLK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

133 
	#S_ISREG
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

134 #ifde‡
__S_IFIFO


135 
	#S_ISFIFO
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

137 #ifde‡
__S_IFLNK


138 
	#S_ISLNK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

141 #i‡
deföed
 
__USE_BSD
 && !deföed 
__S_IFLNK


142 
	#S_ISLNK
(
mode
Ë0

	)

145 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K
) \

146 && 
deföed
 
	g__S_IFSOCK


147 
	#S_ISSOCK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

148 #ñi‡
deföed
 
__USE_XOPEN2K


149 
	#S_ISSOCK
(
mode
Ë0

	)

156 #ifdef 
__USE_POSIX199309


157 
	#S_TYPEISMQ
(
buf
Ë
	`__S_TYPEISMQ
(buf)

	)

158 
	#S_TYPEISSEM
(
buf
Ë
	`__S_TYPEISSEM
(buf)

	)

159 
	#S_TYPEISSHM
(
buf
Ë
	`__S_TYPEISSHM
(buf)

	)

165 
	#S_ISUID
 
__S_ISUID


	)

166 
	#S_ISGID
 
__S_ISGID


	)

168 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


170 
	#S_ISVTX
 
__S_ISVTX


	)

173 
	#S_IRUSR
 
__S_IREAD


	)

174 
	#S_IWUSR
 
__S_IWRITE


	)

175 
	#S_IXUSR
 
__S_IEXEC


	)

177 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

179 #i‡
deföed
 
__USE_MISC
 && deföed 
__USE_BSD


180 
	#S_IREAD
 
S_IRUSR


	)

181 
	#S_IWRITE
 
S_IWUSR


	)

182 
	#S_IEXEC
 
S_IXUSR


	)

185 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

186 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

187 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

189 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

191 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

192 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

193 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

195 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

198 #ifdef 
__USE_BSD


200 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
Ë

	)

201 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

202 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

204 
	#S_BLKSIZE
 512

	)

208 #i‚de‡
__USE_FILE_OFFSET64


210 
	$°©
 (c⁄° *
__ª°ri˘
 
__fûe
,

211 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

215 
	$f°©
 (
__fd
, 
°©
 *
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

217 #ifde‡
__REDIRECT_NTH


218 
	`__REDIRECT_NTH
 (
°©
, (c⁄° *
__ª°ri˘
 
__fûe
,

219 
°©
 *
__ª°ri˘
 
__buf
), 
°©64
)

220 
	`__n⁄nuŒ
 ((1, 2));

221 
	`__REDIRECT_NTH
 (
f°©
, (
__fd
, 
°©
 *
__buf
), 
f°©64
)

222 
	`__n⁄nuŒ
 ((2));

224 
	#°©
 
°©64


	)

225 
	#f°©
 
f°©64


	)

228 #ifde‡
__USE_LARGEFILE64


229 
	$°©64
 (c⁄° *
__ª°ri˘
 
__fûe
,

230 
°©64
 *
__ª°ri˘
 
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

231 
	$f°©64
 (
__fd
, 
°©64
 *
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

234 #ifde‡
__USE_ATFILE


238 #i‚de‡
__USE_FILE_OFFSET64


239 
	$f°©©
 (
__fd
, c⁄° *
__ª°ri˘
 
__fûe
,

240 
°©
 *
__ª°ri˘
 
__buf
, 
__Êag
)

241 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

243 #ifde‡
__REDIRECT_NTH


244 
	`__REDIRECT_NTH
 (
f°©©
, (
__fd
, c⁄° *
__ª°ri˘
 
__fûe
,

245 
°©
 *
__ª°ri˘
 
__buf
,

246 
__Êag
),

247 
f°©©64
Ë
	`__n⁄nuŒ
 ((2, 3));

249 
	#f°©©
 
f°©©64


	)

253 #ifde‡
__USE_LARGEFILE64


254 
	$f°©©64
 (
__fd
, c⁄° *
__ª°ri˘
 
__fûe
,

255 
°©64
 *
__ª°ri˘
 
__buf
, 
__Êag
)

256 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

260 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K


261 #i‚de‡
__USE_FILE_OFFSET64


264 
	$l°©
 (c⁄° *
__ª°ri˘
 
__fûe
,

265 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

267 #ifde‡
__REDIRECT_NTH


268 
	`__REDIRECT_NTH
 (
l°©
,

269 (c⁄° *
__ª°ri˘
 
__fûe
,

270 
°©
 *
__ª°ri˘
 
__buf
), 
l°©64
)

271 
	`__n⁄nuŒ
 ((1, 2));

273 
	#l°©
 
l°©64


	)

276 #ifde‡
__USE_LARGEFILE64


277 
	$l°©64
 (c⁄° *
__ª°ri˘
 
__fûe
,

278 
°©64
 *
__ª°ri˘
 
__buf
)

279 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

285 
	$chmod
 (c⁄° *
__fûe
, 
__mode_t
 
__mode
)

286 
__THROW
 
	`__n⁄nuŒ
 ((1));

288 #ifde‡
__USE_BSD


292 
	$lchmod
 (c⁄° *
__fûe
, 
__mode_t
 
__mode
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

297 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_POSIX


298 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
Ë
__THROW
;

301 #ifde‡
__USE_ATFILE


304 
	$fchmod©
 (
__fd
, c⁄° *
__fûe
, 
__mode_t
 
__mode
,

305 
__Êag
)

306 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

313 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
Ë
__THROW
;

315 #ifdef 
__USE_GNU


318 
__mode_t
 
	$gëumask
 (Ë
__THROW
;

322 
	$mkdú
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
)

323 
__THROW
 
	`__n⁄nuŒ
 ((1));

325 #ifde‡
__USE_ATFILE


329 
	$mkdú©
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
)

330 
__THROW
 
	`__n⁄nuŒ
 ((2));

336 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


337 
	$mknod
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

338 
__THROW
 
	`__n⁄nuŒ
 ((1));

340 #ifde‡
__USE_ATFILE


344 
	$mknod©
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
,

345 
__dev_t
 
__dev
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

351 
	$mkfifo
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
)

352 
__THROW
 
	`__n⁄nuŒ
 ((1));

354 #ifde‡
__USE_ATFILE


358 
	$mkfifﬂt
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
)

359 
__THROW
 
	`__n⁄nuŒ
 ((2));

362 #ifde‡
__USE_ATFILE


365 
	$utimíßt
 (
__fd
, c⁄° *
__∑th
,

366 c⁄° 
time•ec
 
__times
[2],

367 
__Êags
)

368 
__THROW
 
	`__n⁄nuŒ
 ((2));

371 #ifde‡
__USE_XOPEN2K8


373 
	$futimís
 (
__fd
, c⁄° 
time•ec
 
__times
[2]Ë
__THROW
;

391 #i‚de‡
_STAT_VER


392 
	#_STAT_VER
 0

	)

394 #i‚de‡
_MKNOD_VER


395 
	#_MKNOD_VER
 0

	)

399 #i‚de‡
__USE_FILE_OFFSET64


400 
	$__fx°©
 (
__vî
, 
__fûdes
, 
°©
 *
__°©_buf
)

401 
__THROW
 
	`__n⁄nuŒ
 ((3));

402 
	$__x°©
 (
__vî
, c⁄° *
__fûíame
,

403 
°©
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

404 
	$__lx°©
 (
__vî
, c⁄° *
__fûíame
,

405 
°©
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

406 
	$__fx°©©
 (
__vî
, 
__fûdes
, c⁄° *
__fûíame
,

407 
°©
 *
__°©_buf
, 
__Êag
)

408 
__THROW
 
	`__n⁄nuŒ
 ((3, 4));

410 #ifde‡
__REDIRECT_NTH


411 
	`__REDIRECT_NTH
 (
__fx°©
, (
__vî
, 
__fûdes
,

412 
°©
 *
__°©_buf
), 
__fx°©64
)

413 
	`__n⁄nuŒ
 ((3));

414 
	`__REDIRECT_NTH
 (
__x°©
, (
__vî
, c⁄° *
__fûíame
,

415 
°©
 *
__°©_buf
), 
__x°©64
)

416 
	`__n⁄nuŒ
 ((2, 3));

417 
	`__REDIRECT_NTH
 (
__lx°©
, (
__vî
, c⁄° *
__fûíame
,

418 
°©
 *
__°©_buf
), 
__lx°©64
)

419 
	`__n⁄nuŒ
 ((2, 3));

420 
	`__REDIRECT_NTH
 (
__fx°©©
, (
__vî
, 
__fûdes
,

421 c⁄° *
__fûíame
,

422 
°©
 *
__°©_buf
, 
__Êag
),

423 
__fx°©©64
Ë
	`__n⁄nuŒ
 ((3, 4));

426 
	#__fx°©
 
__fx°©64


	)

427 
	#__x°©
 
__x°©64


	)

428 
	#__lx°©
 
__lx°©64


	)

432 #ifde‡
__USE_LARGEFILE64


433 
	$__fx°©64
 (
__vî
, 
__fûdes
, 
°©64
 *
__°©_buf
)

434 
__THROW
 
	`__n⁄nuŒ
 ((3));

435 
	$__x°©64
 (
__vî
, c⁄° *
__fûíame
,

436 
°©64
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

437 
	$__lx°©64
 (
__vî
, c⁄° *
__fûíame
,

438 
°©64
 *
__°©_buf
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

439 
	$__fx°©©64
 (
__vî
, 
__fûdes
, c⁄° *
__fûíame
,

440 
°©64
 *
__°©_buf
, 
__Êag
)

441 
__THROW
 
	`__n⁄nuŒ
 ((3, 4));

443 
	$__xmknod
 (
__vî
, c⁄° *
__∑th
, 
__mode_t
 
__mode
,

444 
__dev_t
 *
__dev
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

446 
	$__xmknod©
 (
__vî
, 
__fd
, c⁄° *
__∑th
,

447 
__mode_t
 
__mode
, 
__dev_t
 *
__dev
)

448 
__THROW
 
	`__n⁄nuŒ
 ((3, 5));

450 #i‡
deföed
 
__GNUC__
 && __GNUC__ >2 && deföed 
__USE_EXTERN_INLINES


453 
__exã∫_ölöe
 

454 
	`__NTH
 (
	$°©
 (c⁄° *
__∑th
, 
°©
 *
__°©buf
))

456  
	`__x°©
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

457 
	}
}

459 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


460 
__exã∫_ölöe
 

461 
__NTH
 (
	$l°©
 (c⁄° *
__∑th
, 
°©
 *
__°©buf
))

463  
	`__lx°©
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

464 
	}
}

467 
__exã∫_ölöe
 

468 
__NTH
 (
	$f°©
 (
__fd
, 
°©
 *
__°©buf
))

470  
	`__fx°©
 (
_STAT_VER
, 
__fd
, 
__°©buf
);

471 
	}
}

473 #ifde‡
__USE_ATFILE


474 
__exã∫_ölöe
 

475 
__NTH
 (
	$f°©©
 (
__fd
, c⁄° *
__fûíame
, 
°©
 *
__°©buf
,

476 
__Êag
))

478  
	`__fx°©©
 (
_STAT_VER
, 
__fd
, 
__fûíame
, 
__°©buf
, 
__Êag
);

479 
	}
}

482 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_BSD


483 
__exã∫_ölöe
 

484 
__NTH
 (
	$mknod
 (c⁄° *
__∑th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
))

486  
	`__xmknod
 (
_MKNOD_VER
, 
__∑th
, 
__mode
, &
__dev
);

487 
	}
}

490 #ifde‡
__USE_ATFILE


491 
__exã∫_ölöe
 

492 
__NTH
 (
	$mknod©
 (
__fd
, c⁄° *
__∑th
, 
__mode_t
 
__mode
,

493 
__dev_t
 
__dev
))

495  
	`__xmknod©
 (
_MKNOD_VER
, 
__fd
, 
__∑th
, 
__mode
, &
__dev
);

496 
	}
}

499 #i‡
deföed
 
__USE_LARGEFILE64
 \

500 && (! 
deföed
 
	g__USE_FILE_OFFSET64
 \

501 || (
deföed
 
	g__REDIRECT_NTH
 && deföed 
	g__OPTIMIZE__
))

502 
__exã∫_ölöe
 

503 
__NTH
 (
	$°©64
 (c⁄° *
__∑th
, 
°©64
 *
__°©buf
))

505  
	`__x°©64
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

506 
	}
}

508 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


509 
__exã∫_ölöe
 

510 
__NTH
 (
	$l°©64
 (c⁄° *
__∑th
, 
°©64
 *
__°©buf
))

512  
	`__lx°©64
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

513 
	}
}

516 
__exã∫_ölöe
 

517 
__NTH
 (
	$f°©64
 (
__fd
, 
°©64
 *
__°©buf
))

519  
	`__fx°©64
 (
_STAT_VER
, 
__fd
, 
__°©buf
);

520 
	}
}

522 #ifde‡
__USE_ATFILE


523 
__exã∫_ölöe
 

524 
__NTH
 (
	$f°©©64
 (
__fd
, c⁄° *
__fûíame
, 
°©64
 *
__°©buf
,

525 
__Êag
))

527  
	`__fx°©©64
 (
_STAT_VER
, 
__fd
, 
__fûíame
, 
__°©buf
, 
__Êag
);

528 
	}
}

535 
	g__END_DECLS


	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/bits/fcntl.h

19 #i‚de‡
_FCNTL_H


23 #ifde‡
__x86_64__


24 
	#__O_LARGEFILE
 0

	)

27 #ifde‡
__x86_64__


29 
	#F_GETLK64
 5

	)

30 
	#F_SETLK64
 6

	)

31 
	#F_SETLKW64
 7

	)

35 
	sÊock


37 
	ml_ty≥
;

38 
	ml_whí˚
;

39 #i‚de‡
__USE_FILE_OFFSET64


40 
__off_t
 
	ml_°¨t
;

41 
__off_t
 
	ml_Àn
;

43 
__off64_t
 
	ml_°¨t
;

44 
__off64_t
 
	ml_Àn
;

46 
__pid_t
 
	ml_pid
;

49 #ifde‡
__USE_LARGEFILE64


50 
	sÊock64


52 
	ml_ty≥
;

53 
	ml_whí˚
;

54 
__off64_t
 
	ml_°¨t
;

55 
__off64_t
 
	ml_Àn
;

56 
__pid_t
 
	ml_pid
;

61 
	~<bôs/f˙é-löux.h
>

	@/usr/include/bits/fcntl2.h

19 #i‚def 
_FCNTL_H


25 #i‚de‡
__USE_FILE_OFFSET64


26 
	$__›í_2
 (c⁄° *
__∑th
, 
__oÊag
Ë
	`__n⁄nuŒ
 ((1));

27 
	`__REDIRECT
 (
__›í_Æüs
, (c⁄° *
__∑th
, 
__oÊag
, ...),

28 
›í
Ë
	`__n⁄nuŒ
 ((1));

30 
	`__REDIRECT
 (
__›í_2
, (c⁄° *
__∑th
, 
__oÊag
),

31 
__›í64_2
Ë
	`__n⁄nuŒ
 ((1));

32 
	`__REDIRECT
 (
__›í_Æüs
, (c⁄° *
__∑th
, 
__oÊag
, ...),

33 
›í64
Ë
	`__n⁄nuŒ
 ((1));

35 
	`__îr‹de˛
 (
__›í_too_m™y_¨gs
,

37 
	`__îr‹de˛
 (
__›í_missög_mode
,

40 
__f‹tify_fun˘i⁄
 

41 
	$›í
 (c⁄° *
__∑th
, 
__oÊag
, ...)

43 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

44 
	`__›í_too_m™y_¨gs
 ();

46 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

48 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

50 
	`__›í_missög_mode
 ();

51  
	`__›í_2
 (
__∑th
, 
__oÊag
);

53  
	`__›í_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

56 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

57  
	`__›í_2
 (
__∑th
, 
__oÊag
);

59  
	`__›í_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

60 
	}
}

63 #ifde‡
__USE_LARGEFILE64


64 
	$__›í64_2
 (c⁄° *
__∑th
, 
__oÊag
Ë
	`__n⁄nuŒ
 ((1));

65 
	`__REDIRECT
 (
__›í64_Æüs
, (c⁄° *
__∑th
, 
__oÊag
,

66 ...), 
›í64
Ë
	`__n⁄nuŒ
 ((1));

67 
	`__îr‹de˛
 (
__›í64_too_m™y_¨gs
,

69 
	`__îr‹de˛
 (
__›í64_missög_mode
,

72 
__f‹tify_fun˘i⁄
 

73 
	$›í64
 (c⁄° *
__∑th
, 
__oÊag
, ...)

75 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

76 
	`__›í64_too_m™y_¨gs
 ();

78 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

80 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

82 
	`__›í64_missög_mode
 ();

83  
	`__›í64_2
 (
__∑th
, 
__oÊag
);

85  
	`__›í64_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

88 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

89  
	`__›í64_2
 (
__∑th
, 
__oÊag
);

91  
	`__›í64_Æüs
 (
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

92 
	}
}

96 #ifde‡
__USE_ATFILE


97 #i‚de‡
__USE_FILE_OFFSET64


98 
	$__›í©_2
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
)

99 
	`__n⁄nuŒ
 ((2));

100 
	`__REDIRECT
 (
__›í©_Æüs
, (
__fd
, c⁄° *
__∑th
,

101 
__oÊag
, ...), 
›í©
)

102 
	`__n⁄nuŒ
 ((2));

104 
	`__REDIRECT
 (
__›í©_2
, (
__fd
, c⁄° *
__∑th
,

105 
__oÊag
), 
__›í©64_2
)

106 
	`__n⁄nuŒ
 ((2));

107 
	`__REDIRECT
 (
__›í©_Æüs
, (
__fd
, c⁄° *
__∑th
,

108 
__oÊag
, ...), 
›í©64
)

109 
	`__n⁄nuŒ
 ((2));

111 
	`__îr‹de˛
 (
__›í©_too_m™y_¨gs
,

113 
	`__îr‹de˛
 (
__›í©_missög_mode
,

116 
__f‹tify_fun˘i⁄
 

117 
	$›í©
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
, ...)

119 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

120 
	`__›í©_too_m™y_¨gs
 ();

122 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

124 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

126 
	`__›í©_missög_mode
 ();

127  
	`__›í©_2
 (
__fd
, 
__∑th
, 
__oÊag
);

129  
	`__›í©_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

132 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

133  
	`__›í©_2
 (
__fd
, 
__∑th
, 
__oÊag
);

135  
	`__›í©_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

136 
	}
}

139 #ifde‡
__USE_LARGEFILE64


140 
	$__›í©64_2
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
)

141 
	`__n⁄nuŒ
 ((2));

142 
	`__REDIRECT
 (
__›í©64_Æüs
, (
__fd
, c⁄° *
__∑th
,

143 
__oÊag
, ...), 
›í©64
)

144 
	`__n⁄nuŒ
 ((2));

145 
	`__îr‹de˛
 (
__›í©64_too_m™y_¨gs
,

147 
	`__îr‹de˛
 (
__›í©64_missög_mode
,

150 
__f‹tify_fun˘i⁄
 

151 
	$›í©64
 (
__fd
, c⁄° *
__∑th
, 
__oÊag
, ...)

153 i‡(
	`__va_¨g_∑ck_Àn
 () > 1)

154 
	`__›í©64_too_m™y_¨gs
 ();

156 i‡(
	`__buûtö_c⁄°™t_p
 (
__oÊag
))

158 i‡(
	`__OPEN_NEEDS_MODE
 (
__oÊag
Ë&& 
	`__va_¨g_∑ck_Àn
 () < 1)

160 
	`__›í©64_missög_mode
 ();

161  
	`__›í©64_2
 (
__fd
, 
__∑th
, 
__oÊag
);

163  
	`__›í©64_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

166 i‡(
	`__va_¨g_∑ck_Àn
 () < 1)

167  
	`__›í©64_2
 (
__fd
, 
__∑th
, 
__oÊag
);

169  
	`__›í©64_Æüs
 (
__fd
, 
__∑th
, 
__oÊag
, 
	`__va_¨g_∑ck
 ());

170 
	}
}

	@/usr/include/bits/huge_val.h

21 #i‚de‡
_MATH_H


27 #i‡
__GNUC_PREREQ
(3,3)

28 
	#HUGE_VAL
 (
	`__buûtö_huge_vÆ
())

	)

29 #ñi‡
__GNUC_PREREQ
(2,96)

30 
	#HUGE_VAL
 (
__exãnsi⁄__
 0x1.0
p2047
)

	)

31 #ñi‡
deföed
 
__GNUC__


33 
	#HUGE_VAL
 \

34 (
__exãnsi⁄__
 \

35 ((uni⁄ { 
__l
 
	`__©åibuã__
((
	`__mode__
(
__DI__
))); 
__d
; }) \

36 { 
__l
: 0x7ff0000000000000ULL }).
__d
)

	)

40 
	~<ídün.h
>

42 uni⁄ { 
	m__c
[8]; 
	m__d
; } 
	t__huge_vÆ_t
;

44 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


45 
	#__HUGE_VAL_byãs
 { 0x7f, 0xf0, 0, 0, 0, 0, 0, 0 }

	)

47 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


48 
	#__HUGE_VAL_byãs
 { 0, 0, 0, 0, 0, 0, 0xf0, 0x7‡}

	)

51 
__huge_vÆ_t
 
	g__huge_vÆ
 = { 
__HUGE_VAL_byãs
 };

52 
	#HUGE_VAL
 (
__huge_vÆ
.
__d
)

	)

	@/usr/include/bits/huge_valf.h

21 #i‚de‡
_MATH_H


27 #i‡
__GNUC_PREREQ
(3,3)

28 
	#HUGE_VALF
 (
	`__buûtö_huge_vÆf
())

	)

29 #ñi‡
__GNUC_PREREQ
(2,96)

30 
	#HUGE_VALF
 (
__exãnsi⁄__
 0x1.0
p255f
)

	)

31 #ñi‡
deföed
 
__GNUC__


33 
	#HUGE_VALF
 \

34 (
__exãnsi⁄__
 \

35 ((uni⁄ { 
__l
 
	`__©åibuã__
((
	`__mode__
(
__SI__
))); 
__d
; }) \

36 { 
__l
: 0x7f800000UL }).
__d
)

	)

40 uni⁄ { 
	m__c
[4]; 
	m__f
; } 
	t__huge_vÆf_t
;

42 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


43 
	#__HUGE_VALF_byãs
 { 0x7f, 0x80, 0, 0 }

	)

45 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


46 
	#__HUGE_VALF_byãs
 { 0, 0, 0x80, 0x7‡}

	)

49 
__huge_vÆf_t
 
	g__huge_vÆf
 = { 
__HUGE_VALF_byãs
 };

50 
	#HUGE_VALF
 (
__huge_vÆf
.
__f
)

	)

	@/usr/include/bits/huge_vall.h

21 #i‚de‡
_MATH_H


25 #i‡
__GNUC_PREREQ
(3,3)

26 
	#HUGE_VALL
 (
	`__buûtö_huge_vÆl
())

	)

27 #ñi‡
__GNUC_PREREQ
(2,96)

28 
	#HUGE_VALL
 (
__exãnsi⁄__
 0x1.0
p32767L
)

	)

31 
	#__HUGE_VALL_byãs
 { 0, 0, 0, 0, 0, 0, 0, 0x80, 0xff, 0x7f, 0, 0 }

	)

33 
	#__huge_vÆl_t
 uni⁄ { 
__c
[12]; 
__ld
; }

	)

34 #ifde‡
__GNUC__


35 
	#HUGE_VALL
 (
__exãnsi⁄__
 \

36 ((
__huge_vÆl_t
Ë{ 
__c
: 
__HUGE_VALL_byãs
 }).
__ld
)

	)

38 
__huge_vÆl_t
 
	g__huge_vÆl
 = { 
__HUGE_VALL_byãs
 };

39 
	#HUGE_VALL
 (
__huge_vÆl
.
__ld
)

	)

	@/usr/include/bits/inf.h

19 #i‚de‡
_MATH_H


25 #i‡
__GNUC_PREREQ
(3,3)

26 
	#INFINITY
 (
	`__buûtö_öff
())

	)

28 
	#INFINITY
 
HUGE_VALF


	)

	@/usr/include/bits/math-finite.h

19 #i‚de‡
_MATH_H


24 
__REDIRECT_NTH
 (
acos
, (), 
__acos_föôe
);

25 
__REDIRECT_NTH
 (
acosf
, (), 
__acosf_föôe
);

26 #ifde‡
__MATH_DECLARE_LDOUBLE


27 #ifde‡
__NO_LONG_DOUBLE_MATH


28 
__REDIRECT_NTH
 (
aco¶
, (), 
__acos_föôe
);

30 
__REDIRECT_NTH
 (
aco¶
, (), 
__aco¶_föôe
);

34 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


36 
__REDIRECT_NTH
 (
acosh
, (), 
__acosh_föôe
);

37 
__REDIRECT_NTH
 (
acoshf
, (), 
__acoshf_föôe
);

38 #ifde‡
__MATH_DECLARE_LDOUBLE


39 #ifde‡
__NO_LONG_DOUBLE_MATH


40 
__REDIRECT_NTH
 (
acoshl
, (), 
__acosh_föôe
);

42 
__REDIRECT_NTH
 (
acoshl
, (), 
__acoshl_föôe
);

48 
__REDIRECT_NTH
 (
asö
, (), 
__asö_föôe
);

49 
__REDIRECT_NTH
 (
asöf
, (), 
__asöf_föôe
);

50 #ifde‡
__MATH_DECLARE_LDOUBLE


51 #ifde‡
__NO_LONG_DOUBLE_MATH


52 
__REDIRECT_NTH
 (
asöl
, (), 
__asö_föôe
);

54 
__REDIRECT_NTH
 (
asöl
, (), 
__asöl_föôe
);

59 
__REDIRECT_NTH
 (
©™2
, (, ), 
__©™2_föôe
);

60 
__REDIRECT_NTH
 (
©™2f
, (, ), 
__©™2f_föôe
);

61 #ifde‡
__MATH_DECLARE_LDOUBLE


62 #ifde‡
__NO_LONG_DOUBLE_MATH


63 
__REDIRECT_NTH
 (
©™2l
, (, ),

64 
__©™2_föôe
);

66 
__REDIRECT_NTH
 (
©™2l
, (, ),

67 
__©™2l_föôe
);

71 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


73 
__REDIRECT_NTH
 (
©™h
, (), 
__©™h_föôe
);

74 
__REDIRECT_NTH
 (
©™hf
, (), 
__©™hf_föôe
);

75 #ifde‡
__MATH_DECLARE_LDOUBLE


76 #ifde‡
__NO_LONG_DOUBLE_MATH


77 
__REDIRECT_NTH
 (
©™hl
, (), 
__©™h_föôe
);

79 
__REDIRECT_NTH
 (
©™hl
, (), 
__©™hl_föôe
);

85 
__REDIRECT_NTH
 (
cosh
, (), 
__cosh_föôe
);

86 
__REDIRECT_NTH
 (
coshf
, (), 
__coshf_föôe
);

87 #ifde‡
__MATH_DECLARE_LDOUBLE


88 #ifde‡
__NO_LONG_DOUBLE_MATH


89 
__REDIRECT_NTH
 (
coshl
, (), 
__cosh_föôe
);

91 
__REDIRECT_NTH
 (
coshl
, (), 
__coshl_föôe
);

96 
__REDIRECT_NTH
 (
exp
, (), 
__exp_föôe
);

97 
__REDIRECT_NTH
 (
expf
, (), 
__expf_föôe
);

98 #ifde‡
__MATH_DECLARE_LDOUBLE


99 #ifde‡
__NO_LONG_DOUBLE_MATH


100 
__REDIRECT_NTH
 (
ex∂
, (), 
__exp_föôe
);

102 
__REDIRECT_NTH
 (
ex∂
, (), 
__ex∂_föôe
);

106 #ifde‡
__USE_GNU


108 
__REDIRECT_NTH
 (
exp10
, (), 
__exp10_föôe
);

109 
__REDIRECT_NTH
 (
exp10f
, (), 
__exp10f_föôe
);

110 #ifde‡
__MATH_DECLARE_LDOUBLE


111 #ifde‡
__NO_LONG_DOUBLE_MATH


112 
__REDIRECT_NTH
 (
exp10l
, (), 
__exp10_föôe
);

114 
__REDIRECT_NTH
 (
exp10l
, (), 
__exp10l_föôe
);

119 
__REDIRECT_NTH
 (
pow10
, (), 
__exp10_föôe
);

120 
__REDIRECT_NTH
 (
pow10f
, (), 
__exp10f_föôe
);

121 #ifde‡
__MATH_DECLARE_LDOUBLE


122 #ifde‡
__NO_LONG_DOUBLE_MATH


123 
__REDIRECT_NTH
 (
pow10l
, (), 
__exp10_föôe
);

125 
__REDIRECT_NTH
 (
pow10l
, (), 
__exp10l_föôe
);

130 #ifde‡
__USE_ISOC99


132 
__REDIRECT_NTH
 (
exp2
, (), 
__exp2_föôe
);

133 
__REDIRECT_NTH
 (
exp2f
, (), 
__exp2f_föôe
);

134 #ifde‡
__MATH_DECLARE_LDOUBLE


135 #ifde‡
__NO_LONG_DOUBLE_MATH


136 
__REDIRECT_NTH
 (
exp2l
, (), 
__exp2_föôe
);

138 
__REDIRECT_NTH
 (
exp2l
, (), 
__exp2l_föôe
);

144 
__REDIRECT_NTH
 (
fmod
, (, ), 
__fmod_föôe
);

145 
__REDIRECT_NTH
 (
fmodf
, (, ), 
__fmodf_föôe
);

146 #ifde‡
__MATH_DECLARE_LDOUBLE


147 #ifde‡
__NO_LONG_DOUBLE_MATH


148 
__REDIRECT_NTH
 (
fmodl
, (, ),

149 
__fmod_föôe
);

151 
__REDIRECT_NTH
 (
fmodl
, (, ),

152 
__fmodl_föôe
);

156 #ifde‡
__USE_ISOC99


158 
__REDIRECT_NTH
 (
hypŸ
, (, ), 
__hypŸ_föôe
);

159 
__REDIRECT_NTH
 (
hypŸf
, (, ), 
__hypŸf_föôe
);

160 #ifde‡
__MATH_DECLARE_LDOUBLE


161 #ifde‡
__NO_LONG_DOUBLE_MATH


162 
__REDIRECT_NTH
 (
hypŸl
, (, ),

163 
__hypŸ_föôe
);

165 
__REDIRECT_NTH
 (
hypŸl
, (, ),

166 
__hypŸl_föôe
);

171 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


173 
__REDIRECT_NTH
 (
j0
, (), 
__j0_föôe
);

174 
__REDIRECT_NTH
 (
j0f
, (), 
__j0f_föôe
);

175 #ifde‡
__MATH_DECLARE_LDOUBLE


176 #ifde‡
__NO_LONG_DOUBLE_MATH


177 
__REDIRECT_NTH
 (
j0l
, (), 
__j0_föôe
);

179 
__REDIRECT_NTH
 (
j0l
, (), 
__j0l_föôe
);

184 
__REDIRECT_NTH
 (
y0
, (), 
__y0_föôe
);

185 
__REDIRECT_NTH
 (
y0f
, (), 
__y0f_föôe
);

186 #ifde‡
__MATH_DECLARE_LDOUBLE


187 #ifde‡
__NO_LONG_DOUBLE_MATH


188 
__REDIRECT_NTH
 (
y0l
, (), 
__y0_föôe
);

190 
__REDIRECT_NTH
 (
y0l
, (), 
__y0l_föôe
);

195 
__REDIRECT_NTH
 (
j1
, (), 
__j1_föôe
);

196 
__REDIRECT_NTH
 (
j1f
, (), 
__j1f_föôe
);

197 #ifde‡
__MATH_DECLARE_LDOUBLE


198 #ifde‡
__NO_LONG_DOUBLE_MATH


199 
__REDIRECT_NTH
 (
j1l
, (), 
__j1_föôe
);

201 
__REDIRECT_NTH
 (
j1l
, (), 
__j1l_föôe
);

206 
__REDIRECT_NTH
 (
y1
, (), 
__y1_föôe
);

207 
__REDIRECT_NTH
 (
y1f
, (), 
__y1f_föôe
);

208 #ifde‡
__MATH_DECLARE_LDOUBLE


209 #ifde‡
__NO_LONG_DOUBLE_MATH


210 
__REDIRECT_NTH
 (
y1l
, (), 
__y1_föôe
);

212 
__REDIRECT_NTH
 (
y1l
, (), 
__y1l_föôe
);

217 
__REDIRECT_NTH
 (
jn
, (, ), 
__jn_föôe
);

218 
__REDIRECT_NTH
 (
jnf
, (, ), 
__jnf_föôe
);

219 #ifde‡
__MATH_DECLARE_LDOUBLE


220 #ifde‡
__NO_LONG_DOUBLE_MATH


221 
__REDIRECT_NTH
 (
j∆
, (, ), 
__jn_föôe
);

223 
__REDIRECT_NTH
 (
j∆
, (, ), 
__j∆_föôe
);

228 
__REDIRECT_NTH
 (
yn
, (, ), 
__yn_föôe
);

229 
__REDIRECT_NTH
 (
ynf
, (, ), 
__ynf_föôe
);

230 #ifde‡
__MATH_DECLARE_LDOUBLE


231 #ifde‡
__NO_LONG_DOUBLE_MATH


232 
__REDIRECT_NTH
 (
y∆
, (, ), 
__yn_föôe
);

234 
__REDIRECT_NTH
 (
y∆
, (, ), 
__y∆_föôe
);

239 #ifde‡
__USE_MISC


241 
__REDIRECT_NTH
 (
lgamma_r
, (, *), 
__lgamma_r_föôe
);

242 
__REDIRECT_NTH
 (
lgammaf_r
, (, *), 
__lgammaf_r_föôe
);

243 #ifde‡
__MATH_DECLARE_LDOUBLE


244 #ifde‡
__NO_LONG_DOUBLE_MATH


245 
__REDIRECT_NTH
 (
lgammÆ_r
, (, *),

246 
__lgamma_r_föôe
);

248 
__REDIRECT_NTH
 (
lgammÆ_r
, (, *),

249 
__lgammÆ_r_föôe
);

254 #i‡((
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99
) \

255 && 
deföed
 
	g__exã∫_Æways_ölöe
)

257 
__exã∫_Æways_ölöe
 
__NTH
 (
	$lgamma
 (
__d
))

259 #ifde‡
__USE_ISOC99


260 
__loˇl_signgam
 = 0;

261  
	`lgamma_r
 (
__d
, &
__loˇl_signgam
);

263  
	`lgamma_r
 (
__d
, &
signgam
);

265 
	}
}

266 
__exã∫_Æways_ölöe
 
__NTH
 (
	$lgammaf
 (
__d
))

268 #ifde‡
__USE_ISOC99


269 
__loˇl_signgam
 = 0;

270  
	`lgammaf_r
 (
__d
, &
__loˇl_signgam
);

272  
	`lgammaf_r
 (
__d
, &
signgam
);

274 
	}
}

275 #ifde‡
__MATH_DECLARE_LDOUBLE


276 
__exã∫_Æways_ölöe
 
__NTH
 (
	$lgammÆ
 (
__d
))

278 #ifde‡
__USE_ISOC99


279 
__loˇl_signgam
 = 0;

280  
	`lgammÆ_r
 (
__d
, &
__loˇl_signgam
);

282  
	`lgammÆ_r
 (
__d
, &
signgam
);

284 
	}
}

288 #i‡((
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
) \

289 && 
deföed
 
	g__exã∫_Æways_ölöe
)

291 
__exã∫_Æways_ölöe
 
__NTH
 (
	$gamma
 (
__d
))

293 #ifde‡
__USE_ISOC99


294 
__loˇl_signgam
 = 0;

295  
	`lgamma_r
 (
__d
, &
__loˇl_signgam
);

297  
	`lgamma_r
 (
__d
, &
signgam
);

299 
	}
}

300 
__exã∫_Æways_ölöe
 
__NTH
 (
	$gammaf
 (
__d
))

302 #ifde‡
__USE_ISOC99


303 
__loˇl_signgam
 = 0;

304  
	`lgammaf_r
 (
__d
, &
__loˇl_signgam
);

306  
	`lgammaf_r
 (
__d
, &
signgam
);

308 
	}
}

309 #ifde‡
__MATH_DECLARE_LDOUBLE


310 
__exã∫_Æways_ölöe
 
__NTH
 (
	$gammÆ
 (
__d
))

312 #ifde‡
__USE_ISOC99


313 
__loˇl_signgam
 = 0;

314  
	`lgammÆ_r
 (
__d
, &
__loˇl_signgam
);

316  
	`lgammÆ_r
 (
__d
, &
signgam
);

318 
	}
}

323 
__REDIRECT_NTH
 (
log
, (), 
__log_föôe
);

324 
__REDIRECT_NTH
 (
logf
, (), 
__logf_föôe
);

325 #ifde‡
__MATH_DECLARE_LDOUBLE


326 #ifde‡
__NO_LONG_DOUBLE_MATH


327 
__REDIRECT_NTH
 (
logl
, (), 
__log_föôe
);

329 
__REDIRECT_NTH
 (
logl
, (), 
__logl_föôe
);

334 
__REDIRECT_NTH
 (
log10
, (), 
__log10_föôe
);

335 
__REDIRECT_NTH
 (
log10f
, (), 
__log10f_föôe
);

336 #ifde‡
__MATH_DECLARE_LDOUBLE


337 #ifde‡
__NO_LONG_DOUBLE_MATH


338 
__REDIRECT_NTH
 (
log10l
, (), 
__log10_föôe
);

340 
__REDIRECT_NTH
 (
log10l
, (), 
__log10l_föôe
);

344 #ifde‡
__USE_ISOC99


346 
__REDIRECT_NTH
 (
log2
, (), 
__log2_föôe
);

347 
__REDIRECT_NTH
 (
log2f
, (), 
__log2f_föôe
);

348 #ifde‡
__MATH_DECLARE_LDOUBLE


349 #ifde‡
__NO_LONG_DOUBLE_MATH


350 
__REDIRECT_NTH
 (
log2l
, (), 
__log2_föôe
);

352 
__REDIRECT_NTH
 (
log2l
, (), 
__log2l_föôe
);

358 
__REDIRECT_NTH
 (
ldexp
, (, ), 
sˇlbn
);

359 
__REDIRECT_NTH
 (
ldexpf
, (, ), 
sˇlbnf
);

360 #ifde‡
__MATH_DECLARE_LDOUBLE


361 
__REDIRECT_NTH
 (
ldex∂
, (, ), 
sˇlb∆
);

365 
__REDIRECT_NTH
 (
pow
, (, ), 
__pow_föôe
);

366 
__REDIRECT_NTH
 (
powf
, (, ), 
__powf_föôe
);

367 #ifde‡
__MATH_DECLARE_LDOUBLE


368 #ifde‡
__NO_LONG_DOUBLE_MATH


369 
__REDIRECT_NTH
 (
powl
, (, ),

370 
__pow_föôe
);

372 
__REDIRECT_NTH
 (
powl
, (, ),

373 
__powl_föôe
);

378 
__REDIRECT_NTH
 (
ªmaödî
, (, ), 
__ªmaödî_föôe
);

379 
__REDIRECT_NTH
 (
ªmaödîf
, (, ), 
__ªmaödîf_föôe
);

380 #ifde‡
__MATH_DECLARE_LDOUBLE


381 #ifde‡
__NO_LONG_DOUBLE_MATH


382 
__REDIRECT_NTH
 (
ªmaödîl
, (, ),

383 
__ªmaödî_föôe
);

385 
__REDIRECT_NTH
 (
ªmaödîl
, (, ),

386 
__ªmaödîl_föôe
);

390 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


392 
__REDIRECT_NTH
 (
sˇlb
, (, ), 
__sˇlb_föôe
);

393 
__REDIRECT_NTH
 (
sˇlbf
, (, ), 
__sˇlbf_föôe
);

394 #ifde‡
__MATH_DECLARE_LDOUBLE


395 #ifde‡
__NO_LONG_DOUBLE_MATH


396 
__REDIRECT_NTH
 (
sˇlbl
, (, ),

397 
__sˇlb_föôe
);

399 
__REDIRECT_NTH
 (
sˇlbl
, (, ),

400 
__sˇlbl_föôe
);

406 
__REDIRECT_NTH
 (
söh
, (), 
__söh_föôe
);

407 
__REDIRECT_NTH
 (
söhf
, (), 
__söhf_föôe
);

408 #ifde‡
__MATH_DECLARE_LDOUBLE


409 #ifde‡
__NO_LONG_DOUBLE_MATH


410 
__REDIRECT_NTH
 (
söhl
, (), 
__söh_föôe
);

412 
__REDIRECT_NTH
 (
söhl
, (), 
__söhl_föôe
);

417 
__REDIRECT_NTH
 (
sqπ
, (), 
__sqπ_föôe
);

418 
__REDIRECT_NTH
 (
sqπf
, (), 
__sqπf_föôe
);

419 #ifde‡
__MATH_DECLARE_LDOUBLE


420 #ifde‡
__NO_LONG_DOUBLE_MATH


421 
__REDIRECT_NTH
 (
sqπl
, (), 
__sqπ_föôe
);

423 
__REDIRECT_NTH
 (
sqπl
, (), 
__sqπl_föôe
);

427 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__exã∫_Æways_ölöe


429 
__gamma_r_föôe
 (, *);

430 
__exã∫_Æways_ölöe
 
__NTH
 (
	$tgamma
 (
__d
))

432 
__loˇl_signgam
 = 0;

433 
__ªs
 = 
	`__gamma_r_föôe
 (
__d
, &
__loˇl_signgam
);

434  
__loˇl_signgam
 < 0 ? -
__ªs
 : __res;

435 
	}
}

436 
__gammaf_r_föôe
 (, *);

437 
__exã∫_Æways_ölöe
 
__NTH
 (
	$tgammaf
 (
__d
))

439 
__loˇl_signgam
 = 0;

440 
__ªs
 = 
	`__gammaf_r_föôe
 (
__d
, &
__loˇl_signgam
);

441  
__loˇl_signgam
 < 0 ? -
__ªs
 : __res;

442 
	}
}

443 #ifde‡
__MATH_DECLARE_LDOUBLE


444 
__gammÆ_r_föôe
 (, *);

445 
__exã∫_Æways_ölöe
 
__NTH
 (
	$tgammÆ
 (
__d
))

447 
__loˇl_signgam
 = 0;

448 #ifde‡
__NO_LONG_DOUBLE_MATH


449 
__ªs
 = 
	`__gamma_r_föôe
 (
__d
, &
__loˇl_signgam
);

451 
__ªs
 = 
	`__gammÆ_r_föôe
 (
__d
, &
__loˇl_signgam
);

453  
__loˇl_signgam
 < 0 ? -
__ªs
 : __res;

454 
	}
}

	@/usr/include/bits/mathcalls.h

45 #i‚de‡
_MATH_H


52 
_MdoubÀ_BEGIN_NAMESPACE


54 
__MATHCALL
 (
acos
,, (
_MdoubÀ_
 
__x
));

56 
__MATHCALL
 (
asö
,, (
_MdoubÀ_
 
__x
));

58 
__MATHCALL
 (
©™
,, (
_MdoubÀ_
 
__x
));

60 
__MATHCALL
 (
©™2
,, (
_MdoubÀ_
 
__y
, _MdoubÀ_ 
__x
));

63 
__MATHCALL
 (
cos
,, (
_MdoubÀ_
 
__x
));

65 
__MATHCALL
 (
sö
,, (
_MdoubÀ_
 
__x
));

67 
__MATHCALL
 (
èn
,, (
_MdoubÀ_
 
__x
));

72 
__MATHCALL
 (
cosh
,, (
_MdoubÀ_
 
__x
));

74 
__MATHCALL
 (
söh
,, (
_MdoubÀ_
 
__x
));

76 
__MATHCALL
 (
ènh
,, (
_MdoubÀ_
 
__x
));

77 
	g_MdoubÀ_END_NAMESPACE


79 #ifde‡
__USE_GNU


81 
__MATHDECL
 (,
söcos
,,

82 (
_MdoubÀ_
 
__x
, _MdoubÀ_ *
__söx
, _MdoubÀ_ *
__cosx
));

85 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


86 
__BEGIN_NAMESPACE_C99


88 
__MATHCALL
 (
acosh
,, (
_MdoubÀ_
 
__x
));

90 
__MATHCALL
 (
asöh
,, (
_MdoubÀ_
 
__x
));

92 
__MATHCALL
 (
©™h
,, (
_MdoubÀ_
 
__x
));

93 
	g__END_NAMESPACE_C99


98 
_MdoubÀ_BEGIN_NAMESPACE


100 
__MATHCALL
 (
exp
,, (
_MdoubÀ_
 
__x
));

103 
__MATHCALL
 (
‰exp
,, (
_MdoubÀ_
 
__x
, *
__exp⁄ít
));

106 
__MATHCALL
 (
ldexp
,, (
_MdoubÀ_
 
__x
, 
__exp⁄ít
));

109 
__MATHCALL
 (
log
,, (
_MdoubÀ_
 
__x
));

112 
__MATHCALL
 (
log10
,, (
_MdoubÀ_
 
__x
));

115 
__MATHCALL
 (
modf
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ *
__ùå
))

116 
__©åibuã__
 ((
__n⁄nuŒ__
 (2)));

117 
	g_MdoubÀ_END_NAMESPACE


119 #ifde‡
__USE_GNU


121 
__MATHCALL
 (
exp10
,, (
_MdoubÀ_
 
__x
));

123 
__MATHCALL
 (
pow10
,, (
_MdoubÀ_
 
__x
));

126 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


127 
__BEGIN_NAMESPACE_C99


129 
__MATHCALL
 (
expm1
,, (
_MdoubÀ_
 
__x
));

132 
__MATHCALL
 (
log1p
,, (
_MdoubÀ_
 
__x
));

135 
__MATHCALL
 (
logb
,, (
_MdoubÀ_
 
__x
));

136 
	g__END_NAMESPACE_C99


139 #ifde‡
__USE_ISOC99


140 
__BEGIN_NAMESPACE_C99


142 
__MATHCALL
 (
exp2
,, (
_MdoubÀ_
 
__x
));

145 
__MATHCALL
 (
log2
,, (
_MdoubÀ_
 
__x
));

146 
	g__END_NAMESPACE_C99


152 
_MdoubÀ_BEGIN_NAMESPACE


154 
__MATHCALL
 (
pow
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

157 
__MATHCALL
 (
sqπ
,, (
_MdoubÀ_
 
__x
));

158 
	g_MdoubÀ_END_NAMESPACE


160 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99


161 
__BEGIN_NAMESPACE_C99


163 
__MATHCALL
 (
hypŸ
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

164 
	g__END_NAMESPACE_C99


167 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


168 
__BEGIN_NAMESPACE_C99


170 
__MATHCALL
 (
cbπ
,, (
_MdoubÀ_
 
__x
));

171 
	g__END_NAMESPACE_C99


177 
_MdoubÀ_BEGIN_NAMESPACE


179 
__MATHCALLX
 (
˚û
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

182 
__MATHCALLX
 (
Ábs
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

185 
__MATHCALLX
 (
Êo‹
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

188 
__MATHCALL
 (
fmod
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

193 
__MATHDECL_1
 (,
__isöf
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

196 
__MATHDECL_1
 (,
__föôe
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

197 
	g_MdoubÀ_END_NAMESPACE


199 #ifde‡
__USE_MISC


202 
__MATHDECL_1
 (,
isöf
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

205 
__MATHDECL_1
 (,
föôe
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

208 
__MATHCALL
 (
dªm
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

212 
__MATHCALL
 (
signifiˇnd
,, (
_MdoubÀ_
 
__x
));

215 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


216 
__BEGIN_NAMESPACE_C99


218 
__MATHCALLX
 (
c›ysign
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

219 
	g__END_NAMESPACE_C99


222 #ifde‡
__USE_ISOC99


223 
__BEGIN_NAMESPACE_C99


225 
__MATHCALLX
 (
«n
,, (c⁄° *
__ègb
), (
__c⁄°__
));

226 
	g__END_NAMESPACE_C99


231 
__MATHDECL_1
 (,
__i¢™
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

233 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


235 
__MATHDECL_1
 (,
i¢™
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

238 
__MATHCALL
 (
j0
,, (
_MdoubÀ_
));

239 
__MATHCALL
 (
j1
,, (
_MdoubÀ_
));

240 
__MATHCALL
 (
jn
,, (, 
_MdoubÀ_
));

241 
__MATHCALL
 (
y0
,, (
_MdoubÀ_
));

242 
__MATHCALL
 (
y1
,, (
_MdoubÀ_
));

243 
__MATHCALL
 (
yn
,, (, 
_MdoubÀ_
));

247 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99


248 
__BEGIN_NAMESPACE_C99


250 
__MATHCALL
 (
îf
,, (
_MdoubÀ_
));

251 
__MATHCALL
 (
îfc
,, (
_MdoubÀ_
));

252 
__MATHCALL
 (
lgamma
,, (
_MdoubÀ_
));

253 
	g__END_NAMESPACE_C99


256 #ifde‡
__USE_ISOC99


257 
__BEGIN_NAMESPACE_C99


259 
__MATHCALL
 (
tgamma
,, (
_MdoubÀ_
));

260 
	g__END_NAMESPACE_C99


263 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


265 
__MATHCALL
 (
gamma
,, (
_MdoubÀ_
));

268 #ifde‡
__USE_MISC


272 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubÀ_
, *
__signgamp
));

276 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


277 
__BEGIN_NAMESPACE_C99


280 
__MATHCALL
 (
röt
,, (
_MdoubÀ_
 
__x
));

283 
__MATHCALLX
 (
√xè·î
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

284 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__LDBL_COMPAT


285 
__MATHCALLX
 (
√xâow¨d
,, (
_MdoubÀ_
 
__x
, 
__y
), (
__c⁄°__
));

289 
__MATHCALL
 (
ªmaödî
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

291 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


293 
__MATHCALL
 (
sˇlbn
,, (
_MdoubÀ_
 
__x
, 
__n
));

297 
__MATHDECL
 (,
ûogb
,, (
_MdoubÀ_
 
__x
));

300 #ifde‡
__USE_ISOC99


302 
__MATHCALL
 (
sˇlb 
,, (
_MdoubÀ_
 
__x
, 
__n
));

306 
__MATHCALL
 (
√¨byöt
,, (
_MdoubÀ_
 
__x
));

310 
__MATHCALLX
 (
round
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

314 
__MATHCALLX
 (
åunc
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

319 
__MATHCALL
 (
ªmquo
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
, *
__quo
));

326 
__MATHDECL
 (,
Ãöt
,, (
_MdoubÀ_
 
__x
));

327 
__MATHDECL
 (,
Œröt
,, (
_MdoubÀ_
 
__x
));

331 
__MATHDECL
 (,
Ãound
,, (
_MdoubÀ_
 
__x
));

332 
__MATHDECL
 (,
Œround
,, (
_MdoubÀ_
 
__x
));

336 
__MATHCALL
 (
fdim
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

339 
__MATHCALLX
 (
fmax
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

342 
__MATHCALLX
 (
fmö
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

346 
__MATHDECL_1
 (, 
__Â˛assify
,, (
_MdoubÀ_
 
__vÆue
))

347 
__©åibuã__
 ((
__c⁄°__
));

350 
__MATHDECL_1
 (, 
__signbô
,, (
_MdoubÀ_
 
__vÆue
))

351 
__©åibuã__
 ((
__c⁄°__
));

355 
__MATHCALL
 (
fma
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
, _MdoubÀ_ 
__z
));

358 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


359 
	g__END_NAMESPACE_C99


362 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


364 
__MATHCALL
 (
sˇlb
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__n
));

	@/usr/include/bits/mathdef.h

18 #i‡!
deföed
 
_MATH_H
 && !deföed 
_COMPLEX_H


22 #i‡
deföed
 
__USE_ISOC99
 && deföed 
_MATH_H
 && !deföed 
_MATH_H_MATHDEF


23 
	#_MATH_H_MATHDEF
 1

	)

25 #i‡
deföed
 
__x86_64__
 || (deföed 
__FLT_EVAL_METHOD__
 && __FLT_EVAL_METHOD__ == 0)

28 
	tÊﬂt_t
;

29 
	tdoubÀ_t
;

35 
	tÊﬂt_t
;

37 
	tdoubÀ_t
;

42 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

43 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

47 #ifde‡
__FP_FAST_FMA


48 
	#FP_FAST_FMA
 1

	)

51 #ifde‡
__FP_FAST_FMAF


52 
	#FP_FAST_FMAF
 1

	)

55 #ifde‡
__FP_FAST_FMAL


56 
	#FP_FAST_FMAL
 1

	)

	@/usr/include/bits/mathinline.h

19 #i‚de‡
_MATH_H


23 #i‚de‡
__exã∫_Æways_ölöe


24 
	#__MATH_INLINE
 
__ölöe


	)

26 
	#__MATH_INLINE
 
__exã∫_Æways_ölöe


	)

30 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__
 && __GNUC__ >= 2

32 #i‡!
__GNUC_PREREQ
 (2,97)

37 #unde‡
isgª©î


38 #unde‡
isgª©îequÆ


39 #unde‡
i¶ess


40 #unde‡
i¶es£quÆ


41 #unde‡
i¶essgª©î


42 #unde‡
isun‹dîed


43 #ifde‡
__i686__


46 
	#isgª©î
(
x
, 
y
) \

47 ({ 
__ªsu…
; \

48 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

49 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

50 
__ªsu…
; })

	)

51 
	#isgª©îequÆ
(
x
, 
y
) \

52 ({ 
__ªsu…
; \

53 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

54 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

55 
__ªsu…
; })

	)

57 
	#i¶ess
(
x
, 
y
) \

58 ({ 
__ªsu…
; \

59 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

60 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st"); \

61 
__ªsu…
; })

	)

63 
	#i¶es£quÆ
(
x
, 
y
) \

64 ({ 
__ªsu…
; \

65 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

66 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st"); \

67 
__ªsu…
; })

	)

69 
	#i¶essgª©î
(
x
, 
y
) \

70 ({ 
__ªsu…
; \

71 
	`__asm__
 ("fucomip %%st(1), %%st; setne %%al" \

72 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

73 
__ªsu…
; })

	)

75 
	#isun‹dîed
(
x
, 
y
) \

76 ({ 
__ªsu…
; \

77 
	`__asm__
 ("fucomip %%st(1), %%st; setp %%al" \

78 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

79 
__ªsu…
; })

	)

82 
	#isgª©î
(
x
, 
y
) \

83 ({ 
__ªsu…
; \

84 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x45, %%ah; setz %%al" \

85 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

86 
__ªsu…
; })

	)

88 
	#isgª©îequÆ
(
x
, 
y
) \

89 ({ 
__ªsu…
; \

90 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x05, %%ah; setz %%al" \

91 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

92 
__ªsu…
; })

	)

94 
	#i¶ess
(
x
, 
y
) \

95 ({ 
__ªsu…
; \

96 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x45, %%ah; setz %%al" \

97 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

98 
__ªsu…
; })

	)

100 
	#i¶es£quÆ
(
x
, 
y
) \

101 ({ 
__ªsu…
; \

102 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x05, %%ah; setz %%al" \

103 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

104 
__ªsu…
; })

	)

106 
	#i¶essgª©î
(
x
, 
y
) \

107 ({ 
__ªsu…
; \

108 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x44, %%ah; setz %%al" \

109 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

110 
__ªsu…
; })

	)

112 
	#isun‹dîed
(
x
, 
y
) \

113 ({ 
__ªsu…
; \

114 
	`__asm__
 ("fucompp; fnstsw; sahf; setp %%al" \

115 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

116 
__ªsu…
; })

	)

122 #i‡
__GNUC_PREREQ
 (2, 8)

123 
__BEGIN_NAMESPACE_C99


126 
__MATH_INLINE
 

127 
__NTH
 (
	$__signbôf
 (
__x
))

129 #ifde‡
__SSE2_MATH__


130 
__m
;

131 
	`__asm
 ("pmovmskb %1, %0" : "Ù" (
__m
Ë: "x" (
__x
));

132  (
__m
 & 0x8) != 0;

134 
__exãnsi⁄__
 uni⁄ { 
__f
; 
__i
; } 
__u
 = { __f: 
__x
 };

135  
__u
.
__i
 < 0;

137 
	}
}

138 
__MATH_INLINE
 

139 
__NTH
 (
	$__signbô
 (
__x
))

141 #ifde‡
__SSE2_MATH__


142 
__m
;

143 
	`__asm
 ("pmovmskb %1, %0" : "Ù" (
__m
Ë: "x" (
__x
));

144  (
__m
 & 0x80) != 0;

146 
__exãnsi⁄__
 uni⁄ { 
__d
; 
__i
[2]; } 
__u
 = { __d: 
__x
 };

147  
__u
.
__i
[1] < 0;

149 
	}
}

150 
__MATH_INLINE
 

151 
__NTH
 (
	$__signbôl
 (
__x
))

153 
__exãnsi⁄__
 uni⁄ { 
__l
; 
__i
[3]; } 
__u
 = { __l: 
__x
 };

154  (
__u
.
__i
[2] & 0x8000) != 0;

155 
	}
}

157 
	g__END_NAMESPACE_C99


164 #i‡
__GNUC_PREREQ
 (2, 8)

165 #i‡!
__GNUC_PREREQ
 (3, 4Ë&& !
deföed
 
__NO_MATH_INLINES
 \

166 && 
deföed
 
	g__OPTIMIZE__


170 #ifde‡
__USE_ISOC99


171 
	g__BEGIN_NAMESPACE_C99


174 #ifde‡
__SSE_MATH__


175 
__MATH_INLINE
 

176 
__NTH
 (
	$Ãötf
 (
__x
))

178 
__ªs
;

183 
__asm
 
	`__vﬁ©ûe__
 ("cvtss2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

184  
__ªs
;

185 
	}
}

187 #ifde‡
__SSE2_MATH__


188 
__MATH_INLINE
 

189 
__NTH
 (
	$Ãöt
 (
__x
))

191 
__ªs
;

196 
__asm
 
	`__vﬁ©ûe__
 ("cvtsd2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

197  
__ªs
;

198 
	}
}

200 #ifde‡
__x86_64__


201 
__MATH_INLINE
 

202 
__NTH
 (
	$Œrötf
 (
__x
))

204 
__ªs
;

209 
__asm
 
	`__vﬁ©ûe__
 ("cvtss2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

210  
__ªs
;

211 
	}
}

212 
__MATH_INLINE
 

213 
__NTH
 (
	$Œröt
 (
__x
))

215 
__ªs
;

220 
__asm
 
	`__vﬁ©ûe__
 ("cvtsd2sò%1, %0" : "Ù" (
__ªs
Ë: "xm" (
__x
));

221  
__ªs
;

222 
	}
}

225 #i‡
deföed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0 \

226 && 
deföed
 
__SSE2_MATH__


228 
__MATH_INLINE
 

229 
__NTH
 (
	$fmaxf
 (
__x
, 
__y
))

231 #ifde‡
__AVX__


232 
__ªs
;

233 
	`__asm
 ("vmaxs†%2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

234  
__ªs
;

236 
	`__asm
 ("maxs†%1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

237  
__x
;

239 
	}
}

240 
__MATH_INLINE
 

241 
__NTH
 (
	$fmax
 (
__x
, 
__y
))

243 #ifde‡
__AVX__


244 
__ªs
;

245 
	`__asm
 ("vmaxsd %2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

246  
__ªs
;

248 
	`__asm
 ("maxsd %1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

249  
__x
;

251 
	}
}

254 
__MATH_INLINE
 

255 
__NTH
 (
	$fmöf
 (
__x
, 
__y
))

257 #ifde‡
__AVX__


258 
__ªs
;

259 
	`__asm
 ("vmös†%2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

260  
__ªs
;

262 
	`__asm
 ("mös†%1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

263  
__x
;

265 
	}
}

266 
__MATH_INLINE
 

267 
__NTH
 (
	$fmö
 (
__x
, 
__y
))

269 #ifde‡
__AVX__


270 
__ªs
;

271 
	`__asm
 ("vmösd %2, %1, %0" : "=x" (
__ªs
Ë: "x" (
x
), "xm" (
__y
));

272  
__ªs
;

274 
	`__asm
 ("mösd %1, %0" : "+x" (
__x
Ë: "xm" (
__y
));

275  
__x
;

277 
	}
}

280 
	g__END_NAMESPACE_C99


283 #i‡
deföed
 
__SSE4_1__
 && deföed 
__SSE2_MATH__


284 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


285 
__BEGIN_NAMESPACE_C99


288 
__MATH_INLINE
 

289 
__NTH
 (
	$röt
 (
__x
))

291 
__ªs
;

296 
__asm
 
	`__vﬁ©ûe__
 ("roundsd $4, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

297  
__ªs
;

298 
	}
}

299 
__MATH_INLINE
 

300 
__NTH
 (
	$rötf
 (
__x
))

302 
__ªs
;

307 
__asm
 
	`__vﬁ©ûe__
 ("rounds†$4, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

308  
__ªs
;

309 
	}
}

311 #ifde‡
__USE_ISOC99


313 
__MATH_INLINE
 

314 
__NTH
 (
	$√¨byöt
 (
__x
))

316 
__ªs
;

321 
__asm
 
	`__vﬁ©ûe__
 ("roundsd $0xc, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

322  
__ªs
;

323 
	}
}

324 
__MATH_INLINE
 

325 
__NTH
 (
	$√¨byötf
 (
__x
))

327 
__ªs
;

332 
__asm
 
	`__vﬁ©ûe__
 ("rounds†$0xc, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

333  
__ªs
;

334 
	}
}

337 
	g__END_NAMESPACE_C99


340 
__BEGIN_NAMESPACE_STD


342 
__MATH_INLINE
 

343 
__NTH
 (
	$˚û
 (
__x
))

345 
__ªs
;

346 
	`__asm
 ("roundsd $2, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

347  
__ªs
;

348 
	}
}

349 
__END_NAMESPACE_STD


351 
__BEGIN_NAMESPACE_C99


352 
__MATH_INLINE
 

353 
__NTH
 (
	$˚ûf
 (
__x
))

355 
__ªs
;

356 
	`__asm
 ("rounds†$2, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

357  
__ªs
;

358 
	}
}

359 
__END_NAMESPACE_C99


361 
__BEGIN_NAMESPACE_STD


363 
__MATH_INLINE
 

364 
__NTH
 (
	$Êo‹
 (
__x
))

366 
__ªs
;

367 
	`__asm
 ("roundsd $1, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

368  
__ªs
;

369 
	}
}

370 
__END_NAMESPACE_STD


372 
__BEGIN_NAMESPACE_C99


373 
__MATH_INLINE
 

374 
__NTH
 (
	$Êo‹f
 (
__x
))

376 
__ªs
;

377 
	`__asm
 ("rounds†$1, %1, %0" : "=x" (
__ªs
Ë: "xm" (
__x
));

378  
__ªs
;

379 
	}
}

380 
	g__END_NAMESPACE_C99


385 #i‚de‡
__x86_64__


386 #i‡((!
deföed
 
__NO_MATH_INLINES
 || deföed 
__LIBC_INTERNAL_MATH_INLINES
) \

387 && 
deföed
 
	g__OPTIMIZE__
)

391 #unde‡
m©h_îrh™dlög


400 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


401 
	#__ölöe_m©h›
(
func
, 
›
) \

402 
	`__ölöe_m©h›_
 (, 
func
, 
›
) \

403 
	`__ölöe_m©h›_
 (, 
	`__CONCAT
(
func
,
f
), 
›
) \

404 
	`__ölöe_m©h›_
 (, 
	`__CONCAT
(
func
,
l
), 
›
)

	)

405 
	#__ölöe_m©h›NP
(
func
, 
›
) \

406 
	`__ölöe_m©h›NP_
 (, 
func
, 
›
) \

407 
	`__ölöe_m©h›NP_
 (, 
	`__CONCAT
(
func
,
f
), 
›
) \

408 
	`__ölöe_m©h›NP_
 (, 
	`__CONCAT
(
func
,
l
), 
›
)

	)

410 
	#__ölöe_m©h›
(
func
, 
›
) \

411 
	`__ölöe_m©h›_
 (, 
func
, 
›
)

	)

412 
	#__ölöe_m©h›NP
(
func
, 
›
) \

413 
	`__ölöe_m©h›NP_
 (, 
func
, 
›
)

	)

416 
	#__ölöe_m©h›_
(
Êﬂt_ty≥
, 
func
, 
›
) \

417 
	`__ölöe_m©h›_de˛_
 (
Êﬂt_ty≥
, 
func
, 
›
, "0" (
__x
))

	)

418 
	#__ölöe_m©h›NP_
(
Êﬂt_ty≥
, 
func
, 
›
) \

419 
	`__ölöe_m©h›_de˛NP_
 (
Êﬂt_ty≥
, 
func
, 
›
, "0" (
__x
))

	)

422 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


423 
	#__ölöe_m©h›_de˛
(
func
, 
›
, 
∑øms
...) \

424 
	`__ölöe_m©h›_de˛_
 (, 
func
, 
›
, 
∑øms
) \

425 
	`__ölöe_m©h›_de˛_
 (, 
	`__CONCAT
(
func
,
f
), 
›
, 
∑øms
) \

426 
	`__ölöe_m©h›_de˛_
 (, 
	`__CONCAT
(
func
,
l
), 
›
, 
∑øms
)

	)

427 
	#__ölöe_m©h›_de˛NP
(
func
, 
›
, 
∑øms
...) \

428 
	`__ölöe_m©h›_de˛NP_
 (, 
func
, 
›
, 
∑øms
) \

429 
	`__ölöe_m©h›_de˛NP_
 (, 
	`__CONCAT
(
func
,
f
), 
›
, 
∑øms
) \

430 
	`__ölöe_m©h›_de˛NP_
 (, 
	`__CONCAT
(
func
,
l
), 
›
, 
∑øms
)

	)

432 
	#__ölöe_m©h›_de˛
(
func
, 
›
, 
∑øms
...) \

433 
	`__ölöe_m©h›_de˛_
 (, 
func
, 
›
, 
∑øms
)

	)

434 
	#__ölöe_m©h›_de˛NP
(
func
, 
›
, 
∑øms
...) \

435 
	`__ölöe_m©h›_de˛NP_
 (, 
func
, 
›
, 
∑øms
)

	)

438 
	#__ölöe_m©h›_de˛_
(
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
...) \

439 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥Ë
__THROW
; \

440 
	`__ölöe_m©h›_de˛NP_
 (
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
)

	)

442 
	#__ölöe_m©h›_de˛NP_
(
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
...) \

443 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
__x
)) \

445 
Êﬂt_ty≥
 
__ªsu…
; \

446 
__asm
 
	`__vﬁ©ûe__
 (
›
 : "Ò" (
__ªsu…
Ë: 
∑øms
); \

447  
__ªsu…
; \

448 }

	)

451 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


452 
	#__ölöe_m©hcode
(
func
, 
¨g
, 
code
) \

453 
	`__ölöe_m©hcode_
 (, 
func
, 
¨g
, 
code
) \

454 
	`__ölöe_m©hcode_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g
, 
code
) \

455 
	`__ölöe_m©hcode_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g
, 
code
)

	)

456 
	#__ölöe_m©hcodeNP
(
func
, 
¨g
, 
code
) \

457 
	`__ölöe_m©hcodeNP_
 (, 
func
, 
¨g
, 
code
) \

458 
	`__ölöe_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g
, 
code
) \

459 
	`__ölöe_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g
, 
code
)

	)

460 
	#__ölöe_m©hcode2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

461 
	`__ölöe_m©hcode2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
) \

462 
	`__ölöe_m©hcode2_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
code
) \

463 
	`__ölöe_m©hcode2_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
code
)

	)

464 
	#__ölöe_m©hcodeNP2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

465 
	`__ölöe_m©hcodeNP2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
) \

466 
	`__ölöe_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
code
) \

467 
	`__ölöe_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
code
)

	)

468 
	#__ölöe_m©hcode3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

469 
	`__ölöe_m©hcode3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

470 
	`__ölöe_m©hcode3_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

471 
	`__ölöe_m©hcode3_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

472 
	#__ölöe_m©hcodeNP3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

473 
	`__ölöe_m©hcodeNP3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

474 
	`__ölöe_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

475 
	`__ölöe_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

477 
	#__ölöe_m©hcode
(
func
, 
¨g
, 
code
) \

478 
	`__ölöe_m©hcode_
 (, 
func
, (
¨g
), 
code
)

	)

479 
	#__ölöe_m©hcodeNP
(
func
, 
¨g
, 
code
) \

480 
	`__ölöe_m©hcodeNP_
 (, 
func
, (
¨g
), 
code
)

	)

481 
	#__ölöe_m©hcode2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

482 
	`__ölöe_m©hcode2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

483 
	#__ölöe_m©hcodeNP2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

484 
	`__ölöe_m©hcodeNP2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

485 
	#__ölöe_m©hcode3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

486 
	`__ölöe_m©hcode3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

487 
	#__ölöe_m©hcodeNP3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

488 
	`__ölöe_m©hcodeNP3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

491 
	#__ölöe_m©hcode_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
) \

492 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥Ë
__THROW
; \

493 
	`__ölöe_m©hcodeNP_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
)

	)

495 
	#__ölöe_m©hcodeNP_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
) \

496 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
¨g
)) \

498 
code
; \

499 }

	)

502 
	#__ölöe_m©hcode2_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
) \

503 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥, flﬂt_ty≥Ë
__THROW
; \

504 
	`__ölöe_m©hcodeNP2_
 (
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

506 
	#__ölöe_m©hcodeNP2_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
) \

507 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
¨g1
, flﬂt_ty≥ 
¨g2
)) \

509 
code
; \

510 }

	)

512 
	#__ölöe_m©hcode3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

513 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥, flﬂt_ty≥, flﬂt_ty≥Ë
__THROW
; \

514 
	`__ölöe_m©hcodeNP3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

516 
	#__ölöe_m©hcodeNP3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

517 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`__NTH
 (
	`func
 (Êﬂt_ty≥ 
¨g1
, flﬂt_ty≥ 
¨g2
, \

518 
Êﬂt_ty≥
 
¨g3
)) \

520 
code
; \

521 }

	)

525 #i‡!
deföed
 
__NO_MATH_INLINES
 && deföed 
__OPTIMIZE__


529 #ifde‡
__FAST_MATH__


530 #ifde‡
__USE_GNU


531 
	#__söcos_code
 \

532 
__co§
; \

533 
__sör
; \

534 
__swtmp
; \

535 
__asm
 
__vﬁ©ûe__
 \

550 : "Ò" (
__co§
), "=u" (
__sör
), "˜" (
__swtmp
Ë: "0" (
__x
)); \

551 *
__söx
 = 
__sör
; \

552 *
__cosx
 = 
__co§


	)

554 
__MATH_INLINE
 

555 
__NTH
 (
	$__söcos
 (
__x
, *
__söx
, *
__cosx
))

557 
__söcos_code
;

558 
	}
}

560 
__MATH_INLINE
 

561 
__NTH
 (
	$__söcosf
 (
__x
, *
__söx
, *
__cosx
))

563 
__söcos_code
;

564 
	}
}

566 
__MATH_INLINE
 

567 
__NTH
 (
	$__söco¶
 (
__x
, *
__söx
, *
__cosx
))

569 
__söcos_code
;

570 
	}
}

577 #i‡
__GNUC_PREREQ
 (3, 5)

578 
	#__expm1_code
 \

579 
__ãmp
; \

580 
__ãmp
 = 
	`__buûtö_expm1l
 (
__x
); \

581  
__ãmp
 ? __ãm∞: 
__x


	)

583 
	#__expm1_code
 \

584 
__vÆue
; \

585 
__exp⁄ít
; \

586 
__ãmp
; \

587 
__asm
 
__vﬁ©ûe__
 \

596 : "Ò" (
__vÆue
), "=u" (
__exp⁄ít
Ë: "0" (
__x
)); \

597 
__asm
 
__vﬁ©ûe__
 \

599 : "Ò" (
__ãmp
Ë: "0" (1.0), "u" (
__exp⁄ít
)); \

600 
__ãmp
 -= 1.0; \

601 
__ãmp
 +
__vÆue
; \

602  
__ãmp
 ? __ãm∞: 
__x


	)

604 
	$__ölöe_m©hcodeNP_
 (, 
__expm1l
, 
__x
, 
__expm1_code
)

606 #i‡
	`__GNUC_PREREQ
 (3, 4)

607 
	`__ölöe_m©hcodeNP_
 (, 
__ex∂
, 
__x
,  
	$__buûtö_ex∂
 (
__x
))

609 
	#__exp_code
 \

610 
__vÆue
; \

611 
__exp⁄ít
; \

612 
__asm
 
__vﬁ©ûe__
 \

620 : "Ò" (
__vÆue
), "=u" (
__exp⁄ít
Ë: "0" (
__x
)); \

621 
__vÆue
 += 1.0; \

622 
__asm
 
__vﬁ©ûe__
 \

624 : "Ò" (
__vÆue
Ë: "0" (__vÆue), "u" (
__exp⁄ít
)); \

625  
__vÆue


	)

626 
	$__ölöe_m©hcodeNP
 (
exp
, 
__x
, 
__exp_code
)

627 
	$__ölöe_m©hcodeNP_
 (, 
__ex∂
, 
__x
, 
__exp_code
)

631 #i‡!
	`__GNUC_PREREQ
 (3, 5)

632 
	`__ölöe_m©hcodeNP
 (
èn
, 
__x
, \

633 
__vÆue
; \

634 
__vÆue2
 
	`__©åibuã__
 ((
__unu£d__
)); \

635 
__asm
 
__vﬁ©ûe__
 \

637 : "Ò" (
__vÆue2
), "=u" (
__vÆue
Ë: "0" (
__x
)); \

638  
__vÆue
)

643 #i‡
	`__GNUC_PREREQ
 (3, 4)

644 
	`__ölöe_m©hcodeNP2_
 (, 
__©™2l
, 
__y
, 
__x
,

645  
	$__buûtö_©™2l
 (
__y
, 
__x
))

647 
	#__©™2_code
 \

648 
__vÆue
; \

649 
__asm
 
__vﬁ©ûe__
 \

651 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" (
__y
) : "st(1)"); \

652  
__vÆue


	)

653 #ifde‡
__FAST_MATH__


654 
	$__ölöe_m©hcodeNP2
 (
©™2
, 
__y
, 
__x
, 
__©™2_code
)

656 
	$__ölöe_m©hcodeNP2_
 (, 
__©™2l
, 
__y
, 
__x
, 
__©™2_code
)

660 #i‡
deföed
 
__FAST_MATH__
 && !
	`__GNUC_PREREQ
 (3, 5)

661 
	`__ölöe_m©hcodeNP2
 (
fmod
, 
__x
, 
__y
, \

662 
__vÆue
; \

663 
__asm
 
__vﬁ©ûe__
 \

668 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" (
__y
) : "ax", "cc"); \

669  
__vÆue
)

673 #ifde‡
__FAST_MATH__


674 #i‡!
	`__GNUC_PREREQ
 (3,3)

675 
	`__ölöe_m©h›NP
 (
sqπ
, "fsqrt")

676 
	`__ölöe_m©h›NP_
 (, 
__sqπl
, "fsqrt")

677 
	#__libc_sqπl
(
n
Ë
	`__sqπl
 (n)

	)

679 
	#__libc_sqπl
(
n
Ë
	`__buûtö_sqπl
 (n)

	)

683 #i‡
	`__GNUC_PREREQ
 (2, 8)

684 
	`__ölöe_m©hcodeNP_
 (, 
Ábs
, 
__x
,  
	$__buûtö_Ábs
 (
__x
))

685 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


686 
	`__ölöe_m©hcodeNP_
 (, 
Ábsf
, 
__x
,  
	$__buûtö_Ábsf
 (
__x
))

687 
	`__ölöe_m©hcodeNP_
 (, 
Áb¶
, 
__x
,  
	$__buûtö_Áb¶
 (
__x
))

689 
	`__ölöe_m©hcodeNP_
 (, 
__Áb¶
, 
__x
,  
	$__buûtö_Áb¶
 (
__x
))

691 
	`__ölöe_m©h›
 (
Ábs
, "fabs")

692 
	`__ölöe_m©h›_
 (, 
__Áb¶
, "fabs")

695 #ifde‡
__FAST_MATH__


696 #i‡!
	`__GNUC_PREREQ
 (3, 4)

698 
	`__ölöe_m©h›NP
 (
sö
, "fsin")

700 
	`__ölöe_m©h›NP
 (
cos
, "fcos")

702 
	`__ölöe_m©h›_de˛NP
 (
log
, "Êd 2; fxch; fyl2x", "0" (
__x
) : "st(1)")

705 #i‡!
	`__GNUC_PREREQ
 (3, 5)

706 
	`__ölöe_m©h›_de˛NP
 (
log10
, "Êdlg2; fxch; fyl2x", "0" (
__x
) : "st(1)")

708 
	`__ölöe_m©hcodeNP
 (
asö
, 
__x
,  
	`__©™2l
 (__x, 
	`__libc_sqπl
 (1.0 - __x * __x)))

709 
	`__ölöe_m©hcodeNP
 (
acos
, 
__x
,  
	`__©™2l
 (
	`__libc_sqπl
 (1.0 - __x * __x), __x))

712 #i‡!
	`__GNUC_PREREQ
 (3, 4)

713 
	`__ölöe_m©h›_de˛NP
 (
©™
, "Êd1; f∑èn", "0" (
__x
) : "st(1)")

717 
	`__ölöe_m©hcode_
 (, 
__sgn1l
, 
__x
, \

718 
__exãnsi⁄__
 uni⁄ { 
__xld
; 
__xi
[3]; } 
__n
 = \

719 { 
__xld
: 
__x
 
	}
}; \

720 
	g__n
.
	g__xi
[2] = (
__n
.
__xi
[2] & 0x8000) | 0x3fff; \

721 
	g__n
.
	g__xi
[1] = 0x80000000; \

722 
	g__n
.
	g__xi
[0] = 0; \

723  
	g__n
.
	g__xld
)

726 #ifde‡
__FAST_MATH__


728 
__ölöe_m©hcodeNP
 (
söh
, 
__x
, \

729 
__exm1
 = 
__expm1l
 (
__Áb¶
 (
__x
)); \

730  0.5 * (
__exm1
 / (__exm1 + 1.0Ë+ __exm1Ë* 
	$__sgn1l
 (
__x
))

732 
	`__ölöe_m©hcodeNP
 (
cosh
, 
__x
, \

733 
__ex
 = 
	`__ex∂
 (
__x
); \

734  0.5 * (
__ex
 + 1.0 / __ex))

736 
	`__ölöe_m©hcodeNP
 (
ènh
, 
__x
, \

737 
__exm1
 = 
	`__expm1l
 (-
	`__Áb¶
 (
__x
 + __x)); \

738  
__exm1
 / (__exm1 + 2.0Ë* 
	`__sgn1l
 (-
__x
))

741 
	`__ölöe_m©hcodeNP
 (
Êo‹
, 
__x
, \

742 
__vÆue
; \

743 
__ign‹e
; \

744 
__cw
; \

745 
__cwtmp
; \

746 
__asm
 
	`__vﬁ©ûe
 ("fnstcw %3\n\t" \

754 : "Ò" (
__vÆue
), "=&q" (
__ign‹e
), "=m" (
__cwtmp
), \

755 "=m" (
__cw
) \

756 : "0" (
__x
)); \

757  
__vÆue
)

759 
	`__ölöe_m©hcodeNP
 (
˚û
, 
__x
, \

760 
__vÆue
; \

761 
__ign‹e
; \

762 
__cw
; \

763 
__cwtmp
; \

764 
__asm
 
	`__vﬁ©ûe
 ("fnstcw %3\n\t" \

772 : "Ò" (
__vÆue
), "=&q" (
__ign‹e
), "=m" (
__cwtmp
), \

773 "=m" (
__cw
) \

774 : "0" (
__x
)); \

775  
__vÆue
)

777 #ifde‡
__FAST_MATH__


778 
	#__ldexp_code
 \

779 
__vÆue
; \

780 
__asm
 
__vﬁ©ûe__
 \

782 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" ((Ë
__y
)); \

783  
__vÆue


	)

785 
__MATH_INLINE
 

786 
	`__NTH
 (
	$ldexp
 (
__x
, 
__y
))

788 
__ldexp_code
;

789 
	}
}

794 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


796 #ifde‡
__FAST_MATH__


797 
	$__ölöe_m©hcodeNP
 (
expm1
, 
__x
, 
__expm1_code
)

801 
	#__M_SQRT2
 1.41421356237309504880L

	)

803 #i‡!
	`__GNUC_PREREQ
 (3, 5)

804 
	`__ölöe_m©hcodeNP
 (
log1p
, 
__x
, \

805 
__vÆue
; \

806 i‡(
	`__Áb¶
 (
__x
Ë>1.0 - 0.5 * 
__M_SQRT2
) \

807 
__vÆue
 = 
	`logl
 (1.0 + 
__x
); \

809 
__asm
 
__vﬁ©ûe__
 \

813 : "Ò" (
__vÆue
Ë: "0" (
__x
) : "st(1)"); \

814  
__vÆue
)

819 
	`__ölöe_m©hcodeNP
 (
asöh
, 
__x
, \

820 
__y
 = 
	`__Áb¶
 (
__x
); \

821  (
	`log1∂
 (
__y
 * __y / (
	`__libc_sqπl
 (__y * __y + 1.0) + 1.0) + __y) \

822 * 
	$__sgn1l
 (
__x
)))

824 
	`__ölöe_m©hcodeNP
 (
acosh
, 
__x
, \

825  
	`logl
 (
__x
 + 
	`__libc_sqπl
 (__x - 1.0) * __libc_sqrtl (__x + 1.0)))

827 
	`__ölöe_m©hcodeNP
 (
©™h
, 
__x
, \

828 
__y
 = 
	`__Áb¶
 (
__x
); \

829  -0.5 * 
	`log1∂
 (-(
__y
 + __yË/ (1.0 + __y)Ë* 
	$__sgn1l
 (
__x
))

832 
	`__ölöe_m©hcodeNP2
 (
hypŸ
, 
__x
, 
__y
,

833  
	`__libc_sqπl
 (
__x
 * __x + 
__y
 * __y))

835 #i‡!
	`__GNUC_PREREQ
 (3, 5)

836 
	`__ölöe_m©hcodeNP
(
logb
, 
__x
, \

837 
__vÆue
; \

838 
__junk
; \

839 
__asm
 
__vﬁ©ûe__
 \

841 : "Ò" (
__junk
), "=u" (
__vÆue
Ë: "0" (
__x
)); \

842  
__vÆue
)

848 #ifde‡
__USE_ISOC99


849 #ifde‡
__FAST_MATH__


851 #i‡!
	`__GNUC_PREREQ
 (3, 5)

852 
	`__ölöe_m©h›_de˛NP
 (
log2
, "Êd1; fxch; fyl2x", "0" (
__x
) : "st(1)")

855 
__MATH_INLINE
 

856 
	`__NTH
 (
	$ldexpf
 (
__x
, 
__y
))

858 
__ldexp_code
;

859 
	}
}

861 
__MATH_INLINE
 

862 
__NTH
 (
	$ldex∂
 (
__x
, 
__y
))

864 
__ldexp_code
;

865 
	}
}

867 
__ölöe_m©h›NP
 (
röt
, "frndint")

870 
	#__Ãöt_code
 \

871 
__Ãöåes
; \

872 
__asm__
 
__vﬁ©ûe__
 \

874 : "=m" (
__Ãöåes
Ë: "t" (
__x
) : "st"); \

875  
__Ãöåes


	)

876 
__MATH_INLINE
 

877 
__NTH
 (
	$Ãötf
 (
__x
))

879 
__Ãöt_code
;

880 
	}
}

881 
__MATH_INLINE
 

882 
__NTH
 (
	$Ãöt
 (
__x
))

884 
__Ãöt_code
;

885 
	}
}

886 
__MATH_INLINE
 

887 
__NTH
 (
	$Ãöé
 (
__x
))

889 
__Ãöt_code
;

890 
	}
}

891 #unde‡
__Ãöt_code


893 
	#__Œröt_code
 \

894 
__Œröåes
; \

895 
__asm__
 
__vﬁ©ûe__
 \

897 : "=m" (
__Œröåes
Ë: "t" (
__x
) : "st"); \

898  
__Œröåes


	)

899 
__MATH_INLINE
 

900 
__NTH
 (
	$Œrötf
 (
__x
))

902 
__Œröt_code
;

903 
	}
}

904 
__MATH_INLINE
 

905 
__NTH
 (
	$Œröt
 (
__x
))

907 
__Œröt_code
;

908 
	}
}

909 
__MATH_INLINE
 

910 
__NTH
 (
	$Œröé
 (
__x
))

912 
__Œröt_code
;

913 
	}
}

914 #unde‡
__Œröt_code


919 #ifde‡
__USE_MISC


921 #i‡
deföed
 
__FAST_MATH__
 && !
__GNUC_PREREQ
 (3, 5)

922 
__ölöe_m©hcodeNP2
 (
dªm
, 
__x
, 
__y
, \

923 
__vÆue
; \

924 
__˛obbîed
; \

925 
__asm
 
__vﬁ©ûe__
 \

930 : "Ò" (
__vÆue
), "=&a" (
__˛obbîed
Ë: "0" (
__x
), "u" (
__y
) : "cc"); \

931  
__vÆue
)

936 
__MATH_INLINE
 

937 
__NTH
 (
	$__föôe
 (
__x
))

939  (
__exãnsi⁄__


940 (((((uni⁄ { 
__d
; 
__i
[2]; }Ë{__d: 
__x
}).__i[1]

942 
	}
}

947 #unde‡
__©™2_code


948 #ifde‡
__FAST_MATH__


949 #unde‡
__expm1_code


950 #unde‡
__exp_code


951 #unde‡
__söcos_code


958 #ifde‡
__LIBC_INTERNAL_MATH_INLINES


959 
__ölöe_m©h›
 (
__õì754_sqπ
, "fsqrt")

960 
__ölöe_m©hcode2
 (
__õì754_©™2
, 
__y
, 
__x
,

961 
__vÆue
;

962 
__asm
 
__vﬁ©ûe__
 ("fpatan\n\t"

963 : "Ò" (
__vÆue
)

964 : "0" (
__x
), "u" (
__y
) : "st(1)");

965  
__vÆue
;)

	@/usr/include/bits/nan.h

19 #i‚de‡
_MATH_H


26 #i‡
__GNUC_PREREQ
(3,3)

28 
	#NAN
 (
	`__buûtö_«nf
 (""))

	)

30 #ñi‡
deföed
 
__GNUC__


32 
	#NAN
 \

33 (
__exãnsi⁄__
 \

34 ((uni⁄ { 
__l
 
	`__©åibuã__
 ((
	`__mode__
 (
__SI__
))); 
__d
; }) \

35 { 
__l
: 0x7fc00000UL }).
__d
)

	)

39 
	~<ídün.h
>

41 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


42 
	#__«n_byãs
 { 0x7f, 0xc0, 0, 0 }

	)

44 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


45 
	#__«n_byãs
 { 0, 0, 0xc0, 0x7‡}

	)

48 uni⁄ { 
	m__c
[4]; 
	m__d
; } 
__«n_uni⁄


49 
	g__©åibuã_u£d__
 = { 
__«n_byãs
 };

50 
	#NAN
 (
__«n_uni⁄
.
__d
)

	)

	@/usr/include/bits/stat.h

18 #i‡!
deföed
 
_SYS_STAT_H
 && !deföed 
_FCNTL_H


22 #i‚de‡
_BITS_STAT_H


23 
	#_BITS_STAT_H
 1

	)

26 #i‚de‡
__x86_64__


27 
	#_STAT_VER_LINUX_OLD
 1

	)

28 
	#_STAT_VER_KERNEL
 1

	)

29 
	#_STAT_VER_SVR4
 2

	)

30 
	#_STAT_VER_LINUX
 3

	)

33 
	#_MKNOD_VER_LINUX
 1

	)

34 
	#_MKNOD_VER_SVR4
 2

	)

35 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

37 
	#_STAT_VER_KERNEL
 0

	)

38 
	#_STAT_VER_LINUX
 1

	)

41 
	#_MKNOD_VER_LINUX
 0

	)

44 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

46 
	s°©


48 
__dev_t
 
	m°_dev
;

49 #i‚de‡
__x86_64__


50 
	m__∑d1
;

52 #i‡
deföed
 
__x86_64__
 || !deföed 
__USE_FILE_OFFSET64


53 
__öo_t
 
	m°_öo
;

55 
__öo_t
 
	m__°_öo
;

57 #i‚de‡
__x86_64__


58 
__mode_t
 
	m°_mode
;

59 
__∆ök_t
 
	m°_∆ök
;

61 
__∆ök_t
 
	m°_∆ök
;

62 
__mode_t
 
	m°_mode
;

64 
__uid_t
 
	m°_uid
;

65 
__gid_t
 
	m°_gid
;

66 #ifde‡
__x86_64__


67 
	m__∑d0
;

69 
__dev_t
 
	m°_rdev
;

70 #i‚de‡
__x86_64__


71 
	m__∑d2
;

73 #i‡
deföed
 
__x86_64__
 || !deföed 
__USE_FILE_OFFSET64


74 
__off_t
 
	m°_size
;

76 
__off64_t
 
	m°_size
;

78 
__blksize_t
 
	m°_blksize
;

79 #i‡
deföed
 
__x86_64__
 || !deföed 
__USE_FILE_OFFSET64


80 
__blk˙t_t
 
	m°_blocks
;

82 
__blk˙t64_t
 
	m°_blocks
;

84 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K8


91 
time•ec
 
	m°_©im
;

92 
time•ec
 
	m°_mtim
;

93 
time•ec
 
	m°_˘im
;

94 
	#°_©ime
 
°_©im
.
tv_£c


	)

95 
	#°_mtime
 
°_mtim
.
tv_£c


	)

96 
	#°_˘ime
 
°_˘im
.
tv_£c


	)

98 
__time_t
 
	m°_©ime
;

99 
__sysˇŒ_ul⁄g_t
 
	m°_©imí£c
;

100 
__time_t
 
	m°_mtime
;

101 
__sysˇŒ_ul⁄g_t
 
	m°_mtimí£c
;

102 
__time_t
 
	m°_˘ime
;

103 
__sysˇŒ_ul⁄g_t
 
	m°_˘imí£c
;

105 #ifde‡
__x86_64__


106 
__sysˇŒ_¶⁄g_t
 
	m__unu£d
[3];

108 #i‚de‡
__USE_FILE_OFFSET64


109 
	m__unu£d4
;

110 
	m__unu£d5
;

112 
__öo64_t
 
	m°_öo
;

117 #ifde‡
__USE_LARGEFILE64


119 
	s°©64


121 
__dev_t
 
	m°_dev
;

122 #ifde‡
__x86_64__


123 
__öo64_t
 
	m°_öo
;

124 
__∆ök_t
 
	m°_∆ök
;

125 
__mode_t
 
	m°_mode
;

127 
	m__∑d1
;

128 
__öo_t
 
	m__°_öo
;

129 
__mode_t
 
	m°_mode
;

130 
__∆ök_t
 
	m°_∆ök
;

132 
__uid_t
 
	m°_uid
;

133 
__gid_t
 
	m°_gid
;

134 #ifde‡
__x86_64__


135 
	m__∑d0
;

136 
__dev_t
 
	m°_rdev
;

137 
__off_t
 
	m°_size
;

139 
__dev_t
 
	m°_rdev
;

140 
	m__∑d2
;

141 
__off64_t
 
	m°_size
;

143 
__blksize_t
 
	m°_blksize
;

144 
__blk˙t64_t
 
	m°_blocks
;

145 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN2K8


152 
time•ec
 
	m°_©im
;

153 
time•ec
 
	m°_mtim
;

154 
time•ec
 
	m°_˘im
;

156 
__time_t
 
	m°_©ime
;

157 
__sysˇŒ_ul⁄g_t
 
	m°_©imí£c
;

158 
__time_t
 
	m°_mtime
;

159 
__sysˇŒ_ul⁄g_t
 
	m°_mtimí£c
;

160 
__time_t
 
	m°_˘ime
;

161 
__sysˇŒ_ul⁄g_t
 
	m°_˘imí£c
;

163 #ifde‡
__x86_64__


164 
__sysˇŒ_¶⁄g_t
 
	m__unu£d
[3];

166 
__öo64_t
 
	m°_öo
;

172 
	#_STATBUF_ST_BLKSIZE


	)

173 
	#_STATBUF_ST_RDEV


	)

175 
	#_STATBUF_ST_NSEC


	)

179 
	#__S_IFMT
 0170000

	)

182 
	#__S_IFDIR
 0040000

	)

183 
	#__S_IFCHR
 0020000

	)

184 
	#__S_IFBLK
 0060000

	)

185 
	#__S_IFREG
 0100000

	)

186 
	#__S_IFIFO
 0010000

	)

187 
	#__S_IFLNK
 0120000

	)

188 
	#__S_IFSOCK
 0140000

	)

192 
	#__S_TYPEISMQ
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

193 
	#__S_TYPEISSEM
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

194 
	#__S_TYPEISSHM
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

198 
	#__S_ISUID
 04000

	)

199 
	#__S_ISGID
 02000

	)

200 
	#__S_ISVTX
 01000

	)

201 
	#__S_IREAD
 0400

	)

202 
	#__S_IWRITE
 0200

	)

203 
	#__S_IEXEC
 0100

	)

205 #ifde‡
__USE_ATFILE


206 
	#UTIME_NOW
 ((1»<< 30Ë- 1l)

	)

207 
	#UTIME_OMIT
 ((1»<< 30Ë- 2l)

	)

	@/usr/include/bits/stdio-ldbl.h

19 #i‚de‡
_STDIO_H


23 
__BEGIN_NAMESPACE_STD


24 
	$__LDBL_REDIR_DECL
 (
Ârötf
)

25 
	$__LDBL_REDIR_DECL
 (
¥ötf
)

26 
	$__LDBL_REDIR_DECL
 (
•rötf
)

27 
	$__LDBL_REDIR_DECL
 (
vÂrötf
)

28 
	$__LDBL_REDIR_DECL
 (
v¥ötf
)

29 
	$__LDBL_REDIR_DECL
 (
v•rötf
)

30 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

31 && !
deföed
 
__REDIRECT
 \

32 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

33 
	$__LDBL_REDIR1_DECL
 (
fsˇnf
, 
__∆dbl___isoc99_fsˇnf
)

34 
	$__LDBL_REDIR1_DECL
 (
sˇnf
, 
__∆dbl___isoc99_sˇnf
)

35 
	$__LDBL_REDIR1_DECL
 (
ssˇnf
, 
__∆dbl___isoc99_ssˇnf
)

37 
	$__LDBL_REDIR_DECL
 (
fsˇnf
)

38 
	$__LDBL_REDIR_DECL
 (
sˇnf
)

39 
	$__LDBL_REDIR_DECL
 (
ssˇnf
)

41 
__END_NAMESPACE_STD


43 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


44 
__BEGIN_NAMESPACE_C99


45 
	$__LDBL_REDIR_DECL
 (
¢¥ötf
)

46 
	$__LDBL_REDIR_DECL
 (
v¢¥ötf
)

47 
__END_NAMESPACE_C99


50 #ifdef 
__USE_ISOC99


51 
__BEGIN_NAMESPACE_C99


52 #i‡!
deföed
 
__USE_GNU
 && !deföed 
__REDIRECT
 \

53 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

54 
	$__LDBL_REDIR1_DECL
 (
vfsˇnf
, 
__∆dbl___isoc99_vfsˇnf
)

55 
	$__LDBL_REDIR1_DECL
 (
vsˇnf
, 
__∆dbl___isoc99_vsˇnf
)

56 
	$__LDBL_REDIR1_DECL
 (
vssˇnf
, 
__∆dbl___isoc99_vssˇnf
)

58 
	$__LDBL_REDIR_DECL
 (
vfsˇnf
)

59 
	$__LDBL_REDIR_DECL
 (
vssˇnf
)

60 
	$__LDBL_REDIR_DECL
 (
vsˇnf
)

62 
__END_NAMESPACE_C99


65 #ifde‡
__USE_XOPEN2K8


66 
	$__LDBL_REDIR_DECL
 (
vd¥ötf
)

67 
	$__LDBL_REDIR_DECL
 (
d¥ötf
)

70 #ifde‡
__USE_GNU


71 
	$__LDBL_REDIR_DECL
 (
va•rötf
)

72 
	$__LDBL_REDIR_DECL
 (
__a•rötf
)

73 
	$__LDBL_REDIR_DECL
 (
a•rötf
)

74 
	$__LDBL_REDIR_DECL
 (
ob°ack_¥ötf
)

75 
	$__LDBL_REDIR_DECL
 (
ob°ack_v¥ötf
)

78 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


79 
	$__LDBL_REDIR_DECL
 (
__•rötf_chk
)

80 
	$__LDBL_REDIR_DECL
 (
__v•rötf_chk
)

81 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


82 
	$__LDBL_REDIR_DECL
 (
__¢¥ötf_chk
)

83 
	$__LDBL_REDIR_DECL
 (
__v¢¥ötf_chk
)

85 #i‡
__USE_FORTIFY_LEVEL
 > 1

86 
	$__LDBL_REDIR_DECL
 (
__Ârötf_chk
)

87 
	$__LDBL_REDIR_DECL
 (
__¥ötf_chk
)

88 
	$__LDBL_REDIR_DECL
 (
__vÂrötf_chk
)

89 
	$__LDBL_REDIR_DECL
 (
__v¥ötf_chk
)

90 #ifde‡
__USE_XOPEN2K8


91 
	$__LDBL_REDIR_DECL
 (
__d¥ötf_chk
)

92 
	$__LDBL_REDIR_DECL
 (
__vd¥ötf_chk
)

94 #ifde‡
__USE_GNU


95 
	$__LDBL_REDIR_DECL
 (
__a•rötf_chk
)

96 
	$__LDBL_REDIR_DECL
 (
__va•rötf_chk
)

97 
	$__LDBL_REDIR_DECL
 (
__ob°ack_¥ötf_chk
)

98 
	$__LDBL_REDIR_DECL
 (
__ob°ack_v¥ötf_chk
)

	@/usr/include/bits/stdio.h

19 #i‚de‡
_STDIO_H


23 #i‚de‡
__exã∫_ölöe


24 
	#__STDIO_INLINE
 
ölöe


	)

26 
	#__STDIO_INLINE
 
__exã∫_ölöe


	)

30 #ifde‡
__USE_EXTERN_INLINES


33 #i‡!(
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄
)

35 
__STDIO_INLINE
 

36 
	$v¥ötf
 (c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

38  
	`vÂrötf
 (
°dout
, 
__fmt
, 
__¨g
);

39 
	}
}

43 
__STDIO_INLINE
 

44 
	$gëch¨
 ()

46  
	`_IO_gëc
 (
°dö
);

47 
	}
}

50 #ifde‡
__USE_MISC


52 
__STDIO_INLINE
 

53 
	$fgëc_u∆ocked
 (
FILE
 *
__Â
)

55  
	`_IO_gëc_u∆ocked
 (
__Â
);

56 
	}
}

60 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


62 
__STDIO_INLINE
 

63 
	$gëc_u∆ocked
 (
FILE
 *
__Â
)

65  
	`_IO_gëc_u∆ocked
 (
__Â
);

66 
	}
}

69 
__STDIO_INLINE
 

70 
	$gëch¨_u∆ocked
 ()

72  
	`_IO_gëc_u∆ocked
 (
°dö
);

73 
	}
}

78 
__STDIO_INLINE
 

79 
	$putch¨
 (
__c
)

81  
	`_IO_putc
 (
__c
, 
°dout
);

82 
	}
}

85 #ifde‡
__USE_MISC


87 
__STDIO_INLINE
 

88 
	$Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

90  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

91 
	}
}

95 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


97 
__STDIO_INLINE
 

98 
	$putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

100  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

101 
	}
}

104 
__STDIO_INLINE
 

105 
	$putch¨_u∆ocked
 (
__c
)

107  
	`_IO_putc_u∆ocked
 (
__c
, 
°dout
);

108 
	}
}

112 #ifdef 
__USE_GNU


114 
__STDIO_INLINE
 
_IO_ssize_t


115 
	$gëlöe
 (**
__löïå
, 
size_t
 *
__n
, 
FILE
 *
__°ªam
)

117  
	`__gëdñim
 (
__löïå
, 
__n
, '\n', 
__°ªam
);

118 
	}
}

122 #ifde‡
__USE_MISC


124 
__STDIO_INLINE
 

125 
__NTH
 (
	$„of_u∆ocked
 (
FILE
 *
__°ªam
))

127  
	`_IO_„of_u∆ocked
 (
__°ªam
);

128 
	}
}

131 
__STDIO_INLINE
 

132 
__NTH
 (
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
))

134  
	`_IO_„º‹_u∆ocked
 (
__°ªam
);

135 
	}
}

141 #i‡
deföed
 
__USE_MISC
 && deföed 
__GNUC__
 && deföed 
__OPTIMIZE__
 \

142 && !
deföed
 
	g__˝lu•lus


144 
	#‰ód_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

145 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

146 && (
size_t
Ë(
size
Ë* (size_tË(
n
) <= 8 \

147 && (
size_t
Ë(
size
) != 0) \

148 ? ({ *
__±r
 = (*Ë(
±r
); \

149 
FILE
 *
__°ªam
 = (
°ªam
); \

150 
size_t
 
__˙t
; \

151 
__˙t
 = (
size_t
Ë(
size
Ë* (size_tË(
n
); \

152 
__˙t
 > 0; --__cnt) \

154 
__c
 = 
	`_IO_gëc_u∆ocked
 (
__°ªam
); \

155 i‡(
__c
 =
EOF
) \

157 *
__±r
++ = 
__c
; \

159 ((
size_t
Ë(
size
Ë* (size_tË(
n
Ë- 
__˙t
) \

160 / (
size_t
Ë(
size
); }) \

161 : (((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& (
size_t
) (size) == 0) \

162 || (
	`__buûtö_c⁄°™t_p
 (
n
Ë&& (
size_t
) (n) == 0)) \

164 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), \

165 (Ë(
n
), (
size_t
) 0) \

166 : 
	`‰ód_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

168 
	#fwrôe_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

169 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

170 && (
size_t
Ë(
size
Ë* (size_tË(
n
) <= 8 \

171 && (
size_t
Ë(
size
) != 0) \

172 ? ({ c⁄° *
__±r
 = (c⁄° *Ë(
±r
); \

173 
FILE
 *
__°ªam
 = (
°ªam
); \

174 
size_t
 
__˙t
; \

175 
__˙t
 = (
size_t
Ë(
size
Ë* (size_tË(
n
); \

176 
__˙t
 > 0; --__cnt) \

177 i‡(
	`_IO_putc_u∆ocked
 (*
__±r
++, 
__°ªam
Ë=
EOF
) \

179 ((
size_t
Ë(
size
Ë* (size_tË(
n
Ë- 
__˙t
) \

180 / (
size_t
Ë(
size
); }) \

181 : (((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& (
size_t
) (size) == 0) \

182 || (
	`__buûtö_c⁄°™t_p
 (
n
Ë&& (
size_t
) (n) == 0)) \

184 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), \

185 (Ë(
n
), (
size_t
) 0) \

186 : 
	`fwrôe_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

190 #unde‡
__STDIO_INLINE


	@/usr/include/bits/stdio2.h

19 #i‚de‡
_STDIO_H


23 
	$__•rötf_chk
 (*
__ª°ri˘
 
__s
, 
__Êag
, 
size_t
 
__¶í
,

24 c⁄° *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

25 
	$__v•rötf_chk
 (*
__ª°ri˘
 
__s
, 
__Êag
, 
size_t
 
__¶í
,

26 c⁄° *
__ª°ri˘
 
__f‹m©
,

27 
_G_va_li°
 
__≠
Ë
__THROW
;

29 #ifde‡
__va_¨g_∑ck


30 
__f‹tify_fun˘i⁄
 

31 
	`__NTH
 (
	$•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__fmt
, ...))

33  
	`__buûtö___•rötf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

34 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¨g_∑ck
 ());

35 
	}
}

36 #ñi‡!
deföed
 
__˝lu•lus


37 
	#•rötf
(
°r
, ...) \

38 
	`__buûtö___•rötf_chk
 (
°r
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

39 
__VA_ARGS__
)

	)

42 
__f‹tify_fun˘i⁄
 

43 
__NTH
 (
	$v•rötf
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__fmt
,

44 
_G_va_li°
 
__≠
))

46  
	`__buûtö___v•rötf_chk
 (
__s
, 
__USE_FORTIFY_LEVEL
 - 1,

47 
	`__bos
 (
__s
), 
__fmt
, 
__≠
);

48 
	}
}

50 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


52 
	$__¢¥ötf_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
, 
__Êag
,

53 
size_t
 
__¶í
, c⁄° *
__ª°ri˘
 
__f‹m©
,

54 ...Ë
__THROW
;

55 
	$__v¢¥ötf_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
, 
__Êag
,

56 
size_t
 
__¶í
, c⁄° *
__ª°ri˘
 
__f‹m©
,

57 
_G_va_li°
 
__≠
Ë
__THROW
;

59 #ifde‡
__va_¨g_∑ck


60 
__f‹tify_fun˘i⁄
 

61 
	`__NTH
 (
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
,

62 c⁄° *
__ª°ri˘
 
__fmt
, ...))

64  
	`__buûtö___¢¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

65 
	`__bos
 (
__s
), 
__fmt
, 
	`__va_¨g_∑ck
 ());

66 
	}
}

67 #ñi‡!
deföed
 
__˝lu•lus


68 
	#¢¥ötf
(
°r
, 
Àn
, ...) \

69 
	`__buûtö___¢¥ötf_chk
 (
°r
, 
Àn
, 
__USE_FORTIFY_LEVEL
 - 1, 
	`__bos
 (str), \

70 
__VA_ARGS__
)

	)

73 
__f‹tify_fun˘i⁄
 

74 
__NTH
 (
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__n
,

75 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
))

77  
	`__buûtö___v¢¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

78 
	`__bos
 (
__s
), 
__fmt
, 
__≠
);

79 
	}
}

83 #i‡
__USE_FORTIFY_LEVEL
 > 1

85 
__Ârötf_chk
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

86 c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

87 
__¥ötf_chk
 (
__Êag
, c⁄° *
__ª°ri˘
 
__f‹m©
, ...);

88 
__vÂrötf_chk
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

89 c⁄° *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__≠
);

90 
__v¥ötf_chk
 (
__Êag
, c⁄° *
__ª°ri˘
 
__f‹m©
,

91 
_G_va_li°
 
__≠
);

93 #ifde‡
__va_¨g_∑ck


94 
__f‹tify_fun˘i⁄
 

95 
	$Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, c⁄° *__ª°ri˘ 
__fmt
, ...)

97  
	`__Ârötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

98 
	`__va_¨g_∑ck
 ());

99 
	}
}

101 
__f‹tify_fun˘i⁄
 

102 
	$¥ötf
 (c⁄° *
__ª°ri˘
 
__fmt
, ...)

104  
	`__¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¨g_∑ck
 ());

105 
	}
}

106 #ñi‡!
deföed
 
__˝lu•lus


107 
	#¥ötf
(...) \

108 
	`__¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

109 
	#Ârötf
(
°ªam
, ...) \

110 
	`__Ârötf_chk
 (
°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

113 
__f‹tify_fun˘i⁄
 

114 
	$v¥ötf
 (c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

116 #ifde‡
__USE_EXTERN_INLINES


117  
	`__vÂrötf_chk
 (
°dout
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

119  
	`__v¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

121 
	}
}

123 
__f‹tify_fun˘i⁄
 

124 
	$vÂrötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

125 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

127  
	`__vÂrötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

128 
	}
}

130 #ifde‡
__USE_XOPEN2K8


131 
	$__d¥ötf_chk
 (
__fd
, 
__Êag
, c⁄° *
__ª°ri˘
 
__fmt
,

132 ...Ë
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

133 
	$__vd¥ötf_chk
 (
__fd
, 
__Êag
,

134 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

135 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

137 #ifde‡
__va_¨g_∑ck


138 
__f‹tify_fun˘i⁄
 

139 
	$d¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, ...)

141  
	`__d¥ötf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

142 
	`__va_¨g_∑ck
 ());

143 
	}
}

144 #ñi‡!
deföed
 
__˝lu•lus


145 
	#d¥ötf
(
fd
, ...) \

146 
	`__d¥ötf_chk
 (
fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

149 
__f‹tify_fun˘i⁄
 

150 
	$vd¥ötf
 (
__fd
, c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
)

152  
	`__vd¥ötf_chk
 (
__fd
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

153 
	}
}

156 #ifde‡
__USE_GNU


158 
	$__a•rötf_chk
 (**
__ª°ri˘
 
__±r
, 
__Êag
,

159 c⁄° *
__ª°ri˘
 
__fmt
, ...)

160 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 3, 4))Ë
__wur
;

161 
	$__va•rötf_chk
 (**
__ª°ri˘
 
__±r
, 
__Êag
,

162 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

163 
__THROW
 
	`__©åibuã__
 ((
	$__f‹m©__
 (
__¥ötf__
, 3, 0))Ë
__wur
;

164 
	$__ob°ack_¥ötf_chk
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

165 
__Êag
, c⁄° *
__ª°ri˘
 
__f‹m©
,

167 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

168 
	$__ob°ack_v¥ötf_chk
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

169 
__Êag
,

170 c⁄° *
__ª°ri˘
 
__f‹m©
,

171 
_G_va_li°
 
__¨gs
)

172 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

174 #ifde‡
__va_¨g_∑ck


175 
__f‹tify_fun˘i⁄
 

176 
	`__NTH
 (
	$a•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__fmt
, ...))

178  
	`__a•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

179 
	`__va_¨g_∑ck
 ());

180 
	}
}

182 
__f‹tify_fun˘i⁄
 

183 
__NTH
 (
	$__a•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__fmt
,

186  
	`__a•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

187 
	`__va_¨g_∑ck
 ());

188 
	}
}

190 
__f‹tify_fun˘i⁄
 

191 
__NTH
 (
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

192 c⁄° *
__ª°ri˘
 
__fmt
, ...))

194  
	`__ob°ack_¥ötf_chk
 (
__ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

195 
	`__va_¨g_∑ck
 ());

196 
	}
}

197 #ñi‡!
deföed
 
__˝lu•lus


198 
	#a•rötf
(
±r
, ...) \

199 
	`__a•rötf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

200 
	#__a•rötf
(
±r
, ...) \

201 
	`__a•rötf_chk
 (
±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

202 
	#ob°ack_¥ötf
(
ob°ack
, ...) \

203 
	`__ob°ack_¥ötf_chk
 (
ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

206 
__f‹tify_fun˘i⁄
 

207 
__NTH
 (
	$va•rötf
 (**
__ª°ri˘
 
__±r
, c⁄° *__ª°ri˘ 
__fmt
,

208 
_G_va_li°
 
__≠
))

210  
	`__va•rötf_chk
 (
__±r
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

211 
	}
}

213 
__f‹tify_fun˘i⁄
 

214 
__NTH
 (
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

215 c⁄° *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__≠
))

217  
	`__ob°ack_v¥ötf_chk
 (
__ob°ack
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

218 
__≠
);

219 
	}
}

225 #i‡!
deföed
 
__USE_ISOC11
 \

226 || (
deföed
 
	g__˝lu•lus
 && __˝lu•lu†<201103L && !deföed 
__USE_GNU
)

227 *
	$__gës_chk
 (*
__°r
, 
size_t
Ë
__wur
;

228 *
	`__REDIRECT
 (
__gës_w¨n
, (*
__°r
), 
gës
)

229 
__wur
 
	`__w¨«âr
 ("please use fgets or getline instead, gets can't "

232 
__f‹tify_fun˘i⁄
 
__wur
 *

233 
	$gës
 (*
__°r
)

235 i‡(
	`__bos
 (
__°r
Ë!(
size_t
) -1)

236  
	`__gës_chk
 (
__°r
, 
	`__bos
 (__str));

237  
	`__gës_w¨n
 (
__°r
);

238 
	}
}

241 *
	$__fgës_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

242 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

243 *
	`__REDIRECT
 (
__fgës_Æüs
,

244 (*
__ª°ri˘
 
__s
, 
__n
,

245 
FILE
 *
__ª°ri˘
 
__°ªam
), 
fgës
Ë
__wur
;

246 *
	`__REDIRECT
 (
__fgës_chk_w¨n
,

247 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

248 
FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgës_chk
)

249 
__wur
 
	`__w¨«âr
 ("fgets called with bigger sizeÅhanÜength "

252 
__f‹tify_fun˘i⁄
 
__wur
 *

253 
	$fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

255 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

257 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

258  
	`__fgës_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

260 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
))

261  
	`__fgës_chk_w¨n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

263  
	`__fgës_Æüs
 (
__s
, 
__n
, 
__°ªam
);

264 
	}
}

266 
size_t
 
	$__‰ód_chk
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

267 
size_t
 
__size
, size_à
__n
,

268 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

269 
size_t
 
	`__REDIRECT
 (
__‰ód_Æüs
,

270 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

271 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
),

272 
‰ód
Ë
__wur
;

273 
size_t
 
	`__REDIRECT
 (
__‰ód_chk_w¨n
,

274 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

275 
size_t
 
__size
, size_à
__n
,

276 
FILE
 *
__ª°ri˘
 
__°ªam
),

277 
__‰ód_chk
)

278 
__wur
 
	`__w¨«âr
 ("fread called with bigger size *ÇmembÅhanÜength "

281 
__f‹tify_fun˘i⁄
 
__wur
 
size_t


282 
	$‰ód
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
, size_à
__n
,

283 
FILE
 *
__ª°ri˘
 
__°ªam
)

285 i‡(
	`__bos0
 (
__±r
Ë!(
size_t
) -1)

287 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
)

288 || !
	`__buûtö_c⁄°™t_p
 (
__n
)

289 || (
__size
 | 
__n
Ë>(((
size_t
) 1) << (8 *  (size_t) / 2)))

290  
	`__‰ód_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__°ªam
);

292 i‡(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

293  
	`__‰ód_chk_w¨n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
, 
__°ªam
);

295  
	`__‰ód_Æüs
 (
__±r
, 
__size
, 
__n
, 
__°ªam
);

296 
	}
}

298 #ifde‡
__USE_GNU


299 *
	$__fgës_u∆ocked_chk
 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
,

300 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

301 *
	`__REDIRECT
 (
__fgës_u∆ocked_Æüs
,

302 (*
__ª°ri˘
 
__s
, 
__n
,

303 
FILE
 *
__ª°ri˘
 
__°ªam
), 
fgës_u∆ocked
Ë
__wur
;

304 *
	`__REDIRECT
 (
__fgës_u∆ocked_chk_w¨n
,

305 (*
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

306 
FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgës_u∆ocked_chk
)

307 
__wur
 
	`__w¨«âr
 ("fgets_unlocked called with bigger sizeÅhanÜength "

310 
__f‹tify_fun˘i⁄
 
__wur
 *

311 
	$fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
)

313 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

315 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

316  
	`__fgës_u∆ocked_chk
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

318 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
))

319  
	`__fgës_u∆ocked_chk_w¨n
 (
__s
, 
	`__bos
 (__s), 
__n
, 
__°ªam
);

321  
	`__fgës_u∆ocked_Æüs
 (
__s
, 
__n
, 
__°ªam
);

322 
	}
}

325 #ifde‡
__USE_MISC


326 #unde‡
‰ód_u∆ocked


327 
size_t
 
	$__‰ód_u∆ocked_chk
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

328 
size_t
 
__size
, size_à
__n
,

329 
FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

330 
size_t
 
	`__REDIRECT
 (
__‰ód_u∆ocked_Æüs
,

331 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
,

332 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
),

333 
‰ód_u∆ocked
Ë
__wur
;

334 
size_t
 
	`__REDIRECT
 (
__‰ód_u∆ocked_chk_w¨n
,

335 (*
__ª°ri˘
 
__±r
, 
size_t
 
__±æí
,

336 
size_t
 
__size
, size_à
__n
,

337 
FILE
 *
__ª°ri˘
 
__°ªam
),

338 
__‰ód_u∆ocked_chk
)

339 
__wur
 
	`__w¨«âr
 ("fread_unlocked called with bigger size *ÇmembÅhan "

342 
__f‹tify_fun˘i⁄
 
__wur
 
size_t


343 
	$‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, 
size_t
 
__size
, size_à
__n
,

344 
FILE
 *
__ª°ri˘
 
__°ªam
)

346 i‡(
	`__bos0
 (
__±r
Ë!(
size_t
) -1)

348 i‡(!
	`__buûtö_c⁄°™t_p
 (
__size
)

349 || !
	`__buûtö_c⁄°™t_p
 (
__n
)

350 || (
__size
 | 
__n
Ë>(((
size_t
) 1) << (8 *  (size_t) / 2)))

351  
	`__‰ód_u∆ocked_chk
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

352 
__°ªam
);

354 i‡(
__size
 * 
__n
 > 
	`__bos0
 (
__±r
))

355  
	`__‰ód_u∆ocked_chk_w¨n
 (
__±r
, 
	`__bos0
 (__±r), 
__size
, 
__n
,

356 
__°ªam
);

359 #ifde‡
__USE_EXTERN_INLINES


360 i‡(
	`__buûtö_c⁄°™t_p
 (
__size
)

361 && 
	`__buûtö_c⁄°™t_p
 (
__n
)

362 && (
__size
 | 
__n
Ë< (((
size_t
) 1) << (8 *  (size_t) / 2))

363 && 
__size
 * 
__n
 <= 8)

365 
size_t
 
__˙t
 = 
__size
 * 
__n
;

366 *
__˝å
 = (*Ë
__±r
;

367 i‡(
__˙t
 == 0)

370 ; 
__˙t
 > 0; --__cnt)

372 
__c
 = 
	`_IO_gëc_u∆ocked
 (
__°ªam
);

373 i‡(
__c
 =
EOF
)

375 *
__˝å
++ = 
__c
;

377  (
__˝å
 - (*Ë
__±r
Ë/ 
__size
;

380  
	`__‰ód_u∆ocked_Æüs
 (
__±r
, 
__size
, 
__n
, 
__°ªam
);

381 
	}
}

	@/usr/include/bits/stdio_lim.h

18 #i‡!
deföed
 
_STDIO_H
 && !deföed 
__√ed_FOPEN_MAX
 && !deföed 
__√ed_IOV_MAX


22 #ifde‡
_STDIO_H


23 
	#L_tm≤am
 20

	)

24 
	#TMP_MAX
 238328

	)

25 
	#FILENAME_MAX
 4096

	)

27 #ifde‡
__USE_POSIX


28 
	#L_˘îmid
 9

	)

29 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


30 
	#L_cu£rid
 9

	)

35 #i‡
deföed
 
__√ed_FOPEN_MAX
 || deföed 
_STDIO_H


36 #unde‡
FOPEN_MAX


37 
	#FOPEN_MAX
 16

	)

40 #i‡
deföed
 
__√ed_IOV_MAX
 && !deföed 
IOV_MAX


41 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/stdlib-float.h

19 #i‚de‡
_STDLIB_H


23 #ifde‡
__USE_EXTERN_INLINES


24 
__BEGIN_NAMESPACE_STD


25 
__exã∫_ölöe
 

26 
__NTH
 (
	$©of
 (c⁄° *
__≈å
))

28  
	`°πod
 (
__≈å
, (**Ë
NULL
);

29 
	}
}

30 
	g__END_NAMESPACE_STD


	@/usr/include/bits/stdlib-ldbl.h

19 #i‚de‡
_STDLIB_H


23 #ifdef 
__USE_ISOC99


24 
__BEGIN_NAMESPACE_C99


25 
	$__LDBL_REDIR1_DECL
 (
°πﬁd
, 
°πod
)

26 
__END_NAMESPACE_C99


29 #ifde‡
__USE_GNU


30 
	$__LDBL_REDIR1_DECL
 (
°πﬁd_l
, 
°πod_l
)

33 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


34 #ifde‡
__USE_MISC


35 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

36 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

39 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

19 #i‚de‡
_STDLIB_H


23 *
	$__ªÆ∑th_chk
 (c⁄° *
__ª°ri˘
 
__«me
,

24 *
__ª°ri˘
 
__ªsﬁved
,

25 
size_t
 
__ªsﬁvedÀn
Ë
__THROW
 
__wur
;

26 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_Æüs
,

27 (c⁄° *
__ª°ri˘
 
__«me
,

28 *
__ª°ri˘
 
__ªsﬁved
), 
ªÆ∑th
Ë
__wur
;

29 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_chk_w¨n
,

30 (c⁄° *
__ª°ri˘
 
__«me
,

31 *
__ª°ri˘
 
__ªsﬁved
,

32 
size_t
 
__ªsﬁvedÀn
), 
__ªÆ∑th_chk
Ë
__wur


33 
	`__w¨«âr
 ("secondárgument ofÑealpath must beÉither NULL orát "

36 
__f‹tify_fun˘i⁄
 
__wur
 *

37 
	`__NTH
 (
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
, *__ª°ri˘ 
__ªsﬁved
))

39 i‡(
	`__bos
 (
__ªsﬁved
Ë!(
size_t
) -1)

41 #i‡
deföed
 
_LIBC_LIMITS_H_
 && deföed 
PATH_MAX


42 i‡(
	`__bos
 (
__ªsﬁved
Ë< 
PATH_MAX
)

43  
	`__ªÆ∑th_chk_w¨n
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

45  
	`__ªÆ∑th_chk
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

48  
	`__ªÆ∑th_Æüs
 (
__«me
, 
__ªsﬁved
);

49 
	}
}

52 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

53 
size_t
 
__ƒól
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

54 
	`__REDIRECT_NTH
 (
__±¢ame_r_Æüs
, (
__fd
, *
__buf
,

55 
size_t
 
__buÊí
), 
±¢ame_r
)

56 
	`__n⁄nuŒ
 ((2));

57 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¨n
,

58 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

59 
size_t
 
__ƒól
), 
__±¢ame_r_chk
)

60 
	`__n⁄nuŒ
 ((2)Ë
	`__w¨«âr
 ("ptsname_r called with buflen biggerÅhan "

63 
__f‹tify_fun˘i⁄
 

64 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
))

66 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

68 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

69  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

70 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

71  
	`__±¢ame_r_chk_w¨n
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

73  
	`__±¢ame_r_Æüs
 (
__fd
, 
__buf
, 
__buÊí
);

74 
	}
}

77 
	$__w˘omb_chk
 (*
__s
, 
wch¨_t
 
__wch¨
, 
size_t
 
__buÊí
)

78 
__THROW
 
__wur
;

79 
	`__REDIRECT_NTH
 (
__w˘omb_Æüs
, (*
__s
, 
wch¨_t
 
__wch¨
),

80 
w˘omb
Ë
__wur
;

82 
__f‹tify_fun˘i⁄
 
__wur
 

83 
	`__NTH
 (
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
))

88 
	#__STDLIB_MB_LEN_MAX
 16

	)

89 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__STDLIB_MB_LEN_MAX


92 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

93  
	`__w˘omb_chk
 (
__s
, 
__wch¨
, 
	`__bos
 (__s));

94  
	`__w˘omb_Æüs
 (
__s
, 
__wch¨
);

95 
	}
}

98 
size_t
 
	$__mb°owcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

99 c⁄° *
__ª°ri˘
 
__§c
,

100 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

101 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_Æüs
,

102 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

103 c⁄° *
__ª°ri˘
 
__§c
,

104 
size_t
 
__Àn
), 
mb°owcs
);

105 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_chk_w¨n
,

106 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

107 c⁄° *
__ª°ri˘
 
__§c
,

108 
size_t
 
__Àn
, size_à
__d°Àn
), 
__mb°owcs_chk
)

109 
	`__w¨«âr
 ("mbstowcs called with dst buffer smallerÅhanÜen "

112 
__f‹tify_fun˘i⁄
 
size_t


113 
	`__NTH
 (
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° *__ª°ri˘ 
__§c
,

114 
size_t
 
__Àn
))

116 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

118 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

119  
	`__mb°owcs_chk
 (
__d°
, 
__§c
, 
__Àn
,

120 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

122 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

123  
	`__mb°owcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
,

124 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

126  
	`__mb°owcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

127 
	}
}

130 
size_t
 
	$__wc°ombs_chk
 (*
__ª°ri˘
 
__d°
,

131 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

132 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

133 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_Æüs
,

134 (*
__ª°ri˘
 
__d°
,

135 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

136 
size_t
 
__Àn
), 
wc°ombs
);

137 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_chk_w¨n
,

138 (*
__ª°ri˘
 
__d°
,

139 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

140 
size_t
 
__Àn
, size_à
__d°Àn
), 
__wc°ombs_chk
)

141 
	`__w¨«âr
 ("wcstombs called with dst buffer smallerÅhanÜen");

143 
__f‹tify_fun˘i⁄
 
size_t


144 
	`__NTH
 (
	$wc°ombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 *__ª°ri˘ 
__§c
,

145 
size_t
 
__Àn
))

147 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

149 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

150  
	`__wc°ombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

151 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

152  
	`__wc°ombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

154  
	`__wc°ombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

155 
	}
}

	@/usr/include/bits/string.h

19 #i‚de‡
_STRING_H


24 
	#_STRING_ARCH_u«lig√d
 1

	)

28 #i‡!
deföed
 
__x86_64__
 && (deföed 
__i486__
 || deföed 
__≥¡ium__
 \

29 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

30 || 
deföed
 
	g__noc⁄a__
 || deföed 
	g__©om__
 \

31 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__c‹ei7__
 \

32 || 
deföed
 
	g__k6__
 || deföed 
	g__geode__
 \

33 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

34 || 
deföed
 
	g__amdÁm10__
)

38 #i‡!
deföed
 
__NO_STRING_INLINES
 && deföed 
__USE_STRING_INLINES
 \

39 && 
deföed
 
	g__GNUC__
 && __GNUC__ >= 2

41 #i‚de‡
__STRING_INLINE


42 #i‚de‡
__exã∫_ölöe


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

50 
	#__STRING_SMALL_GET16
(
§c
, 
idx
) \

51 ((((c⁄° *Ë(
§c
))[
idx
 + 1] << 8) \

52 | ((c⁄° *Ë(
§c
))[
idx
])

	)

53 
	#__STRING_SMALL_GET32
(
§c
, 
idx
) \

54 (((((c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

55 | ((c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

56 | ((c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

57 | ((c⁄° *Ë(
§c
))[
idx
])

	)

61 
	#_HAVE_STRING_ARCH_mem˝y
 1

	)

62 
	#mem˝y
(
de°
, 
§c
, 
n
) \

63 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

64 ? 
	`__mem˝y_c
 ((
de°
), (
§c
), (
n
)) \

65 : 
	`__mem˝y_g
 ((
de°
), (
§c
), (
n
))))

	)

66 
	#__mem˝y_c
(
de°
, 
§c
, 
n
) \

67 ((
n
) == 0 \

68 ? (
de°
) \

69 : (((
n
) % 4 == 0) \

70 ? 
	`__mem˝y_by4
 (
de°
, 
§c
, 
n
) \

71 : (((
n
) % 2 == 0) \

72 ? 
	`__mem˝y_by2
 (
de°
, 
§c
, 
n
) \

73 : 
	`__mem˝y_g
 (
de°
, 
§c
, 
n
))))

	)

75 
__STRING_INLINE
 *
__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
,

76 
size_t
 
__n
);

78 
__STRING_INLINE
 *

79 
	$__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

81 
__d0
, 
__d1
;

82 *
__tmp
 = 
__de°
;

83 
__asm__
 
__vﬁ©ûe__


91 : "=&r" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

92 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 4)

94  
__de°
;

95 
	}
}

97 
__STRING_INLINE
 *
__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
,

98 
size_t
 
__n
);

100 
__STRING_INLINE
 *

101 
	$__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

103 
__d0
, 
__d1
;

104 *
__tmp
 = 
__de°
;

105 
__asm__
 
__vﬁ©ûe__


118 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

119 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 2)

121  
__de°
;

122 
	}
}

124 
__STRING_INLINE
 *
__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
);

126 
__STRING_INLINE
 *

127 
	$__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

129 
__d0
, 
__d1
, 
__d2
;

130 *
__tmp
 = 
__de°
;

131 
__asm__
 
__vﬁ©ûe__


142 : "=&c" (
__d0
), "=&D" (
__d1
), "=&S" (
__d2
),

143 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

144 : "0" (
__n
), "1" (
__tmp
), "2" (
__§c
),

145 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
)

147  
__de°
;

148 
	}
}

150 
	#_HAVE_STRING_ARCH_memmove
 1

	)

151 #i‚de‡
_FORCE_INLINES


154 
	#memmove
(
de°
, 
§c
, 
n
Ë
	`__memmove_g
 (de°, src,Ç)

	)

156 
__STRING_INLINE
 *
	$__memmove_g
 (*, c⁄° *, 
size_t
)

157 
	`__asm__
 ("memmove");

159 
__STRING_INLINE
 *

160 
	$__memmove_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

162 
__d0
, 
__d1
, 
__d2
;

163 *
__tmp
 = 
__de°
;

164 i‡(
__de°
 < 
__§c
)

165 
__asm__
 
__vﬁ©ûe__


168 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

169 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

170 : "0" (
__n
), "1" (
__§c
), "2" (
__tmp
),

171 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

173 
__asm__
 
__vﬁ©ûe__


177 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

178 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

179 : "0" (
__n
), "1" (__¿- 1 + (c⁄° *Ë
__§c
),

180 "2" (
__n
 - 1 + (*Ë
__tmp
),

181 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

182  
__de°
;

183 
	}
}

187 
	#_HAVE_STRING_ARCH_memcmp
 1

	)

188 #i‚de‡
_FORCE_INLINES


189 #i‚de‡
__PIC__


191 
__STRING_INLINE
 

192 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

194 
__d0
, 
__d1
, 
__d2
;

195 
__ªs
;

196 
__asm__
 
__vﬁ©ûe__


204 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

205 : "0" (0), "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

206 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

207 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

209  
__ªs
;

210 
	}
}

215 
	#_HAVE_STRING_ARCH_mem£t
 1

	)

216 
	#_USE_STRING_ARCH_mem£t
 1

	)

217 
	#mem£t
(
s
, 
c
, 
n
) \

218 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

219 ? ((
n
) == 1 \

220 ? 
	`__mem£t_c1
 ((
s
), (
c
)) \

221 : 
	`__mem£t_gc
 ((
s
), (
c
), (
n
))) \

222 : (
	`__buûtö_c⁄°™t_p
 (
c
) \

223 ? (
	`__buûtö_c⁄°™t_p
 (
n
) \

224 ? 
	`__mem£t_c˙
 ((
s
), (
c
), (
n
)) \

225 : 
	`mem£t
 ((
s
), (
c
), (
n
))) \

226 : (
	`__buûtö_c⁄°™t_p
 (
n
) \

227 ? 
	`__mem£t_g˙
 ((
s
), (
c
), (
n
)) \

228 : 
	`mem£t
 ((
s
), (
c
), (
n
))))))

	)

230 
	#__mem£t_c1
(
s
, 
c
Ë({ *
__s
 = (s); \

231 *((*Ë
__s
Ë(Ë(
c
); \

232 
__s
; })

	)

234 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

235 ({ *
__s
 = (
s
); \

237 
__ui
; \

238 
__usi
; \

239 
__uc
; \

240 } *
__u
 = 
__s
; \

241 
__c
 = ((Ë((Ë(
c
))) * 0x01010101; \

247 i‡((
n
) == 3 || (n) >= 5) \

248 
__asm__
 
	`__vﬁ©ûe__
 ("" : "Ù" (
__c
) : "0" (__c)); \

251 
n
) \

254 
__u
->
__ui
 = 
__c
; \

255 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

257 
__u
->
__ui
 = 
__c
; \

258 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

260 
__u
->
__ui
 = 
__c
; \

261 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

263 
__u
->
__usi
 = (Ë
__c
; \

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

265 
__u
->
__uc
 = (Ë
__c
; \

269 
__u
->
__ui
 = 
__c
; \

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

272 
__u
->
__ui
 = 
__c
; \

273 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

275 
__u
->
__ui
 = 
__c
; \

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

278 
__u
->
__usi
 = (Ë
__c
; \

282 
__u
->
__ui
 = 
__c
; \

283 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

285 
__u
->
__ui
 = 
__c
; \

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

288 
__u
->
__ui
 = 
__c
; \

289 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

291 
__u
->
__uc
 = (Ë
__c
; \

295 
__u
->
__ui
 = 
__c
; \

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

298 
__u
->
__ui
 = 
__c
; \

299 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

301 
__u
->
__ui
 = 
__c
; \

302 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

304 
__u
->
__ui
 = 
__c
; \

309 
__s
; })

	)

311 
	#__mem£t_c˙
(
s
, 
c
, 
n
) \

312 (((
n
) % 4 == 0) \

313 ? 
	`__mem£t_c˙_by4
 (
s
, ((Ë((Ë(
c
))) * 0x01010101,\

314 
n
) \

315 : (((
n
) % 2 == 0) \

316 ? 
	`__mem£t_c˙_by2
 (
s
, \

317 ((Ë((Ë(
c
))) * 0x01010101,\

318 
n
) \

319 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

321 
__STRING_INLINE
 *
__mem£t_c˙_by4
 (*
__s
, 
__c
,

322 
size_t
 
__n
);

324 
__STRING_INLINE
 *

325 
	$__mem£t_c˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

327 *
__tmp
 = 
__s
;

328 
__d0
;

329 #ifde‡
__i686__


330 
__asm__
 
__vﬁ©ûe__


333 : "=&a" (
__c
), "=&D" (
__tmp
), "=&c" (
__d0
),

334 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

335 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

338 
__asm__
 
__vﬁ©ûe__


344 : "=&r" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

345 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

346 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

349  
__s
;

350 
	}
}

352 
__STRING_INLINE
 *
__mem£t_c˙_by2
 (*
__s
, 
__c
,

353 
size_t
 
__n
);

355 
__STRING_INLINE
 *

356 
	$__mem£t_c˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

358 
__d0
, 
__d1
;

359 *
__tmp
 = 
__s
;

360 #ifde‡
__i686__


361 
__asm__
 
__vﬁ©ûe__


365 : "=&a" (
__d0
), "=&D" (
__tmp
), "=&c" (
__d1
),

366 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

367 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

370 
__asm__
 
__vﬁ©ûe__


376 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

377 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

378 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

381  
__s
;

382 
	}
}

384 
	#__mem£t_g˙
(
s
, 
c
, 
n
) \

385 (((
n
) % 4 == 0) \

386 ? 
	`__mem£t_g˙_by4
 (
s
, 
c
, 
n
) \

387 : (((
n
) % 2 == 0) \

388 ? 
	`__mem£t_g˙_by2
 (
s
, 
c
, 
n
) \

389 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

391 
__STRING_INLINE
 *
__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
);

393 
__STRING_INLINE
 *

394 
	$__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

396 *
__tmp
 = 
__s
;

397 
__d0
;

398 
__asm__
 
__vﬁ©ûe__


408 : "=&q" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

409 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

410 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

412  
__s
;

413 
	}
}

415 
__STRING_INLINE
 *
__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
);

417 
__STRING_INLINE
 *

418 
	$__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

420 
__d0
, 
__d1
;

421 *
__tmp
 = 
__s
;

422 
__asm__
 
__vﬁ©ûe__


433 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

434 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

435 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

437  
__s
;

438 
	}
}

442 
	#_HAVE_STRING_ARCH_memchr
 1

	)

443 #i‚de‡
_FORCE_INLINES


444 
__STRING_INLINE
 *

445 
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

447 
__d0
;

448 #ifde‡
__i686__


449 
__d1
;

451 *
__ªs
;

452 i‡(
__n
 == 0)

453  
NULL
;

454 #ifde‡
__i686__


455 
__asm__
 
__vﬁ©ûe__


459 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

460 : "a" (
__c
), "0" (
__s
), "1" (
__n
), "2" (1),

461 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

464 
__asm__
 
__vﬁ©ûe__


470 : "=D" (
__ªs
), "=&c" (
__d0
)

471 : "a" (
__c
), "0" (
__s
), "1" (
__n
),

472 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

475  
__ªs
 - 1;

476 
	}
}

479 
	#_HAVE_STRING_ARCH_memrchr
 1

	)

480 #i‚de‡
_FORCE_INLINES


481 
__STRING_INLINE
 *
__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
);

483 
__STRING_INLINE
 *

484 
	$__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

486 
__d0
;

487 #ifde‡
__i686__


488 
__d1
;

490 *
__ªs
;

491 i‡(
__n
 == 0)

492  
NULL
;

493 #ifde‡
__i686__


494 
__asm__
 
__vﬁ©ûe__


500 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

501 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n), "2" (-1),

502 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

505 
__asm__
 
__vﬁ©ûe__


512 : "=D" (
__ªs
), "=&c" (
__d0
)

513 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n),

514 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

517  
__ªs
;

518 
	}
}

519 #ifde‡
__USE_GNU


520 
	#memrchr
(
s
, 
c
, 
n
Ë
	`__memrchr
 ((s), (c), (n))

	)

525 
	#_HAVE_STRING_ARCH_øwmemchr
 1

	)

526 
__STRING_INLINE
 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

528 #i‚de‡
_FORCE_INLINES


529 
__STRING_INLINE
 *

530 
	$__øwmemchr
 (c⁄° *
__s
, 
__c
)

532 
__d0
;

533 *
__ªs
;

534 
__asm__
 
__vﬁ©ûe__


537 : "=D" (
__ªs
), "=&c" (
__d0
)

538 : "a" (
__c
), "0" (
__s
), "1" (0xffffffff),

539 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

541  
__ªs
 - 1;

542 
	}
}

543 #ifde‡
__USE_GNU


544 
__STRING_INLINE
 *

545 
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

547  
	`__øwmemchr
 (
__s
, 
__c
);

548 
	}
}

554 
	#_HAVE_STRING_ARCH_°æí
 1

	)

555 
	#°æí
(
°r
) \

556 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
°r
) \

557 ? 
	`__buûtö_°æí
 (
°r
) \

558 : 
	`__°æí_g
 (
°r
)))

	)

559 
__STRING_INLINE
 
size_t
 
__°æí_g
 (c⁄° *
__°r
);

561 
__STRING_INLINE
 
size_t


562 
	$__°æí_g
 (c⁄° *
__°r
)

564 
__dummy
;

565 c⁄° *
__tmp
 = 
__°r
;

566 
__asm__
 
__vﬁ©ûe__


572 : "Ù" (
__tmp
), "=&q" (
__dummy
)

573 : "0" (
__°r
),

574 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__°r
)

576  
__tmp
 - 
__°r
 - 1;

577 
	}
}

581 
	#_HAVE_STRING_ARCH_°r˝y
 1

	)

582 
	#°r˝y
(
de°
, 
§c
) \

583 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

584 ? ( ((
§c
)[0]Ë=1 && 
	`°æí
 (src) + 1 <= 8 \

585 ? 
	`__°r˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

586 : (*Ë
	`mem˝y
 ((*Ë(
de°
), \

587 (c⁄° *Ë(
§c
), \

588 
	`°æí
 (
§c
) + 1)) \

589 : 
	`__°r˝y_g
 ((
de°
), (
§c
))))

	)

591 
	#__°r˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

592 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

594 
__ui
; \

595 
__usi
; \

596 
__uc
; \

597 
__c
; \

598 } *
__u
 = (*Ë
__de°
; \

599 
§˛í
) \

602 
__u
->
__uc
 = '\0'; \

605 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

608 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

609 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

610 
__u
->
__uc
 = '\0'; \

613 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

616 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

617 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

618 
__u
->
__uc
 = '\0'; \

621 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

622 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

623 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

626 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

627 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

628 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

629 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

630 
__u
->
__uc
 = '\0'; \

633 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

635 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

638 (*Ë
__de°
; }))

	)

640 
__STRING_INLINE
 *
__°r˝y_g
 (*
__de°
, c⁄° *
__§c
);

642 
__STRING_INLINE
 *

643 
	$__°r˝y_g
 (*
__de°
, c⁄° *
__§c
)

645 *
__tmp
 = 
__de°
;

646 
__dummy
;

647 
__asm__
 
__vﬁ©ûe__


656 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
),

657 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

658 : "0" (
__§c
), "1" (
__tmp
),

659 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

661  
__de°
;

662 
	}
}

665 #ifde‡
__USE_GNU


666 
	#_HAVE_STRING_ARCH_°p˝y
 1

	)

668 
	#__°p˝y
(
de°
, 
§c
) \

669 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

670 ? (
	`°æí
 (
§c
) + 1 <= 8 \

671 ? 
	`__°p˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

672 : 
	`__°p˝y_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1)) \

673 : 
	`__°p˝y_g
 ((
de°
), (
§c
))))

	)

674 
	#__°p˝y_c
(
de°
, 
§c
, 
§˛í
) \

675 ((
§˛í
) % 4 == 0 \

676 ? 
	`__memp˝y_by4
 (
de°
, 
§c
, 
§˛í
) - 1 \

677 : ((
§˛í
) % 2 == 0 \

678 ? 
	`__memp˝y_by2
 (
de°
, 
§c
, 
§˛í
) - 1 \

679 : 
	`__memp˝y_byn
 (
de°
, 
§c
, 
§˛í
Ë- 1))

	)

682 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 ((de°), (§c))

	)

684 
	#__°p˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

685 (
	`__exãnsi⁄__
 ({ union { \

686 
__ui
; \

687 
__usi
; \

688 
__uc
; \

689 
__c
; \

690 } *
__u
 = (*Ë(
de°
); \

691 
§˛í
) \

694 
__u
->
__uc
 = '\0'; \

697 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

698 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

701 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

702 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

703 
__u
->
__uc
 = '\0'; \

706 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

707 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

710 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

711 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

712 
__u
->
__uc
 = '\0'; \

715 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

716 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

717 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

718 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

721 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

722 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

723 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

724 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

725 
__u
->
__uc
 = '\0'; \

728 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

729 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

730 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

731 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

734 (*Ë
__u
; }))

	)

736 
__STRING_INLINE
 *
__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
,

737 
size_t
 
__§˛í
);

739 
__STRING_INLINE
 *

740 
	$__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

742 *
__tmp
 = 
__de°
;

743 
__d0
, 
__d1
;

744 
__asm__
 
__vﬁ©ûe__


752 : "=&r" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

753 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4)

755  
__tmp
;

756 
	}
}

758 
__STRING_INLINE
 *
__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
,

759 
size_t
 
__§˛í
);

761 
__STRING_INLINE
 *

762 
	$__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

764 *
__tmp
 = 
__de°
;

765 
__d0
, 
__d1
;

766 
__asm__
 
__vﬁ©ûe__


779 : "=&q" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
),

780 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

781 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

782 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

784  
__tmp
 + 2;

785 
	}
}

787 
__STRING_INLINE
 *
__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
,

788 
size_t
 
__§˛í
);

790 
__STRING_INLINE
 *

791 
	$__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

793 
__d0
, 
__d1
;

794 *
__tmp
 = 
__de°
;

795 
__asm__
 
__vﬁ©ûe__


806 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

807 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

808 : "0" (
__tmp
), "1" (
__§˛í
), "2" (
__§c
),

809 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

811  
__tmp
;

812 
	}
}

814 
__STRING_INLINE
 *
__°p˝y_g
 (*
__de°
, c⁄° *
__§c
);

816 
__STRING_INLINE
 *

817 
	$__°p˝y_g
 (*
__de°
, c⁄° *
__§c
)

819 *
__tmp
 = 
__de°
;

820 
__dummy
;

821 
__asm__
 
__vﬁ©ûe__


830 : "=&r" (
__§c
), "Ù" (
__tmp
), "=&q" (
__dummy
),

831 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

832 : "0" (
__§c
), "1" (
__tmp
),

833 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

835  
__tmp
 - 1;

836 
	}
}

841 
	#_HAVE_STRING_ARCH_°∫˝y
 1

	)

842 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

843 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

844 ? ((
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

845 ? (*Ë
	`mem˝y
 ((*Ë(
de°
), \

846 (c⁄° *Ë(
§c
), 
n
) \

847 : 
	`__°∫˝y_cg
 ((
de°
), (
§c
), 
	`°æí
 (§cË+ 1, 
n
))) \

848 : 
	`__°∫˝y_gg
 ((
de°
), (
§c
), 
n
)))

	)

849 
	#__°∫˝y_cg
(
de°
, 
§c
, 
§˛í
, 
n
) \

850 (((
§˛í
) % 4 == 0) \

851 ? 
	`__°∫˝y_by4
 (
de°
, 
§c
, 
§˛í
, 
n
) \

852 : (((
§˛í
) % 2 == 0) \

853 ? 
	`__°∫˝y_by2
 (
de°
, 
§c
, 
§˛í
, 
n
) \

854 : 
	`__°∫˝y_byn
 (
de°
, 
§c
, 
§˛í
, 
n
)))

	)

856 
__STRING_INLINE
 *
__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[],

857 
size_t
 
__§˛í
, size_à
__n
);

859 
__STRING_INLINE
 *

860 
	$__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

862 *
__tmp
 = 
__de°
;

863 
__dummy1
, 
__dummy2
;

864 
__asm__
 
__vﬁ©ûe__


872 : "=&r" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

873 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

874 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4),

875 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

877 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

878  
__de°
;

879 
	}
}

881 
__STRING_INLINE
 *
__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[],

882 
size_t
 
__§˛í
, size_à
__n
);

884 
__STRING_INLINE
 *

885 
	$__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

887 *
__tmp
 = 
__de°
;

888 
__dummy1
, 
__dummy2
;

889 
__asm__
 
__vﬁ©ûe__


902 : "=&q" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

903 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

904 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

905 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

907 (Ë
	`mem£t
 (
__tmp
 + 2, '\0', 
__n
 - 
__§˛í
);

908  
__de°
;

909 
	}
}

911 
__STRING_INLINE
 *
__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[],

912 
size_t
 
__§˛í
, size_à
__n
);

914 
__STRING_INLINE
 *

915 
	$__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

917 
__d0
, 
__d1
;

918 *
__tmp
 = 
__de°
;

919 
__asm__
 
__vﬁ©ûe__


930 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

931 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

932 : "1" (
__§˛í
), "0" (
__tmp
),"2" (
__§c
),

933 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

935 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

936  
__de°
;

937 
	}
}

939 
__STRING_INLINE
 *
__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
,

940 
size_t
 
__n
);

942 
__STRING_INLINE
 *

943 
	$__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

945 *
__tmp
 = 
__de°
;

946 
__dummy
;

947 i‡(
__n
 > 0)

948 
__asm__
 
__vﬁ©ûe__


964 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
), "=&r" (
__n
)

965 : "0" (
__§c
), "1" (
__tmp
), "3" (
__n
)

968  
__de°
;

969 
	}
}

973 
	#_HAVE_STRING_ARCH_°rˇt
 1

	)

974 
	#°rˇt
(
de°
, 
§c
) \

975 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

976 ? 
	`__°rˇt_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

977 : 
	`__°rˇt_g
 ((
de°
), (
§c
))))

	)

979 
__STRING_INLINE
 *
__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[],

980 
size_t
 
__§˛í
);

982 
__STRING_INLINE
 *

983 
	$__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
)

985 #ifde‡
__i686__


986 
__d0
;

987 *
__tmp
;

988 
__asm__
 
__vﬁ©ûe__


990 : "=D" (
__tmp
), "=&c" (
__d0
),

991 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

992 : "0" (
__de°
), "1" (0xffffffff), "a" (0),

993 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

995 --
__tmp
;

997 *
__tmp
 = 
__de°
 - 1;

998 
__asm__
 
__vﬁ©ûe__


1003 : "Ù" (
__tmp
),

1004 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1005 : "0" (
__tmp
),

1006 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

1009 (Ë
	`mem˝y
 (
__tmp
, 
__§c
, 
__§˛í
);

1010  
__de°
;

1011 
	}
}

1013 
__STRING_INLINE
 *
__°rˇt_g
 (*
__de°
, c⁄° *
__§c
);

1015 
__STRING_INLINE
 *

1016 
	$__°rˇt_g
 (*
__de°
, c⁄° *
__§c
)

1018 *
__tmp
 = 
__de°
 - 1;

1019 
__dummy
;

1020 
__asm__
 
__vﬁ©ûe__


1032 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
),

1033 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1034 : "1" (
__tmp
), "2" (
__§c
),

1035 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

1037  
__de°
;

1038 
	}
}

1042 
	#_HAVE_STRING_ARCH_°∫ˇt
 1

	)

1043 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

1044 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

1045 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

1046 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

1047 ? 
	`°rˇt
 (
__de°
, (
§c
)) \

1048 : (*(*)
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

1049 (c⁄° *Ë(
§c
), \

1050 (
n
)Ë0, 
__de°
)) \

1051 : 
	`__°∫ˇt_g
 (
__de°
, (
§c
), (
n
)); }))

	)

1053 
__STRING_INLINE
 *
__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[],

1054 
size_t
 
__n
);

1056 
__STRING_INLINE
 *

1057 
	$__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__n
)

1059 *
__tmp
 = 
__de°
;

1060 
__dummy
;

1061 #ifde‡
__i686__


1062 
__asm__
 
__vﬁ©ûe__


1076 : "=&a" (
__dummy
), "=&D" (
__tmp
), "=&S" (
__§c
), "=&c" (
__n
)

1077 : "g" (
__n
), "0" (0), "1" (
__tmp
), "2" (
__§c
), "3" (0xffffffff)

1080 --
__tmp
;

1081 
__asm__
 
__vﬁ©ûe__


1098 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__n
)

1099 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
)

1102  
__de°
;

1103 
	}
}

1107 
	#_HAVE_STRING_ARCH_°rcmp
 1

	)

1108 
	#°rcmp
(
s1
, 
s2
) \

1109 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

1110 && ( ((
s1
)[0]Ë!1 || 
	`°æí
 (s1) >= 4) \

1111 && ( ((
s2
)[0]Ë!1 || 
	`°æí
 (s2) >= 4) \

1112 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

1113 (
	`°æí
 (
s1
Ë< såÀ¿(
s2
) \

1114 ? 
	`°æí
 (
s1
Ë: såÀ¿(
s2
)) + 1) \

1115 : (
	`__buûtö_c⁄°™t_p
 (
s1
) &&  ((s1)[0]) == 1 \

1116 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (
s1
) < 4 \

1117 ? (
	`__buûtö_c⁄°™t_p
 (
s2
) &&  ((s2)[0]) == 1 \

1118 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1119 (c⁄° *Ë(
s2
), \

1120 
	`°æí
 (
s1
)) \

1121 : 
	`__°rcmp_cg
 ((c⁄° *Ë(
s1
), \

1122 (c⁄° *Ë(
s2
), \

1123 
	`°æí
 (
s1
))) \

1124 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&&  ((
s1
)[0]) == 1 \

1125 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (s2) < 4 \

1126 ? (
	`__buûtö_c⁄°™t_p
 (
s1
) \

1127 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1128 (c⁄° *Ë(
s2
), \

1129 
	`°æí
 (
s2
)) \

1130 : 
	`__°rcmp_gc
 ((c⁄° *Ë(
s1
), \

1131 (c⁄° *Ë(
s2
), \

1132 
	`°æí
 (
s2
))) \

1133 : 
	`__°rcmp_gg
 ((
s1
), (
s2
))))))

	)

1135 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

1136 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = (
s1
)[0] - (
s2
)[0]; \

1137 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

1139 
__ªsu…
 = (
s1
)[1] - (
s2
)[1]; \

1140 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

1142 
__ªsu…
 = (
s1
)[2] - (
s2
)[2]; \

1143 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

1144 
__ªsu…
 = (
s1
)[3] - (
s2
)[3]; \

1147 
__ªsu…
; }))

	)

1149 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

1150 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = (
s2
); \

1151 
__ªsu…
 = (
s1
)[0] - 
__s2
[0]; \

1152 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

1154 
__ªsu…
 = (
s1
)[1] - 
__s2
[1]; \

1155 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

1157 
__ªsu…
 = (
s1
)[2] - 
__s2
[2]; \

1158 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

1159 
__ªsu…
 = (
s1
)[3] - 
__s2
[3]; \

1162 
__ªsu…
; }))

	)

1164 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

1165 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = (
s1
); \

1166 
__ªsu…
 = 
__s1
[0] - (
s2
)[0]; \

1167 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

1169 
__ªsu…
 = 
__s1
[1] - (
s2
)[1]; \

1170 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

1172 
__ªsu…
 = 
__s1
[2] - (
s2
)[2]; \

1173 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

1174 
__ªsu…
 = 
__s1
[3] - (
s2
)[3]; \

1177 
__ªsu…
; }))

	)

1179 
__STRING_INLINE
 
__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
);

1181 
__STRING_INLINE
 

1182 
	$__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
)

1184 
__ªs
;

1185 
__asm__
 
__vﬁ©ûe__


1201 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
)

1202 : "1" (
__s1
), "2" (
__s2
),

1203 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s1
),

1204 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s2
)

1206  
__ªs
;

1207 
	}
}

1211 
	#_HAVE_STRING_ARCH_°∫cmp
 1

	)

1212 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

1213 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`°æí
 (s1Ë< ((
size_t
Ë(
n
)) \

1214 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1215 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`°æí
 (s2Ë< ((
size_t
Ë(
n
))\

1216 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1217 : 
	`__°∫cmp_g
 ((
s1
), (
s2
), (
n
)))))

	)

1219 
__STRING_INLINE
 
__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
,

1220 
size_t
 
__n
);

1222 
__STRING_INLINE
 

1223 
	$__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

1225 
__ªs
;

1226 
__asm__
 
__vﬁ©ûe__


1245 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
), "=&r" (
__n
)

1246 : "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

1247 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

1248 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

1250  
__ªs
;

1251 
	}
}

1255 
	#_HAVE_STRING_ARCH_°rchr
 1

	)

1256 
	#_USE_STRING_ARCH_°rchr
 1

	)

1257 
	#°rchr
(
s
, 
c
) \

1258 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1259 ? ((
c
) == '\0' \

1260 ? (*Ë
	`__øwmemchr
 ((
s
), (
c
)) \

1261 : 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1262 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1264 
__STRING_INLINE
 *
__°rchr_c
 (c⁄° *
__s
, 
__c
);

1266 
__STRING_INLINE
 *

1267 
	$__°rchr_c
 (c⁄° *
__s
, 
__c
)

1269 
__d0
;

1270 *
__ªs
;

1271 
__asm__
 
__vﬁ©ûe__


1281 : "Ù" (
__ªs
), "=&a" (
__d0
)

1282 : "0" (
__s
), "1" (
__c
),

1283 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1285  
__ªs
;

1286 
	}
}

1288 
__STRING_INLINE
 *
__°rchr_g
 (c⁄° *
__s
, 
__c
);

1290 
__STRING_INLINE
 *

1291 
	$__°rchr_g
 (c⁄° *
__s
, 
__c
)

1293 
__d0
;

1294 *
__ªs
;

1295 
__asm__
 
__vﬁ©ûe__


1306 : "Ù" (
__ªs
), "=&a" (
__d0
)

1307 : "0" (
__s
), "1" (
__c
),

1308 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1310  
__ªs
;

1311 
	}
}

1315 
	#_HAVE_STRING_ARCH_°rch∫ul
 1

	)

1316 
	#__°rch∫ul
(
s
, 
c
) \

1317 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1318 ? ((
c
) == '\0' \

1319 ? (*Ë
	`__øwmemchr
 ((
s
), 
c
) \

1320 : 
	`__°rch∫ul_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1321 : 
	`__°rch∫ul_g
 ((
s
), 
c
)))

	)

1323 
__STRING_INLINE
 *
__°rch∫ul_c
 (c⁄° *
__s
, 
__c
);

1325 
__STRING_INLINE
 *

1326 
	$__°rch∫ul_c
 (c⁄° *
__s
, 
__c
)

1328 
__d0
;

1329 *
__ªs
;

1330 
__asm__
 
__vﬁ©ûe__


1340 : "Ù" (
__ªs
), "=&a" (
__d0
)

1341 : "0" (
__s
), "1" (
__c
),

1342 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1344  
__ªs
;

1345 
	}
}

1347 
__STRING_INLINE
 *
__°rch∫ul_g
 (c⁄° *
__s
, 
__c
);

1349 
__STRING_INLINE
 *

1350 
	$__°rch∫ul_g
 (c⁄° *
__s
, 
__c
)

1352 
__d0
;

1353 *
__ªs
;

1354 
__asm__
 
__vﬁ©ûe__


1365 : "Ù" (
__ªs
), "=&a" (
__d0
)

1366 : "0" (
__s
), "1" (
__c
),

1367 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1369  
__ªs
;

1370 
	}
}

1371 #ifde‡
__USE_GNU


1372 
	#°rch∫ul
(
s
, 
c
Ë
	`__°rch∫ul
 ((s), (c))

	)

1376 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1378 
	#_HAVE_STRING_ARCH_ödex
 1

	)

1379 
	#ödex
(
s
, 
c
) \

1380 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1381 ? 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1382 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1387 
	#_HAVE_STRING_ARCH_°ºchr
 1

	)

1388 
	#°ºchr
(
s
, 
c
) \

1389 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1390 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1391 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1393 #ifde‡
__i686__


1394 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1396 
__STRING_INLINE
 *

1397 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1399 
__d0
, 
__d1
;

1400 *
__ªs
;

1401 
__asm__
 
__vﬁ©ûe__


1409 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1410 : "0" (1), "1" (
__s
), "2" (
__c
),

1411 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1413  
__ªs
 - 1;

1414 
	}
}

1416 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1418 
__STRING_INLINE
 *

1419 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1421 
__d0
, 
__d1
;

1422 *
__ªs
;

1423 
__asm__
 
__vﬁ©ûe__


1432 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1433 : "0" (1), "1" (
__s
), "2" (
__c
),

1434 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1436  
__ªs
 - 1;

1437 
	}
}

1439 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1441 
__STRING_INLINE
 *

1442 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1444 
__d0
, 
__d1
;

1445 *
__ªs
;

1446 
__asm__
 
__vﬁ©ûe__


1456 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1457 : "0" (0), "1" (
__s
), "2" (
__c
),

1458 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1460  
__ªs
;

1461 
	}
}

1463 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1465 
__STRING_INLINE
 *

1466 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1468 
__d0
, 
__d1
;

1469 *
__ªs
;

1470 
__asm__
 
__vﬁ©ûe__


1481 : "Ù" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1482 : "0" (0), "1" (
__s
), "2" (
__c
),

1483 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1485  
__ªs
;

1486 
	}
}

1490 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1492 
	#_HAVE_STRING_ARCH_rödex
 1

	)

1493 
	#rödex
(
s
, 
c
) \

1494 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1495 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1496 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1502 
	#_HAVE_STRING_ARCH_°rc•n
 1

	)

1503 
	#°rc•n
(
s
, 
ªje˘
) \

1504 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
) &&  ((reject)[0]) == 1 \

1505 ? ((
ªje˘
)[0] == '\0' \

1506 ? 
	`°æí
 (
s
) \

1507 : ((
ªje˘
)[1] == '\0' \

1508 ? 
	`__°rc•n_c1
 ((
s
), (((
ªje˘
)[0] << 8) & 0xff00)) \

1509 : 
	`__°rc•n_cg
 ((
s
), (
ªje˘
), 
	`°æí
 (reject)))) \

1510 : 
	`__°rc•n_g
 ((
s
), (
ªje˘
))))

	)

1512 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

1514 #i‚de‡
_FORCE_INLINES


1515 
__STRING_INLINE
 
size_t


1516 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

1518 
__d0
;

1519 *
__ªs
;

1520 
__asm__
 
__vﬁ©ûe__


1529 : "Ù" (
__ªs
), "=&a" (
__d0
)

1530 : "0" (
__s
), "1" (
__ªje˘
),

1531 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1533  (
__ªs
 - 1Ë- 
__s
;

1534 
	}
}

1537 
__STRING_INLINE
 
size_t
 
__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[],

1538 
size_t
 
__ªje˘_Àn
);

1540 
__STRING_INLINE
 
size_t


1541 
	$__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[], 
size_t
 
__ªje˘_Àn
)

1543 
__d0
, 
__d1
, 
__d2
;

1544 c⁄° *
__ªs
;

1545 
__asm__
 
__vﬁ©ûe__


1556 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1557 : "0" (
__s
), "d" (
__ªje˘
), "g" (
__ªje˘_Àn
)

1559  (
__ªs
 - 1Ë- 
__s
;

1560 
	}
}

1562 
__STRING_INLINE
 
size_t
 
__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
);

1563 #ifde‡
__PIC__


1565 
__STRING_INLINE
 
size_t


1566 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1568 
__d0
, 
__d1
, 
__d2
;

1569 c⁄° *
__ªs
;

1570 
__asm__
 
__vﬁ©ûe__


1587 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1588 : "r" (
__ªje˘
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1590  (
__ªs
 - 1Ë- 
__s
;

1591 
	}
}

1593 
__STRING_INLINE
 
size_t


1594 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1596 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1597 c⁄° *
__ªs
;

1598 
__asm__
 
__vﬁ©ûe__


1612 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1613 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ªje˘
), "b" (__reject)

1616  (
__ªs
 - 1Ë- 
__s
;

1617 
	}
}

1623 
	#_HAVE_STRING_ARCH_°r•n
 1

	)

1624 
	#°r•n
(
s
, 
ac˚±
) \

1625 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1626 ? ((
ac˚±
)[0] == '\0' \

1627 ? ((Ë(
s
), 0) \

1628 : ((
ac˚±
)[1] == '\0' \

1629 ? 
	`__°r•n_c1
 ((
s
), (((
ac˚±
)[0] << 8 ) & 0xff00)) \

1630 : 
	`__°r•n_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1631 : 
	`__°r•n_g
 ((
s
), (
ac˚±
))))

	)

1633 #i‚de‡
_FORCE_INLINES


1634 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1636 
__STRING_INLINE
 
size_t


1637 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1639 
__d0
;

1640 *
__ªs
;

1642 
__asm__
 
__vﬁ©ûe__


1648 : "Ù" (
__ªs
), "=&q" (
__d0
)

1649 : "0" (
__s
), "1" (
__ac˚±
),

1650 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1652  (
__ªs
 - 1Ë- 
__s
;

1653 
	}
}

1656 
__STRING_INLINE
 
size_t
 
__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1657 
size_t
 
__ac˚±_Àn
);

1659 
__STRING_INLINE
 
size_t


1660 
	$__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1662 
__d0
, 
__d1
, 
__d2
;

1663 c⁄° *
__ªs
;

1664 
__asm__
 
__vﬁ©ûe__


1675 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1676 : "0" (
__s
), "g" (
__ac˚±
), "g" (
__ac˚±_Àn
),

1679 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
),

1680 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__ac˚±_Àn
]; } *)
__ac˚±
)

1682  (
__ªs
 - 1Ë- 
__s
;

1683 
	}
}

1685 
__STRING_INLINE
 
size_t
 
__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1686 #ifde‡
__PIC__


1688 
__STRING_INLINE
 
size_t


1689 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1691 
__d0
, 
__d1
, 
__d2
;

1692 c⁄° *
__ªs
;

1693 
__asm__
 
__vﬁ©ûe__


1709 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1710 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (__accept)

1712  (
__ªs
 - 1Ë- 
__s
;

1713 
	}
}

1715 
__STRING_INLINE
 
size_t


1716 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1718 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1719 c⁄° *
__ªs
;

1720 
__asm__
 
__vﬁ©ûe__


1734 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1735 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ac˚±
), "b" (__accept)

1737  (
__ªs
 - 1Ë- 
__s
;

1738 
	}
}

1743 
	#_HAVE_STRING_ARCH_°Ωbrk
 1

	)

1744 
	#°Ωbrk
(
s
, 
ac˚±
) \

1745 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1746 ? ((
ac˚±
)[0] == '\0' \

1747 ? ((Ë(
s
), (*) 0) \

1748 : ((
ac˚±
)[1] == '\0' \

1749 ? 
	`°rchr
 ((
s
), (
ac˚±
)[0]) \

1750 : 
	`__°Ωbrk_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1751 : 
	`__°Ωbrk_g
 ((
s
), (
ac˚±
))))

	)

1753 
__STRING_INLINE
 *
__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1754 
size_t
 
__ac˚±_Àn
);

1756 
__STRING_INLINE
 *

1757 
	$__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1759 
__d0
, 
__d1
, 
__d2
;

1760 *
__ªs
;

1761 
__asm__
 
__vﬁ©ûe__


1776 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1777 : "0" (
__s
), "d" (
__ac˚±
), "g" (
__ac˚±_Àn
)

1779  
__ªs
;

1780 
	}
}

1782 
__STRING_INLINE
 *
__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1783 #ifde‡
__PIC__


1785 
__STRING_INLINE
 *

1786 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1788 
__d0
, 
__d1
, 
__d2
;

1789 *
__ªs
;

1790 
__asm__
 
__vﬁ©ûe__


1811 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1812 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1814  
__ªs
;

1815 
	}
}

1817 
__STRING_INLINE
 *

1818 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1820 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1821 *
__ªs
;

1822 
__asm__
 
__vﬁ©ûe__


1841 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

1842 : "0" (
__s
), "1" (0), "2" (0xffffffff), "b" (
__ac˚±
)

1844  
__ªs
;

1845 
	}
}

1850 
	#_HAVE_STRING_ARCH_°r°r
 1

	)

1851 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1852 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
) &&  ((needle)[0]) == 1 \

1853 ? ((
√edÀ
)[0] == '\0' \

1854 ? (
hay°ack
) \

1855 : ((
√edÀ
)[1] == '\0' \

1856 ? 
	`°rchr
 ((
hay°ack
), (
√edÀ
)[0]) \

1857 : 
	`__°r°r_cg
 ((
hay°ack
), (
√edÀ
), \

1858 
	`°æí
 (
√edÀ
)))) \

1859 : 
	`__°r°r_g
 ((
hay°ack
), (
√edÀ
))))

	)

1863 
__STRING_INLINE
 *
__°r°r_cg
 (c⁄° *
__hay°ack
,

1864 c⁄° 
__√edÀ
[],

1865 
size_t
 
__√edÀ_Àn
);

1867 
__STRING_INLINE
 *

1868 
	$__°r°r_cg
 (c⁄° *
__hay°ack
, c⁄° 
__√edÀ
[],

1869 
size_t
 
__√edÀ_Àn
)

1871 
__d0
, 
__d1
, 
__d2
;

1872 *
__ªs
;

1873 
__asm__
 
__vﬁ©ûe__


1886 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

1887 : "g" (
__√edÀ_Àn
), "1" (
__hay°ack
), "d" (
__√edÀ
)

1889  
__ªs
;

1890 
	}
}

1892 
__STRING_INLINE
 *
__°r°r_g
 (c⁄° *
__hay°ack
,

1893 c⁄° *
__√edÀ
);

1894 #ifde‡
__PIC__


1896 
__STRING_INLINE
 *

1897 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1899 
__d0
, 
__d1
, 
__d2
;

1900 *
__ªs
;

1901 
__asm__
 
__vﬁ©ûe__


1920 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

1921 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1922 "d" (
__√edÀ
)

1924  
__ªs
;

1925 
	}
}

1927 
__STRING_INLINE
 *

1928 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1930 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1931 *
__ªs
;

1932 
__asm__
 
__vﬁ©ûe__


1949 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1950 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1951 "b" (
__√edÀ
)

1953  
__ªs
;

1954 
	}
}

1960 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1961 #ifde‡
__i686__


1962 
	#_HAVE_STRING_ARCH_ffs
 1

	)

1963 
	#ffs
(
w‹d
Ë(
	`__buûtö_c⁄°™t_p
 (word) \

1964 ? 
	`__buûtö_ffs
 (
w‹d
) \

1965 : ({ 
__˙t
, 
__tmp
; \

1966 
__asm__
 
__vﬁ©ûe__
 \

1969 : "=&r" (
__˙t
), "Ù" (
__tmp
) \

1970 : "rm" (
w‹d
), "1" (-1)); \

1971 
__˙t
 + 1; }))

	)

1973 #i‚de‡
ff¶


1974 
	#ff¶
(
w‹d
Ë
	`ffs
(w‹d)

	)

1979 #i‚de‡
_FORCE_INLINES


1980 #unde‡
__STRING_INLINE


	@/usr/include/bits/string2.h

20 #i‚de‡
_STRING_H


24 #i‚de‡
__NO_STRING_INLINES


41 #i‚de‡
__STRING_INLINE


42 #ifde‡
__˝lu•lus


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

49 #i‡
_STRING_ARCH_u«lig√d


51 
	~<ídün.h
>

52 
	~<bôs/ty≥s.h
>

54 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


55 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

56 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1] << 8 \

57 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

58 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

59 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

60 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

61 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

62 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

64 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

65 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

66 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1])

	)

67 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

68 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

69 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

70 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

71 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3])

	)

76 
	#__STRING2_COPY_TYPE
(
N
) \

77 °ru˘ { 
__¨r
[
N
]; } \

78 
	t__©åibuã__
 ((
	t__∑cked__
)Ë
	t__STRING2_COPY_ARR
##
	tN


	)

79 
	t__STRING2_COPY_TYPE
 (2);

80 
__STRING2_COPY_TYPE
 (3);

81 
__STRING2_COPY_TYPE
 (4);

82 
__STRING2_COPY_TYPE
 (5);

83 
__STRING2_COPY_TYPE
 (6);

84 
__STRING2_COPY_TYPE
 (7);

85 
__STRING2_COPY_TYPE
 (8);

86 #unde‡
__STRING2_COPY_TYPE


92 
	#__°rög2_1b±r_p
(
__x
) \

93 ((
size_t
)(c⁄° *)((
__x
Ë+ 1Ë- (size_t)(c⁄° *)(__xË=1)

	)

96 #i‡!
deföed
 
_HAVE_STRING_ARCH_mem£t


97 #i‡!
__GNUC_PREREQ
 (3, 0)

98 #i‡
_STRING_ARCH_u«lig√d


99 
	#mem£t
(
s
, 
c
, 
n
) \

100 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

101 ? ((
n
) == 1 \

102 ? 
	`__mem£t_1
 (
s
, 
c
) \

103 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

104 : (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

105 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

106 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

108 
	#__mem£t_1
(
s
, 
c
Ë({ *
__s
 = (s); \

109 *((
__uöt8_t
 *Ë
__s
Ë(__uöt8_tË
c
; __s; })

	)

111 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

112 ({ *
__s
 = (
s
); \

114 
__ui
; \

115 
__usi
; \

116 
__uc
; \

117 } *
__u
 = 
__s
; \

118 
__uöt8_t
 
__c
 = (__uöt8_tË(
c
); \

121 (Ë(
n
)) \

124 
__u
->
__ui
 = 
__c
 * 0x01010101; \

125 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

127 
__u
->
__ui
 = 
__c
 * 0x01010101; \

128 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

130 
__u
->
__ui
 = 
__c
 * 0x01010101; \

131 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

133 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

134 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

135 
__u
->
__uc
 = (Ë
__c
; \

139 
__u
->
__ui
 = 
__c
 * 0x01010101; \

140 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

142 
__u
->
__ui
 = 
__c
 * 0x01010101; \

143 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

145 
__u
->
__ui
 = 
__c
 * 0x01010101; \

146 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

148 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

152 
__u
->
__ui
 = 
__c
 * 0x01010101; \

153 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

155 
__u
->
__ui
 = 
__c
 * 0x01010101; \

156 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

158 
__u
->
__ui
 = 
__c
 * 0x01010101; \

159 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

161 
__u
->
__uc
 = (Ë
__c
; \

165 
__u
->
__ui
 = 
__c
 * 0x01010101; \

166 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

168 
__u
->
__ui
 = 
__c
 * 0x01010101; \

169 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

171 
__u
->
__ui
 = 
__c
 * 0x01010101; \

172 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

174 
__u
->
__ui
 = 
__c
 * 0x01010101; \

179 
__s
; })

	)

181 
	#mem£t
(
s
, 
c
, 
n
) \

182 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

183 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

184 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

193 #i‡
__GNUC_PREREQ
 (2, 91)

194 
	#__bzîo
(
s
, 
n
Ë
	`__buûtö_mem£t
 (s, '\0',Ç)

	)

202 #ifde‡
__USE_GNU


203 #i‡!
deföed
 
_HAVE_STRING_ARCH_memp˝y
 || deföed 
_FORCE_INLINES


204 #i‚de‡
_HAVE_STRING_ARCH_memp˝y


205 #i‡
__GNUC_PREREQ
 (3, 4)

206 
	#__memp˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_memp˝y
 (de°, src,Ç)

	)

207 #ñi‡
__GNUC_PREREQ
 (3, 0)

208 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

209 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

210 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

211 ? 
	`__buûtö_mem˝y
 (
de°
, 
§c
, 
n
) + (n) \

212 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

214 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

215 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

216 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

217 ? 
	`__memp˝y_smÆl
 (
de°
, 
	`__memp˝y_¨gs
 (
§c
), 
n
) \

218 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

222 
	#memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y
 (de°, src,Ç)

	)

225 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


226 #i‡
_STRING_ARCH_u«lig√d


227 #i‚de‡
_FORCE_INLINES


228 
	#__memp˝y_¨gs
(
§c
) \

229 ((c⁄° *Ë(
§c
))[0], ((const *) (src))[2], \

230 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[6], \

231 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

232 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

233 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

234 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

236 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , , , ,

237 
__uöt16_t
, __uöt16_t, 
__uöt32_t
,

238 
__uöt32_t
, 
size_t
);

239 
__STRING_INLINE
 *

240 
	$__memp˝y_smÆl
 (*
__de°1
,

241 
__§c0_1
, 
__§c2_1
, 
__§c4_1
, 
__§c6_1
,

242 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

243 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

244 
size_t
 
__§˛í
)

247 
__uöt32_t
 
__ui
;

248 
__uöt16_t
 
__usi
;

249 
__uc
;

250 
__c
;

251 } *
__u
 = 
__de°1
;

252 (Ë
__§˛í
)

255 
__u
->
__c
 = 
__§c0_1
;

256 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

259 
__u
->
__usi
 = 
__§c0_2
;

260 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

263 
__u
->
__usi
 = 
__§c0_2
;

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

265 
__u
->
__c
 = 
__§c2_1
;

266 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

269 
__u
->
__ui
 = 
__§c0_4
;

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

273 
__u
->
__ui
 = 
__§c0_4
;

274 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

275 
__u
->
__c
 = 
__§c4_1
;

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

279 
__u
->
__ui
 = 
__§c0_4
;

280 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

281 
__u
->
__usi
 = 
__§c4_2
;

282 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

285 
__u
->
__ui
 = 
__§c0_4
;

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

287 
__u
->
__usi
 = 
__§c4_2
;

288 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

289 
__u
->
__c
 = 
__§c6_1
;

290 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

293 
__u
->
__ui
 = 
__§c0_4
;

294 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

295 
__u
->
__ui
 = 
__§c4_4
;

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

299  (*Ë
__u
;

300 
	}
}

302 #i‚de‡
_FORCE_INLINES


303 
	#__memp˝y_¨gs
(
§c
) \

304 ((c⁄° *Ë(
§c
))[0], \

305 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

306 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1] } }), \

307 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

308 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

309 ((c⁄° *Ë(
§c
))[2] } }), \

310 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

311 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

312 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3] } }), \

313 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

314 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

315 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

316 ((c⁄° *Ë(
§c
))[4] } }), \

317 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

318 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

319 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

320 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5] } }), \

321 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

322 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

323 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

324 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

325 ((c⁄° *Ë(
§c
))[6] } }), \

326 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

327 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

328 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

329 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

330 ((c⁄° *Ë(
§c
))[6], ((c⁄° *Ë(§c))[7] } })

	)

332 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , 
__STRING2_COPY_ARR2
,

333 
__STRING2_COPY_ARR3
,

334 
__STRING2_COPY_ARR4
,

335 
__STRING2_COPY_ARR5
,

336 
__STRING2_COPY_ARR6
,

337 
__STRING2_COPY_ARR7
,

338 
__STRING2_COPY_ARR8
, 
size_t
);

339 
__STRING_INLINE
 *

340 
	$__memp˝y_smÆl
 (*
__de°
, 
__§c1
,

341 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

342 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

343 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

344 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

347 
__c
;

348 
__STRING2_COPY_ARR2
 
__sˇ2
;

349 
__STRING2_COPY_ARR3
 
__sˇ3
;

350 
__STRING2_COPY_ARR4
 
__sˇ4
;

351 
__STRING2_COPY_ARR5
 
__sˇ5
;

352 
__STRING2_COPY_ARR6
 
__sˇ6
;

353 
__STRING2_COPY_ARR7
 
__sˇ7
;

354 
__STRING2_COPY_ARR8
 
__sˇ8
;

355 } *
__u
 = 
__de°
;

356 (Ë
__§˛í
)

359 
__u
->
__c
 = 
__§c1
;

362 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

365 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

368 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

371 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

374 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

377 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

380 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

383  
	`__exãnsi⁄__
 ((*Ë
__u
 + 
__§˛í
);

384 
	}
}

392 #i‚de‡
_HAVE_STRING_ARCH_°rchr


393 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

394 #i‡
__GNUC_PREREQ
 (3, 2)

395 
	#°rchr
(
s
, 
c
) \

396 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
Ë&& !__buûtö_c⁄°™t_∞(
s
) \

397 && (
c
) == '\0' \

398 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

399 : 
	`__buûtö_°rchr
 (
s
, 
c
)))

	)

401 
	#°rchr
(
s
, 
c
) \

402 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

403 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

404 : 
	`°rchr
 (
s
, 
c
)))

	)

410 #i‡(!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)) \

411 || 
deföed
 
	g_FORCE_INLINES


412 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)

413 
	#°r˝y
(
de°
, 
§c
) \

414 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

415 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

416 ? 
	`__°r˝y_smÆl
 (
de°
, 
	`__°r˝y_¨gs
 (
§c
), \

417 
	`°æí
 (
§c
) + 1) \

418 : (*Ë
	`mem˝y
 (
de°
, 
§c
, 
	`°æí
 (src) + 1)) \

419 : 
	`°r˝y
 (
de°
, 
§c
)))

	)

422 #i‡
_STRING_ARCH_u«lig√d


423 #i‚de‡
_FORCE_INLINES


424 
	#__°r˝y_¨gs
(
§c
) \

425 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

426 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

427 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

428 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

430 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

431 
__uöt32_t
, __uöt32_t, 
size_t
);

432 
__STRING_INLINE
 *

433 
	$__°r˝y_smÆl
 (*
__de°
,

434 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

435 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

436 
size_t
 
__§˛í
)

439 
__uöt32_t
 
__ui
;

440 
__uöt16_t
 
__usi
;

441 
__uc
;

442 } *
__u
 = (*Ë
__de°
;

443 (Ë
__§˛í
)

446 
__u
->
__uc
 = '\0';

449 
__u
->
__usi
 = 
__§c0_2
;

452 
__u
->
__usi
 = 
__§c0_2
;

453 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

454 
__u
->
__uc
 = '\0';

457 
__u
->
__ui
 = 
__§c0_4
;

460 
__u
->
__ui
 = 
__§c0_4
;

461 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

462 
__u
->
__uc
 = '\0';

465 
__u
->
__ui
 = 
__§c0_4
;

466 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

467 
__u
->
__usi
 = 
__§c4_2
;

470 
__u
->
__ui
 = 
__§c0_4
;

471 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

472 
__u
->
__usi
 = 
__§c4_2
;

473 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

474 
__u
->
__uc
 = '\0';

477 
__u
->
__ui
 = 
__§c0_4
;

478 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

479 
__u
->
__ui
 = 
__§c4_4
;

482  
__de°
;

483 
	}
}

485 #i‚de‡
_FORCE_INLINES


486 
	#__°r˝y_¨gs
(
§c
) \

487 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

488 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

489 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

490 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

492 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

493 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

494 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

495 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

496 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

497 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

499 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

500 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

501 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

502 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

503 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

504 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

505 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

506 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

508 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

509 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

510 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

511 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

512 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

514 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

515 
__STRING2_COPY_ARR3
,

516 
__STRING2_COPY_ARR4
,

517 
__STRING2_COPY_ARR5
,

518 
__STRING2_COPY_ARR6
,

519 
__STRING2_COPY_ARR7
,

520 
__STRING2_COPY_ARR8
, 
size_t
);

521 
__STRING_INLINE
 *

522 
	$__°r˝y_smÆl
 (*
__de°
,

523 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

524 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

525 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

526 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

529 
__c
;

530 
__STRING2_COPY_ARR2
 
__sˇ2
;

531 
__STRING2_COPY_ARR3
 
__sˇ3
;

532 
__STRING2_COPY_ARR4
 
__sˇ4
;

533 
__STRING2_COPY_ARR5
 
__sˇ5
;

534 
__STRING2_COPY_ARR6
 
__sˇ6
;

535 
__STRING2_COPY_ARR7
 
__sˇ7
;

536 
__STRING2_COPY_ARR8
 
__sˇ8
;

537 } *
__u
 = (*Ë
__de°
;

538 (Ë
__§˛í
)

541 
__u
->
__c
 = '\0';

544 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

547 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

550 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

553 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

556 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

559 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

562 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

565  
__de°
;

566 
	}
}

572 #ifde‡
__USE_GNU


573 #i‡!
deföed
 
_HAVE_STRING_ARCH_°p˝y
 || deföed 
_FORCE_INLINES


574 #i‚de‡
_HAVE_STRING_ARCH_°p˝y


575 #i‡
__GNUC_PREREQ
 (3, 4)

576 
	#__°p˝y
(
de°
, 
§c
Ë
	`__buûtö_°p˝y
 (de°, src)

	)

577 #ñi‡
__GNUC_PREREQ
 (3, 0)

578 
	#__°p˝y
(
de°
, 
§c
) \

579 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

580 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

581 ? 
	`__buûtö_°r˝y
 (
de°
, 
§c
Ë+ 
	`°æí
 (src) \

582 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

584 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

586 
	#__°p˝y
(
de°
, 
§c
) \

587 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

588 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

589 ? 
	`__°p˝y_smÆl
 (
de°
, 
	`__°p˝y_¨gs
 (
§c
), \

590 
	`°æí
 (
§c
) + 1) \

591 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

593 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

597 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 (de°, src)

	)

600 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


601 #i‡
_STRING_ARCH_u«lig√d


602 #i‚de‡
_FORCE_INLINES


603 
	#__°p˝y_¨gs
(
§c
) \

604 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

605 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

606 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

607 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

609 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

610 
__uöt32_t
, __uöt32_t, 
size_t
);

611 
__STRING_INLINE
 *

612 
	$__°p˝y_smÆl
 (*
__de°
,

613 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

614 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

615 
size_t
 
__§˛í
)

618 
__ui
;

619 
__usi
;

620 
__uc
;

621 
__c
;

622 } *
__u
 = (*Ë
__de°
;

623 (Ë
__§˛í
)

626 
__u
->
__uc
 = '\0';

629 
__u
->
__usi
 = 
__§c0_2
;

630 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

633 
__u
->
__usi
 = 
__§c0_2
;

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

635 
__u
->
__uc
 = '\0';

638 
__u
->
__ui
 = 
__§c0_4
;

639 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

642 
__u
->
__ui
 = 
__§c0_4
;

643 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

644 
__u
->
__uc
 = '\0';

647 
__u
->
__ui
 = 
__§c0_4
;

648 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

649 
__u
->
__usi
 = 
__§c4_2
;

650 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

653 
__u
->
__ui
 = 
__§c0_4
;

654 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

655 
__u
->
__usi
 = 
__§c4_2
;

656 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

657 
__u
->
__uc
 = '\0';

660 
__u
->
__ui
 = 
__§c0_4
;

661 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

662 
__u
->
__ui
 = 
__§c4_4
;

663 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

666  &
__u
->
__c
;

667 
	}
}

669 #i‚de‡
_FORCE_INLINES


670 
	#__°p˝y_¨gs
(
§c
) \

671 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

672 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

673 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

674 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

676 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

677 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

678 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

679 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

680 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

681 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

683 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

684 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

685 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

686 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

687 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

688 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

689 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

690 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

692 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

693 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

694 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

695 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

696 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

698 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

699 
__STRING2_COPY_ARR3
,

700 
__STRING2_COPY_ARR4
,

701 
__STRING2_COPY_ARR5
,

702 
__STRING2_COPY_ARR6
,

703 
__STRING2_COPY_ARR7
,

704 
__STRING2_COPY_ARR8
, 
size_t
);

705 
__STRING_INLINE
 *

706 
	$__°p˝y_smÆl
 (*
__de°
,

707 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

708 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

709 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

710 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

713 
__c
;

714 
__STRING2_COPY_ARR2
 
__sˇ2
;

715 
__STRING2_COPY_ARR3
 
__sˇ3
;

716 
__STRING2_COPY_ARR4
 
__sˇ4
;

717 
__STRING2_COPY_ARR5
 
__sˇ5
;

718 
__STRING2_COPY_ARR6
 
__sˇ6
;

719 
__STRING2_COPY_ARR7
 
__sˇ7
;

720 
__STRING2_COPY_ARR8
 
__sˇ8
;

721 } *
__u
 = (*Ë
__de°
;

722 (Ë
__§˛í
)

725 
__u
->
__c
 = '\0';

728 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

731 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

734 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

737 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

740 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

743 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

746 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

749  
__de°
 + 
__§˛í
 - 1;

750 
	}
}

758 #i‚de‡
_HAVE_STRING_ARCH_°∫˝y


759 #i‡
__GNUC_PREREQ
 (3, 2)

760 
	#°∫˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫˝y
 (de°, src,Ç)

	)

762 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

763 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

764 ? (
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

765 ? (*Ë
	`mem˝y
 (
de°
, 
§c
, 
n
) \

766 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)) \

767 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)))

	)

773 #i‚de‡
_HAVE_STRING_ARCH_°∫ˇt


774 #ifde‡
_USE_STRING_ARCH_°rchr


775 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

776 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

777 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

778 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

779 ? 
	`°rˇt
 (
__de°
, 
§c
) \

780 : (*((*Ë
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

781 
§c
, 
n
)Ë'\0', 
__de°
)) \

782 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
); }))

	)

783 #ñi‡
__GNUC_PREREQ
 (3, 2)

784 
	#°∫ˇt
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫ˇt
 (de°, src,Ç)

	)

786 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

787 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

788 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

789 ? 
	`°rˇt
 (
de°
, 
§c
) \

790 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)) \

791 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)))

	)

797 #i‚de‡
_HAVE_STRING_ARCH_°rcmp


798 #i‡
__GNUC_PREREQ
 (3, 2)

799 
	#°rcmp
(
s1
, 
s2
) \

800 
__exãnsi⁄__
 \

801 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

802 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

803 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

804 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

805 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

806 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

807 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

808 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

809 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

810 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

811 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

812 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

813 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

814 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

815 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

816 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

817 : 
	`__buûtö_°rcmp
 (
s1
, 
s2
)))); })

	)

819 
	#°rcmp
(
s1
, 
s2
) \

820 
__exãnsi⁄__
 \

821 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

822 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

823 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

824 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

825 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

826 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

827 (
__s1_Àn
 < 
__s2_Àn
 ? __s1_len : __s2_len) + 1) \

828 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

829 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

830 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

831 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s1_Àn
) \

832 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

833 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

834 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

835 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

836 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s2_Àn
) \

837 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

838 : 
	`°rcmp
 (
s1
, 
s2
)))); })

	)

841 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

842 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = \

843 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

844 - ((c⁄° *Ë(c⁄° *)(
s2
))[0]); \

845 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

847 
__ªsu…
 = (((const *) \

848 (c⁄° *Ë(
s1
))[1] \

850 (c⁄° *Ë(
s2
))[1]); \

851 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

853 
__ªsu…
 = \

855 (c⁄° *Ë(
s1
))[2] \

857 (c⁄° *Ë(
s2
))[2]); \

858 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

859 
__ªsu…
 = \

861 (c⁄° *Ë(
s1
))[3] \

863 (c⁄° *Ë(
s2
))[3]); \

866 
__ªsu…
; }))

	)

868 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

869 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = \

870 (c⁄° *Ë(c⁄° *Ë(
s2
); \

871 
__ªsu…
 = \

872 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

873 - 
__s2
[0]); \

874 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

876 
__ªsu…
 = (((const *) \

877 (c⁄° *Ë(
s1
))[1] - 
__s2
[1]); \

878 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

880 
__ªsu…
 = (((const *) \

881 (c⁄° *Ë(
s1
))[2] - 
__s2
[2]); \

882 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

883 
__ªsu…
 = (((const *) \

884 (c⁄° *Ë(
s1
))[3] \

885 - 
__s2
[3]); \

888 
__ªsu…
; }))

	)

890 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

891 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = \

892 (c⁄° *Ë(c⁄° *Ë(
s1
); \

893 
__ªsu…
 = \

894 
__s1
[0] - ((const *) \

895 (c⁄° *Ë(
s2
))[0]; \

896 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

898 
__ªsu…
 = (
__s1
[1] \

900 (c⁄° *Ë(
s2
))[1]); \

901 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

903 
__ªsu…
 = \

904 (
__s1
[2] - ((const *) \

905 (c⁄° *Ë(
s2
))[2]); \

906 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

907 
__ªsu…
 = \

908 (
__s1
[3] \

910 (c⁄° *Ë(
s2
))[3]); \

913 
__ªsu…
; }))

	)

918 #i‚de‡
_HAVE_STRING_ARCH_°∫cmp


919 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

920 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

921 && ((
	`__buûtö_c⁄°™t_p
 (
s1
) \

922 && 
	`°æí
 (
s1
Ë< ((
size_t
Ë(
n
))) \

923 || (
	`__buûtö_c⁄°™t_p
 (
s2
) \

924 && 
	`°æí
 (
s2
Ë< ((
size_t
Ë(
n
)))) \

925 ? 
	`°rcmp
 (
s1
, 
s2
Ë: 
	`°∫cmp
 (s1, s2, 
n
)))

	)

931 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rc•n
 || deföed 
_FORCE_INLINES


932 #i‚de‡
_HAVE_STRING_ARCH_°rc•n


933 #i‡
__GNUC_PREREQ
 (3, 2)

934 
	#°rc•n
(
s
, 
ªje˘
) \

935 
__exãnsi⁄__
 \

936 ({ 
__r0
, 
__r1
, 
__r2
; \

937 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

938 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

939 ? 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
) \

940 : ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

941 ? 
	`°æí
 (
s
) \

942 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

943 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

944 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

945 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

946 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

947 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

948 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)))))) \

949 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)); })

	)

951 
	#°rc•n
(
s
, 
ªje˘
) \

952 
__exãnsi⁄__
 \

953 ({ 
__r0
, 
__r1
, 
__r2
; \

954 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

955 ? ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

956 ? 
	`°æí
 (
s
) \

957 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

958 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

959 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

960 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

961 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

962 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

963 : 
	`°rc•n
 (
s
, 
ªje˘
))))) \

964 : 
	`°rc•n
 (
s
, 
ªje˘
)); })

	)

968 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

969 
__STRING_INLINE
 
size_t


970 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

972 
size_t
 
__ªsu…
 = 0;

973 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘
)

974 ++
__ªsu…
;

975  
__ªsu…
;

976 
	}
}

978 
__STRING_INLINE
 
size_t
 
__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
,

979 
__ªje˘2
);

980 
__STRING_INLINE
 
size_t


981 
	$__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
)

983 
size_t
 
__ªsu…
 = 0;

984 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


985 && 
__s
[
__ªsu…
] !
__ªje˘2
)

986 ++
__ªsu…
;

987  
__ªsu…
;

988 
	}
}

990 
__STRING_INLINE
 
size_t
 
__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
,

991 
__ªje˘2
, 
__ªje˘3
);

992 
__STRING_INLINE
 
size_t


993 
	$__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
,

994 
__ªje˘3
)

996 
size_t
 
__ªsu…
 = 0;

997 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


998 && 
__s
[
__ªsu…
] !
__ªje˘2
 && __s[__ªsu…] !
__ªje˘3
)

999 ++
__ªsu…
;

1000  
__ªsu…
;

1001 
	}
}

1007 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r•n
 || deföed 
_FORCE_INLINES


1008 #i‚de‡
_HAVE_STRING_ARCH_°r•n


1009 #i‡
__GNUC_PREREQ
 (3, 2)

1010 
	#°r•n
(
s
, 
ac˚±
) \

1011 
__exãnsi⁄__
 \

1012 ({ 
__a0
, 
__a1
, 
__a2
; \

1013 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1014 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1015 ? 
	`__buûtö_°r•n
 (
s
, 
ac˚±
) \

1016 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1017 ? ((Ë(
s
), (
size_t
) 0) \

1018 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1019 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1020 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1021 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1022 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1023 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1024 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)))))) \

1025 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)); })

	)

1027 
	#°r•n
(
s
, 
ac˚±
) \

1028 
__exãnsi⁄__
 \

1029 ({ 
__a0
, 
__a1
, 
__a2
; \

1030 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1031 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1032 ? ((Ë(
s
), (
size_t
) 0) \

1033 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1034 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1035 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1036 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1037 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1038 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1039 : 
	`°r•n
 (
s
, 
ac˚±
))))) \

1040 : 
	`°r•n
 (
s
, 
ac˚±
)); })

	)

1044 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1045 
__STRING_INLINE
 
size_t


1046 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1048 
size_t
 
__ªsu…
 = 0;

1050 
__s
[
__ªsu…
] =
__ac˚±
)

1051 ++
__ªsu…
;

1052  
__ªsu…
;

1053 
	}
}

1055 
__STRING_INLINE
 
size_t
 
__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1056 
__ac˚±2
);

1057 
__STRING_INLINE
 
size_t


1058 
	$__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1060 
size_t
 
__ªsu…
 = 0;

1062 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2
)

1063 ++
__ªsu…
;

1064  
__ªsu…
;

1065 
	}
}

1067 
__STRING_INLINE
 
size_t
 
__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1068 
__ac˚±2
, 
__ac˚±3
);

1069 
__STRING_INLINE
 
size_t


1070 
	$__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1072 
size_t
 
__ªsu…
 = 0;

1074 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2


1075 || 
__s
[
__ªsu…
] =
__ac˚±3
)

1076 ++
__ªsu…
;

1077  
__ªsu…
;

1078 
	}
}

1083 #i‡!
deföed
 
_HAVE_STRING_ARCH_°Ωbrk
 || deföed 
_FORCE_INLINES


1084 #i‚de‡
_HAVE_STRING_ARCH_°Ωbrk


1085 #i‡
__GNUC_PREREQ
 (3, 2)

1086 
	#°Ωbrk
(
s
, 
ac˚±
) \

1087 
__exãnsi⁄__
 \

1088 ({ 
__a0
, 
__a1
, 
__a2
; \

1089 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1090 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1091 ? 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
) \

1092 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1093 ? ((Ë(
s
), (*Ë
NULL
) \

1094 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1095 ? 
	`__buûtö_°rchr
 (
s
, 
__a0
) \

1096 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1097 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1098 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1099 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1100 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)))))) \

1101 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1103 
	#°Ωbrk
(
s
, 
ac˚±
) \

1104 
__exãnsi⁄__
 \

1105 ({ 
__a0
, 
__a1
, 
__a2
; \

1106 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1107 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1108 ? ((Ë(
s
), (*Ë
NULL
) \

1109 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1110 ? 
	`°rchr
 (
s
, 
__a0
) \

1111 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1112 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1113 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1114 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1115 : 
	`°Ωbrk
 (
s
, 
ac˚±
))))) \

1116 : 
	`°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1120 
__STRING_INLINE
 *
__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1121 
__ac˚±2
);

1122 
__STRING_INLINE
 *

1123 
	$__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1126 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2
)

1127 ++
__s
;

1128  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1129 
	}
}

1131 
__STRING_INLINE
 *
__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1132 
__ac˚±2
, 
__ac˚±3
);

1133 
__STRING_INLINE
 *

1134 
	$__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1137 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2


1138 && *
__s
 !
__ac˚±3
)

1139 ++
__s
;

1140  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1141 
	}
}

1147 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r°r
 && !
__GNUC_PREREQ
 (2, 97)

1148 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1149 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
Ë&& 
	`__°rög2_1b±r_p
 (needle) \

1150 ? (((c⁄° *Ë(
√edÀ
))[0] == '\0' \

1151 ? (*Ë(
size_t
Ë(
hay°ack
) \

1152 : (((c⁄° *Ë(
√edÀ
))[1] == '\0' \

1153 ? 
	`°rchr
 (
hay°ack
, \

1154 ((c⁄° *Ë(
√edÀ
))[0]) \

1155 : 
	`°r°r
 (
hay°ack
, 
√edÀ
))) \

1156 : 
	`°r°r
 (
hay°ack
, 
√edÀ
)))

	)

1160 #i‡!
deföed
 
_HAVE_STRING_ARCH_°πok_r
 || deföed 
_FORCE_INLINES


1161 #i‚de‡
_HAVE_STRING_ARCH_°πok_r


1162 
	#__°πok_r
(
s
, 
£p
, 
√xç
) \

1163 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
£p
Ë&& 
	`__°rög2_1b±r_p
 (sep) \

1164 && ((c⁄° *Ë(
£p
))[0] != '\0' \

1165 && ((c⁄° *Ë(
£p
))[1] == '\0' \

1166 ? 
	`__°πok_r_1c
 (
s
, ((c⁄° *Ë(
£p
))[0], 
√xç
) \

1167 : 
	`__°πok_r
 (
s
, 
£p
, 
√xç
)))

	)

1170 
__STRING_INLINE
 *
__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
);

1171 
__STRING_INLINE
 *

1172 
	$__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
)

1174 *
__ªsu…
;

1175 i‡(
__s
 =
NULL
)

1176 
__s
 = *
__√xç
;

1177 *
__s
 =
__£p
)

1178 ++
__s
;

1179 
__ªsu…
 = 
NULL
;

1180 i‡(*
__s
 != '\0')

1182 
__ªsu…
 = 
__s
++;

1183 *
__s
 != '\0')

1184 i‡(*
__s
++ =
__£p
)

1186 
__s
[-1] = '\0';

1190 *
__√xç
 = 
__s
;

1191  
__ªsu…
;

1192 
	}
}

1193 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


1194 
	#°πok_r
(
s
, 
£p
, 
√xç
Ë
	`__°πok_r
 (s, sï,Çexç)

	)

1199 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r£p
 || deföed 
_FORCE_INLINES


1200 #i‚de‡
_HAVE_STRING_ARCH_°r£p


1202 *
__°r£p_g
 (**
__°rögp
, c⁄° *
__dñim
);

1203 
	#__°r£p
(
s
, 
ªje˘
) \

1204 
__exãnsi⁄__
 \

1205 ({ 
__r0
, 
__r1
, 
__r2
; \

1206 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

1207 && (
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], \

1208 ((c⁄° *Ë(
ªje˘
))[0] != '\0') \

1209 ? ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], \

1210 ((c⁄° *Ë(
ªje˘
))[1] == '\0') \

1211 ? 
	`__°r£p_1c
 (
s
, 
__r0
) \

1212 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

1213 ? 
	`__°r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1214 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

1215 ? 
	`__°r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1216 : 
	`__°r£p_g
 (
s
, 
ªje˘
)))) \

1217 : 
	`__°r£p_g
 (
s
, 
ªje˘
)); })

	)

1220 
__STRING_INLINE
 *
__°r£p_1c
 (**
__s
, 
__ªje˘
);

1221 
__STRING_INLINE
 *

1222 
	$__°r£p_1c
 (**
__s
, 
__ªje˘
)

1224 *
__ªtvÆ
 = *
__s
;

1225 i‡(
__ªtvÆ
 !
NULL
 && (*
__s
 = 
	`°rchr
 (__ªtvÆ, 
__ªje˘
)) != NULL)

1226 *(*
__s
)++ = '\0';

1227  
__ªtvÆ
;

1228 
	}
}

1230 
__STRING_INLINE
 *
__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
);

1231 
__STRING_INLINE
 *

1232 
	$__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
)

1234 *
__ªtvÆ
 = *
__s
;

1235 i‡(
__ªtvÆ
 !
NULL
)

1237 *
__˝
 = 
__ªtvÆ
;

1240 i‡(*
__˝
 == '\0')

1242 
__˝
 = 
NULL
;

1245 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
)

1247 *
__˝
++ = '\0';

1250 ++
__˝
;

1252 *
__s
 = 
__˝
;

1254  
__ªtvÆ
;

1255 
	}
}

1257 
__STRING_INLINE
 *
__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
,

1258 
__ªje˘3
);

1259 
__STRING_INLINE
 *

1260 
	$__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
, 
__ªje˘3
)

1262 *
__ªtvÆ
 = *
__s
;

1263 i‡(
__ªtvÆ
 !
NULL
)

1265 *
__˝
 = 
__ªtvÆ
;

1268 i‡(*
__˝
 == '\0')

1270 
__˝
 = 
NULL
;

1273 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
 || *__˝ =
__ªje˘3
)

1275 *
__˝
++ = '\0';

1278 ++
__˝
;

1280 *
__s
 = 
__˝
;

1282  
__ªtvÆ
;

1283 
	}
}

1284 #ifde‡
__USE_BSD


1285 
	#°r£p
(
s
, 
ªje˘
Ë
	`__°r£p
 (s,Ñeje˘)

	)

1292 #ifde‡
__USE_MISC


1294 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rdup
 || !deföed 
_HAVE_STRING_ARCH_°∫dup


1295 
	#__√ed_mÆloc_™d_ˇŒoc


	)

1296 
	~<°dlib.h
>

1299 #i‚de‡
_HAVE_STRING_ARCH_°rdup


1301 *
	$__°rdup
 (c⁄° *
__°rög
Ë
__THROW
 
__©åibuã_mÆloc__
;

1302 
	#__°rdup
(
s
) \

1303 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1304 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1305 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1306 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1307 *
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1308 i‡(
__ªtvÆ
 !
NULL
) \

1309 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, 
__Àn
); \

1310 
__ªtvÆ
; 
	}
})) \

1311 : 
	`__°rdup
 (
s
)))

	)

1313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1314 
	#°rdup
(
s
Ë
	`__°rdup
 (s)

	)

1318 #i‚de‡
_HAVE_STRING_ARCH_°∫dup


1320 *
	$__°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

1321 
__THROW
 
__©åibuã_mÆloc__
;

1322 
	#__°∫dup
(
s
, 
n
) \

1323 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1324 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1325 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1326 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1327 
size_t
 
__n
 = (
n
); \

1328 *
__ªtvÆ
; \

1329 i‡(
__n
 < 
__Àn
) \

1330 
__Àn
 = 
__n
 + 1; \

1331 
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1332 i‡(
__ªtvÆ
 !
NULL
) \

1334 
__ªtvÆ
[
__Àn
 - 1] = '\0'; \

1335 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, \

1336 
__Àn
 - 1); \

1338 
__ªtvÆ
; 
	}
})) \

1339 : 
	`__°∫dup
 (
s
, 
n
)))

	)

1341 #ifde‡
__USE_GNU


1342 
	#°∫dup
(
s
, 
n
Ë
	`__°∫dup
 (s,Ç)

	)

1348 #i‚de‡
_FORCE_INLINES


1349 #unde‡
__STRING_INLINE


	@/usr/include/bits/string3.h

18 #i‚de‡
_STRING_H


22 
__w¨nde˛
 (
__w¨n_mem£t_zîo_Àn
,

25 #i‚de‡
__˝lu•lus


29 #unde‡
mem˝y


30 #unde‡
memmove


31 #unde‡
mem£t


32 #unde‡
°rˇt


33 #unde‡
°r˝y


34 #unde‡
°∫ˇt


35 #unde‡
°∫˝y


36 #ifde‡
__USE_GNU


37 #unde‡
memp˝y


38 #unde‡
°p˝y


40 #ifde‡
__USE_BSD


41 #unde‡
bc›y


42 #unde‡
bzîo


47 
__f‹tify_fun˘i⁄
 *

48 
__NTH
 (
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

49 
size_t
 
__Àn
))

51  
	`__buûtö___mem˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

52 
	}
}

54 
__f‹tify_fun˘i⁄
 *

55 
__NTH
 (
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__Àn
))

57  
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

58 
	}
}

60 #ifde‡
__USE_GNU


61 
__f‹tify_fun˘i⁄
 *

62 
__NTH
 (
	$memp˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

63 
size_t
 
__Àn
))

65  
	`__buûtö___memp˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

66 
	}
}

75 
__f‹tify_fun˘i⁄
 *

76 
__NTH
 (
	$mem£t
 (*
__de°
, 
__ch
, 
size_t
 
__Àn
))

78 i‡(
	`__buûtö_c⁄°™t_p
 (
__Àn
) && __len == 0

79 && (!
	`__buûtö_c⁄°™t_p
 (
__ch
) || __ch != 0))

81 
	`__w¨n_mem£t_zîo_Àn
 ();

82  
__de°
;

84  
	`__buûtö___mem£t_chk
 (
__de°
, 
__ch
, 
__Àn
, 
	`__bos0
 (__dest));

85 
	}
}

87 #ifde‡
__USE_BSD


88 
__f‹tify_fun˘i⁄
 

89 
__NTH
 (
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__Àn
))

91 (Ë
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

92 
	}
}

94 
__f‹tify_fun˘i⁄
 

95 
__NTH
 (
	$bzîo
 (*
__de°
, 
size_t
 
__Àn
))

97 (Ë
	`__buûtö___mem£t_chk
 (
__de°
, '\0', 
__Àn
, 
	`__bos0
 (__dest));

98 
	}
}

101 
__f‹tify_fun˘i⁄
 *

102 
__NTH
 (
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

104  
	`__buûtö___°r˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

105 
	}
}

107 #ifde‡
__USE_GNU


108 
__f‹tify_fun˘i⁄
 *

109 
__NTH
 (
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

111  
	`__buûtö___°p˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

112 
	}
}

116 
__f‹tify_fun˘i⁄
 *

117 
__NTH
 (
	$°∫˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

118 
size_t
 
__Àn
))

120  
	`__buûtö___°∫˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

121 
	}
}

124 *
	$__°≤˝y_chk
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

125 
size_t
 
__de°Àn
Ë
__THROW
;

126 *
	`__REDIRECT_NTH
 (
__°≤˝y_Æüs
, (*
__de°
, c⁄° *
__§c
,

127 
size_t
 
__n
), 
°≤˝y
);

129 
__f‹tify_fun˘i⁄
 *

130 
	`__NTH
 (
	$°≤˝y
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
))

132 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1

133 && (!
	`__buûtö_c⁄°™t_p
 (
__n
Ë|| __¿<
	`__bos
 (
__de°
)))

134  
	`__°≤˝y_chk
 (
__de°
, 
__§c
, 
__n
, 
	`__bos
 (__dest));

135  
	`__°≤˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

136 
	}
}

139 
__f‹tify_fun˘i⁄
 *

140 
__NTH
 (
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

142  
	`__buûtö___°rˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

143 
	}
}

146 
__f‹tify_fun˘i⁄
 *

147 
__NTH
 (
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

148 
size_t
 
__Àn
))

150  
	`__buûtö___°∫ˇt_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

151 
	}
}

	@/usr/include/bits/sys_errlist.h

19 #i‚de‡
_STDIO_H


25 #ifde‡ 
__USE_BSD


26 
sys_√º
;

27 c⁄° *c⁄° 
sys_îæi°
[];

29 #ifde‡ 
__USE_GNU


30 
_sys_√º
;

31 c⁄° *c⁄° 
_sys_îæi°
[];

	@/usr/include/bits/time.h

23 #i‡
deföed
 
__√ed_timevÆ
 || deföed 
__USE_GNU


24 #i‚de‡
_STRUCT_TIMEVAL


25 
	#_STRUCT_TIMEVAL
 1

	)

26 
	~<bôs/ty≥s.h
>

30 
	stimevÆ


32 
__time_t
 
	mtv_£c
;

33 
__su£c⁄ds_t
 
	mtv_u£c
;

38 #i‚de‡
__√ed_timevÆ


39 #i‚de‡
_BITS_TIME_H


40 
	#_BITS_TIME_H
 1

	)

48 
	#CLOCKS_PER_SEC
 1000000l

	)

50 #i‡(!
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_POSIX
) \

51 && !
deföed
 
	g__USE_XOPEN2K


54 
	~<bôs/ty≥s.h
>

55 
__sysc⁄f
 ();

56 
	#CLK_TCK
 ((
__˛ock_t
Ë
	`__sysc⁄f
 (2)Ë

	)

59 #ifde‡
__USE_POSIX199309


61 
	#CLOCK_REALTIME
 0

	)

63 
	#CLOCK_MONOTONIC
 1

	)

65 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

67 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

69 
	#CLOCK_MONOTONIC_RAW
 4

	)

71 
	#CLOCK_REALTIME_COARSE
 5

	)

73 
	#CLOCK_MONOTONIC_COARSE
 6

	)

75 
	#CLOCK_BOOTTIME
 7

	)

77 
	#CLOCK_REALTIME_ALARM
 8

	)

79 
	#CLOCK_BOOTTIME_ALARM
 9

	)

81 
	#CLOCK_TAI
 11

	)

84 
	#TIMER_ABSTIME
 1

	)

87 #ifde‡
__USE_GNU


88 
	~<bôs/timex.h
>

90 
__BEGIN_DECLS


93 
	$˛ock_adjtime
 (
__˛ockid_t
 
__˛ock_id
, 
timex
 *
__utx
Ë
__THROW
;

95 
__END_DECLS


101 #unde‡
__√ed_timevÆ


	@/usr/include/bits/types.h

23 #i‚def 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/w‹dsize.h
>

30 
	t__u_ch¨
;

31 
	t__u_sh‹t
;

32 
	t__u_öt
;

33 
	t__u_l⁄g
;

36 sig√d 
	t__öt8_t
;

37 
	t__uöt8_t
;

38 sig√d 
	t__öt16_t
;

39 
	t__uöt16_t
;

40 sig√d 
	t__öt32_t
;

41 
	t__uöt32_t
;

42 #i‡
__WORDSIZE
 == 64

43 sig√d 
	t__öt64_t
;

44 
	t__uöt64_t
;

45 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


46 
__exãnsi⁄__
 sig√d 
	t__öt64_t
;

47 
__exãnsi⁄__
 
	t__uöt64_t
;

51 #i‡
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

54 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


55 
__exãnsi⁄__
 
	t__quad_t
;

56 
__exãnsi⁄__
 
	t__u_quad_t
;

60 
	m__vÆ
[2];

61 } 
	t__quad_t
;

64 
__u_l⁄g
 
	m__vÆ
[2];

65 } 
	t__u_quad_t
;

98 
	#__S16_TYPE
 

	)

99 
	#__U16_TYPE
 

	)

100 
	#__S32_TYPE
 

	)

101 
	#__U32_TYPE
 

	)

102 
	#__SLONGWORD_TYPE
 

	)

103 
	#__ULONGWORD_TYPE
 

	)

104 #i‡
__WORDSIZE
 == 32

105 
	#__SQUAD_TYPE
 
__quad_t


	)

106 
	#__UQUAD_TYPE
 
__u_quad_t


	)

107 
	#__SWORD_TYPE
 

	)

108 
	#__UWORD_TYPE
 

	)

109 
	#__SLONG32_TYPE
 

	)

110 
	#__ULONG32_TYPE
 

	)

111 
	#__S64_TYPE
 
__quad_t


	)

112 
	#__U64_TYPE
 
__u_quad_t


	)

115 
	#__STD_TYPE
 
__exãnsi⁄__
 

	)

116 #ñi‡
__WORDSIZE
 == 64

117 
	t__SQUAD_TYPE
 

	)

118 
	t__UQUAD_TYPE
 

	)

119 
	t__SWORD_TYPE
 

	)

120 
	t__UWORD_TYPE
 

	)

121 
	t__SLONG32_TYPE
 

	)

122 
	t__ULONG32_TYPE
 

	)

123 
	t__S64_TYPE
 

	)

124 
	t__U64_TYPE
 

	)

126 
	t__STD_TYPE
 

	)

130 
	~<bôs/ty≥sizes.h
>

133 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

134 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

135 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

136 
__STD_TYPE
 
__INO_T_TYPE
 
	g__öo_t
;

137 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__öo64_t
;

138 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

139 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__∆ök_t
;

140 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

141 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

142 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

143 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

144 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__˛ock_t
;

145 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__æim_t
;

146 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__æim64_t
;

147 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

148 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

149 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£c⁄ds_t
;

150 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£c⁄ds_t
;

152 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

153 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

156 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__˛ockid_t
;

159 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__timî_t
;

162 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

167 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blk˙t_t
;

168 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blk˙t64_t
;

171 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblk˙t_t
;

172 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblk˙t64_t
;

175 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfû˙t_t
;

176 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfû˙t64_t
;

179 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fsw‹d_t
;

181 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysˇŒ_¶⁄g_t
;

186 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysˇŒ_ul⁄g_t
;

190 
__off64_t
 
	t__loff_t
;

191 
__quad_t
 *
	t__qaddr_t
;

192 *
	t__ˇddr_t
;

195 
__STD_TYPE
 
__SWORD_TYPE
 
	g__öçå_t
;

198 
__STD_TYPE
 
__U32_TYPE
 
	g__sockÀn_t
;

201 #unde‡
__STD_TYPE


	@/usr/include/bits/waitflags.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


25 
	#WNOHANG
 1

	)

26 
	#WUNTRACED
 2

	)

29 
	#WSTOPPED
 2

	)

30 
	#WEXITED
 4

	)

31 
	#WCONTINUED
 8

	)

32 
	#WNOWAIT
 0x01000000

	)

34 
	#__WNOTHREAD
 0x20000000

	)

36 
	#__WALL
 0x40000000

	)

37 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


28 
	#__WEXITSTATUS
(
°©us
Ë(((°©usË& 0xff00Ë>> 8)

	)

31 
	#__WTERMSIG
(
°©us
Ë((°©usË& 0x7f)

	)

34 
	#__WSTOPSIG
(
°©us
Ë
	`__WEXITSTATUS
(°©us)

	)

37 
	#__WIFEXITED
(
°©us
Ë(
	`__WTERMSIG
(°©usË=0)

	)

40 
	#__WIFSIGNALED
(
°©us
) \

41 (((sig√d Ë(((
°©us
Ë& 0x7fË+ 1Ë>> 1Ë> 0)

	)

44 
	#__WIFSTOPPED
(
°©us
Ë(((°©usË& 0xffË=0x7f)

	)

48 #ifde‡
WCONTINUED


49 
	#__WIFCONTINUED
(
°©us
Ë((°©usË=
__W_CONTINUED
)

	)

53 
	#__WCOREDUMP
(
°©us
Ë((°©usË& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
ªt
, 
sig
Ë(‘ëË<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
Ë((sigË<< 8 | 0x7f)

	)

58 
	#__W_CONTINUED
 0xffff

	)

59 
	#__WCOREFLAG
 0x80

	)

62 #ifdef 
__USE_BSD


64 
	~<ídün.h
>

66 
	uwaô


68 
	mw_°©us
;

71 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


72 
	m__w_ãrmsig
:7;

73 
	m__w_c‹edump
:1;

74 
	m__w_ªtcode
:8;

77 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


79 
	m__w_ªtcode
:8;

80 
	m__w_c‹edump
:1;

81 
	m__w_ãrmsig
:7;

83 } 
	m__waô_ãrmö©ed
;

86 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


87 
	m__w_°›vÆ
:8;

88 
	m__w_°›sig
:8;

91 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


93 
	m__w_°›sig
:8;

94 
	m__w_°›vÆ
:8;

96 } 
	m__waô_°›≥d
;

99 
	#w_ãrmsig
 
__waô_ãrmö©ed
.
__w_ãrmsig


	)

100 
	#w_c‹edump
 
__waô_ãrmö©ed
.
__w_c‹edump


	)

101 
	#w_ªtcode
 
__waô_ãrmö©ed
.
__w_ªtcode


	)

102 
	#w_°›sig
 
__waô_°›≥d
.
__w_°›sig


	)

103 
	#w_°›vÆ
 
__waô_°›≥d
.
__w_°›vÆ


	)

	@/usr/include/bits/wchar.h

19 #i‚de‡
_BITS_WCHAR_H


20 
	#_BITS_WCHAR_H
 1

	)

22 
	~<bôs/w‹dsize.h
>

24 #i‡
__WORDSIZE
 == 64

25 
	#__WCHAR_MIN
 (-2147483647 - 1)

	)

26 
	#__WCHAR_MAX
 (2147483647)

	)

28 
	#__WCHAR_MIN
 (-2147483647»- 1l)

	)

29 
	#__WCHAR_MAX
 (2147483647l)

	)

	@/usr/include/bits/wordsize.h

3 #i‡
deföed
 
__x86_64__
 && !deföed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

9 #ifde‡
__x86_64__


10 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

12 
	#__SYSCALL_WORDSIZE
 64

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

98 #unde‡
__USE_ISOC11


99 #unde‡
__USE_ISOC99


100 #unde‡
__USE_ISOC95


101 #unde‡
__USE_ISOCXX11


102 #unde‡
__USE_POSIX


103 #unde‡
__USE_POSIX2


104 #unde‡
__USE_POSIX199309


105 #unde‡
__USE_POSIX199506


106 #unde‡
__USE_XOPEN


107 #unde‡
__USE_XOPEN_EXTENDED


108 #unde‡
__USE_UNIX98


109 #unde‡
__USE_XOPEN2K


110 #unde‡
__USE_XOPEN2KXSI


111 #unde‡
__USE_XOPEN2K8


112 #unde‡
__USE_XOPEN2K8XSI


113 #unde‡
__USE_LARGEFILE


114 #unde‡
__USE_LARGEFILE64


115 #unde‡
__USE_FILE_OFFSET64


116 #unde‡
__USE_BSD


117 #unde‡
__USE_SVID


118 #unde‡
__USE_MISC


119 #unde‡
__USE_ATFILE


120 #unde‡
__USE_GNU


121 #unde‡
__USE_REENTRANT


122 #unde‡
__USE_FORTIFY_LEVEL


123 #unde‡
__FAVOR_BSD


124 #unde‡
__KERNEL_STRICT_NAMES


128 #i‚de‡
_LOOSE_KERNEL_NAMES


129 
	#__KERNEL_STRICT_NAMES


	)

133 
	#__USE_ANSI
 1

	)

142 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


143 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

144 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

146 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

151 #i‡
deföed
 
_BSD_SOURCE
 && \

152 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

153 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

154 
	#__FAVOR_BSD
 1

	)

158 #ifde‡
_GNU_SOURCE


159 #unde‡
_ISOC95_SOURCE


160 
	#_ISOC95_SOURCE
 1

	)

161 #unde‡
_ISOC99_SOURCE


162 
	#_ISOC99_SOURCE
 1

	)

163 #unde‡
_ISOC11_SOURCE


164 
	#_ISOC11_SOURCE
 1

	)

165 #unde‡
_POSIX_SOURCE


166 
	#_POSIX_SOURCE
 1

	)

167 #unde‡
_POSIX_C_SOURCE


168 
	#_POSIX_C_SOURCE
 200809L

	)

169 #unde‡
_XOPEN_SOURCE


170 
	#_XOPEN_SOURCE
 700

	)

171 #unde‡
_XOPEN_SOURCE_EXTENDED


172 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

173 #unde‡
_LARGEFILE64_SOURCE


174 
	#_LARGEFILE64_SOURCE
 1

	)

175 #unde‡
_BSD_SOURCE


176 
	#_BSD_SOURCE
 1

	)

177 #unde‡
_SVID_SOURCE


178 
	#_SVID_SOURCE
 1

	)

179 #unde‡
_ATFILE_SOURCE


180 
	#_ATFILE_SOURCE
 1

	)

185 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

186 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

187 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

188 
	#_BSD_SOURCE
 1

	)

189 
	#_SVID_SOURCE
 1

	)

193 #i‡(
deföed
 
_ISOC11_SOURCE
 \

194 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

195 
	#__USE_ISOC11
 1

	)

199 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

200 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

201 
	#__USE_ISOC99
 1

	)

205 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

206 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

207 
	#__USE_ISOC95
 1

	)

214 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

215 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

216 
	#__USE_ISOCXX11
 1

	)

221 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

222 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

223 
	#_POSIX_SOURCE
 1

	)

224 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

225 
	#_POSIX_C_SOURCE
 2

	)

226 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

227 
	#_POSIX_C_SOURCE
 199506L

	)

228 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

229 
	#_POSIX_C_SOURCE
 200112L

	)

231 
	#_POSIX_C_SOURCE
 200809L

	)

233 
	#__USE_POSIX_IMPLICITLY
 1

	)

236 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


237 
	#__USE_POSIX
 1

	)

240 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


241 
	#__USE_POSIX2
 1

	)

244 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

245 
	#__USE_POSIX199309
 1

	)

248 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

249 
	#__USE_POSIX199506
 1

	)

252 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

253 
	#__USE_XOPEN2K
 1

	)

254 #unde‡
__USE_ISOC95


255 
	#__USE_ISOC95
 1

	)

256 #unde‡
__USE_ISOC99


257 
	#__USE_ISOC99
 1

	)

260 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

261 
	#__USE_XOPEN2K8
 1

	)

262 #unde‡
_ATFILE_SOURCE


263 
	#_ATFILE_SOURCE
 1

	)

266 #ifdef 
_XOPEN_SOURCE


267 
	#__USE_XOPEN
 1

	)

268 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

269 
	#__USE_XOPEN_EXTENDED
 1

	)

270 
	#__USE_UNIX98
 1

	)

271 #unde‡
_LARGEFILE_SOURCE


272 
	#_LARGEFILE_SOURCE
 1

	)

273 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

274 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

275 
	#__USE_XOPEN2K8
 1

	)

276 
	#__USE_XOPEN2K8XSI
 1

	)

278 
	#__USE_XOPEN2K
 1

	)

279 
	#__USE_XOPEN2KXSI
 1

	)

280 #unde‡
__USE_ISOC95


281 
	#__USE_ISOC95
 1

	)

282 #unde‡
__USE_ISOC99


283 
	#__USE_ISOC99
 1

	)

286 #ifde‡
_XOPEN_SOURCE_EXTENDED


287 
	#__USE_XOPEN_EXTENDED
 1

	)

292 #ifde‡
_LARGEFILE_SOURCE


293 
	#__USE_LARGEFILE
 1

	)

296 #ifde‡
_LARGEFILE64_SOURCE


297 
	#__USE_LARGEFILE64
 1

	)

300 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

301 
	#__USE_FILE_OFFSET64
 1

	)

304 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


305 
	#__USE_MISC
 1

	)

308 #ifdef 
_BSD_SOURCE


309 
	#__USE_BSD
 1

	)

312 #ifdef 
_SVID_SOURCE


313 
	#__USE_SVID
 1

	)

316 #ifdef 
_ATFILE_SOURCE


317 
	#__USE_ATFILE
 1

	)

320 #ifdef 
_GNU_SOURCE


321 
	#__USE_GNU
 1

	)

324 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


325 
	#__USE_REENTRANT
 1

	)

328 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0

329 #i‡!
deföed
 
__OPTIMIZE__
 || __OPTIMIZE__ <= 0

330 #w¨nög 
_FORTIFY_SOURCE
 
ªquúes
 
compûög
 
wôh
 
›timiz©i⁄
 (-
O
)

331 #ñi‡!
__GNUC_PREREQ
 (4, 1)

332 #w¨nög 
_FORTIFY_SOURCE
 
ªquúes
 
GCC
 4.1 
‹
 
œãr


333 #ñi‡
_FORTIFY_SOURCE
 > 1

334 
	#__USE_FORTIFY_LEVEL
 2

	)

336 
	#__USE_FORTIFY_LEVEL
 1

	)

339 #i‚de‡
__USE_FORTIFY_LEVEL


340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<°dc-¥edef.h
>

353 #unde‡
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 17

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

362 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

365 #i‡
deföed
 
__GNUC__
 \

366 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

367 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

368 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

369 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

373 #i‚de‡
__ASSEMBLER__


374 #i‚de‡
_SYS_CDEFS_H


375 
	~<sys/cdefs.h
>

380 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


381 
	#__USE_LARGEFILE
 1

	)

382 
	#__USE_LARGEFILE64
 1

	)

388 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

389 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

390 && 
deföed
 
	g__exã∫_ölöe


391 
	#__USE_EXTERN_INLINES
 1

	)

399 
	~<gnu/°ubs.h
>

	@/usr/include/getopt.h

20 #i‚de‡
_GETOPT_H


22 #i‚de‡
__√ed_gë›t


23 
	#_GETOPT_H
 1

	)

33 #i‡!
deföed
 
__GNU_LIBRARY__


34 
	~<˘y≥.h
>

37 #i‚de‡
__THROW


38 #i‚de‡
__GNUC_PREREQ


39 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë(0)

	)

41 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

42 
	#__THROW
 
	`throw
 ()

	)

44 
	#__THROW


	)

48 #ifdef 
__˝lu•lus


58 *
›èrg
;

72 
›töd
;

77 
›ãº
;

81 
›t›t
;

83 #i‚de‡
__√ed_gë›t


105 
	s›ti⁄


107 c⁄° *
	g«me
;

110 
	ghas_¨g
;

111 *
	gÊag
;

112 
	gvÆ
;

117 
	#no_¨gumít
 0

	)

118 
	#ªquúed_¨gumít
 1

	)

119 
	#›ti⁄Æ_¨gumít
 2

	)

147 #ifde‡
__GNU_LIBRARY__


151 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

152 
__THROW
;

154 #i‡
deföed
 
__√ed_gë›t
 && deföed 
__USE_POSIX2
 \

155 && !
deföed
 
	g__USE_POSIX_IMPLICITLY
 && !deföed 
	g__USE_GNU


159 #ifde‡
__REDIRECT


160 
__REDIRECT_NTH
 (
gë›t
, (
___¨gc
, *c⁄° *
___¨gv
,

161 c⁄° *
__sh‹t›ts
),

162 
__posix_gë›t
);

164 
__posix_gë›t
 (
___¨gc
, *c⁄° *
___¨gv
,

165 c⁄° *
__sh‹t›ts
Ë
__THROW
;

166 
	#gë›t
 
__posix_gë›t


	)

170 
gë›t
 ();

173 #i‚de‡
__√ed_gë›t


174 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

175 c⁄° *
__sh‹t›ts
,

176 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

177 
__THROW
;

178 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

179 c⁄° *
__sh‹t›ts
,

180 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

181 
__THROW
;

185 #ifdef 
__˝lu•lus


190 #unde‡
__√ed_gë›t


	@/usr/include/libio.h

29 #i‚de‡
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_c⁄fig.h
>

34 
	#_IO_Âos_t
 
_G_Âos_t


	)

35 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

36 
	#_IO_size_t
 
size_t


	)

37 
	#_IO_ssize_t
 
__ssize_t


	)

38 
	#_IO_off_t
 
__off_t


	)

39 
	#_IO_off64_t
 
__off64_t


	)

40 
	#_IO_pid_t
 
__pid_t


	)

41 
	#_IO_uid_t
 
__uid_t


	)

42 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

43 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

44 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

45 
	#_IO_va_li°
 
_G_va_li°


	)

46 
	#_IO_wöt_t
 
wöt_t


	)

49 
	#__√ed___va_li°


	)

50 
	~<°d¨g.h
>

51 #ifde‡
__GNUC_VA_LIST


52 #unde‡
_IO_va_li°


53 
	#_IO_va_li°
 
__gnuc_va_li°


	)

56 #i‚de‡
__P


57 
	~<sys/cdefs.h
>

60 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

62 #i‚de‡
EOF


63 
	#EOF
 (-1)

	)

65 #i‚de‡
NULL


66 #i‡
deföed
 
__GNUG__
 && \

67 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

68 
	#NULL
 (
__nuŒ
)

	)

70 #i‡!
deföed
(
__˝lu•lus
)

71 
	#NULL
 ((*)0)

	)

73 
	#NULL
 (0)

	)

78 
	#_IOS_INPUT
 1

	)

79 
	#_IOS_OUTPUT
 2

	)

80 
	#_IOS_ATEND
 4

	)

81 
	#_IOS_APPEND
 8

	)

82 
	#_IOS_TRUNC
 16

	)

83 
	#_IOS_NOCREATE
 32

	)

84 
	#_IOS_NOREPLACE
 64

	)

85 
	#_IOS_BIN
 128

	)

93 
	#_IO_MAGIC
 0xFBAD0000

	)

94 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

95 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

96 
	#_IO_USER_BUF
 1

	)

97 
	#_IO_UNBUFFERED
 2

	)

98 
	#_IO_NO_READS
 4

	)

99 
	#_IO_NO_WRITES
 8

	)

100 
	#_IO_EOF_SEEN
 0x10

	)

101 
	#_IO_ERR_SEEN
 0x20

	)

102 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

103 
	#_IO_LINKED
 0x80

	)

104 
	#_IO_IN_BACKUP
 0x100

	)

105 
	#_IO_LINE_BUF
 0x200

	)

106 
	#_IO_TIED_PUT_GET
 0x400

	)

107 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

108 
	#_IO_IS_APPENDING
 0x1000

	)

109 
	#_IO_IS_FILEBUF
 0x2000

	)

110 
	#_IO_BAD_SEEN
 0x4000

	)

111 
	#_IO_USER_LOCK
 0x8000

	)

113 
	#_IO_FLAGS2_MMAP
 1

	)

114 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

115 #ifde‡
_LIBC


116 
	#_IO_FLAGS2_FORTIFY
 4

	)

118 
	#_IO_FLAGS2_USER_WBUF
 8

	)

119 #ifde‡
_LIBC


120 
	#_IO_FLAGS2_SCANF_STD
 16

	)

121 
	#_IO_FLAGS2_NOCLOSE
 32

	)

122 
	#_IO_FLAGS2_CLOEXEC
 64

	)

126 
	#_IO_SKIPWS
 01

	)

127 
	#_IO_LEFT
 02

	)

128 
	#_IO_RIGHT
 04

	)

129 
	#_IO_INTERNAL
 010

	)

130 
	#_IO_DEC
 020

	)

131 
	#_IO_OCT
 040

	)

132 
	#_IO_HEX
 0100

	)

133 
	#_IO_SHOWBASE
 0200

	)

134 
	#_IO_SHOWPOINT
 0400

	)

135 
	#_IO_UPPERCASE
 01000

	)

136 
	#_IO_SHOWPOS
 02000

	)

137 
	#_IO_SCIENTIFIC
 04000

	)

138 
	#_IO_FIXED
 010000

	)

139 
	#_IO_UNITBUF
 020000

	)

140 
	#_IO_STDIO
 040000

	)

141 
	#_IO_DONT_CLOSE
 0100000

	)

142 
	#_IO_BOOLALPHA
 0200000

	)

145 
_IO_jump_t
; 
	g_IO_FILE
;

148 #ifde‡
_IO_MTSAFE_IO


149 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

150 
	~<bôs/°dio-lock.h
>

155 
	t_IO_lock_t
;

161 
	s_IO_m¨kî
 {

162 
_IO_m¨kî
 *
	m_√xt
;

163 
_IO_FILE
 *
	m_sbuf
;

167 
	m_pos
;

169 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

170 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

171 
	mpublic
:

172 
°ªamm¨kî
(
°ªambuf
 *
sb
);

173 ~
°ªamm¨kî
();

174 
ßvög
(Ë{  
	m_•os
 == -2; }

175 
dñè
(
°ªamm¨kî
&);

176 
dñè
();

181 
	e__codecvt_ªsu…


183 
	m__codecvt_ok
,

184 
	m__codecvt_∑πül
,

185 
	m__codecvt_îr‹
,

186 
	m__codecvt_noc⁄v


189 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


192 
	s_IO_codecvt


194 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

195 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

196 
	m__mb°©e_t
 *,

197 c⁄° 
	mwch¨_t
 *,

198 c⁄° 
	mwch¨_t
 *,

199 c⁄° 
	mwch¨_t
 **, *,

201 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

202 
	m__mb°©e_t
 *, *,

204 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

205 
	m__mb°©e_t
 *,

207 c⁄° **, 
	mwch¨_t
 *,

208 
	mwch¨_t
 *, wchar_t **);

209 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

211 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

212 c⁄° *, c⁄° *, 
	m_IO_size_t
);

213 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

215 
_IO_ic⁄v_t
 
	m__cd_ö
;

216 
_IO_ic⁄v_t
 
	m__cd_out
;

220 
	s_IO_wide_d©a


222 
wch¨_t
 *
	m_IO_ªad_±r
;

223 
wch¨_t
 *
	m_IO_ªad_íd
;

224 
wch¨_t
 *
	m_IO_ªad_ba£
;

225 
wch¨_t
 *
	m_IO_wrôe_ba£
;

226 
wch¨_t
 *
	m_IO_wrôe_±r
;

227 
wch¨_t
 *
	m_IO_wrôe_íd
;

228 
wch¨_t
 *
	m_IO_buf_ba£
;

229 
wch¨_t
 *
	m_IO_buf_íd
;

231 
wch¨_t
 *
	m_IO_ßve_ba£
;

232 
wch¨_t
 *
	m_IO_backup_ba£
;

234 
wch¨_t
 *
	m_IO_ßve_íd
;

236 
__mb°©e_t
 
	m_IO_°©e
;

237 
__mb°©e_t
 
	m_IO_œ°_°©e
;

238 
_IO_codecvt
 
	m_codecvt
;

240 
wch¨_t
 
	m_sh‹tbuf
[1];

242 c⁄° 
_IO_jump_t
 *
	m_wide_vèbÀ
;

246 
	s_IO_FILE
 {

247 
	m_Êags
;

248 
	#_IO_fûe_Êags
 
_Êags


	)

252 * 
	m_IO_ªad_±r
;

253 * 
	m_IO_ªad_íd
;

254 * 
	m_IO_ªad_ba£
;

255 * 
	m_IO_wrôe_ba£
;

256 * 
	m_IO_wrôe_±r
;

257 * 
	m_IO_wrôe_íd
;

258 * 
	m_IO_buf_ba£
;

259 * 
	m_IO_buf_íd
;

261 *
	m_IO_ßve_ba£
;

262 *
	m_IO_backup_ba£
;

263 *
	m_IO_ßve_íd
;

265 
_IO_m¨kî
 *
	m_m¨kîs
;

267 
_IO_FILE
 *
	m_chaö
;

269 
	m_fûío
;

271 
	m_blksize
;

273 
	m_Êags2
;

275 
_IO_off_t
 
	m_ﬁd_off£t
;

277 
	#__HAVE_COLUMN


	)

279 
	m_cur_cﬁumn
;

280 sig√d 
	m_vèbÀ_off£t
;

281 
	m_sh‹tbuf
[1];

285 
_IO_lock_t
 *
	m_lock
;

286 #ifde‡
_IO_USE_OLD_IO_FILE


289 
	s_IO_FILE_com∂ëe


291 
_IO_FILE
 
	m_fûe
;

293 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

294 
_IO_off64_t
 
	m_off£t
;

295 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


297 
_IO_codecvt
 *
	m_codecvt
;

298 
_IO_wide_d©a
 *
	m_wide_d©a
;

299 
_IO_FILE
 *
	m_‰ìªs_li°
;

300 *
	m_‰ìªs_buf
;

301 
size_t
 
	m_‰ìªs_size
;

303 *
	m__∑d1
;

304 *
	m__∑d2
;

305 *
	m__∑d3
;

306 *
	m__∑d4
;

307 
size_t
 
	m__∑d5
;

309 
	m_mode
;

311 
	m_unu£d2
[15 *  (Ë- 4 *  (*Ë-  (
size_t
)];

315 #i‚de‡
__˝lu•lus


316 
_IO_FILE
 
	t_IO_FILE
;

319 
	g_IO_FILE_∂us
;

321 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

322 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

323 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

324 #i‚de‡
_LIBC


325 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

326 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

327 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

329 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

330 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

331 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

339 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

347 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, c⁄° *
	t__buf
,

348 
	tsize_t
 
	t__n
);

356 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

359 
	t__io_˛o£_‚
 (*
	t__cookõ
);

362 #ifde‡
_GNU_SOURCE


364 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

365 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

366 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

367 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

372 
__io_ªad_‚
 *
	mªad
;

373 
__io_wrôe_‚
 *
	mwrôe
;

374 
__io_£ek_‚
 *
	m£ek
;

375 
__io_˛o£_‚
 *
	m˛o£
;

376 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

377 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

379 
	g_IO_cookõ_fûe
;

382 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

383 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

387 #ifde‡
__˝lu•lus


391 
__undîÊow
 (
_IO_FILE
 *);

392 
__uÊow
 (
_IO_FILE
 *);

393 
__ovîÊow
 (
_IO_FILE
 *, );

394 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


395 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *);

396 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *);

397 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wint_t);

400 #i‡ 
__GNUC__
 >= 3

401 
	#_IO_BE
(
ex¥
, 
ªs
Ë
	`__buûtö_ex≥˘
 (”x¥),Ñes)

	)

403 
	#_IO_BE
(
ex¥
, 
ªs
Ë”x¥)

	)

406 
	#_IO_gëc_u∆ocked
(
_Â
) \

407 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

408 ? 
	`__uÊow
 (
_Â
Ë: *(*Ë(_Â)->
_IO_ªad_±r
++)

	)

409 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

410 (
	`_IO_BE
 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
, 0) \

411 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

412 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

413 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

414 (
	`_IO_BE
 ((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
, 0) \

415 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

416 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

418 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


419 
	#_IO_gëwc_u∆ocked
(
_Â
) \

420 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

421 || ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 \

422 >(
_Â
)->
_wide_d©a
->
_IO_ªad_íd
), 0) \

423 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

424 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

425 (
	`_IO_BE
 ((
_Â
)->
_wide_d©a
 =
NULL
 \

426 || ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 \

427 >(
_Â
)->
_wide_d©a
->
_IO_wrôe_íd
), 0) \

428 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

429 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

432 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

433 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

435 
_IO_gëc
 (
_IO_FILE
 *
__Â
);

436 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
);

437 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

438 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

440 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
);

443 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

444 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

446 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

447 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

448 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

450 #ifde‡
_IO_MTSAFE_IO


451 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

452 
	#_IO_Êockfûe
(
_Â
) \

453 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

454 
	#_IO_fu∆ockfûe
(
_Â
) \

455 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

457 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

458 
	#_IO_Êockfûe
(
_Â
Ë

	)

459 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

460 
	#_IO_·rylockfûe
(
_Â
Ë

	)

461 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

462 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

465 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

466 
_IO_va_li°
, *
__ª°ri˘
);

467 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

468 
_IO_va_li°
);

469 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_t);

470 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_t);

472 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

473 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

475 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

477 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


478 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
);

479 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
);

480 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

481 #i‡
__GNUC__
 >= 2

484 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


485 
	~<shlib-com∑t.h
>

486 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

487 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

488 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

489 c⁄° 
_IO_°dö_u£d
;

490 
wók_exã∫
 (
_IO_°dö_u£d
);

493 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


494 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

498 
	#_IO_fwide
(
__Â
, 
__mode
) \

499 ({ 
__ªsu…
 = (
__mode
); \

500 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

502 i‡((
__Â
)->
_mode
 == 0) \

504 (
__Â
)->
_mode
 = -1; \

505 
__ªsu…
 = (
__Â
)->
_mode
; \

507 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

508 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

510 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

511 
__ªsu…
; })

	)

514 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

515 
_IO_va_li°
, *
__ª°ri˘
);

516 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

517 
_IO_va_li°
);

518 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_t);

519 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

522 #ifde‡
__LDBL_COMPAT


523 
	~<bôs/libio-ldbl.h
>

526 #ifde‡
__˝lu•lus


	@/usr/include/sys/types.h

22 #i‚def 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 #ifdef 
__USE_BSD


32 #i‚de‡
__u_ch¨_deföed


33 
__u_ch¨
 
	tu_ch¨
;

34 
__u_sh‹t
 
	tu_sh‹t
;

35 
__u_öt
 
	tu_öt
;

36 
__u_l⁄g
 
	tu_l⁄g
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¨_deföed


	)

44 
__loff_t
 
	tloff_t
;

46 #i‚de‡
__öo_t_deföed


47 #i‚de‡
__USE_FILE_OFFSET64


48 
__öo_t
 
	töo_t
;

50 
__öo64_t
 
	töo_t
;

52 
	#__öo_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


55 
__öo64_t
 
	töo64_t
;

56 
	#__öo64_t_deföed


	)

59 #i‚de‡
__dev_t_deföed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_deföed


	)

64 #i‚de‡
__gid_t_deföed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_deföed


	)

69 #i‚de‡
__mode_t_deföed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_deföed


	)

74 #i‚de‡
__∆ök_t_deföed


75 
__∆ök_t
 
	t∆ök_t
;

76 
	#__∆ök_t_deföed


	)

79 #i‚de‡
__uid_t_deföed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_deföed


	)

84 #i‚de‡
__off_t_deföed


85 #i‚de‡
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_deföed


	)

92 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_deföed


	)

97 #i‚de‡
__pid_t_deföed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_deföed


	)

102 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
) \

103 && !
deföed
 
__id_t_deföed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_deföed


	)

108 #i‚de‡
__ssize_t_deföed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_deföed


	)

113 #ifdef 
__USE_BSD


114 #i‚de‡
__daddr_t_deföed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ˇddr_t
 
	tˇddr_t
;

117 
	#__daddr_t_deföed


	)

121 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__key_t_deföed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_deföed


	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#__√ed_˛ock_t


	)

129 
	#__√ed_time_t


	)

130 
	#__√ed_timî_t


	)

131 
	#__√ed_˛ockid_t


	)

132 
	~<time.h
>

134 #ifde‡
__USE_XOPEN


135 #i‚de‡
__u£c⁄ds_t_deföed


136 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

137 
	#__u£c⁄ds_t_deföed


	)

139 #i‚de‡
__su£c⁄ds_t_deföed


140 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

141 
	#__su£c⁄ds_t_deföed


	)

145 
	#__√ed_size_t


	)

146 
	~<°ddef.h
>

148 #ifde‡
__USE_MISC


150 
	tul⁄g
;

151 
	tush‹t
;

152 
	tuöt
;

157 #i‡!
__GNUC_PREREQ
 (2, 7)

160 #i‚de‡
__öt8_t_deföed


161 
	#__öt8_t_deföed


	)

162 
	töt8_t
;

163 
	töt16_t
;

164 
	töt32_t
;

165 #i‡
__WORDSIZE
 == 64

166 
	töt64_t
;

167 #ñi‡
__GLIBC_HAVE_LONG_LONG


168 
__exãnsi⁄__
 
	töt64_t
;

173 
	tu_öt8_t
;

174 
	tu_öt16_t
;

175 
	tu_öt32_t
;

176 #i‡
__WORDSIZE
 == 64

177 
	tu_öt64_t
;

178 #ñi‡
__GLIBC_HAVE_LONG_LONG


179 
__exãnsi⁄__
 
	tu_öt64_t
;

182 
	tªgi°î_t
;

187 
	#__ötN_t
(
N
, 
MODE
) \

188 ##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

189 
	t__u_ötN_t
(
	tN
, 
	tMODE
) \

190 
	tu_öt
##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

192 #i‚de‡
	t__öt8_t_deföed


193 
	t__öt8_t_deföed


	)

194 
	t__ötN_t
 (8, 
	t__QI__
);

195 
__ötN_t
 (16, 
__HI__
);

196 
__ötN_t
 (32, 
__SI__
);

197 
__ötN_t
 (64, 
__DI__
);

200 
__u_ötN_t
 (8, 
__QI__
);

201 
__u_ötN_t
 (16, 
__HI__
);

202 
__u_ötN_t
 (32, 
__SI__
);

203 
__u_ötN_t
 (64, 
__DI__
);

205 
	tªgi°î_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__w‹d__
)));

211 
	#__BIT_TYPES_DEFINED__
 1

	)

214 #ifdef 
__USE_BSD


216 
	~<ídün.h
>

219 
	~<sys/£À˘.h
>

222 
	~<sys/sysma¸os.h
>

226 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
) \

227 && !
deföed
 
__blksize_t_deföed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_deföed


	)

233 #i‚de‡
__USE_FILE_OFFSET64


234 #i‚de‡
__blk˙t_t_deföed


235 
__blk˙t_t
 
	tblk˙t_t
;

236 
	#__blk˙t_t_deföed


	)

238 #i‚de‡
__fsblk˙t_t_deföed


239 
__fsblk˙t_t
 
	tfsblk˙t_t
;

240 
	#__fsblk˙t_t_deföed


	)

242 #i‚de‡
__fsfû˙t_t_deföed


243 
__fsfû˙t_t
 
	tfsfû˙t_t
;

244 
	#__fsfû˙t_t_deföed


	)

247 #i‚de‡
__blk˙t_t_deföed


248 
__blk˙t64_t
 
	tblk˙t_t
;

249 
	#__blk˙t_t_deföed


	)

251 #i‚de‡
__fsblk˙t_t_deföed


252 
__fsblk˙t64_t
 
	tfsblk˙t_t
;

253 
	#__fsblk˙t_t_deföed


	)

255 #i‚de‡
__fsfû˙t_t_deföed


256 
__fsfû˙t64_t
 
	tfsfû˙t_t
;

257 
	#__fsfû˙t_t_deföed


	)

261 #ifde‡
__USE_LARGEFILE64


262 
__blk˙t64_t
 
	tblk˙t64_t
;

263 
__fsblk˙t64_t
 
	tfsblk˙t64_t
;

264 
__fsfû˙t64_t
 
	tfsfû˙t64_t
;

269 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


270 
	~<bôs/±hªadty≥s.h
>

273 
	g__END_DECLS


	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


12 
	#__√ed_wch¨_t


	)

14 
	#__√ed_NULL


	)

15 
	~<°ddef.h
>

16 
	#__√ed_mb°©e_t


	)

17 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


18 
	#__√ed_wöt_t


	)

20 
	~<wch¨.h
>

23 
__off_t
 
	m__pos
;

24 
__mb°©e_t
 
	m__°©e
;

25 } 
	t_G_Âos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos64_t
;

31 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gc⁄v.h
>

35 
__gc⁄v_öfo
 
	m__cd
;

38 
__gc⁄v_öfo
 
	m__cd
;

39 
__gc⁄v_°ï_d©a
 
	m__d©a
;

40 } 
	m__comböed
;

41 } 
	t_G_ic⁄v_t
;

46 
	#_G_va_li°
 
__gnuc_va_li°


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/bits/fcntl-linux.h

19 #i‚def 
_FCNTL_H


37 #ifde‡
__USE_GNU


38 
	~<bôs/uio.h
>

42 
	#O_ACCMODE
 0003

	)

43 
	#O_RDONLY
 00

	)

44 
	#O_WRONLY
 01

	)

45 
	#O_RDWR
 02

	)

46 #i‚de‡
O_CREAT


47 
	#O_CREAT
 0100

	)

49 #i‚de‡
O_EXCL


50 
	#O_EXCL
 0200

	)

52 #i‚de‡
O_NOCTTY


53 
	#O_NOCTTY
 0400

	)

55 #i‚de‡
O_TRUNC


56 
	#O_TRUNC
 01000

	)

58 #i‚de‡
O_APPEND


59 
	#O_APPEND
 02000

	)

61 #i‚de‡
O_NONBLOCK


62 
	#O_NONBLOCK
 04000

	)

64 #i‚de‡
O_NDELAY


65 
	#O_NDELAY
 
O_NONBLOCK


	)

67 #i‚de‡
O_SYNC


68 
	#O_SYNC
 04010000

	)

70 
	#O_FSYNC
 
O_SYNC


	)

71 #i‚de‡
O_ASYNC


72 
	#O_ASYNC
 020000

	)

74 #i‚de‡
__O_LARGEFILE


75 
	#__O_LARGEFILE
 0100000

	)

78 #i‚de‡
__O_DIRECTORY


79 
	#__O_DIRECTORY
 0200000

	)

81 #i‚de‡
__O_NOFOLLOW


82 
	#__O_NOFOLLOW
 0400000

	)

84 #i‚de‡
__O_CLOEXEC


85 
	#__O_CLOEXEC
 02000000

	)

87 #i‚de‡
__O_DIRECT


88 
	#__O_DIRECT
 040000

	)

90 #i‚de‡
__O_NOATIME


91 
	#__O_NOATIME
 01000000

	)

93 #i‚de‡
__O_PATH


94 
	#__O_PATH
 010000000

	)

96 #i‚de‡
__O_DSYNC


97 
	#__O_DSYNC
 010000

	)

99 #i‚de‡
__O_TMPFILE


100 
	#__O_TMPFILE
 (020000000 | 
__O_DIRECTORY
)

	)

103 #i‚de‡
F_GETLK


104 #i‚de‡
__USE_FILE_OFFSET64


105 
	#F_GETLK
 5

	)

106 
	#F_SETLK
 6

	)

107 
	#F_SETLKW
 7

	)

109 
	#F_GETLK
 
F_GETLK64


	)

110 
	#F_SETLK
 
F_SETLK64


	)

111 
	#F_SETLKW
 
F_SETLKW64


	)

114 #i‚de‡
F_GETLK64


115 
	#F_GETLK64
 12

	)

116 
	#F_SETLK64
 13

	)

117 
	#F_SETLKW64
 14

	)

120 #ifde‡
__USE_FILE_OFFSET64


132 #ifde‡
__USE_GNU


133 
	#F_OFD_GETLK
 36

	)

134 
	#F_OFD_SETLK
 37

	)

135 
	#F_OFD_SETLKW
 38

	)

139 #ifde‡
__USE_LARGEFILE64


140 
	#O_LARGEFILE
 
__O_LARGEFILE


	)

143 #ifde‡
__USE_XOPEN2K8


144 
	#O_DIRECTORY
 
__O_DIRECTORY


	)

145 
	#O_NOFOLLOW
 
__O_NOFOLLOW


	)

146 
	#O_CLOEXEC
 
__O_CLOEXEC


	)

149 #ifde‡
__USE_GNU


150 
	#O_DIRECT
 
__O_DIRECT


	)

151 
	#O_NOATIME
 
__O_NOATIME


	)

152 
	#O_PATH
 
__O_PATH


	)

153 
	#O_TMPFILE
 
__O_TMPFILE


	)

159 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


160 
	#O_DSYNC
 
__O_DSYNC


	)

161 #i‡
deföed
 
__O_RSYNC


162 
	#O_RSYNC
 
__O_RSYNC


	)

164 
	#O_RSYNC
 
O_SYNC


	)

169 
	#F_DUPFD
 0

	)

170 
	#F_GETFD
 1

	)

171 
	#F_SETFD
 2

	)

172 
	#F_GETFL
 3

	)

173 
	#F_SETFL
 4

	)

175 #i‚de‡
__F_SETOWN


176 
	#__F_SETOWN
 8

	)

177 
	#__F_GETOWN
 9

	)

180 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


181 
	#F_SETOWN
 
__F_SETOWN


	)

182 
	#F_GETOWN
 
__F_GETOWN


	)

185 #i‚de‡
__F_SETSIG


186 
	#__F_SETSIG
 10

	)

187 
	#__F_GETSIG
 11

	)

189 #i‚de‡
__F_SETOWN_EX


190 
	#__F_SETOWN_EX
 15

	)

191 
	#__F_GETOWN_EX
 16

	)

194 #ifde‡
__USE_GNU


195 
	#F_SETSIG
 
__F_SETSIG


	)

196 
	#F_GETSIG
 
__F_GETSIG


	)

197 
	#F_SETOWN_EX
 
__F_SETOWN_EX


	)

198 
	#F_GETOWN_EX
 
__F_GETOWN_EX


	)

201 #ifde‡
__USE_GNU


202 
	#F_SETLEASE
 1024

	)

203 
	#F_GETLEASE
 1025

	)

204 
	#F_NOTIFY
 1026

	)

205 
	#F_SETPIPE_SZ
 1031

	)

206 
	#F_GETPIPE_SZ
 1032

	)

208 #ifde‡
__USE_XOPEN2K8


209 
	#F_DUPFD_CLOEXEC
 1030

	)

214 
	#FD_CLOEXEC
 1

	)

216 #i‚de‡
F_RDLCK


218 
	#F_RDLCK
 0

	)

219 
	#F_WRLCK
 1

	)

220 
	#F_UNLCK
 2

	)

225 #i‚de‡
F_EXLCK


226 
	#F_EXLCK
 4

	)

227 
	#F_SHLCK
 8

	)

230 #ifde‡
__USE_BSD


232 
	#LOCK_SH
 1

	)

233 
	#LOCK_EX
 2

	)

234 
	#LOCK_NB
 4

	)

236 
	#LOCK_UN
 8

	)

239 #ifde‡
__USE_GNU


240 
	#LOCK_MAND
 32

	)

241 
	#LOCK_READ
 64

	)

242 
	#LOCK_WRITE
 128

	)

243 
	#LOCK_RW
 192

	)

246 #ifde‡
__USE_GNU


248 
	#DN_ACCESS
 0x00000001

	)

249 
	#DN_MODIFY
 0x00000002

	)

250 
	#DN_CREATE
 0x00000004

	)

251 
	#DN_DELETE
 0x00000008

	)

252 
	#DN_RENAME
 0x00000010

	)

253 
	#DN_ATTRIB
 0x00000020

	)

254 
	#DN_MULTISHOT
 0x80000000

	)

258 #ifde‡
__USE_GNU


260 
	e__pid_ty≥


262 
	mF_OWNER_TID
 = 0,

263 
	mF_OWNER_PID
,

264 
	mF_OWNER_PGRP
,

265 
	mF_OWNER_GID
 = 
F_OWNER_PGRP


269 
	sf_ow√r_ex


271 
__pid_ty≥
 
	mty≥
;

272 
__pid_t
 
	mpid
;

278 #ifdef 
__USE_BSD


279 
	#FAPPEND
 
O_APPEND


	)

280 
	#FFSYNC
 
O_FSYNC


	)

281 
	#FASYNC
 
O_ASYNC


	)

282 
	#FNONBLOCK
 
O_NONBLOCK


	)

283 
	#FNDELAY
 
O_NDELAY


	)

286 #i‚de‡
__POSIX_FADV_DONTNEED


287 
	#__POSIX_FADV_DONTNEED
 4

	)

288 
	#__POSIX_FADV_NOREUSE
 5

	)

291 #ifde‡
__USE_XOPEN2K


292 
	#POSIX_FADV_NORMAL
 0

	)

293 
	#POSIX_FADV_RANDOM
 1

	)

294 
	#POSIX_FADV_SEQUENTIAL
 2

	)

295 
	#POSIX_FADV_WILLNEED
 3

	)

296 
	#POSIX_FADV_DONTNEED
 
__POSIX_FADV_DONTNEED


	)

297 
	#POSIX_FADV_NOREUSE
 
__POSIX_FADV_NOREUSE


	)

301 #ifde‡
__USE_GNU


303 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

306 
	#SYNC_FILE_RANGE_WRITE
 2

	)

309 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

314 
	#SPLICE_F_MOVE
 1

	)

315 
	#SPLICE_F_NONBLOCK
 2

	)

318 
	#SPLICE_F_MORE
 4

	)

319 
	#SPLICE_F_GIFT
 8

	)

323 
	~<löux/ÁŒoc.h
>

327 
	sfûe_h™dÀ


329 
	mh™dÀ_byãs
;

330 
	mh™dÀ_ty≥
;

332 
	mf_h™dÀ
[0];

336 
	#MAX_HANDLE_SZ
 128

	)

339 
	g__BEGIN_DECLS


341 #ifde‡
__USE_GNU


344 
ssize_t
 
	$ªadahód
 (
__fd
, 
__off64_t
 
__off£t
, 
size_t
 
__cou¡
)

345 
__THROW
;

352 
	`sync_fûe_ønge
 (
__fd
, 
__off64_t
 
__off£t
, __off64_à
__cou¡
,

353 
__Êags
);

360 
ssize_t
 
	`vm•li˚
 (
__fdout
, c⁄° 
iovec
 *
__iov
,

361 
size_t
 
__cou¡
, 
__Êags
);

367 
ssize_t
 
	`•li˚
 (
__fdö
, 
__off64_t
 *
__offö
, 
__fdout
,

368 
__off64_t
 *
__offout
, 
size_t
 
__Àn
,

369 
__Êags
);

375 
ssize_t
 
	`ãe
 (
__fdö
, 
__fdout
, 
size_t
 
__Àn
,

376 
__Êags
);

382 #i‚de‡
__USE_FILE_OFFSET64


383 
	`ÁŒoˇã
 (
__fd
, 
__mode
, 
__off_t
 
__off£t
, __off_à
__Àn
);

385 #ifde‡
__REDIRECT


386 
	`__REDIRECT
 (
ÁŒoˇã
, (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

387 
__off64_t
 
__Àn
),

388 
ÁŒoˇã64
);

390 
	#ÁŒoˇã
 
ÁŒoˇã64


	)

393 #ifde‡
__USE_LARGEFILE64


394 
	`ÁŒoˇã64
 (
__fd
, 
__mode
, 
__off64_t
 
__off£t
,

395 
__off64_t
 
__Àn
);

400 
	$«me_to_h™dÀ_©
 (
__dfd
, c⁄° *
__«me
,

401 
fûe_h™dÀ
 *
__h™dÀ
, *
__m¡_id
,

402 
__Êags
Ë
__THROW
;

408 
	`›í_by_h™dÀ_©
 (
__mou¡dúfd
, 
fûe_h™dÀ
 *
__h™dÀ
,

409 
__Êags
);

413 
__END_DECLS


	@/usr/include/bits/libio-ldbl.h

19 #i‚de‡
_IO_STDIO_H


23 
	$__LDBL_REDIR_DECL
 (
_IO_vfsˇnf
)

24 
	`__LDBL_REDIR_DECL
 (
_IO_vÂrötf
)

	@/usr/include/bits/pthreadtypes.h

18 #i‚de‡
_BITS_PTHREADTYPES_H


19 
	#_BITS_PTHREADTYPES_H
 1

	)

21 
	~<bôs/w‹dsize.h
>

23 #ifde‡
__x86_64__


24 #i‡
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

26 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

27 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

28 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

29 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

30 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

31 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

32 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

33 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

35 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

36 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

37 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

38 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

39 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

40 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

41 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

43 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

46 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

47 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

48 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

49 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

50 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

51 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

52 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

53 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

54 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

60 
	t±hªad_t
;

63 
	u±hªad_©å_t


65 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

66 
	m__Æign
;

68 #i‚de‡
__have_±hªad_©å_t


69 
±hªad_©å_t
 
	t±hªad_©å_t
;

70 
	#__have_±hªad_©å_t
 1

	)

74 #ifde‡
__x86_64__


75 
	s__±hªad_öã∫Æ_li°


77 
__±hªad_öã∫Æ_li°
 *
	m__¥ev
;

78 
__±hªad_öã∫Æ_li°
 *
	m__√xt
;

79 } 
	t__±hªad_li°_t
;

81 
	s__±hªad_öã∫Æ_¶i°


83 
__±hªad_öã∫Æ_¶i°
 *
	m__√xt
;

84 } 
	t__±hªad_¶i°_t
;

92 
	s__±hªad_muãx_s


94 
	m__lock
;

95 
	m__cou¡
;

96 
	m__ow√r
;

97 #ifde‡
__x86_64__


98 
	m__nu£rs
;

102 
	m__köd
;

103 #ifde‡
__x86_64__


104 
	m__•ös
;

105 
	m__ñisi⁄
;

106 
__±hªad_li°_t
 
	m__li°
;

107 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

109 
	#__PTHREAD_SPINS
 0, 0

	)

111 
	m__nu£rs
;

112 
__exãnsi⁄__
 union

116 
	m__e•ös
;

117 
	m__ñisi⁄
;

118 
	#__•ös
 
__ñisi⁄_d©a
.
__e•ös


	)

119 
	#__ñisi⁄
 
__ñisi⁄_d©a
.
__ñisi⁄


	)

120 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

121 } 
	m__ñisi⁄_d©a
;

122 
__±hªad_¶i°_t
 
	m__li°
;

125 } 
	m__d©a
;

126 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

127 
	m__Æign
;

128 } 
	t±hªad_muãx_t
;

132 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

133 
	m__Æign
;

134 } 
	t±hªad_muãx©å_t
;

143 
	m__lock
;

144 
	m__fuãx
;

145 
__exãnsi⁄__
 
	m__tŸÆ_£q
;

146 
__exãnsi⁄__
 
	m__wakeup_£q
;

147 
__exãnsi⁄__
 
	m__wokí_£q
;

148 *
	m__muãx
;

149 
	m__nwaôîs
;

150 
	m__brﬂdˇ°_£q
;

151 } 
	m__d©a
;

152 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

153 
__exãnsi⁄__
 
	m__Æign
;

154 } 
	t±hªad_c⁄d_t
;

158 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

159 
	m__Æign
;

160 } 
	t±hªad_c⁄d©å_t
;

164 
	t±hªad_key_t
;

168 
	t±hªad_⁄˚_t
;

171 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


176 #ifde‡
__x86_64__


179 
	m__lock
;

180 
	m__ƒ_ªadîs
;

181 
	m__ªadîs_wakeup
;

182 
	m__wrôî_wakeup
;

183 
	m__ƒ_ªadîs_queued
;

184 
	m__ƒ_wrôîs_queued
;

185 
	m__wrôî
;

186 
	m__sh¨ed
;

187 
	m__∑d1
;

188 
	m__∑d2
;

191 
	m__Êags
;

192 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

193 } 
	m__d©a
;

197 
	m__lock
;

198 
	m__ƒ_ªadîs
;

199 
	m__ªadîs_wakeup
;

200 
	m__wrôî_wakeup
;

201 
	m__ƒ_ªadîs_queued
;

202 
	m__ƒ_wrôîs_queued
;

205 
	m__Êags
;

206 
	m__sh¨ed
;

207 
	m__∑d1
;

208 
	m__∑d2
;

209 
	m__wrôî
;

210 } 
	m__d©a
;

212 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

213 
	m__Æign
;

214 } 
	t±hªad_rwlock_t
;

218 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

219 
	m__Æign
;

220 } 
	t±hªad_rwlock©å_t
;

224 #ifde‡
__USE_XOPEN2K


226 vﬁ©ûê
	t±hªad_•ölock_t
;

233 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

234 
	m__Æign
;

235 } 
	t±hªad_b¨rõr_t
;

239 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

240 
	m__Æign
;

241 } 
	t±hªad_b¨rõøâr_t
;

245 #i‚de‡
__x86_64__


247 
	#__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
	`__ªg∑rm__
 (1)))

	)

	@/usr/include/bits/stdio-lock.h

19 #i‚de‡
_BITS_STDIO_LOCK_H


20 
	#_BITS_STDIO_LOCK_H
 1

	)

22 
	~<bôs/libc-lock.h
>

24 
	$__libc_lock_deföe_ªcursive
 (, 
_IO_lock_t
)

27 #ifde‡
	t_LIBC_LOCK_RECURSIVE_INITIALIZER


28 
	t_IO_lock_öôülizî
 
	t_LIBC_LOCK_RECURSIVE_INITIALIZER


	)

29 #ñi‡
	t_IO_MTSAFE_IO


30 #îr‹ 
	tlibio
 
	t√eds
 
	tªcursive
 
	tmuãxes
 
	t_IO_MTSAFE_IO


33 
	t_IO_lock_öô
(
	t_«me
Ë
	t__libc_lock_öô_ªcursive
 (_«me)

	)

34 
	t_IO_lock_föi
(
	t_«me
Ë
	t__libc_lock_föi_ªcursive
 (_«me)

	)

35 
	t_IO_lock_lock
(
	t_«me
Ë
	t__libc_lock_lock_ªcursive
 (_«me)

	)

36 
	t_IO_lock_åylock
(
	t_«me
Ë
	t__libc_lock_åylock_ªcursive
 (_«me)

	)

37 
	t_IO_lock_u∆ock
(
	t_«me
Ë
	t__libc_lock_u∆ock_ªcursive
 (_«me)

	)

40 
	t_IO_˛ónup_ªgi⁄_°¨t
(
	t_f˘
, 
	t_Â
) \

41 
	t__libc_˛ónup_ªgi⁄_°¨t
 (((
	t_Â
)->
	t_Êags
 & 
	t_IO_USER_LOCK
Ë=0, 
	t_f˘
, _Â)

	)

42 
	t_IO_˛ónup_ªgi⁄_°¨t_nﬂrg
(
	t_f˘
) \

43 
	t__libc_˛ónup_ªgi⁄_°¨t
 (1, 
	t_f˘
, 
	tNULL
)

	)

44 
	t_IO_˛ónup_ªgi⁄_íd
(
	t_doô
) \

45 
	t__libc_˛ónup_ªgi⁄_íd
 (
	t_doô
)

	)

47 #i‡
	tdeföed
 
	t_LIBC
 && 
	tIS_IN
 (
	tlibc
)

48 
	t_IO_acquúe_lock
(
	t_Â
) \

49 
	t_IO_˛ónup_ªgi⁄_°¨t
 (((*Ë(*)Ë
	t_IO_fu∆ockfûe
, (
	t_Â
)); \

50 
	`_IO_Êockfûe
 (
_Â
)

	)

52 
	#_IO_ªÀa£_lock
(
_Â
) \

53 
	`_IO_fu∆ockfûe
 (
_Â
); \

54 
	`_IO_˛ónup_ªgi⁄_íd
 (0)

	)

	@/usr/include/bits/timex.h

18 #i‚def 
_BITS_TIMEX_H


19 
	#_BITS_TIMEX_H
 1

	)

21 
	~<bôs/ty≥s.h
>

25 
	stimex


27 
	mmodes
;

28 
__sysˇŒ_¶⁄g_t
 
	moff£t
;

29 
__sysˇŒ_¶⁄g_t
 
	m‰eq
;

30 
__sysˇŒ_¶⁄g_t
 
	mmaxîr‹
;

31 
__sysˇŒ_¶⁄g_t
 
	me°îr‹
;

32 
	m°©us
;

33 
__sysˇŒ_¶⁄g_t
 
	mc⁄°™t
;

34 
__sysˇŒ_¶⁄g_t
 
	m¥ecisi⁄
;

35 
__sysˇŒ_¶⁄g_t
 
	mtﬁî™˚
;

36 
timevÆ
 
	mtime
;

37 
__sysˇŒ_¶⁄g_t
 
	mtick
;

38 
__sysˇŒ_¶⁄g_t
 
	mµs‰eq
;

39 
__sysˇŒ_¶⁄g_t
 
	mjôãr
;

40 
	mshi·
;

41 
__sysˇŒ_¶⁄g_t
 
	m°abû
;

42 
__sysˇŒ_¶⁄g_t
 
	mjô˙t
;

43 
__sysˇŒ_¶⁄g_t
 
	mˇl˙t
;

44 
__sysˇŒ_¶⁄g_t
 
	mîr˙t
;

45 
__sysˇŒ_¶⁄g_t
 
	m°b˙t
;

47 
	mèi
;

56 
	#ADJ_OFFSET
 0x0001

	)

57 
	#ADJ_FREQUENCY
 0x0002

	)

58 
	#ADJ_MAXERROR
 0x0004

	)

59 
	#ADJ_ESTERROR
 0x0008

	)

60 
	#ADJ_STATUS
 0x0010

	)

61 
	#ADJ_TIMECONST
 0x0020

	)

62 
	#ADJ_TAI
 0x0080

	)

63 
	#ADJ_MICRO
 0x1000

	)

64 
	#ADJ_NANO
 0x2000

	)

65 
	#ADJ_TICK
 0x4000

	)

66 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

67 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

70 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

71 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

72 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

73 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

74 
	#MOD_STATUS
 
ADJ_STATUS


	)

75 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

76 
	#MOD_CLKB
 
ADJ_TICK


	)

77 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

78 
	#MOD_TAI
 
ADJ_TAI


	)

79 
	#MOD_MICRO
 
ADJ_MICRO


	)

80 
	#MOD_NANO
 
ADJ_NANO


	)

84 
	#STA_PLL
 0x0001

	)

85 
	#STA_PPSFREQ
 0x0002

	)

86 
	#STA_PPSTIME
 0x0004

	)

87 
	#STA_FLL
 0x0008

	)

89 
	#STA_INS
 0x0010

	)

90 
	#STA_DEL
 0x0020

	)

91 
	#STA_UNSYNC
 0x0040

	)

92 
	#STA_FREQHOLD
 0x0080

	)

94 
	#STA_PPSSIGNAL
 0x0100

	)

95 
	#STA_PPSJITTER
 0x0200

	)

96 
	#STA_PPSWANDER
 0x0400

	)

97 
	#STA_PPSERROR
 0x0800

	)

99 
	#STA_CLOCKERR
 0x1000

	)

100 
	#STA_NANO
 0x2000

	)

101 
	#STA_MODE
 0x4000

	)

102 
	#STA_CLK
 0x8000

	)

105 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

106 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@/usr/include/bits/typesizes.h

19 #i‚de‡
_BITS_TYPES_H


23 #i‚def 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifde‡
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 såu˘ { 
__vÆ
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

75 #ifde‡
__x86_64__


79 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

82 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/ctype.h

23 #i‚def 
_CTYPE_H


24 
	#_CTYPE_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 
	g__BEGIN_DECLS


31 #i‚de‡
_ISbô


40 
	~<ídün.h
>

41 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


42 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

44 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

49 
	m_ISuµî
 = 
_ISbô
 (0),

50 
	m_ISlowî
 = 
_ISbô
 (1),

51 
	m_ISÆpha
 = 
_ISbô
 (2),

52 
	m_ISdigô
 = 
_ISbô
 (3),

53 
	m_ISxdigô
 = 
_ISbô
 (4),

54 
	m_IS•a˚
 = 
_ISbô
 (5),

55 
	m_IS¥öt
 = 
_ISbô
 (6),

56 
	m_ISgøph
 = 
_ISbô
 (7),

57 
	m_ISbœnk
 = 
_ISbô
 (8),

58 
	m_IS˙ål
 = 
_ISbô
 (9),

59 
	m_ISpun˘
 = 
_ISbô
 (10),

60 
	m_ISÆnum
 = 
_ISbô
 (11)

80 c⁄° **
	$__˘y≥_b_loc
 ()

81 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

82 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

83 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

84 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

85 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

88 #i‚de‡
__˝lu•lus


89 
	#__is˘y≥
(
c
, 
ty≥
) \

90 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

91 #ñi‡
deföed
 
__USE_EXTERN_INLINES


92 
	#__is˘y≥_f
(
ty≥
) \

93 
__exã∫_ölöe
 \

94 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

96  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

97 
	}

	)
}

100 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

101 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

103 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

105 
__BEGIN_NAMESPACE_STD


111 
__ex˘y≥
 (
iß um
);

112 
__ex˘y≥
 (
ißÕha
);

113 
__ex˘y≥
 (
is˙ål
);

114 
__ex˘y≥
 (
isdigô
);

115 
__ex˘y≥
 (
i¶owî
);

116 
__ex˘y≥
 (
isgøph
);

117 
__ex˘y≥
 (
i•röt
);

118 
__ex˘y≥
 (
i•un˘
);

119 
__ex˘y≥
 (
is•a˚
);

120 
__ex˘y≥
 (
isuµî
);

121 
__ex˘y≥
 (
isxdigô
);

125 
	$tﬁowî
 (
__c
Ë
__THROW
;

128 
	$touµî
 (
__c
Ë
__THROW
;

130 
__END_NAMESPACE_STD


134 #ifdef 
__USE_ISOC99


135 
__BEGIN_NAMESPACE_C99


137 
	`__ex˘y≥
 (
isbœnk
);

139 
__END_NAMESPACE_C99


142 #ifde‡
__USE_GNU


144 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

147 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


151 
	$ißscii
 (
__c
Ë
__THROW
;

155 
	$tﬂscii
 (
__c
Ë
__THROW
;

159 
	`__ex˘y≥
 (
_touµî
);

160 
	`__ex˘y≥
 (
_tﬁowî
);

164 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

165 (
__exãnsi⁄__
 \

166 ({ 
__ªs
; \

167 i‡( (
c
) > 1) \

169 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

171 
__c
 = (
c
); \

172 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

175 
__ªs
 = 
f
 
¨gs
; \

178 
__ªs
 = (
a
)[(Ë(
c
)]; \

179 
__ªs
; 
	}
}))

	)

181 #i‡!
deföed
 
__NO_CTYPE


182 #ifde‡
__is˘y≥_f


183 
	$__is˘y≥_f
 (
Ænum
)

184 
	$__is˘y≥_f
 (
Æpha
)

185 
	$__is˘y≥_f
 (
˙ål
)

186 
	$__is˘y≥_f
 (
digô
)

187 
	$__is˘y≥_f
 (
lowî
)

188 
	$__is˘y≥_f
 (
gøph
)

189 
	$__is˘y≥_f
 (
¥öt
)

190 
	$__is˘y≥_f
 (
pun˘
)

191 
	$__is˘y≥_f
 (
•a˚
)

192 
	$__is˘y≥_f
 (
uµî
)

193 
	$__is˘y≥_f
 (
xdigô
)

194 #ifde‡
__USE_ISOC99


195 
	$__is˘y≥_f
 (
bœnk
)

197 #ñi‡
deföed
 
__is˘y≥


198 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

199 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

200 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

201 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

202 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

203 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

204 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

205 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

206 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

207 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

208 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

209 #ifde‡
__USE_ISOC99


210 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

214 #ifde‡
__USE_EXTERN_INLINES


215 
__exã∫_ölöe
 

216 
	`__NTH
 (
	$tﬁowî
 (
__c
))

218  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

219 
	}
}

221 
__exã∫_ölöe
 

222 
__NTH
 (
	$touµî
 (
__c
))

224  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

225 
	}
}

228 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


229 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

230 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

233 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


234 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

235 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

237 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

238 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

244 #ifde‡
__USE_XOPEN2K8


258 
	~<xloˇÀ.h
>

262 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

263 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

265 
	#__ex˘y≥_l
(
«me
) \

266 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

272 
__ex˘y≥_l
 (
iß um_l
);

273 
__ex˘y≥_l
 (
ißÕha_l
);

274 
__ex˘y≥_l
 (
is˙ål_l
);

275 
__ex˘y≥_l
 (
isdigô_l
);

276 
__ex˘y≥_l
 (
i¶owî_l
);

277 
__ex˘y≥_l
 (
isgøph_l
);

278 
__ex˘y≥_l
 (
i•röt_l
);

279 
__ex˘y≥_l
 (
i•un˘_l
);

280 
__ex˘y≥_l
 (
is•a˚_l
);

281 
__ex˘y≥_l
 (
isuµî_l
);

282 
__ex˘y≥_l
 (
isxdigô_l
);

284 
__ex˘y≥_l
 (
isbœnk_l
);

288 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

289 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

293 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

295 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


296 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

297 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

298 
	#__touµî_l
(
c
, 
loˇÀ
) \

299 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

300 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

301 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

305 #i‚de‡
__NO_CTYPE


306 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

307 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

308 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

309 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

310 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

311 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

312 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

313 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

314 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

315 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

316 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

318 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

320 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


321 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

322 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

325 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

326 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

327 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

328 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

329 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

330 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

331 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

332 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

333 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

334 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

335 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

337 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

339 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


340 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

341 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

348 
__END_DECLS


	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 #i‡
__GLIBC_HAVE_LONG_LONG


74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

81 
	#htobe16
(
x
Ë(x)

	)

82 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

83 
	#be16toh
(
x
Ë(x)

	)

84 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

86 
	#htobe32
(
x
Ë(x)

	)

87 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

88 
	#be32toh
(
x
Ë(x)

	)

89 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

91 #i‡
__GLIBC_HAVE_LONG_LONG


92 
	#htobe64
(
x
Ë(x)

	)

93 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

94 
	#be64toh
(
x
Ë(x)

	)

95 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/gnu/stubs.h

6 #i‡!
deföed
 
__x86_64__


7 
	~<gnu/°ubs-32.h
>

9 #i‡
deföed
 
__x86_64__
 && deföed 
__LP64__


10 
	~<gnu/°ubs-64.h
>

12 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


13 
	~<gnu/°ubs-x32.h
>

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

30 
	#__STDC_IEC_559__
 1

	)

31 
	#__STDC_IEC_559_COMPLEX__
 1

	)

35 
	#__STDC_ISO_10646__
 201103L

	)

38 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/sys/cdefs.h

19 #i‚def 
_SYS_CDEFS_H


20 
	#_SYS_CDEFS_H
 1

	)

23 #i‚de‡
_FEATURES_H


24 
	~<„©uªs.h
>

30 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


35 #unde‡
__P


36 #unde‡
__PMT


38 #ifde‡
__GNUC__


42 #i‡
__GNUC_PREREQ
 (4, 6Ë&& !
deföed
 
_LIBC


43 
	#__LEAF
 , 
__Àaf__


	)

44 
	#__LEAF_ATTR
 
	`__©åibuã__
 ((
__Àaf__
))

	)

46 
	#__LEAF


	)

47 
	#__LEAF_ATTR


	)

55 #i‡!
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (3, 3)

56 
	#__THROW
 
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
))

	)

57 
	#__THROWNL
 
	`__©åibuã__
 ((
__nŸhrow__
))

	)

58 
	#__NTH
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
)Ë
	)
fct

60 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
f˘
Ë
__LEAF_ATTR
 f˘ 
	`throw
 ()

	)

65 
	#__THROW


	)

66 
	#__THROWNL


	)

67 
	#__NTH
(
f˘
Ë
	)
fct

73 
	#__ölöe


	)

75 
	#__THROW


	)

76 
	#__THROWNL


	)

77 
	#__NTH
(
f˘
Ë
	)
fct

83 
	#__P
(
¨gs
Ë
	)
args

84 
	#__PMT
(
¨gs
Ë
	)
args

89 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

90 
	#__STRING
(
x
Ë#x

	)

93 
	#__±r_t
 *

	)

94 
	#__l⁄g_doubÀ_t
 

	)

98 #ifdef 
__˝lu•lus


99 
	#__BEGIN_DECLS
 "C" {

	)

100 
	#__END_DECLS
 }

	)

102 
	#__BEGIN_DECLS


	)

103 
	#__END_DECLS


	)

112 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES


113 
	#__BEGIN_NAMESPACE_STD
 
«me•a˚
 
°d
 {

	)

114 
	#__END_NAMESPACE_STD
 }

	)

115 
	#__USING_NAMESPACE_STD
(
«me
Ë
usög
 
°d
::«me;

	)

116 
	#__BEGIN_NAMESPACE_C99
 
«me•a˚
 
__c99
 {

	)

117 
	#__END_NAMESPACE_C99
 }

	)

118 
	#__USING_NAMESPACE_C99
(
«me
Ë
usög
 
__c99
::«me;

	)

123 
	#__BEGIN_NAMESPACE_STD


	)

124 
	#__END_NAMESPACE_STD


	)

125 
	#__USING_NAMESPACE_STD
(
«me
)

	)

126 
	#__BEGIN_NAMESPACE_C99


	)

127 
	#__END_NAMESPACE_C99


	)

128 
	#__USING_NAMESPACE_C99
(
«me
)

	)

133 #i‚de‡
__BOUNDED_POINTERS__


134 
	#__bounded


	)

135 
	#__unbounded


	)

136 
	#__±rvÆue


	)

141 
	#__bos
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

142 
	#__bos0
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 0)

	)

144 #i‡
__GNUC_PREREQ
 (4,3)

145 
	#__w¨nde˛
(
«me
, 
msg
) \

146 
	`«me
 (Ë
	`__©åibuã__
((
	`__w¨nög__
 (
msg
)))

	)

147 
	#__w¨«âr
(
msg
Ë
	`__©åibuã__
((
	`__w¨nög__
 (msg)))

	)

148 
	#__îr‹de˛
(
«me
, 
msg
) \

149 
	`«me
 (Ë
	`__©åibuã__
((
	`__îr‹__
 (
msg
)))

	)

151 
	#__w¨nde˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

152 
	#__w¨«âr
(
msg
)

	)

153 
	#__îr‹de˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

157 #i‡
__GNUC_PREREQ
 (2,97)

159 
	#__Êex¨r
 []

	)

161 #ifde‡
__GNUC__


162 
	#__Êex¨r
 [0]

	)

164 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

165 
	#__Êex¨r
 []

	)

168 
	#__Êex¨r
 [1]

	)

184 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

186 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

187 #ifde‡
__˝lu•lus


188 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

189 
«me
 
¥Ÿo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

190 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

191 
«me
 
¥Ÿo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

193 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

194 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROW


	)

195 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

196 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROWNL


	)

198 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

199 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
cname

212 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

213 
	#__©åibuã__
(
xyz
Ë

	)

219 #i‡
__GNUC_PREREQ
 (2,96)

220 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

222 
	#__©åibuã_mÆloc__


	)

228 #i‡
__GNUC_PREREQ
 (2,96)

229 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

231 
	#__©åibuã_puª__


	)

235 #i‡
__GNUC_PREREQ
 (2,5)

236 
	#__©åibuã_c⁄°__
 
	`__©åibuã__
 ((
__c⁄°__
))

	)

238 
	#__©åibuã_c⁄°__


	)

244 #i‡
__GNUC_PREREQ
 (3,1)

245 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

246 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

248 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

249 
	#__©åibuã_noölöe__


	)

253 #i‡
__GNUC_PREREQ
 (3,2)

254 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

256 
	#__©åibuã_dïªˇãd__


	)

265 #i‡
__GNUC_PREREQ
 (2,8)

266 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

268 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

275 #i‡
__GNUC_PREREQ
 (2,97)

276 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

277 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

279 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

284 #i‡
__GNUC_PREREQ
 (3,3)

285 
	#__n⁄nuŒ
(
∑øms
Ë
	`__©åibuã__
 ((
__n⁄nuŒ__
Ö¨ams))

	)

287 
	#__n⁄nuŒ
(
∑øms
)

	)

292 #i‡
__GNUC_PREREQ
 (3,4)

293 
	#__©åibuã_w¨n_unu£d_ªsu…__
 \

294 
	`__©åibuã__
 ((
__w¨n_unu£d_ªsu…__
))

	)

295 #i‡
__USE_FORTIFY_LEVEL
 > 0

296 
	#__wur
 
__©åibuã_w¨n_unu£d_ªsu…__


	)

299 
	#__©åibuã_w¨n_unu£d_ªsu…__


	)

301 #i‚de‡
__wur


302 
	#__wur


	)

306 #i‡
__GNUC_PREREQ
 (3,2)

307 
	#__Æways_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__Æways_ölöe__
))

	)

309 
	#__Æways_ölöe
 
__ölöe


	)

314 #i‡
__GNUC_PREREQ
 (4,3)

315 
	#__©åibuã_¨tificül__
 
	`__©åibuã__
 ((
__¨tificül__
))

	)

317 
	#__©åibuã_¨tificül__


	)

329 #i‡(!
deföed
 
__˝lu•lus
 || 
__GNUC_PREREQ
 (4,3) \

330 || (
deföed
 
__˛™g__
 && (deföed 
__GNUC_STDC_INLINE__
 \

331 || 
deföed
 
__GNUC_GNU_INLINE__
)))

332 #i‡
deföed
 
__GNUC_STDC_INLINE__
 || deföed 
__˝lu•lus


333 
	#__exã∫_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

334 
	#__exã∫_Æways_ölöe
 \

335 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

337 
	#__exã∫_ölöe
 
__ölöe


	)

338 
	#__exã∫_Æways_ölöe
 
__Æways_ölöe


	)

342 #ifde‡
__exã∫_Æways_ölöe


343 
	#__f‹tify_fun˘i⁄
 
__exã∫_Æways_ölöe
 
__©åibuã_¨tificül__


	)

348 #i‡
__GNUC_PREREQ
 (4,3)

349 
	#__va_¨g_∑ck
(Ë
	`__buûtö_va_¨g_∑ck
 ()

	)

350 
	#__va_¨g_∑ck_Àn
(Ë
	`__buûtö_va_¨g_∑ck_Àn
 ()

	)

357 #i‡!
__GNUC_PREREQ
 (2,8)

358 
	#__exãnsi⁄__


	)

362 #i‡!
__GNUC_PREREQ
 (2,92)

363 
	#__ª°ri˘


	)

369 #i‡
__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


370 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

372 #ifde‡
__GNUC__


373 
	#__ª°ri˘_¨r


	)

375 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

376 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

379 
	#__ª°ri˘_¨r


	)

384 #i‡
__GNUC__
 >= 3

385 
	#__glibc_u∆ikñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
((c⁄d), 0)

	)

386 
	#__glibc_likñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
((c⁄d), 1)

	)

388 
	#__glibc_u∆ikñy
(
c⁄d
Ë(c⁄d)

	)

389 
	#__glibc_likñy
(
c⁄d
Ë(c⁄d)

	)

392 
	~<bôs/w‹dsize.h
>

394 #i‡
deföed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && deföed 
__NO_LONG_DOUBLE_MATH


395 
	#__LDBL_COMPAT
 1

	)

396 #ifde‡
__REDIRECT


397 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

398 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
) \

399 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

400 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT_NTH
 («me,ÖrŸo,álüs)

	)

401 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
) \

402 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

403 
	#__LDBL_REDIR1_DECL
(
«me
, 
Æüs
) \

404 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 (#Æüs));

	)

405 
	#__LDBL_REDIR_DECL
(
«me
) \

406 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 ("__∆dbl_" #«me));

	)

407 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

408 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

409 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

410 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

413 #i‡!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT


414 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê
	)
proto

415 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
Ë«mê
	)
proto

416 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
__THROW


	)

417 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
Ë«mê¥Ÿÿ
__THROW


	)

418 
	#__LDBL_REDIR_DECL
(
«me
)

	)

419 #ifde‡
__REDIRECT


420 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

421 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

422 
	`__REDIRECT_NTH
 (
«me
, 
¥Ÿo
, 
Æüs
)

	)

	@/usr/include/sys/select.h

21 #i‚de‡
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

30 
	~<bôs/£À˘.h
>

33 
	~<bôs/sig£t.h
>

35 #i‚de‡
__sig£t_t_deföed


36 
	#__sig£t_t_deföed


	)

37 
__sig£t_t
 
	tsig£t_t
;

41 
	#__√ed_time_t


	)

42 
	#__√ed_time•ec


	)

43 
	~<time.h
>

44 
	#__√ed_timevÆ


	)

45 
	~<bôs/time.h
>

47 #i‚de‡
__su£c⁄ds_t_deföed


48 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

49 
	#__su£c⁄ds_t_deföed


	)

54 
	t__fd_mask
;

57 #unde‡
__NFDBITS


59 
	#__NFDBITS
 (8 * (Ë (
__fd_mask
))

	)

60 
	#__FD_ELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

61 
	#__FD_MASK
(
d
Ë((
__fd_mask
Ë1 << ((dË% 
__NFDBITS
))

	)

68 #ifde‡
__USE_XOPEN


69 
__fd_mask
 
	mfds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

70 
	#__FDS_BITS
(
£t
Ë((£t)->
fds_bôs
)

	)

72 
__fd_mask
 
	m__fds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
Ë((£t)->
__fds_bôs
)

	)

75 } 
	tfd_£t
;

78 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

80 #ifde‡
__USE_MISC


82 
__fd_mask
 
	tfd_mask
;

85 
	#NFDBITS
 
__NFDBITS


	)

90 
	#FD_SET
(
fd
, 
fd£ç
Ë
	`__FD_SET
 (fd, fd£ç)

	)

91 
	#FD_CLR
(
fd
, 
fd£ç
Ë
	`__FD_CLR
 (fd, fd£ç)

	)

92 
	#FD_ISSET
(
fd
, 
fd£ç
Ë
	`__FD_ISSET
 (fd, fd£ç)

	)

93 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
 (fd£ç)

	)

96 
__BEGIN_DECLS


106 
£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

107 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

108 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

109 
timevÆ
 *
__ª°ri˘
 
__timeout
);

111 #ifde‡
__USE_XOPEN2K


118 
p£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

119 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

120 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

121 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
,

122 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__sigmask
);

127 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__GNUC__


128 
	~<bôs/£À˘2.h
>

131 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

20 #i‚de‡
_SYS_SYSMACROS_H


21 
	#_SYS_SYSMACROS_H
 1

	)

23 
	~<„©uªs.h
>

28 #ifde‡
__GLIBC_HAVE_LONG_LONG


29 
__BEGIN_DECLS


31 
__exãnsi⁄__


32 
	$gnu_dev_maj‹
 (
__dev
)

33 
__THROW
 
__©åibuã_c⁄°__
;

34 
__exãnsi⁄__


35 
	$gnu_dev_mö‹
 (
__dev
)

36 
__THROW
 
__©åibuã_c⁄°__
;

37 
__exãnsi⁄__


38 
	$gnu_dev_makedev
 (
__maj‹
,

39 
__mö‹
)

40 
__THROW
 
__©åibuã_c⁄°__
;

42 #i‡
deföed
 
__GNUC__
 && __GNUC__ >2 && deföed 
__USE_EXTERN_INLINES


43 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

44 
	`__NTH
 (
	$gnu_dev_maj‹
 (
__dev
))

46  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

47 
	}
}

49 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

50 
__NTH
 (
	$gnu_dev_mö‹
 (
__dev
))

52  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

53 
	}
}

55 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

56 
__NTH
 (
	$gnu_dev_makedev
 (
__maj‹
, 
__mö‹
))

58  ((
__mö‹
 & 0xffË| ((
__maj‹
 & 0xfff) << 8)

59 | (((Ë(
__mö‹
 & ~0xff)) << 12)

60 | (((Ë(
__maj‹
 & ~0xfff)) << 32));

61 
	}
}

63 
	g__END_DECLS


66 
	#maj‹
(
dev
Ë
	`gnu_dev_maj‹
 (dev)

	)

67 
	#mö‹
(
dev
Ë
	`gnu_dev_mö‹
 (dev)

	)

68 
	#makedev
(
maj
, 
mö
Ë
	`gnu_dev_makedev
 (maj, mö)

	)

	@/usr/include/bits/byteswap.h

19 #i‡!
deföed
 
_BYTESWAP_H
 && !deföed 
_NETINET_IN_H
 && !deföed 
_ENDIAN_H


23 #i‚de‡
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

28 
	~<bôs/w‹dsize.h
>

31 
	#__bsw≠_c⁄°™t_16
(
x
) \

32 ((Ë((((
x
Ë>> 8Ë& 0xffË| (((xË& 0xffË<< 8)))

	)

35 
	~<bôs/byãsw≠-16.h
>

38 
	#__bsw≠_c⁄°™t_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
Ë& 0x0000ff00Ë<< 8Ë| (((xË& 0x000000ffË<< 24))

	)

42 #ifde‡
__GNUC__


43 #i‡
__GNUC_PREREQ
 (4, 3)

44 
__ölöe
 

45 
	$__bsw≠_32
 (
__bsx
)

47  
	`__buûtö_bsw≠32
 (
__bsx
);

48 
	}
}

49 #ñi‡
__GNUC__
 >= 2

50 #i‡
__WORDSIZE
 =64 || (
deföed
 
__i486__
 || deföed 
__≥¡ium__
 \

51 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

52 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

53 || 
deföed
 
	g__k6__
 || deföed 
	g__noc⁄a__
 \

54 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__geode__
 \

55 || 
deföed
 
	g__amdÁm10__
)

58 
	#__bsw≠_32
(
x
) \

59 (
__exãnsi⁄__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

62 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

64 
	`__asm__
 ("bsw≠ %0" : "Ù" (
__v
Ë: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw≠_32
(
x
) \

68 (
__exãnsi⁄__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

71 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "Ù" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw≠_32
(
x
) \

83 (
__exãnsi⁄__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_32
 (__x); }))

	)

87 
__ölöe
 

88 
	$__bsw≠_32
 (
__bsx
)

90  
	`__bsw≠_c⁄°™t_32
 (
__bsx
);

91 
	}
}

95 #i‡
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw≠_c⁄°™t_64
(
x
) \

98 (
	`__exãnsi⁄__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
Ë& 0x00000000000000ffuŒË<< 56)))

	)

107 #i‡
__GNUC_PREREQ
 (4, 3)

108 
__ölöe
 
__uöt64_t


109 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

111  
	`__buûtö_bsw≠64
 (
__bsx
);

112 
	}
}

113 #ñi‡
__WORDSIZE
 == 64

114 
	#__bsw≠_64
(
x
) \

115 (
__exãnsi⁄__
 \

116 ({ 
__uöt64_t
 
__v
, 
__x
 = (
x
); \

117 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

118 
__v
 = 
	`__bsw≠_c⁄°™t_64
 (
__x
); \

120 
	`__asm__
 ("bsw≠ %q0" : "Ù" (
__v
Ë: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw≠_64
(
x
) \

124 (
__exãnsi⁄__
 \

125 ({ uni⁄ { 
__exãnsi⁄__
 
__uöt64_t
 
__Œ
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 i‡(
	`__buûtö_c⁄°™t_p
 (
x
)) \

128 
__r
.
__Œ
 = 
	`__bsw≠_c⁄°™t_64
 (
x
); \

131 
__w
.
__Œ
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw≠_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw≠_32
 (
__w
.__l[0]); \

135 
__r
.
__Œ
; }))

	)

137 #ñi‡
__GLIBC_HAVE_LONG_LONG


138 
	#__bsw≠_c⁄°™t_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
Ë& 0x00000000000000ffuŒË<< 56))

	)

148 
__ölöe
 
__uöt64_t


149 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

151  
	`__bsw≠_c⁄°™t_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/endian.h

3 #i‚de‡
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/libc-lock.h

21 #i‚de‡
_BITS_LIBC_LOCK_H


22 
	#_BITS_LIBC_LOCK_H
 1

	)

24 
	~<±hªad.h
>

27 #ifde‡
_IO_MTSAFE_IO


28 
±hªad_muãx_t
 
	t__libc_lock_t
;

29 °ru˘ { 
±hªad_muãx_t
 
	mmuãx
; } 
	t__libc_lock_ªcursive_t
;

30 #ifde‡
__USE_UNIX98


31 
±hªad_rwlock_t
 
	t__libc_rwlock_t
;

33 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

35 
__libc_lock_ªcursive_t
 
	t__πld_lock_ªcursive_t
;

37 
__libc_lock_›aque__
 
	t__libc_lock_t
;

38 
__libc_lock_ªcursive_›aque__
 
	t__libc_lock_ªcursive_t
;

39 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

43 
±hªad_key_t
 
	t__libc_key_t
;

52 
	#__libc_lock_deföe
(
CLASS
,
NAME
) \

53 
CLASS
 
__libc_lock_t
 
NAME
;

	)

54 
	#__libc_rwlock_deföe
(
CLASS
,
NAME
) \

55 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

56 
	#__libc_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

57 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
;

	)

58 
	#__πld_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

59 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
;

	)

70 #i‡
__LT_SPINLOCK_INIT
 == 0

71 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

72 
CLASS
 
__libc_lock_t
 
NAME
;

	)

74 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

75 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

78 
	#__libc_rwlock_deföe_öôülized
(
CLASS
,
NAME
) \

79 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

83 
	#__libc_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

84 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

85 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

86 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

88 
	#__πld_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

89 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

90 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

91 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

93 #i‡
deföed
 
__PIC__


94 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

95 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of
 (
FUNC
Ë*
_‚
 = (FUNC); \

96 
_‚
 !
NULL
 ? (*_‚Ë
ARGS
 : 
ELSE
; }))

	)

98 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

99 (
FUNC
 !
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

101 
	#__libc_maybe_ˇŒ2
(
FUNC
, 
ARGS
, 
ELSE
Ë
	`__libc_maybe_ˇŒ
 (
__
##FUNC, ARGS, ELSE)

	)

105 
	#__libc_lock_öô
(
NAME
) \

106 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_öô
, (&(
NAME
), 
NULL
), 0))

	)

107 
	#__libc_rwlock_öô
(
NAME
) \

108 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_öô
, (&(
NAME
), 
NULL
), 0));

	)

111 
	#__libc_lock_öô_ªcursive
(
NAME
) \

113 i‡(
__±hªad_muãx_öô
 !
NULL
) \

115 
±hªad_muãx©å_t
 
__©å
; \

116 
	`__±hªad_muãx©å_öô
 (&
__©å
); \

117 
	`__±hªad_muãx©å_£ây≥
 (&
__©å
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

118 
	`__±hªad_muãx_öô
 (&(
NAME
).
muãx
, &
__©å
); \

119 
	`__±hªad_muãx©å_de°roy
 (&
__©å
); \

121 } 0);

	)

122 
	#__πld_lock_öô_ªcursive
(
NAME
) \

123 
	`__libc_lock_öô_ªcursive
 (
NAME
)

	)

128 
	#__libc_lock_föi
(
NAME
) \

129 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_de°roy
, (&(
NAME
)), 0));

	)

130 
	#__libc_rwlock_föi
(
NAME
) \

131 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_de°roy
, (&(
NAME
)), 0));

	)

134 
	#__libc_lock_föi_ªcursive
(
NAME
Ë
	`__libc_lock_föi
 ((NAME).
muãx
)

	)

135 
	#__πld_lock_föi_ªcursive
(
NAME
Ë
	`__libc_lock_föi_ªcursive
 (NAME)

	)

138 
	#__libc_lock_lock
(
NAME
) \

139 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_lock
, (&(
NAME
)), 0));

	)

140 
	#__libc_rwlock_rdlock
(
NAME
) \

141 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_rdlock
, (&(
NAME
)), 0));

	)

142 
	#__libc_rwlock_wæock
(
NAME
) \

143 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_wæock
, (&(
NAME
)), 0));

	)

146 
	#__libc_lock_lock_ªcursive
(
NAME
Ë
	`__libc_lock_lock
 ((NAME).
muãx
)

	)

149 
	#__libc_lock_åylock
(
NAME
) \

150 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_åylock
, (&(
NAME
)), 0))

	)

151 
	#__libc_rwlock_åyrdlock
(
NAME
) \

152 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åyrdlock
, (&(
NAME
)), 0))

	)

153 
	#__libc_rwlock_åywæock
(
NAME
) \

154 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åywæock
, (&(
NAME
)), 0))

	)

157 
	#__libc_lock_åylock_ªcursive
(
NAME
Ë
	`__libc_lock_åylock
 ((NAME).
muãx
)

	)

158 
	#__πld_lock_åylock_ªcursive
(
NAME
) \

159 
	`__libc_lock_åylock_ªcursive
 (
NAME
)

	)

162 
	#__libc_lock_u∆ock
(
NAME
) \

163 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_u∆ock
, (&(
NAME
)), 0));

	)

164 
	#__libc_rwlock_u∆ock
(
NAME
) \

165 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_u∆ock
, (&(
NAME
)), 0));

	)

168 
	#__libc_lock_u∆ock_ªcursive
(
NAME
Ë
	`__libc_lock_u∆ock
 ((NAME).
muãx
)

	)

170 
	#__πld_lock_lock_ªcursive
(
NAME
Ë
	`__libc_lock_lock_ªcursive
 (NAME)

	)

171 
	#__πld_lock_u∆ock_ªcursive
(
NAME
Ë
	`__libc_lock_u∆ock_ªcursive
 (NAME)

	)

174 #i‡
PTHREAD_ONCE_INIT
 == 0

177 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

178 
CLASS
 
±hªad_⁄˚_t
 
NAME


	)

180 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

181 
CLASS
 
±hªad_⁄˚_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

185 
	#__libc_⁄˚
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

187 i‡(
__±hªad_⁄˚
 !
NULL
) \

188 
	`__±hªad_⁄˚
 (&(
ONCE_CONTROL
), (
INIT_FUNCTION
)); \

189 i‡((
ONCE_CONTROL
Ë=
PTHREAD_ONCE_INIT
) { \

190 
	`INIT_FUNCTION
 (); \

191 (
ONCE_CONTROL
) = 2; \

193 } 0)

	)

197 
	#__libc_˛ónup_ªgi⁄_°¨t
(
DOIT
, 
FCT
, 
ARG
) \

198 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

199 
_avaû
 = (
DOIT
Ë&& 
_±hªad_˛ónup_push_de„r
 !
NULL
; \

200 i‡(
_avaû
) { \

201 
	`_±hªad_˛ónup_push_de„r
 (&
_buf„r
, (
FCT
), (
ARG
)); \

202 }

	)

205 
	#__libc_˛ónup_ªgi⁄_íd
(
DOIT
) \

206 i‡(
_avaû
) { \

207 
	`_±hªad_˛ónup_p›_ª°‹e
 (&
_buf„r
, (
DOIT
)); \

209 }

	)

212 
	#__libc_˛ónup_íd
(
DOIT
) \

213 i‡(
_avaû
) { \

214 
	`_±hªad_˛ónup_p›_ª°‹e
 (&
_buf„r
, (
DOIT
)); \

215 }

	)

217 
	#__libc_˛ónup_push
(
f˘
, 
¨g
) \

218 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

219 
	`__libc_maybe_ˇŒ
 (
_±hªad_˛ónup_push
, (&
_buf„r
, (
f˘
), (
¨g
)), 0)

	)

221 
	#__libc_˛ónup_p›
(
execuã
) \

222 
	`__libc_maybe_ˇŒ
 (
_±hªad_˛ónup_p›
, (&
_buf„r
, 
execuã
), 0); \

223 }

	)

226 
	#__libc_key_¸óã
(
KEY
, 
DESTRUCTOR
) \

227 (
	`__libc_maybe_ˇŒ
 (
__±hªad_key_¸óã
, (
KEY
, 
DESTRUCTOR
), 1))

	)

230 
	#__libc_gë•ecific
(
KEY
) \

231 (
	`__libc_maybe_ˇŒ
 (
__±hªad_gë•ecific
, (
KEY
), 
NULL
))

	)

234 
	#__libc_£t•ecific
(
KEY
, 
VALUE
) \

235 (
	`__libc_maybe_ˇŒ
 (
__±hªad_£t•ecific
, (
KEY
, 
VALUE
), 0))

	)

239 
	#__libc_©f‹k
(
PREPARE
, 
PARENT
, 
CHILD
) \

240 (
	`__libc_maybe_ˇŒ
 (
__±hªad_©f‹k
, (
PREPARE
, 
PARENT
, 
CHILD
), 0))

	)

242 
__BEGIN_DECLS


244 
_±hªad_˛ónup_push_de„r
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

245 (*
__routöe
) (*),

246 *
__¨g
Ë
__THROW
;

248 
	$_±hªad_˛ónup_p›_ª°‹e
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

249 
__execuã
Ë
__THROW
;

255 
	`__±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

256 
__c⁄°
 
±hªad_muãx©å_t
 *
__muãx_©å
);

258 
	`__±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
);

260 
	`__±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
);

262 
	`__±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
);

264 
	`__±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
);

266 
	`__±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
);

268 
	`__±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
);

270 
	`__±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
,

271 
__köd
);

273 #ifde‡
__USE_UNIX98


274 
	`__±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__rwlock
,

275 
__c⁄°
 
±hªad_rwlock©å_t
 *
__©å
);

277 
	`__±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
);

279 
	`__±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

281 
	`__±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

283 
	`__±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
);

285 
	`__±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
);

287 
	`__±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
);

290 
	`__±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

291 (*
__de°r_fun˘i⁄
) (*));

293 
	`__±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

294 
__c⁄°
 *
__poöãr
);

296 *
	`__±hªad_gë•ecific
 (
±hªad_key_t
 
__key
);

298 
	`__±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

299 (*
__öô_routöe
) ());

301 
	`__±hªad_©f‹k
 ((*
__¥ï¨e
) (),

302 (*
__∑ª¡
) (),

303 (*
__chûd
) ());

305 
__END_DECLS


309 #i‚de‡
__NO_WEAK_PTHREAD_ALIASES


310 #¥agm®
wók
 
__±hªad_muãx_öô


311 #¥agm®
wók
 
__±hªad_muãx_de°roy


312 #¥agm®
wók
 
__±hªad_muãx_lock


313 #¥agm®
wók
 
__±hªad_muãx_åylock


314 #¥agm®
wók
 
__±hªad_muãx_u∆ock


315 #¥agm®
wók
 
__±hªad_muãx©å_öô


316 #¥agm®
wók
 
__±hªad_muãx©å_de°roy


317 #¥agm®
wók
 
__±hªad_muãx©å_£ây≥


318 #¥agm®
wók
 
__±hªad_rwlock_de°roy


319 #¥agm®
wók
 
__±hªad_rwlock_rdlock


320 #¥agm®
wók
 
__±hªad_rwlock_åyrdlock


321 #¥agm®
wók
 
__±hªad_rwlock_wæock


322 #¥agm®
wók
 
__±hªad_rwlock_åywæock


323 #¥agm®
wók
 
__±hªad_rwlock_u∆ock


324 #¥agm®
wók
 
__±hªad_key_¸óã


325 #¥agm®
wók
 
__±hªad_£t•ecific


326 #¥agm®
wók
 
__±hªad_gë•ecific


327 #¥agm®
wók
 
__±hªad_⁄˚


328 #¥agm®
wók
 
__±hªad_öôülize


329 #¥agm®
wók
 
__±hªad_©f‹k


330 #¥agm®
wók
 
_±hªad_˛ónup_push_de„r


331 #¥agm®
wók
 
_±hªad_˛ónup_p›_ª°‹e


332 #¥agm®
wók
 
_±hªad_˛ónup_push


333 #¥agm®
wók
 
_±hªad_˛ónup_p›


338 
	#__libc_muãx_u∆ock
 
__±hªad_muãx_u∆ock


	)

	@/usr/include/bits/select.h

18 #i‚de‡
_SYS_SELECT_H


22 
	~<bôs/w‹dsize.h
>

25 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

27 #i‡
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "°osq"

	)

30 
	#__FD_ZERO_STOS
 "°o¶"

	)

33 
	#__FD_ZERO
(
fd•
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vﬁ©ûe__
 ("˛d;Ñï; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd•
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¨r
 = (
£t
); \

52 
__i
 = 0; __ò<  (
fd_£t
Ë/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¨r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)Ë!0)

	)

	@/usr/include/bits/select2.h

19 #i‚de‡
_SYS_SELECT_H


24 
__fdñt_chk
 (
__d
);

25 
	$__fdñt_w¨n
 (
__d
)

26 
	`__w¨«âr
 ("bit outside of fd_set selected");

27 #unde‡
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__exãnsi⁄__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__buûtö_c⁄°™t_p
 (
__d
) \

32 ? (0 <
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fdñt_w¨n
 (
__d
)) \

35 : 
	`__fdñt_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/sigset.h

20 #i‚def 
_SIGSET_H_ty≥s


21 
	#_SIGSET_H_ty≥s
 1

	)

23 
	t__sig_©omic_t
;

27 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

30 
	m__vÆ
[
_SIGSET_NWORDS
];

31 } 
	t__sig£t_t
;

42 #i‡!
deföed
 
_SIGSET_H_‚s
 && deföed 
_SIGNAL_H


43 
	#_SIGSET_H_‚s
 1

	)

45 #i‚de‡
_EXTERN_INLINE


46 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

50 
	#__sigmask
(
sig
) \

51 (((Ë1Ë<< (((
sig
Ë- 1Ë% (8 *  ())))

	)

54 
	#__sigw‹d
(
sig
Ë(((sigË- 1Ë/ (8 *  ()))

	)

56 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

57 
	#__sigem±y£t
(
£t
) \

58 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

59 
sig£t_t
 *
__£t
 = (
£t
); \

60 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = 0; \

61 0; }))

	)

62 
	#__sigfûl£t
(
£t
) \

63 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

64 
sig£t_t
 *
__£t
 = (
£t
); \

65 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = ~0UL; \

66 0; }))

	)

68 #ifde‡
__USE_GNU


72 
	#__sigi£m±y£t
(
£t
) \

73 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

74 c⁄° 
sig£t_t
 *
__£t
 = (
£t
); \

75 
__ªt
 = 
__£t
->
__vÆ
[--
__˙t
]; \

76 !
__ªt
 && --
__˙t
 >= 0) \

77 
__ªt
 = 
__£t
->
__vÆ
[
__˙t
]; \

78 
__ªt
 =0; }))

	)

79 
	#__sig™d£t
(
de°
, 
À·
, 
right
) \

80 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

81 
sig£t_t
 *
__de°
 = (
de°
); \

82 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

83 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

84 --
__˙t
 >= 0) \

85 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

86 & 
__right
->
__vÆ
[
__˙t
]); \

87 0; }))

	)

88 
	#__sig‹£t
(
de°
, 
À·
, 
right
) \

89 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

90 
sig£t_t
 *
__de°
 = (
de°
); \

91 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

92 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

93 --
__˙t
 >= 0) \

94 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

95 | 
__right
->
__vÆ
[
__˙t
]); \

96 0; }))

	)

103 
__sigismembî
 (c⁄° 
__sig£t_t
 *, );

104 
__sigadd£t
 (
__sig£t_t
 *, );

105 
__sigdñ£t
 (
__sig£t_t
 *, );

107 #ifde‡
__USE_EXTERN_INLINES


108 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

109 
_EXTERN_INLINE
 \

110 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

112 
__mask
 = 
	`__sigmask
 (
__sig
); \

113 
__w‹d
 = 
	`__sigw‹d
 (
__sig
); \

114  
BODY
; \

115 }

	)

117 
__SIGSETFN
 (
__sigismembî
, (
__£t
->
__vÆ
[
__w‹d
] & 
__mask
) ? 1 : 0, const)

118 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__vÆ
[
__w‹d
] |
__mask
), 0), )

119 
__SIGSETFN
 (
__sigdñ£t
, ((
__£t
->
__vÆ
[
__w‹d
] &~
__mask
), 0), )

121 #unde‡
__SIGSETFN


	@/usr/include/bits/uio.h

18 #i‡!
deföed
 
_SYS_UIO_H
 && !deföed 
_FCNTL_H


22 #i‚de‡
_BITS_UIO_H


23 
	#_BITS_UIO_H
 1

	)

25 
	~<sys/ty≥s.h
>

39 
	#UIO_MAXIOV
 1024

	)

43 
	siovec


45 *
	miov_ba£
;

46 
size_t
 
	miov_Àn
;

52 #ifde‡
__USE_GNU


53 #i‡
deföed
 
_SYS_UIO_H
 && !deföed 
_BITS_UIO_H_FOR_SYS_UIO_H


54 
	#_BITS_UIO_H_FOR_SYS_UIO_H
 1

	)

56 
__BEGIN_DECLS


59 
ssize_t
 
	$¥o˚ss_vm_ªadv
 (
pid_t
 
__pid
, c⁄° 
iovec
 *
__lvec
,

60 
__liov˙t
,

61 c⁄° 
iovec
 *
__rvec
,

62 
__riov˙t
,

63 
__Êags
)

64 
__THROW
;

67 
ssize_t
 
	$¥o˚ss_vm_wrôev
 (
pid_t
 
__pid
, c⁄° 
iovec
 *
__lvec
,

68 
__liov˙t
,

69 c⁄° 
iovec
 *
__rvec
,

70 
__riov˙t
,

71 
__Êags
)

72 
__THROW
;

74 
__END_DECLS


	@/usr/include/gconv.h

22 #i‚de‡
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<„©uªs.h
>

26 
	#__√ed_mb°©e_t


	)

27 
	#__√ed_wöt_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gc⁄v_°ï
;

65 
	g__gc⁄v_°ï_d©a
;

66 
	g__gc⁄v_lﬂded_obje˘
;

67 
	g__gc⁄v_å™s_d©a
;

71 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

79 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

80 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

84 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

85 
	t__gc⁄v_°ï_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
) (*, const *,

97 (*
	t__gc⁄v_å™s_quîy_f˘
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

102 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

104 
	s__gc⁄v_å™s_d©a


107 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

108 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

109 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

110 *
__d©a
;

111 
__gc⁄v_å™s_d©a
 *
__√xt
;

116 
	s__gc⁄v_°ï


118 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

119 c⁄° *
__mod«me
;

121 
__cou¡î
;

123 *
__‰om_«me
;

124 *
__to_«me
;

126 
__gc⁄v_f˘
 
__f˘
;

127 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

128 
__gc⁄v_öô_f˘
 
__öô_f˘
;

129 
__gc⁄v_íd_f˘
 
__íd_f˘
;

133 
__mö_√eded_‰om
;

134 
__max_√eded_‰om
;

135 
__mö_√eded_to
;

136 
__max_√eded_to
;

139 
__°©eful
;

141 *
__d©a
;

146 
	s__gc⁄v_°ï_d©a


148 *
__outbuf
;

149 *
__outbu„nd
;

153 
__Êags
;

157 
__övoˇti⁄_cou¡î
;

161 
__öã∫Æ_u£
;

163 
__mb°©e_t
 *
__°©ï
;

164 
__mb°©e_t
 
__°©e
;

168 
__gc⁄v_å™s_d©a
 *
__å™s
;

173 
	s__gc⁄v_öfo


175 
size_t
 
__n°ïs
;

176 
__gc⁄v_°ï
 *
__°ïs
;

177 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

178 } *
	t__gc⁄v_t
;

	@/usr/include/gnu/stubs-32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_chÊags


	)

11 
	#__°ub_Áâach


	)

12 
	#__°ub_fchÊags


	)

13 
	#__°ub_fdëach


	)

14 
	#__°ub_gây


	)

15 
	#__°ub_lchmod


	)

16 
	#__°ub_ªvoke


	)

17 
	#__°ub_£éogö


	)

18 
	#__°ub_sigªtu∫


	)

19 
	#__°ub_s°k


	)

20 
	#__°ub_°ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_bdÊush


	)

11 
	#__°ub_chÊags


	)

12 
	#__°ub_Áâach


	)

13 
	#__°ub_fchÊags


	)

14 
	#__°ub_fdëach


	)

15 
	#__°ub_gëmsg


	)

16 
	#__°ub_gây


	)

17 
	#__°ub_lchmod


	)

18 
	#__°ub_putmsg


	)

19 
	#__°ub_ªvoke


	)

20 
	#__°ub_£éogö


	)

21 
	#__°ub_sigªtu∫


	)

22 
	#__°ub_s°k


	)

23 
	#__°ub_°ty


	)

	@/usr/include/linux/falloc.h

1 #i‚de‡
_FALLOC_H_


2 
	#_FALLOC_H_


	)

4 
	#FALLOC_FL_KEEP_SIZE
 0x01

	)

5 
	#FALLOC_FL_PUNCH_HOLE
 0x02

	)

6 
	#FALLOC_FL_NO_HIDE_STALE
 0x04

	)

28 
	#FALLOC_FL_COLLAPSE_RANGE
 0x08

	)

42 
	#FALLOC_FL_ZERO_RANGE
 0x10

	)

59 
	#FALLOC_FL_INSERT_RANGE
 0x20

	)

	@/usr/include/wchar.h

23 #i‚de‡
_WCHAR_H


25 #i‡!
deföed
 
__√ed_mb°©e_t
 && !deföed 
__√ed_wöt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<„©uªs.h
>

30 #ifde‡
_WCHAR_H


32 
	#__√ed___FILE


	)

33 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


34 
	#__√ed_FILE


	)

36 
	~<°dio.h
>

38 
	#__√ed___va_li°


	)

39 
	~<°d¨g.h
>

41 
	~<bôs/wch¨.h
>

44 
	#__√ed_size_t


	)

45 
	#__√ed_wch¨_t


	)

46 
	#__√ed_NULL


	)

48 #i‡
deföed
 
_WCHAR_H
 || deföed 
__√ed_wöt_t
 || !deföed 
__WINT_TYPE__


49 #unde‡
__√ed_wöt_t


50 
	#__√ed_wöt_t


	)

51 
	~<°ddef.h
>

55 #i‚de‡
_WINT_T


60 
	#_WINT_T


	)

61 
	twöt_t
;

65 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
deföed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twöt_t
;

69 
	g__END_NAMESPACE_STD


74 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i‡(
deföed
 
_WCHAR_H
 || deföed 
__√ed_mb°©e_t
Ë&& !deföed 
____mb°©e_t_deföed


80 
	#____mb°©e_t_deföed
 1

	)

84 
	m__cou¡
;

87 #ifde‡
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wöt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vÆue
;

94 } 
	t__mb°©e_t
;

96 #unde‡
__√ed_mb°©e_t


101 #ifde‡
_WCHAR_H


103 #i‚de‡
__mb°©e_t_deföed


104 
__BEGIN_NAMESPACE_C99


106 
__mb°©e_t
 
	tmb°©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb°©e_t_deföed
 1

	)

111 #ifde‡
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

115 #i‚de‡
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #i‚de‡
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


128 
	~<w˘y≥.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

148 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

150 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

151 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

156 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

158 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

159 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
)

164 
__THROW
 
__©åibuã_puª__
;

166 
	$wc¢cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©åibuã_puª__
;

168 
__END_NAMESPACE_STD


170 #ifde‡
__USE_XOPEN2K8


172 
	$wcsˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

175 
	$wc¢ˇ£cmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

176 
size_t
 
__n
Ë
__THROW
;

180 
	~<xloˇÀ.h
>

182 
	$wcsˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

183 
__loˇÀ_t
 
__loc
Ë
__THROW
;

185 
	$wc¢ˇ£cmp_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

186 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscﬁl
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
Ë
__THROW
;

196 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

197 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifde‡
__USE_XOPEN2K8


206 
	$wcscﬁl_l
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

207 
__loˇÀ_t
 
__loc
Ë
__THROW
;

212 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

213 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

216 
wch¨_t
 *
	$wcsdup
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¨_t
 *
	$wcschr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

224 "C++" c⁄° 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"Ë
__©åibuã_puª__
;

227 
wch¨_t
 *
	$wcschr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

228 
__THROW
 
__©åibuã_puª__
;

231 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¨_t
 *
	$wc§chr
 (
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

233 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

234 "C++" c⁄° 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

235 
__THROW
 
	`__asm
 ("wc§chr"Ë
__©åibuã_puª__
;

237 
wch¨_t
 *
	$wc§chr
 (c⁄° 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

238 
__THROW
 
__©åibuã_puª__
;

240 
__END_NAMESPACE_STD


242 #ifde‡
__USE_GNU


245 
wch¨_t
 *
	$wcsch∫ul
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__wc
)

246 
__THROW
 
__©åibuã_puª__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ªje˘
)

253 
__THROW
 
__©åibuã_puª__
;

256 
size_t
 
	$wcs•n
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

257 
__THROW
 
__©åibuã_puª__
;

259 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¨_t
 *
	$wc•brk
 (
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

261 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

262 "C++" c⁄° 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
,

263 c⁄° 
wch¨_t
 *
__ac˚±
)

264 
__THROW
 
	`__asm
 ("wc•brk"Ë
__©åibuã_puª__
;

266 
wch¨_t
 *
	$wc•brk
 (c⁄° 
wch¨_t
 *
__wcs
, c⁄° wch¨_à*
__ac˚±
)

267 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¨_t
 *
	$wcs°r
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

272 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

273 "C++" c⁄° 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
,

274 c⁄° 
wch¨_t
 *
__√edÀ
)

275 
__THROW
 
	`__asm
 ("wcs°r"Ë
__©åibuã_puª__
;

277 
wch¨_t
 *
	$wcs°r
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

278 
__THROW
 
__©åibuã_puª__
;

282 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

283 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

284 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

287 
size_t
 
	$wc¶í
 (c⁄° 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

288 
__END_NAMESPACE_STD


290 #ifde‡
__USE_XOPEN


292 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¨_t
 *
	$wcswcs
 (
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

294 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

295 "C++" c⁄° 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
,

296 c⁄° 
wch¨_t
 *
__√edÀ
)

297 
__THROW
 
	`__asm
 ("wcswcs"Ë
__©åibuã_puª__
;

299 
wch¨_t
 *
	$wcswcs
 (c⁄° 
wch¨_t
 *
__hay°ack
, c⁄° wch¨_à*
__√edÀ
)

300 
__THROW
 
__©åibuã_puª__
;

304 #ifde‡
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Àn
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

307 
__THROW
 
__©åibuã_puª__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifde‡
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¨_t
 *
	$wmemchr
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

316 "C++" c⁄° 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"Ë
__©åibuã_puª__
;

320 
wch¨_t
 *
	$wmemchr
 (c⁄° 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©åibuã_puª__
;

325 
	$wmemcmp
 (c⁄° 
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©åibuã_puª__
;

329 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

330 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

334 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifde‡
__USE_GNU


344 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

345 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

357 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

361 
	$mbsöô
 (c⁄° 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

365 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

366 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

367 
mb°©e_t
 *
__ª°ri˘
 
__p
Ë
__THROW
;

370 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

371 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

374 
size_t
 
	$__mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

375 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

376 
size_t
 
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

377 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifde‡
__USE_EXTERN_INLINES


386 
wöt_t
 
	$__btowc_Æüs
 (
__c
Ë
	`__asm
 ("btowc");

387 
__exã∫_ölöe
 
wöt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__buûtö_c⁄°™t_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wöt_t
Ë
__c
 : 
	`__btowc_Æüs
 (__c)); 
	}
}

392 
	$__w˘ob_Æüs
 (
wöt_t
 
__c
Ë
	`__asm
 ("wctob");

393 
__exã∫_ölöe
 

394 
	`__NTH
 (
	$w˘ob
 (
wöt_t
 
__wc
))

395 {  (
	`__buûtö_c⁄°™t_p
 (
__wc
Ë&& __w¯>
L
'\0' && __wc <= L'\x7f'

396 ? (Ë
__wc
 : 
	`__w˘ob_Æüs
 (__wc)); 
	}
}

398 
__exã∫_ölöe
 
size_t


399 
__NTH
 (
	$mbæí
 (c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

400 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

401 {  (
__ps
 !
NULL


402 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

409 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

410 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

414 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

415 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

416 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

424 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

425 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

429 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

430 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

431 
size_t
 
__nwc
, size_à
__Àn
,

432 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

437 #ifde‡
__USE_XOPEN


439 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

443 
	$wcswidth
 (c⁄° 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc°od
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

451 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifde‡
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc°of
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

459 
	$wc°ﬁd
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

460 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc°ﬁ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

469 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

473 
	$wc°oul
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

474 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GNUC__
 && deföed 
__USE_GNU
)

479 
__BEGIN_NAMESPACE_C99


482 
__exãnsi⁄__


483 
	$wc°ﬁl
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

485 
__THROW
;

489 
__exãnsi⁄__


490 
	$wc°ouŒ
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

491 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

492 
__ba£
Ë
__THROW
;

493 
__END_NAMESPACE_C99


496 #i‡
deföed
 
__GNUC__
 && deföed 
__USE_GNU


499 
__exãnsi⁄__


500 
	$wc°oq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

502 
__THROW
;

506 
__exãnsi⁄__


507 
	$wc°ouq
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
Ë
__THROW
;

512 #ifde‡
__USE_GNU


526 
	~<xloˇÀ.h
>

530 
	$wc°ﬁ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

531 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

532 
__loˇÀ_t
 
__loc
Ë
__THROW
;

534 
	$wc°oul_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

535 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

536 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

538 
__exãnsi⁄__


539 
	$wc°ﬁl_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

540 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

541 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

543 
__exãnsi⁄__


544 
	$wc°ouŒ_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

545 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

546 
__ba£
, 
__loˇÀ_t
 
__loc
)

547 
__THROW
;

549 
	$wc°od_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

550 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

551 
__THROW
;

553 
	$wc°of_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

554 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

555 
__THROW
;

557 
	$wc°ﬁd_l
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__loˇÀ_t
 
__loc
Ë
__THROW
;

563 #ifde‡
__USE_XOPEN2K8


566 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

567 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

571 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

572 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$›í_wmem°ªam
 (
wch¨_t
 **
__buÊoc
, 
size_t
 *
__sizñoc
Ë
__THROW
;

583 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

594 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

595 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
	`w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

604 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

605 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

606 
__THROW
 ;

612 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

613 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

614 
__gnuc_va_li°
 
__¨g
)

620 
	`vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

621 
__gnuc_va_li°
 
__¨g
)

625 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

626 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

627 
__gnuc_va_li°
 
__¨g
)

628 
__THROW
 ;

635 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

636 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
	`wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

645 
	$swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

646 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

647 
__THROW
 ;

649 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

650 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

651 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

652 #ifde‡
__REDIRECT


656 
	`__REDIRECT
 (
fwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__°ªam
,

657 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

658 
__isoc99_fwsˇnf
)

660 
	`__REDIRECT
 (
wsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...),

661 
__isoc99_wsˇnf
)

663 
	`__REDIRECT_NTH
 (
swsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

664 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

665 ...), 
__isoc99_swsˇnf
)

668 
	`__isoc99_fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

669 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

670 
	`__isoc99_wsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

671 
	$__isoc99_swsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

672 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

673 
__THROW
;

674 
	#fwsˇnf
 
__isoc99_fwsˇnf


	)

675 
	#wsˇnf
 
__isoc99_wsˇnf


	)

676 
	#swsˇnf
 
__isoc99_swsˇnf


	)

680 
__END_NAMESPACE_STD


683 #ifde‡
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

690 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

691 
__gnuc_va_li°
 
__¨g
)

697 
	`vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

698 
__gnuc_va_li°
 
__¨g
)

701 
	$vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

702 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

703 
__gnuc_va_li°
 
__¨g
)

704 
__THROW
 ;

706 #i‡!
deföed
 
__USE_GNU
 \

707 && (!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT
) \

708 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

709 #ifde‡
__REDIRECT


710 
	`__REDIRECT
 (
vfwsˇnf
, (
__FILE
 *
__ª°ri˘
 
__s
,

711 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

712 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vfwsˇnf
)

714 
	`__REDIRECT
 (
vwsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

715 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vwsˇnf
)

717 
	`__REDIRECT_NTH
 (
vswsˇnf
, (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

718 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

719 
__gnuc_va_li°
 
__¨g
), 
__isoc99_vswsˇnf
)

722 
	`__isoc99_vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

723 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

724 
__gnuc_va_li°
 
__¨g
);

725 
	`__isoc99_vwsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

726 
__gnuc_va_li°
 
__¨g
);

727 
	$__isoc99_vswsˇnf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s
,

728 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

729 
__gnuc_va_li°
 
__¨g
Ë
__THROW
;

730 
	#vfwsˇnf
 
__isoc99_vfwsˇnf


	)

731 
	#vwsˇnf
 
__isoc99_vwsˇnf


	)

732 
	#vswsˇnf
 
__isoc99_vswsˇnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

746 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

752 
wöt_t
 
	`gëwch¨
 ();

759 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

760 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

766 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

774 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

775 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

789 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

790 
__END_NAMESPACE_STD


793 #ifde‡
__USE_GNU


801 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

802 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

810 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

818 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

827 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

828 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

837 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

838 
__FILE
 *
__ª°ri˘
 
__°ªam
);

846 
	`Âutws_u∆ocked
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__ws
,

847 
__FILE
 *
__ª°ri˘
 
__°ªam
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

856 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

857 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifde‡
__USE_GNU


861 
	~<xloˇÀ.h
>

865 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

866 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

867 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

868 
__loˇÀ_t
 
__loc
Ë
__THROW
;

877 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


878 
	#__√ed_iswxxx


	)

879 
	~<w˘y≥.h
>

883 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


884 
	~<bôs/wch¨2.h
>

887 #ifde‡
__LDBL_COMPAT


888 
	~<bôs/wch¨-ldbl.h
>

891 
__END_DECLS


899 #unde‡
__√ed_mb°©e_t


900 #unde‡
__√ed_wöt_t


	@/usr/include/bits/byteswap-16.h

19 #i‚de‡
_BITS_BYTESWAP_H


23 #ifde‡
__GNUC__


24 #i‡
__GNUC__
 >= 2

25 
	#__bsw≠_16
(
x
) \

26 (
__exãnsi⁄__
 \

27 ({ 
__v
, 
__x
 = (Ë(
x
); \

28 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

29 
__v
 = 
	`__bsw≠_c⁄°™t_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "Ù" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw≠_16
(
x
) \

39 (
__exãnsi⁄__
 \

40 ({ 
__x
 = (Ë(
x
); \

41 
	`__bsw≠_c⁄°™t_16
 (
__x
); }))

	)

44 
__ölöe
 

45 
	$__bsw≠_16
 (
__bsx
)

47  
	`__bsw≠_c⁄°™t_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/wchar-ldbl.h

19 #i‚de‡
_WCHAR_H


23 #i‡
deföed
 
__USE_ISOC95
 || deföed 
__USE_UNIX98


24 
__BEGIN_NAMESPACE_C99


25 
__LDBL_REDIR_DECL
 (
fw¥ötf
);

26 
__LDBL_REDIR_DECL
 (
w¥ötf
);

27 
__LDBL_REDIR_DECL
 (
sw¥ötf
);

28 
__LDBL_REDIR_DECL
 (
vfw¥ötf
);

29 
__LDBL_REDIR_DECL
 (
vw¥ötf
);

30 
__LDBL_REDIR_DECL
 (
vsw¥ötf
);

31 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__USE_GNU
 \

32 && !
deföed
 
	g__REDIRECT
 \

33 && (
deföed
 
	g__STRICT_ANSI__
 || deföed 
	g__USE_XOPEN2K
)

34 
	$__LDBL_REDIR1_DECL
 (
fwsˇnf
, 
__∆dbl___isoc99_fwsˇnf
)

35 
	$__LDBL_REDIR1_DECL
 (
wsˇnf
, 
__∆dbl___isoc99_wsˇnf
)

36 
	$__LDBL_REDIR1_DECL
 (
swsˇnf
, 
__∆dbl___isoc99_swsˇnf
)

38 
	`__LDBL_REDIR_DECL
 (
fwsˇnf
);

39 
	`__LDBL_REDIR_DECL
 (
wsˇnf
);

40 
	`__LDBL_REDIR_DECL
 (
swsˇnf
);

42 
__END_NAMESPACE_C99


45 #ifde‡
__USE_ISOC99


46 
__BEGIN_NAMESPACE_C99


47 
	`__LDBL_REDIR1_DECL
 (
wc°ﬁd
, 
wc°od
);

48 #i‡!
deföed
 
__USE_GNU
 && !deföed 
__REDIRECT
 \

49 && (
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_XOPEN2K
)

50 
	$__LDBL_REDIR1_DECL
 (
vfwsˇnf
, 
__∆dbl___isoc99_vfwsˇnf
)

51 
	$__LDBL_REDIR1_DECL
 (
vwsˇnf
, 
__∆dbl___isoc99_vwsˇnf
)

52 
	$__LDBL_REDIR1_DECL
 (
vswsˇnf
, 
__∆dbl___isoc99_vswsˇnf
)

54 
	`__LDBL_REDIR_DECL
 (
vfwsˇnf
);

55 
	`__LDBL_REDIR_DECL
 (
vwsˇnf
);

56 
	`__LDBL_REDIR_DECL
 (
vswsˇnf
);

58 
__END_NAMESPACE_C99


61 #ifde‡
__USE_GNU


62 
	`__LDBL_REDIR1_DECL
 (
wc°ﬁd_l
, 
wc°od_l
);

65 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


66 
	$__LDBL_REDIR_DECL
 (
__sw¥ötf_chk
)

67 
	$__LDBL_REDIR_DECL
 (
__vsw¥ötf_chk
)

68 #i‡
__USE_FORTIFY_LEVEL
 > 1

69 
	$__LDBL_REDIR_DECL
 (
__fw¥ötf_chk
)

70 
	$__LDBL_REDIR_DECL
 (
__w¥ötf_chk
)

71 
	$__LDBL_REDIR_DECL
 (
__vfw¥ötf_chk
)

72 
	$__LDBL_REDIR_DECL
 (
__vw¥ötf_chk
)

	@/usr/include/bits/wchar2.h

19 #i‚de‡
_WCHAR_H


24 
wch¨_t
 *
	$__wmem˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

25 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

26 
size_t
 
__ns1
Ë
__THROW
;

27 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem˝y_Æüs
,

28 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

29 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
),

30 
wmem˝y
);

31 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem˝y_chk_w¨n
,

32 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

33 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

34 
size_t
 
__ns1
), 
__wmem˝y_chk
)

35 
	`__w¨«âr
 ("wmemcpy called withÜength biggerÅhan size of destination "

38 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

39 
	`__NTH
 (
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
, c⁄° wch¨_à*__ª°ri˘ 
__s2
,

40 
size_t
 
__n
))

42 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

44 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

45  
	`__wmem˝y_chk
 (
__s1
, 
__s2
, 
__n
,

46 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

48 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

49  
	`__wmem˝y_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

50 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

52  
	`__wmem˝y_Æüs
 (
__s1
, 
__s2
, 
__n
);

53 
	}
}

56 
wch¨_t
 *
	$__wmemmove_chk
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

57 
size_t
 
__n
, size_à
__ns1
Ë
__THROW
;

58 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_Æüs
, (wch¨_à*
__s1
,

59 c⁄° 
wch¨_t
 *
__s2
,

60 
size_t
 
__n
), 
wmemmove
);

61 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemmove_chk_w¨n
,

62 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
,

63 
size_t
 
__n
, size_à
__ns1
), 
__wmemmove_chk
)

64 
	`__w¨«âr
 ("wmemmove called withÜength biggerÅhan size of destination "

67 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

68 
	`__NTH
 (
	$wmemmove
 (
wch¨_t
 *
__s1
, c⁄° wch¨_à*
__s2
, 
size_t
 
__n
))

70 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

72 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

73  
	`__wmemmove_chk
 (
__s1
, 
__s2
, 
__n
,

74 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

76 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

77  
	`__wmemmove_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

78 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

80  
	`__wmemmove_Æüs
 (
__s1
, 
__s2
, 
__n
);

81 
	}
}

84 #ifde‡
__USE_GNU


85 
wch¨_t
 *
	$__wmemp˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

86 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

87 
size_t
 
__ns1
Ë
__THROW
;

88 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemp˝y_Æüs
,

89 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

90 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
,

91 
size_t
 
__n
), 
wmemp˝y
);

92 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmemp˝y_chk_w¨n
,

93 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

94 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
,

95 
size_t
 
__ns1
), 
__wmemp˝y_chk
)

96 
	`__w¨«âr
 ("wmempcpy called withÜength biggerÅhan size of destination "

99 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

100 
	`__NTH
 (
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
, c⁄° wch¨_à*__ª°ri˘ 
__s2
,

101 
size_t
 
__n
))

103 i‡(
	`__bos0
 (
__s1
Ë!(
size_t
) -1)

105 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

106  
	`__wmemp˝y_chk
 (
__s1
, 
__s2
, 
__n
,

107 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

109 i‡(
__n
 > 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
))

110  
	`__wmemp˝y_chk_w¨n
 (
__s1
, 
__s2
, 
__n
,

111 
	`__bos0
 (
__s1
Ë/  (
wch¨_t
));

113  
	`__wmemp˝y_Æüs
 (
__s1
, 
__s2
, 
__n
);

114 
	}
}

118 
wch¨_t
 *
	$__wmem£t_chk
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
,

119 
size_t
 
__ns
Ë
__THROW
;

120 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_Æüs
, (wch¨_à*
__s
, wch¨_à
__c
,

121 
size_t
 
__n
), 
wmem£t
);

122 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wmem£t_chk_w¨n
,

123 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
,

124 
size_t
 
__ns
), 
__wmem£t_chk
)

125 
	`__w¨«âr
 ("wmemset called withÜength biggerÅhan size of destination "

128 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

129 
	`__NTH
 (
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
))

131 i‡(
	`__bos0
 (
__s
Ë!(
size_t
) -1)

133 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

134  
	`__wmem£t_chk
 (
__s
, 
__c
, 
__n
, 
	`__bos0
 (__sË/  (
wch¨_t
));

136 i‡(
__n
 > 
	`__bos0
 (
__s
Ë/  (
wch¨_t
))

137  
	`__wmem£t_chk_w¨n
 (
__s
, 
__c
, 
__n
,

138 
	`__bos0
 (
__s
Ë/  (
wch¨_t
));

140  
	`__wmem£t_Æüs
 (
__s
, 
__c
, 
__n
);

141 
	}
}

144 
wch¨_t
 *
	$__wcs˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

145 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

146 
size_t
 
__n
Ë
__THROW
;

147 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wcs˝y_Æüs
,

148 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

149 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
wcs˝y
);

151 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

152 
	`__NTH
 (
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
))

154 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

155  
	`__wcs˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

156  
	`__wcs˝y_Æüs
 (
__de°
, 
__§c
);

157 
	}
}

160 
wch¨_t
 *
	$__w˝˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

161 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

162 
size_t
 
__de°Àn
Ë
__THROW
;

163 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝˝y_Æüs
,

164 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

165 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
w˝˝y
);

167 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

168 
	`__NTH
 (
	$w˝˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
))

170 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

171  
	`__w˝˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

172  
	`__w˝˝y_Æüs
 (
__de°
, 
__§c
);

173 
	}
}

176 
wch¨_t
 *
	$__wc¢˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

177 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
,

178 
size_t
 
__de°Àn
Ë
__THROW
;

179 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢˝y_Æüs
,

180 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

181 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

182 
size_t
 
__n
), 
wc¢˝y
);

183 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢˝y_chk_w¨n
,

184 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

185 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

186 
size_t
 
__n
, size_à
__de°Àn
), 
__wc¢˝y_chk
)

187 
	`__w¨«âr
 ("wcsncpy called withÜength biggerÅhan size of destination "

190 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

191 
	`__NTH
 (
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
,

192 
size_t
 
__n
))

194 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

196 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

197  
	`__wc¢˝y_chk
 (
__de°
, 
__§c
, 
__n
,

198 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

199 i‡(
__n
 > 
	`__bos
 (
__de°
Ë/  (
wch¨_t
))

200  
	`__wc¢˝y_chk_w¨n
 (
__de°
, 
__§c
, 
__n
,

201 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

203  
	`__wc¢˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

204 
	}
}

207 
wch¨_t
 *
	$__w˝n˝y_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

208 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
,

209 
size_t
 
__de°Àn
Ë
__THROW
;

210 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝n˝y_Æüs
,

211 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

212 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

213 
size_t
 
__n
), 
w˝n˝y
);

214 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__w˝n˝y_chk_w¨n
,

215 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

216 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

217 
size_t
 
__n
, size_à
__de°Àn
), 
__w˝n˝y_chk
)

218 
	`__w¨«âr
 ("wcpncpy called withÜength biggerÅhan size of destination "

221 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

222 
	`__NTH
 (
	$w˝n˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
,

223 
size_t
 
__n
))

225 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

227 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
))

228  
	`__w˝n˝y_chk
 (
__de°
, 
__§c
, 
__n
,

229 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

230 i‡(
__n
 > 
	`__bos
 (
__de°
Ë/  (
wch¨_t
))

231  
	`__w˝n˝y_chk_w¨n
 (
__de°
, 
__§c
, 
__n
,

232 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

234  
	`__w˝n˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

235 
	}
}

238 
wch¨_t
 *
	$__wcsˇt_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

239 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

240 
size_t
 
__de°Àn
Ë
__THROW
;

241 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wcsˇt_Æüs
,

242 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

243 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
), 
wcsˇt
);

245 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

246 
	`__NTH
 (
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
))

248 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

249  
	`__wcsˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__de°Ë/  (
wch¨_t
));

250  
	`__wcsˇt_Æüs
 (
__de°
, 
__§c
);

251 
	}
}

254 
wch¨_t
 *
	$__wc¢ˇt_chk
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

255 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

256 
size_t
 
__n
, size_à
__de°Àn
Ë
__THROW
;

257 
wch¨_t
 *
	`__REDIRECT_NTH
 (
__wc¢ˇt_Æüs
,

258 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

259 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

260 
size_t
 
__n
), 
wc¢ˇt
);

262 
__f‹tify_fun˘i⁄
 
wch¨_t
 *

263 
	`__NTH
 (
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
, c⁄° wch¨_à*__ª°ri˘ 
__§c
,

264 
size_t
 
__n
))

266 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1)

267  
	`__wc¢ˇt_chk
 (
__de°
, 
__§c
, 
__n
,

268 
	`__bos
 (
__de°
Ë/  (
wch¨_t
));

269  
	`__wc¢ˇt_Æüs
 (
__de°
, 
__§c
, 
__n
);

270 
	}
}

273 
	$__sw¥ötf_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

274 
__Êag
, 
size_t
 
__s_Àn
,

275 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

276 
__THROW
 ;

278 
	`__REDIRECT_NTH_LDBL
 (
__sw¥ötf_Æüs
,

279 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

280 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...),

281 
sw¥ötf
);

283 #ifde‡
__va_¨g_∑ck


284 
__f‹tify_fun˘i⁄
 

285 
	`__NTH
 (
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

286 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...))

288 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1)

289  
	`__sw¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

290 
	`__bos
 (
__s
Ë/  (
wch¨_t
),

291 
__fmt
, 
	`__va_¨g_∑ck
 ());

292  
	`__sw¥ötf_Æüs
 (
__s
, 
__n
, 
__fmt
, 
	`__va_¨g_∑ck
 ());

293 
	}
}

294 #ñi‡!
deföed
 
__˝lu•lus


296 
	#sw¥ötf
(
s
, 
n
, ...) \

297 (
	`__bos
 (
s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1 \

298 ? 
	`__sw¥ötf_chk
 (
s
, 
n
, 
__USE_FORTIFY_LEVEL
 - 1, \

299 
	`__bos
 (
s
Ë/  (
wch¨_t
), 
__VA_ARGS__
) \

300 : 
	`sw¥ötf
 (
s
, 
n
, 
__VA_ARGS__
))

	)

303 
	$__vsw¥ötf_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

304 
__Êag
, 
size_t
 
__s_Àn
,

305 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

306 
__gnuc_va_li°
 
__¨g
)

307 
__THROW
 ;

309 
	`__REDIRECT_NTH_LDBL
 (
__vsw¥ötf_Æüs
,

310 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

311 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
,

312 
__gnuc_va_li°
 
__≠
), 
vsw¥ötf
);

314 
__f‹tify_fun˘i⁄
 

315 
	`__NTH
 (
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

316 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
))

318 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 || 
__USE_FORTIFY_LEVEL
 > 1)

319  
	`__vsw¥ötf_chk
 (
__s
, 
__n
, 
__USE_FORTIFY_LEVEL
 - 1,

320 
	`__bos
 (
__s
Ë/  (
wch¨_t
), 
__fmt
, 
__≠
);

321  
	`__vsw¥ötf_Æüs
 (
__s
, 
__n
, 
__fmt
, 
__≠
);

322 
	}
}

325 #i‡
__USE_FORTIFY_LEVEL
 > 1

327 
__fw¥ötf_chk
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

328 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...);

329 
__w¥ötf_chk
 (
__Êag
, c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

331 
__vfw¥ötf_chk
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, 
__Êag
,

332 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

333 
__gnuc_va_li°
 
__≠
);

334 
__vw¥ötf_chk
 (
__Êag
, c⁄° 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

335 
__gnuc_va_li°
 
__≠
);

337 #ifde‡
__va_¨g_∑ck


338 
__f‹tify_fun˘i⁄
 

339 
	$w¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, ...)

341  
	`__w¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
	`__va_¨g_∑ck
 ());

342 
	}
}

344 
__f‹tify_fun˘i⁄
 

345 
	$fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
, c⁄° 
wch¨_t
 *__ª°ri˘ 
__fmt
, ...)

347  
	`__fw¥ötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
,

348 
	`__va_¨g_∑ck
 ());

349 
	}
}

350 #ñi‡!
deföed
 
__˝lu•lus


351 
	#w¥ötf
(...) \

352 
	`__w¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

353 
	#fw¥ötf
(
°ªam
, ...) \

354 
	`__fw¥ötf_chk
 (
°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__VA_ARGS__
)

	)

357 
__f‹tify_fun˘i⁄
 

358 
	$vw¥ötf
 (c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
)

360  
	`__vw¥ötf_chk
 (
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

361 
	}
}

363 
__f‹tify_fun˘i⁄
 

364 
	$vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

365 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__fmt
, 
__gnuc_va_li°
 
__≠
)

367  
	`__vfw¥ötf_chk
 (
__°ªam
, 
__USE_FORTIFY_LEVEL
 - 1, 
__fmt
, 
__≠
);

368 
	}
}

372 
wch¨_t
 *
	$__fgëws_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

373 
__FILE
 *
__ª°ri˘
 
__°ªam
Ë
__wur
;

374 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_Æüs
,

375 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
,

376 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
fgëws
Ë
__wur
;

377 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_chk_w¨n
,

378 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

379 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
__fgëws_chk
)

380 
__wur
 
	`__w¨«âr
 ("fgetws called with bigger sizeÅhanÜength "

383 
__f‹tify_fun˘i⁄
 
__wur
 
wch¨_t
 *

384 
	$fgëws
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
, 
__FILE
 *__ª°ri˘ 
__°ªam
)

386 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

388 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

389  
	`__fgëws_chk
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

390 
__n
, 
__°ªam
);

392 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
Ë/  (
wch¨_t
))

393  
	`__fgëws_chk_w¨n
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

394 
__n
, 
__°ªam
);

396  
	`__fgëws_Æüs
 (
__s
, 
__n
, 
__°ªam
);

397 
	}
}

399 #ifde‡
__USE_GNU


400 
wch¨_t
 *
	$__fgëws_u∆ocked_chk
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
,

401 
__n
, 
__FILE
 *
__ª°ri˘
 
__°ªam
)

402 
__wur
;

403 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_u∆ocked_Æüs
,

404 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
,

405 
__FILE
 *
__ª°ri˘
 
__°ªam
), 
fgëws_u∆ocked
)

406 
__wur
;

407 
wch¨_t
 *
	`__REDIRECT
 (
__fgëws_u∆ocked_chk_w¨n
,

408 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__size
, 
__n
,

409 
__FILE
 *
__ª°ri˘
 
__°ªam
),

410 
__fgëws_u∆ocked_chk
)

411 
__wur
 
	`__w¨«âr
 ("fgetws_unlocked called with bigger sizeÅhanÜength "

414 
__f‹tify_fun˘i⁄
 
__wur
 
wch¨_t
 *

415 
	$fgëws_u∆ocked
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
__n
, 
__FILE
 *__ª°ri˘ 
__°ªam
)

417 i‡(
	`__bos
 (
__s
Ë!(
size_t
) -1)

419 i‡(!
	`__buûtö_c⁄°™t_p
 (
__n
) || __n <= 0)

420  
	`__fgëws_u∆ocked_chk
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

421 
__n
, 
__°ªam
);

423 i‡((
size_t
Ë
__n
 > 
	`__bos
 (
__s
Ë/  (
wch¨_t
))

424  
	`__fgëws_u∆ocked_chk_w¨n
 (
__s
, 
	`__bos
 (__sË/  (
wch¨_t
),

425 
__n
, 
__°ªam
);

427  
	`__fgëws_u∆ocked_Æüs
 (
__s
, 
__n
, 
__°ªam
);

428 
	}
}

432 
size_t
 
	$__w¸tomb_chk
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wch¨
,

433 
mb°©e_t
 *
__ª°ri˘
 
__p
,

434 
size_t
 
__buÊí
Ë
__THROW
 
__wur
;

435 
size_t
 
	`__REDIRECT_NTH
 (
__w¸tomb_Æüs
,

436 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wch¨
,

437 
mb°©e_t
 *
__ª°ri˘
 
__ps
), 
w¸tomb
Ë
__wur
;

439 
__f‹tify_fun˘i⁄
 
__wur
 
size_t


440 
	`__NTH
 (
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wch¨
,

441 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

446 
	#__WCHAR_MB_LEN_MAX
 16

	)

447 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__WCHAR_MB_LEN_MAX


450 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__WCHAR_MB_LEN_MAX
 > __bos (__s))

451  
	`__w¸tomb_chk
 (
__s
, 
__wch¨
, 
__ps
, 
	`__bos
 (__s));

452  
	`__w¸tomb_Æüs
 (
__s
, 
__wch¨
, 
__ps
);

453 
	}
}

456 
size_t
 
	$__mb§towcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

457 c⁄° **
__ª°ri˘
 
__§c
,

458 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

459 
size_t
 
__d°Àn
Ë
__THROW
;

460 
size_t
 
	`__REDIRECT_NTH
 (
__mb§towcs_Æüs
,

461 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

462 c⁄° **
__ª°ri˘
 
__§c
,

463 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

464 
mb§towcs
);

465 
size_t
 
	`__REDIRECT_NTH
 (
__mb§towcs_chk_w¨n
,

466 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

467 c⁄° **
__ª°ri˘
 
__§c
,

468 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

469 
size_t
 
__d°Àn
), 
__mb§towcs_chk
)

470 
	`__w¨«âr
 ("mbsrtowcs called with dst buffer smallerÅhanÜen "

473 
__f‹tify_fun˘i⁄
 
size_t


474 
	`__NTH
 (
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° **__ª°ri˘ 
__§c
,

475 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

477 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

479 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

480  
	`__mb§towcs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
,

481 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

483 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

484  
	`__mb§towcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
,

485 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

487  
	`__mb§towcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
);

488 
	}
}

491 
size_t
 
	$__wc§tombs_chk
 (*
__ª°ri˘
 
__d°
,

492 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

493 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

494 
size_t
 
__d°Àn
Ë
__THROW
;

495 
size_t
 
	`__REDIRECT_NTH
 (
__wc§tombs_Æüs
,

496 (*
__ª°ri˘
 
__d°
,

497 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

498 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

499 
wc§tombs
);

500 
size_t
 
	`__REDIRECT_NTH
 (
__wc§tombs_chk_w¨n
,

501 (*
__ª°ri˘
 
__d°
,

502 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

503 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

504 
size_t
 
__d°Àn
), 
__wc§tombs_chk
)

505 
	`__w¨«âr
 ("wcsrtombs called with dst buffer smallerÅhanÜen");

507 
__f‹tify_fun˘i⁄
 
size_t


508 
	`__NTH
 (
	$wc§tombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 **__ª°ri˘ 
__§c
,

509 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

511 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

513 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

514  
	`__wc§tombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
, 
	`__bos
 (__dst));

516 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

517  
	`__wc§tombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
, 
	`__bos
 (__dst));

519  
	`__wc§tombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
, 
__ps
);

520 
	}
}

523 #ifde‡
__USE_GNU


524 
size_t
 
	$__mb¢πowcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

525 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

526 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

527 
size_t
 
__d°Àn
Ë
__THROW
;

528 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢πowcs_Æüs
,

529 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

530 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

531 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
),

532 
mb¢πowcs
);

533 
size_t
 
	`__REDIRECT_NTH
 (
__mb¢πowcs_chk_w¨n
,

534 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

535 c⁄° **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

536 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

537 
size_t
 
__d°Àn
), 
__mb¢πowcs_chk
)

538 
	`__w¨«âr
 ("mbsnrtowcs called with dst buffer smallerÅhanÜen "

541 
__f‹tify_fun˘i⁄
 
size_t


542 
	`__NTH
 (
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° **__ª°ri˘ 
__§c
,

543 
size_t
 
__nmc
, size_à
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

545 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

547 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

548  
	`__mb¢πowcs_chk
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
,

549 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

551 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

552  
	`__mb¢πowcs_chk_w¨n
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
,

553 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

555  
	`__mb¢πowcs_Æüs
 (
__d°
, 
__§c
, 
__nmc
, 
__Àn
, 
__ps
);

556 
	}
}

559 
size_t
 
	$__wc¢πombs_chk
 (*
__ª°ri˘
 
__d°
,

560 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

561 
size_t
 
__nwc
, size_à
__Àn
,

562 
mb°©e_t
 *
__ª°ri˘
 
__ps
, 
size_t
 
__d°Àn
)

563 
__THROW
;

564 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢πombs_Æüs
,

565 (*
__ª°ri˘
 
__d°
,

566 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

567 
size_t
 
__nwc
, size_à
__Àn
,

568 
mb°©e_t
 *
__ª°ri˘
 
__ps
), 
wc¢πombs
);

569 
size_t
 
	`__REDIRECT_NTH
 (
__wc¢πombs_chk_w¨n
,

570 (*
__ª°ri˘
 
__d°
,

571 c⁄° 
wch¨_t
 **
__ª°ri˘
 
__§c
,

572 
size_t
 
__nwc
, size_à
__Àn
,

573 
mb°©e_t
 *
__ª°ri˘
 
__ps
,

574 
size_t
 
__d°Àn
), 
__wc¢πombs_chk
)

575 
	`__w¨«âr
 ("wcsnrtombs called with dst buffer smallerÅhanÜen");

577 
__f‹tify_fun˘i⁄
 
size_t


578 
	`__NTH
 (
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 **__ª°ri˘ 
__§c
,

579 
size_t
 
__nwc
, size_à
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
))

581 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

583 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

584  
	`__wc¢πombs_chk
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
,

585 
	`__bos
 (
__d°
));

587 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

588  
	`__wc¢πombs_chk_w¨n
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
,

589 
	`__bos
 (
__d°
));

591  
	`__wc¢πombs_Æüs
 (
__d°
, 
__§c
, 
__nwc
, 
__Àn
, 
__ps
);

592 
	}
}

	@/usr/include/pthread.h

18 #i‚de‡
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<„©uªs.h
>

22 
	~<ídün.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<bôs/±hªadty≥s.h
>

27 
	~<bôs/£tjmp.h
>

28 
	~<bôs/w‹dsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifde‡
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifde‡
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


85 #ifde‡
__PTHREAD_MUTEX_HAVE_PREV


86 
	#PTHREAD_MUTEX_INITIALIZER
 \

87 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

88 #ifde‡
__USE_GNU


89 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

90 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

91 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

92 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

93 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

94 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

95 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

96 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_MUTEX_INITIALIZER
 \

101 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

102 #ifde‡
__USE_GNU


103 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

105 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

107 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

108 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

115 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


118 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

119 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

120 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

121 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


127 #i‚de‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


128 #i‡
__WORDSIZE
 == 64

129 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

134 
	#PTHREAD_RWLOCK_INITIALIZER
 \

135 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

136 #ifde‡
__USE_GNU


137 #ifde‡
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


138 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

140 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

142 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


143 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

144 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

145 0, 0, 0, 0 } }

	)

147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

148 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

149 0 } }

	)

159 
	mPTHREAD_INHERIT_SCHED
,

160 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

161 
	mPTHREAD_EXPLICIT_SCHED


162 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

169 
	mPTHREAD_SCOPE_SYSTEM
,

170 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

171 
	mPTHREAD_SCOPE_PROCESS


172 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

179 
	mPTHREAD_PROCESS_PRIVATE
,

180 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

181 
	mPTHREAD_PROCESS_SHARED


182 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

188 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*Ë0, 0, 0 } }

	)

192 
	s_±hªad_˛ónup_buf„r


194 (*
	m__routöe
) (*);

195 *
	m__¨g
;

196 
	m__ˇn˚…y≥
;

197 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

203 
	mPTHREAD_CANCEL_ENABLE
,

204 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

205 
	mPTHREAD_CANCEL_DISABLE


206 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

210 
	mPTHREAD_CANCEL_DEFERRED
,

211 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

212 
	mPTHREAD_CANCEL_ASYNCHRONOUS


213 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

215 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

219 
	#PTHREAD_ONCE_INIT
 0

	)

222 #ifde‡
__USE_XOPEN2K


226 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

230 
__BEGIN_DECLS


235 
±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__√wthªad
,

236 c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

237 *(*
__°¨t_routöe
) (*),

238 *
__ª°ri˘
 
__¨g
Ë
__THROWNL
 
__n⁄nuŒ
 ((1, 3));

244 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

252 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

254 #ifde‡
__USE_GNU


257 
	$±hªad_åyjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
Ë
__THROW
;

265 
	`±hªad_timedjoö_≈
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
,

266 c⁄° 
time•ec
 *
__ab°ime
);

273 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

277 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

280 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
)

281 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

289 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

292 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
)

293 
__THROW
 
	`__n⁄nuŒ
 ((1));

296 
	$±hªad_©å_gëdëach°©e
 (c⁄° 
±hªad_©å_t
 *
__©å
,

297 *
__dëach°©e
)

298 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

301 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

302 
__dëach°©e
)

303 
__THROW
 
	`__n⁄nuŒ
 ((1));

307 
	$±hªad_©å_gëgu¨dsize
 (c⁄° 
±hªad_©å_t
 *
__©å
,

308 
size_t
 *
__gu¨dsize
)

309 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

312 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

313 
size_t
 
__gu¨dsize
)

314 
__THROW
 
	`__n⁄nuŒ
 ((1));

318 
	$±hªad_©å_gësched∑øm
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

319 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

320 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

323 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

324 c⁄° 
sched_∑øm
 *
__ª°ri˘


325 
__∑øm
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

328 
	$±hªad_©å_gëschedpﬁicy
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


329 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

330 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

333 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

334 
__THROW
 
	`__n⁄nuŒ
 ((1));

337 
	$±hªad_©å_gëöhîôsched
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


338 
__©å
, *
__ª°ri˘
 
__öhîô
)

339 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

342 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

343 
__öhîô
)

344 
__THROW
 
	`__n⁄nuŒ
 ((1));

348 
	$±hªad_©å_gësc›e
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

349 *
__ª°ri˘
 
__sc›e
)

350 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

353 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

354 
__THROW
 
	`__n⁄nuŒ
 ((1));

357 
	$±hªad_©å_gë°ackaddr
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


358 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

359 
__THROW
 
	`__n⁄nuŒ
 ((1, 2)Ë
__©åibuã_dïªˇãd__
;

365 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

366 *
__°ackaddr
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__©åibuã_dïªˇãd__
;

370 
	$±hªad_©å_gë°acksize
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘


371 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

372 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

377 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

378 
size_t
 
__°acksize
)

379 
__THROW
 
	`__n⁄nuŒ
 ((1));

381 #ifde‡
__USE_XOPEN2K


383 
	$±hªad_©å_gë°ack
 (c⁄° 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

384 **
__ª°ri˘
 
__°ackaddr
,

385 
size_t
 *
__ª°ri˘
 
__°acksize
)

386 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3));

391 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

392 
size_t
 
__°acksize
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

395 #ifde‡
__USE_GNU


398 
	$±hªad_©å_£èfföôy_≈
 (
±hªad_©å_t
 *
__©å
,

399 
size_t
 
__˝u£tsize
,

400 c⁄° 
˝u_£t_t
 *
__˝u£t
)

401 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

405 
	$±hªad_©å_gëafföôy_≈
 (c⁄° 
±hªad_©å_t
 *
__©å
,

406 
size_t
 
__˝u£tsize
,

407 
˝u_£t_t
 *
__˝u£t
)

408 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

414 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
)

415 
__THROW
 
	`__n⁄nuŒ
 ((2));

423 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

424 c⁄° 
sched_∑øm
 *
__∑øm
)

425 
__THROW
 
	`__n⁄nuŒ
 ((3));

428 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

429 *
__ª°ri˘
 
__pﬁicy
,

430 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

431 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

434 
	$±hªad_£tsched¥io
 (
±hªad_t
 
__èrgë_thªad
, 
__¥io
)

435 
__THROW
;

438 #ifde‡
__USE_GNU


440 
	$±hªad_gë«me_≈
 (
±hªad_t
 
__èrgë_thªad
, *
__buf
,

441 
size_t
 
__buÊí
)

442 
__THROW
 
	`__n⁄nuŒ
 ((2));

445 
	$±hªad_£äame_≈
 (
±hªad_t
 
__èrgë_thªad
, c⁄° *
__«me
)

446 
__THROW
 
	`__n⁄nuŒ
 ((2));

450 #ifde‡
__USE_UNIX98


452 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

455 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

458 #ifde‡
__USE_GNU


463 
	$±hªad_yõld
 (Ë
__THROW
;

468 
	$±hªad_£èfföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

469 c⁄° 
˝u_£t_t
 *
__˝u£t
)

470 
__THROW
 
	`__n⁄nuŒ
 ((3));

473 
	$±hªad_gëafföôy_≈
 (
±hªad_t
 
__th
, 
size_t
 
__˝u£tsize
,

474 
˝u_£t_t
 *
__˝u£t
)

475 
__THROW
 
	`__n⁄nuŒ
 ((3));

488 
	`±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

489 (*
__öô_routöe
Ë()Ë
	`__n⁄nuŒ
 ((1, 2));

500 
	`±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
);

504 
	`±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
);

507 
	`±hªad_ˇn˚l
 (
±hªad_t
 
__th
);

512 
	`±hªad_ã°ˇn˚l
 ();

521 
__jmp_buf
 
__ˇn˚l_jmp_buf
;

522 
__mask_was_ßved
;

523 } 
__ˇn˚l_jmp_buf
[1];

524 *
__∑d
[4];

525 } 
	t__±hªad_unwöd_buf_t
 
	t__©åibuã__
 ((
	t__Æig√d__
));

528 #i‚de‡
__˛ónup_f˘_©åibuã


529 
	#__˛ónup_f˘_©åibuã


	)

534 
	s__±hªad_˛ónup_‰ame


536 (*
__ˇn˚l_routöe
) (*);

537 *
__ˇn˚l_¨g
;

538 
__do_ô
;

539 
__ˇn˚l_ty≥
;

542 #i‡
deföed
 
__GNUC__
 && deföed 
__EXCEPTIONS


543 #ifde‡
__˝lu•lus


545 ˛as†
	c__±hªad_˛ónup_˛ass


547 (*
__ˇn˚l_routöe
) (*);

548 *
__ˇn˚l_¨g
;

549 
__do_ô
;

550 
__ˇn˚l_ty≥
;

552 
public
:

553 
	`__±hªad_˛ónup_˛ass
 ((*
__f˘
Ë(*), *
__¨g
)

554 : 
	`__ˇn˚l_routöe
 (
__f˘
), 
	`__ˇn˚l_¨g
 (
__¨g
), 
	$__do_ô
 (1) { }

555 ~
	$__±hªad_˛ónup_˛ass
 (Ë{ i‡(
__do_ô
Ë
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); 
	}
}

556 
	$__£tdoô
 (
__√wvÆ
Ë{ 
__do_ô
 = __√wvÆ; 
	}
}

557 
	$__de„r
 (Ë{ 
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
,

558 &
__ˇn˚l_ty≥
); 
	}
}

559 
	$__ª°‹e
 (Ëc⁄° { 
	`±hªad_£tˇn˚…y≥
 (
__ˇn˚l_ty≥
, 0); 
	}
}

569 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

571 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
)

	)

575 
	#±hªad_˛ónup_p›
(
execuã
) \

576 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

577 } 0)

	)

579 #ifde‡
__USE_GNU


583 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

585 
__±hªad_˛ónup_˛ass
 
	`__˛‰ame
 (
routöe
, 
¨g
); \

586 
__˛‰ame
.
	`__de„r
 ()

	)

591 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

592 
__˛‰ame
.
	`__ª°‹e
 (); \

593 
__˛‰ame
.
	`__£tdoô
 (
execuã
); \

594 } 0)

	)

601 
__exã∫_ölöe
 

602 
	$__±hªad_˛ónup_routöe
 (
__±hªad_˛ónup_‰ame
 *
__‰ame
)

604 i‡(
__‰ame
->
__do_ô
)

605 
__‰ame
->
	`__ˇn˚l_routöe
 (__‰ame->
__ˇn˚l_¨g
);

606 
	}
}

615 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

617 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

618 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

619 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

620 .
__do_ô
 = 1 };

	)

624 
	#±hªad_˛ónup_p›
(
execuã
) \

625 
__˛‰ame
.
__do_ô
 = (
execuã
); \

626 } 0)

	)

628 #ifde‡
__USE_GNU


632 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

634 
__±hªad_˛ónup_‰ame
 
__˛‰ame
 \

635 
	`__©åibuã__
 ((
	`__˛ónup__
 (
__±hªad_˛ónup_routöe
))) \

636 { .
__ˇn˚l_routöe
 = (
routöe
), .
__ˇn˚l_¨g
 = (
¨g
), \

637 .
__do_ô
 = 1 }; \

638 (Ë
	`±hªad_£tˇn˚…y≥
 (
PTHREAD_CANCEL_DEFERRED
, \

639 &
__˛‰ame
.
__ˇn˚l_ty≥
)

	)

644 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

645 (Ë
	`±hªad_£tˇn˚…y≥
 (
__˛‰ame
.
__ˇn˚l_ty≥
, 
NULL
); \

646 
__˛‰ame
.
__do_ô
 = (
execuã
); \

647 } 0)

	)

658 
	#±hªad_˛ónup_push
(
routöe
, 
¨g
) \

660 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

661 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

662 *
__ˇn˚l_¨g
 = (
¨g
); \

663 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

664 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

665 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

667 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

668 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

672 
	`__±hªad_ªgi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

673 dÿ{

	)

674 
__±hªad_ªgi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

675 
__˛ónup_f˘_©åibuã
;

679 
	#±hªad_˛ónup_p›
(
execuã
) \

682 
	`__±hªad_uƒegi°î_ˇn˚l
 (&
__ˇn˚l_buf
); \

683 i‡(
execuã
) \

684 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

685 } 0)

	)

686 
	$__±hªad_uƒegi°î_ˇn˚l
 (
__±hªad_unwöd_buf_t
 *
__buf
)

687 
__˛ónup_f˘_©åibuã
;

689 #ifde‡
__USE_GNU


693 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
, 
¨g
) \

695 
__±hªad_unwöd_buf_t
 
__ˇn˚l_buf
; \

696 (*
__ˇn˚l_routöe
Ë(*Ë(
routöe
); \

697 *
__ˇn˚l_¨g
 = (
¨g
); \

698 
__nŸ_fú°_ˇŒ
 = 
	`__sig£tjmp
 ((
__jmp_buf_èg
 *) (*) \

699 
__ˇn˚l_buf
.
__ˇn˚l_jmp_buf
, 0); \

700 i‡(
	`__glibc_u∆ikñy
 (
__nŸ_fú°_ˇŒ
)) \

702 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

703 
	`__±hªad_unwöd_√xt
 (&
__ˇn˚l_buf
); \

707 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (&
__ˇn˚l_buf
); \

708 dÿ{

	)

709 
	`__±hªad_ªgi°î_ˇn˚l_de„r
 (
__±hªad_unwöd_buf_t
 *
__buf
)

710 
__˛ónup_f˘_©åibuã
;

715 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

718 
	`__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (&
__ˇn˚l_buf
); \

719 i‡(
execuã
) \

720 
	`__ˇn˚l_routöe
 (
__ˇn˚l_¨g
); \

721 
	}
} 0)

	)

722 
	$__±hªad_uƒegi°î_ˇn˚l_ª°‹e
 (
__±hªad_unwöd_buf_t
 *
__buf
)

723 
__˛ónup_f˘_©åibuã
;

727 
	$__±hªad_unwöd_√xt
 (
__±hªad_unwöd_buf_t
 *
__buf
)

728 
__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
__n‹ëu∫__
))

729 #i‚de‡
SHARED


730 
	`__©åibuã__
 ((
__wók__
))

736 
__jmp_buf_èg
;

737 
	$__sig£tjmp
 (
__jmp_buf_èg
 *
__ív
, 
__ßvemask
Ë
__THROWNL
;

743 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

744 c⁄° 
±hªad_muãx©å_t
 *
__muãx©å
)

745 
__THROW
 
	`__n⁄nuŒ
 ((1));

748 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
)

749 
__THROW
 
	`__n⁄nuŒ
 ((1));

752 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
)

753 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

756 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
)

757 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

759 #ifde‡
__USE_XOPEN2K


761 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

762 c⁄° 
time•ec
 *
__ª°ri˘


763 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

767 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
)

768 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

772 
	$±hªad_muãx_gë¥io˚ûög
 (c⁄° 
±hªad_muãx_t
 *

773 
__ª°ri˘
 
__muãx
,

774 *
__ª°ri˘
 
__¥io˚ûög
)

775 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

779 
	$±hªad_muãx_£çrio˚ûög
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

780 
__¥io˚ûög
,

781 *
__ª°ri˘
 
__ﬁd_˚ûög
)

782 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

785 #ifde‡
__USE_XOPEN2K8


787 
	$±hªad_muãx_c⁄si°ít
 (
±hªad_muãx_t
 *
__muãx
)

788 
__THROW
 
	`__n⁄nuŒ
 ((1));

789 #ifde‡
__USE_GNU


790 
	$±hªad_muãx_c⁄si°ít_≈
 (
±hªad_muãx_t
 *
__muãx
)

791 
__THROW
 
	`__n⁄nuŒ
 ((1));

800 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
)

801 
__THROW
 
	`__n⁄nuŒ
 ((1));

804 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
)

805 
__THROW
 
	`__n⁄nuŒ
 ((1));

808 
	$±hªad_muãx©å_gëpsh¨ed
 (c⁄° 
±hªad_muãx©å_t
 *

809 
__ª°ri˘
 
__©å
,

810 *
__ª°ri˘
 
__psh¨ed
)

811 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

814 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

815 
__psh¨ed
)

816 
__THROW
 
	`__n⁄nuŒ
 ((1));

818 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8


820 
	$±hªad_muãx©å_gëty≥
 (c⁄° 
±hªad_muãx©å_t
 *
__ª°ri˘


821 
__©å
, *
__ª°ri˘
 
__köd
)

822 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

827 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

828 
__THROW
 
	`__n⁄nuŒ
 ((1));

832 
	$±hªad_muãx©å_gë¥Ÿocﬁ
 (c⁄° 
±hªad_muãx©å_t
 *

833 
__ª°ri˘
 
__©å
,

834 *
__ª°ri˘
 
__¥Ÿocﬁ
)

835 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

839 
	$±hªad_muãx©å_£çrŸocﬁ
 (
±hªad_muãx©å_t
 *
__©å
,

840 
__¥Ÿocﬁ
)

841 
__THROW
 
	`__n⁄nuŒ
 ((1));

844 
	$±hªad_muãx©å_gë¥io˚ûög
 (c⁄° 
±hªad_muãx©å_t
 *

845 
__ª°ri˘
 
__©å
,

846 *
__ª°ri˘
 
__¥io˚ûög
)

847 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

850 
	$±hªad_muãx©å_£çrio˚ûög
 (
±hªad_muãx©å_t
 *
__©å
,

851 
__¥io˚ûög
)

852 
__THROW
 
	`__n⁄nuŒ
 ((1));

854 #ifde‡
__USE_XOPEN2K


856 
	$±hªad_muãx©å_gërobu°
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

857 *
__robu°√ss
)

858 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

859 #ifde‡
__USE_GNU


860 
	$±hªad_muãx©å_gërobu°_≈
 (c⁄° 
±hªad_muãx©å_t
 *
__©å
,

861 *
__robu°√ss
)

862 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

866 
	$±hªad_muãx©å_£åobu°
 (
±hªad_muãx©å_t
 *
__©å
,

867 
__robu°√ss
)

868 
__THROW
 
	`__n⁄nuŒ
 ((1));

869 #ifde‡
__USE_GNU


870 
	$±hªad_muãx©å_£åobu°_≈
 (
±hªad_muãx©å_t
 *
__©å
,

871 
__robu°√ss
)

872 
__THROW
 
	`__n⁄nuŒ
 ((1));

877 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


882 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

883 c⁄° 
±hªad_rwlock©å_t
 *
__ª°ri˘


884 
__©å
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

887 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
)

888 
__THROW
 
	`__n⁄nuŒ
 ((1));

891 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

892 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

895 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
)

896 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

898 #ifde‡
__USE_XOPEN2K


900 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

901 c⁄° 
time•ec
 *
__ª°ri˘


902 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

906 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
)

907 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

910 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
)

911 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

913 #ifde‡
__USE_XOPEN2K


915 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

916 c⁄° 
time•ec
 *
__ª°ri˘


917 
__ab°ime
Ë
__THROWNL
 
	`__n⁄nuŒ
 ((1, 2));

921 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
)

922 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

928 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
)

929 
__THROW
 
	`__n⁄nuŒ
 ((1));

932 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
)

933 
__THROW
 
	`__n⁄nuŒ
 ((1));

936 
	$±hªad_rwlock©å_gëpsh¨ed
 (c⁄° 
±hªad_rwlock©å_t
 *

937 
__ª°ri˘
 
__©å
,

938 *
__ª°ri˘
 
__psh¨ed
)

939 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

942 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

943 
__psh¨ed
)

944 
__THROW
 
	`__n⁄nuŒ
 ((1));

947 
	$±hªad_rwlock©å_gëköd_≈
 (c⁄° 
±hªad_rwlock©å_t
 *

948 
__ª°ri˘
 
__©å
,

949 *
__ª°ri˘
 
__¥ef
)

950 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

953 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

954 
__¥ef
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

962 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

963 c⁄° 
±hªad_c⁄d©å_t
 *
__ª°ri˘
 
__c⁄d_©å
)

964 
__THROW
 
	`__n⁄nuŒ
 ((1));

967 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
)

968 
__THROW
 
	`__n⁄nuŒ
 ((1));

971 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
)

972 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

975 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
)

976 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

983 
	$±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

984 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
)

985 
	`__n⁄nuŒ
 ((1, 2));

994 
	$±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

995 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

996 c⁄° 
time•ec
 *
__ª°ri˘
 
__ab°ime
)

997 
	`__n⁄nuŒ
 ((1, 2, 3));

1002 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
)

1003 
__THROW
 
	`__n⁄nuŒ
 ((1));

1006 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
)

1007 
__THROW
 
	`__n⁄nuŒ
 ((1));

1010 
	$±hªad_c⁄d©å_gëpsh¨ed
 (c⁄° 
±hªad_c⁄d©å_t
 *

1011 
__ª°ri˘
 
__©å
,

1012 *
__ª°ri˘
 
__psh¨ed
)

1013 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1016 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

1017 
__psh¨ed
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

1019 #ifde‡
__USE_XOPEN2K


1021 
	$±hªad_c⁄d©å_gë˛ock
 (c⁄° 
±hªad_c⁄d©å_t
 *

1022 
__ª°ri˘
 
__©å
,

1023 
__˛ockid_t
 *
__ª°ri˘
 
__˛ock_id
)

1024 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1027 
	$±hªad_c⁄d©å_£t˛ock
 (
±hªad_c⁄d©å_t
 *
__©å
,

1028 
__˛ockid_t
 
__˛ock_id
)

1029 
__THROW
 
	`__n⁄nuŒ
 ((1));

1033 #ifde‡
__USE_XOPEN2K


1038 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

1039 
__THROW
 
	`__n⁄nuŒ
 ((1));

1042 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
)

1043 
__THROW
 
	`__n⁄nuŒ
 ((1));

1046 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
)

1047 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1050 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
)

1051 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1054 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
)

1055 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1062 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

1063 c⁄° 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


1064 
__©å
, 
__cou¡
)

1065 
__THROW
 
	`__n⁄nuŒ
 ((1));

1068 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1069 
__THROW
 
	`__n⁄nuŒ
 ((1));

1072 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
)

1073 
__THROWNL
 
	`__n⁄nuŒ
 ((1));

1077 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1078 
__THROW
 
	`__n⁄nuŒ
 ((1));

1081 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
)

1082 
__THROW
 
	`__n⁄nuŒ
 ((1));

1085 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (c⁄° 
±hªad_b¨rõøâr_t
 *

1086 
__ª°ri˘
 
__©å
,

1087 *
__ª°ri˘
 
__psh¨ed
)

1088 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

1091 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

1092 
__psh¨ed
)

1093 
__THROW
 
	`__n⁄nuŒ
 ((1));

1105 
	`±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

1106 (*
__de°r_fun˘i⁄
) (*))

1107 
__THROW
 
	`__n⁄nuŒ
 ((1));

1110 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1113 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

1116 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

1117 c⁄° *
__poöãr
Ë
__THROW
 ;

1120 #ifde‡
__USE_XOPEN2K


1122 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

1123 
__˛ockid_t
 *
__˛ock_id
)

1124 
__THROW
 
	`__n⁄nuŒ
 ((2));

1139 
	`±hªad_©f‹k
 ((*
__¥ï¨e
) (),

1140 (*
__∑ª¡
) (),

1141 (*
__chûd
Ë()Ë
__THROW
;

1144 #ifde‡
__USE_EXTERN_INLINES


1146 
__exã∫_ölöe
 

1147 
	`__NTH
 (
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
))

1149  
__thªad1
 =
__thªad2
;

1150 
	}
}

1153 
	g__END_DECLS


	@/usr/include/wctype.h

23 #i‚de‡
_WCTYPE_H


25 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 #i‚de‡
__√ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__√ed_wöt_t


	)

33 
	~<wch¨.h
>

37 #i‚de‡
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde‡
__√ed_iswxxx


46 #i‚de‡
__iswxxx_deföed


47 
	#__iswxxx_deföed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	tw˘y≥_t
;

53 
	g__END_NAMESPACE_C99


55 #i‚de‡
_ISwbô


60 
	~<ídün.h
>

61 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

64 
	#_ISwbô
(
bô
) \

65 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

73 
	m__ISwuµî
 = 0,

74 
	m__ISwlowî
 = 1,

75 
	m__ISwÆpha
 = 2,

76 
	m__ISwdigô
 = 3,

77 
	m__ISwxdigô
 = 4,

78 
	m__ISw•a˚
 = 5,

79 
	m__ISw¥öt
 = 6,

80 
	m__ISwgøph
 = 7,

81 
	m__ISwbœnk
 = 8,

82 
	m__ISw˙ål
 = 9,

83 
	m__ISwpun˘
 = 10,

84 
	m__ISwÆnum
 = 11,

86 
	m_ISwuµî
 = 
_ISwbô
 (
__ISwuµî
),

87 
	m_ISwlowî
 = 
_ISwbô
 (
__ISwlowî
),

88 
	m_ISwÆpha
 = 
_ISwbô
 (
__ISwÆpha
),

89 
	m_ISwdigô
 = 
_ISwbô
 (
__ISwdigô
),

90 
	m_ISwxdigô
 = 
_ISwbô
 (
__ISwxdigô
),

91 
	m_ISw•a˚
 = 
_ISwbô
 (
__ISw•a˚
),

92 
	m_ISw¥öt
 = 
_ISwbô
 (
__ISw¥öt
),

93 
	m_ISwgøph
 = 
_ISwbô
 (
__ISwgøph
),

94 
	m_ISwbœnk
 = 
_ISwbô
 (
__ISwbœnk
),

95 
	m_ISw˙ål
 = 
_ISwbô
 (
__ISw˙ål
),

96 
	m_ISwpun˘
 = 
_ISwbô
 (
__ISwpun˘
),

97 
	m_ISwÆnum
 = 
_ISwbô
 (
__ISwÆnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

117 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

120 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

124 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

128 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

133 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

136 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

141 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

146 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

161 #ifde‡
__USE_ISOC99


162 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
w˘y≥_t
 
	$w˘y≥
 (c⁄° *
__¥›îty
Ë
__THROW
;

175 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 c⁄° 
	t__öt32_t
 *
	tw˘øns_t
;

187 
__END_NAMESPACE_C99


188 #ifde‡
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

197 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde‡
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
w˘øns_t
 
	$w˘øns
 (c⁄° *
__¥›îty
Ë
__THROW
;

221 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde‡
__USE_XOPEN2K8


226 
	~<xloˇÀ.h
>

230 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

236 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

239 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

243 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

247 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

252 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

255 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

260 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

265 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

284 
w˘y≥_t
 
	$w˘y≥_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

285 
__THROW
;

289 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

290 
__THROW
;

298 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

301 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

305 
w˘øns_t
 
	$w˘øns_l
 (c⁄° *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

306 
__THROW
;

309 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

310 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

314 
__END_DECLS


	@/usr/include/bits/setjmp.h

19 #i‚de‡
_BITS_SETJMP_H


20 
	#_BITS_SETJMP_H
 1

	)

22 #i‡!
deföed
 
_SETJMP_H
 && !deföed 
_PTHREAD_H


26 
	~<bôs/w‹dsize.h
>

28 #i‚de‡
_ASM


30 #i‡
__WORDSIZE
 == 64

31 
	t__jmp_buf
[8];

32 #ñi‡
deföed
 
__x86_64__


33 
	t__jmp_buf
[8];

35 
	t__jmp_buf
[6];

	@/usr/include/sched.h

20 #i‚def 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

31 
	#__√ed_time_t


	)

32 
	#__√ed_time•ec


	)

33 
	~<time.h
>

35 #i‚de‡
__pid_t_deföed


36 
__pid_t
 
	tpid_t
;

37 
	#__pid_t_deföed


	)

42 
	~<bôs/sched.h
>

44 
	#sched_¥i‹ôy
 
__sched_¥i‹ôy


	)

47 
__BEGIN_DECLS


50 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, c⁄° 
sched_∑øm
 *
__∑øm
)

51 
__THROW
;

54 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

57 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

58 c⁄° 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

61 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

64 
	$sched_yõld
 (Ë
__THROW
;

67 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

70 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

73 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

76 #ifde‡
__USE_GNU


78 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

79 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

80 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u,  (
˝u_£t_t
), cpu£ç)

	)

81 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (˝u,  (
˝u_£t_t
), \

82 
˝u£ç
)

	)

83 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO_S
 ( (
˝u_£t_t
), cpu£ç)

	)

84 
	#CPU_COUNT
(
˝u£ç
Ë
	`__CPU_COUNT_S
 ( (
˝u_£t_t
), cpu£ç)

	)

86 
	#CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_SET_S
 (˝u, sësize, cpu£ç)

	)

87 
	#CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_CLR_S
 (˝u, sësize, cpu£ç)

	)

88 
	#CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
Ë
	`__CPU_ISSET_S
 (cpu, setsize, \

89 
˝u£ç
)

	)

90 
	#CPU_ZERO_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_ZERO_S
 (£tsize, cpu£ç)

	)

91 
	#CPU_COUNT_S
(
£tsize
, 
˝u£ç
Ë
	`__CPU_COUNT_S
 (£tsize, cpu£ç)

	)

93 
	#CPU_EQUAL
(
˝u£ç1
, 
˝u£ç2
) \

94 
	`__CPU_EQUAL_S
 ( (
˝u_£t_t
), 
˝u£ç1
, 
˝u£ç2
)

	)

95 
	#CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

96 
	`__CPU_EQUAL_S
 (
£tsize
, 
˝u£ç1
, 
˝u£ç2
)

	)

98 
	#CPU_AND
(
de°£t
, 
§c£t1
, 
§c£t2
) \

99 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

100 
	#CPU_OR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

101 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

102 
	#CPU_XOR
(
de°£t
, 
§c£t1
, 
§c£t2
) \

103 
	`__CPU_OP_S
 ( (
˝u_£t_t
), 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

104 
	#CPU_AND_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

105 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, &)

	)

106 
	#CPU_OR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

107 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, |)

	)

108 
	#CPU_XOR_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
) \

109 
	`__CPU_OP_S
 (
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, ^)

	)

111 
	#CPU_ALLOC_SIZE
(
cou¡
Ë
	`__CPU_ALLOC_SIZE
 (cou¡)

	)

112 
	#CPU_ALLOC
(
cou¡
Ë
	`__CPU_ALLOC
 (cou¡)

	)

113 
	#CPU_FREE
(
˝u£t
Ë
	`__CPU_FREE
 (˝u£t)

	)

117 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

118 c⁄° 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

121 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

122 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

125 
__END_DECLS


	@/usr/include/bits/sched.h

21 #i‚de‡
__√ed_sched∑øm


23 #i‚de‡
_SCHED_H


29 
	#SCHED_OTHER
 0

	)

30 
	#SCHED_FIFO
 1

	)

31 
	#SCHED_RR
 2

	)

32 #ifde‡
__USE_GNU


33 
	#SCHED_BATCH
 3

	)

34 
	#SCHED_IDLE
 5

	)

36 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

39 #ifde‡
__USE_GNU


41 
	#CSIGNAL
 0x000000f‡

	)

42 
	#CLONE_VM
 0x00000100

	)

43 
	#CLONE_FS
 0x00000200

	)

44 
	#CLONE_FILES
 0x00000400

	)

45 
	#CLONE_SIGHAND
 0x00000800

	)

46 
	#CLONE_PTRACE
 0x00002000

	)

47 
	#CLONE_VFORK
 0x00004000

	)

49 
	#CLONE_PARENT
 0x00008000

	)

51 
	#CLONE_THREAD
 0x00010000

	)

52 
	#CLONE_NEWNS
 0x00020000

	)

53 
	#CLONE_SYSVSEM
 0x00040000

	)

54 
	#CLONE_SETTLS
 0x00080000

	)

55 
	#CLONE_PARENT_SETTID
 0x00100000

	)

57 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

59 
	#CLONE_DETACHED
 0x00400000

	)

60 
	#CLONE_UNTRACED
 0x00800000

	)

62 
	#CLONE_CHILD_SETTID
 0x01000000

	)

64 
	#CLONE_NEWUTS
 0x04000000

	)

65 
	#CLONE_NEWIPC
 0x08000000

	)

66 
	#CLONE_NEWUSER
 0x10000000

	)

67 
	#CLONE_NEWPID
 0x20000000

	)

68 
	#CLONE_NEWNET
 0x40000000

	)

69 
	#CLONE_IO
 0x80000000

	)

73 
	ssched_∑øm


75 
	m__sched_¥i‹ôy
;

78 
	g__BEGIN_DECLS


80 #ifde‡
__USE_GNU


82 
˛⁄e
 ((*
__‚
Ë(*
__¨g
), *
__chûd_°ack
,

83 
__Êags
, *
__¨g
, ...Ë
__THROW
;

86 
	$unsh¨e
 (
__Êags
Ë
__THROW
;

89 
	$sched_gë˝u
 (Ë
__THROW
;

92 
	$£äs
 (
__fd
, 
__n°y≥
Ë
__THROW
;

96 
__END_DECLS


100 #i‡!
deföed
 
__deföed_sched∑øm
 \

101 && (
deföed
 
__√ed_sched∑øm
 || deföed 
_SCHED_H
)

102 
	#__deföed_sched∑øm
 1

	)

104 
	s__sched_∑øm


106 
__sched_¥i‹ôy
;

108 #unde‡
__√ed_sched∑øm


112 #i‡
deföed
 
_SCHED_H
 && !deföed 
__˝u_£t_t_deföed


113 
	#__˝u_£t_t_deföed


	)

115 
	#__CPU_SETSIZE
 1024

	)

116 
	#__NCPUBITS
 (8 *  (
__˝u_mask
))

	)

119 
	t__˝u_mask
;

122 
	#__CPUELT
(
˝u
Ë((˝uË/ 
__NCPUBITS
)

	)

123 
	#__CPUMASK
(
˝u
Ë((
__˝u_mask
Ë1 << ((˝uË% 
__NCPUBITS
))

	)

128 
__˝u_mask
 
__bôs
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

129 } 
	t˝u_£t_t
;

132 #i‡
	`__GNUC_PREREQ
 (2, 91)

133 
	#__CPU_ZERO_S
(
£tsize
, 
˝u£ç
) \

134 dÿ
	`__buûtö_mem£t
 (
˝u£ç
, '\0', 
£tsize
); 0)

	)

136 
	#__CPU_ZERO_S
(
£tsize
, 
˝u£ç
) \

138 
size_t
 
__i
; \

139 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

140 
__˝u_mask
 *
__bôs
 = (
˝u£ç
)->__bits; \

141 
__i
 = 0; __ò< 
__imax
; ++__i) \

142 
__bôs
[
__i
] = 0; \

143 
	}
} 0)

	)

145 
	#__CPU_SET_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

146 (
__exãnsi⁄__
 \

147 ({ 
size_t
 
__˝u
 = (
˝u
); \

148 
__˝u
 < 8 * (
£tsize
) \

149 ? (((
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

150 |
	`__CPUMASK
 (
__˝u
)) \

151 : 0; }))

	)

152 
	#__CPU_CLR_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

153 (
__exãnsi⁄__
 \

154 ({ 
size_t
 
__˝u
 = (
˝u
); \

155 
__˝u
 < 8 * (
£tsize
) \

156 ? (((
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

157 &~
	`__CPUMASK
 (
__˝u
)) \

158 : 0; }))

	)

159 
	#__CPU_ISSET_S
(
˝u
, 
£tsize
, 
˝u£ç
) \

160 (
__exãnsi⁄__
 \

161 ({ 
size_t
 
__˝u
 = (
˝u
); \

162 
__˝u
 < 8 * (
£tsize
) \

163 ? ((((c⁄° 
__˝u_mask
 *Ë((
˝u£ç
)->
__bôs
))[
	`__CPUELT
 (
__˝u
)] \

164 & 
	`__CPUMASK
 (
__˝u
))) != 0 \

165 : 0; }))

	)

167 
	#__CPU_COUNT_S
(
£tsize
, 
˝u£ç
) \

168 
	`__sched_˝ucou¡
 (
£tsize
, 
˝u£ç
)

	)

170 #i‡
__GNUC_PREREQ
 (2, 91)

171 
	#__CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

172 (
	`__buûtö_memcmp
 (
˝u£ç1
, 
˝u£ç2
, 
£tsize
Ë=0)

	)

174 
	#__CPU_EQUAL_S
(
£tsize
, 
˝u£ç1
, 
˝u£ç2
) \

175 (
__exãnsi⁄__
 \

176 ({ c⁄° 
__˝u_mask
 *
__¨r1
 = (
˝u£ç1
)->
__bôs
; \

177 c⁄° 
__˝u_mask
 *
__¨r2
 = (
˝u£ç2
)->
__bôs
; \

178 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

179 
size_t
 
__i
; \

180 
__i
 = 0; __ò< 
__imax
; ++__i) \

181 i‡(
__¨r1
[
__i
] !
__¨r2
[__i]) \

183 
__i
 =
__imax
; }))

	)

186 
	#__CPU_OP_S
(
£tsize
, 
de°£t
, 
§c£t1
, 
§c£t2
, 
›
) \

187 (
__exãnsi⁄__
 \

188 ({ 
˝u_£t_t
 *
__de°
 = (
de°£t
); \

189 c⁄° 
__˝u_mask
 *
__¨r1
 = (
§c£t1
)->
__bôs
; \

190 c⁄° 
__˝u_mask
 *
__¨r2
 = (
§c£t2
)->
__bôs
; \

191 
size_t
 
__imax
 = (
£tsize
Ë/  (
__˝u_mask
); \

192 
size_t
 
__i
; \

193 
__i
 = 0; __ò< 
__imax
; ++__i) \

194 ((
__˝u_mask
 *Ë
__de°
->
__bôs
)[
__i
] = 
__¨r1
[__i] 
›
 
__¨r2
[__i]; \

195 
__de°
; }))

	)

197 
	#__CPU_ALLOC_SIZE
(
cou¡
) \

198 ((((
cou¡
Ë+ 
__NCPUBITS
 - 1Ë/ __NCPUBITSË*  (
__˝u_mask
))

	)

199 
	#__CPU_ALLOC
(
cou¡
Ë
	`__sched_˝uÆloc
 (cou¡)

	)

200 
	#__CPU_FREE
(
˝u£t
Ë
	`__sched_˝u‰ì
 (˝u£t)

	)

202 
__BEGIN_DECLS


204 
	$__sched_˝ucou¡
 (
size_t
 
__£tsize
, c⁄° 
˝u_£t_t
 *
__£ç
)

205 
__THROW
;

206 
˝u_£t_t
 *
	$__sched_˝uÆloc
 (
size_t
 
__cou¡
Ë
__THROW
 
__wur
;

207 
	$__sched_˝u‰ì
 (
˝u_£t_t
 *
__£t
Ë
__THROW
;

209 
__END_DECLS


	@
1
.
1
/usr/include
223
6026
TLibCommon/AccessUnit.h
TLibCommon/CommonDef.h
TLibCommon/ContextModel.cpp
TLibCommon/ContextModel.h
TLibCommon/ContextModel3DBuffer.cpp
TLibCommon/ContextModel3DBuffer.h
TLibCommon/ContextTables.h
TLibCommon/Debug.cpp
TLibCommon/Debug.h
TLibCommon/NAL.h
TLibCommon/ProfileLevelTierFeatures.cpp
TLibCommon/ProfileLevelTierFeatures.h
TLibCommon/SEI.cpp
TLibCommon/SEI.h
TLibCommon/SEIFilmGrainSynthesizer.cpp
TLibCommon/SEIFilmGrainSynthesizer.h
TLibCommon/TComBitCounter.h
TLibCommon/TComBitStream.cpp
TLibCommon/TComBitStream.h
TLibCommon/TComCABACTables.cpp
TLibCommon/TComCABACTables.h
TLibCommon/TComChromaFormat.cpp
TLibCommon/TComChromaFormat.h
TLibCommon/TComCodingStatistics.h
TLibCommon/TComDataCU.cpp
TLibCommon/TComDataCU.h
TLibCommon/TComInterpolationFilter.cpp
TLibCommon/TComInterpolationFilter.h
TLibCommon/TComList.h
TLibCommon/TComLoopFilter.cpp
TLibCommon/TComLoopFilter.h
TLibCommon/TComMotionInfo.cpp
TLibCommon/TComMotionInfo.h
TLibCommon/TComMv.h
TLibCommon/TComPattern.cpp
TLibCommon/TComPattern.h
TLibCommon/TComPic.cpp
TLibCommon/TComPic.h
TLibCommon/TComPicSym.cpp
TLibCommon/TComPicSym.h
TLibCommon/TComPicYuv.cpp
TLibCommon/TComPicYuv.h
TLibCommon/TComPicYuvMD5.cpp
TLibCommon/TComPrediction.cpp
TLibCommon/TComPrediction.h
TLibCommon/TComRdCost.cpp
TLibCommon/TComRdCost.h
TLibCommon/TComRdCostWeightPrediction.cpp
TLibCommon/TComRdCostWeightPrediction.h
TLibCommon/TComRectangle.h
TLibCommon/TComRom.cpp
TLibCommon/TComRom.h
TLibCommon/TComSampleAdaptiveOffset.cpp
TLibCommon/TComSampleAdaptiveOffset.h
TLibCommon/TComSlice.cpp
TLibCommon/TComSlice.h
TLibCommon/TComTU.cpp
TLibCommon/TComTU.h
TLibCommon/TComTrQuant.cpp
TLibCommon/TComTrQuant.h
TLibCommon/TComWeightPrediction.cpp
TLibCommon/TComWeightPrediction.h
TLibCommon/TComYuv.cpp
TLibCommon/TComYuv.h
TLibCommon/TypeDef.h
TLibDecoder/AnnexBread.cpp
TLibDecoder/AnnexBread.h
TLibDecoder/NALread.cpp
TLibDecoder/NALread.h
TLibDecoder/SEIread.cpp
TLibDecoder/SEIread.h
TLibDecoder/SyntaxElementParser.cpp
TLibDecoder/SyntaxElementParser.h
TLibDecoder/TDecBinCoder.h
TLibDecoder/TDecBinCoderCABAC.cpp
TLibDecoder/TDecBinCoderCABAC.h
TLibDecoder/TDecCAVLC.cpp
TLibDecoder/TDecCAVLC.h
TLibDecoder/TDecConformance.cpp
TLibDecoder/TDecConformance.h
TLibDecoder/TDecCu.cpp
TLibDecoder/TDecCu.h
TLibDecoder/TDecEntropy.cpp
TLibDecoder/TDecEntropy.h
TLibDecoder/TDecGop.cpp
TLibDecoder/TDecGop.h
TLibDecoder/TDecSbac.cpp
TLibDecoder/TDecSbac.h
TLibDecoder/TDecSlice.cpp
TLibDecoder/TDecSlice.h
TLibDecoder/TDecTop.cpp
TLibDecoder/TDecTop.h
TLibEncoder/AnnexBwrite.h
TLibEncoder/NALwrite.cpp
TLibEncoder/NALwrite.h
TLibEncoder/SEIEncoder.cpp
TLibEncoder/SEIEncoder.h
TLibEncoder/SEIwrite.cpp
TLibEncoder/SEIwrite.h
TLibEncoder/SyntaxElementWriter.cpp
TLibEncoder/SyntaxElementWriter.h
TLibEncoder/TEncAnalyze.h
TLibEncoder/TEncBinCoder.h
TLibEncoder/TEncBinCoderCABAC.cpp
TLibEncoder/TEncBinCoderCABAC.h
TLibEncoder/TEncBinCoderCABACCounter.cpp
TLibEncoder/TEncBinCoderCABACCounter.h
TLibEncoder/TEncCavlc.cpp
TLibEncoder/TEncCavlc.h
TLibEncoder/TEncCfg.h
TLibEncoder/TEncCu.cpp
TLibEncoder/TEncCu.h
TLibEncoder/TEncEntropy.cpp
TLibEncoder/TEncEntropy.h
TLibEncoder/TEncGOP.cpp
TLibEncoder/TEncGOP.h
TLibEncoder/TEncPic.cpp
TLibEncoder/TEncPic.h
TLibEncoder/TEncPreanalyzer.cpp
TLibEncoder/TEncPreanalyzer.h
TLibEncoder/TEncRateCtrl.cpp
TLibEncoder/TEncRateCtrl.h
TLibEncoder/TEncSampleAdaptiveOffset.cpp
TLibEncoder/TEncSampleAdaptiveOffset.h
TLibEncoder/TEncSbac.cpp
TLibEncoder/TEncSbac.h
TLibEncoder/TEncSearch.cpp
TLibEncoder/TEncSearch.h
TLibEncoder/TEncSlice.cpp
TLibEncoder/TEncSlice.h
TLibEncoder/TEncTemporalFilter.cpp
TLibEncoder/TEncTemporalFilter.h
TLibEncoder/TEncTop.cpp
TLibEncoder/TEncTop.h
TLibEncoder/WeightPredAnalysis.cpp
TLibEncoder/WeightPredAnalysis.h
Utilities/TVideoIOYuv.cpp
Utilities/TVideoIOYuv.h
Utilities/program_options_lite.cpp
Utilities/program_options_lite.h
libmd5/MD5.h
libmd5/libmd5.cpp
libmd5/libmd5.h
/usr/include/assert.h
/usr/include/fcntl.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/memory.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/sys/stat.h
/usr/include/time.h
/usr/include/alloca.h
/usr/include/bits/fcntl.h
/usr/include/bits/fcntl2.h
/usr/include/bits/huge_val.h
/usr/include/bits/huge_valf.h
/usr/include/bits/huge_vall.h
/usr/include/bits/inf.h
/usr/include/bits/math-finite.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathdef.h
/usr/include/bits/mathinline.h
/usr/include/bits/nan.h
/usr/include/bits/stat.h
/usr/include/bits/stdio-ldbl.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio2.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/stdlib-float.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wchar.h
/usr/include/bits/wordsize.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/sys/types.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/bits/fcntl-linux.h
/usr/include/bits/libio-ldbl.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/timex.h
/usr/include/bits/typesizes.h
/usr/include/ctype.h
/usr/include/endian.h
/usr/include/gnu/stubs.h
/usr/include/stdc-predef.h
/usr/include/sys/cdefs.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/libc-lock.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/sigset.h
/usr/include/bits/uio.h
/usr/include/gconv.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/linux/falloc.h
/usr/include/wchar.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/wchar-ldbl.h
/usr/include/bits/wchar2.h
/usr/include/pthread.h
/usr/include/wctype.h
/usr/include/bits/setjmp.h
/usr/include/sched.h
/usr/include/bits/sched.h
